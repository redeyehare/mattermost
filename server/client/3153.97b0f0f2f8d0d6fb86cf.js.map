{"version":3,"file":"3153.97b0f0f2f8d0d6fb86cf.js","mappings":"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","sources":["webpack://mattermost-webapp/./src/components/popout_button.tsx","webpack://mattermost-webapp/./src/components/common/svg_images_components/chat_illustration.tsx","webpack://mattermost-webapp/./src/components/common/svg_images_components/search_hint_svg.tsx","webpack://mattermost-webapp/./src/components/post_priority/post_priority_badge.tsx","webpack://mattermost-webapp/./src/components/threading/global_threads/thread_item/attachments/attachment_card/index.tsx","webpack://mattermost-webapp/./src/components/threading/global_threads/thread_item/attachments/file_card/file_card.tsx","webpack://mattermost-webapp/./src/components/threading/global_threads/thread_item/attachments/file_card/index.ts","webpack://mattermost-webapp/./src/components/threading/global_threads/thread_item/attachments/index.tsx","webpack://mattermost-webapp/./src/components/threading/global_threads/thread_item/thread_item.tsx","webpack://mattermost-webapp/./src/components/threading/global_threads/thread_item/index.ts","webpack://mattermost-webapp/./src/components/threading/global_threads/thread_list/virtualized_thread_list_row.tsx","webpack://mattermost-webapp/./src/components/threading/global_threads/thread_list/virtualized_thread_list.tsx","webpack://mattermost-webapp/./src/components/threading/global_threads/mark_all_threads_as_read_modal/mark_all_threads_as_read_modal.tsx","webpack://mattermost-webapp/./src/components/threading/global_threads/thread_list/thread_list.tsx","webpack://mattermost-webapp/./src/components/threading/global_threads/global_threads.tsx","webpack://mattermost-webapp/./src/components/threading/global_threads/thread_menu/thread_menu.tsx","webpack://mattermost-webapp/./src/hooks/useReadout.ts","webpack://mattermost-webapp/./src/components/threading/global_threads/thread_pane/thread_pane.tsx","webpack://mattermost-webapp/./src/components/threading/hooks.ts","webpack://mattermost-webapp/./src/components/widgets/header/header.tsx"],"sourcesContent":["// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\n\r\nimport WithTooltip from 'components/with_tooltip';\r\n\r\nimport {canPopout} from 'utils/popouts/popout_windows';\r\n\r\ntype Props = {\r\n    onClick: React.MouseEventHandler<HTMLButtonElement>;\r\n    className?: string;\r\n};\r\n\r\nexport default function PopoutButton({\r\n    onClick,\r\n    className,\r\n}: Props) {\r\n    const intl = useIntl();\r\n\r\n    if (!canPopout()) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <WithTooltip\r\n            title={\r\n                <FormattedMessage\r\n                    id='new_window_button.tooltip'\r\n                    defaultMessage='Open in new window'\r\n                />\r\n            }\r\n        >\r\n            <button\r\n                type='button'\r\n                className={classNames('btn btn-icon btn-sm', 'PopoutButton', className)}\r\n                aria-label={intl.formatMessage({id: 'new_window_button.tooltip', defaultMessage: 'Open in new window'})}\r\n                onClick={onClick}\r\n            >\r\n                <i\r\n                    className='icon icon-dock-window'\r\n                    aria-hidden='true'\r\n                />\r\n            </button>\r\n        </WithTooltip>\r\n    );\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\n\r\nconst ChatIllustration = (\r\n    <svg\r\n        width='125'\r\n        height='97'\r\n        viewBox='0 0 125 97'\r\n        fill='none'\r\n        xmlns='http://www.w3.org/2000/svg'\r\n    >\r\n        <g clipPath='url(#clip0_4210_74752)'>\r\n            <rect\r\n                opacity='0.08'\r\n                x='0.00390625'\r\n                width='50'\r\n                height='50'\r\n                rx='2'\r\n                fill='var(--button-bg)'\r\n            />\r\n            <rect\r\n                opacity='0.12'\r\n                x='30.0039'\r\n                y='50'\r\n                width='95'\r\n                height='28'\r\n                rx='2'\r\n                fill='var(--button-bg)'\r\n            />\r\n            <circle\r\n                cx='95.5039'\r\n                cy='32.5'\r\n                r='2.5'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.48'\r\n            />\r\n            <circle\r\n                cx='109.004'\r\n                cy='32.5'\r\n                r='2.5'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.48'\r\n            />\r\n            <circle\r\n                cx='122.504'\r\n                cy='32.5'\r\n                r='2.5'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.48'\r\n            />\r\n            <path\r\n                d='M95.0482 87.1199L105.004 97V46C105.004 44.8954 104.108 44 103.004 44H55.0039C53.8993 44 53.0039 44.8954 53.0039 46V84.5395C53.0039 85.644 53.8993 86.5395 55.0039 86.5395H93.6394C94.1672 86.5395 94.6736 86.7481 95.0482 87.1199Z'\r\n                fill='#28427B'\r\n            />\r\n            <path\r\n                d='M67.0039 65H97.0039'\r\n                stroke='#FFFFFF'\r\n                strokeOpacity='0.56'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M67.0039 72H86.0039'\r\n                stroke='#FFFFFF'\r\n                strokeOpacity='0.56'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M67.0039 59H77.0039'\r\n                stroke='#FFFFFF'\r\n                strokeOpacity='0.56'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M80.0039 59H93.0039'\r\n                stroke='#FFFFFF'\r\n                strokeOpacity='0.56'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M27.6089 69.5638L14.0039 83V14C14.0039 12.8954 14.8993 12 16.0039 12H82.0039C83.1085 12 84.0039 12.8954 84.0039 14V66.9868C84.0039 68.0914 83.1085 68.9868 82.0039 68.9868H29.0142C28.4881 68.9868 27.9832 69.1941 27.6089 69.5638Z'\r\n                fill='var(--center-channel-bg)'\r\n            />\r\n            <path\r\n                d='M27.2575 69.2081L14.5039 81.8035V14C14.5039 13.1716 15.1755 12.5 16.0039 12.5H82.0039C82.8323 12.5 83.5039 13.1716 83.5039 14V66.9868C83.5039 67.8153 82.8323 68.4868 82.0039 68.4868H29.0142C28.3566 68.4868 27.7254 68.746 27.2575 69.2081Z'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.8'\r\n            />\r\n            <circle\r\n                cx='32.0039'\r\n                cy='31'\r\n                r='9'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.32'\r\n            />\r\n            <path\r\n                d='M47.0039 27H63.0039'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.48'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M24.0039 51H74.0039'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.48'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M24.0039 58H46.0039'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.48'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M47.0039 33H72.0039'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.48'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M24.0039 45H41.0039'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.48'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M45.0039 45H63.0039'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.48'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M9.0039 39.5L9.0039 58L19.5039 58'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.8'\r\n                strokeLinecap='round'\r\n                strokeLinejoin='round'\r\n            />\r\n            <path\r\n                d='M9.00391 36.5L9.00391 30.5'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.8'\r\n                strokeLinecap='round'\r\n                strokeLinejoin='round'\r\n            />\r\n            <path\r\n                d='M9.00391 27.5L9.00391 25.5'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.8'\r\n                strokeLinecap='round'\r\n                strokeLinejoin='round'\r\n            />\r\n        </g>\r\n        <defs>\r\n            <clipPath id='clip0_4210_74752'>\r\n                <rect\r\n                    width='125'\r\n                    height='97'\r\n                    fill='white'\r\n                    transform='translate(0.00390625)'\r\n                />\r\n            </clipPath>\r\n        </defs>\r\n    </svg>\r\n);\r\n\r\nexport default ChatIllustration;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\n\r\ntype SvgProps = {\r\n    width?: number;\r\n    height?: number;\r\n}\r\n\r\nconst SearchHintSVG = ({width, height}: SvgProps) => (\r\n    <svg\r\n        width={width?.toString() || '72'}\r\n        height={height?.toString() || '48'}\r\n        viewBox='0 0 72 48'\r\n        fill='none'\r\n        xmlns='http://www.w3.org/2000/svg'\r\n    >\r\n        <g clipPath='url(#clip0_410_25534)'>\r\n            <path\r\n                d='M35.1353 12.5745H4.8754C4.32086 12.5726 3.77137 12.6798 3.25832 12.8898C2.74526 13.0998 2.27869 13.4087 1.88524 13.7986C1.49178 14.1886 1.17916 14.6521 0.965209 15.1627C0.751261 15.6732 0.640179 16.2208 0.638306 16.7742V35.9654C0.640179 36.5188 0.751261 37.0664 0.965209 37.577C1.17916 38.0875 1.49178 38.551 1.88524 38.941C2.27869 39.331 2.74526 39.6398 3.25832 39.8498C3.77137 40.0599 4.32086 40.167 4.8754 40.1651H9.34115V47.3489L16.0398 40.1651H35.1246C35.6791 40.167 36.2286 40.0599 36.7417 39.8498C37.2547 39.6398 37.7213 39.331 38.1147 38.941C38.5082 38.551 38.8208 38.0875 39.0348 37.577C39.2487 37.0664 39.3598 36.5188 39.3617 35.9654V16.7742C39.3579 15.6585 38.9108 14.5897 38.1185 13.8024C37.3262 13.0151 36.2534 12.5735 35.1353 12.5745Z'\r\n                fill='var(--away-indicator)'\r\n            />\r\n            <path\r\n                d='M16.0398 40.1651H35.1246C35.6791 40.167 36.2286 40.0598 36.7417 39.8498C37.2547 39.6397 37.7213 39.3309 38.1148 38.9409C38.5082 38.5509 38.8208 38.0874 39.0348 37.5769C39.2487 37.0663 39.3598 36.5187 39.3617 35.9653V24.3145C39.3617 24.3145 38.0291 35.0883 37.7897 36.0367C37.5504 36.985 37.0752 38.4039 34.8245 38.6392C32.5738 38.8745 16.0398 40.1651 16.0398 40.1651Z'\r\n                fill='#CC8F00'\r\n            />\r\n            <path\r\n                d='M9.66973 23.6263C10.2089 23.6263 10.7359 23.7859 11.1842 24.0848C11.6324 24.3837 11.9818 24.8085 12.1881 25.3056C12.3944 25.8026 12.4484 26.3496 12.3432 26.8772C12.2381 27.4049 11.9785 27.8896 11.5972 28.27C11.216 28.6504 10.7303 28.9095 10.2015 29.0145C9.67275 29.1194 9.12467 29.0656 8.62657 28.8597C8.12848 28.6538 7.70276 28.3051 7.40323 27.8578C7.10371 27.4105 6.94383 26.8845 6.94383 26.3465C6.94336 25.9892 7.01355 25.6353 7.15038 25.305C7.2872 24.9748 7.48797 24.6747 7.74118 24.422C7.9944 24.1693 8.29509 23.969 8.62602 23.8324C8.95695 23.6959 9.31163 23.6259 9.66973 23.6263Z'\r\n                fill='var(--center-channel-bg)'\r\n            />\r\n            <path\r\n                d='M20.0056 23.6263C20.5447 23.6263 21.0717 23.7859 21.52 24.0848C21.9683 24.3837 22.3177 24.8085 22.524 25.3056C22.7303 25.8026 22.7843 26.3496 22.6791 26.8772C22.5739 27.4049 22.3143 27.8896 21.9331 28.27C21.5518 28.6504 21.0661 28.9095 20.5374 29.0145C20.0086 29.1194 19.4605 29.0656 18.9624 28.8597C18.4643 28.6538 18.0386 28.3051 17.7391 27.8578C17.4396 27.4105 17.2797 26.8845 17.2797 26.3465C17.2792 25.9892 17.3494 25.6353 17.4862 25.305C17.6231 24.9748 17.8238 24.6747 18.077 24.422C18.3303 24.1693 18.6309 23.969 18.9619 23.8324C19.2928 23.6959 19.6475 23.6259 20.0056 23.6263Z'\r\n                fill='var(--center-channel-bg)'\r\n            />\r\n            <path\r\n                d='M30.33 23.6263C30.8693 23.6256 31.3967 23.7846 31.8454 24.083C32.2942 24.3815 32.6441 24.8061 32.851 25.3031C33.0579 25.8001 33.1123 26.3471 33.0076 26.875C32.9028 27.4029 32.6435 27.888 32.2624 28.2688C31.8813 28.6495 31.3956 28.909 30.8667 29.0142C30.3379 29.1195 29.7896 29.0658 29.2913 28.86C28.793 28.6542 28.3671 28.3056 28.0674 27.8582C27.7677 27.4108 27.6077 26.8847 27.6077 26.3465C27.6073 25.9895 27.6773 25.6358 27.8139 25.3058C27.9505 24.9758 28.151 24.6759 28.4038 24.4233C28.6566 24.1706 28.9569 23.9702 29.2874 23.8335C29.618 23.6967 29.9722 23.6263 30.33 23.6263Z'\r\n                fill='var(--center-channel-bg)'\r\n            />\r\n            <path\r\n                d='M3.7787 20.6104C4.08616 19.5244 4.60589 18.5098 5.30794 17.625C6.00999 16.7403 6.88049 16.0028 7.86932 15.4552C7.92789 15.4257 7.97498 15.3776 8.00322 15.3184C8.03145 15.2593 8.03923 15.1925 8.02534 15.1285C8.01145 15.0645 7.97668 15.0069 7.92646 14.9647C7.87625 14.9225 7.81343 14.8982 7.74785 14.8955C5.84009 14.7814 1.98883 15.1878 3.19637 20.5819C3.20911 20.6477 3.24362 20.7074 3.29437 20.7513C3.34513 20.7953 3.4092 20.821 3.47632 20.8242C3.54343 20.8275 3.60972 20.8082 3.66454 20.7695C3.71937 20.7307 3.75956 20.6747 3.7787 20.6104Z'\r\n                fill='#FFD470'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M32.3334 7.28991C34.7785 4.81371 37.8644 3.53829 41.5849 3.46985C45.237 3.53829 48.3042 4.80749 50.7866 7.28991C53.2628 9.77233 54.5383 12.8396 54.6067 16.4917C54.5383 20.2122 53.269 23.2919 50.7866 25.7432C48.3042 28.1883 45.237 29.4824 41.5849 29.6068C37.8644 29.4761 34.7847 28.1883 32.3334 25.7432C29.8883 23.2919 28.6004 20.206 28.4698 16.4854C28.6004 12.8334 29.8883 9.76611 32.3334 7.28991Z'\r\n                fill='var(--center-channel-bg)'\r\n            />\r\n            <path\r\n                d='M53.5706 14.1678C52.464 10.5721 50.3691 7.88057 47.2828 6.09868C44.1964 4.31679 40.8181 3.84832 37.1508 4.68784C35.1455 5.20001 33.3983 6.08537 31.8951 7.34293C33.576 5.5084 35.7082 4.23809 38.2863 3.52882C41.9535 2.68929 45.3485 3.16738 48.4626 4.9653C51.5767 6.76321 53.6882 9.46433 54.7948 13.06C55.4751 15.6505 55.4412 18.1323 54.6873 20.502C53.939 22.875 52.5957 24.8683 50.6551 26.4733C52.1121 24.8855 53.1147 23.0208 53.6603 20.8706C54.2005 18.7172 54.1703 16.4876 53.5706 14.1678Z'\r\n                fill='black'\r\n                fillOpacity='0.4'\r\n            />\r\n            <path\r\n                d='M57.6194 15.4776C57.3584 11.6178 55.7919 8.22807 52.9264 5.30846C49.663 2.19708 45.8961 0.638306 41.6257 0.638306C37.3554 0.638306 33.5947 2.19708 30.3313 5.30846C27.2047 8.55591 25.6383 12.2982 25.6383 16.5477C25.6383 20.7973 27.2047 24.5458 30.3313 27.787C33.3274 30.6448 36.7524 32.185 40.6001 32.4077C44.4478 32.6366 47.9971 31.5788 51.2605 29.2468L53.7034 31.6778L56.83 28.5664L54.3871 26.1355C56.7989 22.8942 57.8743 19.3375 57.6194 15.4776ZM50.8689 25.6963C48.3887 28.1272 45.3242 29.4139 41.6755 29.5376C37.9583 29.4077 34.8814 28.1272 32.4323 25.6963C29.9895 23.2653 28.7028 20.1973 28.5722 16.4983C28.7028 12.8673 29.9895 9.81778 32.4323 7.34971C34.8752 4.88783 37.9583 3.61978 41.6755 3.55174C45.3242 3.61978 48.3887 4.88165 50.8689 7.34971C53.3428 9.81778 54.6171 12.8673 54.6855 16.4983C54.6171 20.1973 53.3491 23.2653 50.8689 25.6963Z'\r\n                fill='#BABEC9'\r\n            />\r\n            <path\r\n                d='M67.6182 46.4679C66.8121 46.6983 66.2153 46.6174 65.8276 46.225L53.1453 32.3065C52.7577 31.9142 52.5977 31.4098 52.6592 30.787C52.7207 30.1643 53.1084 29.4668 53.8222 28.6821C54.5975 27.9659 55.2867 27.5549 55.9021 27.4553C56.5174 27.3556 57.0159 27.5362 57.4035 27.9971L71.2488 40.832C71.6364 41.2243 71.698 41.8097 71.4395 42.5944C71.1811 43.3791 70.695 44.1637 69.9873 44.9484C69.2181 45.7331 68.4243 46.2375 67.6182 46.4679Z'\r\n                fill='var(--away-indicator)'\r\n            />\r\n            <path\r\n                d='M68.5465 38.3191L63.3621 43.5465L57.1116 36.6856L61.6961 32.0027L68.5465 38.3191Z'\r\n                fill='#7A5600'\r\n            />\r\n        </g>\r\n        <defs>\r\n            <clipPath id='clip0_410_25534'>\r\n                <rect\r\n                    width='72'\r\n                    height='48'\r\n                    fill='var(--center-channel-bg)'\r\n                />\r\n            </clipPath>\r\n        </defs>\r\n    </svg>\r\n\r\n);\r\n\r\nexport default SearchHintSVG;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport styled from 'styled-components';\r\n\r\nimport {AlertOutlineIcon, AlertCircleOutlineIcon} from '@mattermost/compass-icons/components';\r\nimport {PostPriority} from '@mattermost/types/posts';\r\n\r\ntype Props = {\r\n    priority?: PostPriority;\r\n    className?: string;\r\n}\r\n\r\nconst Badge = styled.span`\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    height: 20px;\r\n    width: 20px;\r\n    margin-left: 8px;\r\n    min-width: 20px;\r\n    border-radius: 10px;\r\n    color: #fff;\r\n\r\n    background-color: ${(props: {priority: PostPriority}) => {\r\n        return props.priority === PostPriority.URGENT ? 'rgb(var(--semantic-color-danger))' : 'rgb(var(--semantic-color-info))';\r\n    }}\r\n`;\r\n\r\nexport default function PriorityLabel({priority, className}: Props) {\r\n    if (priority !== PostPriority.URGENT && priority !== PostPriority.IMPORTANT) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <Badge\r\n            className={className}\r\n            priority={priority}\r\n        >\r\n            {priority === PostPriority.URGENT ? (\r\n                <AlertOutlineIcon size={14}/>\r\n            ) : (\r\n                <AlertCircleOutlineIcon size={14}/>\r\n            )}\r\n        </Badge>\r\n    );\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\n\r\nimport {stripMarkdown} from 'utils/markdown';\r\n\r\nimport './attachment_card.scss';\r\n\r\ntype Props = {\r\n    fallback?: string;\r\n    pretext?: string;\r\n    title?: string;\r\n    text?: string;\r\n    author_name?: string;\r\n}\r\n\r\nfunction AttachmentCard({\r\n    fallback,\r\n    title,\r\n    text,\r\n    author_name: authorName,\r\n    pretext,\r\n}: Props) {\r\n    return (\r\n        <div>\r\n            <div className='attachment__truncated'>\r\n                {`${authorName}: ${title}`}\r\n            </div>\r\n            <div className='attachment__truncated'>\r\n                {stripMarkdown(text || pretext || fallback || '')}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default AttachmentCard;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport cn from 'classnames';\r\nimport React, {useMemo, memo} from 'react';\r\n\r\nimport type {FileInfo} from '@mattermost/types/files';\r\n\r\nimport {getFileThumbnailUrl, getFileUrl} from 'mattermost-redux/utils/file_utils';\r\n\r\nimport {FileTypes} from 'utils/constants';\r\nimport {fileSizeToString, getCompassIconClassName, getFileType} from 'utils/utils';\r\n\r\nimport './file_card.scss';\r\n\r\ntype Props = {\r\n    file?: FileInfo;\r\n    enableSVGs: boolean;\r\n}\r\n\r\ntype FileProps = FileInfo & {\r\n    enableSVGs: boolean;\r\n}\r\n\r\ntype CardProps = {\r\n    children?: React.ReactElement<typeof Image>;\r\n    title: string;\r\n    size?: number;\r\n}\r\n\r\nfunction File({\r\n    id,\r\n    has_preview_image: hasPreviewImage,\r\n    mini_preview: miniPreview,\r\n    mime_type: mimeType,\r\n    extension,\r\n    enableSVGs,\r\n}: FileProps) {\r\n    const imgSrc = useMemo(() => {\r\n        if (!hasPreviewImage) {\r\n            return undefined;\r\n        }\r\n        if (miniPreview) {\r\n            return `data:${mimeType};base64,${miniPreview}`;\r\n        }\r\n        return getFileThumbnailUrl(id);\r\n    }, [id, miniPreview, mimeType, hasPreviewImage]);\r\n\r\n    const fileType = getFileType(extension);\r\n\r\n    switch (fileType) {\r\n    case FileTypes.SVG:\r\n        if (enableSVGs) {\r\n            return (\r\n                <img\r\n                    alt='file preview'\r\n                    className='file_card__image post-image small'\r\n                    src={getFileUrl(id)}\r\n                />\r\n            );\r\n        }\r\n        return (\r\n            <div\r\n                className={cn(\r\n                    'icon',\r\n                    'icon-20',\r\n                    getCompassIconClassName(fileType),\r\n                    'file_card__attachment',\r\n                )}\r\n            />\r\n        );\r\n    case FileTypes.IMAGE:\r\n        return (\r\n            <img\r\n                alt='file preview'\r\n                className='file_card__image post-image small'\r\n                src={imgSrc}\r\n            />\r\n        );\r\n    default:\r\n        return (\r\n            <i\r\n                className={cn(\r\n                    'icon',\r\n                    'icon-20',\r\n                    getCompassIconClassName(fileType),\r\n                    'file_card__attachment',\r\n                )}\r\n            />\r\n        );\r\n    }\r\n}\r\n\r\nfunction Card({children, title, size}: CardProps) {\r\n    return (\r\n        <div\r\n            className='file_card'\r\n            title={title}\r\n        >\r\n            {children}\r\n            <div className='file_card__name'>\r\n                {title}\r\n            </div>\r\n            {size != null && (\r\n                <div className='file_card__size'>\r\n                    {fileSizeToString(size)}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction FileCard({file, enableSVGs}: Props) {\r\n    if (!file) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <Card\r\n            title={file.name}\r\n            size={file.size}\r\n        >\r\n            <File\r\n                enableSVGs={enableSVGs}\r\n                {...file}\r\n            />\r\n        </Card>\r\n    );\r\n}\r\n\r\nexport default memo(FileCard);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\n\r\nimport type {FileInfo} from '@mattermost/types/files';\r\n\r\nimport {getFile} from 'mattermost-redux/selectors/entities/files';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport FileCard from './file_card';\r\n\r\ntype OwnProps = {\r\n    id: FileInfo['id'];\r\n}\r\n\r\nfunction mapStateToProps(state: GlobalState, ownProps: OwnProps) {\r\n    const file = getFile(state, ownProps.id);\r\n    const config = getConfig(state);\r\n\r\n    return {\r\n        file,\r\n        enableSVGs: config.EnableSVGs === 'true',\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps)(FileCard);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\n\r\nimport {isMessageAttachmentArray} from '@mattermost/types/message_attachments';\r\nimport type {Post} from '@mattermost/types/posts';\r\n\r\nimport AttachmentCard from './attachment_card';\r\nimport FileCard from './file_card';\r\n\r\ntype Props = {\r\n    post: Post;\r\n}\r\n\r\nfunction Attachment({post}: Props) {\r\n    if (post.file_ids?.length) {\r\n        return <FileCard id={post.file_ids[0]}/>;\r\n    }\r\n\r\n    if (isMessageAttachmentArray(post.props.attachments) && post.props.attachments.length) {\r\n        return <AttachmentCard {...post.props.attachments[0]}/>;\r\n    }\r\n\r\n    return null;\r\n}\r\n\r\nexport default Attachment;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React, {memo, useCallback, useEffect, useMemo, useRef} from 'react';\r\nimport type {MouseEvent, KeyboardEvent} from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\n\r\nimport {DotsVerticalIcon} from '@mattermost/compass-icons/components';\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {Post} from '@mattermost/types/posts';\r\nimport {PostPriority} from '@mattermost/types/posts';\r\nimport type {UserThread} from '@mattermost/types/threads';\r\n\r\nimport {getChannel as fetchChannel} from 'mattermost-redux/actions/channels';\r\nimport {markLastPostInThreadAsUnread, updateThreadRead} from 'mattermost-redux/actions/threads';\r\nimport {getMissingProfilesByIds} from 'mattermost-redux/actions/users';\r\nimport {Posts} from 'mattermost-redux/constants';\r\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\r\nimport {ensureString} from 'mattermost-redux/utils/post_utils';\r\n\r\nimport {manuallyMarkThreadAsUnread} from 'actions/views/threads';\r\n\r\nimport Markdown from 'components/markdown';\r\nimport {makeGetMentionKeysForPost} from 'components/post_markdown';\r\nimport PriorityBadge from 'components/post_priority/post_priority_badge';\r\nimport Button from 'components/threading/common/button';\r\nimport Timestamp from 'components/timestamp';\r\nimport Tag from 'components/widgets/tag/tag';\r\nimport Avatars from 'components/widgets/users/avatars';\r\nimport WithTooltip from 'components/with_tooltip';\r\n\r\nimport * as Utils from 'utils/utils';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport Attachment from './attachments';\r\n\r\nimport {THREADING_TIME} from '../../common/options';\r\nimport {useThreadRouting} from '../../hooks';\r\nimport ThreadMenu from '../thread_menu';\r\n\r\nimport './thread_item.scss';\r\n\r\nexport type OwnProps = {\r\n    isSelected: boolean;\r\n    threadId: UserThread['id'];\r\n    style?: React.CSSProperties;\r\n    isFirstThreadInList: boolean;\r\n};\r\n\r\ntype Props = {\r\n    channel?: Channel;\r\n    currentRelativeTeamUrl?: string;\r\n    displayName?: string;\r\n    post?: Post;\r\n    postsInThread?: Post[];\r\n    thread?: UserThread | null;\r\n    isPostPriorityEnabled?: boolean;\r\n};\r\n\r\nconst markdownPreviewOptions = {\r\n    singleline: true,\r\n    mentionHighlight: false,\r\n    atMentions: true,\r\n};\r\n\r\nfunction ThreadItem({\r\n    channel,\r\n    currentRelativeTeamUrl,\r\n    displayName,\r\n    isSelected,\r\n    post,\r\n    postsInThread,\r\n    style,\r\n    thread,\r\n    threadId,\r\n    isFirstThreadInList,\r\n    isPostPriorityEnabled,\r\n}: Props & OwnProps): React.ReactElement|null {\r\n    const dispatch = useDispatch();\r\n    const {select, goToInChannel, currentTeamId} = useThreadRouting();\r\n    const {formatMessage} = useIntl();\r\n    const currentUserId = useSelector(getCurrentUserId);\r\n    const msgDeleted = formatMessage({id: 'post_body.deleted', defaultMessage: '(message deleted)'});\r\n    const postAuthor = ensureString(post?.props?.override_username) || displayName;\r\n    const getMentionKeysForPost = useMemo(() => makeGetMentionKeysForPost(), []);\r\n    const mentionsKeys = useSelector((state: GlobalState) => getMentionKeysForPost(state, post, channel));\r\n    const ref = useRef<HTMLDivElement>(null);\r\n\r\n    useEffect(() => {\r\n        if (channel?.teammate_id) {\r\n            dispatch(getMissingProfilesByIds([channel.teammate_id]));\r\n        }\r\n    }, [channel?.teammate_id]);\r\n\r\n    useEffect(() => {\r\n        if (!channel && thread?.post.channel_id) {\r\n            dispatch(fetchChannel(thread.post.channel_id));\r\n        }\r\n    }, [channel, thread?.post.channel_id]);\r\n\r\n    useEffect(() => {\r\n        if (isSelected) {\r\n            ref.current?.focus();\r\n        }\r\n    }, [isSelected, threadId]);\r\n\r\n    const participantIds = useMemo(() => {\r\n        const ids = (thread?.participants || []).flatMap(({id}) => {\r\n            if (id === post?.user_id) {\r\n                return [];\r\n            }\r\n            return id;\r\n        }).reverse();\r\n        return [post?.user_id ?? '', ...ids];\r\n    }, [post?.user_id, thread?.participants]);\r\n\r\n    let unreadTimestamp = post?.edit_at || post?.create_at;\r\n\r\n    const selectHandler = useCallback((e: MouseEvent<HTMLElement> | KeyboardEvent<HTMLElement>) => {\r\n        // If the event is a keyboard event, check if the key is 'Enter' or ' '.\r\n        if ('key' in e) {\r\n            if (e.key !== 'Enter' && e.key !== ' ') {\r\n                return;\r\n            }\r\n        }\r\n        if (e.altKey) {\r\n            const hasUnreads = thread ? Boolean(thread.unread_replies) : false;\r\n            const lastViewedAt = hasUnreads ? Date.now() : unreadTimestamp;\r\n\r\n            dispatch(manuallyMarkThreadAsUnread(threadId, lastViewedAt ?? 0));\r\n            if (hasUnreads) {\r\n                dispatch(updateThreadRead(currentUserId, currentTeamId, threadId, Date.now()));\r\n            } else {\r\n                dispatch(markLastPostInThreadAsUnread(currentUserId, currentTeamId, threadId));\r\n            }\r\n        } else {\r\n            select(threadId);\r\n        }\r\n    }, [\r\n        thread,\r\n        unreadTimestamp,\r\n        dispatch,\r\n        threadId,\r\n        currentUserId,\r\n        currentTeamId,\r\n        select,\r\n    ]);\r\n\r\n    const imageProps = useMemo(() => ({\r\n        onImageHeightChanged: () => {},\r\n        onImageLoaded: () => {},\r\n    }), []);\r\n\r\n    const goToInChannelHandler = useCallback((e: MouseEvent) => {\r\n        e.stopPropagation();\r\n        goToInChannel(threadId);\r\n    }, [goToInChannel, threadId]);\r\n\r\n    const handleFormattedTextClick = useCallback((e: React.UIEvent) => {\r\n        // If the event is a keyboard event, check if the key is 'Enter' or ' '.\r\n        if ('key' in e) {\r\n            if (e.key !== 'Enter' && e.key !== ' ') {\r\n                return;\r\n            }\r\n        }\r\n        Utils.handleFormattedTextClick(e, currentRelativeTeamUrl);\r\n    }, [currentRelativeTeamUrl]);\r\n\r\n    if (!thread || !post) {\r\n        return null;\r\n    }\r\n\r\n    const {\r\n        unread_replies: newReplies,\r\n        unread_mentions: newMentions,\r\n        last_reply_at: lastReplyAt,\r\n        reply_count: totalReplies,\r\n        is_following: isFollowing,\r\n    } = thread;\r\n\r\n    // if we have the whole thread, get the posts in it, sorted from newest to oldest.\r\n    // First post is latest reply. Use that timestamp\r\n    if (postsInThread && postsInThread.length > 1) {\r\n        const p = postsInThread[0];\r\n        unreadTimestamp = p.edit_at || p.create_at;\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <div\r\n                style={style}\r\n                className={classNames('ThreadItem', {\r\n                    'has-unreads': newReplies,\r\n                    'is-selected': isSelected,\r\n                })}\r\n                tabIndex={isSelected ? -1 : 0}\r\n                role='link'\r\n                aria-label={formatMessage(\r\n                    {id: 'threading.threadItem.ariaLabel', defaultMessage: 'Thread by {author}'},\r\n                    {author: postAuthor},\r\n                )}\r\n                aria-describedby={`ThreadItem__timestamp_${threadId}`}\r\n                id={isFirstThreadInList ? 'tutorial-threads-mobile-list' : ''}\r\n                onClick={selectHandler}\r\n                onKeyDown={selectHandler}\r\n                ref={ref}\r\n            >\r\n                <div className='thread-item-header'>\r\n                    {Boolean(newMentions || newReplies) && (\r\n                        <div className='indicator'>\r\n                            {newMentions ? (\r\n                                <div className={classNames('dot-mentions', {over: newMentions > 99})}>\r\n                                    {Math.min(newMentions, 99)}\r\n                                    {newMentions > 99 && '+'}\r\n                                </div>\r\n                            ) : (\r\n                                <div className='dot-unreads'/>\r\n                            )}\r\n                        </div>\r\n                    )}\r\n                    <div className='ThreadItem__author'>{postAuthor}</div>\r\n                    <div className='ThreadItem__tags'>\r\n                        {channel && postAuthor !== channel?.display_name && (\r\n                            <Tag\r\n                                onClick={goToInChannelHandler}\r\n                                text={channel?.display_name}\r\n                            />\r\n                        )}\r\n                        {isPostPriorityEnabled && (\r\n                            thread.is_urgent && (\r\n                                <PriorityBadge\r\n                                    className={postAuthor === channel?.display_name ? 'ml-2' : ''}\r\n                                    priority={PostPriority.URGENT}\r\n                                />\r\n                            )\r\n                        )}\r\n                    </div>\r\n                    <Timestamp\r\n                        {...THREADING_TIME}\r\n                        className='alt-hidden'\r\n                        value={lastReplyAt}\r\n                    />\r\n                </div>\r\n                <div className='menu-anchor alt-visible'>\r\n                    <ThreadMenu\r\n                        threadId={threadId}\r\n                        isFollowing={isFollowing ?? false}\r\n                        hasUnreads={Boolean(newReplies)}\r\n                        unreadTimestamp={unreadTimestamp ?? 0}\r\n                    >\r\n                        <WithTooltip\r\n                            title={(\r\n                                <FormattedMessage\r\n                                    id='threading.threadItem.menu'\r\n                                    defaultMessage='Actions'\r\n                                />\r\n                            )}\r\n                        >\r\n                            <Button\r\n                                marginTop={true}\r\n                                className='Button___icon'\r\n                                aria-label={formatMessage({\r\n                                    id: 'threading.threadItem.menu',\r\n                                    defaultMessage: 'Actions',\r\n                                })}\r\n                            >\r\n                                <DotsVerticalIcon size={18}/>\r\n                            </Button>\r\n                        </WithTooltip>\r\n                    </ThreadMenu>\r\n                </div>\r\n\r\n                {/* The strange interaction here where we need a click/keydown handler messes with the ESLint rules, so we just disable it */}\r\n                {/*eslint-disable-next-line jsx-a11y/no-static-element-interactions*/}\r\n                <div\r\n                    className='preview'\r\n                    dir='auto'\r\n                    onClick={handleFormattedTextClick}\r\n                    onKeyDown={handleFormattedTextClick}\r\n                >\r\n                    {post.message ? (\r\n                        <Markdown\r\n                            message={post.state === Posts.POST_DELETED ? msgDeleted : post.message}\r\n                            options={markdownPreviewOptions}\r\n                            imagesMetadata={post?.metadata && post?.metadata?.images}\r\n                            mentionKeys={mentionsKeys}\r\n                            imageProps={imageProps}\r\n                        />\r\n                    ) : (\r\n                        <Attachment post={post}/>\r\n                    )}\r\n                </div>\r\n                <div className='activity'>\r\n                    {participantIds?.length ? (\r\n                        <Avatars\r\n                            userIds={participantIds}\r\n                            size='xs'\r\n                        />\r\n                    ) : null}\r\n                    {Boolean(totalReplies) && (\r\n                        <>\r\n                            {newReplies ? (\r\n                                <FormattedMessage\r\n                                    id='threading.numNewReplies'\r\n                                    defaultMessage='{newReplies, plural, =1 {# new reply} other {# new replies}}'\r\n                                    values={{newReplies}}\r\n                                />\r\n                            ) : (\r\n                                <FormattedMessage\r\n                                    id='threading.numReplies'\r\n                                    defaultMessage='{totalReplies, plural, =0 {Reply} =1 {# reply} other {# replies}}'\r\n                                    values={{totalReplies}}\r\n                                />\r\n                            )}\r\n                        </>\r\n                    )}\r\n                </div>\r\n                <span\r\n                    className='sr-only'\r\n                    id={`ThreadItem__timestamp_${threadId}`}\r\n                >\r\n                    <FormattedMessage\r\n                        id='threading.threadItem.timestamp'\r\n                        defaultMessage='Last reply '\r\n                    />\r\n                    <Timestamp\r\n                        {...THREADING_TIME}\r\n                        value={lastReplyAt}\r\n                    />\r\n                </span>\r\n            </div>\r\n        </>\r\n    );\r\n}\r\n\r\nexport default memo(ThreadItem);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\n\r\nimport {makeGetChannel} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getPost, isPostPriorityEnabled, makeGetPostsForThread} from 'mattermost-redux/selectors/entities/posts';\r\nimport {getCurrentRelativeTeamUrl} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getThread} from 'mattermost-redux/selectors/entities/threads';\r\nimport {makeGetDisplayName} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport ThreadItem from './thread_item';\r\nimport type {OwnProps} from './thread_item';\r\n\r\nfunction makeMapStateToProps() {\r\n    const getPostsForThread = makeGetPostsForThread();\r\n    const getChannel = makeGetChannel();\r\n    const getDisplayName = makeGetDisplayName();\r\n\r\n    return (state: GlobalState, ownProps: OwnProps) => {\r\n        const {threadId} = ownProps;\r\n\r\n        const post = getPost(state, threadId);\r\n\r\n        if (!post) {\r\n            return {};\r\n        }\r\n\r\n        return {\r\n            post,\r\n            channel: getChannel(state, post.channel_id),\r\n            currentRelativeTeamUrl: getCurrentRelativeTeamUrl(state),\r\n            displayName: getDisplayName(state, post.user_id, true),\r\n            postsInThread: getPostsForThread(state, post.id),\r\n            thread: getThread(state, threadId),\r\n            isPostPriorityEnabled: isPostPriorityEnabled(state),\r\n        };\r\n    };\r\n}\r\n\r\nexport default connect(makeMapStateToProps)(ThreadItem);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {memo} from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\nimport {areEqual} from 'react-window';\r\n\r\nimport type {UserThread} from '@mattermost/types/threads';\r\n\r\nimport SearchHintSVG from 'components/common/svg_images_components/search_hint_svg';\r\nimport LoadingScreen from 'components/loading_screen';\r\nimport NoResultsIndicator from 'components/no_results_indicator';\r\nimport {NoResultsLayout} from 'components/no_results_indicator/types';\r\nimport {SearchShortcut} from 'components/search_shortcut/search_shortcut';\r\nimport {ShortcutKeyVariant} from 'components/shortcut_key';\r\n\r\nimport {Constants} from 'utils/constants';\r\n\r\nimport ThreadItem from '../thread_item';\r\n\r\ntype Props = {\r\n    data: {\r\n        ids: Array<UserThread['id']>;\r\n        selectedThreadId?: UserThread['id'];\r\n    };\r\n    index: number;\r\n    style: any;\r\n};\r\n\r\nfunction Row({index, style, data}: Props) {\r\n    const itemId = data.ids[index];\r\n    const isSelected = data.selectedThreadId === itemId;\r\n\r\n    if (itemId === Constants.THREADS_LOADING_INDICATOR_ITEM_ID) {\r\n        return (\r\n            <LoadingScreen\r\n                message={<></>}\r\n                style={style}\r\n            />\r\n        );\r\n    }\r\n\r\n    if (itemId === Constants.THREADS_NO_RESULTS_ITEM_ID) {\r\n        return (\r\n            <NoResultsIndicator\r\n                style={{...style, padding: '16px 16px 16px 24px', background: 'rgba(var(--center-channel-color-rgb), 0.04)'}}\r\n                iconGraphic={<SearchHintSVG/>}\r\n                title={\r\n                    <FormattedMessage\r\n                        id='globalThreads.searchGuidance.title'\r\n                        defaultMessage='Thats the end of the list'\r\n                    />\r\n                }\r\n                subtitle={\r\n                    <FormattedMessage\r\n                        id='globalThreads.searchGuidance.subtitle'\r\n                        defaultMessage='If youre looking for older conversations, try searching with {searchShortcut}'\r\n                        values={{\r\n                            searchShortcut: (\r\n                                <SearchShortcut\r\n                                    className='thread-no-results-subtitle-shortcut'\r\n                                    variant={ShortcutKeyVariant.TutorialTip}\r\n                                />\r\n                            ),\r\n                        }}\r\n                    />\r\n                }\r\n                titleClassName='thread-no-results-title'\r\n                subtitleClassName='thread-no-results-subtitle'\r\n                layout={NoResultsLayout.Horizontal}\r\n            />\r\n        );\r\n    }\r\n\r\n    return (\r\n        <ThreadItem\r\n            isSelected={isSelected}\r\n            key={itemId}\r\n            style={style}\r\n            threadId={itemId}\r\n            isFirstThreadInList={index === 0}\r\n        />\r\n    );\r\n}\r\n\r\nexport default memo(Row, areEqual);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {memo, useCallback, useEffect, useMemo} from 'react';\r\nimport AutoSizer from 'react-virtualized-auto-sizer';\r\nimport {FixedSizeList} from 'react-window';\r\nimport InfiniteLoader from 'react-window-infinite-loader';\r\n\r\nimport type {UserThread} from '@mattermost/types/threads';\r\n\r\nimport ThreadsConstants from 'mattermost-redux/constants/threads';\r\n\r\nimport {Constants} from 'utils/constants';\r\n\r\nimport Row from './virtualized_thread_list_row';\r\n\r\ntype ThreadData = {\r\n    ids: string[];\r\n    selectedThreadId: string | undefined;\r\n};\r\n\r\ntype Props = {\r\n    ids: Array<UserThread['id']>;\r\n    loadMoreItems: (startIndex: number, stopIndex: number) => Promise<any>;\r\n    selectedThreadId?: UserThread['id'];\r\n    total: number;\r\n    isLoading?: boolean;\r\n    addNoMoreResultsItem?: boolean;\r\n};\r\n\r\nconst style = {\r\n    willChange: 'auto',\r\n};\r\n\r\nfunction VirtualizedThreadList({\r\n    ids,\r\n    selectedThreadId,\r\n    loadMoreItems,\r\n    total,\r\n    isLoading,\r\n    addNoMoreResultsItem,\r\n}: Props) {\r\n    const infiniteLoaderRef = React.useRef<any>();\r\n    const startIndexRef = React.useRef<number>(0);\r\n    const stopIndexRef = React.useRef<number>(0);\r\n\r\n    useEffect(() => {\r\n        if (ids.length > 0 && selectedThreadId) {\r\n            const index = ids.indexOf(selectedThreadId);\r\n            if (startIndexRef.current >= index || index > stopIndexRef.current) {\r\n                // eslint-disable-next-line no-underscore-dangle\r\n                infiniteLoaderRef.current?._listRef.scrollToItem(index);\r\n            }\r\n        }\r\n\r\n        // ids should not be on the dependency list as\r\n        // it will auto scroll to selected item upon\r\n        // infinite loading\r\n        // when the selectedThreadId changes it will get\r\n        // the new ids so no issue there\r\n    }, [selectedThreadId]);\r\n\r\n    const data: ThreadData = useMemo(\r\n        () => (\r\n            {\r\n                ids: addNoMoreResultsItem && ids.length === total ? [...ids, Constants.THREADS_NO_RESULTS_ITEM_ID] : (isLoading && ids.length !== total && [...ids, Constants.THREADS_LOADING_INDICATOR_ITEM_ID]) || ids,\r\n                selectedThreadId,\r\n            }\r\n        ),\r\n        [ids, selectedThreadId, isLoading, addNoMoreResultsItem, total],\r\n    );\r\n\r\n    const itemKey = useCallback((index: number, data: ThreadData) => data.ids[index], []);\r\n\r\n    const isItemLoaded = useCallback((index: number) => {\r\n        return ids.length === total || index < ids.length;\r\n    }, [ids, total]);\r\n\r\n    return (\r\n        <AutoSizer>\r\n            {({height, width}) => (\r\n                <InfiniteLoader\r\n                    ref={infiniteLoaderRef}\r\n                    itemCount={total}\r\n                    loadMoreItems={loadMoreItems}\r\n                    isItemLoaded={isItemLoaded}\r\n                    minimumBatchSize={ThreadsConstants.THREADS_PAGE_SIZE}\r\n                >\r\n                    {({onItemsRendered, ref}) => {\r\n                        return (\r\n                            <FixedSizeList\r\n                                onItemsRendered={({\r\n                                    overscanStartIndex,\r\n                                    overscanStopIndex,\r\n                                    visibleStartIndex,\r\n                                    visibleStopIndex,\r\n                                }) => {\r\n                                    onItemsRendered({\r\n                                        overscanStartIndex,\r\n                                        overscanStopIndex,\r\n                                        visibleStartIndex,\r\n                                        visibleStopIndex,\r\n                                    });\r\n                                    startIndexRef.current = visibleStartIndex;\r\n                                    stopIndexRef.current = visibleStopIndex;\r\n                                }}\r\n                                ref={ref}\r\n                                height={height}\r\n                                itemCount={data.ids.length}\r\n                                itemData={data}\r\n                                itemKey={itemKey}\r\n                                itemSize={133}\r\n                                style={style}\r\n                                width={width}\r\n                                className='virtualized-thread-list'\r\n                            >\r\n                                {Row}\r\n                            </FixedSizeList>\r\n                        );\r\n                    }\r\n                    }\r\n                </InfiniteLoader>\r\n            )}\r\n        </AutoSizer>\r\n    );\r\n}\r\n\r\nfunction areEqual(prevProps: Props, nextProps: Props) {\r\n    return (\r\n        prevProps.selectedThreadId === nextProps.selectedThreadId &&\r\n        prevProps.ids.join() === nextProps.ids.join() &&\r\n        prevProps.isLoading === nextProps.isLoading &&\r\n        prevProps.addNoMoreResultsItem === nextProps.addNoMoreResultsItem\r\n    );\r\n}\r\n\r\nexport default memo(VirtualizedThreadList, areEqual);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nimport {GenericModal} from '@mattermost/components';\r\n\r\nimport './mark_all_threads_as_read_modal.scss';\r\n\r\nexport type MarkAllThreadsAsReadModalProps = {\r\n    onConfirm: () => void;\r\n    onCancel: () => void;\r\n}\r\n\r\nfunction MarkAllThreadsAsReadModal({\r\n    onConfirm,\r\n    onCancel,\r\n}: MarkAllThreadsAsReadModalProps) {\r\n    const {formatMessage} = useIntl();\r\n\r\n    return (\r\n        <GenericModal\r\n            className='mark-all-threads-as-read'\r\n            id='mark-all-threads-as-read-modal'\r\n            compassDesign={true}\r\n            modalHeaderText={formatMessage({\r\n                id: 'mark_all_threads_as_read_modal.title',\r\n                defaultMessage: 'Mark all your threads as read?',\r\n            })}\r\n            confirmButtonText={formatMessage({\r\n                id: 'mark_all_threads_as_read_modal.confirm',\r\n                defaultMessage: 'Mark all as read',\r\n            })}\r\n            cancelButtonText={formatMessage({\r\n                id: 'mark_all_threads_as_read_modal.cancel',\r\n                defaultMessage: 'Cancel',\r\n            })}\r\n            onExited={onCancel}\r\n            handleCancel={onCancel}\r\n            handleConfirm={onConfirm}\r\n        >\r\n            <div className='mark_all_threads_as_read_modal__body'>\r\n                <span>\r\n                    {formatMessage({\r\n                        id: 'mark_all_threads_as_read_modal.description',\r\n                        defaultMessage: 'This will clear the unread state and mention badges on all your threads. Are you sure?',\r\n                    })}\r\n                </span>\r\n            </div>\r\n        </GenericModal>\r\n    );\r\n}\r\n\r\nexport default MarkAllThreadsAsReadModal;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport isEmpty from 'lodash/isEmpty';\r\nimport React, {memo, useCallback, useEffect} from 'react';\r\nimport type {PropsWithChildren} from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\n\r\nimport {PlaylistCheckIcon} from '@mattermost/compass-icons/components';\r\nimport type {UserThread} from '@mattermost/types/threads';\r\n\r\nimport {getThreadsForCurrentTeam, markAllThreadsInTeamRead} from 'mattermost-redux/actions/threads';\r\nimport {getThreadCountsInCurrentTeam} from 'mattermost-redux/selectors/entities/threads';\r\n\r\nimport {closeModal, openModal} from 'actions/views/modals';\r\n\r\nimport NoResultsIndicator from 'components/no_results_indicator';\r\nimport Header from 'components/widgets/header';\r\nimport WithTooltip from 'components/with_tooltip';\r\n\r\nimport {A11yClassNames, Constants, ModalIdentifiers} from 'utils/constants';\r\nimport * as Keyboard from 'utils/keyboard';\r\nimport {a11yFocus, mod} from 'utils/utils';\r\n\r\nimport VirtualizedThreadList from './virtualized_thread_list';\r\n\r\nimport Button from '../../common/button';\r\nimport {useThreadRouting} from '../../hooks';\r\nimport MarkAllThreadsAsReadModal from '../mark_all_threads_as_read_modal';\r\nimport type {MarkAllThreadsAsReadModalProps} from '../mark_all_threads_as_read_modal';\r\n\r\nimport './thread_list.scss';\r\n\r\nexport enum ThreadFilter {\r\n    none = '',\r\n    unread = 'unread'\r\n}\r\n\r\nexport const FILTER_STORAGE_KEY = 'globalThreads_filter';\r\n\r\ntype Props = {\r\n    currentFilter: ThreadFilter;\r\n    someUnread: boolean;\r\n    setFilter: (filter: ThreadFilter) => void;\r\n    selectedThreadId?: UserThread['id'];\r\n    ids: Array<UserThread['id']>;\r\n    unreadIds: Array<UserThread['id']>;\r\n};\r\n\r\nconst ThreadList = ({\r\n    currentFilter = ThreadFilter.none,\r\n    someUnread,\r\n    setFilter,\r\n    selectedThreadId,\r\n    unreadIds,\r\n    ids,\r\n}: PropsWithChildren<Props>) => {\r\n    const unread = ThreadFilter.unread === currentFilter;\r\n    const data = unread ? unreadIds : ids;\r\n    const ref = React.useRef<HTMLDivElement>(null);\r\n    const {currentTeamId, currentUserId, clear, select} = useThreadRouting();\r\n    const {formatMessage} = useIntl();\r\n    const dispatch = useDispatch();\r\n\r\n    const {total = 0, total_unread_threads: totalUnread} = useSelector(getThreadCountsInCurrentTeam) ?? {};\r\n\r\n    const [isLoading, setLoading] = React.useState<boolean>(false);\r\n    const [hasLoaded, setHasLoaded] = React.useState<boolean>(false);\r\n\r\n    const handleKeyDown = useCallback((e: KeyboardEvent) => {\r\n        // Ensure that arrow keys navigation is not triggered if the textbox is focused\r\n        const target = e.target as HTMLElement;\r\n        const tagName = target?.tagName?.toLowerCase();\r\n        if (tagName === 'input' || tagName === 'textarea' || tagName === 'select') {\r\n            return;\r\n        }\r\n        const comboKeyPressed = e.altKey || e.metaKey || e.shiftKey || e.ctrlKey;\r\n        if (comboKeyPressed || (!Keyboard.isKeyPressed(e, Constants.KeyCodes.DOWN) && !Keyboard.isKeyPressed(e, Constants.KeyCodes.UP))) {\r\n            return;\r\n        }\r\n\r\n        // Don't switch threads if a modal or popup is open, since the focus is inside the modal/popup.\r\n        const noModalsAreOpen = document.getElementsByClassName(A11yClassNames.MODAL).length === 0;\r\n        const noPopupsDropdownsAreOpen = document.getElementsByClassName(A11yClassNames.POPUP).length === 0;\r\n        if (!noModalsAreOpen || !noPopupsDropdownsAreOpen) {\r\n            return;\r\n        }\r\n\r\n        let threadIdToSelect = 0;\r\n        if (selectedThreadId) {\r\n            const selectedThreadIndex = data.indexOf(selectedThreadId);\r\n            if (Keyboard.isKeyPressed(e, Constants.KeyCodes.DOWN)) {\r\n                if (selectedThreadIndex < data.length - 1) {\r\n                    threadIdToSelect = selectedThreadIndex + 1;\r\n                }\r\n\r\n                if (selectedThreadIndex === data.length - 1) {\r\n                    return;\r\n                }\r\n            }\r\n\r\n            if (Keyboard.isKeyPressed(e, Constants.KeyCodes.UP)) {\r\n                if (selectedThreadIndex > 0) {\r\n                    threadIdToSelect = selectedThreadIndex - 1;\r\n                } else {\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n        select(data[threadIdToSelect]);\r\n        e.preventDefault();\r\n    }, [selectedThreadId, data]);\r\n\r\n    useEffect(() => {\r\n        document.addEventListener('keydown', handleKeyDown);\r\n        return () => {\r\n            document.removeEventListener('keydown', handleKeyDown);\r\n        };\r\n    }, [handleKeyDown]);\r\n\r\n    const handleLoadMoreItems = useCallback(async (startIndex: number) => {\r\n        setLoading(true);\r\n        let before = data[startIndex - 1];\r\n\r\n        if (before === selectedThreadId) {\r\n            before = data[startIndex - 2];\r\n        }\r\n\r\n        await dispatch(getThreadsForCurrentTeam({unread, before}));\r\n\r\n        setLoading(false);\r\n        setHasLoaded(true);\r\n\r\n        return {data: true};\r\n    }, [currentTeamId, data, unread, selectedThreadId]);\r\n\r\n    const handleAllMarkedRead = useCallback(() => {\r\n        dispatch(markAllThreadsInTeamRead(currentUserId, currentTeamId));\r\n        if (currentFilter === ThreadFilter.unread) {\r\n            clear();\r\n        }\r\n    }, [currentTeamId, currentUserId, currentFilter]);\r\n\r\n    const handleOpenMarkAllAsReadModal = useCallback(() => {\r\n        const handleCloseMarkAllAsReadModal = () => {\r\n            dispatch(closeModal(ModalIdentifiers.MARK_ALL_THREADS_AS_READ));\r\n        };\r\n\r\n        const handleConfirm = () => {\r\n            handleAllMarkedRead();\r\n            handleCloseMarkAllAsReadModal();\r\n        };\r\n\r\n        const modalProp: MarkAllThreadsAsReadModalProps = {\r\n            onConfirm: handleConfirm,\r\n            onCancel: handleCloseMarkAllAsReadModal,\r\n        };\r\n\r\n        dispatch(openModal({\r\n            modalId: ModalIdentifiers.MARK_ALL_THREADS_AS_READ,\r\n            dialogType: MarkAllThreadsAsReadModal,\r\n            dialogProps: modalProp,\r\n        }));\r\n    }, [handleAllMarkedRead]);\r\n\r\n    const {tabListProps, tabProps} = useTabs<ThreadFilter>({\r\n        activeTab: currentFilter,\r\n        setActiveTab: setFilter,\r\n        tabs: [\r\n            {\r\n                id: 'threads-list-filter-none',\r\n                name: ThreadFilter.none,\r\n                panelId: 'threads-list',\r\n            },\r\n            {\r\n                id: 'threads-list-filter-unread',\r\n                name: ThreadFilter.unread,\r\n                panelId: 'threads-list',\r\n            },\r\n        ],\r\n    });\r\n\r\n    return (\r\n        <div\r\n            tabIndex={0}\r\n            ref={ref}\r\n            className={'ThreadList'}\r\n            id={'threads-list-container'}\r\n        >\r\n            <Header\r\n                id={'tutorial-threads-mobile-header'}\r\n                heading={(\r\n                    <div\r\n                        className='tab-buttons-list'\r\n                        aria-label={formatMessage({\r\n                            id: 'threading.threadList.tabsLabel',\r\n                            defaultMessage: 'Filter visible threads',\r\n                        })}\r\n                        {...tabListProps}\r\n                    >\r\n                        <div className={'tab-button-wrapper'}>\r\n                            <Button\r\n                                className={'Button___large Margined'}\r\n                                isActive={currentFilter === ThreadFilter.none}\r\n                                {...tabProps[0]}\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='globalThreads.heading'\r\n                                    defaultMessage='Followed threads'\r\n                                />\r\n                            </Button>\r\n                        </div>\r\n                        <div\r\n                            id={'threads-list-unread-button'}\r\n                            className={'tab-button-wrapper'}\r\n                        >\r\n                            <Button\r\n                                className={'Button___large Margined'}\r\n                                isActive={currentFilter === ThreadFilter.unread}\r\n                                hasDot={someUnread}\r\n                                {...tabProps[1]}\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='threading.filters.unreads'\r\n                                    defaultMessage='Unreads'\r\n                                />\r\n                            </Button>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n                right={(\r\n                    <div className='right-anchor'>\r\n                        <WithTooltip\r\n                            title={formatMessage({\r\n                                id: 'threading.threadList.markRead',\r\n                                defaultMessage: 'Mark all threads as read',\r\n                            })}\r\n                        >\r\n                            <Button\r\n                                id={'threads-list__mark-all-as-read'}\r\n                                aria-label={formatMessage({\r\n                                    id: 'threading.threadList.markRead',\r\n                                    defaultMessage: 'Mark all threads as read',\r\n                                })}\r\n                                className={'Button___large Button___icon'}\r\n                                onClick={handleOpenMarkAllAsReadModal}\r\n                                marginTop={true}\r\n                            >\r\n                                <span className='icon'>\r\n                                    <PlaylistCheckIcon size={18}/>\r\n                                </span>\r\n                            </Button>\r\n                        </WithTooltip>\r\n                    </div>\r\n                )}\r\n            />\r\n            <div\r\n                id='threads-list'\r\n                role='tabpanel'\r\n                className='threads'\r\n                data-testid={'threads_list'}\r\n            >\r\n                <VirtualizedThreadList\r\n                    key={`threads_list_${currentFilter}`}\r\n                    loadMoreItems={handleLoadMoreItems}\r\n                    ids={data}\r\n                    selectedThreadId={selectedThreadId}\r\n                    total={unread ? totalUnread : total}\r\n                    isLoading={isLoading}\r\n                    addNoMoreResultsItem={hasLoaded && !unread}\r\n                />\r\n                {unread && !someUnread && isEmpty(unreadIds) ? (\r\n                    <NoResultsIndicator\r\n                        expanded={true}\r\n                        title={formatMessage({\r\n                            id: 'globalThreads.threadList.noUnreadThreads',\r\n                            defaultMessage: 'No unread threads',\r\n                        })}\r\n                        subtitle={formatMessage({\r\n                            id: 'globalThreads.threadList.noUnreadThreads.subtitle',\r\n                            defaultMessage: 'You\\'re all caught up',\r\n                        })}\r\n                    />\r\n                ) : null}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nfunction useTabs<TabName extends string>({\r\n    activeTab,\r\n    setActiveTab,\r\n    tabs,\r\n}: {\r\n    activeTab: TabName;\r\n    setActiveTab: (tab: TabName) => void;\r\n    tabs: Array<{\r\n        id: string;\r\n        name: TabName;\r\n        panelId: string;\r\n    }>;\r\n}): {\r\n        tabListProps: React.HTMLAttributes<HTMLElement>;\r\n        tabProps: Array<React.HTMLAttributes<HTMLElement>>;\r\n    } {\r\n    const handleKeyDown = useCallback((e: React.KeyboardEvent) => {\r\n        let delta = 0;\r\n        if (Keyboard.isKeyPressed(e, Constants.KeyCodes.RIGHT)) {\r\n            delta = 1;\r\n        } else if (Keyboard.isKeyPressed(e, Constants.KeyCodes.LEFT)) {\r\n            delta = -1;\r\n        }\r\n\r\n        if (delta === 0) {\r\n            return;\r\n        }\r\n\r\n        let index = tabs.findIndex((tab) => tab.name === activeTab);\r\n        index += delta;\r\n        index = mod(index, tabs.length);\r\n\r\n        setActiveTab(tabs[index].name);\r\n        a11yFocus(document.getElementById(tabs[index].id));\r\n    }, [activeTab, setActiveTab, tabs]);\r\n\r\n    return {\r\n        tabListProps: {\r\n            role: 'tablist',\r\n            'aria-orientation': 'horizontal',\r\n        },\r\n        tabProps: tabs.map((tab) => ({\r\n            id: tab.id,\r\n            role: 'tab',\r\n            onClick: () => setActiveTab(tab.name),\r\n            onKeyDown: handleKeyDown,\r\n            tabIndex: tab.name === activeTab ? 0 : -1,\r\n            'aria-controls': tab.panelId,\r\n            'aria-selected': activeTab === tab.name,\r\n        })),\r\n    };\r\n}\r\n\r\nexport default memo(ThreadList);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport isEmpty from 'lodash/isEmpty';\r\nimport React, {memo, useCallback, useEffect, useState} from 'react';\r\nimport type {ReactNode} from 'react';\r\nimport {useIntl} from 'react-intl';\r\nimport {useSelector, useDispatch, shallowEqual} from 'react-redux';\r\nimport {Link, useRouteMatch} from 'react-router-dom';\r\n\r\nimport {getThreadCounts, getThreadsForCurrentTeam} from 'mattermost-redux/actions/threads';\r\nimport {getPost} from 'mattermost-redux/selectors/entities/posts';\r\nimport {\r\n    getThreadOrderInCurrentTeam,\r\n    getUnreadThreadOrderInCurrentTeam,\r\n    getThreadCountsInCurrentTeam,\r\n    getThread,\r\n} from 'mattermost-redux/selectors/entities/threads';\r\n\r\nimport {clearLastUnreadChannel} from 'actions/global_actions';\r\nimport {loadProfilesForSidebar} from 'actions/user_actions';\r\nimport {selectLhsItem} from 'actions/views/lhs';\r\nimport {suppressRHS, unsuppressRHS} from 'actions/views/rhs';\r\nimport {setSelectedThreadId} from 'actions/views/threads';\r\nimport {getRhsState} from 'selectors/rhs';\r\nimport {getSelectedThreadIdInCurrentTeam} from 'selectors/views/threads';\r\nimport {useGlobalState} from 'stores/hooks';\r\nimport LocalStorageStore from 'stores/local_storage_store';\r\n\r\nimport ChatIllustration from 'components/common/svg_images_components/chat_illustration';\r\nimport LoadingScreen from 'components/loading_screen';\r\nimport NoResultsIndicator from 'components/no_results_indicator';\r\n\r\nimport {PreviousViewedTypes, RHSStates} from 'utils/constants';\r\nimport {Mark, Measure, measureAndReport} from 'utils/performance_telemetry';\r\n\r\nimport type {GlobalState} from 'types/store/index';\r\nimport {LhsItemType, LhsPage} from 'types/store/lhs';\r\n\r\nimport ThreadList, {ThreadFilter, FILTER_STORAGE_KEY} from './thread_list';\r\nimport ThreadPane from './thread_pane';\r\n\r\nimport {useThreadRouting} from '../hooks';\r\nimport ThreadViewer from '../thread_viewer';\r\n\r\nimport './global_threads.scss';\r\n\r\nconst GlobalThreads = () => {\r\n    const {formatMessage} = useIntl();\r\n    const dispatch = useDispatch();\r\n\r\n    const {url, params: {threadIdentifier}} = useRouteMatch<{threadIdentifier?: string}>();\r\n    const [filter, setFilter] = useGlobalState(ThreadFilter.none, FILTER_STORAGE_KEY);\r\n    const {currentTeamId, currentUserId, clear} = useThreadRouting();\r\n\r\n    const counts = useSelector(getThreadCountsInCurrentTeam);\r\n    const selectedThread = useSelector((state: GlobalState) => getThread(state, threadIdentifier));\r\n    const selectedThreadId = useSelector(getSelectedThreadIdInCurrentTeam);\r\n    const selectedPost = useSelector((state: GlobalState) => getPost(state, threadIdentifier!));\r\n    const threadIds = useSelector((state: GlobalState) => getThreadOrderInCurrentTeam(state), shallowEqual);\r\n    const unreadThreadIds = useSelector((state: GlobalState) => getUnreadThreadOrderInCurrentTeam(state), shallowEqual);\r\n    const numUnread = counts?.total_unread_threads || 0;\r\n    const rhsState = useSelector(getRhsState);\r\n\r\n    useEffect(() => {\r\n        // If RHS is not any one of the below then suppress it when navigating to global threads\r\n        if (!(\r\n            rhsState === RHSStates.MENTION ||\r\n            rhsState === RHSStates.SEARCH ||\r\n            rhsState === RHSStates.FLAG)\r\n        ) {\r\n            dispatch(suppressRHS);\r\n        }\r\n\r\n        dispatch(selectLhsItem(LhsItemType.Page, LhsPage.Threads));\r\n        dispatch(clearLastUnreadChannel);\r\n        loadProfilesForSidebar();\r\n\r\n        const penultimateType = LocalStorageStore.getPreviousViewedType(currentUserId, currentTeamId);\r\n\r\n        if (penultimateType !== PreviousViewedTypes.THREADS) {\r\n            LocalStorageStore.setPenultimateViewedType(currentUserId, currentTeamId, penultimateType);\r\n            LocalStorageStore.setPreviousViewedType(currentUserId, currentTeamId, PreviousViewedTypes.THREADS);\r\n        }\r\n\r\n        // unsuppresses RHS on navigating away (unmount)\r\n        return () => {\r\n            dispatch(unsuppressRHS);\r\n        };\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        dispatch(getThreadCounts(currentUserId, currentTeamId));\r\n    }, [currentTeamId, currentUserId]);\r\n\r\n    useEffect(() => {\r\n        if (!selectedThreadId || selectedThreadId !== threadIdentifier) {\r\n            dispatch(setSelectedThreadId(currentTeamId, selectedThread?.id));\r\n        }\r\n    }, [currentTeamId, selectedThreadId, threadIdentifier]);\r\n\r\n    const isEmptyList = isEmpty(threadIds) && isEmpty(unreadThreadIds);\r\n\r\n    const [isLoading, setLoading] = useState(isEmptyList);\r\n\r\n    const shouldLoadThreads = isEmpty(threadIds);\r\n    const shouldLoadUnreadThreads = isEmpty(unreadThreadIds);\r\n\r\n    useEffect(() => {\r\n        const promises = [];\r\n\r\n        // this is needed to jump start threads fetching\r\n        if (shouldLoadThreads) {\r\n            promises.push(dispatch(getThreadsForCurrentTeam({unread: false})));\r\n        }\r\n\r\n        if (filter === ThreadFilter.unread && shouldLoadUnreadThreads) {\r\n            promises.push(dispatch(getThreadsForCurrentTeam({unread: true})));\r\n        }\r\n\r\n        Promise.all(promises).then(() => {\r\n            setLoading(false);\r\n        });\r\n    }, [filter, threadIds, unreadThreadIds]);\r\n\r\n    useEffect(() => {\r\n        if (!isLoading) {\r\n            measureAndReport({\r\n                name: Measure.GlobalThreadsLoad,\r\n                startMark: Mark.GlobalThreadsLinkClicked,\r\n                canFail: true,\r\n            });\r\n            performance.clearMarks(Mark.GlobalThreadsLinkClicked);\r\n        }\r\n    }, [isLoading]);\r\n\r\n    useEffect(() => {\r\n        if (!selectedThread && !selectedPost && !isLoading) {\r\n            clear();\r\n        }\r\n    }, [currentTeamId, selectedThread, selectedPost, isLoading, counts, filter]);\r\n\r\n    // cleanup on unmount\r\n    useEffect(() => {\r\n        return () => {\r\n            dispatch(setSelectedThreadId(currentTeamId, ''));\r\n        };\r\n    }, []);\r\n\r\n    const handleSelectUnread = useCallback(() => {\r\n        setFilter(ThreadFilter.unread);\r\n    }, []);\r\n\r\n    return (\r\n        <div\r\n            id='app-content'\r\n            className={classNames('GlobalThreads app__content', {'thread-selected': Boolean(selectedThread)})}\r\n        >\r\n            {isLoading || isEmptyList ? (\r\n                <div className='no-results__holder'>\r\n                    {isLoading ? (\r\n                        <LoadingScreen/>\r\n                    ) : (\r\n                        <NoResultsIndicator\r\n                            expanded={true}\r\n                            iconGraphic={ChatIllustration}\r\n                            title={formatMessage({\r\n                                id: 'globalThreads.noThreads.title',\r\n                                defaultMessage: 'No followed threads yet',\r\n                            })}\r\n                            subtitle={formatMessage({\r\n                                id: 'globalThreads.noThreads.subtitle',\r\n                                defaultMessage: 'Any threads you are mentioned in or have participated in will show here along with any threads you have followed.',\r\n                            })}\r\n                        />\r\n                    )}\r\n                </div>\r\n            ) : (\r\n                <>\r\n                    <ThreadList\r\n                        currentFilter={filter}\r\n                        setFilter={setFilter}\r\n                        someUnread={Boolean(numUnread)}\r\n                        selectedThreadId={threadIdentifier}\r\n                        ids={threadIds}\r\n                        unreadIds={unreadThreadIds}\r\n                    />\r\n                    {selectedThread && selectedPost ? (\r\n                        <ThreadPane\r\n                            thread={selectedThread}\r\n                        >\r\n                            <ThreadViewer\r\n                                rootPostId={selectedThread.id}\r\n                                useRelativeTimestamp={true}\r\n                                isThreadView={true}\r\n                            />\r\n                        </ThreadPane>\r\n                    ) : (\r\n                        <NoResultsIndicator\r\n                            expanded={true}\r\n                            iconGraphic={ChatIllustration}\r\n                            title={formatMessage({\r\n                                id: 'globalThreads.threadPane.unselectedTitle',\r\n                                defaultMessage: '{numUnread, plural, =0 {Looks like youre all caught up} other {Catch up on your threads}}',\r\n                            }, {numUnread})}\r\n                            subtitle={formatMessage<ReactNode>({\r\n                                id: 'globalThreads.threadPane.unreadMessageLink',\r\n                                defaultMessage: 'You have {numUnread, plural, =0 {no unread threads} =1 {<link>{numUnread} thread</link>} other {<link>{numUnread} threads</link>}} {numUnread, plural, =0 {} other {with unread messages}}',\r\n                            }, {\r\n                                numUnread,\r\n                                link: (chunks) => (\r\n                                    <Link\r\n                                        key='single'\r\n                                        to={`${url}/${unreadThreadIds[0]}`}\r\n                                        onClick={handleSelectUnread}\r\n                                    >\r\n                                        {chunks}\r\n                                    </Link>\r\n                                ),\r\n                            })}\r\n                        />\r\n                    )}\r\n                </>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default memo(GlobalThreads);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {memo, useCallback} from 'react';\r\nimport type {ReactNode} from 'react';\r\nimport {useIntl} from 'react-intl';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\n\r\nimport type {UserThread} from '@mattermost/types/threads';\r\n\r\nimport {setThreadFollow, updateThreadRead, markLastPostInThreadAsUnread} from 'mattermost-redux/actions/threads';\r\nimport {isPostFlagged} from 'mattermost-redux/selectors/entities/posts';\r\n\r\nimport {\r\n    flagPost as savePost,\r\n    unflagPost as unsavePost,\r\n} from 'actions/post_actions';\r\nimport {manuallyMarkThreadAsUnread} from 'actions/views/threads';\r\n\r\nimport {focusPost} from 'components/permalink_view/actions';\r\nimport Menu from 'components/widgets/menu/menu';\r\nimport MenuWrapper from 'components/widgets/menu/menu_wrapper';\r\n\r\nimport {useReadout} from 'hooks/useReadout';\r\nimport {canPopout, popoutThread} from 'utils/popouts/popout_windows';\r\nimport {getSiteURL} from 'utils/url';\r\nimport {copyToClipboard} from 'utils/utils';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport {useThreadRouting} from '../../hooks';\r\n\r\nimport './thread_menu.scss';\r\n\r\ntype Props = {\r\n    threadId: UserThread['id'];\r\n    isFollowing?: boolean;\r\n    hasUnreads: boolean;\r\n    children: ReactNode;\r\n    unreadTimestamp: number;\r\n};\r\n\r\nfunction ThreadMenu({\r\n    threadId,\r\n    isFollowing = false,\r\n    unreadTimestamp,\r\n    hasUnreads,\r\n    children,\r\n}: Props) {\r\n    const intl = useIntl();\r\n    const {formatMessage} = intl;\r\n    const dispatch = useDispatch();\r\n    const {\r\n        params: {\r\n            team,\r\n        },\r\n        currentTeamId,\r\n        currentUserId,\r\n        goToInChannel,\r\n    } = useThreadRouting();\r\n\r\n    const isSaved = useSelector((state: GlobalState) => isPostFlagged(state, threadId));\r\n    const readAloud = useReadout();\r\n\r\n    const handleReadUnread = useCallback(() => {\r\n        readAloud(hasUnreads ? formatMessage({\r\n            id: 'threading.threadMenu.markedRead',\r\n            defaultMessage: 'Marked as read',\r\n        }) : formatMessage({\r\n            id: 'threading.threadMenu.markedUnread',\r\n            defaultMessage: 'Marked as unread',\r\n        }));\r\n        const lastViewedAt = hasUnreads ? Date.now() : unreadTimestamp;\r\n\r\n        dispatch(manuallyMarkThreadAsUnread(threadId, lastViewedAt));\r\n        if (hasUnreads) {\r\n            dispatch(updateThreadRead(currentUserId, currentTeamId, threadId, Date.now()));\r\n        } else {\r\n            dispatch(markLastPostInThreadAsUnread(currentUserId, currentTeamId, threadId));\r\n        }\r\n    }, [\r\n        currentUserId,\r\n        currentTeamId,\r\n        threadId,\r\n        hasUnreads,\r\n        updateThreadRead,\r\n        unreadTimestamp,\r\n    ]);\r\n\r\n    const popout = useCallback(() => {\r\n        popoutThread(intl, threadId, team, (postId, returnTo) => {\r\n            dispatch(focusPost(postId, returnTo, currentUserId, {skipRedirectReplyPermalink: true}));\r\n        });\r\n    }, [threadId, team, intl, dispatch, currentUserId]);\r\n\r\n    return (\r\n        <MenuWrapper\r\n            stopPropagationOnToggle={true}\r\n        >\r\n            {children}\r\n            <Menu\r\n                ariaLabel={formatMessage({\r\n                    id: 'threading.threadItem.menu',\r\n                    defaultMessage: 'Actions',\r\n                })}\r\n                openLeft={true}\r\n            >\r\n                {!canPopout() && (\r\n                    <Menu.ItemAction\r\n                        buttonClass='PopoutMenuItem'\r\n                        text={formatMessage({\r\n                            id: 'threading.threadMenu.openInNewWindow',\r\n                            defaultMessage: 'Open in new window',\r\n                        })}\r\n                        onClick={popout}\r\n                        icon={<i className='icon icon-dock-window'/>}\r\n                    />\r\n                )}\r\n                <Menu.ItemAction\r\n                    {...isFollowing ? {\r\n                        text: formatMessage({\r\n                            id: 'threading.threadMenu.unfollow',\r\n                            defaultMessage: 'Unfollow thread',\r\n                        }),\r\n                        extraText: formatMessage({\r\n                            id: 'threading.threadMenu.unfollowExtra',\r\n                            defaultMessage: 'You wont be notified about replies',\r\n                        }),\r\n                    } : {\r\n                        text: formatMessage({\r\n                            id: 'threading.threadMenu.follow',\r\n                            defaultMessage: 'Follow thread',\r\n                        }),\r\n                        extraText: formatMessage({\r\n                            id: 'threading.threadMenu.followExtra',\r\n                            defaultMessage: 'You will be notified about replies',\r\n                        }),\r\n                    }}\r\n                    onClick={useCallback(() => {\r\n                        dispatch(setThreadFollow(currentUserId, currentTeamId, threadId, !isFollowing));\r\n                        readAloud(isFollowing ? formatMessage({\r\n                            id: 'threading.threadMenu.unfollowed',\r\n                            defaultMessage: 'Unfollowed thread',\r\n                        }) : formatMessage({\r\n                            id: 'threading.threadMenu.followed',\r\n                            defaultMessage: 'Followed thread',\r\n                        }));\r\n                    }, [currentUserId, currentTeamId, threadId, isFollowing, setThreadFollow, readAloud, formatMessage])}\r\n                />\r\n                <Menu.ItemAction\r\n                    text={formatMessage({\r\n                        id: 'threading.threadMenu.openInChannel',\r\n                        defaultMessage: 'Open in channel',\r\n                    })}\r\n                    onClick={useCallback(() => {\r\n                        goToInChannel(threadId);\r\n                        readAloud(formatMessage({\r\n                            id: 'threading.threadMenu.openingChannel',\r\n                            defaultMessage: 'Opening channel',\r\n                        }));\r\n                    }, [threadId, readAloud, formatMessage])}\r\n                />\r\n                <Menu.ItemAction\r\n                    text={hasUnreads ? formatMessage({\r\n                        id: 'threading.threadMenu.markRead',\r\n                        defaultMessage: 'Mark as read',\r\n                    }) : formatMessage({\r\n                        id: 'threading.threadMenu.markUnread',\r\n                        defaultMessage: 'Mark as unread',\r\n                    })}\r\n                    onClick={handleReadUnread}\r\n                />\r\n\r\n                <Menu.ItemAction\r\n                    text={isSaved ? formatMessage({\r\n                        id: 'threading.threadMenu.unsave',\r\n                        defaultMessage: 'Unsave',\r\n                    }) : formatMessage({\r\n                        id: 'threading.threadMenu.save',\r\n                        defaultMessage: 'Save',\r\n                    })}\r\n                    onClick={useCallback(() => {\r\n                        dispatch(isSaved ? unsavePost(threadId) : savePost(threadId));\r\n                        readAloud(isSaved ? formatMessage({\r\n                            id: 'threading.threadMenu.unsaved',\r\n                            defaultMessage: 'Unsaved',\r\n                        }) : formatMessage({\r\n                            id: 'threading.threadMenu.saved',\r\n                            defaultMessage: 'Saved',\r\n                        }));\r\n                    }, [threadId, isSaved])}\r\n                />\r\n                <Menu.ItemAction\r\n                    text={formatMessage({\r\n                        id: 'threading.threadMenu.copy',\r\n                        defaultMessage: 'Copy link',\r\n                    })}\r\n                    onClick={useCallback(() => {\r\n                        copyToClipboard(`${getSiteURL()}/${team}/pl/${threadId}`);\r\n                        readAloud(formatMessage({\r\n                            id: 'threading.threadMenu.linkCopied',\r\n                            defaultMessage: 'Link copied',\r\n                        }));\r\n                    }, [team, threadId])}\r\n                />\r\n            </Menu>\r\n        </MenuWrapper>\r\n    );\r\n}\r\n\r\nfunction areEqual(prevProps: Props, nextProps: Props) {\r\n    return (\r\n        prevProps.threadId === nextProps.threadId &&\r\n        prevProps.isFollowing === nextProps.isFollowing &&\r\n        prevProps.unreadTimestamp === nextProps.unreadTimestamp &&\r\n        prevProps.hasUnreads === nextProps.hasUnreads\r\n    );\r\n}\r\n\r\nexport default memo(ThreadMenu, areEqual);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {useCallback} from 'react';\r\nimport {useDispatch} from 'react-redux';\r\n\r\nimport {setReadout} from 'actions/views/root';\r\n\r\nexport const useReadout = () => {\r\n    const dispatch = useDispatch();\r\n\r\n    const readAloud = useCallback((message: string) => {\r\n        dispatch(setReadout(message));\r\n    }, [dispatch]);\r\n\r\n    return readAloud;\r\n};\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {memo, useCallback} from 'react';\r\nimport type {ReactNode} from 'react';\r\nimport {useIntl} from 'react-intl';\r\nimport {useSelector, useDispatch} from 'react-redux';\r\n\r\nimport {DotsVerticalIcon} from '@mattermost/compass-icons/components';\r\nimport type {UserThread, UserThreadSynthetic} from '@mattermost/types/threads';\r\n\r\nimport {setThreadFollow} from 'mattermost-redux/actions/threads';\r\nimport {makeGetChannel} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getPost, makeGetPostsForThread} from 'mattermost-redux/selectors/entities/posts';\r\n\r\nimport {focusPost} from 'components/permalink_view/actions';\r\nimport PopoutButton from 'components/popout_button';\r\nimport Header from 'components/widgets/header';\r\nimport WithTooltip from 'components/with_tooltip';\r\n\r\nimport {popoutThread} from 'utils/popouts/popout_windows';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport Button from '../../common/button';\r\nimport FollowButton from '../../common/follow_button';\r\nimport {useThreadRouting} from '../../hooks';\r\nimport ThreadMenu from '../thread_menu';\r\n\r\nimport './thread_pane.scss';\r\n\r\nconst getChannel = makeGetChannel();\r\nconst getPostsForThread = makeGetPostsForThread();\r\n\r\ntype Props = {\r\n    thread: UserThread | UserThreadSynthetic;\r\n    children?: ReactNode;\r\n};\r\n\r\nconst ThreadPane = ({\r\n    thread,\r\n    children,\r\n}: Props) => {\r\n    const intl = useIntl();\r\n    const {formatMessage} = intl;\r\n    const dispatch = useDispatch();\r\n    const {\r\n        params: {\r\n            team,\r\n        },\r\n        currentTeamId,\r\n        currentUserId,\r\n        goToInChannel,\r\n        select,\r\n    } = useThreadRouting();\r\n\r\n    const {\r\n        id: threadId,\r\n        is_following: isFollowing,\r\n        post: {\r\n            channel_id: channelId,\r\n        },\r\n    } = thread;\r\n\r\n    const channel = useSelector((state: GlobalState) => getChannel(state, channelId));\r\n    const post = useSelector((state: GlobalState) => getPost(state, thread.id));\r\n    const postsInThread = useSelector((state: GlobalState) => getPostsForThread(state, post.id));\r\n    const selectHandler = useCallback(() => select(), []);\r\n    let unreadTimestamp = post.edit_at || post.create_at;\r\n\r\n    // if we have the whole thread, get the posts in it, sorted from newest to oldest.\r\n    // First post is latest reply. Use that timestamp\r\n    if (postsInThread.length > 1) {\r\n        const p = postsInThread[0];\r\n        unreadTimestamp = p.edit_at || p.create_at;\r\n    }\r\n    const goToInChannelHandler = useCallback(() => {\r\n        goToInChannel(threadId);\r\n    }, [goToInChannel, threadId]);\r\n\r\n    const followHandler = useCallback(() => {\r\n        dispatch(setThreadFollow(currentUserId, currentTeamId, threadId, !isFollowing));\r\n    }, [dispatch, currentUserId, currentTeamId, threadId, isFollowing]);\r\n\r\n    const popout = useCallback(() => {\r\n        popoutThread(intl, threadId, team, (postId, returnTo) => {\r\n            dispatch(focusPost(postId, returnTo, currentUserId, {skipRedirectReplyPermalink: true}));\r\n        });\r\n    }, [threadId, team, intl, dispatch, currentUserId]);\r\n\r\n    return (\r\n        <div\r\n            id={'thread-pane-container'}\r\n            className='ThreadPane'\r\n        >\r\n            <Header\r\n                className='ThreadPane___header'\r\n                heading={(\r\n                    <>\r\n                        <Button\r\n                            className='Button___icon Button___large back'\r\n                            onClick={selectHandler}\r\n                        >\r\n                            <i className='icon icon-arrow-back-ios'/>\r\n                        </Button>\r\n                        <h3>\r\n                            <span className='separated'>\r\n                                {formatMessage({\r\n                                    id: 'threading.header.heading',\r\n                                    defaultMessage: 'Thread',\r\n                                })}\r\n                            </span>\r\n                            <Button\r\n                                className='separated'\r\n                                allowTextOverflow={true}\r\n                                onClick={goToInChannelHandler}\r\n                            >\r\n                                {channel?.display_name}\r\n                            </Button>\r\n                        </h3>\r\n                    </>\r\n                )}\r\n                right={(\r\n                    <>\r\n                        <FollowButton\r\n                            isFollowing={isFollowing}\r\n                            onClick={followHandler}\r\n                        />\r\n                        <PopoutButton onClick={popout}/>\r\n                        <ThreadMenu\r\n                            threadId={threadId}\r\n                            isFollowing={isFollowing}\r\n                            hasUnreads={isFollowing && Boolean((thread as UserThread).unread_replies || (thread as UserThread).unread_mentions)}\r\n                            unreadTimestamp={unreadTimestamp}\r\n                        >\r\n                            <WithTooltip\r\n                                title={formatMessage({\r\n                                    id: 'threading.threadHeader.menu',\r\n                                    defaultMessage: 'More Actions',\r\n                                })}\r\n                            >\r\n                                <Button className='Button___icon Button___large'>\r\n                                    <DotsVerticalIcon size={18}/>\r\n                                </Button>\r\n                            </WithTooltip>\r\n                        </ThreadMenu>\r\n                    </>\r\n                )}\r\n            />\r\n            {children}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default memo(ThreadPane);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {useMemo, useCallback} from 'react';\r\nimport {useSelector, shallowEqual} from 'react-redux';\r\nimport {useParams, useHistory} from 'react-router-dom';\r\n\r\nimport type {Team} from '@mattermost/types/teams';\r\nimport type {UserThread} from '@mattermost/types/threads';\r\n\r\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\r\n\r\n/**\r\n * GlobalThreads-specific hook for nav/routing, selection, and common data needed for actions.\r\n */\r\nexport function useThreadRouting() {\r\n    const matchParams = useParams<{team: string; threadIdentifier?: UserThread['id']}>();\r\n    const params = useMemo(() => matchParams, [matchParams.threadIdentifier, matchParams.team]);\r\n    const history = useHistory();\r\n\r\n    const currentTeamId = useSelector(getCurrentTeamId, shallowEqual);\r\n    const currentUserId = useSelector(getCurrentUserId, shallowEqual);\r\n\r\n    const select = useCallback((threadId?: UserThread['id']) => {\r\n        return history.push(`/${params.team}/threads${threadId ? '/' + threadId : ''}`);\r\n    }, [params.team]);\r\n\r\n    const clear = useCallback(() => history.replace(`/${params.team}/threads`), [params.team]);\r\n\r\n    const goToInChannel = useCallback((threadId?: UserThread['id'], teamName: Team['name'] = params.team) => {\r\n        return history.push(`/${teamName}/pl/${threadId ?? params.threadIdentifier}`);\r\n    }, [params.threadIdentifier, params.team]);\r\n\r\n    return {\r\n        params,\r\n        history,\r\n        currentTeamId,\r\n        currentUserId,\r\n        clear,\r\n        select,\r\n        goToInChannel,\r\n    };\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React, {Fragment} from 'react';\r\nimport type {ReactNode, HTMLAttributes} from 'react';\r\n\r\nimport './header.scss';\r\n\r\ntype Props = {\r\n    heading: ReactNode;\r\n    level?: 0 | 1 | 2 | 3 | 4 | 5 | 6;\r\n    subtitle?: ReactNode;\r\n    right?: ReactNode;\r\n};\r\n\r\ntype HeadingTag = keyof Pick<JSX.IntrinsicElements, 'h1' | 'h2' | 'h3' | 'h4' | 'h5' | 'h6'>;\r\n\r\nconst Headings: Array<typeof Fragment | HeadingTag> = [Fragment, 'h1', 'h2', 'h3', 'h4', 'h5', 'h6'];\r\n\r\nconst Header = ({\r\n    level = 0,\r\n    heading,\r\n    subtitle,\r\n    right,\r\n    ...attrs\r\n}: Props & HTMLAttributes<HTMLElement>) => {\r\n    const H = Headings[level];\r\n    return (\r\n        <div\r\n            {...attrs}\r\n            className={classNames('Header', attrs.className)}\r\n        >\r\n            <div className='left'>\r\n                <H>{heading}</H>\r\n                {subtitle ? <p>{subtitle}</p> : null}\r\n            </div>\r\n            <div className='spacer'/>\r\n            {right}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Header;\r\n"],"names":["PopoutButton","_ref","onClick","className","intl","useIntl","canPopout","React","WithTooltip","title","FormattedMessage","id","defaultMessage","type","classNames","formatMessage","propTypes","_pt","isRequired","width","height","viewBox","fill","xmlns","clipPath","opacity","x","rx","y","cx","cy","r","fillOpacity","d","stroke","strokeOpacity","strokeLinecap","strokeLinejoin","transform","SearchHintSVG","toString","Badge","styled","withConfig","displayName","props","priority","PostPriority","URGENT","PriorityLabel","IMPORTANT","AlertOutlineIcon","size","AlertCircleOutlineIcon","AttachmentCard","fallback","text","author_name","authorName","pretext","concat","stripMarkdown","File","has_preview_image","hasPreviewImage","mini_preview","miniPreview","mime_type","mimeType","extension","enableSVGs","imgSrc","useMemo","getFileThumbnailUrl","fileType","getFileType","FileTypes","SVG","alt","src","getFileUrl","cn","getCompassIconClassName","IMAGE","Card","_ref2","children","fileSizeToString","FileCard","_ref3","file","name","Object","assign","memo","connect","state","ownProps","getFile","getConfig","EnableSVGs","_post$file_ids","post","file_ids","length","isMessageAttachmentArray","attachments","markdownPreviewOptions","singleline","mentionHighlight","atMentions","ThreadItem","_post$props","_unreadTimestamp","_post$metadata","channel","currentRelativeTeamUrl","isSelected","postsInThread","style","thread","threadId","isFirstThreadInList","isPostPriorityEnabled","dispatch","useDispatch","select","goToInChannel","currentTeamId","useThreadRouting","currentUserId","useSelector","getCurrentUserId","msgDeleted","postAuthor","ensureString","override_username","getMentionKeysForPost","makeGetMentionKeysForPost","mentionsKeys","ref","useRef","useEffect","teammate_id","getMissingProfilesByIds","channel_id","fetchChannel","_ref$current","current","focus","participantIds","_post$user_id","ids","participants","flatMap","user_id","reverse","unreadTimestamp","edit_at","create_at","selectHandler","useCallback","e","key","altKey","hasUnreads","Boolean","unread_replies","lastViewedAt","Date","now","manuallyMarkThreadAsUnread","updateThreadRead","markLastPostInThreadAsUnread","imageProps","onImageHeightChanged","onImageLoaded","goToInChannelHandler","stopPropagation","handleFormattedTextClick","Utils","newReplies","unread_mentions","newMentions","last_reply_at","lastReplyAt","reply_count","totalReplies","is_following","isFollowing","p","tabIndex","role","author","onKeyDown","over","Math","min","display_name","Tag","is_urgent","PriorityBadge","Timestamp","THREADING_TIME","value","ThreadMenu","Button","marginTop","DotsVerticalIcon","dir","message","Markdown","Posts","POST_DELETED","options","imagesMetadata","metadata","images","mentionKeys","Attachment","Avatars","userIds","values","getPostsForThread","makeGetPostsForThread","getChannel","makeGetChannel","getDisplayName","makeGetDisplayName","getPost","getCurrentRelativeTeamUrl","getThread","Row","index","data","itemId","selectedThreadId","Constants","THREADS_LOADING_INDICATOR_ITEM_ID","LoadingScreen","THREADS_NO_RESULTS_ITEM_ID","NoResultsIndicator","_objectSpread","padding","background","iconGraphic","subtitle","searchShortcut","SearchShortcut","variant","ShortcutKeyVariant","TutorialTip","titleClassName","subtitleClassName","layout","NoResultsLayout","Horizontal","areEqual","willChange","VirtualizedThreadList","loadMoreItems","total","isLoading","addNoMoreResultsItem","infiniteLoaderRef","startIndexRef","stopIndexRef","indexOf","_infiniteLoaderRef$cu","_listRef","scrollToItem","itemKey","isItemLoaded","AutoSizer","InfiniteLoader","itemCount","minimumBatchSize","ThreadsConstants","THREADS_PAGE_SIZE","onItemsRendered","FixedSizeList","_ref4","overscanStartIndex","overscanStopIndex","visibleStartIndex","visibleStopIndex","itemData","itemSize","prevProps","nextProps","join","MarkAllThreadsAsReadModal","onConfirm","onCancel","GenericModal","compassDesign","modalHeaderText","confirmButtonText","cancelButtonText","onExited","handleCancel","handleConfirm","ThreadFilter","ThreadList","_useSelector","currentFilter","none","someUnread","setFilter","unreadIds","unread","clear","total_unread_threads","totalUnread","getThreadCountsInCurrentTeam","setLoading","hasLoaded","setHasLoaded","handleKeyDown","_target$tagName","target","tagName","toLowerCase","metaKey","shiftKey","ctrlKey","Keyboard","KeyCodes","DOWN","UP","noModalsAreOpen","document","getElementsByClassName","A11yClassNames","MODAL","noPopupsDropdownsAreOpen","POPUP","threadIdToSelect","selectedThreadIndex","preventDefault","addEventListener","removeEventListener","handleLoadMoreItems","async","before","startIndex","getThreadsForCurrentTeam","handleAllMarkedRead","markAllThreadsInTeamRead","handleOpenMarkAllAsReadModal","handleCloseMarkAllAsReadModal","closeModal","ModalIdentifiers","MARK_ALL_THREADS_AS_READ","modalProp","openModal","modalId","dialogType","dialogProps","tabListProps","tabProps","activeTab","setActiveTab","tabs","delta","RIGHT","LEFT","findIndex","tab","mod","a11yFocus","getElementById","map","panelId","useTabs","Header","heading","isActive","hasDot","right","PlaylistCheckIcon","isEmpty","expanded","GlobalThreads","url","params","threadIdentifier","useRouteMatch","filter","useGlobalState","counts","selectedThread","getSelectedThreadIdInCurrentTeam","selectedPost","threadIds","getThreadOrderInCurrentTeam","shallowEqual","unreadThreadIds","getUnreadThreadOrderInCurrentTeam","numUnread","rhsState","getRhsState","RHSStates","MENTION","SEARCH","FLAG","suppressRHS","selectLhsItem","LhsItemType","Page","LhsPage","Threads","clearLastUnreadChannel","loadProfilesForSidebar","penultimateType","LocalStorageStore","getPreviousViewedType","PreviousViewedTypes","THREADS","setPenultimateViewedType","setPreviousViewedType","unsuppressRHS","getThreadCounts","setSelectedThreadId","isEmptyList","useState","shouldLoadThreads","shouldLoadUnreadThreads","promises","push","Promise","all","then","measureAndReport","Measure","GlobalThreadsLoad","startMark","Mark","GlobalThreadsLinkClicked","canFail","performance","clearMarks","handleSelectUnread","ChatIllustration","ThreadPane","ThreadViewer","rootPostId","useRelativeTimestamp","isThreadView","link","chunks","Link","to","team","isSaved","isPostFlagged","readAloud","useReadout","setReadout","handleReadUnread","popout","popoutThread","postId","returnTo","focusPost","skipRedirectReplyPermalink","MenuWrapper","stopPropagationOnToggle","Menu","ariaLabel","openLeft","ItemAction","buttonClass","icon","extraText","setThreadFollow","unsavePost","savePost","copyToClipboard","getSiteURL","channelId","followHandler","allowTextOverflow","FollowButton","matchParams","useParams","history","useHistory","getCurrentTeamId","replace","teamName","arguments","undefined","Headings","Fragment","level","attrs","_objectWithoutProperties","_excluded","H"],"sourceRoot":""}