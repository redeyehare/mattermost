{"version":3,"file":"6222.1914f47eb7bcd70edebb.js","mappings":"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","sources":["webpack://mattermost-webapp/./src/components/app_bar/new_channel_with_board_tour_tip.tsx","webpack://mattermost-webapp/./src/components/channel_header/components/header_icon_wrapper.tsx","webpack://mattermost-webapp/./src/plugins/call_button/index.ts","webpack://mattermost-webapp/./src/plugins/call_button/call_button.tsx","webpack://mattermost-webapp/./src/components/widgets/icons/plugin_channel_header_icon.tsx","webpack://mattermost-webapp/./src/plugins/channel_header_plug/channel_header_plug.tsx","webpack://mattermost-webapp/./src/plugins/channel_header_plug/index.ts","webpack://mattermost-webapp/./src/components/channel_header/channel_header_text_popover.tsx","webpack://mattermost-webapp/./src/components/channel_header/channel_header_text.tsx","webpack://mattermost-webapp/./src/components/channel_header/channel_header_title_favorite.tsx","webpack://mattermost-webapp/./src/components/channel_header/channel_header_title.tsx","webpack://mattermost-webapp/./src/components/channel_header/channel_info_button.tsx","webpack://mattermost-webapp/./src/components/channel_header/channel_header.tsx","webpack://mattermost-webapp/./src/components/channel_header/index.ts"],"sourcesContent":["// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback, useState} from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\nimport type {Placement} from 'tippy.js';\r\n\r\nimport {TourTip, useMeasurePunchouts} from '@mattermost/components';\r\n\r\nimport {setNewChannelWithBoardPreference} from 'mattermost-redux/actions/boards';\r\nimport {Preferences} from 'mattermost-redux/constants';\r\n\r\nimport {showNewChannelWithBoardPulsatingDot} from 'selectors/plugins';\r\n\r\ntype Props = {\r\n    pulsatingDotPlacement?: Omit<Placement, 'auto'| 'auto-end'>;\r\n    pulsatingDotTranslate?: {x: number; y: number};\r\n}\r\n\r\nconst NewChannelWithBoardTourTip = ({\r\n    pulsatingDotPlacement = 'left',\r\n    pulsatingDotTranslate,\r\n}: Props): JSX.Element | null => {\r\n    const dispatch = useDispatch();\r\n    const showTip = useSelector(showNewChannelWithBoardPulsatingDot);\r\n\r\n    const title = (\r\n        <FormattedMessage\r\n            id='newChannelWithBoard.tutorialTip.title'\r\n            defaultMessage='Access linked boards from the App Bar'\r\n        />\r\n    );\r\n\r\n    const screen = (\r\n        <FormattedMessage\r\n            id='newChannelWithBoard.tutorialTip.description'\r\n            defaultMessage='The board you just created can be quickly accessed by clicking on the Boards icon in the App bar. You can view the boards that are linked to this channel in the right-hand sidebar and open one in full view.'\r\n        />\r\n    );\r\n\r\n    const [tipOpened, setTipOpened] = useState(showTip);\r\n\r\n    const handleDismiss = useCallback((e: React.MouseEvent) => {\r\n        e.stopPropagation();\r\n        setTipOpened(false);\r\n        dispatch(setNewChannelWithBoardPreference({[Preferences.NEW_CHANNEL_WITH_BOARD_TOUR_SHOWED]: true}));\r\n    }, []);\r\n\r\n    const handleOpen = useCallback((e: React.MouseEvent) => {\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n\r\n        if (tipOpened) {\r\n            dispatch(setNewChannelWithBoardPreference({[Preferences.NEW_CHANNEL_WITH_BOARD_TOUR_SHOWED]: true}));\r\n            setTipOpened(false);\r\n        } else {\r\n            setTipOpened(true);\r\n        }\r\n    }, []);\r\n\r\n    const overlayPunchOut = useMeasurePunchouts(['app-bar-icon-focalboard'], [], {y: -2, height: 4, x: 0, width: 0});\r\n\r\n    if (!showTip) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <TourTip\r\n            show={true}\r\n            screen={screen}\r\n            title={title}\r\n            overlayPunchOut={overlayPunchOut}\r\n            placement='right-start'\r\n            pulsatingDotPlacement={pulsatingDotPlacement}\r\n            step={1}\r\n            singleTip={true}\r\n            showOptOut={false}\r\n            interactivePunchOut={true}\r\n            handleDismiss={handleDismiss}\r\n            handleOpen={handleOpen}\r\n            handlePrevious={handleDismiss}\r\n            offset={[-30, 5]}\r\n            pulsatingDotTranslate={pulsatingDotTranslate}\r\n        />\r\n    );\r\n};\r\n\r\nexport default NewChannelWithBoardTourTip;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\n\r\nimport NewChannelWithBoardTourTip from 'components/app_bar/new_channel_with_board_tour_tip';\r\nimport WithTooltip from 'components/with_tooltip';\r\nimport type {ShortcutDefinition} from 'components/with_tooltip/tooltip_shortcut';\r\n\r\nimport {suitePluginIds} from 'utils/constants';\r\n\r\ntype Props = {\r\n\r\n    /**\r\n     * ariaLabelOverride lets you override the aria-label which would otherwise use the tooltip text. This typically\r\n     * shouldn't be needed.\r\n     */\r\n    ariaLabelOverride?: string;\r\n\r\n    buttonClass?: string;\r\n    buttonId: string;\r\n    children: React.ReactNode;\r\n    onClick: (event: React.MouseEvent<HTMLButtonElement>) => void;\r\n    tooltip: string;\r\n    tooltipShortcut?: ShortcutDefinition;\r\n    isRhsOpen?: boolean;\r\n    pluginId?: string;\r\n}\r\n\r\nconst HeaderIconWrapper = (props: Props) => {\r\n    const {\r\n        ariaLabelOverride,\r\n        buttonClass,\r\n        buttonId,\r\n        children,\r\n        onClick,\r\n        tooltip: tooltipText,\r\n        tooltipShortcut,\r\n        isRhsOpen,\r\n        pluginId,\r\n    } = props;\r\n\r\n    const boardsEnabled = pluginId === suitePluginIds.focalboard;\r\n\r\n    const ariaLabelText = ariaLabelOverride ?? tooltipText;\r\n\r\n    return (\r\n        <>\r\n            <WithTooltip\r\n                title={isRhsOpen ? '' : tooltipText}\r\n                shortcut={tooltipShortcut}\r\n            >\r\n                <button\r\n                    id={buttonId}\r\n                    aria-label={ariaLabelText}\r\n                    className={buttonClass || 'channel-header__icon'}\r\n                    onClick={onClick}\r\n                >\r\n                    {children}\r\n                </button>\r\n            </WithTooltip>\r\n            {boardsEnabled &&\r\n                <NewChannelWithBoardTourTip\r\n                    pulsatingDotPlacement={'start'}\r\n                    pulsatingDotTranslate={{x: 0, y: -22}}\r\n                />\r\n            }\r\n        </>\r\n    );\r\n};\r\n\r\nexport default HeaderIconWrapper;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\n\r\nimport {getCurrentChannel, getMyCurrentChannelMembership} from 'mattermost-redux/selectors/entities/channels';\r\n\r\nimport type {GlobalState} from 'types/store/index';\r\n\r\nimport CallButton from './call_button';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    return {\r\n        currentChannel: getCurrentChannel(state),\r\n        pluginCallComponents: state.plugins.components.CallButton,\r\n        channelMember: getMyCurrentChannelMembership(state),\r\n        sidebarOpen: state.views.rhs.isSidebarOpen,\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps)(CallButton);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React, {useState, useEffect, useRef} from 'react';\r\nimport type {CSSProperties} from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nimport ChevronDownIcon from '@mattermost/compass-icons/components/chevron-down';\r\nimport PhoneOutlineIcon from '@mattermost/compass-icons/components/phone-outline';\r\nimport type {Channel, ChannelMembership} from '@mattermost/types/channels';\r\n\r\nimport Menu from 'components/widgets/menu/menu';\r\nimport MenuWrapper from 'components/widgets/menu/menu_wrapper';\r\n\r\nimport {Constants} from 'utils/constants';\r\n\r\nimport type {CallButtonAction} from 'types/store/plugins';\r\n\r\nimport './call_button.scss';\r\n\r\ntype Props = {\r\n    currentChannel?: Channel;\r\n    channelMember?: ChannelMembership;\r\n    pluginCallComponents: CallButtonAction[];\r\n    sidebarOpen: boolean;\r\n}\r\n\r\nexport default function CallButton({pluginCallComponents, currentChannel, channelMember, sidebarOpen}: Props) {\r\n    const [active, setActive] = useState(false);\r\n    const [clickEnabled, setClickEnabled] = useState(true);\r\n    const prevSidebarOpen = useRef(sidebarOpen);\r\n    const {formatMessage} = useIntl();\r\n\r\n    useEffect(() => {\r\n        if (prevSidebarOpen.current && !sidebarOpen) {\r\n            setClickEnabled(false);\r\n            setTimeout(() => {\r\n                setClickEnabled(true);\r\n            }, Constants.CHANNEL_HEADER_BUTTON_DISABLE_TIMEOUT);\r\n        }\r\n        prevSidebarOpen.current = sidebarOpen;\r\n    }, [sidebarOpen]);\r\n\r\n    if (pluginCallComponents.length === 0) {\r\n        return null;\r\n    }\r\n\r\n    const style = {\r\n        container: {\r\n            marginTop: 16,\r\n            height: 32,\r\n        } as CSSProperties,\r\n    };\r\n\r\n    if (pluginCallComponents.length === 1) {\r\n        const item = pluginCallComponents[0];\r\n        const clickHandler = () => item.action?.(currentChannel, channelMember);\r\n\r\n        return (\r\n            <div\r\n                style={style.container}\r\n                className='flex-child'\r\n                onClick={clickEnabled ? clickHandler : undefined}\r\n                onTouchEnd={clickEnabled ? clickHandler : undefined}\r\n            >\r\n                {item.button}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const items = pluginCallComponents.map((item) => {\r\n        return (\r\n            <li\r\n                className='MenuItem'\r\n                key={item.id}\r\n                onClick={(e) => {\r\n                    e.preventDefault();\r\n                    item.action?.(currentChannel, channelMember);\r\n                }}\r\n            >\r\n                {item.dropdownButton}\r\n            </li>\r\n        );\r\n    });\r\n\r\n    return (\r\n        <div\r\n            style={style.container}\r\n            className='flex-child'\r\n        >\r\n            <MenuWrapper onToggle={(toggle: boolean) => setActive(toggle)}>\r\n                <button className={classNames('style--none call-button dropdown', {active})}>\r\n                    <PhoneOutlineIcon\r\n                        color='inherit'\r\n                        aria-label={formatMessage({id: 'generic_icons.call', defaultMessage: 'Call icon'}).toLowerCase()}\r\n                    />\r\n                    <span className='call-button-label'>{'Call'}</span>\r\n                    <ChevronDownIcon\r\n                        color='inherit'\r\n                        aria-label={formatMessage({id: 'generic_icons.dropdown', defaultMessage: 'Dropdown Icon'}).toLowerCase()}\r\n                    />\r\n                </button>\r\n                <Menu\r\n                    id='callOptions'\r\n                    ariaLabel={formatMessage({id: 'call_button.menuAriaLabel', defaultMessage: 'Call type selector'})}\r\n                    customStyles={{\r\n                        top: 'auto',\r\n                        left: 'auto',\r\n                        right: 0,\r\n                    }}\r\n                >\r\n                    {items}\r\n                </Menu>\r\n            </MenuWrapper>\r\n        </div>\r\n    );\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nexport default function PluginChannelHeaderIcon(props: React.HTMLAttributes<HTMLSpanElement>) {\r\n    const {formatMessage} = useIntl();\r\n    return (\r\n        <span {...props}>\r\n            <svg\r\n                width='16px'\r\n                height='16px'\r\n                viewBox='0 0 18 18'\r\n                version='1.1'\r\n                role='img'\r\n                aria-label={formatMessage({id: 'generic_icons.plugins', defaultMessage: 'Plugins'})}\r\n            >\r\n                <path d='M14.58 9.14399L17.136 6.60599C17.304 6.42599 17.388 6.20999 17.388 5.95799C17.388 5.70599 17.298 5.49599 17.118 5.32799C16.95 5.14799 16.74 5.05799 16.488 5.05799C16.236 5.05799 16.026 5.14799 15.858 5.32799L13.302 7.86599L10.134 4.69799L12.672 2.14199C12.852 1.97399 12.942 1.76399 12.942 1.51199C12.942 1.25999 12.852 1.04999 12.672 0.881987C12.504 0.701987 12.294 0.611987 12.042 0.611987C11.79 0.611987 11.574 0.695987 11.394 0.863987L8.856 3.41999L6.318 0.863987C6.138 0.695987 5.922 0.611987 5.67 0.611987C5.418 0.611987 5.208 0.695987 5.04 0.863987V0.881987C4.86 1.04999 4.77 1.25999 4.77 1.51199C4.77 1.76399 4.86 1.97399 5.04 2.14199L5.67 2.78999L2.808 5.65199C2.016 6.44399 1.458 7.36799 1.134 8.42399C0.81 9.45599 0.744 10.512 0.936 11.592C1.128 12.66 1.56 13.632 2.232 14.508L0.27 16.47C0.09 16.638 0 16.848 0 17.1C0 17.352 0.09 17.562 0.27 17.73C0.45 17.898 0.66 17.982 0.9 17.982C1.152 17.994 1.362 17.91 1.53 17.73L3.492 15.768C4.368 16.44 5.34 16.872 6.408 17.064C7.488 17.256 8.544 17.19 9.576 16.866C10.632 16.542 11.556 15.984 12.348 15.192L15.21 12.33L15.858 12.96C16.026 13.14 16.236 13.23 16.488 13.23C16.74 13.23 16.95 13.14 17.118 12.96H17.136C17.304 12.792 17.388 12.582 17.388 12.33C17.388 12.078 17.304 11.862 17.136 11.682L14.58 9.14399ZM11.088 13.914C10.452 14.55 9.702 14.976 8.838 15.192C8.01 15.408 7.176 15.408 6.336 15.192C5.472 14.976 4.722 14.55 4.086 13.914C3.45 13.278 3.024 12.528 2.808 11.664C2.592 10.824 2.592 9.98999 2.808 9.16199C3.024 8.29799 3.45 7.54799 4.086 6.91199L6.948 4.04999L13.95 11.052L11.088 13.914Z'/>\r\n            </svg>\r\n        </span>\r\n    );\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\n/* eslint-disable react/no-multi-comp */\r\n\r\nimport React from 'react';\r\nimport {Dropdown} from 'react-bootstrap';\r\nimport {FormattedMessage, injectIntl} from 'react-intl';\r\nimport type {IntlShape} from 'react-intl';\r\nimport {RootCloseWrapper} from 'react-overlays';\r\n\r\nimport type {AppBinding} from '@mattermost/types/apps';\r\nimport type {Channel, ChannelMembership} from '@mattermost/types/channels';\r\n\r\nimport {AppCallResponseTypes} from 'mattermost-redux/constants/apps';\r\n\r\nimport HeaderIconWrapper from 'components/channel_header/components/header_icon_wrapper';\r\nimport PluginChannelHeaderIcon from 'components/widgets/icons/plugin_channel_header_icon';\r\nimport WithTooltip from 'components/with_tooltip';\r\n\r\nimport {createCallContext} from 'utils/apps';\r\nimport {Constants} from 'utils/constants';\r\n\r\nimport type {HandleBindingClick, OpenAppsModal, PostEphemeralCallResponseForChannel} from 'types/apps';\r\nimport type {ChannelHeaderButtonAction, PluggableText} from 'types/store/plugins';\r\n\r\ntype CustomMenuProps = {\r\n    open?: boolean;\r\n    children?: React.ReactNode;\r\n    onClose: () => void;\r\n    rootCloseEvent?: 'click' | 'mousedown';\r\n    bsRole: string;\r\n}\r\n\r\nexport const maxComponentsBeforeDropdown = 15;\r\n\r\nclass CustomMenu extends React.PureComponent<CustomMenuProps> {\r\n    handleRootClose = () => {\r\n        this.props.onClose();\r\n    };\r\n\r\n    render() {\r\n        const {\r\n            open,\r\n            rootCloseEvent,\r\n            children,\r\n        } = this.props;\r\n\r\n        return (\r\n            <RootCloseWrapper\r\n                disabled={!open}\r\n                onRootClose={this.handleRootClose}\r\n                event={rootCloseEvent}\r\n            >\r\n                <ul\r\n                    role='menu'\r\n                    className='dropdown-menu channel-header_plugin-dropdown'\r\n                >\r\n                    {children}\r\n                </ul>\r\n            </RootCloseWrapper>\r\n        );\r\n    }\r\n}\r\n\r\ntype CustomToggleProps = {\r\n    children?: React.ReactNode;\r\n    dropdownOpen?: boolean;\r\n    onClick?: (e: React.MouseEvent) => void;\r\n    bsRole: string;\r\n}\r\n\r\nclass CustomToggle extends React.PureComponent<CustomToggleProps> {\r\n    handleClick = (e: React.MouseEvent) => {\r\n        if (this.props.onClick) {\r\n            this.props.onClick(e);\r\n        }\r\n    };\r\n\r\n    render() {\r\n        const {children} = this.props;\r\n\r\n        let activeClass = '';\r\n        if (this.props.dropdownOpen) {\r\n            activeClass = ' channel-header__icon--active';\r\n        }\r\n\r\n        return (\r\n            <button\r\n                id='pluginChannelHeaderButtonDropdown'\r\n                className={'channel-header__icon channel-header__icon--wide ' + activeClass}\r\n                type='button'\r\n                onClick={this.handleClick}\r\n            >\r\n                {children}\r\n            </button>\r\n        );\r\n    }\r\n}\r\n\r\ntype ChannelHeaderPlugProps = {\r\n    intl: IntlShape;\r\n    components: ChannelHeaderButtonAction[];\r\n    appBindings?: AppBinding[];\r\n    appsEnabled: boolean;\r\n    channel: Channel;\r\n    channelMember?: ChannelMembership;\r\n    sidebarOpen: boolean;\r\n    shouldShowAppBar: boolean;\r\n    actions: {\r\n        handleBindingClick: HandleBindingClick;\r\n        postEphemeralCallResponseForChannel: PostEphemeralCallResponseForChannel;\r\n        openAppsModal: OpenAppsModal;\r\n    };\r\n}\r\n\r\ntype ChannelHeaderPlugState = {\r\n    dropdownOpen: boolean;\r\n}\r\n\r\nclass ChannelHeaderPlug extends React.PureComponent<ChannelHeaderPlugProps, ChannelHeaderPlugState> {\r\n    public static defaultProps: Partial<ChannelHeaderPlugProps> = {\r\n        components: [],\r\n        appBindings: [],\r\n    };\r\n\r\n    private disableButtonsClosingRHS = false;\r\n\r\n    constructor(props: ChannelHeaderPlugProps) {\r\n        super(props);\r\n        this.state = {\r\n            dropdownOpen: false,\r\n        };\r\n    }\r\n\r\n    componentDidUpdate(prevProps: ChannelHeaderPlugProps) {\r\n        if (prevProps.sidebarOpen && !this.props.sidebarOpen) {\r\n            this.disableButtonsClosingRHS = true;\r\n\r\n            setTimeout(() => {\r\n                this.disableButtonsClosingRHS = false;\r\n            }, Constants.CHANNEL_HEADER_BUTTON_DISABLE_TIMEOUT);\r\n        }\r\n    }\r\n\r\n    toggleDropdown = (dropdownOpen: boolean) => {\r\n        this.setState({dropdownOpen});\r\n    };\r\n\r\n    onClose = () => {\r\n        this.toggleDropdown(false);\r\n    };\r\n\r\n    fireAction = (action: (channel: Channel, channelMember?: ChannelMembership) => void) => {\r\n        if (this.disableButtonsClosingRHS) {\r\n            return;\r\n        }\r\n\r\n        action(this.props.channel, this.props.channelMember);\r\n    };\r\n\r\n    fireActionAndClose = (action: (channel: Channel, channelMember?: ChannelMembership) => void) => {\r\n        action(this.props.channel, this.props.channelMember);\r\n        this.onClose();\r\n    };\r\n\r\n    createComponentButton = (plug: ChannelHeaderButtonAction) => {\r\n        // These values are supposed to be strings based on PluginComponent, but some plugins pass non-strings,\r\n        // so do some hacky stuff to try to convert it back to a string. DO NOT USE THIS ELSEWHERE!\r\n        function tooltipToAriaLabelHack(intl: IntlShape, stringOrElement: PluggableText) {\r\n            if (typeof stringOrElement === 'string') {\r\n                // This is the case that we hope for\r\n                return stringOrElement;\r\n            }\r\n\r\n            if (!stringOrElement) {\r\n                return '';\r\n            }\r\n\r\n            if (typeof stringOrElement === 'object' && 'type' in stringOrElement && stringOrElement.type === FormattedMessage) {\r\n                // This is a FormattedMessage, so extract the props to translate the text manually\r\n                return intl.formatMessage(\r\n                    {\r\n                        id: stringOrElement.props.id,\r\n                        defaultMessage: stringOrElement.props.defaultMessage,\r\n                    },\r\n                    stringOrElement.props.value,\r\n                );\r\n            }\r\n\r\n            return '';\r\n        }\r\n\r\n        let ariaLabel;\r\n        if (plug.tooltipText) {\r\n            ariaLabel = tooltipToAriaLabelHack(this.props.intl, plug.tooltipText);\r\n        } else if (plug.dropdownText) {\r\n            ariaLabel = tooltipToAriaLabelHack(this.props.intl, plug.dropdownText);\r\n        }\r\n\r\n        // TODO: Remove this any and make sure the types are properly\r\n        // handled.\r\n        const tooltipText: any = plug.tooltipText ?? plug.dropdownText ?? '';\r\n\r\n        return (\r\n            <HeaderIconWrapper\r\n                key={'channelHeaderButton' + plug.id}\r\n                buttonClass='channel-header__icon'\r\n                onClick={() => this.fireAction(plug.action!)}\r\n                buttonId={plug.id + 'ChannelHeaderButton'}\r\n                tooltip={tooltipText}\r\n                ariaLabelOverride={ariaLabel}\r\n                pluginId={plug.pluginId}\r\n            >\r\n                {plug.icon}\r\n            </HeaderIconWrapper>\r\n        );\r\n    };\r\n\r\n    onBindingClick = async (binding: AppBinding) => {\r\n        if (this.disableButtonsClosingRHS) {\r\n            return;\r\n        }\r\n\r\n        const {channel, intl} = this.props;\r\n\r\n        const context = createCallContext(\r\n            binding.app_id,\r\n            binding.location,\r\n            this.props.channel.id,\r\n            this.props.channel.team_id,\r\n        );\r\n\r\n        const res = await this.props.actions.handleBindingClick(binding, context, intl);\r\n\r\n        if (res.error) {\r\n            const errorResponse = res.error;\r\n            const errorMessage = errorResponse.text || intl.formatMessage({\r\n                id: 'apps.error.unknown',\r\n                defaultMessage: 'Unknown error occurred.',\r\n            });\r\n            this.props.actions.postEphemeralCallResponseForChannel(errorResponse, errorMessage, channel.id);\r\n            return;\r\n        }\r\n\r\n        const callResp = res.data!;\r\n        switch (callResp.type) {\r\n        case AppCallResponseTypes.OK:\r\n            if (callResp.text) {\r\n                this.props.actions.postEphemeralCallResponseForChannel(callResp, callResp.text, channel.id);\r\n            }\r\n            break;\r\n        case AppCallResponseTypes.NAVIGATE:\r\n            break;\r\n        case AppCallResponseTypes.FORM:\r\n            if (callResp.form) {\r\n                this.props.actions.openAppsModal(callResp.form, context);\r\n            }\r\n            break;\r\n        default: {\r\n            const errorMessage = this.props.intl.formatMessage({\r\n                id: 'apps.error.responses.unknown_type',\r\n                defaultMessage: 'App response type not supported. Response type: {type}.',\r\n            }, {\r\n                type: callResp.type,\r\n            });\r\n            this.props.actions.postEphemeralCallResponseForChannel(callResp, errorMessage, channel.id);\r\n        }\r\n        }\r\n    };\r\n\r\n    createAppBindingButton = (binding: AppBinding) => {\r\n        return (\r\n            <HeaderIconWrapper\r\n                key={`channelHeaderButton_${binding.app_id}_${binding.location}`}\r\n                buttonClass='channel-header__icon style--none'\r\n                onClick={() => this.onBindingClick(binding)}\r\n                buttonId={`${binding.app_id}_${binding.location}`}\r\n                tooltip={binding.label}\r\n            >\r\n                <img\r\n                    src={binding.icon}\r\n                    width='24'\r\n                    height='24'\r\n                />\r\n            </HeaderIconWrapper>\r\n        );\r\n    };\r\n\r\n    createDropdown = (plugs: ChannelHeaderButtonAction[], appBindings: AppBinding[]) => {\r\n        const componentItems = plugs.filter((plug) => plug.action).map((plug) => {\r\n            return (\r\n                <li\r\n                    key={'channelHeaderPlug' + plug.id}\r\n                >\r\n                    <a\r\n                        href='#'\r\n                        className='d-flex align-items-center'\r\n                        onClick={() => this.fireActionAndClose(plug.action!)}\r\n                    >\r\n                        <span className='d-flex align-items-center overflow--ellipsis'>{plug.icon}</span>\r\n                        <span>{plug.dropdownText}</span>\r\n                    </a>\r\n                </li>\r\n            );\r\n        });\r\n\r\n        let items = componentItems;\r\n        if (this.props.appsEnabled) {\r\n            items = componentItems.concat(appBindings.map((binding) => {\r\n                return (\r\n                    <li\r\n                        key={'channelHeaderPlug' + binding.app_id + binding.location}\r\n                    >\r\n                        <a\r\n                            href='#'\r\n                            className='d-flex align-items-center'\r\n                            onClick={() => this.fireActionAndClose(() => this.onBindingClick(binding))}\r\n                        >\r\n                            <span className='d-flex align-items-center overflow--ellipsis icon'>{(<img src={binding.icon}/>)}</span>\r\n                            <span>{binding.label}</span>\r\n                        </a>\r\n                    </li>\r\n                );\r\n            }));\r\n        }\r\n\r\n        return (\r\n            <div className='flex-child'>\r\n                <Dropdown\r\n                    id='channelHeaderPlugDropdown'\r\n                    onToggle={this.toggleDropdown}\r\n                    open={this.state.dropdownOpen}\r\n                >\r\n                    <CustomToggle\r\n                        bsRole='toggle'\r\n                        dropdownOpen={this.state.dropdownOpen}\r\n                    >\r\n                        <WithTooltip\r\n                            title={\r\n                                <FormattedMessage\r\n                                    id='generic_icons.plugins'\r\n                                    defaultMessage='Plugins'\r\n                                />\r\n                            }\r\n                        >\r\n                            <>\r\n                                <PluginChannelHeaderIcon\r\n                                    id='pluginChannelHeaderIcon'\r\n                                    className='icon icon--standard icon__pluginChannelHeader'\r\n                                    aria-hidden='true'\r\n                                />\r\n                                <span\r\n                                    id='pluginCount'\r\n                                    className='icon__text'\r\n                                >\r\n                                    {items.length}\r\n                                </span>\r\n                            </>\r\n                        </WithTooltip>\r\n                    </CustomToggle>\r\n                    <CustomMenu\r\n                        bsRole='menu'\r\n                        open={this.state.dropdownOpen}\r\n                        onClose={this.onClose}\r\n                    >\r\n                        {items}\r\n                    </CustomMenu>\r\n                </Dropdown>\r\n            </div>\r\n        );\r\n    };\r\n\r\n    render() {\r\n        const components = this.props.components || [];\r\n        const appBindings = this.props.appsEnabled ? this.props.appBindings || [] : [];\r\n        if (this.props.shouldShowAppBar || (components.length === 0 && appBindings.length === 0)) {\r\n            return null;\r\n        } else if ((components.length + appBindings.length) <= maxComponentsBeforeDropdown) {\r\n            let componentButtons = components.filter((plug) => plug.icon && plug.action).map(this.createComponentButton);\r\n            if (this.props.appsEnabled) {\r\n                componentButtons = componentButtons.concat(appBindings.map(this.createAppBindingButton));\r\n            }\r\n            return componentButtons;\r\n        }\r\n\r\n        return this.createDropdown(components, appBindings);\r\n    }\r\n}\r\n\r\nexport default injectIntl(ChannelHeaderPlug);\r\n/* eslint-enable react/no-multi-comp */\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {appBarEnabled, appsEnabled, getChannelHeaderAppBindings} from 'mattermost-redux/selectors/entities/apps';\r\nimport {getTheme} from 'mattermost-redux/selectors/entities/preferences';\r\n\r\nimport {handleBindingClick, openAppsModal, postEphemeralCallResponseForChannel} from 'actions/apps';\r\nimport {getChannelHeaderPluginComponents, shouldShowAppBar} from 'selectors/plugins';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport ChannelHeaderPlug from './channel_header_plug';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const apps = appsEnabled(state);\r\n    return {\r\n        components: getChannelHeaderPluginComponents(state),\r\n        appBindings: getChannelHeaderAppBindings(state),\r\n        appsEnabled: apps,\r\n        appBarEnabled: appBarEnabled(state),\r\n        theme: getTheme(state),\r\n        sidebarOpen: state.views.rhs.isSidebarOpen,\r\n        shouldShowAppBar: shouldShowAppBar(state),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            handleBindingClick,\r\n            postEphemeralCallResponseForChannel,\r\n            openAppsModal,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ChannelHeaderPlug);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {\r\n    autoUpdate,\r\n    useDismiss,\r\n    safePolygon,\r\n    useFocus,\r\n    useHover,\r\n    useTransitionStyles,\r\n    useInteractions,\r\n    useRole,\r\n    useMergeRefs,\r\n    useFloating,\r\n    FloatingPortal,\r\n    FloatingOverlay,\r\n    useClick,\r\n    offset,\r\n} from '@floating-ui/react';\r\nimport React, {useMemo, useRef, useState} from 'react';\r\nimport type {MouseEvent} from 'react';\r\nimport {useSelector} from 'react-redux';\r\n\r\nimport {getCurrentRelativeTeamUrl} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport Markdown from 'components/markdown';\r\n\r\nimport {OverlaysTimings, OverlayTransitionStyles, RootHtmlPortalId} from 'utils/constants';\r\nimport type {ChannelNamesMap} from 'utils/text_formatting';\r\nimport {handleFormattedTextClick} from 'utils/utils';\r\n\r\nimport './channel_header_text_popover.scss';\r\n\r\nconst TEXT_IN_HEADER_MARKDOWN_OPTIONS = {singleline: true};\r\nconst TEXT_IN_POPOVER_MARKDOWN_OPTIONS = {singleline: false};\r\nconst MENTION_MARKDOWN_OPTIONS = {mentionHighlight: false, atMentions: true};\r\nconst IMAGE_MARKDOWN_OPTIONS = {hideUtilities: true};\r\n\r\nconst TRANSITION_STYLE_PROPS = {\r\n    duration: {\r\n        open: OverlaysTimings.FADE_IN_DURATION,\r\n        close: OverlaysTimings.FADE_OUT_DURATION,\r\n    },\r\n    initial: OverlayTransitionStyles.START,\r\n};\r\n\r\nconst PADDING_Y_OF_POPOVER = 6; // padding top & bottom of .channel-header-text-popover in channel_header_text_popover.scss\r\nconst PADDING_X_OF_POPOVER = 8; // padding right & left of .channel-header-text-popover in channel_header_text_popover.scss\r\nconst BORDER_WIDTH_OF_POPOVER = 1; // border of .channel-header-text-popover in channel_header_text_popover.scss\r\n\r\nconst HEIGHT_OF_HEADER_TEXT = 24; // height of .header-description__text in _headers.scss\r\nconst SHIFT_UP_OF_POPOVER = -((HEIGHT_OF_HEADER_TEXT + PADDING_Y_OF_POPOVER) - (2 * BORDER_WIDTH_OF_POPOVER));\r\n\r\ninterface Props {\r\n    text: string;\r\n    channelMentionsNameMap?: ChannelNamesMap;\r\n}\r\nexport function ChannelHeaderTextPopover(props: Props) {\r\n    const currentRelativeTeamUrl = useSelector(getCurrentRelativeTeamUrl);\r\n\r\n    const rootElementRef = useRef<HTMLDivElement>(null);\r\n\r\n    const isTextOverflowing = checkIfTextIsOverflowing(rootElementRef?.current, props.text);\r\n\r\n    const markdownOptions = useMemo(() => {\r\n        const inHeader = {\r\n            ...TEXT_IN_HEADER_MARKDOWN_OPTIONS,\r\n            ...MENTION_MARKDOWN_OPTIONS,\r\n            channelNamesMap: props.channelMentionsNameMap,\r\n        };\r\n        const inPopover = {\r\n            ...TEXT_IN_POPOVER_MARKDOWN_OPTIONS,\r\n            ...MENTION_MARKDOWN_OPTIONS,\r\n            channelNamesMap: props.channelMentionsNameMap,\r\n        };\r\n\r\n        return {\r\n            inHeader,\r\n            inPopover,\r\n        };\r\n    }, [props.channelMentionsNameMap]);\r\n\r\n    const [isPopoverOpen, setPopoverOpen] = useState(false);\r\n\r\n    const {refs: {setReference, setFloating}, floatingStyles, context: floatingContext} = useFloating({\r\n        open: isTextOverflowing ? isPopoverOpen : false,\r\n        onOpenChange: setPopoverOpen,\r\n        whileElementsMounted: autoUpdate,\r\n        middleware: [\r\n            offset(SHIFT_UP_OF_POPOVER),\r\n        ],\r\n    });\r\n    const {isMounted, styles: transitionStyles} = useTransitionStyles(\r\n        floatingContext,\r\n        TRANSITION_STYLE_PROPS,\r\n    );\r\n\r\n    const hover = useHover(floatingContext, {\r\n        enabled: isTextOverflowing,\r\n        handleClose: safePolygon({\r\n            requireIntent: false,\r\n            blockPointerEvents: true,\r\n        }),\r\n    });\r\n    const focus = useFocus(floatingContext);\r\n    const dismiss = useDismiss(floatingContext);\r\n    const click = useClick(floatingContext);\r\n    const role = useRole(floatingContext, {role: 'tooltip'});\r\n\r\n    const {getReferenceProps, getFloatingProps} = useInteractions([hover, focus, click, dismiss, role]);\r\n\r\n    const rootRef = useMergeRefs([rootElementRef, setReference]);\r\n\r\n    const maxWidthOfPopover = getMaxWidthOfPopover(rootElementRef?.current);\r\n\r\n    // This action processes clicks on formatted text elements like hashtags, user mentions,\r\n    // channel mentions, etc. while also allowing other elements to function as is such as external links etc\r\n    function handleClick(event: MouseEvent<HTMLDivElement>) {\r\n        handleFormattedTextClick(event, currentRelativeTeamUrl);\r\n    }\r\n\r\n    return (\r\n        <>\r\n            {/* eslint-disable-next-line jsx-a11y/click-events-have-key-events, jsx-a11y/no-static-element-interactions */}\r\n            <div\r\n                ref={rootRef}\r\n                className='header-description__text'\r\n                {...getReferenceProps()}\r\n                onClick={handleClick}\r\n            >\r\n                <Markdown\r\n                    message={props.text}\r\n                    options={markdownOptions.inHeader}\r\n                    imageProps={IMAGE_MARKDOWN_OPTIONS}\r\n                />\r\n            </div>\r\n\r\n            {isMounted && (\r\n                <FloatingPortal id={RootHtmlPortalId}>\r\n                    <FloatingOverlay\r\n                        className='channel-header-text-popover-floating-overlay'\r\n                        lockScroll={true}\r\n                    >\r\n                        {/* eslint-disable-next-line jsx-a11y/click-events-have-key-events, jsx-a11y/no-static-element-interactions */}\r\n                        <div\r\n                            ref={setFloating}\r\n                            className='channel-header-text-popover'\r\n                            style={{\r\n                                maxWidth: maxWidthOfPopover,\r\n                                ...floatingStyles,\r\n                                ...transitionStyles,\r\n                            }}\r\n                            onClick={handleClick}\r\n                            {...getFloatingProps()}\r\n                        >\r\n                            <Markdown\r\n                                message={props.text}\r\n                                options={markdownOptions.inPopover}\r\n                                imageProps={IMAGE_MARKDOWN_OPTIONS}\r\n                            />\r\n                        </div>\r\n                    </FloatingOverlay>\r\n                </FloatingPortal>\r\n            )}\r\n        </>\r\n    );\r\n}\r\n\r\nfunction checkIfTextIsOverflowing(elem: HTMLDivElement | null, text: string): boolean {\r\n    if (!elem) {\r\n        return false;\r\n    }\r\n\r\n    if (text.match(/\\n{2,}/g)) {\r\n        return true;\r\n    }\r\n\r\n    if (elem.scrollWidth === elem.clientWidth && elem.scrollHeight === elem.clientHeight) {\r\n        return false;\r\n    }\r\n\r\n    return elem.scrollWidth > elem.clientWidth || elem.scrollHeight > elem.clientHeight;\r\n}\r\n\r\nfunction getMaxWidthOfPopover(elem: HTMLDivElement | null): string | number {\r\n    if (!elem) {\r\n        return 'inherit';\r\n    }\r\n\r\n    return (elem.clientWidth) + ((2 * PADDING_X_OF_POPOVER) + (2 * BORDER_WIDTH_OF_POPOVER));\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\nimport {useDispatch} from 'react-redux';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {Team} from '@mattermost/types/teams';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\n\r\nimport {Permissions} from 'mattermost-redux/constants';\r\n\r\nimport {openModal} from 'actions/views/modals';\r\n\r\nimport EditChannelHeaderModal from 'components/edit_channel_header_modal';\r\nimport ChannelPermissionGate from 'components/permissions_gates/channel_permission_gate';\r\n\r\nimport {\r\n    Constants,\r\n    ModalIdentifiers,\r\n} from 'utils/constants';\r\nimport {isChannelNamesMap} from 'utils/text_formatting';\r\n\r\nimport {ChannelHeaderTextPopover} from './channel_header_text_popover';\r\n\r\ninterface Props {\r\n    teamId: Team['id'];\r\n    channel: Channel;\r\n    dmUser?: UserProfile;\r\n}\r\n\r\nexport default function ChannelHeaderText(props: Props) {\r\n    const isArchivedChannel = props.channel.delete_at !== 0;\r\n    const isDirectChannel = props.channel.type === Constants.DM_CHANNEL;\r\n    const isGroupChannel = props.channel.type === Constants.GM_CHANNEL;\r\n    const isBotDMChannel = isDirectChannel && (props.dmUser?.is_bot ?? false);\r\n    const isPrivateChannel = props.channel.type === Constants.PRIVATE_CHANNEL;\r\n    const headerText = isBotDMChannel ? props.dmUser?.bot_description ?? '' : props.channel?.header ?? '';\r\n    const hasHeaderText = headerText.trim().length > 0;\r\n\r\n    // If it has a channel then show the channel irrespective of the channel type/state etc\r\n    if (hasHeaderText) {\r\n        return (\r\n            <ChannelHeaderTextPopover\r\n                text={headerText}\r\n                channelMentionsNameMap={\r\n                    isChannelNamesMap(props.channel?.props?.channel_mentions) ? props.channel.props.channel_mentions : undefined\r\n                }\r\n            />\r\n        );\r\n    }\r\n\r\n    // If doesn't have a header text then we need to check based on below\r\n    // conditions if we need to show button to add or not\r\n\r\n    if (isArchivedChannel) {\r\n        return null;\r\n    }\r\n\r\n    if (isBotDMChannel) {\r\n        return null;\r\n    }\r\n\r\n    if (isDirectChannel || isGroupChannel) {\r\n        return <AddChannelHeaderTextButton channel={props.channel}/>;\r\n    }\r\n\r\n    // should show option to add channel header text for any channel\r\n    // other than a DM or a GM or a Bot DM based on user's permission\r\n    return (\r\n        <ChannelPermissionGate\r\n            channelId={props.channel.id}\r\n            teamId={props.teamId}\r\n            permissions={[\r\n                isPrivateChannel ? Permissions.MANAGE_PRIVATE_CHANNEL_PROPERTIES : Permissions.MANAGE_PUBLIC_CHANNEL_PROPERTIES,\r\n            ]}\r\n        >\r\n            <AddChannelHeaderTextButton channel={props.channel}/>\r\n        </ChannelPermissionGate>\r\n    );\r\n}\r\n\r\nfunction AddChannelHeaderTextButton({channel}: {channel: Channel}) {\r\n    const dispatch = useDispatch();\r\n\r\n    function handleClick() {\r\n        dispatch(openModal({\r\n            modalId: ModalIdentifiers.EDIT_CHANNEL_HEADER,\r\n            dialogType: EditChannelHeaderModal,\r\n            dialogProps: {channel},\r\n        }));\r\n    }\r\n\r\n    return (\r\n        <button\r\n            className='header-placeholder style--none'\r\n            onClick={handleClick}\r\n        >\r\n            <FormattedMessage\r\n                id='channel_header.headerText.addNewButton'\r\n                defaultMessage='Add a channel header'\r\n            />\r\n            <i\r\n                className='icon icon-pencil-outline edit-icon'\r\n                aria-hidden={true}\r\n            />\r\n        </button>\r\n    );\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React, {memo, useCallback, useRef} from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\nimport {useSelector, useDispatch} from 'react-redux';\r\n\r\nimport {favoriteChannel, unfavoriteChannel} from 'mattermost-redux/actions/channels';\r\nimport {getCurrentChannel, isCurrentChannelFavorite} from 'mattermost-redux/selectors/entities/channels';\r\n\r\nimport WithTooltip from 'components/with_tooltip';\r\n\r\nimport type {A11yFocusEventDetail} from 'utils/constants';\r\nimport {A11yCustomEventTypes} from 'utils/constants';\r\n\r\nconst ChannelHeaderTitleFavorite = () => {\r\n    const intl = useIntl();\r\n    const dispatch = useDispatch();\r\n    const isFavorite = useSelector(isCurrentChannelFavorite);\r\n    const channel = useSelector(getCurrentChannel);\r\n    const channelIsArchived = (channel?.delete_at ?? 0) > 0;\r\n    const favIconRef = useRef<HTMLButtonElement>(null);\r\n\r\n    const toggleFavoriteCallback = useCallback((e: React.MouseEvent<HTMLButtonElement>) => {\r\n        e.stopPropagation();\r\n        if (!channel) {\r\n            return;\r\n        }\r\n        if (isFavorite) {\r\n            dispatch(unfavoriteChannel(channel.id));\r\n        } else {\r\n            dispatch(favoriteChannel(channel.id));\r\n        }\r\n        requestAnimationFrame(() => {\r\n            if (favIconRef.current) {\r\n                document.dispatchEvent(\r\n                    new CustomEvent<A11yFocusEventDetail>(A11yCustomEventTypes.FOCUS, {\r\n                        detail: {\r\n                            target: favIconRef.current,\r\n                            keyboardOnly: false,\r\n                        },\r\n                    }),\r\n                );\r\n            }\r\n        });\r\n    }, [isFavorite, channel, dispatch]);\r\n\r\n    if (!channel || channelIsArchived) {\r\n        return null;\r\n    }\r\n\r\n    let ariaLabel = intl.formatMessage({id: 'channelHeader.addToFavorites', defaultMessage: 'Add to Favorites'});\r\n    if (isFavorite) {\r\n        ariaLabel = intl.formatMessage({id: 'channelHeader.removeFromFavorites', defaultMessage: 'Remove from Favorites'});\r\n    }\r\n    ariaLabel = ariaLabel.toLowerCase();\r\n\r\n    const title = (\r\n        <>\r\n            {!isFavorite &&\r\n                <FormattedMessage\r\n                    id='channelHeader.addToFavorites'\r\n                    defaultMessage='Add to Favorites'\r\n                />}\r\n            {isFavorite &&\r\n                <FormattedMessage\r\n                    id='channelHeader.removeFromFavorites'\r\n                    defaultMessage='Remove from Favorites'\r\n                />}\r\n        </>\r\n    );\r\n\r\n    return (\r\n        <WithTooltip\r\n            title={title}\r\n        >\r\n            <button\r\n                id='toggleFavorite'\r\n                onClick={toggleFavoriteCallback}\r\n                className={classNames('channel-header__favorites btn btn-icon btn-xs', {active: isFavorite, inactive: !isFavorite})}\r\n                aria-label={ariaLabel}\r\n                ref={favIconRef}\r\n            >\r\n                <i className={classNames('icon', {'icon-star': isFavorite, 'icon-star-outline': !isFavorite})}/>\r\n            </button>\r\n        </WithTooltip>\r\n    );\r\n};\r\n\r\nexport default memo(ChannelHeaderTitleFavorite);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {ReactNode} from 'react';\r\nimport React, {memo} from 'react';\r\nimport {useSelector} from 'react-redux';\r\n\r\nimport type {UserProfile} from '@mattermost/types/users';\r\n\r\nimport {Client4} from 'mattermost-redux/client';\r\nimport {getCurrentChannel} from 'mattermost-redux/selectors/entities/channels';\r\n\r\nimport ProfilePicture from 'components/profile_picture';\r\nimport SharedChannelIndicator from 'components/shared_channel_indicator';\r\nimport ArchiveIcon from 'components/widgets/icons/archive_icon';\r\nimport BotTag from 'components/widgets/tag/bot_tag';\r\n\r\nimport {Constants} from 'utils/constants';\r\n\r\nimport ChannelHeaderTitleDirect from './channel_header_title_direct';\r\nimport ChannelHeaderTitleFavorite from './channel_header_title_favorite';\r\nimport ChannelHeaderTitleGroup from './channel_header_title_group';\r\n\r\nimport ChannelHeaderMenu from '../channel_header_menu/channel_header_menu';\r\n\r\ntype Props = {\r\n    dmUser?: UserProfile;\r\n    gmMembers?: UserProfile[];\r\n    remoteNames?: string[];\r\n}\r\n\r\nconst ChannelHeaderTitle = ({\r\n    dmUser,\r\n    gmMembers,\r\n    remoteNames,\r\n}: Props) => {\r\n    const channel = useSelector(getCurrentChannel);\r\n\r\n    if (!channel) {\r\n        return null;\r\n    }\r\n\r\n    const isDirect = (channel.type === Constants.DM_CHANNEL);\r\n    const isGroup = (channel.type === Constants.GM_CHANNEL);\r\n    const channelIsArchived = channel.delete_at !== 0;\r\n\r\n    let archivedIcon;\r\n    if (channelIsArchived) {\r\n        archivedIcon = <ArchiveIcon className='icon icon__archive icon channel-header-archived-icon svg-text-color'/>;\r\n    }\r\n\r\n    let sharedIcon;\r\n    if (channel.shared) {\r\n        sharedIcon = (\r\n            <SharedChannelIndicator\r\n                className='shared-channel-icon'\r\n                withTooltip={true}\r\n                remoteNames={remoteNames}\r\n            />\r\n        );\r\n    }\r\n\r\n    let channelTitle: ReactNode = channel.display_name;\r\n    if (isDirect) {\r\n        channelTitle = <ChannelHeaderTitleDirect dmUser={dmUser}/>;\r\n    } else if (isGroup) {\r\n        channelTitle = <ChannelHeaderTitleGroup gmMembers={gmMembers}/>;\r\n    }\r\n\r\n    if (isDirect && dmUser?.is_bot) {\r\n        return (\r\n            <div\r\n                id='channelHeaderDropdownButton'\r\n                className='channel-header__bot'\r\n            >\r\n                <ChannelHeaderTitleFavorite/>\r\n                <ProfilePicture\r\n                    src={Client4.getProfilePictureUrl(dmUser.id, dmUser.last_picture_update)}\r\n                    size='sm'\r\n                />\r\n                <strong\r\n                    id='channelHeaderTitle'\r\n                    className='heading'\r\n                >\r\n                    <span>\r\n                        {archivedIcon}\r\n                        {channelTitle}\r\n                    </span>\r\n                </strong>\r\n                <BotTag/>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className='channel-header__top'>\r\n            <ChannelHeaderTitleFavorite/>\r\n            {isDirect && dmUser && ( // Check if it's a DM and dmUser is provided\r\n                <ProfilePicture\r\n                    src={Client4.getProfilePictureUrl(dmUser.id, dmUser.last_picture_update)}\r\n                    size='sm'\r\n                    status={channel.status}\r\n                />\r\n            )}\r\n            <ChannelHeaderMenu\r\n                dmUser={dmUser}\r\n                gmMembers={gmMembers}\r\n                sharedIcon={sharedIcon}\r\n                archivedIcon={archivedIcon}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default memo(ChannelHeaderTitle);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback} from 'react';\r\nimport {useIntl} from 'react-intl';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\nimport styled from 'styled-components';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\n\r\nimport {closeRightHandSide, showChannelInfo} from 'actions/views/rhs';\r\nimport {getIsRhsOpen, getRhsState} from 'selectors/rhs';\r\n\r\nimport {RHSStates} from 'utils/constants';\r\n\r\nimport type {RhsState} from 'types/store/rhs';\r\n\r\nimport HeaderIconWrapper from './components/header_icon_wrapper';\r\n\r\ninterface Props {\r\n    channel: Channel;\r\n}\r\n\r\nconst Icon = styled.i`\r\n    font-size:18px;\r\n    line-height:18px;\r\n    display: inline-flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n`;\r\n\r\nconst ChannelInfoButton = ({channel}: Props) => {\r\n    const dispatch = useDispatch();\r\n    const intl = useIntl();\r\n\r\n    const rhsState: RhsState = useSelector(getRhsState);\r\n    const isRhsOpen: boolean = useSelector(getIsRhsOpen);\r\n    const isChannelInfo = rhsState === RHSStates.CHANNEL_INFO ||\r\n        rhsState === RHSStates.CHANNEL_MEMBERS ||\r\n        rhsState === RHSStates.CHANNEL_FILES ||\r\n        rhsState === RHSStates.PIN;\r\n\r\n    const buttonActive = isRhsOpen && isChannelInfo;\r\n    const toggleRHS = useCallback(() => {\r\n        if (buttonActive) {\r\n            const action = isChannelInfo ? closeRightHandSide() : showChannelInfo(channel.id);\r\n            dispatch(action);\r\n        } else {\r\n            dispatch(showChannelInfo(channel.id));\r\n        }\r\n    }, [buttonActive, channel.id, isChannelInfo, dispatch]);\r\n\r\n    let tooltip;\r\n    if (buttonActive) {\r\n        tooltip = intl.formatMessage({id: 'channel_header.closeChannelInfo', defaultMessage: 'Close info'});\r\n    } else {\r\n        tooltip = intl.formatMessage({id: 'channel_header.openChannelInfo', defaultMessage: 'View Info'});\r\n    }\r\n\r\n    let buttonClass = 'channel-header__icon';\r\n    if (buttonActive) {\r\n        buttonClass += ' channel-header__icon--active-inverted';\r\n    }\r\n\r\n    return (\r\n        <HeaderIconWrapper\r\n            buttonClass={buttonClass}\r\n            buttonId='channel-info-btn'\r\n            onClick={toggleRHS}\r\n            tooltip={tooltip}\r\n        >\r\n            <Icon className='icon-information-outline'/>\r\n        </HeaderIconWrapper>\r\n    );\r\n};\r\n\r\nexport default ChannelInfoButton;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\nimport type {MouseEvent, ReactNode, RefObject} from 'react';\r\nimport {FormattedMessage, injectIntl} from 'react-intl';\r\nimport type {WrappedComponentProps} from 'react-intl';\r\n\r\nimport CustomStatusEmoji from 'components/custom_status/custom_status_emoji';\r\nimport CustomStatusText from 'components/custom_status/custom_status_text';\r\nimport Timestamp from 'components/timestamp';\r\nimport WithTooltip from 'components/with_tooltip';\r\n\r\nimport CallButton from 'plugins/call_button';\r\nimport ChannelHeaderPlug from 'plugins/channel_header_plug';\r\nimport {\r\n    Constants,\r\n    NotificationLevels,\r\n    RHSStates,\r\n} from 'utils/constants';\r\nimport {isEmptyObject} from 'utils/utils';\r\n\r\nimport ChannelHeaderText from './channel_header_text';\r\nimport ChannelHeaderTitle from './channel_header_title';\r\nimport ChannelInfoButton from './channel_info_button';\r\nimport HeaderIconWrapper from './components/header_icon_wrapper';\r\n\r\nimport type {PropsFromRedux} from './index';\r\n\r\nexport type Props = WrappedComponentProps & PropsFromRedux;\r\n\r\nclass ChannelHeader extends React.PureComponent<Props> {\r\n    toggleFavoriteRef: RefObject<HTMLButtonElement>;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n        this.toggleFavoriteRef = React.createRef();\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.props.actions.getCustomEmojisInText(this.props.channel ? this.props.channel.header : '');\r\n\r\n        // Fetch remote names for shared channels on initial mount\r\n        if (this.props.channel?.shared) {\r\n            // Don't force refresh on initial load, use cached data if available\r\n            this.props.actions.fetchChannelRemotes(this.props.channel.id);\r\n        }\r\n    }\r\n\r\n    componentDidUpdate(prevProps: Props) {\r\n        const header = this.props.channel ? this.props.channel.header : '';\r\n        const prevHeader = prevProps.channel ? prevProps.channel.header : '';\r\n        if (header !== prevHeader) {\r\n            this.props.actions.getCustomEmojisInText(header);\r\n        }\r\n\r\n        // Fetch remote names when channel changes or when a channel becomes shared\r\n        if (this.props.channel?.shared) {\r\n            if (this.props.channel.id !== prevProps.channel?.id) {\r\n                // For regular channel changes, use cached data if available\r\n                this.props.actions.fetchChannelRemotes(this.props.channel.id);\r\n            } else if (this.props.channel.shared !== prevProps.channel?.shared) {\r\n                // Only force refresh when a channel's shared status changes\r\n                this.props.actions.fetchChannelRemotes(this.props.channel.id, true);\r\n            }\r\n        }\r\n    }\r\n\r\n    unmute = () => {\r\n        const {actions, channel, channelMember, currentUser} = this.props;\r\n\r\n        if (!channelMember || !currentUser || !channel) {\r\n            return;\r\n        }\r\n\r\n        const options = {mark_unread: NotificationLevels.ALL};\r\n        actions.updateChannelNotifyProps(currentUser.id, channel.id, options);\r\n    };\r\n\r\n    showPinnedPosts = (e: MouseEvent<HTMLButtonElement>) => {\r\n        e.preventDefault();\r\n        if (this.props.rhsState === RHSStates.PIN) {\r\n            this.props.actions.closeRightHandSide();\r\n        } else {\r\n            this.props.actions.showPinnedPosts();\r\n        }\r\n    };\r\n\r\n    showChannelFiles = () => {\r\n        if (this.props.rhsState === RHSStates.CHANNEL_FILES) {\r\n            this.props.actions.closeRightHandSide();\r\n        } else if (this.props.channel) {\r\n            this.props.actions.showChannelFiles(this.props.channel.id);\r\n        }\r\n    };\r\n\r\n    toggleChannelMembersRHS = () => {\r\n        if (this.props.rhsState === RHSStates.CHANNEL_MEMBERS) {\r\n            this.props.actions.closeRightHandSide();\r\n        } else if (this.props.channel) {\r\n            this.props.actions.showChannelMembers(this.props.channel.id);\r\n        }\r\n    };\r\n\r\n    renderCustomStatus = () => {\r\n        const {customStatus, isCustomStatusEnabled, isCustomStatusExpired} = this.props;\r\n        const isStatusSet = !isCustomStatusExpired && (customStatus?.text || customStatus?.emoji);\r\n        if (!(isCustomStatusEnabled && isStatusSet)) {\r\n            return null;\r\n        }\r\n\r\n        return (\r\n            <div className='custom-emoji__wrapper'>\r\n                <CustomStatusEmoji\r\n                    userID={this.props.dmUser?.id}\r\n                    showTooltip={true}\r\n                    emojiStyle={{\r\n                        verticalAlign: 'top',\r\n                        margin: '0 4px 1px',\r\n                    }}\r\n                />\r\n                <CustomStatusText\r\n                    text={customStatus?.text}\r\n                    className='custom-emoji__text'\r\n                />\r\n            </div>\r\n        );\r\n    };\r\n\r\n    render() {\r\n        const {\r\n            teamId,\r\n            currentUser,\r\n            gmMembers,\r\n            channel,\r\n            channelMember,\r\n            isChannelMuted,\r\n            dmUser,\r\n            rhsState,\r\n            hasGuests,\r\n            hideGuestTags,\r\n        } = this.props;\r\n        if (!channel) {\r\n            return null;\r\n        }\r\n\r\n        const ariaLabelChannelHeader = this.props.intl.formatMessage({id: 'accessibility.sections.channelHeader', defaultMessage: 'channel header region'});\r\n\r\n        let hasGuestsText: ReactNode = '';\r\n        if (hasGuests && !hideGuestTags) {\r\n            hasGuestsText = (\r\n                <span className='has-guest-header'>\r\n                    <span tabIndex={0}>\r\n                        <FormattedMessage\r\n                            id='channel_header.channelHasGuests'\r\n                            defaultMessage='Channel has guests'\r\n                        />\r\n                    </span>\r\n                </span>\r\n            );\r\n        }\r\n\r\n        if (isEmptyObject(channel) ||\r\n            isEmptyObject(channelMember) ||\r\n            isEmptyObject(currentUser) ||\r\n            (!dmUser && channel.type === Constants.DM_CHANNEL)\r\n        ) {\r\n            // Use an empty div to make sure the header's height stays constant\r\n            return (\r\n                <div className='channel-header'/>\r\n            );\r\n        }\r\n\r\n        const isDirect = (channel.type === Constants.DM_CHANNEL);\r\n        const isGroup = (channel.type === Constants.GM_CHANNEL);\r\n\r\n        if (isGroup) {\r\n            if (hasGuests && !hideGuestTags) {\r\n                hasGuestsText = (\r\n                    <span className='has-guest-header'>\r\n                        <FormattedMessage\r\n                            id='channel_header.groupMessageHasGuests'\r\n                            defaultMessage='This group message has guests'\r\n                        />\r\n                    </span>\r\n                );\r\n            }\r\n        }\r\n\r\n        let dmHeaderTextStatus: ReactNode;\r\n        if (isDirect && !dmUser?.delete_at && !dmUser?.is_bot) {\r\n            dmHeaderTextStatus = (\r\n                <span className='header-status__text'>\r\n                    {this.renderCustomStatus()}\r\n                </span>\r\n            );\r\n\r\n            if (this.props.isLastActiveEnabled && this.props.lastActivityTimestamp && this.props.timestampUnits) {\r\n                dmHeaderTextStatus = (\r\n                    <span className='header-status__text'>\r\n                        <span className='last-active__text'>\r\n                            <FormattedMessage\r\n                                id='channel_header.lastActive'\r\n                                defaultMessage='Active {timestamp}'\r\n                                values={{\r\n                                    timestamp: (\r\n                                        <Timestamp\r\n                                            value={this.props.lastActivityTimestamp}\r\n                                            units={this.props.timestampUnits}\r\n                                            useTime={false}\r\n                                            style={'short'}\r\n                                        />\r\n                                    ),\r\n                                }}\r\n                            />\r\n                        </span>\r\n                        {this.renderCustomStatus()}\r\n                    </span>\r\n                );\r\n            }\r\n        }\r\n\r\n        const channelFilesIconClass = classNames('channel-header__icon channel-header__icon--left btn btn-icon btn-xs ', {\r\n            'channel-header__icon--active': rhsState === RHSStates.CHANNEL_FILES,\r\n        });\r\n        const channelFilesIcon = <i className='icon icon-file-text-outline'/>;\r\n        const pinnedIconClass = classNames('channel-header__icon channel-header__icon--wide channel-header__icon--left btn btn-icon btn-xs', {\r\n            'channel-header__icon--active': rhsState === RHSStates.PIN,\r\n        });\r\n        const pinnedIcon = this.props.pinnedPostsCount ? (\r\n            <>\r\n                <i\r\n                    aria-hidden='true'\r\n                    className='icon icon-pin-outline channel-header__pin'\r\n                />\r\n                <span\r\n                    id='channelPinnedPostCountText'\r\n                    className='icon__text'\r\n                >\r\n                    {this.props.pinnedPostsCount}\r\n                </span>\r\n            </>\r\n        ) : (\r\n            <i\r\n                aria-hidden='true'\r\n                className='icon icon-pin-outline channel-header__pin'\r\n            />\r\n        );\r\n\r\n        const pinnedButton = this.props.pinnedPostsCount ? (\r\n            <HeaderIconWrapper\r\n                buttonClass={pinnedIconClass}\r\n                buttonId={'channelHeaderPinButton'}\r\n                onClick={this.showPinnedPosts}\r\n                tooltip={this.props.intl.formatMessage({id: 'channel_header.pinnedPosts', defaultMessage: 'Pinned messages'})}\r\n            >\r\n                {pinnedIcon}\r\n            </HeaderIconWrapper>\r\n        ) : (\r\n            null\r\n        );\r\n\r\n        let memberListButton = null;\r\n        if (!isDirect) {\r\n            const membersIconClass = classNames('member-rhs__trigger channel-header__icon channel-header__icon--wide channel-header__icon--left btn btn-icon btn-xs', {\r\n                'channel-header__icon--active': rhsState === RHSStates.CHANNEL_MEMBERS,\r\n            });\r\n            const membersIcon = this.props.memberCount ? (\r\n                <>\r\n                    <i\r\n                        aria-hidden='true'\r\n                        className='icon icon-account-outline channel-header__members'\r\n                    />\r\n                    <span\r\n                        id='channelMemberCountText'\r\n                        className='icon__text'\r\n                    >\r\n                        {this.props.memberCount}\r\n                    </span>\r\n                </>\r\n            ) : (\r\n                <>\r\n                    <i\r\n                        aria-hidden='true'\r\n                        className='icon icon-account-outline channel-header__members'\r\n                    />\r\n                    <span\r\n                        id='channelMemberCountText'\r\n                        className='icon__text'\r\n                    >\r\n                        {'-'}\r\n                    </span>\r\n                </>\r\n            );\r\n\r\n            memberListButton = (\r\n                <HeaderIconWrapper\r\n                    tooltip={this.props.intl.formatMessage({id: 'channel_header.channelMembers', defaultMessage: 'Members'})}\r\n                    buttonClass={membersIconClass}\r\n                    buttonId={'member_rhs'}\r\n                    onClick={this.toggleChannelMembersRHS}\r\n                >\r\n                    {membersIcon}\r\n                </HeaderIconWrapper>\r\n            );\r\n        }\r\n\r\n        let muteTrigger;\r\n        if (isChannelMuted) {\r\n            muteTrigger = (\r\n                <WithTooltip\r\n                    title={\r\n                        <FormattedMessage\r\n                            id='channelHeader.unmute'\r\n                            defaultMessage='Unmute'\r\n                        />\r\n                    }\r\n                >\r\n                    <button\r\n                        id='toggleMute'\r\n                        onClick={this.unmute}\r\n                        className={'channel-header__mute inactive btn btn-icon btn-xs'}\r\n                        aria-label={this.props.intl.formatMessage({id: 'channelHeader.unmute', defaultMessage: 'Unmute'})}\r\n                    >\r\n                        <i\r\n                            className={'icon icon-bell-off-outline'}\r\n                            aria-hidden={true}\r\n                        />\r\n                    </button>\r\n                </WithTooltip>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div\r\n                id='channel-header'\r\n                aria-label={ariaLabelChannelHeader}\r\n                role='banner'\r\n                tabIndex={-1}\r\n                data-channelid={`${channel.id}`}\r\n                className='channel-header alt a11y__region'\r\n                data-a11y-sort-order='8'\r\n            >\r\n                <div className='flex-parent'>\r\n                    <div className='flex-child'>\r\n                        <div\r\n                            id='channelHeaderInfo'\r\n                            className='channel-header__info'\r\n                        >\r\n                            <div\r\n                                className='channel-header__title dropdown'\r\n                            >\r\n                                <ChannelHeaderTitle\r\n                                    dmUser={dmUser}\r\n                                    gmMembers={gmMembers}\r\n                                    remoteNames={this.props.remoteNames}\r\n                                />\r\n                                <div\r\n                                    className='channel-header__icons'\r\n                                >\r\n                                    {muteTrigger}\r\n                                    {memberListButton}\r\n                                    {pinnedButton}\r\n                                    {this.props.isFileAttachmentsEnabled &&\r\n                                        <HeaderIconWrapper\r\n                                            buttonClass={channelFilesIconClass}\r\n                                            buttonId={'channelHeaderFilesButton'}\r\n                                            onClick={this.showChannelFiles}\r\n                                            tooltip={this.props.intl.formatMessage({id: 'channel_header.channelFiles', defaultMessage: 'Channel files'})}\r\n                                        >\r\n                                            {channelFilesIcon}\r\n                                        </HeaderIconWrapper>\r\n                                    }\r\n                                </div>\r\n                                <div\r\n                                    id='channelHeaderDescription'\r\n                                    className='channel-header__description'\r\n                                >\r\n                                    {dmHeaderTextStatus}\r\n                                    {hasGuestsText}\r\n                                    <ChannelHeaderText\r\n                                        teamId={teamId}\r\n                                        channel={channel}\r\n                                        dmUser={dmUser}\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    {(!channel.shared || this.props.sharedChannelsPluginsEnabled) && (\r\n                        <>\r\n                            <ChannelHeaderPlug\r\n                                channel={channel}\r\n                                channelMember={channelMember}\r\n                            />\r\n                            <CallButton/>\r\n                        </>\r\n                    )}\r\n                    <ChannelInfoButton channel={channel}/>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default injectIntl(ChannelHeader);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {ConnectedProps} from 'react-redux';\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {\r\n    updateChannelNotifyProps,\r\n} from 'mattermost-redux/actions/channels';\r\nimport {getCustomEmojisInText} from 'mattermost-redux/actions/emojis';\r\nimport {fetchChannelRemotes} from 'mattermost-redux/actions/shared_channels';\r\nimport {General} from 'mattermost-redux/constants';\r\nimport {\r\n    getCurrentChannel,\r\n    getMyCurrentChannelMembership,\r\n    isCurrentChannelMuted,\r\n    getCurrentChannelStats,\r\n} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getConfig, getFeatureFlagValue} from 'mattermost-redux/selectors/entities/general';\r\nimport {getRemoteNamesForChannel} from 'mattermost-redux/selectors/entities/shared_channels';\r\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\r\nimport {\r\n    displayLastActiveLabel,\r\n    getCurrentUser,\r\n    getLastActiveTimestampUnits,\r\n    getLastActivityForUserId,\r\n    getUser,\r\n    makeGetProfilesInChannel,\r\n} from 'mattermost-redux/selectors/entities/users';\r\nimport {getUserIdFromChannelName} from 'mattermost-redux/utils/channel_utils';\r\n\r\nimport {\r\n    showPinnedPosts,\r\n    showChannelFiles,\r\n    closeRightHandSide,\r\n    showChannelMembers,\r\n} from 'actions/views/rhs';\r\nimport {getRhsState} from 'selectors/rhs';\r\nimport {makeGetCustomStatus, isCustomStatusEnabled, isCustomStatusExpired} from 'selectors/views/custom_status';\r\n\r\nimport {isFileAttachmentsEnabled} from 'utils/file_utils';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport ChannelHeader from './channel_header';\r\n\r\nfunction makeMapStateToProps() {\r\n    const doGetProfilesInChannel = makeGetProfilesInChannel();\r\n    const getCustomStatus = makeGetCustomStatus();\r\n    let timestampUnits: string[] = [];\r\n\r\n    return function mapStateToProps(state: GlobalState) {\r\n        const channel = getCurrentChannel(state);\r\n        const user = getCurrentUser(state);\r\n        const config = getConfig(state);\r\n        const sharedChannelsPluginsEnabled = getFeatureFlagValue(state, 'EnableSharedChannelsPlugins') === 'true';\r\n\r\n        let dmUser;\r\n        let gmMembers;\r\n        let customStatus;\r\n        let lastActivityTimestamp;\r\n        let remoteNames: string[] = [];\r\n\r\n        if (channel && channel.type === General.DM_CHANNEL) {\r\n            const dmUserId = getUserIdFromChannelName(user.id, channel.name);\r\n            dmUser = getUser(state, dmUserId);\r\n            customStatus = dmUser && getCustomStatus(state, dmUser.id);\r\n            lastActivityTimestamp = dmUser && getLastActivityForUserId(state, dmUser.id);\r\n        } else if (channel && channel.type === General.GM_CHANNEL) {\r\n            gmMembers = doGetProfilesInChannel(state, channel.id);\r\n        }\r\n\r\n        if (channel?.shared) {\r\n            remoteNames = getRemoteNamesForChannel(state, channel.id);\r\n        }\r\n\r\n        const stats = getCurrentChannelStats(state);\r\n\r\n        let isLastActiveEnabled = false;\r\n        if (dmUser) {\r\n            isLastActiveEnabled = displayLastActiveLabel(state, dmUser.id);\r\n            timestampUnits = getLastActiveTimestampUnits(state, dmUser.id);\r\n        }\r\n\r\n        return {\r\n            teamId: getCurrentTeamId(state),\r\n            channel,\r\n            channelMember: getMyCurrentChannelMembership(state),\r\n            memberCount: stats?.member_count || 0,\r\n            currentUser: user,\r\n            dmUser,\r\n            gmMembers,\r\n            remoteNames,\r\n            rhsState: getRhsState(state),\r\n            isChannelMuted: isCurrentChannelMuted(state),\r\n            hasGuests: stats ? stats.guest_count > 0 : false,\r\n            pinnedPostsCount: stats?.pinnedpost_count || 0,\r\n            customStatus,\r\n            isCustomStatusEnabled: isCustomStatusEnabled(state),\r\n            isCustomStatusExpired: isCustomStatusExpired(state, customStatus),\r\n            lastActivityTimestamp,\r\n            isFileAttachmentsEnabled: isFileAttachmentsEnabled(config),\r\n            isLastActiveEnabled,\r\n            timestampUnits,\r\n            hideGuestTags: config.HideGuestTags === 'true',\r\n            sharedChannelsPluginsEnabled,\r\n        };\r\n    };\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch: Dispatch) => ({\r\n    actions: bindActionCreators({\r\n        showPinnedPosts,\r\n        showChannelFiles,\r\n        closeRightHandSide,\r\n        getCustomEmojisInText,\r\n        updateChannelNotifyProps,\r\n        showChannelMembers,\r\n        fetchChannelRemotes,\r\n    }, dispatch),\r\n});\r\n\r\nconst connector = connect(makeMapStateToProps, mapDispatchToProps);\r\n\r\nexport type PropsFromRedux = ConnectedProps<typeof connector>;\r\n\r\nexport default connector(ChannelHeader);\r\n"],"names":["NewChannelWithBoardTourTip","_ref","pulsatingDotPlacement","pulsatingDotTranslate","dispatch","useDispatch","showTip","useSelector","showNewChannelWithBoardPulsatingDot","title","React","FormattedMessage","id","defaultMessage","screen","tipOpened","setTipOpened","useState","handleDismiss","useCallback","e","stopPropagation","setNewChannelWithBoardPreference","Preferences","NEW_CHANNEL_WITH_BOARD_TOUR_SHOWED","handleOpen","preventDefault","overlayPunchOut","useMeasurePunchouts","y","height","x","width","TourTip","show","placement","step","singleTip","showOptOut","interactivePunchOut","handlePrevious","offset","propTypes","_pt","isRequired","HeaderIconWrapper","props","ariaLabelOverride","buttonClass","buttonId","children","onClick","tooltip","tooltipText","tooltipShortcut","isRhsOpen","pluginId","boardsEnabled","suitePluginIds","focalboard","ariaLabelText","WithTooltip","shortcut","className","connect","state","currentChannel","getCurrentChannel","pluginCallComponents","plugins","components","CallButton","channelMember","getMyCurrentChannelMembership","sidebarOpen","views","rhs","isSidebarOpen","active","setActive","clickEnabled","setClickEnabled","prevSidebarOpen","useRef","formatMessage","useIntl","useEffect","current","setTimeout","Constants","CHANNEL_HEADER_BUTTON_DISABLE_TIMEOUT","length","style","container","marginTop","item","clickHandler","_item$action","action","call","undefined","onTouchEnd","button","items","map","key","_item$action2","dropdownButton","MenuWrapper","onToggle","toggle","classNames","PhoneOutlineIcon","color","toLowerCase","ChevronDownIcon","Menu","ariaLabel","customStyles","top","left","right","PluginChannelHeaderIcon","viewBox","version","role","d","CustomMenu","constructor","arguments","_defineProperty","this","onClose","render","open","rootCloseEvent","RootCloseWrapper","disabled","onRootClose","handleRootClose","event","bsRole","CustomToggle","activeClass","dropdownOpen","type","handleClick","ChannelHeaderPlug","super","setState","toggleDropdown","disableButtonsClosingRHS","channel","plug","_plug$tooltipText","tooltipToAriaLabelHack","intl","stringOrElement","value","dropdownText","fireAction","icon","async","context","createCallContext","binding","app_id","location","team_id","res","actions","handleBindingClick","error","errorResponse","errorMessage","text","postEphemeralCallResponseForChannel","callResp","data","AppCallResponseTypes","OK","NAVIGATE","FORM","form","openAppsModal","concat","onBindingClick","label","src","plugs","appBindings","componentItems","filter","href","fireActionAndClose","appsEnabled","Dropdown","componentDidUpdate","prevProps","shouldShowAppBar","componentButtons","createComponentButton","createAppBindingButton","createDropdown","injectIntl","apps","getChannelHeaderPluginComponents","getChannelHeaderAppBindings","appBarEnabled","theme","getTheme","bindActionCreators","TEXT_IN_HEADER_MARKDOWN_OPTIONS","singleline","TEXT_IN_POPOVER_MARKDOWN_OPTIONS","MENTION_MARKDOWN_OPTIONS","mentionHighlight","atMentions","IMAGE_MARKDOWN_OPTIONS","hideUtilities","TRANSITION_STYLE_PROPS","duration","OverlaysTimings","FADE_IN_DURATION","close","FADE_OUT_DURATION","initial","OverlayTransitionStyles","START","ChannelHeaderTextPopover","currentRelativeTeamUrl","getCurrentRelativeTeamUrl","rootElementRef","isTextOverflowing","elem","match","scrollWidth","clientWidth","scrollHeight","clientHeight","markdownOptions","useMemo","inHeader","_objectSpread","channelNamesMap","channelMentionsNameMap","inPopover","isPopoverOpen","setPopoverOpen","refs","setReference","setFloating","floatingStyles","floatingContext","useFloating","onOpenChange","whileElementsMounted","autoUpdate","middleware","isMounted","styles","transitionStyles","useTransitionStyles","hover","useHover","enabled","handleClose","safePolygon","requireIntent","blockPointerEvents","focus","useFocus","dismiss","useDismiss","click","useClick","useRole","getReferenceProps","getFloatingProps","useInteractions","rootRef","useMergeRefs","maxWidthOfPopover","getMaxWidthOfPopover","handleFormattedTextClick","Object","assign","ref","Markdown","message","options","imageProps","FloatingPortal","RootHtmlPortalId","FloatingOverlay","lockScroll","maxWidth","ChannelHeaderText","_props$dmUser$is_bot","_props$dmUser","_props$dmUser$bot_des","_props$dmUser2","_props$channel$header","_props$channel","isArchivedChannel","delete_at","isDirectChannel","DM_CHANNEL","isGroupChannel","GM_CHANNEL","isBotDMChannel","dmUser","is_bot","isPrivateChannel","PRIVATE_CHANNEL","headerText","bot_description","header","_props$channel2","_props$channel2$props","trim","isChannelNamesMap","channel_mentions","AddChannelHeaderTextButton","ChannelPermissionGate","channelId","teamId","permissions","Permissions","MANAGE_PRIVATE_CHANNEL_PROPERTIES","MANAGE_PUBLIC_CHANNEL_PROPERTIES","openModal","modalId","ModalIdentifiers","EDIT_CHANNEL_HEADER","dialogType","EditChannelHeaderModal","dialogProps","ChannelHeaderTitleFavorite","_channel$delete_at","isFavorite","isCurrentChannelFavorite","channelIsArchived","favIconRef","toggleFavoriteCallback","unfavoriteChannel","favoriteChannel","requestAnimationFrame","document","dispatchEvent","CustomEvent","A11yCustomEventTypes","FOCUS","detail","target","keyboardOnly","inactive","memo","ChannelHeaderTitle","gmMembers","remoteNames","isDirect","isGroup","archivedIcon","sharedIcon","ArchiveIcon","shared","SharedChannelIndicator","withTooltip","channelTitle","display_name","ChannelHeaderTitleDirect","ChannelHeaderTitleGroup","ProfilePicture","Client4","getProfilePictureUrl","last_picture_update","size","BotTag","status","ChannelHeaderMenu","Icon","styled","withConfig","displayName","rhsState","getRhsState","getIsRhsOpen","isChannelInfo","RHSStates","CHANNEL_INFO","CHANNEL_MEMBERS","CHANNEL_FILES","PIN","buttonActive","toggleRHS","closeRightHandSide","showChannelInfo","ChannelHeader","currentUser","mark_unread","NotificationLevels","ALL","updateChannelNotifyProps","showPinnedPosts","showChannelFiles","showChannelMembers","_this$props$dmUser","customStatus","isCustomStatusEnabled","isCustomStatusExpired","isStatusSet","emoji","CustomStatusEmoji","userID","showTooltip","emojiStyle","verticalAlign","margin","CustomStatusText","toggleFavoriteRef","componentDidMount","_this$props$channel","getCustomEmojisInText","fetchChannelRemotes","_this$props$channel2","_prevProps$channel","_prevProps$channel2","isChannelMuted","hasGuests","hideGuestTags","ariaLabelChannelHeader","hasGuestsText","tabIndex","isEmptyObject","dmHeaderTextStatus","renderCustomStatus","isLastActiveEnabled","lastActivityTimestamp","timestampUnits","values","timestamp","Timestamp","units","useTime","channelFilesIconClass","channelFilesIcon","pinnedIconClass","pinnedIcon","pinnedPostsCount","pinnedButton","muteTrigger","memberListButton","membersIconClass","membersIcon","memberCount","toggleChannelMembersRHS","unmute","isFileAttachmentsEnabled","sharedChannelsPluginsEnabled","ChannelInfoButton","doGetProfilesInChannel","makeGetProfilesInChannel","getCustomStatus","makeGetCustomStatus","user","getCurrentUser","config","getConfig","getFeatureFlagValue","General","dmUserId","getUserIdFromChannelName","name","getUser","getLastActivityForUserId","getRemoteNamesForChannel","stats","getCurrentChannelStats","displayLastActiveLabel","getLastActiveTimestampUnits","getCurrentTeamId","member_count","isCurrentChannelMuted","guest_count","pinnedpost_count","HideGuestTags"],"sourceRoot":""}