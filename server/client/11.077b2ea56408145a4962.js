"use strict";(self.webpackChunkmattermost_webapp=self.webpackChunkmattermost_webapp||[]).push([[11],{92600:(e,t,i)=>{i.d(t,{A:()=>u});var n=i(37270),a=i(26614),l=i(68124),s=i(62688),o=i.n(s),r=i(36418),c=i.n(r),m=i(14778),d=i(85873);const h=e=>{let{fileInfo:t,fileUrl:i,canDownloadFiles:n}=e;const a=(0,m.useIntl)(),l=[];""!==t.extension&&l.push(a.formatMessage({id:"file_info_preview.type",defaultMessage:"File type "})+t.extension.toUpperCase()),t.size&&l.push(a.formatMessage({id:"file_info_preview.size",defaultMessage:"Size "})+d.O1(t.size));const s=l.join(", ");let o=null;return o=n?c().createElement("a",{className:"file-details__preview",href:i},c().createElement("span",{className:"file-details__preview-helper"}),c().createElement("img",{alt:"file preview",src:d.Xm(t)})):c().createElement("span",{className:"file-details__preview"},c().createElement("span",{className:"file-details__preview-helper"}),c().createElement("img",{alt:"file preview",src:d.Xm(t)})),c().createElement("div",{className:"file-details__container"},o,c().createElement("div",{className:"file-details"},c().createElement("div",{className:"file-details__name"},t.name),c().createElement("div",{className:"file-details__info"},s)))};h.propTypes={fileUrl:o().string.isRequired,canDownloadFiles:o().bool.isRequired};const f=c().memo(h),u=(0,n.connect)((function(e){const t=(0,a.zj)(e);return{canDownloadFiles:(0,l.En)(t)}}))(f)},90011:(e,t,i)=>{i.r(t),i.d(t,{default:()=>me});var n=i(62688),a=i.n(n),l=(i(43813),i(17046),i(4290),i(71633)),s=i.n(l),o=i(36418),r=i.n(o),c=i(89735),m=i(14778),d=i(31655),h=i(85406);function f(e){const t=(0,m.useIntl)().formatMessage({id:"workspace_limits.archived_file.archived",defaultMessage:"This file is archived"}),i=r().createElement("span",{className:"file-details__preview file-details__preview--archived"},r().createElement(h.ArchiveOutlineIcon,{size:80,color:"rgba(var(--center-channel-color-rgb), 0.48)","data-testid":"archived-file-icon"}));return r().createElement("div",{className:"file-details__container"},i,r().createElement("div",{className:"file-details"},r().createElement("div",{className:"file-details__name"},e.fileInfo.name),r().createElement("div",{className:"file-details__info"},t)))}var u=i(37270),p=i(7380),g=i(92600),v=i(78451);function E(e,t,i){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var i=t.call(e,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class w extends r().PureComponent{constructor(e){super(e),E(this,"sourceRef",r().createRef()),E(this,"videoRef",r().createRef()),E(this,"handleFileInfoChanged",(()=>{let e=this.videoRef.current;e||(e=document.createElement("video")),this.setState({canPlay:!0})})),E(this,"handleLoadError",(()=>{this.setState({canPlay:!1})})),E(this,"stop",(()=>{if(this.videoRef.current){const e=this.videoRef.current;e.pause(),e.currentTime=0}})),this.state={canPlay:!0}}componentDidMount(){this.handleFileInfoChanged(),this.sourceRef.current&&this.sourceRef.current.addEventListener("error",this.handleLoadError,{once:!0})}componentDidUpdate(e){this.props.fileUrl!==e.fileUrl&&this.handleFileInfoChanged(),this.sourceRef.current&&this.sourceRef.current.addEventListener("error",this.handleLoadError,{once:!0})}render(){if(!this.state.canPlay)return r().createElement(g.A,{fileInfo:this.props.fileInfo,fileUrl:this.props.fileUrl});let e=v.Ay.WEB_VIDEO_WIDTH,t=v.Ay.WEB_VIDEO_HEIGHT;return this.props.isMobileView&&(e=v.Ay.MOBILE_VIDEO_WIDTH,t=v.Ay.MOBILE_VIDEO_HEIGHT),r().createElement("video",{key:this.props.fileInfo.id,ref:this.videoRef,"data-setup":"{}",controls:!0,width:e,height:t},r().createElement("source",{ref:this.sourceRef,src:this.props.fileUrl}))}}E(w,"propTypes",{fileUrl:a().string.isRequired,isMobileView:a().bool.isRequired});const _=(0,u.connect)((function(e){return{isMobileView:(0,p.w3)(e)}}))(w);i(57406),i(55448);var b=i(53654),I=i(75842);const y=e=>{let{fileInfo:t,fileUrl:i,getContent:n}=e;const[a,l]=(0,o.useState)({code:"",lang:"",highlighted:""}),[s,c]=(0,o.useState)("loading");if((0,o.useEffect)((()=>{const e=I.od(t.extension);if(!e||t.size>v.Ay.CODE_PREVIEW_MAX_FILE_SIZE)return l({code:"",lang:"",highlighted:""}),void c("fail");l({code:"",lang:e,highlighted:""}),c("loading"),(async()=>{try{var t;const a=await fetch(i);let s=await a.text();if(null!==(t=a.headers.get("content-type"))&&void 0!==t&&t.includes("xml"))try{const e=(new DOMParser).parseFromString(s,"text/xml");"#document"===e.nodeName&&(s=(new XMLSerializer).serializeToString(e))}catch(e){}null==n||n(s);const o=await I.Zt(e,s);l({code:s,lang:e,highlighted:o}),c("success")}catch(e){c("fail")}})()}),[i,t.extension,t.size,n]),"loading"===s)return r().createElement("div",{className:"view-image__loading"},r().createElement(b.A,null));if("fail"===s)return r().createElement(g.A,{fileInfo:t,fileUrl:i});const m=I.OT(a.lang);return r().createElement("div",{className:"post-code code-preview"},r().createElement("span",{className:"post-code__language"},"".concat(t.name," - ").concat(m)),r().createElement("div",{className:"hljs"},r().createElement("div",{className:"post-code__line-numbers"},I.bg(a.code)),r().createElement("code",{dangerouslySetInnerHTML:{__html:a.highlighted}})))};y.propTypes={fileUrl:a().string.isRequired,getContent:a().func};const C=r().memo(y);var M=i(7596),N=i(19513),R=i(85873),x=(i(29206),i(65952)),P=i(7430),F=i(18309);const L=(0,P.ml)(),k=e=>{const t=(0,u.useSelector)((t=>{var i,n;return(0,P.wz)(t,null!==(i=null===(n=e.post)||void 0===n?void 0:n.user_id)&&void 0!==i?i:"")})),i=(0,u.useSelector)((t=>{var i,n;return(0,x.s9)()(t,null!==(i=null===(n=e.post)||void 0===n?void 0:n.channel_id)&&void 0!==i?i:"")})),n=(0,u.useSelector)((t=>{var i,n;return L(t,null!==(i=null===(n=e.post)||void 0===n?void 0:n.user_id)&&void 0!==i?i:"",!0)}));let a;const l=i?r().createElement(m.FormattedMessage,{id:"file_preview_modal_info.shared_in",defaultMessage:"Shared in ~{name}",values:{name:i.display_name||i.name}}):null;return a=e.showFileName?r().createElement(r().Fragment,null,r().createElement("h5",{className:"file-preview-modal__file-name"},e.filename),r().createElement("span",{className:"file-preview-modal__file-details"},r().createElement("span",{className:"file-preview-modal__file-details-user-name"},n),r().createElement("span",{className:"file-preview-modal__channel"},l))):r().createElement(r().Fragment,null,r().createElement("h5",{className:"file-preview-modal__user-name"},n),r().createElement("span",{className:"file-preview-modal__channel"},l)),r().createElement("div",{className:"file-preview-modal__info"},e.post&&Object.keys(e.post).length>0&&r().createElement(F.A,{size:"lg",username:null==t?void 0:t.username,url:(0,R.RG)(e.post.user_id,null==t?void 0:t.last_picture_update),className:"file-preview-modal__avatar",alt:""}),r().createElement("div",{className:"file-preview-modal__info-details"},a))};k.propTypes={showFileName:a().bool.isRequired,filename:a().string.isRequired};const O=(0,o.memo)(k);var S=i(42474),A=i(69813),D=i(35301),q=i(17518),T=i(87131);function j(e){return Boolean(e.id)}function U(e){return Boolean(e.link)&&!j(e)}const Z=e=>{let{showOnlyClose:t=!1,showClose:i=!0,showPublicLink:n=!0,filename:a,fileURL:l,fileInfo:s,enablePublicLink:c,canDownloadFiles:d,canCopyContent:h,handleModalClose:f,content:p}=e;const g=(0,m.useIntl)(),E=(0,u.useSelector)((e=>{var t;return null===(t=(0,A.EL)(e))||void 0===t?void 0:t.link})),w=(0,u.useDispatch)(),[_,b]=(0,o.useState)(!1);(0,o.useEffect)((()=>{j(s)&&c&&w((0,S.EL)(s.id))}),[s,c]),(0,o.useEffect)((()=>{_&&setTimeout((()=>{b(!1)}),2e3)}),[_]);const I=g.formatMessage({id:"full_screen_modal.close",defaultMessage:"Close"}),y=r().createElement(T.A,{title:I,key:"publicLink"},r().createElement("button",{className:"file-preview-modal-main-actions__action-item",onClick:f,"aria-label":I},r().createElement("i",{className:"icon icon-close"})));let C;C=_?g.formatMessage({id:"file_preview_modal_main_actions.public_link-copied",defaultMessage:"Public link copied"}):g.formatMessage({id:"view_image_popover.publicLink",defaultMessage:"Get a public link"});const M=r().createElement(T.A,{key:"filePreviewPublicLink",title:C},r().createElement("a",{href:"#",className:"file-preview-modal-main-actions__action-item",onClick:()=>{(0,R.lW)(null!=E?E:""),b(!0)},"aria-label":C},r().createElement("i",{className:"icon icon-link-variant"}))),N=g.formatMessage({id:"view_image_popover.download",defaultMessage:"Download"}),x=r().createElement(T.A,{key:"download",title:N},r().createElement(q.A,{href:l,className:"file-preview-modal-main-actions__action-item",location:"file_preview_modal_main_actions",download:a,"aria-label":N},r().createElement("i",{className:"icon icon-download-outline"}))),P=r().createElement(D.A,{className:"file-preview-modal-main-actions__action-item",isForText:(0,R.ti)(s.extension)===v.a0.TEXT,content:p});return r().createElement("div",{className:"file-preview-modal-main-actions__actions"},!t&&h&&P,!t&&c&&n&&M,!t&&d&&x,i&&y)};Z.propTypes={showOnlyClose:a().bool,showClose:a().bool,showPublicLink:a().bool,filename:a().string.isRequired,fileURL:a().string.isRequired,enablePublicLink:a().bool.isRequired,canDownloadFiles:a().bool.isRequired,canCopyContent:a().bool.isRequired,handleModalClose:a().func.isRequired,content:a().string.isRequired};const z=(0,o.memo)(Z),V=["post"],B=e=>{let{post:t}=e,i=function(e,t){if(null==e)return{};var i,n,a=function(e,t){if(null==e)return{};var i={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;i[n]=e[n]}return i}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)i=l[n],-1===t.indexOf(i)&&{}.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}(e,V);return r().createElement("div",{className:"file-preview-modal-footer"},r().createElement(O,{showFileName:!1,post:t,filename:i.filename}),r().createElement(z,Object.assign({},i,{showClose:!1,showOnlyClose:!1})))};B.propTypes={filename:a().string.isRequired,fileURL:a().string.isRequired,showPublicLink:a().bool,enablePublicLink:a().bool.isRequired,canDownloadFiles:a().bool.isRequired,isExternalFile:a().bool.isRequired,handleModalClose:a().func.isRequired,canCopyContent:a().bool.isRequired,content:a().string.isRequired};const H=(0,o.memo)(B),G=e=>{const{formatMessage:t}=(0,m.useIntl)(),i=r().createElement(T.A,{key:"previewArrowLeft",title:r().createElement(m.FormattedMessage,{id:"generic.close",defaultMessage:"Close"})},r().createElement("button",{id:"previewArrowLeft",className:"file_preview_modal_main_nav__prev",onClick:e.handlePrev,"aria-label":t({id:"file_preview_modal_main_nav.prevAriaLabel",defaultMessage:"Previous file"})},r().createElement("i",{className:"icon icon-chevron-left"}))),n=r().createElement(T.A,{key:"publicLink",title:r().createElement(m.FormattedMessage,{id:"generic.next",defaultMessage:"Next"})},r().createElement("button",{id:"previewArrowRight",className:"file_preview_modal_main_nav__next",onClick:e.handleNext,"aria-label":t({id:"file_preview_modal_main_nav.nextAriaLabel",defaultMessage:"Next file"})},r().createElement("i",{className:"icon icon-chevron-right"})));return r().createElement("div",{className:"file_preview_modal_main_nav"},i,r().createElement("span",{className:"modal-bar-file-count","aria-live":"polite","aria-atomic":"true"},r().createElement(m.FormattedMessage,{id:"file_preview_modal_main_nav.file",defaultMessage:"{count, number} of {total, number}",values:{count:e.fileIndex+1,total:e.totalFiles}})),n)};G.propTypes={fileIndex:a().number.isRequired,totalFiles:a().number.isRequired,handlePrev:a().func.isRequired,handleNext:a().func.isRequired};const W=(0,o.memo)(G),X=["post","totalFiles","fileIndex"],K=e=>{let{post:t,totalFiles:i,fileIndex:n}=e,a=function(e,t){if(null==e)return{};var i,n,a=function(e,t){if(null==e)return{};var i={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;i[n]=e[n]}return i}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)i=l[n],-1===t.indexOf(i)&&{}.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}(e,X),l=r().createElement("div",null);i>1&&(l=r().createElement(W,{totalFiles:i,fileIndex:n,handlePrev:a.handlePrev,handleNext:a.handleNext}));const s=r().createElement(z,Object.assign({},a,{showOnlyClose:a.isMobileView}));return r().createElement("div",{className:"file-preview-modal-header"},a.isMobileView&&s,!a.isMobileView&&r().createElement(O,{showFileName:!0,post:t,filename:a.filename}),l,!a.isMobileView&&s)};K.propTypes={isMobileView:a().bool.isRequired,fileIndex:a().number.isRequired,totalFiles:a().number.isRequired,filename:a().string.isRequired,fileURL:a().string.isRequired,showPublicLink:a().bool,enablePublicLink:a().bool.isRequired,canDownloadFiles:a().bool.isRequired,canCopyContent:a().bool.isRequired,isExternalFile:a().bool.isRequired,handlePrev:a().func.isRequired,handleNext:a().func.isRequired,handleModalClose:a().func.isRequired,content:a().string.isRequired};const J=(0,o.memo)(K);function Q(e){let t,i,n,{fileInfo:a,canDownloadFiles:l}=e;return a.id?(t=(0,d.S1)(a.id),i=a.has_preview_image?(0,d.cV)(a.id):t):(t=a.link,i=a.link),l?((0,R.ti)(a.extension)===v.a0.SVG&&(n={width:a.width,height:"auto"}),r().createElement("a",{className:"image_preview",href:"#"},r().createElement("img",{className:"image_preview__image",loading:"lazy","data-testid":"imagePreview",alt:"preview url image",src:i,style:n}))):r().createElement("img",{src:i})}Q.propTypes={canDownloadFiles:a().bool.isRequired};var Y,$,ee,te=i(46177),ie=i.n(te);class ne extends r().PureComponent{render(){const e=[];let t=null;if(this.props.showZoomControls){let i,n,a;n=this.props.scale&&this.props.scale>v.tR.MIN_SCALE?r().createElement("span",{className:"modal-zoom-btn"},r().createElement("a",{onClick:this.props.handleZoomOut&&ie()(this.props.handleZoomOut,300,{maxWait:300})},r().createElement("i",{className:"icon icon-minus"}))):r().createElement("span",{className:"btn-inactive"},r().createElement("i",{className:"icon icon-minus"})),e.push(r().createElement(T.A,{key:"zoomOut",title:r().createElement(m.FormattedMessage,{id:"view_image.zoom_out",defaultMessage:"Zoom Out"})},n)),i=this.props.scale&&this.props.scale>v.tR.DEFAULT_SCALE?r().createElement("span",{className:"modal-zoom-btn"},r().createElement("a",{onClick:this.props.handleZoomReset},r().createElement("i",{className:"icon icon-magnify-minus"}))):this.props.scale&&this.props.scale<v.tR.DEFAULT_SCALE?r().createElement("span",{className:"modal-zoom-btn"},r().createElement("a",{onClick:this.props.handleZoomReset},r().createElement("i",{className:"icon icon-magnify-plus"}))):r().createElement("span",{className:"btn-inactive"},r().createElement("i",{className:"icon icon-magnify-minus"})),e.push(r().createElement(T.A,{key:"zoomReset",title:r().createElement(m.FormattedMessage,{id:"view_image.zoom_reset",defaultMessage:"Reset Zoom"})},i)),a=this.props.scale&&this.props.scale<v.tR.MAX_SCALE?r().createElement("span",{className:"modal-zoom-btn"},r().createElement("a",{onClick:this.props.handleZoomIn&&ie()(this.props.handleZoomIn,300,{maxWait:300})},r().createElement("i",{className:"icon icon-plus"}))):r().createElement("span",{className:"btn-inactive"},r().createElement("i",{className:"icon icon-plus"})),e.push(r().createElement(T.A,{key:"zoomIn",title:r().createElement(m.FormattedMessage,{id:"view_image.zoom_in",defaultMessage:"Zoom In"})},a)),t=r().createElement("div",{className:"modal-column"},e)}return r().createElement("div",{"data-testid":"fileCountFooter",className:"modal-button-bar file-preview-modal__zoom-bar"},t)}}Y=ne,$="propTypes",ee={scale:a().number,showZoomControls:a().bool,handleZoomIn:a().func,handleZoomOut:a().func,handleZoomReset:a().func},($=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var i=t.call(e,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}($))in Y?Object.defineProperty(Y,$,{value:ee,enumerable:!0,configurable:!0,writable:!0}):Y[$]=ee;const ae=ne;function le(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function se(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?le(Object(i),!0).forEach((function(t){oe(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):le(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function oe(e,t,i){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var i=t.call(e,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const re=r().lazy((()=>Promise.all([i.e(1959),i.e(5660)]).then(i.bind(i,25660)))),ce=v.Ay.KeyCodes;class me extends r().PureComponent{constructor(e){super(e),oe(this,"handleNext",(()=>{let e=this.state.imageIndex+1;e>this.props.fileInfos.length-1&&(e=0),this.showImage(e)})),oe(this,"handlePrev",(()=>{let e=this.state.imageIndex-1;e<0&&(e=this.props.fileInfos.length-1),this.showImage(e)})),oe(this,"handleKeyPress",(e=>{N.e(e,ce.RIGHT)?this.handleNext():N.e(e,ce.LEFT)&&this.handlePrev()})),oe(this,"showImage",(e=>{this.setState({imageIndex:e});const t=window.innerHeight-100;this.setState({imageHeight:t}),this.state.loaded[e]||this.loadImage(e)})),oe(this,"isImageUrl",(e=>{const t=R.ti(e);return t===v.a0.IMAGE||t===v.a0.SVG})),oe(this,"getFileTypeFromFileInfo",(e=>{if(j(e))return R.ti(e.extension);if(U(e)){const t=11,i=e.extension&&e.extension.length<=t?e.extension:e.link;return R.ti(i)}return v.a0.OTHER})),oe(this,"loadImage",(e=>{const t=this.props.fileInfos[e];if(j(t)&&t.archived)this.handleImageLoaded(e);else if(this.getFileTypeFromFileInfo(t)===v.a0.IMAGE){let i="";j(t)?i=t.has_preview_image?(0,d.cV)(t.id):(0,d.w8)(t.id):U(t)&&(i=t.link),R.yt(i,(()=>this.handleImageLoaded(e)),(t=>this.handleImageProgress(e,t)))}else this.handleImageLoaded(e)})),oe(this,"handleImageLoaded",(e=>{this.setState((t=>({loaded:se(se({},t.loaded),{},{[e]:!0})})))})),oe(this,"handleImageProgress",((e,t)=>{this.setState((i=>({progress:se(se({},i.progress),{},{[e]:t})})))})),oe(this,"onMouseEnterImage",(()=>{this.setState({showCloseBtn:!0})})),oe(this,"onMouseLeaveImage",(()=>{this.setState({showCloseBtn:!1})})),oe(this,"setScale",((e,t)=>{this.setState((i=>({scale:se(se({},i.scale),{},{[e]:t})})))})),oe(this,"handleZoomIn",(()=>{let e=this.state.scale[this.state.imageIndex];e=Math.min(e+v.tR.SCALE_DELTA,v.tR.MAX_SCALE),this.setScale(this.state.imageIndex,e)})),oe(this,"handleZoomOut",(()=>{let e=this.state.scale[this.state.imageIndex];e=Math.max(e-v.tR.SCALE_DELTA,v.tR.MIN_SCALE),this.setScale(this.state.imageIndex,e)})),oe(this,"handleZoomReset",(()=>{this.setScale(this.state.imageIndex,v.tR.DEFAULT_SCALE)})),oe(this,"handleModalClose",(()=>{this.setState({show:!1})})),oe(this,"getContent",(e=>{this.setState({content:e})})),oe(this,"handleBgClose",(e=>{e.currentTarget===e.target&&this.handleModalClose()})),this.state={show:!0,imageIndex:this.props.startIndex,imageHeight:"100%",loaded:R.lI(!1,this.props.fileInfos.length),prevFileInfosCount:0,progress:R.lI(0,this.props.fileInfos.length),showCloseBtn:!1,showZoomControls:!1,scale:R.lI(v.tR.DEFAULT_SCALE,this.props.fileInfos.length),content:""}}componentDidMount(){document.addEventListener("keyup",this.handleKeyPress),this.showImage(this.props.startIndex)}componentWillUnmount(){document.removeEventListener("keyup",this.handleKeyPress)}static getDerivedStateFromProps(e,t){const i={};return e.fileInfos[t.imageIndex]&&e.fileInfos[t.imageIndex].extension===v.a0.PDF?i.showZoomControls=!0:i.showZoomControls=!1,e.fileInfos.length!==t.prevFileInfosCount&&(i.loaded=R.lI(!1,e.fileInfos.length),i.progress=R.lI(0,e.fileInfos.length),i.prevFileInfosCount=e.fileInfos.length),Object.keys(i).length?i:null}render(){var e;if(this.props.fileInfos.length<1||this.props.fileInfos.length-1<this.state.imageIndex)return null;const t=this.props.fileInfos[this.state.imageIndex],i=this.getFileTypeFromFileInfo(t);let n,a,l,o,h,u=!1;j(t)?(n=!0,a=t.name,l=(0,d.w8)(t.id),o=(0,d.S1)(t.id),h=!1):(n=!1,a=t.name||t.link,l=t.link,o=t.link,h=!0);let p,E,w="a11y__modal modal-image file-preview-modal";if(j(t)&&t.archived&&(p=r().createElement(f,{fileInfo:t})),!j(t)||!t.archived)if(this.state.loaded[this.state.imageIndex])i===v.a0.IMAGE||i===v.a0.SVG?p=r().createElement(Q,{fileInfo:t,canDownloadFiles:this.props.canDownloadFiles}):i===v.a0.VIDEO||i===v.a0.AUDIO?p=r().createElement(_,{fileInfo:t,fileUrl:l}):i===v.a0.PDF?(p=r().createElement("div",{className:"file-preview-modal__scrollable",onClick:this.handleBgClose},r().createElement(r().Suspense,{fallback:null},r().createElement(re,{fileInfo:t,fileUrl:l,scale:this.state.scale[this.state.imageIndex],handleBgClose:this.handleBgClose}))),E=r().createElement(ae,{scale:this.state.scale[this.state.imageIndex],showZoomControls:this.state.showZoomControls,handleZoomIn:this.handleZoomIn,handleZoomOut:this.handleZoomOut,handleZoomReset:this.handleZoomReset})):function(e){return Boolean(I.od(e.extension))}(t)?(w+=" modal-code",u=!0,p=r().createElement(C,{fileInfo:t,fileUrl:l,getContent:this.getContent})):p=r().createElement(g.A,{fileInfo:t,fileUrl:l});else{const e=Math.floor(this.state.progress[this.state.imageIndex]);p=r().createElement(M.A,{loading:r().createElement(m.FormattedMessage,{id:"view_image.loading",defaultMessage:"Loading"}),progress:e})}if(j(t)&&!t.archived)for(const e of this.props.pluginFilePreviewComponents)if(e.override(t,this.props.post)){p=r().createElement(e.component,{fileInfo:t,post:this.props.post,onModalDismissed:this.handleModalClose});break}return r().createElement(c.Modal,{show:this.state.show,onHide:this.handleModalClose,onExited:this.props.onExited,className:"modal-image file-preview-modal",dialogClassName:w,animation:!0,backdrop:!1,role:"none",style:{paddingLeft:0},"aria-labelledby":"viewImageModalLabel"},r().createElement(c.Modal.Body,{className:"file-preview-modal__body"},r().createElement("div",{className:"modal-image__wrapper",onClick:this.handleModalClose},r().createElement("div",{className:"file-preview-modal__main-ctr",onMouseEnter:this.onMouseEnterImage,onMouseLeave:this.onMouseLeaveImage,onClick:e=>e.stopPropagation()},r().createElement(c.Modal.Title,{componentClass:"div",id:"viewImageModalLabel",className:"file-preview-modal__title"},r().createElement(J,{isMobileView:this.props.isMobileView,post:this.props.post,showPublicLink:n,fileIndex:this.state.imageIndex,totalFiles:null===(e=this.props.fileInfos)||void 0===e?void 0:e.length,filename:a,fileURL:o,fileInfo:t,enablePublicLink:this.props.enablePublicLink,canDownloadFiles:this.props.canDownloadFiles,canCopyContent:u,isExternalFile:h,handlePrev:this.handlePrev,handleNext:this.handleNext,handleModalClose:this.handleModalClose,content:this.state.content}),E),r().createElement("div",{className:s()("file-preview-modal__content",{"file-preview-modal__content-scrollable":(!j(t)||!t.archived)&&this.state.loaded[this.state.imageIndex]&&i===v.a0.PDF}),onClick:this.handleBgClose},p),this.props.isMobileView&&r().createElement(H,{post:this.props.post,showPublicLink:n,filename:a,fileURL:o,fileInfo:t,enablePublicLink:this.props.enablePublicLink,canDownloadFiles:this.props.canDownloadFiles,canCopyContent:u,isExternalFile:h,handleModalClose:this.handleModalClose,content:this.state.content})))))}}oe(me,"propTypes",{canDownloadFiles:a().bool.isRequired,enablePublicLink:a().bool.isRequired,isMobileView:a().bool.isRequired,pluginFilePreviewComponents:a().array,onExited:a().func.isRequired,postId:a().string,startIndex:a().number}),oe(me,"defaultProps",{fileInfos:[],startIndex:0,pluginFilePreviewComponents:[]})}}]);
//# sourceMappingURL=11.077b2ea56408145a4962.js.map