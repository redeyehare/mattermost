"use strict";(self.webpackChunkmattermost_webapp=self.webpackChunkmattermost_webapp||[]).push([[5555],{24567:(e,t,a)=>{a.r(t),a.d(t,{default:()=>_});var r=a(37270),n=a(40693),s=a(26614),i=a(77440),o=(a(4290),a(62688)),l=a.n(o),p=(a(17046),a(60473),a(36169),a(76685),a(12401),a(3188),a(59297),a(36418)),d=a.n(p),c=a(14778),m=a(52123),h=a(17518);const g=a.p+"files/a4573a94c80cab1d0240.png",u=a.p+"files/2c7992ec656481c9d362.png",f=a.p+"files/17a50e2f200ecc8c4a58.svg";var w=a(78451),b=a(4715),E=a(85873);function k(e,t,a){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class M extends p.PureComponent{constructor(e){super(e),k(this,"clearLandingPreferenceIfNotChecked",(()=>{this.state.navigating||this.state.rememberChecked||m.A.clearLandingPreference(this.props.siteUrl)})),k(this,"checkLandingPreferenceBrowser",(()=>{const e=m.A.getLandingPreference(this.props.siteUrl);return e&&e===w.ih.BROWSER})),k(this,"isEmbedded",(()=>{const e=document.cookie.split(";");for(let t=0;t<e.length;t++){const a=e[t].trim();if(a.startsWith("MMEMBED=")){const e=a.substring(8);return"1"===decodeURIComponent(e)}}return!1})),k(this,"checkLandingPreferenceApp",(()=>{const e=m.A.getLandingPreference(this.props.siteUrl);return e&&e===w.ih.MATTERMOSTAPP})),k(this,"handleChecked",(e=>{this.setState({rememberChecked:e.target.checked}),e.target.checked||m.A.clearLandingPreference(this.props.siteUrl)})),k(this,"setPreference",((e,t)=>{if(this.state.rememberChecked)switch(e){case w.ih.MATTERMOSTAPP:m.A.setLandingPreferenceToMattermostApp(this.props.siteUrl);break;case w.ih.BROWSER:m.A.setLandingPreferenceToBrowser(this.props.siteUrl)}else t&&m.A.clearLandingPreference(this.props.siteUrl)})),k(this,"openMattermostApp",(()=>{this.setPreference(w.ih.MATTERMOSTAPP),this.setState({redirectPage:!0}),window.location.href=this.state.nativeLocation})),k(this,"openInBrowser",(()=>{this.setPreference(w.ih.BROWSER),window.location.href=this.state.location})),k(this,"renderSystemDialogMessage",(()=>b.Fr()?d().createElement(c.FormattedMessage,{id:"get_app.systemDialogMessageMobile",defaultMessage:"View in App"}):d().createElement(c.FormattedMessage,{id:"get_app.systemDialogMessage",defaultMessage:"View in Desktop App"}))),k(this,"renderGoNativeAppMessage",(()=>d().createElement("a",{href:b.Fr()?"#":this.state.nativeLocation,onMouseDown:()=>{this.setPreference(w.ih.MATTERMOSTAPP,!0)},onClick:()=>{if(this.setPreference(w.ih.MATTERMOSTAPP,!0),this.setState({redirectPage:!0,navigating:!0}),b.Fr()){if(b.Ct()){const e=setTimeout((()=>{window.location.replace(this.getDownloadLink())}),2e3);window.addEventListener("blur",(()=>{clearTimeout(e)}))}window.location.replace(this.state.nativeLocation)}},className:"btn btn-primary btn-lg get-app__download"},this.renderSystemDialogMessage()))),k(this,"getDownloadLink",(()=>b.Yn()?this.props.iosAppLink:b.Ct()?this.props.androidAppLink:this.props.desktopAppLink)),k(this,"handleBrandImageError",(()=>{this.setState({brandImageError:!0})})),k(this,"renderGraphic",(()=>b.Fr()?d().createElement("img",{src:u}):d().createElement("img",{src:g}))),k(this,"renderDownloadLinkText",(()=>b.Fr()?d().createElement(c.FormattedMessage,{id:"get_app.dontHaveTheMobileApp",defaultMessage:"Don't have the Mobile App?"}):d().createElement(c.FormattedMessage,{id:"get_app.dontHaveTheDesktopApp",defaultMessage:"Don't have the Desktop App?"}))),k(this,"renderDownloadLinkSection",(()=>{const e=this.getDownloadLink();return this.state.redirectPage?d().createElement("div",{className:"get-app__download-link"},d().createElement(c.FormattedMessage,{id:"getApp.downloadLinkInBrowser",defaultMessage:"Or, <a>open this link in your browser</a>.",values:{a:e=>d().createElement(h.A,{href:this.state.location,location:"landingPage"},e)}})):e?d().createElement("div",{className:"get-app__download-link"},this.renderDownloadLinkText()," ",d().createElement("br",null),d().createElement("a",{href:e},d().createElement(c.FormattedMessage,{id:"get_app.downloadTheAppNow",defaultMessage:"Download the app now."}))):null})),k(this,"renderDialogHeader",(()=>{const e=this.getDownloadLink(),t=b.Fr();let a=d().createElement(c.FormattedMessage,{id:"get_app.openingLink",defaultMessage:"Opening link in Mattermost..."});if(this.props.enableCustomBrand&&(a=d().createElement(c.FormattedMessage,{id:"get_app.openingLinkWhiteLabel",defaultMessage:"Opening link in {appName}...",values:{appName:this.props.siteName||"Mattermost"}})),this.state.redirectPage)return d().createElement("h1",{className:"get-app__launching"},a,d().createElement("div",{className:"get-app__alternative".concat(this.state.redirectPage?" redirect-page":"")},d().createElement(c.FormattedMessage,{id:"get_app.redirectedInMoments",defaultMessage:"You will be redirected in a few moments."}),d().createElement("br",null),this.renderDownloadLinkText()," ",d().createElement("br",{className:"mobile-only"}),d().createElement("a",{href:e},d().createElement(c.FormattedMessage,{id:"get_app.downloadTheAppNow",defaultMessage:"Download the app now."}))));let r=d().createElement(c.FormattedMessage,{id:"get_app.ifNothingPrompts",defaultMessage:"You can view {siteName} in the desktop app or continue in your web browser.",values:{siteName:this.props.enableCustomBrand?"":" Mattermost"}});return t&&(r=d().createElement(c.FormattedMessage,{id:"get_app.ifNothingPromptsMobile",defaultMessage:"You can view {siteName} in the mobile app or continue in your web browser.",values:{siteName:this.props.enableCustomBrand?"":" Mattermost"}})),d().createElement("div",{className:"get-app__launching"},d().createElement(c.FormattedMessage,{id:"get_app.launching",tagName:"h1",defaultMessage:"Where would you like to view this?"}),d().createElement("div",{className:"get-app__alternative"},r))})),k(this,"renderDialogBody",(()=>this.state.redirectPage?d().createElement("div",{className:"get-app__dialog-body"},this.renderDialogHeader(),this.renderDownloadLinkSection()):d().createElement("div",{className:"get-app__dialog-body"},this.renderDialogHeader(),d().createElement("div",{className:"get-app__buttons"},this.renderGoNativeAppMessage(),d().createElement("a",{href:this.state.location,onMouseDown:()=>{this.setPreference(w.ih.BROWSER,!0)},onClick:()=>{this.setPreference(w.ih.BROWSER,!0),this.setState({navigating:!0})},className:"btn btn-tertiary btn-lg"},d().createElement(c.FormattedMessage,{id:"get_app.continueToBrowser",defaultMessage:"View in Browser"}))),d().createElement("label",{className:"get-app__preference"},d().createElement("input",{type:"checkbox",checked:this.state.rememberChecked,className:"get-app__checkbox",onChange:this.handleChecked}),d().createElement(c.FormattedMessage,{id:"get_app.rememberMyPreference",defaultMessage:"Remember my preference"})),this.renderDownloadLinkSection()))),k(this,"renderHeader",(()=>{let e=d().createElement("div",{className:"get-app__header"},d().createElement("img",{src:f,className:"get-app__logo"}));if(this.props.enableCustomBrand&&this.props.brandImageUrl){let t;this.props.brandImageUrl&&!this.state.brandImageError&&(t=d().createElement("img",{src:this.props.brandImageUrl,onError:this.handleBrandImageError,className:"get-app__custom-logo"})),e=d().createElement("div",{className:"get-app__header"},t,d().createElement("div",{className:"get-app__custom-site-name"},d().createElement("span",null,this.props.siteName)))}return e}));const t=function(e){const t=new URL(e);t.pathname=t.pathname.slice(0,-8);const a=t.hash.slice(1),r=new URL(t.pathname,t.origin);if(!a)return r.href;let n;try{n=new URL(a,r)}catch(e){return r.href}return n.origin!==r.origin?r.href:n.href}(window.location.href),a=t.replace(/^(https|http)/,"mattermost");this.state={rememberChecked:!1,redirectPage:!1,location:t,nativeLocation:a,brandImageError:!1,navigating:!1},m.A.hasSeenLandingPage()||m.A.setLandingPageSeen(!0)}componentDidMount(){E.AZ(this.props.defaultTheme),this.checkLandingPreferenceApp()&&this.openMattermostApp(),window.addEventListener("beforeunload",this.clearLandingPreferenceIfNotChecked)}componentWillUnmount(){window.removeEventListener("beforeunload",this.clearLandingPreferenceIfNotChecked)}render(){const e=b.Fr();return this.checkLandingPreferenceBrowser()||this.isEmbedded()?(this.openInBrowser(),null):d().createElement("div",{className:"get-app"},this.renderHeader(),d().createElement("div",{className:"get-app__dialog"},d().createElement("div",{className:"get-app__graphic ".concat(e?"mobile":"")},this.renderGraphic()),this.renderDialogBody()))}}k(M,"propTypes",{defaultTheme:l().any.isRequired,desktopAppLink:l().string,iosAppLink:l().string,androidAppLink:l().string,siteUrl:l().string,siteName:l().string,brandImageUrl:l().string,enableCustomBrand:l().bool.isRequired});const _=(0,r.connect)((function(e){const t=(0,s.zj)(e);return{desktopAppLink:t.AppDownloadLink,iosAppLink:t.IosAppDownloadLink,androidAppLink:t.AndroidAppDownloadLink,defaultTheme:(0,i.O4)(e),siteUrl:t.SiteURL,siteName:t.SiteName,brandImageUrl:n.mT.getBrandImageUrl("0"),enableCustomBrand:"true"===t.EnableCustomBrand}}))(M)}}]);
//# sourceMappingURL=5555.f42a369f71b8b505f374.js.map