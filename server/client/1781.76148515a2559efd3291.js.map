{"version":3,"file":"1781.76148515a2559efd3291.js","mappings":"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","sources":["webpack://mattermost-webapp/./src/components/app_bar/new_channel_with_board_tour_tip.tsx","webpack://mattermost-webapp/./src/components/channel_header/components/header_icon_wrapper.tsx","webpack://mattermost-webapp/./src/components/common/hooks/useCopyText.ts","webpack://mattermost-webapp/./src/components/common/svg_images_components/alert_svg.tsx","webpack://mattermost-webapp/./src/components/popout_button.tsx","webpack://mattermost-webapp/./src/components/search_results_header/search_results_header.tsx","webpack://mattermost-webapp/./src/components/search_results_header/index.tsx","webpack://mattermost-webapp/./src/components/channel_info_rhs/components/editable_area.tsx","webpack://mattermost-webapp/./src/components/channel_info_rhs/components/linelimiter.tsx","webpack://mattermost-webapp/./src/components/channel_info_rhs/about_area_channel.tsx","webpack://mattermost-webapp/./src/components/channel_info_rhs/about_area_dm.tsx","webpack://mattermost-webapp/./src/components/channel_info_rhs/about_area_gm.tsx","webpack://mattermost-webapp/./src/components/channel_info_rhs/about_area.tsx","webpack://mattermost-webapp/./src/components/channel_info_rhs/header.tsx","webpack://mattermost-webapp/./src/components/channel_info_rhs/menu.tsx","webpack://mattermost-webapp/./src/components/channel_info_rhs/top_buttons.tsx","webpack://mattermost-webapp/./src/components/channel_info_rhs/channel_info_rhs.tsx","webpack://mattermost-webapp/./src/components/channel_info_rhs/index.ts","webpack://mattermost-webapp/./src/components/channel_members_rhs/action_bar.tsx","webpack://mattermost-webapp/./src/components/channel_members_rhs/header.tsx","webpack://mattermost-webapp/./src/components/channel_members_rhs/search.tsx","webpack://mattermost-webapp/./src/components/channel_members_rhs/channel_members_rhs.tsx","webpack://mattermost-webapp/./src/components/channel_members_rhs/index.ts","webpack://mattermost-webapp/./src/components/info_toast/info_toast.tsx","webpack://mattermost-webapp/./src/components/post_edit_history/restore_post_modal.tsx","webpack://mattermost-webapp/./src/components/post_edit_history/edited_post_item/edited_post_item.tsx","webpack://mattermost-webapp/./src/components/post_edit_history/edited_post_item/index.ts","webpack://mattermost-webapp/./src/components/post_edit_history/post_edit_history.tsx","webpack://mattermost-webapp/./src/components/post_edit_history/index.ts","webpack://mattermost-webapp/./src/components/resizable_sidebar/resizable_rhs/index.tsx","webpack://mattermost-webapp/./src/components/rhs_card_header/rhs_card_header.tsx","webpack://mattermost-webapp/./src/components/rhs_card_header/index.tsx","webpack://mattermost-webapp/./src/components/rhs_card/rhs_card.tsx","webpack://mattermost-webapp/./src/components/rhs_card/index.ts","webpack://mattermost-webapp/./src/components/rhs_header_post/rhs_header_post.tsx","webpack://mattermost-webapp/./src/components/rhs_header_post/index.ts","webpack://mattermost-webapp/./src/components/rhs_thread/rhs_thread.tsx","webpack://mattermost-webapp/./src/components/rhs_thread/index.ts","webpack://mattermost-webapp/./src/components/widgets/popover/index.tsx","webpack://mattermost-webapp/./src/components/suggestion/search_suggestion_list.tsx","webpack://mattermost-webapp/./src/components/suggestion/suggestion_date.tsx","webpack://mattermost-webapp/./src/components/search_bar/search_bar.tsx","webpack://mattermost-webapp/./src/components/search_hint/search_hint.tsx","webpack://mattermost-webapp/./src/components/file_search_results/file_search_result_item.tsx","webpack://mattermost-webapp/./src/components/file_search_results/index.tsx","webpack://mattermost-webapp/./src/components/search_results/files_filter_menu.tsx","webpack://mattermost-webapp/./src/components/search_results/messages_or_files_selector.tsx","webpack://mattermost-webapp/./src/components/search_results/post_search_results_item.tsx","webpack://mattermost-webapp/./src/components/search_results/search_limits_banner.tsx","webpack://mattermost-webapp/./src/components/search_results/search_results.tsx","webpack://mattermost-webapp/./src/components/search_results/index.tsx","webpack://mattermost-webapp/./src/components/search/search.tsx","webpack://mattermost-webapp/./src/components/search/index.tsx","webpack://mattermost-webapp/./src/plugins/rhs_plugin/rhs_plugin.tsx","webpack://mattermost-webapp/./src/plugins/rhs_plugin/index.ts","webpack://mattermost-webapp/./src/components/sidebar_right/sidebar_right.tsx","webpack://mattermost-webapp/./src/components/sidebar_right/index.ts","webpack://mattermost-webapp/./src/components/widgets/icons/search_icon.tsx"],"sourcesContent":["// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback, useState} from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\nimport type {Placement} from 'tippy.js';\r\n\r\nimport {TourTip, useMeasurePunchouts} from '@mattermost/components';\r\n\r\nimport {setNewChannelWithBoardPreference} from 'mattermost-redux/actions/boards';\r\nimport {Preferences} from 'mattermost-redux/constants';\r\n\r\nimport {showNewChannelWithBoardPulsatingDot} from 'selectors/plugins';\r\n\r\ntype Props = {\r\n    pulsatingDotPlacement?: Omit<Placement, 'auto'| 'auto-end'>;\r\n    pulsatingDotTranslate?: {x: number; y: number};\r\n}\r\n\r\nconst NewChannelWithBoardTourTip = ({\r\n    pulsatingDotPlacement = 'left',\r\n    pulsatingDotTranslate,\r\n}: Props): JSX.Element | null => {\r\n    const dispatch = useDispatch();\r\n    const showTip = useSelector(showNewChannelWithBoardPulsatingDot);\r\n\r\n    const title = (\r\n        <FormattedMessage\r\n            id='newChannelWithBoard.tutorialTip.title'\r\n            defaultMessage='Access linked boards from the App Bar'\r\n        />\r\n    );\r\n\r\n    const screen = (\r\n        <FormattedMessage\r\n            id='newChannelWithBoard.tutorialTip.description'\r\n            defaultMessage='The board you just created can be quickly accessed by clicking on the Boards icon in the App bar. You can view the boards that are linked to this channel in the right-hand sidebar and open one in full view.'\r\n        />\r\n    );\r\n\r\n    const [tipOpened, setTipOpened] = useState(showTip);\r\n\r\n    const handleDismiss = useCallback((e: React.MouseEvent) => {\r\n        e.stopPropagation();\r\n        setTipOpened(false);\r\n        dispatch(setNewChannelWithBoardPreference({[Preferences.NEW_CHANNEL_WITH_BOARD_TOUR_SHOWED]: true}));\r\n    }, []);\r\n\r\n    const handleOpen = useCallback((e: React.MouseEvent) => {\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n\r\n        if (tipOpened) {\r\n            dispatch(setNewChannelWithBoardPreference({[Preferences.NEW_CHANNEL_WITH_BOARD_TOUR_SHOWED]: true}));\r\n            setTipOpened(false);\r\n        } else {\r\n            setTipOpened(true);\r\n        }\r\n    }, []);\r\n\r\n    const overlayPunchOut = useMeasurePunchouts(['app-bar-icon-focalboard'], [], {y: -2, height: 4, x: 0, width: 0});\r\n\r\n    if (!showTip) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <TourTip\r\n            show={true}\r\n            screen={screen}\r\n            title={title}\r\n            overlayPunchOut={overlayPunchOut}\r\n            placement='right-start'\r\n            pulsatingDotPlacement={pulsatingDotPlacement}\r\n            step={1}\r\n            singleTip={true}\r\n            showOptOut={false}\r\n            interactivePunchOut={true}\r\n            handleDismiss={handleDismiss}\r\n            handleOpen={handleOpen}\r\n            handlePrevious={handleDismiss}\r\n            offset={[-30, 5]}\r\n            pulsatingDotTranslate={pulsatingDotTranslate}\r\n        />\r\n    );\r\n};\r\n\r\nexport default NewChannelWithBoardTourTip;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\n\r\nimport NewChannelWithBoardTourTip from 'components/app_bar/new_channel_with_board_tour_tip';\r\nimport WithTooltip from 'components/with_tooltip';\r\nimport type {ShortcutDefinition} from 'components/with_tooltip/tooltip_shortcut';\r\n\r\nimport {suitePluginIds} from 'utils/constants';\r\n\r\ntype Props = {\r\n\r\n    /**\r\n     * ariaLabelOverride lets you override the aria-label which would otherwise use the tooltip text. This typically\r\n     * shouldn't be needed.\r\n     */\r\n    ariaLabelOverride?: string;\r\n\r\n    buttonClass?: string;\r\n    buttonId: string;\r\n    children: React.ReactNode;\r\n    onClick: (event: React.MouseEvent<HTMLButtonElement>) => void;\r\n    tooltip: string;\r\n    tooltipShortcut?: ShortcutDefinition;\r\n    isRhsOpen?: boolean;\r\n    pluginId?: string;\r\n}\r\n\r\nconst HeaderIconWrapper = (props: Props) => {\r\n    const {\r\n        ariaLabelOverride,\r\n        buttonClass,\r\n        buttonId,\r\n        children,\r\n        onClick,\r\n        tooltip: tooltipText,\r\n        tooltipShortcut,\r\n        isRhsOpen,\r\n        pluginId,\r\n    } = props;\r\n\r\n    const boardsEnabled = pluginId === suitePluginIds.focalboard;\r\n\r\n    const ariaLabelText = ariaLabelOverride ?? tooltipText;\r\n\r\n    return (\r\n        <>\r\n            <WithTooltip\r\n                title={isRhsOpen ? '' : tooltipText}\r\n                shortcut={tooltipShortcut}\r\n            >\r\n                <button\r\n                    id={buttonId}\r\n                    aria-label={ariaLabelText}\r\n                    className={buttonClass || 'channel-header__icon'}\r\n                    onClick={onClick}\r\n                >\r\n                    {children}\r\n                </button>\r\n            </WithTooltip>\r\n            {boardsEnabled &&\r\n                <NewChannelWithBoardTourTip\r\n                    pulsatingDotPlacement={'start'}\r\n                    pulsatingDotTranslate={{x: 0, y: -22}}\r\n                />\r\n            }\r\n        </>\r\n    );\r\n};\r\n\r\nexport default HeaderIconWrapper;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {useRef, useCallback, useState} from 'react';\r\nimport {defineMessages} from 'react-intl';\r\n\r\ntype CopyOptions = {\r\n    successCopyTimeout?: number;\r\n    text: string;\r\n};\r\n\r\ntype CopyResponse = {\r\n    copiedRecently: boolean;\r\n    copyError: boolean;\r\n    onClick: () => void;\r\n};\r\n\r\nconst DEFAULT_COPY_TIMEOUT = 4000;\r\n\r\nexport default function useCopyText({\r\n    text,\r\n    successCopyTimeout: successCopyTimeoutReceived,\r\n}: CopyOptions): CopyResponse {\r\n    const [copiedRecently, setCopiedRecently] = useState(false);\r\n    const [copyError, setCopyError] = useState(false);\r\n    const timerRef = useRef<NodeJS.Timeout | null>(null);\r\n\r\n    let successCopyTimeout = DEFAULT_COPY_TIMEOUT;\r\n    if (successCopyTimeoutReceived || successCopyTimeoutReceived === 0) {\r\n        successCopyTimeout = successCopyTimeoutReceived;\r\n    }\r\n\r\n    const onClick = useCallback(() => {\r\n        if (timerRef.current) {\r\n            clearTimeout(timerRef.current);\r\n            timerRef.current = null;\r\n        }\r\n        const clipboard = navigator.clipboard;\r\n        if (clipboard) {\r\n            clipboard.writeText(text).\r\n                then(() => {\r\n                    setCopiedRecently(true);\r\n                    setCopyError(false);\r\n                }).\r\n                catch(() => {\r\n                    setCopiedRecently(false);\r\n                    setCopyError(true);\r\n                });\r\n        } else {\r\n            const textField = document.createElement('textarea');\r\n            textField.innerText = text;\r\n            textField.style.position = 'fixed';\r\n            textField.style.opacity = '0';\r\n\r\n            document.body.appendChild(textField);\r\n            textField.select();\r\n\r\n            try {\r\n                const success = document.execCommand('copy');\r\n                setCopiedRecently(success);\r\n                setCopyError(!success);\r\n            } catch (err) {\r\n                setCopiedRecently(false);\r\n                setCopyError(true);\r\n            }\r\n            textField.remove();\r\n        }\r\n\r\n        timerRef.current = setTimeout(() => {\r\n            setCopiedRecently(false);\r\n            setCopyError(false);\r\n        }, successCopyTimeout);\r\n    }, [successCopyTimeout, text]);\r\n\r\n    return {\r\n        copiedRecently,\r\n        copyError,\r\n        onClick,\r\n    };\r\n}\r\n\r\nexport const messages = defineMessages({\r\n    copy: {id: 'copy_text.copy', defaultMessage: 'Copy'},\r\n    copied: {id: 'copy_text.copied', defaultMessage: 'Copied'},\r\n});\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\n\r\ntype SvgProps = {\r\n    width: number;\r\n    height: number;\r\n};\r\n\r\nconst AlertSvg = (props: SvgProps) => (\r\n    <svg\r\n        width={props.width ? props.width.toString() : '87'}\r\n        height={props.height ? props.height.toString() : '70'}\r\n        viewBox='0 0 87 70'\r\n        fill='none'\r\n        xmlns='http://www.w3.org/2000/svg'\r\n    >\r\n        <rect\r\n            x='8.00098'\r\n            y='7'\r\n            width='72'\r\n            height='24'\r\n            rx='3.75'\r\n            fill='var(--button-bg)'\r\n            fillOpacity='0.12'\r\n        />\r\n        <rect\r\n            x='0.000976562'\r\n            y='34'\r\n            width='87'\r\n            height='25'\r\n            rx='3.75'\r\n            fill='var(--button-bg)'\r\n            fillOpacity='0.12'\r\n        />\r\n        <path\r\n            d='M38.3214 2.31098C39.4303 0.112261 42.5697 0.112256 43.6786 2.31098L71.7146 57.899C72.7209 59.8943 71.2707 62.25 69.0359 62.25H12.9641C10.7294 62.25 9.27912 59.8943 10.2854 57.899L38.3214 2.31098Z'\r\n            fill='var(--center-channel-bg)'\r\n        />\r\n        <path\r\n            d='M40.3214 4.31098C41.4303 2.11226 44.5697 2.11226 45.6786 4.31098L73.7146 59.899C74.7209 61.8943 73.2707 64.25 71.0359 64.25H14.9641C12.7294 64.25 11.2791 61.8943 12.2854 59.899L40.3214 4.31098Z'\r\n            fill='#FFBC1F'\r\n        />\r\n        <path\r\n            d='M43.2322 2.53614L71.2681 58.1242C72.1067 59.7869 70.8982 61.75 69.0359 61.75H12.9641C11.1018 61.75 9.89327 59.7869 10.7319 58.1242L38.7678 2.53614C39.6919 0.703873 42.3081 0.703871 43.2322 2.53614Z'\r\n            stroke='var(--center-channel-color)'\r\n        />\r\n        <path\r\n            d='M49.542 4.23999L52.8888 10.72M74.922 53.38L68.5073 40.96L66.8339 37.72L64.6027 33.4L61.5348 27.46M59.3036 23.14L55.12 15.04'\r\n            stroke='var(--center-channel-color)'\r\n            strokeOpacity='0.56'\r\n            strokeWidth='1.08'\r\n            strokeLinecap='round'\r\n        />\r\n        <path\r\n            d='M38.0164 25.2833L40.2971 39.9301C40.3191 40.2208 40.4554 40.4927 40.6786 40.6912C40.9018 40.8897 41.1954 41 41.5002 41C41.8051 41 42.0986 40.8897 42.3219 40.6912C42.5451 40.4927 42.6814 40.2208 42.7034 39.9301L44.984 25.2833C45.3987 19.5722 37.5955 19.5722 38.0164 25.2833Z'\r\n            fill='#3F4350'\r\n        />\r\n        <path\r\n            d='M41.0072 47C41.798 47.0014 42.5706 47.2372 43.2275 47.6776C43.8843 48.118 44.396 48.7432 44.6976 49.4742C44.9993 50.2053 45.0774 51.0093 44.9222 51.7848C44.7671 52.5602 44.3856 53.2723 43.8259 53.831C43.2662 54.3897 42.5535 54.7699 41.7777 54.9237C41.002 55.0774 40.1981 54.9978 39.4676 54.6948C38.7371 54.3919 38.1128 53.8792 37.6736 53.2215C37.2344 52.5639 37 51.7908 37 51C37 50.4741 37.1036 49.9534 37.3051 49.4676C37.5066 48.9818 37.8019 48.5406 38.1741 48.169C38.5463 47.7975 38.9881 47.503 39.4743 47.3024C39.9604 47.1018 40.4813 46.9991 41.0072 47Z'\r\n            fill='#3F4350'\r\n        />\r\n        <path\r\n            d='M48.4619 68.5H70.0619'\r\n            stroke='var(--center-channel-color)'\r\n            strokeOpacity='0.56'\r\n            strokeWidth='1.08'\r\n            strokeLinecap='round'\r\n        />\r\n        <path\r\n            d='M10.001 50L26.001 19'\r\n            stroke='var(--center-channel-color)'\r\n            strokeOpacity='0.56'\r\n            strokeWidth='1.08'\r\n            strokeLinecap='round'\r\n        />\r\n    </svg>\r\n\r\n);\r\n\r\nexport default AlertSvg;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\n\r\nimport WithTooltip from 'components/with_tooltip';\r\n\r\nimport {canPopout} from 'utils/popouts/popout_windows';\r\n\r\ntype Props = {\r\n    onClick: React.MouseEventHandler<HTMLButtonElement>;\r\n    className?: string;\r\n};\r\n\r\nexport default function PopoutButton({\r\n    onClick,\r\n    className,\r\n}: Props) {\r\n    const intl = useIntl();\r\n\r\n    if (!canPopout()) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <WithTooltip\r\n            title={\r\n                <FormattedMessage\r\n                    id='new_window_button.tooltip'\r\n                    defaultMessage='Open in new window'\r\n                />\r\n            }\r\n        >\r\n            <button\r\n                type='button'\r\n                className={classNames('btn btn-icon btn-sm', 'PopoutButton', className)}\r\n                aria-label={intl.formatMessage({id: 'new_window_button.tooltip', defaultMessage: 'Open in new window'})}\r\n                onClick={onClick}\r\n            >\r\n                <i\r\n                    className='icon icon-dock-window'\r\n                    aria-hidden='true'\r\n                />\r\n            </button>\r\n        </WithTooltip>\r\n    );\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\n\r\nimport KeyboardShortcutSequence, {KEYBOARD_SHORTCUTS} from 'components/keyboard_shortcuts/keyboard_shortcuts_sequence';\r\nimport PopoutButton from 'components/popout_button';\r\nimport WithTooltip from 'components/with_tooltip';\r\n\r\nimport {RHSStates} from 'utils/constants';\r\nimport {isPopoutWindow} from 'utils/popouts/popout_windows';\r\n\r\nimport type {PropsFromRedux} from './index';\r\n\r\nexport interface Props extends PropsFromRedux {\r\n    children: React.ReactNode;\r\n    newWindowHandler?: () => void;\r\n}\r\n\r\nfunction SearchResultsHeader(props: Props) {\r\n    const {formatMessage} = useIntl();\r\n\r\n    const showExpand = props.previousRhsState !== RHSStates.CHANNEL_INFO;\r\n\r\n    // sidebarTooltipContent contains tooltips content for expand or shrink sidebarTooltip.\r\n    // if props.isExpanded is true, defaultMessage would feed from 'shrinkTooltip', else 'expandTooltip'\r\n    const sidebarTooltipContent = props.isExpanded ? (\r\n        <>\r\n            <FormattedMessage\r\n                id='rhs_header.collapseSidebarTooltip'\r\n                defaultMessage='Collapse the right sidebar'\r\n            />\r\n            <KeyboardShortcutSequence\r\n                shortcut={KEYBOARD_SHORTCUTS.navExpandSidebar}\r\n                hideDescription={true}\r\n                isInsideTooltip={true}\r\n            />\r\n        </>\r\n    ) : (\r\n        <>\r\n            <FormattedMessage\r\n                id='rhs_header.expandSidebarTooltip'\r\n                defaultMessage='Expand the right sidebar'\r\n            />\r\n            <KeyboardShortcutSequence\r\n                shortcut={KEYBOARD_SHORTCUTS.navExpandSidebar}\r\n                hideDescription={true}\r\n                isInsideTooltip={true}\r\n            />\r\n        </>\r\n    );\r\n\r\n    const expandOrCollapseSidebarButtonAriaLabel = props.isExpanded ? formatMessage({id: 'rhs_header.collapseSidebarTooltip.icon', defaultMessage: 'Collapse Sidebar Icon'}) : formatMessage({id: 'rhs_header.expandSidebarTooltip.icon', defaultMessage: 'Expand Sidebar Icon'});\r\n\r\n    return (\r\n        <div className='sidebar--right__header'>\r\n            <span\r\n                className='sidebar--right__title'\r\n                id='rhsPanelTitle'\r\n            >\r\n                {props.canGoBack && (\r\n                    <button\r\n                        className='sidebar--right__back btn btn-icon btn-sm'\r\n                        onClick={props.actions.goBack}\r\n                        aria-label={formatMessage({id: 'rhs_header.back.icon', defaultMessage: 'Back Icon'})}\r\n                    >\r\n                        <i className='icon icon-arrow-back-ios'/>\r\n                    </button>\r\n                )}\r\n                {props.children}\r\n            </span>\r\n            <div className='pull-right'>\r\n                {showExpand && !isPopoutWindow() && (\r\n                    <WithTooltip\r\n                        title={sidebarTooltipContent}\r\n                    >\r\n                        <button\r\n                            type='button'\r\n                            className='sidebar--right__expand btn btn-icon btn-sm'\r\n                            onClick={props.actions.toggleRhsExpanded}\r\n                            aria-label={expandOrCollapseSidebarButtonAriaLabel}\r\n                        >\r\n                            <i\r\n                                className='icon icon-arrow-expand'\r\n                                aria-hidden='true'\r\n                            />\r\n                            <i\r\n                                className='icon icon-arrow-collapse'\r\n                                aria-hidden='true'\r\n                            />\r\n                        </button>\r\n                    </WithTooltip>\r\n                )}\r\n                {props.newWindowHandler && (\r\n                    <PopoutButton onClick={props.newWindowHandler}/>\r\n                )}\r\n                {!isPopoutWindow() &&\r\n                    <WithTooltip\r\n                        title={\r\n                            <FormattedMessage\r\n                                id='rhs_header.closeSidebarTooltip'\r\n                                defaultMessage='Close'\r\n                            />\r\n                        }\r\n                    >\r\n                        <button\r\n                            id='searchResultsCloseButton'\r\n                            type='button'\r\n                            className='sidebar--right__close btn btn-icon btn-sm'\r\n                            aria-label='Close'\r\n                            onClick={props.actions.closeRightHandSide}\r\n                        >\r\n                            <i\r\n                                className='icon icon-close'\r\n                                aria-label={formatMessage({id: 'rhs_header.closeTooltip.icon', defaultMessage: 'Close Sidebar Icon'})}\r\n                            />\r\n                        </button>\r\n                    </WithTooltip>\r\n                }\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default SearchResultsHeader;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {ConnectedProps} from 'react-redux';\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {AnyAction, Dispatch} from 'redux';\r\n\r\nimport {getCurrentChannelId} from 'mattermost-redux/selectors/entities/common';\r\n\r\nimport {\r\n    closeRightHandSide,\r\n    toggleRhsExpanded,\r\n    goBack,\r\n} from 'actions/views/rhs';\r\nimport {getIsRhsExpanded, getPreviousRhsState} from 'selectors/rhs';\r\n\r\nimport {RHSStates} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store/index.js';\r\n\r\nimport SearchResultsHeader from './search_results_header';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const previousRhsState = getPreviousRhsState(state);\r\n    const canGoBack = previousRhsState === RHSStates.CHANNEL_INFO ||\r\n        previousRhsState === RHSStates.CHANNEL_MEMBERS ||\r\n        previousRhsState === RHSStates.CHANNEL_FILES ||\r\n        previousRhsState === RHSStates.PIN;\r\n\r\n    return {\r\n        isExpanded: getIsRhsExpanded(state),\r\n        channelId: getCurrentChannelId(state),\r\n        previousRhsState,\r\n        canGoBack,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<AnyAction>) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            closeRightHandSide,\r\n            toggleRhsExpanded,\r\n            goBack,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nconst connector = connect(mapStateToProps, mapDispatchToProps);\r\n\r\nexport type PropsFromRedux = ConnectedProps<typeof connector>;\r\n\r\nexport default connector(SearchResultsHeader);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {useIntl} from 'react-intl';\r\nimport styled from 'styled-components';\r\n\r\nconst EditButton = styled.button`\r\n    border: 0;\r\n    margin: 0px;\r\n    padding: 0px;\r\n    border-radius: 4px;\r\n    background: rgba(var(--center-channel-color-rgb), 0.04);\r\n    color: rgba(var(--center-channel-color-rgb), 0.75);\r\n    &:hover {\r\n        background: rgba(var(--center-channel-color-rgb), 0.08);\r\n        color: rgba(var(--center-channel-color-rgb), 0.75);\r\n    }\r\n    width: 24px;\r\n    height: 24px;\r\n    i.icon {\r\n        font-size: 14.4px;\r\n    }\r\n`;\r\n\r\nconst EmptyPlace = styled.button`\r\n    padding: 0px;\r\n    background: transparent;\r\n    border: 0px;\r\n    color: rgba(var(--center-channel-color-rgb), 0.75);\r\n    i {\r\n        display: none;\r\n        font-size: 14px;\r\n        margin-left: 4px;\r\n    }\r\n    &:hover {\r\n        color: rgba(var(--center-channel-color-rgb), 0.75);\r\n        i {\r\n            display: inline-block;\r\n        }\r\n    }\r\n`;\r\n\r\ninterface EditableAreaProps {\r\n    editable: boolean;\r\n    content: React.ReactNode;\r\n    emptyLabel: string;\r\n    onEdit: () => void;\r\n    className?: string;\r\n}\r\n\r\nconst EditableAreaBase = ({editable, content, emptyLabel, onEdit, className}: EditableAreaProps) => {\r\n    const {formatMessage} = useIntl();\r\n\r\n    const allowEditArea = editable && content;\r\n\r\n    return (\r\n        <div className={className}>\r\n            <div className='EditableArea__content'>\r\n                {content}\r\n                {!content && editable && (\r\n                    <EmptyPlace\r\n                        onClick={onEdit}\r\n                        aria-label={formatMessage({id: 'channel_info_rhs.edit_link', defaultMessage: 'Edit'})}\r\n                    >\r\n                        {emptyLabel}\r\n                        <i className='icon icon-pencil-outline edit-icon'/>\r\n                    </EmptyPlace>\r\n                )}\r\n            </div>\r\n            <div className='EditableArea__edit'>\r\n                {allowEditArea ? (\r\n                    <EditButton\r\n                        onClick={onEdit}\r\n                        aria-label={formatMessage({id: 'channel_info_rhs.edit_link', defaultMessage: 'Edit'})}\r\n                    >\r\n                        <i className='icon icon-pencil-outline'/>\r\n                    </EditButton>\r\n                ) : ''}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst EditableArea = styled(EditableAreaBase)`\r\n    display: flex;\r\n    &>.EditableArea__content {\r\n        flex: 1;\r\n        p:last-child {\r\n            margin-bottom:0;\r\n        }\r\n    }\r\n    &:hover {\r\n        &>.EditableArea__edit {\r\n            visibility: visible;\r\n        }\r\n    }\r\n\r\n    &>.EditableArea__edit {\r\n        visibility: hidden;\r\n        width: 24px;\r\n    }\r\n`;\r\n\r\nexport default EditableArea;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useEffect, useRef, useState} from 'react';\r\nimport {CSSTransition} from 'react-transition-group';\r\nimport styled from 'styled-components';\r\n\r\ninterface LineLimiterProps {\r\n    children: React.ReactNode;\r\n    maxLines: number;\r\n    lineHeight: number;\r\n    moreText: string;\r\n    lessText: string;\r\n    className?: string;\r\n    errorMargin?: number;\r\n}\r\n\r\nconst LineLimiterBase = ({children, maxLines, lineHeight, moreText, lessText, errorMargin = 0.1, className}: LineLimiterProps) => {\r\n    const maxLineHeight = maxLines * lineHeight;\r\n\r\n    const [needLimiter, setNeedLimiter] = useState(false);\r\n    const [open, setOpen] = useState(false);\r\n    const [maxHeight, setMaxHeight] = useState('inherit');\r\n    const ref = useRef<HTMLDivElement>(null);\r\n\r\n    useEffect(() => {\r\n        if (ref === null || ref.current === null) {\r\n            return;\r\n        }\r\n\r\n        const contentHeight = ref.current.scrollHeight;\r\n        const margin = maxLineHeight * errorMargin;\r\n        if (contentHeight > (maxLineHeight + margin)) {\r\n            setNeedLimiter(true);\r\n\r\n            if (open) {\r\n                setMaxHeight(`${contentHeight}px`);\r\n            } else {\r\n                setMaxHeight(`${maxLineHeight}px`);\r\n            }\r\n        } else {\r\n            setNeedLimiter(false);\r\n            setMaxHeight('inherit');\r\n        }\r\n    }, [children, open]);\r\n\r\n    return (\r\n        <CSSTransition\r\n            in={open}\r\n            timeout={500}\r\n            classNames='LineLimiter--Transition-'\r\n        >\r\n            <>\r\n                <div\r\n                    className={className}\r\n                    style={{maxHeight}}\r\n                >\r\n                    <div>\r\n                        <div ref={ref}>{children}</div>\r\n                    </div>\r\n                </div>\r\n                {needLimiter && (\r\n                    <ToggleButton\r\n                        className='LineLimiter__toggler'\r\n                        onClick={() => setOpen(!open)}\r\n                    >\r\n                        {open ? lessText : moreText}\r\n                    </ToggleButton>\r\n                )}\r\n            </>\r\n        </CSSTransition>\r\n    );\r\n};\r\n\r\nconst ToggleButton = styled.button`\r\n    border: 0px;\r\n    background-color: var(--center-channel-bg);\r\n    color: var(--button-bg);\r\n    padding: 0;\r\n    margin: 0;\r\n`;\r\n\r\nconst LineLimiter = styled(LineLimiterBase)<LineLimiterProps>`\r\n    transition: max-height 0.5s ease;\r\n    line-height: ${(props) => props.lineHeight}px;\r\n    overflow: hidden;\r\n\r\n    p {\r\n        margin-bottom: ${(props) => props.lineHeight}px;\r\n    }\r\n\r\n    span[data-emoticon] {\r\n        max-height: ${(props) => props.lineHeight}px;\r\n        .emoticon {\r\n            max-height: ${(props) => props.lineHeight}px;\r\n            min-height: ${(props) => props.lineHeight}px;\r\n         }\r\n    }\r\n\r\n    .markdown-inline-img__container img.markdown-inline-img {\r\n        max-height: ${(props) => props.lineHeight}px !important;\r\n        margin-top: 0 !important;\r\n        margin-bottom: 0 !important;\r\n    }\r\n\r\n    & > * {\r\n       overflow: hidden;\r\n    }\r\n`;\r\n\r\nexport default LineLimiter;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {useIntl} from 'react-intl';\r\nimport styled from 'styled-components';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\n\r\nimport Markdown from 'components/markdown';\r\n\r\nimport EditableArea from './components/editable_area';\r\nimport LineLimiter from './components/linelimiter';\r\n\r\nconst ChannelId = styled.div`\r\n    margin-bottom: 12px;\r\n    font-size: 11px;\r\n    line-height: 16px;\r\n    letter-spacing: 0.02em;\r\n    color: rgba(var(--center-channel-color-rgb), 0.75);\r\n`;\r\n\r\nconst ChannelPurpose = styled.div`\r\n    margin-bottom: 12px;\r\n    &.ChannelPurpose--is-dm {\r\n        margin-bottom: 16px;\r\n    }\r\n`;\r\n\r\nconst ChannelDescriptionHeading = styled.div`\r\n    color: rgba(var(--center-channel-color-rgb), 0.75);\r\n    font-size: 12px;\r\n    font-style: normal;\r\n    font-weight: 600;\r\n    line-height: 16px;\r\n    letter-spacing: 0.24px;\r\n    text-transform: uppercase;\r\n    padding: 6px 0px;\r\n`;\r\n\r\nconst ChannelHeader = styled.div`\r\n    margin-bottom: 12px;\r\n`;\r\n\r\ninterface Props {\r\n    channel: Channel;\r\n    canEditChannelProperties: boolean;\r\n    actions: {\r\n        editChannelPurpose: () => void;\r\n        editChannelHeader: () => void;\r\n    };\r\n}\r\n\r\nconst AboutAreaChannel = ({channel, canEditChannelProperties, actions}: Props) => {\r\n    const {formatMessage} = useIntl();\r\n\r\n    return (\r\n        <>\r\n            {(channel.purpose || canEditChannelProperties) && (\r\n                <ChannelPurpose>\r\n                    <ChannelDescriptionHeading>\r\n                        {formatMessage({id: 'channel_info_rhs.about_area.channel_purpose.heading', defaultMessage: 'Channel Purpose'})}\r\n                    </ChannelDescriptionHeading>\r\n                    <EditableArea\r\n                        editable={canEditChannelProperties}\r\n                        content={channel.purpose && (\r\n                            <LineLimiter\r\n                                maxLines={4}\r\n                                lineHeight={20}\r\n                                moreText={formatMessage({id: 'channel_info_rhs.about_area.channel_purpose.line_limiter.more', defaultMessage: 'more'})}\r\n                                lessText={formatMessage({id: 'channel_info_rhs.about_area.channel_purpose.line_limiter.less', defaultMessage: 'less'})}\r\n                            >\r\n                                <Markdown message={channel.purpose}/>\r\n                            </LineLimiter>\r\n                        )}\r\n                        onEdit={actions.editChannelPurpose}\r\n                        emptyLabel={formatMessage({id: 'channel_info_rhs.about_area.add_channel_purpose', defaultMessage: 'Add a channel purpose'})}\r\n                    />\r\n                </ChannelPurpose>\r\n            )}\r\n\r\n            {(channel.header || canEditChannelProperties) && (\r\n                <ChannelHeader>\r\n                    <ChannelDescriptionHeading>\r\n                        {formatMessage({id: 'channel_info_rhs.about_area.channel_header.heading', defaultMessage: 'Channel Header'})}\r\n                    </ChannelDescriptionHeading>\r\n                    <EditableArea\r\n                        content={channel.header && (\r\n                            <LineLimiter\r\n                                maxLines={4}\r\n                                lineHeight={20}\r\n                                moreText={formatMessage({id: 'channel_info_rhs.about_area.channel_header.line_limiter.more', defaultMessage: 'more'})}\r\n                                lessText={formatMessage({id: 'channel_info_rhs.about_area.channel_header.line_limiter.less', defaultMessage: 'less'})}\r\n                            >\r\n                                <Markdown message={channel.header}/>\r\n                            </LineLimiter>\r\n                        )}\r\n                        editable={canEditChannelProperties}\r\n                        onEdit={actions.editChannelHeader}\r\n                        emptyLabel={formatMessage({id: 'channel_info_rhs.about_area.add_channel_header', defaultMessage: 'Add a channel header'})}\r\n                    />\r\n                </ChannelHeader>\r\n            )}\r\n\r\n            <ChannelId>\r\n                {formatMessage({id: 'channel_info_rhs.about_area_id', defaultMessage: 'ID:'})} {channel.id}\r\n            </ChannelId>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default AboutAreaChannel;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {useIntl} from 'react-intl';\r\nimport styled from 'styled-components';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\n\r\nimport {Client4} from 'mattermost-redux/client';\r\n\r\nimport Markdown from 'components/markdown';\r\nimport ProfilePicture from 'components/profile_picture';\r\nimport BotTag from 'components/widgets/tag/bot_tag';\r\nimport GuestTag from 'components/widgets/tag/guest_tag';\r\n\r\nimport type {DMUser} from './channel_info_rhs';\r\nimport EditableArea from './components/editable_area';\r\nimport LineLimiter from './components/linelimiter';\r\n\r\nconst Username = styled.p`\r\n    font-family: Metropolis, sans-serif;\r\n    font-size: 18px;\r\n    line-height: 24px;\r\n    color: rgb(var(--center-channel-color-rgb));\r\n    font-weight: 600;\r\n    margin: 0;\r\n`;\r\n\r\nconst ChannelHeader = styled.div`\r\n    margin-bottom: 12px;\r\n`;\r\n\r\nconst UserInfoContainer = styled.div`\r\n    display: flex;\r\n    align-items: center;\r\n    margin-bottom: 12px;\r\n`;\r\n\r\nconst UserAvatar = styled.div`\r\n    .status {\r\n        bottom: 0;\r\n        right: 0;\r\n        height: 18px;\r\n        width: 18px;\r\n        & svg {\r\n            min-height: 14.4px;\r\n        }\r\n    }\r\n`;\r\n\r\nconst UserInfo = styled.div`\r\n    margin-left: 12px;\r\n    display: flex;\r\n    flex-direction: column;\r\n`;\r\n\r\nconst UsernameContainer = styled.div`\r\n    display: flex;\r\n    gap: 8px\r\n`;\r\n\r\nconst UserPosition = styled.div`\r\n    line-height: 20px;\r\n\r\n    p {\r\n        margin-bottom: 0;\r\n    }\r\n`;\r\n\r\nconst ChannelId = styled.div`\r\n    margin-bottom: 12px;\r\n    font-size: 11px;\r\n    line-height: 16px;\r\n    letter-spacing: 0.02em;\r\n    color: rgba(var(--center-channel-color-rgb), 0.75);\r\n`;\r\n\r\ninterface Props {\r\n    channel: Channel;\r\n    dmUser: DMUser;\r\n    actions: {\r\n        editChannelHeader: () => void;\r\n    };\r\n}\r\n\r\nconst AboutAreaDM = ({channel, dmUser, actions}: Props) => {\r\n    const {formatMessage} = useIntl();\r\n\r\n    return (\r\n        <>\r\n            <UserInfoContainer>\r\n                <UserAvatar>\r\n                    <ProfilePicture\r\n                        src={Client4.getProfilePictureUrl(dmUser.user.id, dmUser.user.last_picture_update)}\r\n                        isBot={dmUser.user.is_bot}\r\n                        status={dmUser.status ? dmUser.status : undefined}\r\n                        username={dmUser.display_name}\r\n                        userId={dmUser.user.id}\r\n                        channelId={channel.id}\r\n                        size='xl'\r\n                    />\r\n                </UserAvatar>\r\n                <UserInfo>\r\n                    <UsernameContainer>\r\n                        <Username>{dmUser.display_name}</Username>\r\n                        {dmUser.user.is_bot && <BotTag/>}\r\n                        {dmUser.is_guest && <GuestTag/>}\r\n                    </UsernameContainer>\r\n                    <UserPosition>\r\n                        <Markdown message={dmUser.user.is_bot ? dmUser.user.bot_description : dmUser.user.position}/>\r\n                    </UserPosition>\r\n                </UserInfo>\r\n            </UserInfoContainer>\r\n\r\n            {!dmUser.user.is_bot && (\r\n                <ChannelHeader>\r\n                    <EditableArea\r\n                        content={channel.header && (\r\n                            <LineLimiter\r\n                                maxLines={4}\r\n                                lineHeight={20}\r\n                                moreText={formatMessage({id: 'channel_info_rhs.about_area.channel_header.line_limiter.more', defaultMessage: 'more'})}\r\n                                lessText={formatMessage({id: 'channel_info_rhs.about_area.channel_header.line_limiter.less', defaultMessage: 'less'})}\r\n                            >\r\n                                <Markdown message={channel.header}/>\r\n                            </LineLimiter>\r\n                        )}\r\n                        editable={true}\r\n                        onEdit={actions.editChannelHeader}\r\n                        emptyLabel={formatMessage({id: 'channel_info_rhs.about_area.add_channel_header', defaultMessage: 'Add a channel header'})}\r\n                    />\r\n                </ChannelHeader>\r\n            )}\r\n\r\n            <ChannelId>\r\n                {formatMessage({id: 'channel_info_rhs.about_area_id', defaultMessage: 'ID:'})} {channel.id}\r\n            </ChannelId>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default AboutAreaDM;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {useIntl} from 'react-intl';\r\nimport styled from 'styled-components';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\n\r\nimport {Client4} from 'mattermost-redux/client';\r\n\r\nimport Markdown from 'components/markdown';\r\nimport ProfilePicture from 'components/profile_picture';\r\nimport UserProfileElement from 'components/user_profile';\r\n\r\nimport EditableArea from './components/editable_area';\r\nimport LineLimiter from './components/linelimiter';\r\n\r\nconst Usernames = styled.p`\r\n    font-family: Metropolis, sans-serif;\r\n    font-size: 18px;\r\n    line-height: 24px;\r\n    color: rgb(var(--center-channel-color-rgb));\r\n    font-weight: 600;\r\n    margin: 0;\r\n`;\r\n\r\nconst ProfilePictures = styled.div`\r\n    margin-bottom: 10px;\r\n`;\r\n\r\ninterface ProfilePictureContainerProps {\r\n    position: number;\r\n}\r\n\r\nconst ProfilePictureContainer = styled.div<ProfilePictureContainerProps>`\r\n    display: inline-block;\r\n    position: relative;\r\n    left: ${(props) => props.position * -15}px;\r\n\r\n    & img {\r\n        border: 2px solid white;\r\n    }\r\n`;\r\n\r\nconst UsersArea = styled.div`\r\n    margin-bottom: 12px;\r\n    &.ChannelPurpose--is-dm {\r\n        margin-bottom: 16px;\r\n    }\r\n`;\r\n\r\nconst ChannelHeader = styled.div`\r\n    margin-bottom: 12px;\r\n`;\r\n\r\nconst ChannelId = styled.div`\r\n    margin-bottom: 12px;\r\n    font-size: 11px;\r\n    line-height: 16px;\r\n    letter-spacing: 0.02em;\r\n    color: rgba(var(--center-channel-color-rgb), 0.75);\r\n`;\r\n\r\ninterface Props {\r\n    channel: Channel;\r\n    gmUsers: UserProfile[];\r\n    actions: {\r\n        editChannelHeader: () => void;\r\n    };\r\n}\r\n\r\nconst AboutAreaGM = ({channel, gmUsers, actions}: Props) => {\r\n    const {formatMessage} = useIntl();\r\n\r\n    return (\r\n        <>\r\n            <UsersArea>\r\n                <ProfilePictures>\r\n                    {gmUsers.map((user, idx) => (\r\n                        <ProfilePictureContainer\r\n                            key={user.id}\r\n                            position={idx}\r\n                        >\r\n                            <ProfilePicture\r\n                                src={Client4.getProfilePictureUrl(user.id, user.last_picture_update)}\r\n                                size='xl'\r\n                                userId={user.id}\r\n                                username={user.username}\r\n                                channelId={channel.id}\r\n                            />\r\n                        </ProfilePictureContainer>\r\n                    ))}\r\n                </ProfilePictures>\r\n                <Usernames>\r\n                    {gmUsers.map((user, i, {length}) => (\r\n                        <React.Fragment key={user.id}>\r\n                            <UserProfileElement\r\n                                userId={user.id}\r\n                                channelId={channel.id}\r\n                            />\r\n                            {(i + 1 !== length) && (<span>{', '}</span>)}\r\n                        </React.Fragment>\r\n                    ))}\r\n                </Usernames>\r\n            </UsersArea>\r\n\r\n            <ChannelHeader>\r\n                <EditableArea\r\n                    content={channel.header && (\r\n                        <LineLimiter\r\n                            maxLines={4}\r\n                            lineHeight={20}\r\n                            moreText={formatMessage({id: 'channel_info_rhs.about_area.channel_header.line_limiter.more', defaultMessage: 'more'})}\r\n                            lessText={formatMessage({id: 'channel_info_rhs.about_area.channel_header.line_limiter.less', defaultMessage: 'less'})}\r\n                        >\r\n                            <Markdown message={channel.header}/>\r\n                        </LineLimiter>\r\n                    )}\r\n                    editable={true}\r\n                    onEdit={actions.editChannelHeader}\r\n                    emptyLabel={formatMessage({id: 'channel_info_rhs.about_area.add_channel_header', defaultMessage: 'Add a channel header'})}\r\n                />\r\n            </ChannelHeader>\r\n\r\n            <ChannelId>\r\n                {formatMessage({id: 'channel_info_rhs.about_area_id', defaultMessage: 'ID:'})} {channel.id}\r\n            </ChannelId>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default AboutAreaGM;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport styled from 'styled-components';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\n\r\nimport Constants from 'utils/constants';\r\n\r\nimport AboutAreaChannel from './about_area_channel';\r\nimport AboutAreaDM from './about_area_dm';\r\nimport AboutAreaGM from './about_area_gm';\r\nimport type {DMUser} from './channel_info_rhs';\r\n\r\nconst Container = styled.div`\r\n    overflow-wrap: anywhere;\r\n    padding: 24px;\r\n    padding-bottom: 12px;\r\n\r\n    font-size: 14px;\r\n    line-height: 20px;\r\n\r\n    & .status-wrapper {\r\n        height: 50px;\r\n    }\r\n\r\n    & .text-empty {\r\n        padding: 0px;\r\n        background: transparent;\r\n        border: 0px;\r\n        color: rgba(var(--center-channel-color-rgb), 0.75);\r\n    }\r\n`;\r\n\r\ninterface Props {\r\n    channel: Channel;\r\n    dmUser?: DMUser;\r\n    gmUsers?: UserProfile[];\r\n    canEditChannelProperties: boolean;\r\n    actions: {\r\n        editChannelPurpose: () => void;\r\n        editChannelHeader: () => void;\r\n    };\r\n}\r\n\r\nconst AboutArea = ({channel, dmUser, gmUsers, canEditChannelProperties, actions}: Props) => {\r\n    return (\r\n        <Container>\r\n            {channel.type === Constants.DM_CHANNEL && dmUser && (\r\n                <AboutAreaDM\r\n                    channel={channel}\r\n                    dmUser={dmUser}\r\n                    actions={{editChannelHeader: actions.editChannelHeader}}\r\n                />\r\n            )}\r\n            {channel.type === Constants.GM_CHANNEL && gmUsers && (\r\n                <AboutAreaGM\r\n                    channel={channel}\r\n                    gmUsers={gmUsers!}\r\n                    actions={{editChannelHeader: actions.editChannelHeader}}\r\n                />\r\n            )}\r\n            {[Constants.OPEN_CHANNEL, Constants.PRIVATE_CHANNEL].includes(channel.type) && (\r\n                <AboutAreaChannel\r\n                    channel={channel}\r\n                    canEditChannelProperties={canEditChannelProperties}\r\n                    actions={actions}\r\n                />\r\n            )}\r\n        </Container>\r\n    );\r\n};\r\n\r\nexport default AboutArea;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\nimport styled from 'styled-components';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\n\r\nimport WithTooltip from 'components/with_tooltip';\r\n\r\ninterface Props {\r\n    channel: Channel;\r\n    isArchived: boolean;\r\n    isMobile: boolean;\r\n    onClose: () => void;\r\n}\r\n\r\nconst Icon = styled.i`\r\n    font-size:12px;\r\n`;\r\n\r\nconst HeaderTitle = styled.span`\r\n    line-height: 2.4rem;\r\n`;\r\n\r\nconst Header = ({channel, isArchived, isMobile, onClose}: Props) => {\r\n    const {formatMessage} = useIntl();\r\n\r\n    return (\r\n        <div className='sidebar--right__header'>\r\n            <span className='sidebar--right__title'>\r\n                {isMobile && (\r\n                    <button\r\n                        className='sidebar--right__back btn btn-icon btn-sm'\r\n                        onClick={onClose}\r\n                        aria-label={formatMessage({id: 'rhs_header.back.icon', defaultMessage: 'Back Icon'})}\r\n                    >\r\n                        <i\r\n                            className='icon icon-arrow-back-ios'\r\n                        />\r\n                    </button>\r\n                )}\r\n                <h2>\r\n                    <HeaderTitle\r\n                        id='rhsPanelTitle'\r\n                    >\r\n                        <FormattedMessage\r\n                            id='channel_info_rhs.header.title'\r\n                            defaultMessage='Info'\r\n                        />\r\n                    </HeaderTitle>\r\n\r\n                    {channel.display_name &&\r\n                    <span\r\n                        className='style--none sidebar--right__title__subtitle'\r\n                    >\r\n                        {isArchived && (<Icon className='icon icon-archive-outline'/>)}\r\n                        {channel.display_name}\r\n                    </span>\r\n                    }\r\n                </h2>\r\n            </span>\r\n\r\n            <WithTooltip\r\n                title={\r\n                    <FormattedMessage\r\n                        id='rhs_header.closeSidebarTooltip'\r\n                        defaultMessage='Close'\r\n                    />\r\n                }\r\n            >\r\n                <button\r\n                    id='rhsCloseButton'\r\n                    type='button'\r\n                    className='sidebar--right__close btn btn-icon btn-sm'\r\n                    aria-label={formatMessage({id: 'rhs_header.closeTooltip.icon', defaultMessage: 'Close Sidebar Icon'})}\r\n                    onClick={onClose}\r\n                >\r\n                    <i\r\n                        className='icon icon-close'\r\n                    />\r\n                </button>\r\n            </WithTooltip>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Header;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useEffect, useState} from 'react';\r\nimport {useIntl} from 'react-intl';\r\nimport styled from 'styled-components';\r\n\r\nimport type {Channel, ChannelStats} from '@mattermost/types/channels';\r\n\r\nimport LoadingSpinner from 'components/widgets/loading/loading_spinner';\r\n\r\nimport {Constants} from 'utils/constants';\r\n\r\nconst MenuContainer = styled.nav`\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: flex-start;\r\n    padding: 16px 0;\r\n\r\n    font-size: 14px;\r\n    line-height: 20px;\r\n    color: rgb(var(--center-channel-color-rgb));\r\n`;\r\n\r\nconst MenuItemButton = styled.button`\r\n    display: flex;\r\n    flex-direction: row;\r\n    align-items: center;\r\n    width: 100%;\r\n    height: 40px;\r\n    padding: 8px 16px;\r\n\r\n    background: none;\r\n    border: none;\r\n    text-align: left;\r\n    cursor: pointer;\r\n\r\n    &:hover {\r\n        background: rgba(var(--center-channel-color-rgb), 0.08);\r\n    }\r\n`;\r\n\r\nconst Icon = styled.div`\r\n    color: rgba(var(--center-channel-color-rgb), var(--icon-opacity));\r\n`;\r\n\r\nconst MenuItemText = styled.div`\r\n    padding-left: 8px;\r\n    flex: 1;\r\n`;\r\n\r\nconst RightSide = styled.div`\r\n    display: flex;\r\n    color: rgba(var(--center-channel-color-rgb), 0.75);\r\n`;\r\n\r\nconst Badge = styled.div`\r\n    font-size: 12px;\r\n    line-height: 18px;\r\n    width: 20px;\r\n    display: flex;\r\n    place-content: center;\r\n`;\r\n\r\ninterface MenuItemProps {\r\n    icon: JSX.Element;\r\n    text: string;\r\n    opensSubpanel?: boolean;\r\n    badge?: string | number | JSX.Element;\r\n    onClick: () => void;\r\n    id?: string;\r\n}\r\n\r\nfunction MenuItem(props: MenuItemProps) {\r\n    const {icon, text, opensSubpanel, badge, onClick, id} = props;\r\n    const hasRightSide = (badge !== undefined) || opensSubpanel;\r\n\r\n    return (\r\n        <MenuItemButton\r\n            onClick={onClick}\r\n            aria-label={text}\r\n            type='button'\r\n            id={id || ''}\r\n        >\r\n            <Icon>{icon}</Icon>\r\n            <MenuItemText>{text}</MenuItemText>\r\n            {hasRightSide && (\r\n                <RightSide>\r\n                    {badge !== undefined && (\r\n                        <Badge>{badge}</Badge>\r\n                    )}\r\n                    {opensSubpanel && (\r\n                        <Icon><i className='icon icon-chevron-right'/></Icon>\r\n                    )}\r\n                </RightSide>\r\n            )}\r\n        </MenuItemButton>\r\n    );\r\n}\r\n\r\ninterface MenuProps {\r\n    channel: Channel;\r\n    channelStats: ChannelStats;\r\n    isArchived: boolean;\r\n\r\n    className?: string;\r\n\r\n    actions: {\r\n        openNotificationSettings: () => void;\r\n        showChannelFiles: (channelId: string) => void;\r\n        showPinnedPosts: (channelId: string | undefined) => void;\r\n        showChannelMembers: (channelId: string) => void;\r\n        getChannelStats: (channelId: string, includeFileCount: boolean) => Promise<{data: ChannelStats}>;\r\n    };\r\n}\r\n\r\nexport default function Menu(props: MenuProps) {\r\n    const {formatMessage} = useIntl();\r\n    const {\r\n        channel,\r\n        channelStats,\r\n        isArchived,\r\n        className,\r\n        actions,\r\n    } = props;\r\n\r\n    const [loadingStats, setLoadingStats] = useState(true);\r\n\r\n    const showNotificationPreferences = channel.type !== Constants.DM_CHANNEL && !isArchived;\r\n    const showMembers = channel.type !== Constants.DM_CHANNEL;\r\n    const fileCount = channelStats?.files_count >= 0 ? channelStats?.files_count : 0;\r\n\r\n    useEffect(() => {\r\n        actions.getChannelStats(channel.id, true).then(() => {\r\n            setLoadingStats(false);\r\n        });\r\n        return () => {\r\n            setLoadingStats(true);\r\n        };\r\n    }, [channel.id]);\r\n\r\n    return (\r\n        <MenuContainer\r\n            className={className}\r\n            data-testid='channel_info_rhs-menu'\r\n            aria-label={formatMessage({\r\n                id: 'channel_info_rhs.menu.title',\r\n                defaultMessage: 'Channel Info Actions',\r\n            })}\r\n        >\r\n            {showNotificationPreferences && (\r\n                <MenuItem\r\n                    id='channelInfoRHSNotificationSettings'\r\n                    icon={<i className='icon icon-bell-outline'/>}\r\n                    text={formatMessage({\r\n                        id: 'channel_info_rhs.menu.notification_preferences',\r\n                        defaultMessage: 'Notification Preferences',\r\n                    })}\r\n                    onClick={actions.openNotificationSettings}\r\n                />\r\n            )}\r\n            {showMembers && (\r\n                <MenuItem\r\n                    icon={<i className='icon icon-account-outline'/>}\r\n                    text={formatMessage({\r\n                        id: 'channel_info_rhs.menu.members',\r\n                        defaultMessage: 'Members',\r\n                    })}\r\n                    opensSubpanel={true}\r\n                    badge={channelStats.member_count}\r\n                    onClick={() => actions.showChannelMembers(channel.id)}\r\n                />\r\n            )}\r\n            <MenuItem\r\n                icon={<i className='icon icon-pin-outline'/>}\r\n                text={formatMessage({\r\n                    id: 'channel_info_rhs.menu.pinned',\r\n                    defaultMessage: 'Pinned messages',\r\n                })}\r\n                opensSubpanel={true}\r\n                badge={channelStats?.pinnedpost_count}\r\n                onClick={() => actions.showPinnedPosts(channel.id)}\r\n            />\r\n            <MenuItem\r\n                icon={<i className='icon icon-file-text-outline'/>}\r\n                text={formatMessage({\r\n                    id: 'channel_info_rhs.menu.files',\r\n                    defaultMessage: 'Files',\r\n                })}\r\n                opensSubpanel={true}\r\n                badge={loadingStats ? <LoadingSpinner/> : fileCount}\r\n                onClick={() => actions.showChannelFiles(channel.id)}\r\n            />\r\n        </MenuContainer>\r\n    );\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {useIntl, FormattedMessage} from 'react-intl';\r\nimport styled from 'styled-components';\r\n\r\nimport useCopyText from 'components/common/hooks/useCopyText';\r\nimport WithTooltip from 'components/with_tooltip';\r\n\r\nimport Constants from 'utils/constants';\r\n\r\nconst ChannelInfoRhsTopButtons = styled.div`\r\n    display: flex;\r\n    color: rgba(var(--center-channel-color-rgb), 0.75);\r\n    margin-top: 24px;\r\n    padding: 0 18px;\r\n`;\r\n\r\nconst Button = styled.button`\r\n    flex: 1;\r\n    padding: 12px 0 10px 0;\r\n    border: 0;\r\n    margin: 0 6px;\r\n    background: rgba(var(--center-channel-color-rgb), 0.04);\r\n    border-radius: 4px;\r\n\r\n    &:hover {\r\n        background: rgba(var(--center-channel-color-rgb), 0.08);\r\n        color: rgba(var(--center-channel-color-rgb), 0.8);\r\n\r\n        & i {\r\n            color: rgba(var(--center-channel-color-rgb), var(--icon-opacity-hover));\r\n        }\r\n    }\r\n\r\n    &:active,\r\n    &.active {\r\n        background: rgba(var(--button-bg-rgb), 0.08);\r\n        color: var(--button-bg);\r\n\r\n        & i {\r\n            color: var(--button-bg-rgb);\r\n        }\r\n    }\r\n\r\n    & i {\r\n        color: rgba(var(--center-channel-color-rgb), var(--icon-opacity));\r\n        font-size: 24px;\r\n    }\r\n\r\n    & span {\r\n        font-size: 10px;\r\n        font-weight: 600;\r\n        line-height: 16px;\r\n    }\r\n`;\r\n\r\nconst CopyButton = styled(Button)`\r\n    transition: background-color 0.5s ease;\r\n\r\n    &:active,\r\n    &.active {\r\n        background: rgba(var(--center-channel-color-rgb), 0.08);\r\n        color: rgba(var(--center-channel-color-rgb), 0.75);\r\n        transition: none;\r\n    }\r\n\r\n    &.success {\r\n        background: var(--online-indicator);\r\n        color: var(--button-color);\r\n\r\n        & i {\r\n            color: var(--button-color);\r\n        }\r\n    }\r\n`;\r\n\r\nexport interface Props {\r\n    channelType: string;\r\n    channelURL?: string;\r\n\r\n    isFavorite: boolean;\r\n    isMuted: boolean;\r\n    isInvitingPeople: boolean;\r\n\r\n    canAddPeople: boolean;\r\n\r\n    actions: {\r\n        toggleFavorite: () => void;\r\n        toggleMute: () => void;\r\n        addPeople: () => void;\r\n    };\r\n}\r\n\r\nexport default function TopButtons({\r\n    channelType,\r\n    channelURL,\r\n    isFavorite,\r\n    isMuted,\r\n    isInvitingPeople,\r\n    canAddPeople: propsCanAddPeople,\r\n    actions,\r\n}: Props) {\r\n    const {formatMessage} = useIntl();\r\n\r\n    const copyLink = useCopyText({\r\n        text: channelURL || '',\r\n        successCopyTimeout: 1000,\r\n    });\r\n\r\n    const canAddPeople = ([Constants.OPEN_CHANNEL, Constants.PRIVATE_CHANNEL].includes(channelType) && propsCanAddPeople) || channelType === Constants.GM_CHANNEL;\r\n\r\n    const canCopyLink = [Constants.OPEN_CHANNEL, Constants.PRIVATE_CHANNEL].includes(channelType);\r\n\r\n    // Favorite Button State\r\n    const favoriteIcon = isFavorite ? 'icon-star' : 'icon-star-outline';\r\n    const favoriteText = isFavorite ? formatMessage({id: 'channel_info_rhs.top_buttons.favorited', defaultMessage: 'Favorited'}) : formatMessage({id: 'channel_info_rhs.top_buttons.favorite', defaultMessage: 'Favorite'});\r\n\r\n    // Mute Button State\r\n    const mutedIcon = isMuted ? 'icon-bell-off-outline' : 'icon-bell-outline';\r\n    const mutedText = isMuted ? formatMessage({id: 'channel_info_rhs.top_buttons.muted', defaultMessage: 'Muted'}) : formatMessage({id: 'channel_info_rhs.top_buttons.mute', defaultMessage: 'Mute'});\r\n\r\n    // Copy Button State\r\n    const copyIcon = copyLink.copiedRecently ? 'icon-check' : 'icon-link-variant';\r\n    const copyText = copyLink.copiedRecently ? formatMessage({id: 'channel_info_rhs.top_buttons.copied', defaultMessage: 'Copied'}) : formatMessage({id: 'channel_info_rhs.top_buttons.copy', defaultMessage: 'Copy Link'});\r\n\r\n    return (\r\n        <ChannelInfoRhsTopButtons>\r\n            <WithTooltip\r\n                title={\r\n                    <FormattedMessage\r\n                        id='channel_info_rhs.top_buttons.favorite.tooltip'\r\n                        defaultMessage='Add this channel to favorites'\r\n                    />\r\n                }\r\n            >\r\n                <Button\r\n                    onClick={actions.toggleFavorite}\r\n                    className={isFavorite ? 'active' : ''}\r\n                    aria-label={favoriteText}\r\n                    id='channelInfoRHSAddFavoriteButton'\r\n                >\r\n                    <div>\r\n                        <i className={'icon ' + favoriteIcon}/>\r\n                    </div>\r\n                    <span>{favoriteText}</span>\r\n                </Button>\r\n            </WithTooltip>\r\n            <WithTooltip\r\n                title={\r\n                    <FormattedMessage\r\n                        id='channel_info_rhs.top_buttons.mute.tooltip'\r\n                        defaultMessage='Mute notifications for this channel'\r\n                    />\r\n                }\r\n            >\r\n                <Button\r\n                    onClick={actions.toggleMute}\r\n                    className={isMuted ? 'active' : ''}\r\n                    aria-label={mutedText}\r\n                    id='channelInfoRHSMuteChannelButton'\r\n                >\r\n                    <div>\r\n                        <i className={'icon ' + mutedIcon}/>\r\n                    </div>\r\n                    <span>{mutedText}</span>\r\n                </Button>\r\n            </WithTooltip>\r\n            {canAddPeople && (\r\n                <WithTooltip\r\n                    title={\r\n                        <FormattedMessage\r\n                            id='channel_info_rhs.top_buttons.add_people.tooltip'\r\n                            defaultMessage='Add team members to this channel'\r\n                        />\r\n                    }\r\n                >\r\n                    <Button\r\n                        onClick={actions.addPeople}\r\n                        className={isInvitingPeople ? 'active' : ''}\r\n                        id='channelInfoRHSAddPeopleButton'\r\n                    >\r\n                        <div>\r\n                            <i className='icon icon-account-plus-outline'/>\r\n                        </div>\r\n                        <span>\r\n                            <FormattedMessage\r\n                                id='channel_info_rhs.top_buttons.add_people'\r\n                                defaultMessage='Add People'\r\n                            />\r\n                        </span>\r\n                    </Button>\r\n                </WithTooltip>\r\n            )}\r\n            {canCopyLink && (\r\n                <WithTooltip\r\n                    title={\r\n                        <FormattedMessage\r\n                            id='channel_info_rhs.top_buttons.copy_link.tooltip'\r\n                            defaultMessage='Copy link to this channel'\r\n                        />\r\n                    }\r\n                >\r\n                    <CopyButton\r\n                        onClick={copyLink.onClick}\r\n                        className={copyLink.copiedRecently ? 'success' : ''}\r\n                        aria-label={copyText}\r\n                    >\r\n                        <div>\r\n                            <i className={'icon ' + copyIcon}/>\r\n                        </div>\r\n                        <span>{copyText}</span>\r\n                    </CopyButton>\r\n                </WithTooltip>\r\n            )}\r\n        </ChannelInfoRhsTopButtons>\r\n    );\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {memo} from 'react';\r\nimport styled from 'styled-components';\r\n\r\nimport type {Channel, ChannelStats} from '@mattermost/types/channels';\r\nimport type {Team} from '@mattermost/types/teams';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\n\r\nimport ChannelInviteModal from 'components/channel_invite_modal';\r\nimport ChannelNotificationsModal from 'components/channel_notifications_modal';\r\nimport EditChannelHeaderModal from 'components/edit_channel_header_modal';\r\nimport EditChannelPurposeModal from 'components/edit_channel_purpose_modal';\r\nimport MoreDirectChannels from 'components/more_direct_channels';\r\n\r\nimport Constants, {ModalIdentifiers} from 'utils/constants';\r\nimport {getSiteURL} from 'utils/url';\r\n\r\nimport type {ModalData} from 'types/actions';\r\n\r\nimport AboutArea from './about_area';\r\nimport Header from './header';\r\nimport Menu from './menu';\r\nimport TopButtons from './top_buttons';\r\n\r\nconst Divider = styled.div`\r\n    width: 88%;\r\n    border: 1px solid rgba(var(--center-channel-color-rgb), 0.04);\r\n    margin: 0 auto;\r\n`;\r\n\r\nexport interface DMUser {\r\n    user: UserProfile;\r\n    display_name: string;\r\n    is_guest: boolean;\r\n    status: string;\r\n}\r\n\r\nexport interface Props {\r\n    channel: Channel;\r\n    channelStats: ChannelStats;\r\n    currentUser: UserProfile;\r\n    currentTeam: Team;\r\n    isArchived: boolean;\r\n    isFavorite: boolean;\r\n    isMuted: boolean;\r\n    isInvitingPeople: boolean;\r\n    isMobile: boolean;\r\n    canManageMembers: boolean;\r\n    canManageProperties: boolean;\r\n    dmUser?: DMUser;\r\n    channelMembers: UserProfile[];\r\n    actions: {\r\n        closeRightHandSide: () => void;\r\n        unfavoriteChannel: (channelId: string) => void;\r\n        favoriteChannel: (channelId: string) => void;\r\n        unmuteChannel: (userId: string, channelId: string) => void;\r\n        muteChannel: (userId: string, channelId: string) => void;\r\n        openModal: <P>(modalData: ModalData<P>) => void;\r\n        showChannelFiles: (channelId: string) => void;\r\n        showPinnedPosts: (channelId: string | undefined) => void;\r\n        showChannelMembers: (channelId: string) => void;\r\n        getChannelStats: (channelId: string) => Promise<{data: ChannelStats}>;\r\n    };\r\n}\r\n\r\nconst ChannelInfoRhs = ({\r\n    channel,\r\n    channelStats,\r\n    isArchived,\r\n    isFavorite,\r\n    isMuted,\r\n    isInvitingPeople,\r\n    isMobile,\r\n    currentTeam,\r\n    currentUser,\r\n    dmUser,\r\n    channelMembers,\r\n    canManageMembers,\r\n    canManageProperties,\r\n    actions,\r\n}: Props) => {\r\n    const currentUserId = currentUser.id;\r\n    const channelURL = getSiteURL() + '/' + currentTeam.name + '/channels/' + channel.name;\r\n\r\n    const toggleFavorite = () => {\r\n        if (isFavorite) {\r\n            actions.unfavoriteChannel(channel.id);\r\n            return;\r\n        }\r\n        actions.favoriteChannel(channel.id);\r\n    };\r\n\r\n    const toggleMute = () => {\r\n        if (isMuted) {\r\n            actions.unmuteChannel(currentUserId, channel.id);\r\n            return;\r\n        }\r\n        actions.muteChannel(currentUserId, channel.id);\r\n    };\r\n\r\n    const addPeople = () => {\r\n        if (channel.type === Constants.GM_CHANNEL) {\r\n            return actions.openModal({\r\n                modalId: ModalIdentifiers.CREATE_DM_CHANNEL,\r\n                dialogType: MoreDirectChannels,\r\n                dialogProps: {isExistingChannel: true, focusOriginElement: 'channelInfoRHSAddPeopleButton'},\r\n            });\r\n        }\r\n\r\n        return actions.openModal({\r\n            modalId: ModalIdentifiers.CHANNEL_INVITE,\r\n            dialogType: ChannelInviteModal,\r\n            dialogProps: {channel},\r\n        });\r\n    };\r\n\r\n    const editChannelPurpose = () => actions.openModal({\r\n        modalId: ModalIdentifiers.EDIT_CHANNEL_PURPOSE,\r\n        dialogType: EditChannelPurposeModal,\r\n        dialogProps: {channel},\r\n    });\r\n\r\n    const editChannelHeader = () => actions.openModal({\r\n        modalId: ModalIdentifiers.EDIT_CHANNEL_HEADER,\r\n        dialogType: EditChannelHeaderModal,\r\n        dialogProps: {channel},\r\n    });\r\n\r\n    const openNotificationSettings = () => actions.openModal({\r\n        modalId: ModalIdentifiers.CHANNEL_NOTIFICATIONS,\r\n        dialogType: ChannelNotificationsModal,\r\n        dialogProps: {channel, currentUser, focusOriginElement: 'channelInfoRHSNotificationSettings'},\r\n    });\r\n\r\n    const gmUsers = channelMembers.filter((user) => {\r\n        return user.id !== currentUser.id;\r\n    });\r\n\r\n    const canEditChannelProperties = !isArchived && canManageProperties;\r\n\r\n    return (\r\n        <div\r\n            id='rhsContainer'\r\n            className='sidebar-right__body'\r\n        >\r\n            <Header\r\n                channel={channel}\r\n                isArchived={isArchived}\r\n                isMobile={isMobile}\r\n                onClose={actions.closeRightHandSide}\r\n            />\r\n            <TopButtons\r\n                channelType={channel.type}\r\n                channelURL={channelURL}\r\n                isFavorite={isFavorite}\r\n                isMuted={isMuted}\r\n                isInvitingPeople={isInvitingPeople}\r\n                canAddPeople={canManageMembers}\r\n                actions={{toggleFavorite, toggleMute, addPeople}}\r\n            />\r\n            <AboutArea\r\n                channel={channel}\r\n                dmUser={dmUser}\r\n                gmUsers={gmUsers}\r\n                canEditChannelProperties={canEditChannelProperties}\r\n                actions={{\r\n                    editChannelHeader,\r\n                    editChannelPurpose,\r\n                }}\r\n            />\r\n            <Divider/>\r\n            <Menu\r\n                channel={channel}\r\n                channelStats={channelStats}\r\n                isArchived={isArchived}\r\n                actions={{\r\n                    openNotificationSettings,\r\n                    showChannelFiles: actions.showChannelFiles,\r\n                    showPinnedPosts: actions.showPinnedPosts,\r\n                    showChannelMembers: actions.showChannelMembers,\r\n                    getChannelStats: actions.getChannelStats,\r\n                }}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default memo(ChannelInfoRhs);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {AnyAction, Dispatch} from 'redux';\r\n\r\nimport {unfavoriteChannel, favoriteChannel, getChannelStats} from 'mattermost-redux/actions/channels';\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {getCurrentChannel, isCurrentChannelFavorite, isCurrentChannelMuted, isCurrentChannelArchived, getCurrentChannelStats} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getCurrentUser} from 'mattermost-redux/selectors/entities/common';\r\nimport {haveIChannelPermission} from 'mattermost-redux/selectors/entities/roles';\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getProfilesInCurrentChannel, getStatusForUserId, getUser} from 'mattermost-redux/selectors/entities/users';\r\nimport {isGuest} from 'mattermost-redux/utils/user_utils';\r\n\r\nimport {muteChannel, unmuteChannel} from 'actions/channel_actions';\r\nimport {openModal} from 'actions/views/modals';\r\nimport {closeRightHandSide, showChannelFiles, showChannelMembers, showPinnedPosts} from 'actions/views/rhs';\r\nimport {getIsMobileView} from 'selectors/views/browser';\r\nimport {isModalOpen} from 'selectors/views/modals';\r\n\r\nimport {Constants, ModalIdentifiers} from 'utils/constants';\r\nimport {getDisplayNameByUser, getUserIdFromChannelId} from 'utils/utils';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport RHS from './channel_info_rhs';\r\nimport type {Props} from './channel_info_rhs';\r\n\r\nconst EMPTY_CHANNEL_STATS = {\r\n    member_count: 0,\r\n    guest_count: 0,\r\n    pinnedpost_count: 0,\r\n    files_count: 0,\r\n};\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const channel = getCurrentChannel(state);\r\n    const currentUser = getCurrentUser(state);\r\n    const currentTeam = getCurrentTeam(state);\r\n    const channelStats = getCurrentChannelStats(state) || EMPTY_CHANNEL_STATS;\r\n    const isArchived = isCurrentChannelArchived(state);\r\n    const isFavorite = isCurrentChannelFavorite(state);\r\n    const isMuted = isCurrentChannelMuted(state);\r\n    const isInvitingPeople = isModalOpen(state, ModalIdentifiers.CHANNEL_INVITE) || isModalOpen(state, ModalIdentifiers.CREATE_DM_CHANNEL);\r\n    const isMobile = getIsMobileView(state);\r\n\r\n    const isPrivate = channel?.type === Constants.PRIVATE_CHANNEL;\r\n    const canManageMembers = haveIChannelPermission(state, currentTeam?.id, channel?.id, isPrivate ? Permissions.MANAGE_PRIVATE_CHANNEL_MEMBERS : Permissions.MANAGE_PUBLIC_CHANNEL_MEMBERS);\r\n    const canManageProperties = haveIChannelPermission(state, currentTeam?.id, channel?.id, isPrivate ? Permissions.MANAGE_PRIVATE_CHANNEL_PROPERTIES : Permissions.MANAGE_PUBLIC_CHANNEL_PROPERTIES);\r\n\r\n    const channelMembers = getProfilesInCurrentChannel(state);\r\n\r\n    const props = {\r\n        channel,\r\n        currentUser,\r\n        currentTeam,\r\n        isArchived,\r\n        isFavorite,\r\n        isMuted,\r\n        isInvitingPeople,\r\n        isMobile,\r\n        canManageMembers,\r\n        canManageProperties,\r\n        channelStats,\r\n        channelMembers,\r\n    } as Props;\r\n\r\n    if (channel?.type === Constants.DM_CHANNEL) {\r\n        const user = getUser(state, getUserIdFromChannelId(channel.name, currentUser.id));\r\n        props.dmUser = {\r\n            user,\r\n            display_name: getDisplayNameByUser(state, user),\r\n            is_guest: isGuest(user.roles),\r\n            status: getStatusForUserId(state, user.id),\r\n        };\r\n    }\r\n\r\n    return props;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<AnyAction>) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            closeRightHandSide,\r\n            unfavoriteChannel,\r\n            favoriteChannel,\r\n            unmuteChannel,\r\n            muteChannel,\r\n            openModal,\r\n            showChannelFiles,\r\n            showPinnedPosts,\r\n            showChannelMembers,\r\n            getChannelStats,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(RHS);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback, useEffect} from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\nimport styled from 'styled-components';\r\n\r\nimport Constants from 'utils/constants';\r\nimport {isKeyPressed} from 'utils/keyboard';\r\n\r\nconst Title = styled.div`\r\n    flex:1;\r\n    font-family: 'Open Sans', sans-serif;\r\n    font-weight: 600;\r\n    font-size: 14px;\r\n    line-height: 20px;\r\n`;\r\n\r\nconst Actions = styled.div`\r\n    button + button {\r\n        margin-left: 8px;\r\n    }\r\n`;\r\n\r\nconst Button = styled.button`\r\n    border: none;\r\n    background: transparent;\r\n    width: fit-content;\r\n    padding: 8px 16px;\r\n    border-radius: 4px;\r\n    font-size: 12px;\r\n    font-weight: 600;\r\n    line-height: 16px;\r\n    &.add-members, &.manage-members-done {\r\n        background-color: var(--button-bg);\r\n        color: var(--button-color);\r\n        &:hover, &:active, &:focus {\r\n            background: linear-gradient(0deg, rgba(var(--center-channel-color-rgb), 0.16), rgba(var(--center-channel-color-rgb), 0.16)), var(--button-bg);\r\n            color: var(--button-color);\r\n        }\r\n    }\r\n    &.manage-members {\r\n        background: rgba(var(--button-bg-rgb),0.08);\r\n        color: var(--button-bg);\r\n        &:hover, &:focus {\r\n            background: rgba(var(--button-bg-rgb),0.12);\r\n        }\r\n        &:active {\r\n            background: rgba(var(--button-bg-rgb),0.16);\r\n        }\r\n    }\r\n`;\r\n\r\nconst ButtonIcon = styled.i`\r\n    font-size: 14.4px;\r\n`;\r\n\r\nexport interface Props {\r\n    className?: string;\r\n    channelType: string;\r\n    membersCount: number;\r\n    canManageMembers: boolean;\r\n    editing: boolean;\r\n    actions: {\r\n        startEditing: () => void;\r\n        stopEditing: () => void;\r\n        inviteMembers: () => void;\r\n    };\r\n}\r\n\r\nconst ActionBar = ({className, channelType, membersCount, canManageMembers, editing, actions}: Props) => {\r\n    const showManageButton = channelType !== Constants.GM_CHANNEL && membersCount > 1;\r\n\r\n    const handleShortcut = useCallback((e: KeyboardEvent) => {\r\n        if (isKeyPressed(e, Constants.KeyCodes.ESCAPE) && editing) {\r\n            actions.stopEditing();\r\n        }\r\n    }, [editing, actions]);\r\n\r\n    useEffect(() => {\r\n        document.addEventListener('keydown', handleShortcut);\r\n        return () => {\r\n            document.removeEventListener('keydown', handleShortcut);\r\n        };\r\n    }, [handleShortcut]);\r\n\r\n    return (\r\n        <div className={className}>\r\n            <Title>\r\n                {editing ? (\r\n                    <FormattedMessage\r\n                        id='channel_members_rhs.action_bar.managing_title'\r\n                        defaultMessage='Managing Members'\r\n                    />\r\n                ) : (\r\n                    <FormattedMessage\r\n                        id='channel_members_rhs.action_bar.members_count_title'\r\n                        defaultMessage='{members_count} members'\r\n                        values={{members_count: membersCount}}\r\n                    />\r\n                )}\r\n\r\n            </Title>\r\n\r\n            {canManageMembers && (\r\n                <Actions>\r\n                    {editing ? (\r\n                        <Button\r\n                            onClick={actions.stopEditing}\r\n                            className='manage-members-done'\r\n                        >\r\n                            <FormattedMessage\r\n                                id='channel_members_rhs.action_bar.done_button'\r\n                                defaultMessage='Done'\r\n                            />\r\n                        </Button>\r\n                    ) : (\r\n                        <>\r\n                            {showManageButton && (\r\n                                <Button\r\n                                    className='manage-members'\r\n                                    onClick={actions.startEditing}\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='channel_members_rhs.action_bar.manage_button'\r\n                                        defaultMessage='Manage'\r\n                                    />\r\n                                </Button>\r\n                            )}\r\n                            <Button\r\n                                onClick={actions.inviteMembers}\r\n                                className='add-members'\r\n                            >\r\n                                <ButtonIcon\r\n                                    className='icon-account-plus-outline'\r\n                                    title='Add Icon'\r\n                                />\r\n                                <FormattedMessage\r\n                                    id='channel_members_rhs.action_bar.add_button'\r\n                                    defaultMessage='Add'\r\n                                />\r\n                            </Button>\r\n                        </>\r\n                    )}\r\n\r\n                </Actions>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default styled(ActionBar)`\r\n    display: flex;\r\n    flex-direction: row;\r\n    align-items: center;\r\n    padding: 16px 20px;\r\n`;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\nimport styled from 'styled-components';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\n\r\nimport WithTooltip from 'components/with_tooltip';\r\n\r\ninterface Props {\r\n    channel: Channel;\r\n    canGoBack: boolean;\r\n\r\n    onClose: () => void;\r\n    goBack: () => void;\r\n}\r\n\r\nconst HeaderTitle = styled.span`\r\n    line-height: 2.4rem;\r\n`;\r\n\r\nconst Header = ({channel, canGoBack, onClose, goBack}: Props) => {\r\n    const {formatMessage} = useIntl();\r\n\r\n    return (\r\n        <div className='sidebar--right__header'>\r\n            <span className='sidebar--right__title'>\r\n\r\n                {canGoBack && (\r\n                    <button\r\n                        className='sidebar--right__back btn btn-icon btn-sm'\r\n                        onClick={goBack}\r\n                        aria-label={formatMessage({id: 'rhs_header.back.icon', defaultMessage: 'Back Icon'})}\r\n                    >\r\n                        <i\r\n                            className='icon icon-arrow-back-ios'\r\n                        />\r\n                    </button>\r\n                )}\r\n                <h2>\r\n                    <HeaderTitle\r\n                        id='rhsPanelTitle'\r\n                    >\r\n                        <FormattedMessage\r\n                            id='channel_members_rhs.header.title'\r\n                            defaultMessage='Members'\r\n                        />\r\n                    </HeaderTitle>\r\n\r\n                    {channel.display_name &&\r\n                    <span\r\n                        className='style--none sidebar--right__title__subtitle'\r\n                    >\r\n                        {channel.display_name}\r\n                    </span>\r\n                    }\r\n                </h2>\r\n            </span>\r\n\r\n            <WithTooltip\r\n                title={\r\n                    <FormattedMessage\r\n                        id='rhs_header.closeSidebarTooltip'\r\n                        defaultMessage='Close'\r\n                    />\r\n                }\r\n            >\r\n                <button\r\n                    id='rhsCloseButton'\r\n                    type='button'\r\n                    className='sidebar--right__close btn btn-icon btn-sm'\r\n                    aria-label={formatMessage({id: 'rhs_header.closeTooltip.icon', defaultMessage: 'Close Sidebar Icon'})}\r\n                    onClick={onClose}\r\n                >\r\n                    <i\r\n                        className='icon icon-close'\r\n                    />\r\n                </button>\r\n            </WithTooltip>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Header;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {useIntl} from 'react-intl';\r\nimport styled from 'styled-components';\r\n\r\nimport Input from 'components/widgets/inputs/input/input';\r\n\r\ninterface Props {\r\n    className?: string;\r\n    terms: string;\r\n    onInput: (terms: string) => void;\r\n}\r\n\r\nconst SearchBar = ({className, terms, onInput}: Props) => {\r\n    const {formatMessage} = useIntl();\r\n\r\n    let inputSuffix;\r\n    if (terms.length > 0) {\r\n        inputSuffix = (\r\n            <button\r\n                className='style--none'\r\n                onClick={() => onInput('')}\r\n                aria-label={formatMessage({\r\n                    id: 'channel_members_rhs.search_bar.aria.cancel_search_button',\r\n                    defaultMessage: 'cancel members search',\r\n                })}\r\n            >\r\n                <i className={'icon icon-close-circle'}/>\r\n            </button>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className={className}>\r\n            <Input\r\n                data-testid='channel-member-rhs-search'\r\n                value={terms}\r\n                onInput={(e) => onInput(e.currentTarget.value)}\r\n                inputPrefix={<i className={'icon icon-magnify'}/>}\r\n                inputSuffix={inputSuffix}\r\n                placeholder={formatMessage({\r\n                    id: 'channel_members_rhs.search_bar.placeholder',\r\n                    defaultMessage: 'Search members',\r\n                })}\r\n                useLegend={false}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default styled(SearchBar)`\r\n    display: flex;\r\n    padding: 0px 20px 12px;\r\n\r\n    .Input_container .Input_wrapper {\r\n        padding: 0 8px;\r\n    }\r\n`;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport debounce from 'lodash/debounce';\r\nimport React, {useCallback, useEffect, useState} from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\nimport {useHistory} from 'react-router-dom';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\n\r\nimport {ProfilesInChannelSortBy} from 'mattermost-redux/actions/users';\r\n\r\nimport AlertBanner from 'components/alert_banner';\r\nimport ChannelInviteModal from 'components/channel_invite_modal';\r\nimport useAccessControlAttributes, {EntityType} from 'components/common/hooks/useAccessControlAttributes';\r\nimport ExternalLink from 'components/external_link';\r\nimport MoreDirectChannels from 'components/more_direct_channels';\r\nimport AlertTag from 'components/widgets/tag/alert_tag';\r\nimport TagGroup from 'components/widgets/tag/tag_group';\r\n\r\nimport Constants, {ModalIdentifiers} from 'utils/constants';\r\n\r\nimport type {ModalData} from 'types/actions';\r\n\r\nimport ActionBar from './action_bar';\r\nimport Header from './header';\r\nimport MemberList, {ListItemType} from './member_list';\r\nimport type {ChannelMember, ListItem} from './member_list';\r\nimport SearchBar from './search';\r\n\r\nimport './channel_members_rhs.scss';\r\n\r\nconst USERS_PER_PAGE = 100;\r\n\r\nexport interface Props {\r\n    channel: Channel;\r\n    currentUserIsChannelAdmin: boolean;\r\n    membersCount: number;\r\n    searchTerms: string;\r\n    canGoBack: boolean;\r\n    teamUrl: string;\r\n    channelMembers: ChannelMember[];\r\n    canManageMembers: boolean;\r\n    editing: boolean;\r\n\r\n    actions: {\r\n        openModal: <P>(modalData: ModalData<P>) => void;\r\n        openDirectChannelToUserId: (userId: string) => Promise<{data: Channel}>;\r\n        closeRightHandSide: () => void;\r\n        goBack: () => void;\r\n        setChannelMembersRhsSearchTerm: (terms: string) => void;\r\n        loadProfilesAndReloadChannelMembers: (page: number, perParge: number, channelId: string, sort: string) => void;\r\n        loadMyChannelMemberAndRole: (channelId: string) => void;\r\n        setEditChannelMembers: (active: boolean) => void;\r\n        searchProfilesAndChannelMembers: (term: string, options: any) => Promise<{data: UserProfile[]}>;\r\n        fetchRemoteClusterInfo: (remoteId: string, forceRefresh?: boolean) => void;\r\n    };\r\n}\r\n\r\nexport default function ChannelMembersRHS({\r\n    channel,\r\n    currentUserIsChannelAdmin,\r\n    searchTerms,\r\n    membersCount,\r\n    canGoBack,\r\n    teamUrl,\r\n    channelMembers,\r\n    canManageMembers,\r\n    editing = false,\r\n    actions,\r\n}: Props) {\r\n    const history = useHistory();\r\n\r\n    const [list, setList] = useState<ListItem[]>([]);\r\n\r\n    const [page, setPage] = useState(0);\r\n    const [isNextPageLoading, setIsNextPageLoading] = useState(false);\r\n    const {formatMessage} = useIntl();\r\n\r\n    const {structuredAttributes, loading} = useAccessControlAttributes(\r\n        EntityType.Channel,\r\n        channel.id,\r\n        channel.policy_enforced,\r\n    );\r\n\r\n    // Helper function to format attribute names for tooltips\r\n    const formatAttributeName = (name: string): string => {\r\n        // Convert snake_case or camelCase to Title Case with spaces\r\n        return name.\r\n            replace(/_/g, ' ').\r\n            replace(/([A-Z])/g, ' $1').\r\n            replace(/\\w\\S*/g, (txt) => txt.charAt(0).toUpperCase() + txt.substring(1).toLowerCase());\r\n    };\r\n\r\n    const searching = searchTerms !== '';\r\n\r\n    const isDefaultChannel = channel.name === Constants.DEFAULT_CHANNEL;\r\n\r\n    // show search if there's more than 20 or if the user have an active search.\r\n    const showSearch = searching || membersCount >= 20;\r\n\r\n    useEffect(() => {\r\n        return () => {\r\n            actions.setChannelMembersRhsSearchTerm('');\r\n        };\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        const listcp: ListItem[] = [];\r\n        let memberDone = false;\r\n\r\n        for (let i = 0; i < channelMembers.length; i++) {\r\n            const member = channelMembers[i];\r\n            if (listcp.length === 0) {\r\n                let text = null;\r\n                if (member.membership?.scheme_admin === true) {\r\n                    text = (\r\n                        <FormattedMessage\r\n                            id='channel_members_rhs.list.channel_admin_title'\r\n                            defaultMessage='CHANNEL ADMINS'\r\n                        />\r\n                    );\r\n                } else {\r\n                    text = (\r\n                        <FormattedMessage\r\n                            id='channel_members_rhs.list.channel_members_title'\r\n                            defaultMessage='MEMBERS'\r\n                        />\r\n                    );\r\n                    memberDone = true;\r\n                }\r\n\r\n                listcp.push({\r\n                    type: ListItemType.FirstSeparator,\r\n                    data: <div className='channel-members-rhs__member-list-separator channel-members-rhs__member-list-separator--first'>{text}</div>,\r\n                });\r\n            } else if (!memberDone && member.membership?.scheme_admin === false) {\r\n                listcp.push({\r\n                    type: ListItemType.Separator,\r\n                    data: <div className='channel-members-rhs__member-list-separator'>\r\n                        <FormattedMessage\r\n                            id='channel_members_rhs.list.channel_members_title'\r\n                            defaultMessage='MEMBERS'\r\n                        />\r\n                    </div>,\r\n                });\r\n                memberDone = true;\r\n            }\r\n\r\n            listcp.push({type: ListItemType.Member, data: member});\r\n        }\r\n        if (JSON.stringify(list) !== JSON.stringify(listcp)) {\r\n            setList(listcp);\r\n        }\r\n    }, [channelMembers]);\r\n\r\n    useEffect(() => {\r\n        if (channel.type === Constants.DM_CHANNEL) {\r\n            let rhsAction = actions.closeRightHandSide;\r\n            if (canGoBack) {\r\n                rhsAction = actions.goBack;\r\n            }\r\n            rhsAction();\r\n            return;\r\n        }\r\n\r\n        setPage(0);\r\n        setIsNextPageLoading(false);\r\n        actions.setChannelMembersRhsSearchTerm('');\r\n        actions.loadProfilesAndReloadChannelMembers(0, USERS_PER_PAGE, channel.id, ProfilesInChannelSortBy.Admin);\r\n        actions.loadMyChannelMemberAndRole(channel.id);\r\n    }, [channel.id, channel.type]);\r\n\r\n    const setSearchTerms = async (terms: string) => {\r\n        actions.setChannelMembersRhsSearchTerm(terms);\r\n    };\r\n\r\n    const doSearch = useCallback(debounce(async (terms: string) => {\r\n        await actions.searchProfilesAndChannelMembers(terms, {in_team_id: channel.team_id, in_channel_id: channel.id});\r\n    }, Constants.SEARCH_TIMEOUT_MILLISECONDS), [actions.searchProfilesAndChannelMembers]);\r\n\r\n    useEffect(() => {\r\n        if (searchTerms) {\r\n            doSearch(searchTerms);\r\n        }\r\n    }, [searchTerms]);\r\n\r\n    const inviteMembers = () => {\r\n        if (channel.type === Constants.GM_CHANNEL) {\r\n            return actions.openModal({\r\n                modalId: ModalIdentifiers.CREATE_DM_CHANNEL,\r\n                dialogType: MoreDirectChannels,\r\n                dialogProps: {isExistingChannel: true, focusOriginElement: 'channelInfoRHSAddPeopleButton'},\r\n            });\r\n        }\r\n\r\n        return actions.openModal({\r\n            modalId: ModalIdentifiers.CHANNEL_INVITE,\r\n            dialogType: ChannelInviteModal,\r\n            dialogProps: {channel},\r\n        });\r\n    };\r\n\r\n    const openDirectMessage = useCallback(async (user: UserProfile) => {\r\n        // we first prepare the DM channel...\r\n        await actions.openDirectChannelToUserId(user.id);\r\n\r\n        // ... and then redirect to it\r\n        history.push(teamUrl + '/messages/@' + user.username);\r\n\r\n        await actions.closeRightHandSide();\r\n    }, [actions.openDirectChannelToUserId, history, teamUrl, actions.closeRightHandSide]);\r\n\r\n    const loadMore = useCallback(async () => {\r\n        setIsNextPageLoading(true);\r\n\r\n        await actions.loadProfilesAndReloadChannelMembers(page + 1, USERS_PER_PAGE, channel.id, ProfilesInChannelSortBy.Admin);\r\n        setPage(page + 1);\r\n\r\n        setIsNextPageLoading(false);\r\n    }, [actions.loadProfilesAndReloadChannelMembers, page, channel.id],\r\n    );\r\n\r\n    return (\r\n        <div\r\n            id='rhsContainer'\r\n            className='sidebar-right__body channel-members-rhs'\r\n        >\r\n\r\n            <Header\r\n                channel={channel}\r\n                canGoBack={canGoBack}\r\n                onClose={actions.closeRightHandSide}\r\n                goBack={actions.goBack}\r\n            />\r\n            {/* Show banner for policy-enforced channels */}\r\n            {channel.policy_enforced && (\r\n                <div className='channel-members-rhs__alert-container policy-enforced'>\r\n                    <AlertBanner\r\n                        mode='info'\r\n                        variant='app'\r\n                        title={formatMessage({\r\n                            id: 'channel_members_rhs.policy_enforced_restrictions',\r\n                            defaultMessage: 'Channel access is restricted by user attributes',\r\n                        })}\r\n                    >\r\n                        {structuredAttributes.length > 0 && (\r\n                            <TagGroup>\r\n                                {structuredAttributes.flatMap((attribute) =>\r\n                                    attribute.values.map((value) => (\r\n                                        <AlertTag\r\n                                            key={`${attribute.name}-${value}`}\r\n                                            tooltipTitle={formatAttributeName(attribute.name)}\r\n                                            text={value}\r\n                                        />\r\n                                    )),\r\n                                )}\r\n                            </TagGroup>\r\n                        )}\r\n                        {loading && <span className='loading-indicator'>{'Loading...'}</span>}\r\n                    </AlertBanner>\r\n                </div>\r\n            )}\r\n\r\n            <ActionBar\r\n                channelType={channel.type}\r\n                membersCount={membersCount}\r\n                canManageMembers={canManageMembers}\r\n                editing={editing}\r\n                actions={{\r\n                    startEditing: () => actions.setEditChannelMembers(true),\r\n                    stopEditing: () => actions.setEditChannelMembers(false),\r\n                    inviteMembers,\r\n                }}\r\n            />\r\n\r\n            {/* Users with user management permissions have special restrictions in the default channel */}\r\n            {(editing && isDefaultChannel && !currentUserIsChannelAdmin) && (\r\n                <div className='channel-members-rhs__alert-container'>\r\n                    <AlertBanner\r\n                        mode='info'\r\n                        variant='app'\r\n                        message={formatMessage({\r\n                            id: 'channel_members_rhs.default_channel_moderation_restrictions',\r\n                            defaultMessage: 'In this channel, you can only remove guests. Only <link>channel admins</link> can manage other members.',\r\n                        }, {\r\n                            link: (msg: React.ReactNode) => (\r\n                                <ExternalLink\r\n                                    href='https://docs.mattermost.com/welcome/about-user-roles.html#channel-admin'\r\n                                    location='channel_members_rhs'\r\n                                >\r\n                                    {msg}\r\n                                </ExternalLink>\r\n                            ),\r\n                        })}\r\n                    />\r\n                </div>\r\n            )}\r\n\r\n            {showSearch && (\r\n                <SearchBar\r\n                    terms={searchTerms}\r\n                    onInput={setSearchTerms}\r\n                />\r\n            )}\r\n\r\n            <div className='channel-members-rhs__members-container'>\r\n                {channelMembers.length > 0 && (\r\n                    <MemberList\r\n                        searchTerms={searchTerms}\r\n                        members={list}\r\n                        editing={editing}\r\n                        channel={channel}\r\n                        openDirectMessage={openDirectMessage}\r\n                        fetchRemoteClusterInfo={actions.fetchRemoteClusterInfo}\r\n                        loadMore={loadMore}\r\n                        hasNextPage={channelMembers.length < membersCount}\r\n                        isNextPageLoading={isNextPageLoading}\r\n                    />\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {AnyAction, Dispatch} from 'redux';\r\n\r\nimport type {Channel, ChannelMembership} from '@mattermost/types/channels';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\nimport type {RelationOneToOne} from '@mattermost/types/utilities';\r\n\r\nimport {loadMyChannelMemberAndRole} from 'mattermost-redux/actions/channels';\r\nimport {fetchRemoteClusterInfo} from 'mattermost-redux/actions/shared_channels';\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {createSelector} from 'mattermost-redux/selectors/create_selector';\r\nimport {\r\n    getCurrentChannel,\r\n    getCurrentChannelStats,\r\n    getMembersInCurrentChannel,\r\n    getMyCurrentChannelMembership,\r\n    isCurrentChannelArchived,\r\n} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getTeammateNameDisplaySetting} from 'mattermost-redux/selectors/entities/preferences';\r\nimport {haveIChannelPermission} from 'mattermost-redux/selectors/entities/roles';\r\nimport {getRemoteDisplayName} from 'mattermost-redux/selectors/entities/shared_channels';\r\nimport {getCurrentRelativeTeamUrl, getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\nimport {\r\n    getActiveProfilesInCurrentChannelWithoutSorting,\r\n    getUserStatuses, searchActiveProfilesInCurrentChannel,\r\n} from 'mattermost-redux/selectors/entities/users';\r\nimport {displayUsername} from 'mattermost-redux/utils/user_utils';\r\n\r\nimport {openDirectChannelToUserId} from 'actions/channel_actions';\r\nimport {loadProfilesAndReloadChannelMembers, searchProfilesAndChannelMembers} from 'actions/user_actions';\r\nimport {openModal} from 'actions/views/modals';\r\nimport {closeRightHandSide, goBack, setEditChannelMembers} from 'actions/views/rhs';\r\nimport {setChannelMembersRhsSearchTerm} from 'actions/views/search';\r\nimport {getIsEditingMembers, getPreviousRhsState} from 'selectors/rhs';\r\n\r\nimport {Constants, RHSStates} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport ChannelMembersRHS from './channel_members_rhs';\r\nimport type {Props} from './channel_members_rhs';\r\nimport type {ChannelMember} from './member_list';\r\n\r\nconst buildProfileList = (\r\n    profilesInCurrentChannel: UserProfile[],\r\n    userStatuses: RelationOneToOne<UserProfile, string>,\r\n    teammateNameDisplaySetting: string,\r\n    membersInCurrentChannel: Record<string, ChannelMembership>,\r\n    state: GlobalState,\r\n) => {\r\n    const channelMembers: ChannelMember[] = [];\r\n    profilesInCurrentChannel.forEach((profile) => {\r\n        if (!membersInCurrentChannel[profile.id]) {\r\n            return;\r\n        }\r\n\r\n        const remoteDisplayName = profile.remote_id ? getRemoteDisplayName(state, profile.remote_id) || undefined : undefined;\r\n\r\n        channelMembers.push({\r\n            user: profile,\r\n            membership: membersInCurrentChannel[profile.id],\r\n            status: userStatuses[profile.id],\r\n            displayName: displayUsername(profile, teammateNameDisplaySetting),\r\n            remoteDisplayName,\r\n        });\r\n    });\r\n\r\n    channelMembers.sort((a, b) => {\r\n        if (a.membership?.scheme_admin === b.membership?.scheme_admin) {\r\n            return a.displayName.localeCompare(b.displayName);\r\n        }\r\n\r\n        if (a.membership?.scheme_admin === true) {\r\n            return -1;\r\n        }\r\n        return 1;\r\n    });\r\n\r\n    return channelMembers;\r\n};\r\n\r\nconst getProfiles = createSelector(\r\n    'getProfiles',\r\n    getActiveProfilesInCurrentChannelWithoutSorting,\r\n    getUserStatuses,\r\n    getTeammateNameDisplaySetting,\r\n    getMembersInCurrentChannel,\r\n    (state: GlobalState) => state,\r\n    buildProfileList,\r\n);\r\n\r\nconst searchProfiles = createSelector(\r\n    'searchProfiles',\r\n    (state: GlobalState, search: string) => searchActiveProfilesInCurrentChannel(state, search, false),\r\n    getUserStatuses,\r\n    getTeammateNameDisplaySetting,\r\n    getMembersInCurrentChannel,\r\n    (state: GlobalState) => state,\r\n    buildProfileList,\r\n);\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const channel = getCurrentChannel(state);\r\n    const currentTeam = getCurrentTeam(state);\r\n    const currentUser = getMyCurrentChannelMembership(state);\r\n    const {member_count: membersCount} = getCurrentChannelStats(state) || {member_count: 0};\r\n\r\n    if (!channel) {\r\n        return {\r\n            channel: {} as Channel,\r\n            currentUserIsChannelAdmin: false,\r\n            channelMembers: [],\r\n            channelAdmins: [],\r\n            searchTerms: '',\r\n            membersCount,\r\n            canManageMembers: false,\r\n            canGoBack: false,\r\n            teamUrl: '',\r\n        } as unknown as Props;\r\n    }\r\n\r\n    const isArchived = isCurrentChannelArchived(state);\r\n    const isPrivate = channel.type === Constants.PRIVATE_CHANNEL;\r\n    const canManageMembers = haveIChannelPermission(\r\n        state,\r\n        currentTeam?.id,\r\n        channel.id,\r\n        isPrivate ? Permissions.MANAGE_PRIVATE_CHANNEL_MEMBERS : Permissions.MANAGE_PUBLIC_CHANNEL_MEMBERS,\r\n    ) && !isArchived;\r\n\r\n    const searchTerms = state.views.search.channelMembersRhsSearch || '';\r\n\r\n    let channelMembers: ChannelMember[] = [];\r\n    if (searchTerms === '') {\r\n        channelMembers = getProfiles(state);\r\n    } else {\r\n        channelMembers = searchProfiles(state, searchTerms.trim());\r\n    }\r\n\r\n    const teamUrl = getCurrentRelativeTeamUrl(state);\r\n    const prevRhsState = getPreviousRhsState(state);\r\n    const hasInfoPrevState = prevRhsState === RHSStates.CHANNEL_INFO ||\r\n        prevRhsState === RHSStates.CHANNEL_FILES ||\r\n        prevRhsState === RHSStates.PIN;\r\n\r\n    const canGoBack = Boolean(hasInfoPrevState);\r\n    const editing = getIsEditingMembers(state);\r\n\r\n    const currentUserIsChannelAdmin = currentUser && currentUser.scheme_admin;\r\n\r\n    return {\r\n        channel,\r\n        currentUserIsChannelAdmin,\r\n        membersCount,\r\n        searchTerms,\r\n        teamUrl,\r\n        canGoBack,\r\n        canManageMembers,\r\n        channelMembers,\r\n        editing,\r\n    } as Props;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<AnyAction>) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            openModal,\r\n            openDirectChannelToUserId,\r\n            closeRightHandSide,\r\n            goBack,\r\n            setChannelMembersRhsSearchTerm,\r\n            loadProfilesAndReloadChannelMembers,\r\n            loadMyChannelMemberAndRole,\r\n            setEditChannelMembers,\r\n            searchProfilesAndChannelMembers,\r\n            fetchRemoteClusterInfo,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ChannelMembersRHS);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React, {useEffect, useCallback} from 'react';\r\nimport {useIntl} from 'react-intl';\r\nimport {CSSTransition} from 'react-transition-group';\r\n\r\nimport './info_toast.scss';\r\n\r\ntype Props = {\r\n    content: {\r\n        icon?: JSX.Element;\r\n        message: string;\r\n        undo?: () => void;\r\n    };\r\n    className?: string;\r\n    onExited: () => void;\r\n}\r\n\r\nfunction InfoToast({content, onExited, className}: Props): JSX.Element {\r\n    const {formatMessage} = useIntl();\r\n    const closeToast = useCallback(() => {\r\n        onExited();\r\n    }, [onExited]);\r\n\r\n    const undoTodo = useCallback(() => {\r\n        content.undo?.();\r\n        onExited();\r\n    }, [content.undo, onExited]);\r\n\r\n    const toastContainerClassname = classNames('info-toast', className);\r\n\r\n    useEffect(() => {\r\n        const timer = setTimeout(() => {\r\n            onExited();\r\n        }, 5000);\r\n\r\n        return () => clearTimeout(timer);\r\n    }, [onExited]);\r\n\r\n    return (\r\n        <CSSTransition\r\n            in={Boolean(content)}\r\n            classNames='toast'\r\n            mountOnEnter={true}\r\n            unmountOnExit={true}\r\n            timeout={300}\r\n            appear={true}\r\n        >\r\n            <div className={toastContainerClassname}>\r\n                {content.icon}\r\n                <span>{content.message}</span>\r\n                {content.undo && (\r\n                    <button\r\n                        onClick={undoTodo}\r\n                        className='info-toast__undo'\r\n                    >\r\n                        {formatMessage({\r\n                            id: 'post_info.edit.undo',\r\n                            defaultMessage: 'Undo',\r\n                        })}\r\n                    </button>\r\n                )}\r\n                <button\r\n                    className='info-toast__icon_button'\r\n                    onClick={closeToast}\r\n                    aria-label={formatMessage({id: 'general_button.close', defaultMessage: 'Close'})}\r\n                >\r\n                    <i className='icon icon-close'/>\r\n                </button>\r\n            </div>\r\n        </CSSTransition>\r\n    );\r\n}\r\n\r\nexport default React.memo(InfoToast);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {memo} from 'react';\r\nimport {defineMessages, useIntl} from 'react-intl';\r\n\r\nimport {GenericModal} from '@mattermost/components';\r\nimport type {Post} from '@mattermost/types/posts';\r\n\r\nimport FileAttachmentListContainer from 'components/file_attachment_list';\r\nimport PostMessageView from 'components/post_view/post_message_view';\r\n\r\nimport './restore_post_history.scss';\r\n\r\nconst modalMessages = defineMessages({\r\n    title: {\r\n        id: 'post_info.edit.restore',\r\n        defaultMessage: 'Restore this version',\r\n    },\r\n    titleQuestion: {\r\n        id: 'post_info.edit.restore_question',\r\n        defaultMessage: 'Restore this version?',\r\n    },\r\n});\r\n\r\ntype Props = {\r\n    post: Post;\r\n    postHeader: JSX.Element;\r\n    actions: {\r\n        handleRestore: (post: Post) => void;\r\n    };\r\n    onExited: () => void;\r\n}\r\n\r\nconst RestorePostModal = ({post, postHeader, actions, onExited}: Props) => {\r\n    const {formatMessage} = useIntl();\r\n    const onHide = () => onExited();\r\n\r\n    const handleRestore = async () => {\r\n        await actions.handleRestore(post);\r\n        onHide();\r\n    };\r\n\r\n    const modalHeaderText = (\r\n        <div className='edit-post-history__restore__modal__header'>\r\n            {formatMessage(modalMessages.titleQuestion)}\r\n        </div>\r\n    );\r\n\r\n    return (\r\n        <GenericModal\r\n            compassDesign={true}\r\n            onExited={onHide}\r\n            enforceFocus={false}\r\n            id='restorePostModal'\r\n            aria-labelledby='restorePostModalLabel'\r\n            modalHeaderText={modalHeaderText}\r\n            handleCancel={onHide}\r\n            cancelButtonClassName='cancel-button'\r\n            handleConfirm={handleRestore}\r\n        >\r\n            <div className='edit-post-history__restore__modal__content'>\r\n                {postHeader}\r\n                <PostMessageView\r\n                    post={post}\r\n                    overflowType='ellipsis'\r\n                    maxHeight={100}\r\n                    showPostEditedIndicator={false}\r\n                />\r\n                <FileAttachmentListContainer\r\n                    post={post}\r\n                    isEditHistory={true}\r\n                    disableDownload={true}\r\n                    disableActions={true}\r\n                />\r\n            </div>\r\n        </GenericModal>\r\n    );\r\n};\r\n\r\nexport default memo(RestorePostModal);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React, {memo, useCallback, useState} from 'react';\r\nimport {defineMessages, useIntl} from 'react-intl';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\n\r\nimport {CheckIcon} from '@mattermost/compass-icons/components';\r\nimport type {Post} from '@mattermost/types/posts';\r\n\r\nimport {getPostEditHistory, restorePostVersion} from 'mattermost-redux/actions/posts';\r\nimport {ensureString} from 'mattermost-redux/utils/post_utils';\r\n\r\nimport {removeDraft} from 'actions/views/drafts';\r\nimport {getConnectionId} from 'selectors/general';\r\n\r\nimport FileAttachmentListContainer from 'components/file_attachment_list';\r\nimport InfoToast from 'components/info_toast/info_toast';\r\nimport PostAriaLabelDiv from 'components/post_view/post_aria_label_div';\r\nimport PostMessageContainer from 'components/post_view/post_message_view';\r\nimport Timestamp, {RelativeRanges} from 'components/timestamp';\r\nimport UserProfileComponent from 'components/user_profile';\r\nimport Avatar from 'components/widgets/users/avatar';\r\nimport WithTooltip from 'components/with_tooltip';\r\n\r\nimport {ModalIdentifiers, StoragePrefixes} from 'utils/constants';\r\nimport {imageURLForUser} from 'utils/utils';\r\n\r\nimport RestorePostModal from '../restore_post_modal';\r\n\r\nimport './edited_post_items.scss';\r\n\r\nimport type {PropsFromRedux} from './index';\r\n\r\nconst DATE_RANGES = [\r\n    RelativeRanges.TODAY_TITLE_CASE,\r\n    RelativeRanges.YESTERDAY_TITLE_CASE,\r\n];\r\n\r\nconst itemMessages = defineMessages({\r\n    helpText: {\r\n        id: 'post_info.edit.restore',\r\n        defaultMessage: 'Restore this version',\r\n    },\r\n    currentVersionText: {\r\n        id: 'post_info.edit.current_version',\r\n        defaultMessage: 'Current Version',\r\n    },\r\n    ariaLabelMessage: {\r\n        id: 'post_info.edit.aria_label',\r\n        defaultMessage: 'Select to restore an old message.',\r\n    },\r\n});\r\n\r\nexport type Props = PropsFromRedux & {\r\n    post: Post;\r\n    isCurrent?: boolean;\r\n}\r\n\r\nconst EditedPostItem = ({post, isCurrent = false, postCurrentVersion, actions}: Props) => {\r\n    const {formatMessage} = useIntl();\r\n    const [open, setOpen] = useState(isCurrent);\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    const connectionId = useSelector(getConnectionId);\r\n\r\n    const openRestorePostModal = useCallback((e: React.MouseEvent) => {\r\n        // this prevents history item from\r\n        // collapsing and closing when clicking on restore button\r\n        e.stopPropagation();\r\n\r\n        const restorePostModalData = {\r\n            modalId: ModalIdentifiers.RESTORE_POST_MODAL,\r\n            dialogType: RestorePostModal,\r\n            dialogProps: {\r\n                post,\r\n                postHeader,\r\n                actions: {\r\n                    handleRestore,\r\n                },\r\n            },\r\n        };\r\n\r\n        actions.openModal(restorePostModalData);\r\n    }, [actions, post]);\r\n\r\n    const togglePost = () => {\r\n        setOpen((prevState) => !prevState);\r\n    };\r\n\r\n    if (!post) {\r\n        return null;\r\n    }\r\n\r\n    const showInfoTooltip = () => {\r\n        const infoToastModalData = {\r\n            modalId: ModalIdentifiers.INFO_TOAST,\r\n            dialogType: InfoToast,\r\n            dialogProps: {\r\n                content: {\r\n                    icon: <CheckIcon size={18}/>,\r\n                    message: 'Restored Message',\r\n                    undo: handleUndo,\r\n                },\r\n            },\r\n        };\r\n\r\n        actions.openModal(infoToastModalData);\r\n    };\r\n\r\n    const handleRestore = async () => {\r\n        if (!postCurrentVersion || !post) {\r\n            actions.closeRightHandSide();\r\n            return;\r\n        }\r\n\r\n        const result = await dispatch(restorePostVersion(post.original_id, post.id, connectionId));\r\n        if (result.data) {\r\n            actions.closeRightHandSide();\r\n            showInfoTooltip();\r\n        }\r\n\r\n        const key = StoragePrefixes.EDIT_DRAFT + post.original_id;\r\n        dispatch(removeDraft(key, post.channel_id, post.root_id));\r\n    };\r\n\r\n    const handleUndo = async () => {\r\n        if (!postCurrentVersion) {\r\n            actions.closeRightHandSide();\r\n            return;\r\n        }\r\n\r\n        // To undo a recent restore, you need to restore the previous version of the post right before this restore.\r\n        // That would be the first history item in post's edit history as it is the most recent edit\r\n        // and edit history is sorted from most recent first to oldest.\r\n        const result = await dispatch(getPostEditHistory(post.original_id));\r\n        if (!result.data || result.data.length === 0) {\r\n            return;\r\n        }\r\n\r\n        const previousPostVersion = result.data[0];\r\n        await dispatch(restorePostVersion(previousPostVersion.original_id, previousPostVersion.id, connectionId));\r\n    };\r\n\r\n    const currentVersionIndicator = isCurrent ? (\r\n        <div className='edit-post-history__current__indicator'>\r\n            {formatMessage(itemMessages.currentVersionText)}\r\n        </div>\r\n    ) : null;\r\n\r\n    const profileSrc = imageURLForUser(post.user_id);\r\n\r\n    const overwriteName = ensureString(post.props?.override_username);\r\n    const postHeader = (\r\n        <div className='edit-post-history__header'>\r\n            <span className='profile-icon'>\r\n                <Avatar\r\n                    size={'sm'}\r\n                    url={profileSrc}\r\n                    className={'avatar-post-preview'}\r\n                />\r\n            </span>\r\n            <div className={'edit-post-history__header__username'}>\r\n                <UserProfileComponent\r\n                    userId={post.user_id}\r\n                    disablePopover={true}\r\n                    overwriteName={overwriteName}\r\n                />\r\n            </div>\r\n        </div>\r\n    );\r\n\r\n    const message = (\r\n        <PostMessageContainer\r\n            post={post}\r\n            isRHS={true}\r\n            showPostEditedIndicator={false}\r\n        />\r\n    );\r\n\r\n    const isFileDeleted = post.delete_at > 0;\r\n\r\n    const messageContainer = (\r\n        <div className='edit-post-history__content_container'>\r\n            {postHeader}\r\n            <div className='post__content'>\r\n                <div className='search-item-snippet post__body'>\r\n                    {message}\r\n                </div>\r\n            </div>\r\n            <FileAttachmentListContainer\r\n                post={post}\r\n                isEditHistory={isFileDeleted}\r\n                disableDownload={isFileDeleted}\r\n                disableActions={isFileDeleted}\r\n            />\r\n        </div>\r\n    );\r\n\r\n    const restoreButton = isCurrent ? null : (\r\n        <WithTooltip\r\n            title={formatMessage(itemMessages.helpText)}\r\n        >\r\n            <button\r\n                className='edit-post-history__icon__button restore-icon'\r\n                onClick={openRestorePostModal}\r\n                aria-label={formatMessage(itemMessages.ariaLabelMessage)}\r\n            >\r\n                <i className={'icon icon-restore'}/>\r\n            </button>\r\n        </WithTooltip>\r\n    );\r\n\r\n    const postContainerClass = classNames('edit-post-history__container', {'edit-post-history__container__background': open});\r\n    const timeStampValue = post.edit_at === 0 ? post.create_at : post.edit_at;\r\n\r\n    return (\r\n        <div\r\n            className={postContainerClass}\r\n            onClick={togglePost}\r\n        >\r\n            <PostAriaLabelDiv\r\n                className={'a11y__section post'}\r\n                id={'searchResult_' + post.id}\r\n                post={post}\r\n            >\r\n                <div\r\n                    className='edit-post-history__title__container'\r\n                >\r\n                    <div className='edit-post-history__date__badge__container'>\r\n                        <button\r\n                            aria-label='Toggle to see an old message.'\r\n                            className='edit-post-history__icon__button toggleCollapseButton'\r\n                        >\r\n                            <i className={`icon ${open ? 'icon-chevron-down' : 'icon-chevron-right'}`}/>\r\n                        </button>\r\n                        <span className='edit-post-history__date'>\r\n                            <Timestamp\r\n                                value={timeStampValue}\r\n                                ranges={DATE_RANGES}\r\n                            />\r\n                        </span>\r\n                        {currentVersionIndicator}\r\n                    </div>\r\n                    {restoreButton}\r\n                </div>\r\n                {open && messageContainer}\r\n            </PostAriaLabelDiv>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default memo(EditedPostItem);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport type {ConnectedProps} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {getPost} from 'mattermost-redux/selectors/entities/posts';\r\n\r\nimport {openModal} from 'actions/views/modals';\r\nimport {editPost} from 'actions/views/posts';\r\nimport {closeRightHandSide} from 'actions/views/rhs';\r\nimport {getSelectedPostId} from 'selectors/rhs';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport EditedPostItem from './edited_post_item';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const selectedPostId = getSelectedPostId(state) || '';\r\n\r\n    return {\r\n        postCurrentVersion: getPost(state, selectedPostId),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            editPost,\r\n            closeRightHandSide,\r\n            openModal,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nconst connector = connect(mapStateToProps, mapDispatchToProps);\r\n\r\nexport type PropsFromRedux = ConnectedProps<typeof connector>;\r\n\r\nexport default connector(EditedPostItem);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {memo, useEffect, useRef, useState} from 'react';\r\nimport {useIntl} from 'react-intl';\r\nimport {useDispatch} from 'react-redux';\r\n\r\nimport type {Post} from '@mattermost/types/posts';\r\n\r\nimport {getPostEditHistory} from 'mattermost-redux/actions/posts';\r\n\r\nimport Scrollbars from 'components/common/scrollbars';\r\nimport AlertIcon from 'components/common/svg_images_components/alert_svg';\r\nimport LoadingScreen from 'components/loading_screen';\r\nimport SearchResultsHeader from 'components/search_results_header';\r\n\r\nimport EditedPostItem from './edited_post_item';\r\n\r\nimport type {PropsFromRedux} from './index';\r\nimport './post_edit_history.scss';\r\n\r\nconst PostEditHistory = ({\r\n    channelDisplayName,\r\n    originalPost,\r\n}: PropsFromRedux) => {\r\n    const [postEditHistory, setPostEditHistory] = useState<Post[]>([]);\r\n    const [hasError, setHasError] = useState<boolean>(false);\r\n    const [isLoading, setIsLoading] = useState<boolean>(false);\r\n    const dispatch = useDispatch();\r\n    const scrollbars = useRef<HTMLDivElement>(null);\r\n    const {formatMessage} = useIntl();\r\n    const retrieveErrorHeading = formatMessage({\r\n        id: 'post_info.edit.history.retrieveError',\r\n        defaultMessage: 'Unable to load edit history',\r\n    });\r\n    const retrieveErrorSubheading = formatMessage({\r\n        id: 'post_info.edit.history.retrieveErrorVerbose',\r\n        defaultMessage: 'There was an error loading the history for this message. Check your network connection or try again later.',\r\n    });\r\n\r\n    useEffect(() => {\r\n        const fetchPostEditHistory = async () => {\r\n            setIsLoading(true);\r\n            const result = await dispatch(getPostEditHistory(originalPost.id));\r\n            if (result.data) {\r\n                setPostEditHistory(result.data);\r\n                setHasError(false);\r\n            } else {\r\n                setHasError(true);\r\n                setPostEditHistory([]);\r\n            }\r\n            setIsLoading(false);\r\n        };\r\n        fetchPostEditHistory();\r\n        scrollbars.current?.scrollTo({top: 0});\r\n    }, [originalPost, dispatch]);\r\n\r\n    useEffect(() => {\r\n        setPostEditHistory([]);\r\n        setHasError(false);\r\n    }, [originalPost.id]);\r\n\r\n    const title = formatMessage({\r\n        id: 'search_header.title_edit.history',\r\n        defaultMessage: 'Edit History',\r\n    });\r\n\r\n    const errorContainer: JSX.Element = (\r\n        <div className='edit-post-history__error_container'>\r\n            <div className='edit-post-history__error_item'>\r\n                <AlertIcon\r\n                    width={127}\r\n                    height={127}\r\n                />\r\n                <p className='edit-post-history__error_heading'>\r\n                    {retrieveErrorHeading}\r\n                </p>\r\n                <p className='edit-post-history__error_subheading'>\r\n                    {retrieveErrorSubheading}\r\n                </p>\r\n            </div>\r\n        </div>\r\n    );\r\n\r\n    if (isLoading && postEditHistory.length === 0) {\r\n        return (\r\n            <div\r\n                id='rhsContainer'\r\n                className='sidebar-right__body sidebar-right__edit-post-history'\r\n            >\r\n                <LoadingScreen\r\n                    style={{\r\n                        display: 'grid',\r\n                        placeContent: 'center',\r\n                        flex: '1',\r\n                    }}\r\n                />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const currentItem = (\r\n        <EditedPostItem\r\n            post={originalPost}\r\n            key={originalPost.id}\r\n            isCurrent={true}\r\n        />\r\n    );\r\n\r\n    const postEditItems = [currentItem, ...postEditHistory.map((postEdited) => (\r\n        <EditedPostItem\r\n            key={postEdited.id}\r\n            post={postEdited}\r\n        />\r\n    ))];\r\n\r\n    return (\r\n        <div\r\n            id='rhsContainer'\r\n            className='sidebar-right__body sidebar-right__edit-post-history'\r\n        >\r\n            <Scrollbars ref={scrollbars}>\r\n                <SearchResultsHeader>\r\n                    <h2 id='rhsPanelTitle'>\r\n                        {title}\r\n                    </h2>\r\n                    <div className='sidebar--right__title__channel'>{channelDisplayName}</div>\r\n                </SearchResultsHeader>\r\n                {hasError ? errorContainer : postEditItems}\r\n            </Scrollbars>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default memo(PostEditHistory);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport type {ConnectedProps} from 'react-redux';\r\n\r\nimport {getChannel, getCurrentChannel} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getPost} from 'mattermost-redux/selectors/entities/posts';\r\n\r\nimport {getSelectedPostId} from 'selectors/rhs';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport PostEditHistory from './post_edit_history';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const selectedPostId = getSelectedPostId(state) || '';\r\n    const originalPost = getPost(state, selectedPostId);\r\n    const channel = getCurrentChannel(state) ?? getChannel(state, originalPost.channel_id);\r\n    const channelDisplayName = channel?.display_name || '';\r\n\r\n    return {\r\n        channelDisplayName,\r\n        originalPost,\r\n    };\r\n}\r\n\r\nconst connector = connect(mapStateToProps);\r\n\r\nexport type PropsFromRedux = ConnectedProps<typeof connector>;\r\n\r\nexport default connector(PostEditHistory);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {HTMLAttributes} from 'react';\r\nimport React, {useEffect, useRef, useState} from 'react';\r\nimport {useSelector} from 'react-redux';\r\n\r\nimport {getIsRhsExpanded, getRhsSize} from 'selectors/rhs';\r\n\r\nimport {CssVarKeyForResizable, RHS_MIN_MAX_WIDTH, ResizeDirection} from '../constants';\r\nimport ResizableDivider from '../resizable_divider';\r\nimport {shouldRhsOverlapChannelView} from '../utils';\r\n\r\ninterface Props extends HTMLAttributes<'div'> {\r\n    children: React.ReactNode;\r\n    rightWidthHolderRef: React.RefObject<HTMLDivElement>;\r\n    ariaLabel?: string;\r\n    ariaLabeledby?: string;\r\n}\r\n\r\nfunction ResizableRhs({\r\n    role,\r\n    children,\r\n    id,\r\n    className,\r\n    rightWidthHolderRef,\r\n    ariaLabel,\r\n    ariaLabeledby,\r\n}: Props) {\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n\r\n    const rhsSize = useSelector(getRhsSize);\r\n    const isRhsExpanded = useSelector(getIsRhsExpanded);\r\n\r\n    const [previousRhsExpanded, setPreviousRhsExpanded] = useState(false);\r\n\r\n    const defaultWidth = RHS_MIN_MAX_WIDTH[rhsSize].default;\r\n\r\n    const shouldRhsOverlap = shouldRhsOverlapChannelView(rhsSize);\r\n\r\n    const handleResize = (_: number, cssVarProp: string, cssVarValue: string) => {\r\n        const rightWidthHolderRefElement = rightWidthHolderRef.current;\r\n\r\n        if (!rightWidthHolderRefElement) {\r\n            return;\r\n        }\r\n\r\n        if (!shouldRhsOverlap) {\r\n            rightWidthHolderRefElement.style.setProperty(cssVarProp, cssVarValue);\r\n        }\r\n    };\r\n\r\n    const handleResizeEnd = (_: number, cssVarProp: string) => {\r\n        const rightWidthHolderRefElement = rightWidthHolderRef.current;\r\n\r\n        if (!rightWidthHolderRefElement) {\r\n            return;\r\n        }\r\n\r\n        rightWidthHolderRefElement.style.removeProperty(cssVarProp);\r\n    };\r\n\r\n    const handleDividerDoubleClick = (_: number, cssVarProp: string) => {\r\n        handleResizeEnd(_, cssVarProp);\r\n\r\n        document.body.classList.add('layout-changing');\r\n\r\n        setTimeout(() => {\r\n            document.body.classList.remove('layout-changing');\r\n        }, 1000);\r\n    };\r\n\r\n    // If max-width is applied immediately when expanded is collapsed, the transition will not work correctly.\r\n    useEffect(() => {\r\n        const containerRefElement = containerRef.current;\r\n\r\n        if (!containerRefElement) {\r\n            return;\r\n        }\r\n\r\n        setPreviousRhsExpanded(isRhsExpanded);\r\n\r\n        if (previousRhsExpanded && !isRhsExpanded) {\r\n            containerRefElement.classList.add('resize-disabled');\r\n\r\n            setTimeout(() => {\r\n                containerRefElement.classList.remove('resize-disabled');\r\n            }, 1000);\r\n        }\r\n    }, [isRhsExpanded]);\r\n\r\n    return (\r\n        <div\r\n            id={id}\r\n            className={className}\r\n            role={role}\r\n            ref={containerRef}\r\n            aria-label={ariaLabel}\r\n            aria-labelledby={ariaLabeledby || 'rhsPanelTitle'}\r\n        >\r\n            {children}\r\n            <ResizableDivider\r\n                name='rhsResizeHandle'\r\n                globalCssVar={CssVarKeyForResizable.RHS}\r\n                defaultWidth={defaultWidth}\r\n                dir={ResizeDirection.RIGHT}\r\n                disabled={isRhsExpanded}\r\n                containerRef={containerRef}\r\n                onResize={handleResize}\r\n                onResizeEnd={handleResizeEnd}\r\n                onDividerDoubleClick={handleDividerDoubleClick}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default ResizableRhs;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage, injectIntl, type IntlShape} from 'react-intl';\r\n\r\nimport KeyboardShortcutSequence, {\r\n    KEYBOARD_SHORTCUTS,\r\n} from 'components/keyboard_shortcuts/keyboard_shortcuts_sequence';\r\nimport WithTooltip from 'components/with_tooltip';\r\n\r\nimport {RHSStates} from 'utils/constants';\r\n\r\nimport type {RhsState} from 'types/store/rhs';\r\n\r\ntype Props = {\r\n    intl: IntlShape;\r\n    previousRhsState?: RhsState;\r\n    isExpanded: boolean;\r\n    actions: {\r\n        showMentions: () => void;\r\n        showSearchResults: () => void;\r\n        showFlaggedPosts: () => void;\r\n        showPinnedPosts: () => void;\r\n        closeRightHandSide: () => void;\r\n        toggleRhsExpanded: () => void;\r\n    };\r\n};\r\n\r\nclass RhsCardHeader extends React.PureComponent<Props> {\r\n    handleBack = (e: React.MouseEvent<HTMLButtonElement>): void => {\r\n        e.preventDefault();\r\n\r\n        switch (this.props.previousRhsState) {\r\n        case RHSStates.CHANNEL_FILES:\r\n            this.props.actions.showSearchResults();\r\n            break;\r\n        case RHSStates.SEARCH:\r\n            this.props.actions.showSearchResults();\r\n            break;\r\n        case RHSStates.MENTION:\r\n            this.props.actions.showMentions();\r\n            break;\r\n        case RHSStates.FLAG:\r\n            this.props.actions.showFlaggedPosts();\r\n            break;\r\n        case RHSStates.PIN:\r\n            this.props.actions.showPinnedPosts();\r\n            break;\r\n        default:\r\n            break;\r\n        }\r\n    };\r\n\r\n    render(): React.ReactNode {\r\n        let back;\r\n        let title;\r\n\r\n        switch (this.props.previousRhsState) {\r\n        case RHSStates.SEARCH:\r\n        case RHSStates.MENTION:\r\n            title = (\r\n                <FormattedMessage\r\n                    id='rhs_header.backToResultsTooltip'\r\n                    defaultMessage='Back to search results'\r\n                />\r\n            );\r\n            break;\r\n        case RHSStates.FLAG:\r\n            title = (\r\n                <FormattedMessage\r\n                    id='rhs_header.backToFlaggedTooltip'\r\n                    defaultMessage='Back to saved messages'\r\n                />\r\n            );\r\n            break;\r\n        case RHSStates.PIN:\r\n            title = (\r\n                <FormattedMessage\r\n                    id='rhs_header.backToPinnedTooltip'\r\n                    defaultMessage='Back to pinned messages'\r\n                />\r\n            );\r\n            break;\r\n        }\r\n\r\n        const expandSidebarTooltip = (\r\n            <>\r\n                <FormattedMessage\r\n                    id='rhs_header.expandSidebarTooltip'\r\n                    defaultMessage='Expand the right sidebar'\r\n                />\r\n                <KeyboardShortcutSequence\r\n                    shortcut={KEYBOARD_SHORTCUTS.navExpandSidebar}\r\n                    hideDescription={true}\r\n                    isInsideTooltip={true}\r\n                />\r\n            </>\r\n        );\r\n\r\n        const shrinkSidebarTooltip = (\r\n            <>\r\n                <FormattedMessage\r\n                    id='rhs_header.collapseSidebarTooltip'\r\n                    defaultMessage='Collapse the right sidebar'\r\n                />\r\n                <KeyboardShortcutSequence\r\n                    shortcut={KEYBOARD_SHORTCUTS.navExpandSidebar}\r\n                    hideDescription={true}\r\n                    isInsideTooltip={true}\r\n                />\r\n            </>\r\n        );\r\n\r\n        if (title) {\r\n            back = (\r\n                <WithTooltip\r\n                    title={title}\r\n                >\r\n                    <button\r\n                        className='sidebar--right__back btn btn-icon btn-sm'\r\n                        onClick={this.handleBack}\r\n                        aria-label={this.props.intl.formatMessage({id: 'rhs_header.back.icon', defaultMessage: 'Back Icon'})}\r\n                    >\r\n                        <i\r\n                            className='icon icon-arrow-back-ios'\r\n                        />\r\n                    </button>\r\n                </WithTooltip>\r\n            );\r\n        }\r\n\r\n        const collapseIconLabel = this.props.intl.formatMessage({id: 'rhs_header.collapseSidebarTooltip.icon', defaultMessage: 'Collapse Sidebar Icon'});\r\n        const expandIconLabel = this.props.intl.formatMessage({id: 'rhs_header.expandSidebarTooltip.icon', defaultMessage: 'Expand Sidebar Icon'});\r\n\r\n        return (\r\n            <div className='sidebar--right__header'>\r\n                <span\r\n                    className='sidebar--right__title'\r\n                    id='rhsPanelTitle'\r\n                >\r\n                    {back}\r\n                    <FormattedMessage\r\n                        id='search_header.title5'\r\n                        defaultMessage='Extra information'\r\n                    />\r\n                </span>\r\n                <div className='pull-right'>\r\n                    <WithTooltip\r\n                        title={this.props.isExpanded ? shrinkSidebarTooltip : expandSidebarTooltip}\r\n                    >\r\n                        <button\r\n                            type='button'\r\n                            className='sidebar--right__expand btn btn-icon btn-sm'\r\n                            aria-label={this.props.isExpanded ? collapseIconLabel : expandIconLabel}\r\n                            onClick={this.props.actions.toggleRhsExpanded}\r\n                        >\r\n                            <i\r\n                                className='icon icon-arrow-expand'\r\n                            />\r\n                            <i\r\n                                className='icon icon-arrow-collapse'\r\n                            />\r\n                        </button>\r\n                    </WithTooltip>\r\n                    <WithTooltip\r\n                        title={\r\n                            <FormattedMessage\r\n                                id='rhs_header.closeSidebarTooltip'\r\n                                defaultMessage='Close'\r\n                            />\r\n                        }\r\n                    >\r\n                        <button\r\n                            type='button'\r\n                            className='sidebar--right__close btn btn-icon btn-sm'\r\n                            aria-label='Close'\r\n                            onClick={this.props.actions.closeRightHandSide}\r\n                        >\r\n                            <i\r\n                                className='icon icon-close'\r\n                                aria-label={this.props.intl.formatMessage({id: 'rhs_header.closeTooltip.icon', defaultMessage: 'Close Sidebar Icon'})}\r\n                            />\r\n                        </button>\r\n                    </WithTooltip>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default injectIntl(RhsCardHeader);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {AnyAction, Dispatch} from 'redux';\r\n\r\nimport {\r\n    showMentions,\r\n    showSearchResults,\r\n    showFlaggedPosts,\r\n    showPinnedPosts,\r\n    closeRightHandSide,\r\n    toggleRhsExpanded,\r\n} from 'actions/views/rhs';\r\nimport {getIsRhsExpanded} from 'selectors/rhs';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport RhsCardHeader from './rhs_card_header';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    return {\r\n        isExpanded: getIsRhsExpanded(state),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<AnyAction>) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            showMentions,\r\n            showSearchResults,\r\n            showFlaggedPosts,\r\n            showPinnedPosts,\r\n            closeRightHandSide,\r\n            toggleRhsExpanded,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(RhsCardHeader);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport deepEqual from 'fast-deep-equal';\r\nimport React from 'react';\r\nimport type {ReactNode} from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport type {Post} from '@mattermost/types/posts';\r\n\r\nimport {ensureString} from 'mattermost-redux/utils/post_utils';\r\n\r\nimport {emitCloseRightHandSide} from 'actions/global_actions';\r\n\r\nimport Scrollbars from 'components/common/scrollbars';\r\nimport Markdown from 'components/markdown';\r\nimport PostProfilePicture from 'components/post_profile_picture';\r\nimport RhsCardHeader from 'components/rhs_card_header';\r\nimport UserProfile from 'components/user_profile';\r\n\r\nimport Constants from 'utils/constants';\r\nimport DelayedAction from 'utils/delayed_action';\r\n\r\nimport type {PostPluginComponent} from 'types/store/plugins';\r\nimport type {RhsState} from 'types/store/rhs';\r\n\r\ntype Props = {\r\n    isMobileView: boolean;\r\n    selected?: Post;\r\n    pluginPostCardTypes?: Record<string, PostPluginComponent>;\r\n    previousRhsState?: RhsState;\r\n    enablePostUsernameOverride?: boolean;\r\n    teamUrl?: string;\r\n};\r\n\r\ntype State = {\r\n    isScrolling: boolean;\r\n};\r\n\r\nexport default class RhsCard extends React.Component<Props, State> {\r\n    scrollStopAction: DelayedAction;\r\n\r\n    static defaultProps = {\r\n        pluginPostCardTypes: {},\r\n    };\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.scrollStopAction = new DelayedAction(this.handleScrollStop);\r\n\r\n        this.state = {\r\n            isScrolling: false,\r\n        };\r\n    }\r\n\r\n    shouldComponentUpdate(nextProps: Props, nextState: State) {\r\n        if (!deepEqual(nextProps.selected?.props?.card, this.props.selected?.props?.card)) {\r\n            return true;\r\n        }\r\n        if (nextState.isScrolling !== this.state.isScrolling) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    handleScroll = () => {\r\n        if (!this.state.isScrolling) {\r\n            this.setState({\r\n                isScrolling: true,\r\n            });\r\n        }\r\n\r\n        this.scrollStopAction.fireAfter(Constants.SCROLL_DELAY);\r\n    };\r\n\r\n    handleScrollStop = () => {\r\n        this.setState({\r\n            isScrolling: false,\r\n        });\r\n    };\r\n\r\n    handleClick = () => {\r\n        if (this.props.isMobileView) {\r\n            emitCloseRightHandSide();\r\n        }\r\n    };\r\n\r\n    render() {\r\n        if (this.props.selected == null) {\r\n            return (<div/>);\r\n        }\r\n\r\n        const {selected, pluginPostCardTypes, teamUrl} = this.props;\r\n        const postType = selected.type;\r\n        let content: ReactNode = null;\r\n        if (pluginPostCardTypes && Object.hasOwn(pluginPostCardTypes, postType)) {\r\n            const PluginComponent = pluginPostCardTypes[postType].component;\r\n            content = <PluginComponent post={selected}/>;\r\n        }\r\n\r\n        if (!content) {\r\n            const message = ensureString(selected.props?.card);\r\n            content = (\r\n                <div className='info-card'>\r\n                    <Markdown message={message}/>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        let user = (\r\n            <UserProfile\r\n                userId={selected.user_id}\r\n                hideStatus={true}\r\n                disablePopover={true}\r\n            />\r\n        );\r\n        const overrideUsername = ensureString(selected.props.override_username);\r\n        if (overrideUsername && this.props.enablePostUsernameOverride) {\r\n            user = (\r\n                <UserProfile\r\n                    userId={selected.user_id}\r\n                    hideStatus={true}\r\n                    disablePopover={true}\r\n                    overwriteName={overrideUsername}\r\n                />\r\n            );\r\n        }\r\n        const avatar = (\r\n            <PostProfilePicture\r\n                compactDisplay={false}\r\n                post={selected}\r\n                userId={selected.user_id}\r\n            />\r\n        );\r\n\r\n        return (\r\n            <div className='sidebar-right__body sidebar-right__card'>\r\n                <RhsCardHeader previousRhsState={this.props.previousRhsState}/>\r\n                <Scrollbars onScroll={this.handleScroll}>\r\n                    <div className='post-right__scroll'>\r\n                        {content}\r\n                        <div className='d-flex post-card--info'>\r\n                            <div className='post-card--post-by overflow--ellipsis'>\r\n                                <FormattedMessage\r\n                                    id='rhs_card.message_by'\r\n                                    defaultMessage='Message by {avatar} {user}'\r\n                                    values={{user, avatar}}\r\n                                />\r\n                            </div>\r\n                            <div className='post-card--view-post'>\r\n                                <Link\r\n                                    to={`${teamUrl}/pl/${selected.id}`}\r\n                                    className='post__permalink'\r\n                                    onClick={this.handleClick}\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='rhs_card.jump'\r\n                                        defaultMessage='Jump'\r\n                                    />\r\n                                </Link>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </Scrollbars>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\n\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {getCurrentRelativeTeamUrl} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport {getSelectedPostCard} from 'selectors/rhs';\r\nimport {getIsMobileView} from 'selectors/views/browser';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport RhsCard from './rhs_card';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const selected = getSelectedPostCard(state);\r\n    const config = getConfig(state);\r\n    const enablePostUsernameOverride = config.EnablePostUsernameOverride === 'true';\r\n\r\n    return {\r\n        enablePostUsernameOverride,\r\n        isMobileView: getIsMobileView(state),\r\n        selected,\r\n        pluginPostCardTypes: state.plugins.postCardTypes,\r\n        teamUrl: getCurrentRelativeTeamUrl(state),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps)(RhsCard);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage, injectIntl, type WrappedComponentProps} from 'react-intl';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport KeyboardShortcutSequence, {\r\n    KEYBOARD_SHORTCUTS,\r\n} from 'components/keyboard_shortcuts/keyboard_shortcuts_sequence';\r\nimport PopoutButton from 'components/popout_button';\r\nimport FollowButton from 'components/threading/common/follow_button';\r\nimport WithTooltip from 'components/with_tooltip';\r\n\r\nimport {getHistory} from 'utils/browser_history';\r\nimport {RHSStates} from 'utils/constants';\r\nimport {popoutThread} from 'utils/popouts/popout_windows';\r\n\r\nimport type {RhsState} from 'types/store/rhs';\r\n\r\ntype Props = WrappedComponentProps & {\r\n    isExpanded: boolean;\r\n    isMobileView: boolean;\r\n    rootPostId: string;\r\n    previousRhsState?: RhsState;\r\n    relativeTeamUrl: string;\r\n    channel: Channel;\r\n    isCollapsedThreadsEnabled: boolean;\r\n    isFollowingThread?: boolean;\r\n    currentTeam?: Team;\r\n    currentUserId: string;\r\n    setRhsExpanded: (b: boolean) => void;\r\n    showMentions: () => void;\r\n    showSearchResults: () => void;\r\n    showFlaggedPosts: () => void;\r\n    showPinnedPosts: () => void;\r\n    goBack: () => void;\r\n    closeRightHandSide: (e?: React.MouseEvent) => void;\r\n    toggleRhsExpanded: (e: React.MouseEvent) => void;\r\n    setThreadFollow: (userId: string, teamId: string, threadId: string, newState: boolean) => void;\r\n    focusPost: (postId: string, returnTo: string, currentUserId: string, option?: {skipRedirectReplyPermalink: boolean}) => Promise<void>;\r\n};\r\n\r\nclass RhsHeaderPost extends React.PureComponent<Props> {\r\n    handleBack = (e: React.MouseEvent) => {\r\n        e.preventDefault();\r\n\r\n        switch (this.props.previousRhsState) {\r\n        case RHSStates.SEARCH:\r\n        case RHSStates.MENTION:\r\n        case RHSStates.FLAG:\r\n        case RHSStates.PIN:\r\n            this.props.goBack();\r\n            break;\r\n        default:\r\n            break;\r\n        }\r\n    };\r\n\r\n    handleJumpClick = () => {\r\n        if (this.props.isMobileView) {\r\n            this.props.closeRightHandSide();\r\n        }\r\n\r\n        this.props.setRhsExpanded(false);\r\n        const teamUrl = this.props.relativeTeamUrl;\r\n        getHistory().push(`${teamUrl}/pl/${this.props.rootPostId}`);\r\n    };\r\n\r\n    handleFollowChange = () => {\r\n        const {currentTeam, currentUserId, rootPostId, isFollowingThread} = this.props;\r\n        if (!currentTeam) {\r\n            return;\r\n        }\r\n        this.props.setThreadFollow(currentUserId, currentTeam.id, rootPostId, !isFollowingThread);\r\n    };\r\n\r\n    popout = async () => {\r\n        const {currentTeam, intl, rootPostId, focusPost, currentUserId} = this.props;\r\n        if (!currentTeam) {\r\n            return;\r\n        }\r\n        await popoutThread(intl, rootPostId, currentTeam.name, (postId, returnTo) => {\r\n            focusPost(postId, returnTo, currentUserId, {skipRedirectReplyPermalink: true});\r\n        });\r\n    };\r\n\r\n    render() {\r\n        let back;\r\n        const {isFollowingThread} = this.props;\r\n        const {formatMessage} = this.props.intl;\r\n        const closeSidebarTooltip = (\r\n            <FormattedMessage\r\n                id='rhs_header.closeSidebarTooltip'\r\n                defaultMessage='Close'\r\n            />\r\n        );\r\n\r\n        let backToResultsTooltip;\r\n\r\n        switch (this.props.previousRhsState) {\r\n        case RHSStates.SEARCH:\r\n        case RHSStates.MENTION:\r\n            backToResultsTooltip = (\r\n                <FormattedMessage\r\n                    id='rhs_header.backToResultsTooltip'\r\n                    defaultMessage='Back to search results'\r\n                />\r\n            );\r\n            break;\r\n        case RHSStates.FLAG:\r\n            backToResultsTooltip = (\r\n                <FormattedMessage\r\n                    id='rhs_header.backToFlaggedTooltip'\r\n                    defaultMessage='Back to saved messages'\r\n                />\r\n            );\r\n            break;\r\n        case RHSStates.PIN:\r\n            backToResultsTooltip = (\r\n                <FormattedMessage\r\n                    id='rhs_header.backToPinnedTooltip'\r\n                    defaultMessage='Back to pinned messages'\r\n                />\r\n            );\r\n            break;\r\n        }\r\n\r\n        //rhsHeaderTooltipContent contains tooltips content for expand or shrink sidebarTooltip.\r\n        // if props.isExpanded is true, defaultMessage would feed from 'shrinkTooltip', else 'expandTooltip'\r\n        const rhsHeaderTooltipContent = this.props.isExpanded ? (\r\n            <>\r\n                <FormattedMessage\r\n                    id='rhs_header.collapseSidebarTooltip'\r\n                    defaultMessage='Collapse the right sidebar'\r\n                />\r\n                <KeyboardShortcutSequence\r\n                    shortcut={KEYBOARD_SHORTCUTS.navExpandSidebar}\r\n                    hideDescription={true}\r\n                    isInsideTooltip={true}\r\n                />\r\n            </>\r\n        ) : (\r\n            <>\r\n                <FormattedMessage\r\n                    id='rhs_header.expandSidebarTooltip'\r\n                    defaultMessage='Expand the right sidebar'\r\n                />\r\n                <KeyboardShortcutSequence\r\n                    shortcut={KEYBOARD_SHORTCUTS.navExpandSidebar}\r\n                    hideDescription={true}\r\n                    isInsideTooltip={true}\r\n                />\r\n            </>\r\n        );\r\n\r\n        const channelName = this.props.channel.display_name;\r\n\r\n        if (backToResultsTooltip) {\r\n            back = (\r\n                <WithTooltip\r\n                    title={backToResultsTooltip}\r\n                >\r\n                    <button\r\n                        className='sidebar--right__back btn btn-icon btn-sm'\r\n                        onClick={this.handleBack}\r\n                        aria-label={formatMessage({id: 'rhs_header.back.icon', defaultMessage: 'Back Icon'})}\r\n                    >\r\n                        <i\r\n                            className='icon icon-arrow-back-ios'\r\n                        />\r\n                    </button>\r\n                </WithTooltip>\r\n            );\r\n        }\r\n\r\n        const collapseIconLabel = formatMessage({id: 'rhs_header.collapseSidebarTooltip.icon', defaultMessage: 'Collapse Sidebar Icon'});\r\n        const expandIconLabel = formatMessage({id: 'rhs_header.expandSidebarTooltip.icon', defaultMessage: 'Expand Sidebar Icon'});\r\n\r\n        return (\r\n            <div className='sidebar--right__header'>\r\n                <span\r\n                    className='sidebar--right__title'\r\n                    id='rhsPanelTitle'\r\n                >\r\n                    {back}\r\n                    <FormattedMessage\r\n                        id='rhs_header.details'\r\n                        defaultMessage='Thread'\r\n                    />\r\n                    {channelName &&\r\n                        <button\r\n                            onClick={this.handleJumpClick}\r\n                            className='style--none sidebar--right__title__channel'\r\n                        >\r\n                            {channelName}\r\n                        </button>\r\n                    }\r\n                </span>\r\n                <div className='controls'>\r\n                    {this.props.isCollapsedThreadsEnabled ? (\r\n                        <FollowButton\r\n                            className='sidebar--right__follow__thread'\r\n                            isFollowing={isFollowingThread}\r\n                            onClick={this.handleFollowChange}\r\n                        />\r\n                    ) : null}\r\n                    <PopoutButton onClick={this.popout}/>\r\n                    <WithTooltip\r\n                        title={rhsHeaderTooltipContent}\r\n                    >\r\n                        <button\r\n                            type='button'\r\n                            className='sidebar--right__expand btn btn-icon btn-sm'\r\n                            aria-label={this.props.isExpanded ? collapseIconLabel : expandIconLabel}\r\n                            onClick={this.props.toggleRhsExpanded}\r\n                        >\r\n                            <i\r\n                                className='icon icon-arrow-expand'\r\n                            />\r\n                            <i\r\n                                className='icon icon-arrow-collapse'\r\n                            />\r\n                        </button>\r\n                    </WithTooltip>\r\n\r\n                    <WithTooltip\r\n                        title={closeSidebarTooltip}\r\n                    >\r\n                        <button\r\n                            id='rhsCloseButton'\r\n                            type='button'\r\n                            className='sidebar--right__close btn btn-icon btn-sm'\r\n                            aria-label='Close'\r\n                            onClick={this.props.closeRightHandSide}\r\n                        >\r\n                            <i\r\n                                className='icon icon-close'\r\n                                aria-label={formatMessage({id: 'rhs_header.closeTooltip.icon', defaultMessage: 'Close Sidebar Icon'})}\r\n                            />\r\n                        </button>\r\n                    </WithTooltip>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default injectIntl(RhsHeaderPost);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {ComponentProps} from 'react';\r\nimport {connect} from 'react-redux';\r\n\r\nimport {setThreadFollow} from 'mattermost-redux/actions/threads';\r\nimport {getPost} from 'mattermost-redux/selectors/entities/posts';\r\nimport {isCollapsedThreadsEnabled} from 'mattermost-redux/selectors/entities/preferences';\r\nimport {getCurrentTeam, getCurrentRelativeTeamUrl} from 'mattermost-redux/selectors/entities/teams';\r\nimport {makeGetThreadOrSynthetic} from 'mattermost-redux/selectors/entities/threads';\r\nimport {getCurrentUserId, getCurrentUserMentionKeys} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {\r\n    setRhsExpanded,\r\n    showMentions,\r\n    showSearchResults,\r\n    showFlaggedPosts,\r\n    showPinnedPosts,\r\n    showChannelFiles,\r\n    closeRightHandSide,\r\n    toggleRhsExpanded,\r\n    goBack,\r\n} from 'actions/views/rhs';\r\nimport {getIsRhsExpanded} from 'selectors/rhs';\r\nimport {getIsMobileView} from 'selectors/views/browser';\r\n\r\nimport {focusPost} from 'components/permalink_view/actions';\r\n\r\nimport {matchUserMentionTriggersWithMessageMentions} from 'utils/post_utils';\r\nimport {allAtMentions} from 'utils/text_formatting';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport RhsHeaderPost from './rhs_header_post';\r\n\r\ntype OwnProps = Pick<ComponentProps<typeof RhsHeaderPost>, 'rootPostId'>\r\n\r\nfunction makeMapStateToProps() {\r\n    const getThreadOrSynthetic = makeGetThreadOrSynthetic();\r\n\r\n    return function mapStateToProps(state: GlobalState, {rootPostId}: OwnProps) {\r\n        let isFollowingThread = false;\r\n\r\n        const collapsedThreads = isCollapsedThreadsEnabled(state);\r\n        const root = getPost(state, rootPostId);\r\n        const currentUserId = getCurrentUserId(state);\r\n\r\n        if (root && collapsedThreads) {\r\n            const thread = getThreadOrSynthetic(state, root);\r\n            isFollowingThread = thread.is_following;\r\n\r\n            if (isFollowingThread === null && thread.reply_count === 0) {\r\n                const currentUserMentionKeys = getCurrentUserMentionKeys(state);\r\n                const rootMessageMentionKeys = allAtMentions(root.message);\r\n\r\n                isFollowingThread = matchUserMentionTriggersWithMessageMentions(currentUserMentionKeys, rootMessageMentionKeys);\r\n            }\r\n        }\r\n\r\n        return {\r\n            isExpanded: getIsRhsExpanded(state),\r\n            isMobileView: getIsMobileView(state),\r\n            relativeTeamUrl: getCurrentRelativeTeamUrl(state),\r\n            currentTeam: getCurrentTeam(state),\r\n            currentUserId,\r\n            isCollapsedThreadsEnabled: collapsedThreads,\r\n            isFollowingThread,\r\n        };\r\n    };\r\n}\r\n\r\nconst actions = {\r\n    setRhsExpanded,\r\n    showSearchResults,\r\n    showMentions,\r\n    showFlaggedPosts,\r\n    showPinnedPosts,\r\n    showChannelFiles,\r\n    closeRightHandSide,\r\n    toggleRhsExpanded,\r\n    setThreadFollow,\r\n    goBack,\r\n    focusPost,\r\n};\r\n\r\nexport default connect(makeMapStateToProps, actions)(RhsHeaderPost);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {memo, useEffect} from 'react';\r\nimport {useDispatch} from 'react-redux';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {Post} from '@mattermost/types/posts';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport {closeRightHandSide} from 'actions/views/rhs';\r\n\r\nimport RhsHeaderPost from 'components/rhs_header_post';\r\nimport ThreadViewer from 'components/threading/thread_viewer';\r\n\r\nimport type {FakePost, RhsState} from 'types/store/rhs';\r\n\r\ntype Props = {\r\n    currentTeam?: Team;\r\n    channel?: Channel;\r\n    selected: Post | FakePost;\r\n    previousRhsState?: RhsState;\r\n}\r\n\r\nconst RhsThread = ({\r\n    currentTeam,\r\n    channel,\r\n    selected,\r\n    previousRhsState,\r\n}: Props) => {\r\n    const dispatch = useDispatch();\r\n\r\n    useEffect(() => {\r\n        if (channel?.team_id && channel.team_id !== currentTeam?.id) {\r\n            // if team-scoped and mismatched team, close rhs\r\n            dispatch(closeRightHandSide());\r\n        }\r\n    }, [currentTeam, channel, dispatch]);\r\n\r\n    if (selected == null || !channel) {\r\n        return (\r\n            <div/>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div\r\n            id='rhsContainer'\r\n            className='sidebar-right__body'\r\n        >\r\n            <RhsHeaderPost\r\n                rootPostId={selected.id}\r\n                channel={channel}\r\n                previousRhsState={previousRhsState}\r\n            />\r\n            <ThreadViewer\r\n                rootPostId={selected.id}\r\n                useRelativeTimestamp={true}\r\n                isThreadView={false}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default memo(RhsThread);\r\n\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\n\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport {getSelectedChannel, getSelectedPost} from 'selectors/rhs';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport RhsThread from './rhs_thread';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const selected = getSelectedPost(state);\r\n    const channel = getSelectedChannel(state);\r\n    const currentTeam = getCurrentTeam(state);\r\n\r\n    return {\r\n        selected,\r\n        channel,\r\n        currentTeam,\r\n    };\r\n}\r\nexport default connect(mapStateToProps)(RhsThread);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {Popover as BSPopover} from 'react-bootstrap';\r\nimport type {Sizes as BSSizes} from 'react-bootstrap';\r\n\r\nconst SizeMap = {xs: 'xsmall', sm: 'small', md: 'medium', lg: 'large'};\r\nexport type Sizes = 'xs' | 'sm' | 'md' | 'lg';\r\n\r\ninterface Props {\r\n    id?: string;\r\n    children?: React.ReactNode;\r\n    popoverStyle?: 'info';\r\n    popoverSize?: Sizes;\r\n    title?: React.ReactNode;\r\n    placement?: 'bottom' | 'top' | 'right' | 'left';\r\n    className?: string;\r\n    style?: React.CSSProperties;\r\n    onMouseOut?: React.MouseEventHandler<BSPopover>; // didn't find a better way to satisfy typing, so for now we have a slight 'bootstrap leakage'\r\n    onMouseOver?: React.MouseEventHandler<BSPopover>;\r\n}\r\n\r\nconst Popover = React.forwardRef<BSPopover, Props>(({\r\n    placement = 'right',\r\n    popoverSize = 'sm',\r\n    children,\r\n    popoverStyle = 'info',\r\n    title,\r\n    id,\r\n    onMouseOut,\r\n    onMouseOver,\r\n    className,\r\n    style,\r\n}, ref?) => {\r\n    return (\r\n        <BSPopover\r\n            id={id}\r\n            style={style}\r\n            className={className}\r\n            bsStyle={popoverStyle}\r\n            placement={placement}\r\n            bsClass='popover'\r\n            title={title}\r\n            bsSize={popoverSize && SizeMap[popoverSize] as BSSizes} // map our sizes to bootstrap\r\n            onMouseOut={onMouseOut}\r\n            onMouseOver={onMouseOver}\r\n            ref={ref}\r\n        >\r\n            {children}\r\n        </BSPopover>\r\n    );\r\n});\r\n\r\nPopover.displayName = 'Popover';\r\n\r\nexport default React.memo(Popover);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport type {Popover as BSPopover} from 'react-bootstrap';\r\n\r\nimport Popover from 'components/widgets/popover';\r\n\r\nimport type {Props} from './suggestion_list';\r\nimport SuggestionList from './suggestion_list';\r\nimport SuggestionListContents from './suggestion_list_contents';\r\nimport {hasResults} from './suggestion_results';\r\n\r\nexport default class SearchSuggestionList extends SuggestionList {\r\n    popoverRef: React.RefObject<BSPopover>;\r\n    itemsContainerRef: React.RefObject<HTMLDivElement>;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.popoverRef = React.createRef();\r\n        this.itemsContainerRef = React.createRef();\r\n    }\r\n\r\n    getContent = () => {\r\n        return this.itemsContainerRef?.current?.parentNode as HTMLUListElement | null;\r\n    };\r\n\r\n    render() {\r\n        if (!hasResults(this.props.results)) {\r\n            return null;\r\n        }\r\n\r\n        return (\r\n            <Popover\r\n                ref={this.popoverRef}\r\n                id='search-autocomplete__popover'\r\n                className='search-help-popover autocomplete visible'\r\n                placement='bottom'\r\n            >\r\n                <SuggestionListContents\r\n                    ref={this.itemsContainerRef}\r\n                    id='searchSuggestionList'\r\n                    results={this.props.results}\r\n                    selectedTerm={this.props.selection}\r\n\r\n                    getItemId={(term) => `sbrSearchBox_item_${term}`}\r\n                    onItemClick={this.props.onCompleteWord}\r\n                    onItemHover={this.props.onItemHover}\r\n                />\r\n            </Popover>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {memo} from 'react';\r\n\r\nimport Popover from 'components/widgets/popover';\r\n\r\nimport type {SuggestionResults, SuggestionResultsUngrouped} from './suggestion_results';\r\nimport {hasResults} from './suggestion_results';\r\n\r\ntype SuggestionItem = {\r\n    date: string;\r\n    label: string;\r\n}\r\n\r\ntype Props = {\r\n    onCompleteWord: (term: string, matchedPretext: string[], e?: React.MouseEvent<HTMLDivElement>) => boolean;\r\n    matchedPretext: string;\r\n    results: SuggestionResults<SuggestionItem>;\r\n    preventClose: () => void;\r\n    handleEscape: () => void;\r\n}\r\n\r\nconst SuggestionDate = ({\r\n    results,\r\n    matchedPretext,\r\n    onCompleteWord,\r\n    preventClose,\r\n    handleEscape,\r\n}: Props) => {\r\n    if (!hasResults(results)) {\r\n        return null;\r\n    }\r\n\r\n    // This is safe to do because SearchDateProvider only returns ungrouped results\r\n    const ungroupedResults = results as SuggestionResultsUngrouped;\r\n\r\n    const item = ungroupedResults.items[0];\r\n    const term = ungroupedResults.terms[0];\r\n\r\n    // ReactComponent names need to be upper case when used in JSX\r\n    const Component = ungroupedResults.components[0];\r\n\r\n    return (\r\n        <Popover\r\n            id='search-autocomplete__popover'\r\n            className='search-help-popover autocomplete visible'\r\n            placement='bottom'\r\n        >\r\n            <Component\r\n                key={term}\r\n                item={item as SuggestionItem}\r\n                term={term}\r\n                matchedPretext={matchedPretext}\r\n                isSelection={false}\r\n                onClick={onCompleteWord}\r\n                preventClose={preventClose}\r\n                handleEscape={handleEscape}\r\n            />\r\n        </Popover>\r\n    );\r\n};\r\n\r\nexport default memo(SuggestionDate);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React, {useEffect, useRef} from 'react';\r\nimport type {ChangeEvent, CSSProperties, FormEvent} from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\n\r\nimport type Provider from 'components/suggestion/provider';\r\nimport SearchSuggestionList from 'components/suggestion/search_suggestion_list';\r\nimport SuggestionBox from 'components/suggestion/suggestion_box';\r\nimport type SuggestionBoxComponent from 'components/suggestion/suggestion_box/suggestion_box';\r\nimport SuggestionDate from 'components/suggestion/suggestion_date';\r\nimport LoadingSpinner from 'components/widgets/loading/loading_spinner';\r\n\r\nimport Constants from 'utils/constants';\r\nimport * as Keyboard from 'utils/keyboard';\r\n\r\nconst {KeyCodes} = Constants;\r\n\r\nconst style: Record<string, CSSProperties> = {\r\n    searchForm: {overflow: 'visible'},\r\n};\r\n\r\ntype Props = {\r\n    searchTerms: string;\r\n    updateHighlightedSearchHint: (indexDelta: number, changedViaKeyPress?: boolean) => void;\r\n    handleChange: (e: ChangeEvent<HTMLInputElement>) => void;\r\n    handleSubmit: (e: FormEvent<HTMLFormElement>) => void;\r\n    handleEnterKey: (e: ChangeEvent<HTMLInputElement>) => void;\r\n    handleClear: () => void;\r\n    handleFocus: () => void;\r\n    handleBlur: () => void;\r\n    keepFocused: boolean;\r\n    setKeepFocused: (value: boolean) => void;\r\n    isFocused: boolean;\r\n    suggestionProviders: Provider[];\r\n    isSearchingTerm: boolean;\r\n    isSideBarRight?: boolean;\r\n    searchType: string;\r\n    clearSearchType?: () => void;\r\n    getFocus?: (searchBarFocus: () => void) => void;\r\n    children?: React.ReactNode;\r\n}\r\n\r\nconst SearchBar: React.FunctionComponent<Props> = (props: Props): JSX.Element => {\r\n    const {\r\n        isFocused,\r\n        keepFocused,\r\n        searchTerms,\r\n        suggestionProviders,\r\n        children = null,\r\n    } = props;\r\n\r\n    const searchRef = useRef<SuggestionBoxComponent>();\r\n    const intl = useIntl();\r\n\r\n    useEffect((): void => {\r\n        const shouldFocus = isFocused || keepFocused;\r\n        if (shouldFocus) {\r\n            // let redux handle changes before focussing the input\r\n            setTimeout(() => searchRef.current?.focus(), 0);\r\n        } else {\r\n            setTimeout(() => searchRef.current?.blur(), 0);\r\n        }\r\n    }, [isFocused, keepFocused]);\r\n\r\n    useEffect((): void => {\r\n        if (isFocused && !keepFocused && searchTerms.endsWith('\"\"')) {\r\n            setTimeout(() => searchRef.current?.focus(), 0);\r\n        }\r\n    }, [searchTerms]);\r\n\r\n    const handleKeyDown = (e: ChangeEvent<HTMLInputElement>): void => {\r\n        if (Keyboard.isKeyPressed(e as any, KeyCodes.ESCAPE)) {\r\n            searchRef.current?.blur();\r\n            e.stopPropagation();\r\n            e.preventDefault();\r\n        }\r\n\r\n        if (Keyboard.isKeyPressed(e as any, KeyCodes.DOWN)) {\r\n            e.preventDefault();\r\n            props.updateHighlightedSearchHint(1, true);\r\n        }\r\n\r\n        if (Keyboard.isKeyPressed(e as any, KeyCodes.UP)) {\r\n            e.preventDefault();\r\n            props.updateHighlightedSearchHint(-1, true);\r\n        }\r\n\r\n        if (Keyboard.isKeyPressed(e as any, KeyCodes.ENTER)) {\r\n            props.handleEnterKey(e);\r\n        }\r\n\r\n        if (Keyboard.isKeyPressed(e as any, KeyCodes.BACKSPACE) && !searchTerms) {\r\n            if (props.clearSearchType) {\r\n                props.clearSearchType();\r\n            }\r\n        }\r\n    };\r\n\r\n    const getSearch = (node: SuggestionBoxComponent): void => {\r\n        searchRef.current = node;\r\n        if (props.getFocus) {\r\n            props.getFocus(props.handleFocus);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div\r\n            id={props.isSideBarRight ? 'sbrSearchFormContainer' : 'searchFormContainer'}\r\n            className='search-form__container'\r\n        >\r\n            <form\r\n                role='search'\r\n                className={classNames(['search__form', {'search__form--focused': isFocused}])}\r\n                onSubmit={props.handleSubmit}\r\n                style={style.searchForm}\r\n                autoComplete='off'\r\n                aria-labelledby='searchBox'\r\n            >\r\n                <div className='search__font-icon'>\r\n                    <i className='icon icon-magnify icon-16'/>\r\n                </div>\r\n\r\n                {props.searchType !== '' && (\r\n                    <div\r\n                        className='searchTypeBadge'\r\n                        onMouseDown={props.handleFocus}\r\n                    >\r\n                        {props.searchType === 'messages' && (\r\n                            <FormattedMessage\r\n                                id='search_bar.search_types.messages'\r\n                                defaultMessage='MESSAGES'\r\n                            />\r\n                        )}\r\n                        {props.searchType === 'files' && (\r\n                            <FormattedMessage\r\n                                id='search_bar.search_types.files'\r\n                                defaultMessage='FILES'\r\n                            />\r\n                        )}\r\n                        <i\r\n                            className='icon icon-close icon-12'\r\n                            onMouseDown={() => {\r\n                                props.setKeepFocused(true);\r\n                            }}\r\n                            onClick={() => props.clearSearchType && props.clearSearchType()}\r\n                        />\r\n                    </div>\r\n                )}\r\n                <SuggestionBox\r\n                    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\r\n                    // @ts-ignore\r\n                    ref={getSearch}\r\n                    id={props.isSideBarRight ? 'sbrSearchBox' : 'searchBox'}\r\n                    tabIndex='0'\r\n                    className={'search-bar form-control a11y__region'}\r\n                    containerClass='w-full'\r\n                    data-a11y-sort-order='9'\r\n                    aria-describedby={props.isSideBarRight ? 'sbr-searchbar-help-popup' : 'searchbar-help-popup'}\r\n                    aria-label={intl.formatMessage({id: 'search_bar.search', defaultMessage: 'Search'})}\r\n                    placeholder={intl.formatMessage({id: 'search_bar.search', defaultMessage: 'Search'})}\r\n                    value={props.searchTerms}\r\n                    onFocus={props.handleFocus}\r\n                    onBlur={props.handleBlur}\r\n                    onChange={props.handleChange}\r\n                    onKeyDown={handleKeyDown}\r\n                    listComponent={SearchSuggestionList}\r\n                    dateComponent={SuggestionDate}\r\n                    providers={suggestionProviders}\r\n                    type='search'\r\n                    delayInputUpdate={true}\r\n                    clearable={true}\r\n                    onClear={props.handleClear}\r\n                />\r\n                {props.isSearchingTerm && <LoadingSpinner/>}\r\n                {children}\r\n            </form>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default SearchBar;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\nimport type {MessageDescriptor} from 'react-intl';\r\nimport {useSelector} from 'react-redux';\r\n\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\n\r\nimport ExternalLink from 'components/external_link';\r\n\r\nimport {isFileAttachmentsEnabled} from 'utils/file_utils';\r\n\r\ninterface SearchTerm {\r\n    searchTerm: string;\r\n    message: MessageDescriptor;\r\n    additionalDisplay?: string;\r\n}\r\n\r\ntype Props = {\r\n    withTitle?: boolean;\r\n    onOptionSelected: (term: string) => void;\r\n    onMouseDown?: () => void | undefined;\r\n    options: SearchTerm[];\r\n    highlightedIndex?: number;\r\n    onOptionHover?: (index: number) => void;\r\n    onSearchTypeSelected?: (searchType: 'files' | 'messages') => void;\r\n    onElementBlur?: () => void;\r\n    onElementFocus?: () => void;\r\n    searchType?: 'files' | 'messages' | '';\r\n}\r\n\r\nconst SearchHint = (props: Props): JSX.Element => {\r\n    const handleOnOptionHover = (optionIndex: number) => {\r\n        if (props.onOptionHover) {\r\n            props.onOptionHover(optionIndex);\r\n        }\r\n    };\r\n    const config = useSelector(getConfig);\r\n    const isFileAttachmentEnabled = isFileAttachmentsEnabled(config);\r\n\r\n    if (props.onSearchTypeSelected) {\r\n        if (!props.searchType) {\r\n            return (\r\n                <div\r\n                    className='search-hint__search-type-selector'\r\n                    onMouseDown={props.onMouseDown}\r\n                >\r\n                    <div className='search-hint_text-container'>\r\n                        <FormattedMessage\r\n                            id='search_bar.usage.search_type_question'\r\n                            defaultMessage='What are you searching for?'\r\n                        />\r\n                        <FormattedMessage\r\n                            id='search_bar.usage.searchLearn'\r\n                            defaultMessage='<a>Learn about search</a>'\r\n                            values={{\r\n                                a: (chunks) => (\r\n                                    <ExternalLink\r\n                                        location='search_hint'\r\n                                        className='search-hint_learn-search'\r\n                                        href='https://mattermost.com/pl/mattermost-academy-search-training'\r\n                                    >\r\n                                        <span>{chunks}</span>\r\n                                        <i className='icon icon-lightbulb-outline'/>\r\n                                    </ExternalLink>\r\n                                ),\r\n                            }}\r\n                        />\r\n\r\n                    </div>\r\n                    <div className='button-container'>\r\n                        <button\r\n                            className={classNames({highlighted: props.highlightedIndex === 0})}\r\n                            onClick={() => props.onSearchTypeSelected && props.onSearchTypeSelected('messages')}\r\n                            onBlur={() => props.onElementBlur && props.onElementBlur()}\r\n                            onFocus={() => props.onElementFocus && props.onElementFocus()}\r\n                        >\r\n                            <i className='icon icon-message-text-outline'/>\r\n                            <FormattedMessage\r\n                                id='search_bar.usage.search_type_messages'\r\n                                defaultMessage='Messages'\r\n                            />\r\n                        </button>\r\n                        {isFileAttachmentEnabled &&\r\n                            <button\r\n                                className={classNames({highlighted: props.highlightedIndex === 1})}\r\n                                onClick={() => props.onSearchTypeSelected && props.onSearchTypeSelected('files')}\r\n                                onBlur={() => props.onElementBlur && props.onElementBlur()}\r\n                                onFocus={() => props.onElementFocus && props.onElementFocus()}\r\n                            >\r\n                                <i className='icon icon-file-text-outline'/>\r\n                                <FormattedMessage\r\n                                    id='search_bar.usage.search_type_files'\r\n                                    defaultMessage='Files'\r\n                                />\r\n                            </button>}\r\n                    </div>\r\n                </div>\r\n            );\r\n        }\r\n    }\r\n\r\n    return (\r\n        <>\r\n            {props.withTitle && (!props.searchType) &&\r\n                <h4 className='search-hint__title'>\r\n                    <FormattedMessage\r\n                        id='search_bar.usage.title'\r\n                        defaultMessage='Search options'\r\n                    />\r\n                </h4>\r\n            }\r\n            {props.withTitle && props.searchType === 'files' &&\r\n                <h4 className='search-hint__title'>\r\n                    <FormattedMessage\r\n                        id='search_bar.usage.title_files'\r\n                        defaultMessage='File search options'\r\n                    />\r\n                </h4>\r\n            }\r\n            {props.withTitle && props.searchType === 'messages' &&\r\n                <h4 className='search-hint__title'>\r\n                    <FormattedMessage\r\n                        id='search_bar.usage.title_messages'\r\n                        defaultMessage='Message search options'\r\n                    />\r\n                </h4>\r\n            }\r\n            <ul\r\n                role='list'\r\n                className='search-hint__suggestions-list'\r\n                onMouseDown={props.onMouseDown}\r\n                onTouchEnd={props.onMouseDown}\r\n            >\r\n                {props.options.map((option, optionIndex) => (\r\n                    <li\r\n                        className={classNames('search-hint__suggestions-list__option', {highlighted: optionIndex === props.highlightedIndex})}\r\n                        key={option.searchTerm}\r\n                        onMouseDown={() => props.onOptionSelected(option.searchTerm)}\r\n                        onTouchEnd={() => props.onOptionSelected(option.searchTerm)}\r\n                        onMouseOver={() => handleOnOptionHover(optionIndex)}\r\n                    >\r\n                        <div className='search-hint__suggestion-list__flex-wrap'>\r\n                            <span className='search-hint__suggestion-list__label'>{option.additionalDisplay ? option.additionalDisplay : option.searchTerm}</span>\r\n                        </div>\r\n                        <div className='search-hint__suggestion-list__value'>\r\n                            <FormattedMessage\r\n                                id={option.message.id}\r\n                                defaultMessage={option.message.defaultMessage}\r\n                            />\r\n                        </div>\r\n                    </li>))}\r\n            </ul>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default SearchHint;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {defineMessage, FormattedMessage} from 'react-intl';\r\n\r\nimport {getFileDownloadUrl} from 'mattermost-redux/utils/file_utils';\r\n\r\nimport FileThumbnail from 'components/file_attachment/file_thumbnail';\r\nimport FilePreviewModal from 'components/file_preview_modal';\r\nimport Timestamp, {RelativeRanges} from 'components/timestamp';\r\nimport Menu from 'components/widgets/menu/menu';\r\nimport MenuWrapper from 'components/widgets/menu/menu_wrapper';\r\nimport Tag from 'components/widgets/tag/tag';\r\nimport WithTooltip from 'components/with_tooltip';\r\n\r\nimport {getHistory} from 'utils/browser_history';\r\nimport Constants, {ModalIdentifiers} from 'utils/constants';\r\nimport {getSiteURL} from 'utils/url';\r\nimport {fileSizeToString, copyToClipboard, localizeMessage} from 'utils/utils';\r\n\r\nimport type {PropsFromRedux, OwnProps} from './index';\r\n\r\nimport './file_search_result_item.scss';\r\n\r\ntype Props = OwnProps & PropsFromRedux;\r\n\r\ntype State = {\r\n    keepOpen: boolean;\r\n}\r\n\r\nconst FILE_TOOLTIP_RANGES = [\r\n    RelativeRanges.TODAY_TITLE_CASE,\r\n    RelativeRanges.YESTERDAY_TITLE_CASE,\r\n];\r\n\r\nexport default class FileSearchResultItem extends React.PureComponent<Props, State> {\r\n    public constructor(props: Props) {\r\n        super(props);\r\n        this.state = {keepOpen: false};\r\n    }\r\n\r\n    private jumpToConv = (e: MouseEvent) => {\r\n        e.stopPropagation();\r\n        getHistory().push(`/${this.props.teamName}/pl/${this.props.fileInfo.post_id}`);\r\n    };\r\n\r\n    private copyLink = () => {\r\n        copyToClipboard(`${getSiteURL()}/${this.props.teamName}/pl/${this.props.fileInfo.post_id}`);\r\n    };\r\n\r\n    private stopPropagation = (e: React.MouseEvent<HTMLElement, MouseEvent>) => {\r\n        e.stopPropagation();\r\n    };\r\n\r\n    private keepOpen = (open: boolean) => {\r\n        this.setState({keepOpen: open});\r\n    };\r\n\r\n    private renderPluginItems = () => {\r\n        const {fileInfo, channel, enableSharedChannelsPlugins} = this.props;\r\n        const isSharedChannel = channel?.shared || false;\r\n\r\n        if (isSharedChannel && !enableSharedChannelsPlugins) {\r\n            return null;\r\n        }\r\n\r\n        const pluginItems = this.props.pluginMenuItems?.filter((item) => item?.match(fileInfo)).map((item) => {\r\n            return (\r\n                <Menu.ItemAction\r\n                    id={item.id + '_pluginmenuitem'}\r\n                    key={item.id + '_pluginmenuitem'}\r\n                    onClick={() => item.action?.(fileInfo)}\r\n                    text={item.text}\r\n                />\r\n            );\r\n        });\r\n\r\n        if (!pluginItems?.length) {\r\n            return null;\r\n        }\r\n\r\n        return (\r\n            <>\r\n                <li\r\n                    id={`divider_file_${this.props.fileInfo.id}_plugins`}\r\n                    className='MenuItem__divider'\r\n                    role='menuitem'\r\n                />\r\n                {pluginItems}\r\n            </>\r\n        );\r\n    };\r\n\r\n    private showPreview = () => {\r\n        this.props.actions.openModal({\r\n            modalId: ModalIdentifiers.FILE_PREVIEW_MODAL,\r\n            dialogType: FilePreviewModal,\r\n            dialogProps: {\r\n                fileInfos: [this.props.fileInfo],\r\n                postId: this.props.fileInfo.post_id,\r\n                startIndex: 0,\r\n            },\r\n        });\r\n    };\r\n\r\n    public render(): React.ReactNode {\r\n        const {fileInfo, channelDisplayName, channelType} = this.props;\r\n        let channelName: React.ReactNode = channelDisplayName;\r\n        if (channelType === Constants.DM_CHANNEL) {\r\n            channelName = (\r\n                <FormattedMessage\r\n                    id='search_item.file_tag.direct_message'\r\n                    defaultMessage='Direct Message'\r\n                />\r\n            );\r\n        } else if (channelType === Constants.GM_CHANNEL) {\r\n            channelName = (\r\n                <FormattedMessage\r\n                    id='search_item.file_tag.group_message'\r\n                    defaultMessage='Group Message'\r\n                />\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div\r\n                data-testid='search-item-container'\r\n                className='search-item__container'\r\n            >\r\n                <button\r\n                    className={'FileSearchResultItem' + (this.state.keepOpen ? ' keep-open' : '')}\r\n                    onClick={this.showPreview}\r\n                >\r\n                    <FileThumbnail fileInfo={fileInfo}/>\r\n                    <div className='fileData'>\r\n                        <div className='fileDataName'>{fileInfo.name}</div>\r\n                        <div className='fileMetadata'>\r\n                            {channelName && (\r\n                                <Tag\r\n                                    className='file-search-channel-name'\r\n                                    text={channelName}\r\n                                />\r\n                            )}\r\n                            <span>{fileSizeToString(fileInfo.size)}</span>\r\n                            <span>{'  '}</span>\r\n                            <Timestamp\r\n                                value={fileInfo.create_at}\r\n                                ranges={FILE_TOOLTIP_RANGES}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                    {this.props.fileInfo.post_id && (\r\n                        <WithTooltip\r\n                            title={defineMessage({id: 'file_search_result_item.more_actions', defaultMessage: 'More Actions'})}\r\n                        >\r\n                            <MenuWrapper\r\n                                onToggle={this.keepOpen}\r\n                                stopPropagationOnToggle={true}\r\n                            >\r\n                                <a\r\n                                    href='#'\r\n                                    className='action-icon dots-icon btn btn-icon btn-sm'\r\n                                >\r\n                                    <i className='icon icon-dots-vertical'/>\r\n                                </a>\r\n                                <Menu\r\n                                    ariaLabel={'file menu'}\r\n                                    openLeft={true}\r\n                                >\r\n                                    <Menu.ItemAction\r\n                                        onClick={this.jumpToConv}\r\n                                        ariaLabel={localizeMessage({id: 'file_search_result_item.open_in_channel', defaultMessage: 'Open in channel'})}\r\n                                        text={localizeMessage({id: 'file_search_result_item.open_in_channel', defaultMessage: 'Open in channel'})}\r\n                                    />\r\n                                    <Menu.ItemAction\r\n                                        onClick={this.copyLink}\r\n                                        ariaLabel={localizeMessage({id: 'file_search_result_item.copy_link', defaultMessage: 'Copy link'})}\r\n                                        text={localizeMessage({id: 'file_search_result_item.copy_link', defaultMessage: 'Copy link'})}\r\n                                    />\r\n                                    {this.renderPluginItems()}\r\n                                </Menu>\r\n                            </MenuWrapper>\r\n                        </WithTooltip>\r\n                    )}\r\n                    <WithTooltip\r\n                        title={defineMessage({id: 'file_search_result_item.download', defaultMessage: 'Download'})}\r\n                    >\r\n                        <a\r\n                            className='action-icon download-icon btn btn-icon btn-sm'\r\n                            href={getFileDownloadUrl(fileInfo.id)}\r\n                            onClick={this.stopPropagation}\r\n                        >\r\n                            <i className='icon icon-download-outline'/>\r\n                        </a>\r\n                    </WithTooltip>\r\n                </button>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport type {ConnectedProps} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {FileInfo} from '@mattermost/types/files';\r\n\r\nimport {getChannel} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getFeatureFlagValue} from 'mattermost-redux/selectors/entities/general';\r\n\r\nimport {openModal} from 'actions/views/modals';\r\n\r\nimport type {GlobalState} from 'types/store';\r\nimport type {FilesDropdownAction} from 'types/store/plugins';\r\n\r\nimport FileSearchResultItem from './file_search_result_item';\r\n\r\nexport type OwnProps = {\r\n    channelId: string;\r\n    fileInfo: FileInfo;\r\n    teamName: string;\r\n    pluginMenuItems?: FilesDropdownAction[];\r\n};\r\n\r\nfunction mapStateToProps(state: GlobalState, ownProps: OwnProps) {\r\n    const channel = getChannel(state, ownProps.channelId);\r\n    const enableSharedChannelsPlugins = getFeatureFlagValue(state, 'EnableSharedChannelsPlugins') === 'true';\r\n\r\n    return {\r\n        channelDisplayName: '',\r\n        channelType: channel?.type,\r\n        channel,\r\n        enableSharedChannelsPlugins,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            openModal,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nconst connector = connect(mapStateToProps, mapDispatchToProps);\r\n\r\nexport type PropsFromRedux = ConnectedProps<typeof connector>;\r\n\r\nexport default connector(FileSearchResultItem);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\n\r\nimport {FilterVariantIcon} from '@mattermost/compass-icons/components';\r\n\r\nimport {IconContainer} from 'components/advanced_text_editor/formatting_bar/formatting_icon';\r\nimport type {SearchFilterType} from 'components/search/types';\r\nimport Menu from 'components/widgets/menu/menu';\r\nimport MenuWrapper from 'components/widgets/menu/menu_wrapper';\r\nimport WithTooltip from 'components/with_tooltip';\r\n\r\nimport './files_filter_menu.scss';\r\n\r\ntype Props = {\r\n    selectedFilter: string;\r\n    onFilter: (filter: SearchFilterType) => void;\r\n};\r\n\r\nexport default function FilesFilterMenu(props: Props): JSX.Element {\r\n    const intl = useIntl();\r\n    return (\r\n        <div className='FilesFilterMenu'>\r\n            <MenuWrapper>\r\n                <WithTooltip\r\n                    title={\r\n                        <FormattedMessage\r\n                            id='channel_info_rhs.menu.files.filter'\r\n                            defaultMessage='Filter'\r\n                        />}\r\n                >\r\n                    <IconContainer\r\n                        id='filesFilterButton'\r\n                        className='action-icon dots-icon'\r\n                        type='button'\r\n                    >\r\n                        {props.selectedFilter !== 'all' && <i className='icon-dot'/>}\r\n                        <FilterVariantIcon\r\n                            size={18}\r\n                            color='currentColor'\r\n                        />\r\n                    </IconContainer>\r\n                </WithTooltip>\r\n\r\n                <Menu\r\n                    ariaLabel={intl.formatMessage({id: 'channel_info_rhs.menu.files.filter.file_menu', defaultMessage: 'file menu'})}\r\n                    openLeft={true}\r\n                >\r\n                    <Menu.ItemAction\r\n                        ariaLabel={intl.formatMessage({id: 'channel_info_rhs.menu.files.filter.all_file_types', defaultMessage: 'All file types'})}\r\n                        text={intl.formatMessage({id: 'channel_info_rhs.menu.files.filter.all_file_types', defaultMessage: 'All file types'})}\r\n                        onClick={() => props.onFilter('all')}\r\n                        icon={props.selectedFilter === 'all' ? <i className='icon icon-check'/> : null}\r\n                    />\r\n                    <Menu.ItemAction\r\n                        ariaLabel={intl.formatMessage({id: 'channel_info_rhs.menu.files.filter.documents', defaultMessage: 'Documents'})}\r\n                        text={intl.formatMessage({id: 'channel_info_rhs.menu.files.filter.documents', defaultMessage: 'Documents'})}\r\n                        onClick={() => props.onFilter('documents')}\r\n                        icon={props.selectedFilter === 'documents' ? <i className='icon icon-check'/> : null}\r\n                    />\r\n                    <Menu.ItemAction\r\n                        ariaLabel={intl.formatMessage({id: 'channel_info_rhs.menu.files.filter.spreadsheets', defaultMessage: 'Spreadsheets'})}\r\n                        text={intl.formatMessage({id: 'channel_info_rhs.menu.files.filter.spreadsheets', defaultMessage: 'Spreadsheets'})}\r\n                        onClick={() => props.onFilter('spreadsheets')}\r\n                        icon={props.selectedFilter === 'spreadsheets' ? <i className='icon icon-check'/> : null}\r\n                    />\r\n                    <Menu.ItemAction\r\n                        ariaLabel={intl.formatMessage({id: 'channel_info_rhs.menu.files.filter.presentations', defaultMessage: 'Presentations'})}\r\n                        text={intl.formatMessage({id: 'channel_info_rhs.menu.files.filter.presentations', defaultMessage: 'Presentations'})}\r\n                        onClick={() => props.onFilter('presentations')}\r\n                        icon={props.selectedFilter === 'presentations' ? <i className='icon icon-check'/> : null}\r\n                    />\r\n                    <Menu.ItemAction\r\n                        ariaLabel={intl.formatMessage({id: 'channel_info_rhs.menu.files.filter.code', defaultMessage: 'Code'})}\r\n                        text={intl.formatMessage({id: 'channel_info_rhs.menu.files.filter.code', defaultMessage: 'Code'})}\r\n                        onClick={() => props.onFilter('code')}\r\n                        icon={props.selectedFilter === 'code' ? <i className='icon icon-check'/> : null}\r\n                    />\r\n                    <Menu.ItemAction\r\n                        ariaLabel={intl.formatMessage({id: 'channel_info_rhs.menu.files.filter.images', defaultMessage: 'Images'})}\r\n                        text={intl.formatMessage({id: 'channel_info_rhs.menu.files.filter.images', defaultMessage: 'Images'})}\r\n                        onClick={() => props.onFilter('images')}\r\n                        icon={props.selectedFilter === 'images' ? <i className='icon icon-check'/> : null}\r\n                    />\r\n                    <Menu.ItemAction\r\n                        ariaLabel={intl.formatMessage({id: 'channel_info_rhs.menu.files.filter.audio', defaultMessage: 'Audio'})}\r\n                        text={intl.formatMessage({id: 'channel_info_rhs.menu.files.filter.audio', defaultMessage: 'Audio'})}\r\n                        onClick={() => props.onFilter('audio')}\r\n                        icon={props.selectedFilter === 'audio' ? <i className='icon icon-check'/> : null}\r\n                    />\r\n                    <Menu.ItemAction\r\n                        ariaLabel={intl.formatMessage({id: 'channel_info_rhs.menu.files.filter.videos', defaultMessage: 'Videos'})}\r\n                        text={intl.formatMessage({id: 'channel_info_rhs.menu.files.filter.videos', defaultMessage: 'Videos'})}\r\n                        onClick={() => props.onFilter('video')}\r\n                        icon={props.selectedFilter === 'video' ? <i className='icon icon-check'/> : null}\r\n                    />\r\n                </Menu>\r\n            </MenuWrapper>\r\n        </div>\r\n    );\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useRef} from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\nimport {useSelector} from 'react-redux';\r\n\r\nimport {getMyTeams} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport {getSearchTeam} from 'selectors/rhs';\r\n\r\nimport SelectTeam from 'components/new_search/select_team';\r\nimport type {SearchFilterType} from 'components/search/types';\r\n\r\nimport type {A11yFocusEventDetail} from 'utils/constants';\r\nimport Constants, {A11yCustomEventTypes, DataSearchTypes} from 'utils/constants';\r\nimport * as Keyboard from 'utils/keyboard';\r\n\r\nimport type {GlobalState} from 'types/store';\r\nimport type {SearchType} from 'types/store/rhs';\r\n\r\nimport FilesFilterMenu from './files_filter_menu';\r\n\r\nconst {KeyCodes} = Constants;\r\n\r\nimport './messages_or_files_selector.scss';\r\n\r\ntype Props = {\r\n    selected: string;\r\n    selectedFilter: SearchFilterType;\r\n    messagesCounter: string;\r\n    filesCounter: string;\r\n    isFileAttachmentsEnabled: boolean;\r\n    crossTeamSearchEnabled: boolean;\r\n    onChange: (value: SearchType) => void;\r\n    onFilter: (filter: SearchFilterType) => void;\r\n    onTeamChange: (teamId: string) => void;\r\n};\r\n\r\ntype DataSearchLiteral = typeof DataSearchTypes[keyof typeof DataSearchTypes];\r\n\r\nexport default function MessagesOrFilesSelector(props: Props): JSX.Element {\r\n    const searchTeam = useSelector((state: GlobalState) => getSearchTeam(state));\r\n    const myTeams = useSelector(getMyTeams);\r\n    const hasMoreThanOneTeam = myTeams.length > 1;\r\n\r\n    // REFS to the tabs so there is ability to pass the custom A11y focus event\r\n    const messagesTabRef = useRef<HTMLButtonElement>(null);\r\n    const filesTabRef = useRef<HTMLButtonElement>(null);\r\n\r\n    // Enhanced arrow key handling to focus the new select tab and also send the a11y custom event\r\n    const handleTabKeyDown = (\r\n        e: React.KeyboardEvent<HTMLButtonElement>,\r\n        currentTab: DataSearchLiteral,\r\n    ) => {\r\n        if (Keyboard.isKeyPressed(e, KeyCodes.LEFT) || Keyboard.isKeyPressed(e, KeyCodes.RIGHT)) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            let nextTab: SearchType;\r\n            let nextTabRef: React.RefObject<HTMLButtonElement>;\r\n\r\n            if (currentTab === DataSearchTypes.MESSAGES_SEARCH_TYPE && props.isFileAttachmentsEnabled) {\r\n                nextTab = DataSearchTypes.FILES_SEARCH_TYPE;\r\n                nextTabRef = filesTabRef;\r\n            } else {\r\n                nextTab = DataSearchTypes.MESSAGES_SEARCH_TYPE;\r\n                nextTabRef = messagesTabRef;\r\n            }\r\n\r\n            props.onChange(nextTab);\r\n\r\n            // Dispatch the custom a11y focus event to focus the selected tab\r\n            if (nextTabRef.current) {\r\n                setTimeout(() => {\r\n                    document.dispatchEvent(\r\n                        new CustomEvent<A11yFocusEventDetail>(A11yCustomEventTypes.FOCUS, {\r\n                            detail: {\r\n                                target: nextTabRef.current,\r\n                                keyboardOnly: true,\r\n                            },\r\n                        }),\r\n                    );\r\n                }, 0);\r\n            }\r\n            return;\r\n        }\r\n\r\n        if (Keyboard.isKeyPressed(e, KeyCodes.ENTER)) {\r\n            props.onChange(currentTab);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className='MessagesOrFilesSelector'>\r\n            <div\r\n                className='buttons-container'\r\n                role='tablist'\r\n                aria-label='Messages or Files'\r\n            >\r\n                <button\r\n                    ref={messagesTabRef}\r\n                    role='tab'\r\n                    aria-selected={props.selected === DataSearchTypes.MESSAGES_SEARCH_TYPE ? 'true' : 'false'}\r\n                    tabIndex={props.selected === DataSearchTypes.MESSAGES_SEARCH_TYPE ? 0 : -1}\r\n                    aria-controls='messagesPanel'\r\n                    id='messagesTab'\r\n                    onClick={() => props.onChange(DataSearchTypes.MESSAGES_SEARCH_TYPE)}\r\n                    onKeyDown={(e) => handleTabKeyDown(e, DataSearchTypes.MESSAGES_SEARCH_TYPE)}\r\n                    className={props.selected === DataSearchTypes.MESSAGES_SEARCH_TYPE ? 'active tab messages-tab' : 'tab messages-tab'}\r\n                >\r\n                    <FormattedMessage\r\n                        id='search_bar.messages_tab'\r\n                        defaultMessage='Messages'\r\n                    />\r\n                    <span className='counter'>{props.messagesCounter}</span>\r\n                </button>\r\n                {props.isFileAttachmentsEnabled && (\r\n                    <button\r\n                        ref={filesTabRef}\r\n                        role='tab'\r\n                        aria-selected={props.selected === DataSearchTypes.FILES_SEARCH_TYPE ? 'true' : 'false'}\r\n                        tabIndex={props.selected === DataSearchTypes.FILES_SEARCH_TYPE ? 0 : -1}\r\n                        aria-controls='filesPanel'\r\n                        id='filesTab'\r\n                        onClick={() => props.onChange(DataSearchTypes.FILES_SEARCH_TYPE)}\r\n                        onKeyDown={(e) => handleTabKeyDown(e, DataSearchTypes.FILES_SEARCH_TYPE)}\r\n                        className={props.selected === DataSearchTypes.FILES_SEARCH_TYPE ? 'active tab files-tab' : 'tab files-tab'}\r\n                    >\r\n                        <FormattedMessage\r\n                            id='search_bar.files_tab'\r\n                            defaultMessage='Files'\r\n                        />\r\n                        <span className='counter'>{props.filesCounter}</span>\r\n                    </button>\r\n                )}\r\n            </div>\r\n            {props.crossTeamSearchEnabled && hasMoreThanOneTeam && (\r\n                <div className='team-selector-container'>\r\n                    <SelectTeam\r\n                        selectedTeamId={searchTeam}\r\n                        onTeamSelected={props.onTeamChange}\r\n                    />\r\n                </div>\r\n            )}\r\n            {props.selected === DataSearchTypes.FILES_SEARCH_TYPE && (\r\n                <FilesFilterMenu\r\n                    selectedFilter={props.selectedFilter}\r\n                    onFilter={props.onFilter}\r\n                />\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\n\r\nimport type {Post} from '@mattermost/types/posts';\r\n\r\nimport PostComponent from 'components/post';\r\n\r\nimport {Locations} from 'utils/constants';\r\n\r\ntype Props = {\r\n    a11yIndex: number;\r\n    isFlaggedPosts: boolean;\r\n    isMentionSearch: boolean;\r\n    isPinnedPosts: boolean;\r\n    matches: string[];\r\n    post: Post;\r\n    searchTerm: string;\r\n}\r\n\r\nexport default function PostSearchResultsItem(props: Props) {\r\n    return (\r\n        <div\r\n            className='search-item__container'\r\n            data-testid='search-item-container'\r\n        >\r\n            <PostComponent\r\n                post={props.post}\r\n                matches={props.matches}\r\n                term={(!props.isFlaggedPosts && !props.isPinnedPosts && !props.isMentionSearch) ? props.searchTerm : ''}\r\n                isMentionSearch={props.isMentionSearch}\r\n                a11yIndex={props.a11yIndex}\r\n                location={Locations.SEARCH}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {useSelector} from 'react-redux';\r\n\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {isSearchTruncated} from 'mattermost-redux/selectors/entities/search';\r\n\r\nimport {getRhsState} from 'selectors/rhs';\r\n\r\nimport CenterMessageLock from 'components/center_message_lock';\r\nimport useGetServerLimits from 'components/common/hooks/useGetServerLimits';\r\n\r\nimport {DataSearchTypes, RHSStates} from 'utils/constants';\r\n\r\nimport './search_limits_banner.scss';\r\n\r\ntype Props = {\r\n    searchType: string;\r\n}\r\n\r\nfunction SearchLimitsBanner(props: Props) {\r\n    const [serverLimits] = useGetServerLimits();\r\n\r\n    // Check if current search results were actually truncated\r\n    const searchTruncated = useSelector((state: GlobalState) => {\r\n        const searchType = props.searchType === DataSearchTypes.FILES_SEARCH_TYPE ? 'files' : 'posts';\r\n        return isSearchTruncated(state, searchType);\r\n    });\r\n\r\n    // Check if RHS is currently showing search results\r\n    const rhsState = useSelector(getRhsState);\r\n    const isShowingSearchResults = rhsState === RHSStates.SEARCH;\r\n\r\n    // Only show banner if search results were actually truncated AND currently showing search results\r\n    if (!searchTruncated || !serverLimits?.postHistoryLimit || !isShowingSearchResults) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <div\r\n            id={`${props.searchType}_search_limits_banner`}\r\n            className='SearchLimitsBanner__wrapper'\r\n        >\r\n            <CenterMessageLock/>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default SearchLimitsBanner;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React, {useEffect, useRef, useState} from 'react';\r\nimport {useIntl, FormattedMessage, defineMessage} from 'react-intl';\r\nimport {useSelector} from 'react-redux';\r\n\r\nimport type {FileSearchResultItem as FileSearchResultItemType} from '@mattermost/types/files';\r\nimport type {Post} from '@mattermost/types/posts';\r\n\r\nimport {debounce} from 'mattermost-redux/actions/helpers';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {isDateLine, getDateForDateLine} from 'mattermost-redux/utils/post_list';\r\n\r\nimport {getFilesDropdownPluginMenuItems} from 'selectors/plugins';\r\n\r\nimport Scrollbars from 'components/common/scrollbars';\r\nimport FileSearchResultItem from 'components/file_search_results';\r\nimport NoResultsIndicator from 'components/no_results_indicator/no_results_indicator';\r\nimport {NoResultsVariant} from 'components/no_results_indicator/types';\r\nimport DateSeparator from 'components/post_view/date_separator';\r\nimport SearchHint from 'components/search_hint/search_hint';\r\nimport SearchResultsHeader from 'components/search_results_header';\r\nimport LoadingWrapper from 'components/widgets/loading/loading_wrapper';\r\n\r\nimport {searchHintOptions, DataSearchTypes} from 'utils/constants';\r\nimport {isFileAttachmentsEnabled} from 'utils/file_utils';\r\n\r\nimport FilesFilterMenu from './files_filter_menu';\r\nimport MessageOrFileSelector from './messages_or_files_selector';\r\nimport PostSearchResultsItem from './post_search_results_item';\r\nimport SearchLimitsBanner from './search_limits_banner';\r\nimport type {Props} from './types';\r\n\r\nimport './search_results.scss';\r\n\r\nconst GET_MORE_BUFFER = 30;\r\n\r\ninterface NoResultsProps {\r\n    variant: NoResultsVariant;\r\n    titleValues?: Record<string, React.ReactNode>;\r\n    subtitleValues?: Record<string, React.ReactNode>;\r\n}\r\n\r\nconst SearchResults: React.FC<Props> = (props: Props): JSX.Element => {\r\n    const scrollbars = useRef<HTMLDivElement>(null);\r\n    const [searchType, setSearchType] = useState<string>(props.searchType);\r\n    const filesDropdownPluginMenuItems = useSelector(getFilesDropdownPluginMenuItems);\r\n    const config = useSelector(getConfig);\r\n    const intl = useIntl();\r\n\r\n    useEffect(() => {\r\n        if (props.searchFilterType !== 'all') {\r\n            props.setSearchFilterType('all');\r\n        }\r\n        setSearchType(props.searchType);\r\n        scrollbars.current?.scrollTo({top: 0});\r\n    }, [props.searchTerms]);\r\n\r\n    useEffect(() => {\r\n        setSearchType(props.searchSelectedType);\r\n    }, [props.searchSelectedType]);\r\n\r\n    useEffect(() => {\r\n        // reset search type when switching views\r\n        setSearchType(props.searchType);\r\n    }, [props.isFlaggedPosts, props.isPinnedPosts, props.isMentionSearch]);\r\n\r\n    useEffect(() => {\r\n        // after the first page of search results, there is no way to\r\n        // know if the search has more results to return, so we search\r\n        // for the second page and stop if it yields no results\r\n        if (props.searchPage === 0 && !props.isChannelFiles && !props.isSearchingTerm) {\r\n            setTimeout(() => {\r\n                props.getMorePostsForSearch();\r\n                props.getMoreFilesForSearch();\r\n            }, 100);\r\n        }\r\n    }, [props.searchPage, props.searchTerms, props.isSearchingTerm]);\r\n\r\n    const handleScroll = (): void => {\r\n        if (!props.isFlaggedPosts && !props.isPinnedPosts && !props.isSearchingTerm && !props.isSearchGettingMore && !props.isChannelFiles) {\r\n            const scrollHeight = scrollbars.current?.scrollHeight || 0;\r\n            const scrollTop = scrollbars.current?.scrollTop || 0;\r\n            const clientHeight = scrollbars.current?.clientHeight || 0;\r\n            if ((scrollTop + clientHeight + GET_MORE_BUFFER) >= scrollHeight) {\r\n                if (searchType === DataSearchTypes.FILES_SEARCH_TYPE) {\r\n                    loadMoreFiles();\r\n                } else {\r\n                    loadMorePosts();\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    const setSearchTeam = (teamId: string): void => {\r\n        props.updateSearchTeam(teamId);\r\n    };\r\n\r\n    const loadMorePosts = debounce(\r\n        () => {\r\n            props.getMorePostsForSearch();\r\n        },\r\n        100,\r\n        false,\r\n        (): void => {},\r\n    );\r\n\r\n    const loadMoreFiles = debounce(\r\n        () => {\r\n            props.getMoreFilesForSearch();\r\n        },\r\n        100,\r\n        false,\r\n        (): void => {},\r\n    );\r\n\r\n    const {\r\n        results,\r\n        fileResults,\r\n        searchTerms,\r\n        isCard = false,\r\n        isSearchAtEnd,\r\n        isSearchFilesAtEnd,\r\n        isSearchingTerm,\r\n        isFlaggedPosts,\r\n        isSearchingFlaggedPost,\r\n        isPinnedPosts,\r\n        isChannelFiles,\r\n        isSearchingPinnedPost,\r\n        isSideBarExpanded,\r\n        isMentionSearch,\r\n        isOpened = false,\r\n        updateSearchTerms,\r\n        handleSearchHintSelection,\r\n        searchFilterType,\r\n        setSearchFilterType,\r\n    } = props;\r\n\r\n    const noResults = (!results || !Array.isArray(results) || results.length === 0);\r\n    const noFileResults = (!fileResults || !Array.isArray(fileResults) || fileResults.length === 0);\r\n    const isLoading = isSearchingTerm || isSearchingFlaggedPost || isSearchingPinnedPost || !isOpened;\r\n    const isAtEnd = (searchType === DataSearchTypes.MESSAGES_SEARCH_TYPE && isSearchAtEnd) || (searchType === DataSearchTypes.FILES_SEARCH_TYPE && isSearchFilesAtEnd);\r\n    const showLoadMore = !isAtEnd && !isChannelFiles && !isFlaggedPosts && !isPinnedPosts;\r\n    const isMessagesSearch = (!isFlaggedPosts && !isMentionSearch && !isCard && !isPinnedPosts && !isChannelFiles);\r\n\r\n    let contentItems;\r\n    let loadingMorePostsComponent;\r\n\r\n    let sortedResults: any = results;\r\n\r\n    let titleDescriptor;\r\n    const noResultsProps: NoResultsProps = {\r\n        variant: NoResultsVariant.ChannelSearch,\r\n    };\r\n\r\n    if (isMentionSearch) {\r\n        noResultsProps.variant = NoResultsVariant.Mentions;\r\n\r\n        titleDescriptor = defineMessage({\r\n            id: 'search_header.title2',\r\n            defaultMessage: 'Recent Mentions',\r\n        });\r\n    } else if (isFlaggedPosts) {\r\n        noResultsProps.variant = NoResultsVariant.FlaggedPosts;\r\n        noResultsProps.subtitleValues = {buttonText: <strong>{\r\n            intl.formatMessage({\r\n                id: 'flag_post.flag',\r\n                defaultMessage: 'Save Message'},\r\n            )}</strong>};\r\n        titleDescriptor = defineMessage({\r\n            id: 'search_header.title3',\r\n            defaultMessage: 'Saved messages',\r\n        });\r\n    } else if (isPinnedPosts) {\r\n        noResultsProps.variant = NoResultsVariant.PinnedPosts;\r\n        noResultsProps.subtitleValues = {text: <strong>{\r\n            intl.formatMessage({\r\n                id: 'post_info.pin',\r\n                defaultMessage: 'Pin to Channel',\r\n            })}</strong>};\r\n\r\n        sortedResults = [...results];\r\n\r\n        titleDescriptor = defineMessage({\r\n            id: 'search_header.pinnedMessages',\r\n            defaultMessage: 'Pinned messages',\r\n        });\r\n    } else if (isChannelFiles) {\r\n        if (searchFilterType === 'all') {\r\n            noResultsProps.variant = NoResultsVariant.ChannelFiles;\r\n        } else {\r\n            noResultsProps.variant = NoResultsVariant.ChannelFilesFiltered;\r\n        }\r\n\r\n        titleDescriptor = defineMessage({\r\n            id: 'search_header.channelFiles',\r\n            defaultMessage: 'Files',\r\n        });\r\n    } else if (isCard) {\r\n        titleDescriptor = defineMessage({\r\n            id: 'search_header.title5',\r\n            defaultMessage: 'Extra information',\r\n        });\r\n    } else if (!searchTerms && noResults && noFileResults) {\r\n        titleDescriptor = defineMessage({\r\n            id: 'search_header.search',\r\n            defaultMessage: 'Search',\r\n        });\r\n    } else if (searchType === DataSearchTypes.FILES_SEARCH_TYPE && !isChannelFiles) {\r\n        noResultsProps.variant = NoResultsVariant.Files;\r\n        noResultsProps.titleValues = {searchTerm: `${searchTerms}`};\r\n        titleDescriptor = defineMessage({\r\n            id: 'search_header.results',\r\n            defaultMessage: 'Search Results',\r\n        });\r\n    } else {\r\n        noResultsProps.titleValues = {channelName: `${searchTerms}`};\r\n\r\n        titleDescriptor = defineMessage({\r\n            id: 'search_header.results',\r\n            defaultMessage: 'Search Results',\r\n        });\r\n    }\r\n\r\n    const formattedTitle = intl.formatMessage(titleDescriptor);\r\n\r\n    const handleOptionSelection = (term: string): void => {\r\n        handleSearchHintSelection();\r\n        updateSearchTerms(term);\r\n    };\r\n\r\n    switch (true) {\r\n    case isLoading:\r\n        contentItems = (\r\n            <div className='sidebar--right__subheader a11y__section'>\r\n                <div className='sidebar--right__loading'>\r\n                    <LoadingWrapper text={defineMessage({id: 'search_header.loading', defaultMessage: 'Searching'})}/>\r\n                </div>\r\n            </div>\r\n        );\r\n        break;\r\n    case (noResults && !searchTerms && !isMentionSearch && !isPinnedPosts && !isFlaggedPosts && !isChannelFiles):\r\n        contentItems = (\r\n            <div className='sidebar--right__subheader search__hints a11y__section'>\r\n                <SearchHint\r\n                    onOptionSelected={handleOptionSelection}\r\n                    options={searchHintOptions}\r\n                />\r\n            </div>\r\n        );\r\n        break;\r\n    case noResults && (searchType === DataSearchTypes.MESSAGES_SEARCH_TYPE && !isChannelFiles):\r\n        contentItems = (\r\n            <div\r\n                className={classNames([\r\n                    'sidebar--right__subheader a11y__section',\r\n                    {'sidebar-expanded': isSideBarExpanded},\r\n                ])}\r\n                aria-live='polite'\r\n            >\r\n                <NoResultsIndicator\r\n                    style={{padding: '48px'}}\r\n                    {...noResultsProps}\r\n                />\r\n            </div>\r\n        );\r\n        break;\r\n    case noFileResults && (searchType === DataSearchTypes.FILES_SEARCH_TYPE || isChannelFiles):\r\n        contentItems = (\r\n            <div\r\n                className={classNames([\r\n                    'sidebar--right__subheader a11y__section',\r\n                    {'sidebar-expanded': isSideBarExpanded},\r\n                ])}\r\n                aria-live='polite'\r\n            >\r\n                <NoResultsIndicator\r\n                    style={{padding: '48px'}}\r\n                    {...noResultsProps}\r\n                />\r\n            </div>\r\n        );\r\n        break;\r\n    default:\r\n        if (searchType === DataSearchTypes.FILES_SEARCH_TYPE || isChannelFiles) {\r\n            sortedResults = fileResults;\r\n        }\r\n\r\n        contentItems = sortedResults.map((item: string|Post|FileSearchResultItemType, index: number) => {\r\n            if (searchType === DataSearchTypes.MESSAGES_SEARCH_TYPE && !props.isChannelFiles) {\r\n                if (typeof item === 'string' && isDateLine(item)) {\r\n                    const date = getDateForDateLine(item);\r\n                    return (\r\n                        <DateSeparator\r\n                            key={date}\r\n                            date={date}\r\n                        />\r\n                    );\r\n                }\r\n\r\n                const post = item as Post;\r\n                return (\r\n                    <PostSearchResultsItem\r\n                        key={post.id}\r\n                        post={post}\r\n                        matches={props.matches[post.id]}\r\n                        searchTerm={searchTerms}\r\n                        isFlaggedPosts={props.isFlaggedPosts}\r\n                        isMentionSearch={props.isMentionSearch}\r\n                        isPinnedPosts={props.isPinnedPosts}\r\n                        a11yIndex={index}\r\n                    />\r\n                );\r\n            }\r\n            return (\r\n                <FileSearchResultItem\r\n                    key={(item as FileSearchResultItemType).id}\r\n                    channelId={(item as FileSearchResultItemType).channel_id}\r\n                    fileInfo={item as FileSearchResultItemType}\r\n                    teamName={props.currentTeamName}\r\n                    pluginMenuItems={filesDropdownPluginMenuItems}\r\n                />\r\n            );\r\n        });\r\n\r\n        loadingMorePostsComponent = (showLoadMore) ? (\r\n            <div className='loading-screen'>\r\n                <div className='loading__content'>\r\n                    <div className='round round-1'/>\r\n                    <div className='round round-2'/>\r\n                    <div className='round round-3'/>\r\n                </div>\r\n            </div>\r\n        ) : null;\r\n    }\r\n\r\n    return (\r\n        <div\r\n            id='searchContainer'\r\n            className='SearchResults sidebar-right__body'\r\n        >\r\n            <SearchResultsHeader>\r\n                <h2 id='rhsPanelTitle'>\r\n                    {formattedTitle}\r\n                </h2>\r\n                {props.channelDisplayName && <div className='sidebar--right__title__channel'>{props.channelDisplayName}</div>}\r\n            </SearchResultsHeader>\r\n            {isMessagesSearch &&\r\n                <MessageOrFileSelector\r\n                    selected={searchType}\r\n                    selectedFilter={searchFilterType}\r\n                    isFileAttachmentsEnabled={isFileAttachmentsEnabled(config)}\r\n                    messagesCounter={isSearchAtEnd || props.searchPage === 0 ? `${results.length}` : `${results.length}+`}\r\n                    filesCounter={isSearchFilesAtEnd || props.searchPage === 0 ? `${fileResults.length}` : `${fileResults.length}+`}\r\n                    onChange={setSearchType}\r\n                    onFilter={setSearchFilterType}\r\n                    onTeamChange={setSearchTeam}\r\n                    crossTeamSearchEnabled={props.crossTeamSearchEnabled}\r\n                />}\r\n            {isChannelFiles &&\r\n                <div className='channel-files__header'>\r\n                    <div className='channel-files__title'>\r\n                        <FormattedMessage\r\n                            id='search_results.channel-files-header'\r\n                            defaultMessage='Recent files'\r\n                        />\r\n                    </div>\r\n                    <FilesFilterMenu\r\n                        selectedFilter={searchFilterType}\r\n                        onFilter={setSearchFilterType}\r\n                    />\r\n                </div>\r\n            }\r\n            <SearchLimitsBanner searchType={searchType}/>\r\n            <Scrollbars\r\n                ref={scrollbars}\r\n                color='--center-channel-color-rgb'\r\n                onScroll={handleScroll}\r\n            >\r\n                <div\r\n                    id='search-items-container'\r\n                    className={classNames([\r\n                        'search-items-container post-list__table a11y__region',\r\n                        {\r\n                            'no-results': (noResults && searchType === DataSearchTypes.MESSAGES_SEARCH_TYPE) || (noFileResults && (searchType === DataSearchTypes.FILES_SEARCH_TYPE || isChannelFiles)),\r\n                            'channel-files-container': isChannelFiles,\r\n                        },\r\n                    ])}\r\n                    data-a11y-sort-order='3'\r\n                    data-a11y-focus-child={true}\r\n                    data-a11y-loop-navigation={false}\r\n                    aria-label={intl.formatMessage({\r\n                        id: 'accessibility.sections.rhs',\r\n                        defaultMessage: '{regionTitle} complementary region',\r\n                    }, {\r\n                        regionTitle: formattedTitle,\r\n                    })}\r\n                >\r\n                    <div\r\n                        id={`${searchType}Panel`}\r\n                        className='files-or-messages-panel'\r\n                    >\r\n                        {contentItems}\r\n                    </div>\r\n                    {loadingMorePostsComponent}\r\n                </div>\r\n            </Scrollbars>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport const arePropsEqual = (props: Props, nextProps: Props): boolean => {\r\n    // Shallow compare for all props except 'results' and 'fileResults'\r\n    for (const key in nextProps) {\r\n        if (!Object.hasOwn(nextProps, key) || key === 'results') {\r\n            continue;\r\n        }\r\n\r\n        if (!Object.hasOwn(nextProps, key) || key === 'fileResults') {\r\n            continue;\r\n        }\r\n\r\n        if (nextProps[key] !== props[key]) {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    // Here we do a slightly deeper compare on 'results' because it is frequently a new\r\n    // array but without any actual changes\r\n    const {results} = props;\r\n    const {results: nextResults} = nextProps;\r\n\r\n    if (results.length !== nextResults.length) {\r\n        return false;\r\n    }\r\n\r\n    for (let i = 0; i < results.length; i++) {\r\n        // Only need a shallow compare on each post\r\n        if (results[i] !== nextResults[i]) {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    // Here we do a slightly deeper compare on 'fileResults' because it is frequently a new\r\n    // array but without any actual changes\r\n    const {fileResults} = props;\r\n    const {fileResults: nextFileResults} = nextProps;\r\n\r\n    if (fileResults.length !== nextFileResults.length) {\r\n        return false;\r\n    }\r\n\r\n    for (let i = 0; i < fileResults.length; i++) {\r\n        // Only need a shallow compare on each file\r\n        if (fileResults[i] !== nextFileResults[i]) {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    return true;\r\n};\r\n\r\nexport default React.memo(SearchResults, arePropsEqual);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\n\r\nimport type {FileSearchResultItem} from '@mattermost/types/files';\r\nimport type {Post} from '@mattermost/types/posts';\r\n\r\nimport {getSearchFilesResults} from 'mattermost-redux/selectors/entities/files';\r\nimport {getSearchMatches, getSearchResults} from 'mattermost-redux/selectors/entities/posts';\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\nimport {makeAddDateSeparatorsForSearchResults} from 'mattermost-redux/utils/post_list';\r\n\r\nimport {\r\n    getSearchResultsTerms,\r\n    getSearchResultsType,\r\n    getIsSearchingTerm,\r\n    getIsSearchingFlaggedPost,\r\n    getIsSearchingPinnedPost,\r\n    getIsSearchGettingMore,\r\n    getCurrentSearchForSearchTeam,\r\n} from 'selectors/rhs';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport SearchResults from './search_results';\r\nimport type {StateProps, OwnProps} from './types';\r\n\r\nfunction makeMapStateToProps() {\r\n    let results: Post[];\r\n    let fileResults: FileSearchResultItem[];\r\n    let files: FileSearchResultItem[] = [];\r\n    const addDateSeparatorsForSearchResults = makeAddDateSeparatorsForSearchResults();\r\n\r\n    return function mapStateToProps(state: GlobalState, ownProps: OwnProps) {\r\n        const newResults = getSearchResults(state);\r\n\r\n        // Cache results\r\n        if (newResults && newResults !== results) {\r\n            results = newResults;\r\n\r\n            if (ownProps.isPinnedPosts) {\r\n                results = results.sort((postA: Post | FileSearchResultItem, postB: Post | FileSearchResultItem) => postB.create_at - postA.create_at);\r\n            }\r\n        }\r\n\r\n        const newFilesResults = getSearchFilesResults(state);\r\n\r\n        // Cache files and channels\r\n        if (newFilesResults && newFilesResults !== fileResults) {\r\n            fileResults = newFilesResults;\r\n\r\n            files = [];\r\n            fileResults.forEach((file) => {\r\n                if (!file) {\r\n                    return;\r\n                }\r\n\r\n                files.push(file);\r\n            });\r\n        }\r\n\r\n        // this is basically a hack to make ts compiler happy\r\n        // add correct type when it is known what exactly is returned from the function\r\n        const currentSearch = (getCurrentSearchForSearchTeam(state) as unknown as Record<string, any>) || {};\r\n        const currentTeamName = getCurrentTeam(state)?.name ?? '';\r\n\r\n        const resultsWithDateSeparators = addDateSeparatorsForSearchResults(state, results);\r\n\r\n        return {\r\n            results: resultsWithDateSeparators,\r\n            fileResults: files,\r\n            matches: getSearchMatches(state),\r\n            searchTerms: getSearchResultsTerms(state),\r\n            searchSelectedType: getSearchResultsType(state),\r\n            isSearchingTerm: getIsSearchingTerm(state),\r\n            isSearchingFlaggedPost: getIsSearchingFlaggedPost(state),\r\n            isSearchingPinnedPost: getIsSearchingPinnedPost(state),\r\n            isSearchGettingMore: getIsSearchGettingMore(state),\r\n            isSearchAtEnd: currentSearch.isEnd,\r\n            isSearchFilesAtEnd: currentSearch.isFilesEnd,\r\n            searchPage: currentSearch.params?.page,\r\n            currentTeamName,\r\n        };\r\n    };\r\n}\r\n\r\n// eslint-disable-next-line @typescript-eslint/ban-types\r\nexport default connect<StateProps, {}, OwnProps, GlobalState>(makeMapStateToProps)(SearchResults);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useEffect, useState, useRef, useCallback} from 'react';\r\nimport type {ChangeEvent, FormEvent} from 'react';\r\nimport {useIntl} from 'react-intl';\r\nimport {useSelector} from 'react-redux';\r\n\r\nimport {getCurrentChannelNameForSearchShortcut} from 'mattermost-redux/selectors/entities/channels';\r\n\r\nimport HeaderIconWrapper from 'components/channel_header/components/header_icon_wrapper';\r\nimport SearchBar from 'components/search_bar/search_bar';\r\nimport SearchHint from 'components/search_hint/search_hint';\r\nimport SearchResults from 'components/search_results';\r\nimport type Provider from 'components/suggestion/provider';\r\nimport SearchChannelProvider from 'components/suggestion/search_channel_provider';\r\nimport SearchDateProvider from 'components/suggestion/search_date_provider';\r\nimport SearchUserProvider from 'components/suggestion/search_user_provider';\r\nimport SearchIcon from 'components/widgets/icons/search_icon';\r\nimport Popover from 'components/widgets/popover';\r\n\r\nimport Constants, {searchHintOptions, RHSStates, searchFilesHintOptions} from 'utils/constants';\r\nimport * as Keyboard from 'utils/keyboard';\r\nimport {isServerVersionGreaterThanOrEqualTo} from 'utils/server_version';\r\nimport {isDesktopApp, getDesktopVersion, isMacApp} from 'utils/user_agent';\r\n\r\nimport type {SearchType} from 'types/store/rhs';\r\n\r\nimport type {Props, SearchFilterType} from './types';\r\n\r\ninterface SearchHintOption {\r\n    searchTerm: string;\r\n    message: {\r\n        id: string;\r\n        defaultMessage: string;\r\n    };\r\n}\r\n\r\nconst determineVisibleSearchHintOptions = (searchTerms: string, searchType: SearchType): SearchHintOption[] => {\r\n    let newVisibleSearchHintOptions: SearchHintOption[] = [];\r\n    let options = searchHintOptions;\r\n    if (searchType === 'files') {\r\n        options = searchFilesHintOptions;\r\n    }\r\n\r\n    if (searchTerms.trim() === '') {\r\n        return options;\r\n    }\r\n\r\n    const pretextArray = searchTerms.split(/\\s+/g);\r\n    const pretext = pretextArray[pretextArray.length - 1];\r\n    const penultimatePretext = pretextArray[pretextArray.length - 2];\r\n\r\n    let shouldShowHintOptions: boolean;\r\n\r\n    if (penultimatePretext) {\r\n        shouldShowHintOptions = !(options.some(({searchTerm}) => penultimatePretext.toLowerCase().endsWith(searchTerm.toLowerCase())) && penultimatePretext !== '@');\r\n    } else {\r\n        shouldShowHintOptions = !options.some(({searchTerm}) => searchTerms.toLowerCase().endsWith(searchTerm.toLowerCase())) || searchTerms === '@';\r\n    }\r\n\r\n    if (shouldShowHintOptions) {\r\n        try {\r\n            newVisibleSearchHintOptions = options.filter((option) => {\r\n                if (pretext === '@' && option.searchTerm === 'From:') {\r\n                    return true;\r\n                }\r\n\r\n                return new RegExp(pretext, 'ig').\r\n                    test(option.searchTerm) && option.searchTerm.toLowerCase() !== pretext.toLowerCase();\r\n            });\r\n        } catch {\r\n            newVisibleSearchHintOptions = [];\r\n        }\r\n    }\r\n\r\n    return newVisibleSearchHintOptions;\r\n};\r\n\r\nconst Search = ({\r\n    actions: {\r\n        autocompleteChannelsForSearch,\r\n        autocompleteUsersInTeam,\r\n        closeRightHandSide,\r\n        filterFilesSearchByExt,\r\n        getMoreFilesForSearch,\r\n        getMorePostsForSearch,\r\n        openRHSSearch,\r\n        setRhsExpanded,\r\n        showChannelFiles,\r\n        showSearchResults,\r\n        updateRhsState,\r\n        updateSearchTeam,\r\n        updateSearchTerms,\r\n        updateSearchTermsForShortcut,\r\n        updateSearchType,\r\n    },\r\n    crossTeamSearchEnabled,\r\n    hideMobileSearchBarInRHS = false,\r\n    isChannelFiles,\r\n    isFlaggedPosts,\r\n    isMentionSearch,\r\n    isMobileView,\r\n    isPinnedPosts,\r\n    isRhsExpanded,\r\n    isSearchingTerm,\r\n    searchTeam,\r\n    searchTerms = '',\r\n    searchType,\r\n    searchVisible,\r\n    channelDisplayName = '',\r\n    children,\r\n    currentChannel,\r\n    enableFindShortcut,\r\n    getFocus,\r\n    hideSearchBar,\r\n    isSideBarRight = false,\r\n    isSideBarRightOpen,\r\n}: Props): JSX.Element => {\r\n    const intl = useIntl();\r\n    const currentChannelName = useSelector(getCurrentChannelNameForSearchShortcut);\r\n\r\n    // generate intial component state and setters\r\n    const [focused, setFocused] = useState<boolean>(false);\r\n    const [dropdownFocused, setDropdownFocused] = useState<boolean>(false);\r\n    const [keepInputFocused, setKeepInputFocused] = useState<boolean>(false);\r\n    const [indexChangedViaKeyPress, setIndexChangedViaKeyPress] = useState<boolean>(false);\r\n    const [highlightedSearchHintIndex, setHighlightedSearchHintIndex] = useState<number>(-1);\r\n    const [visibleSearchHintOptions, setVisibleSearchHintOptions] = useState<SearchHintOption[]>(\r\n        determineVisibleSearchHintOptions(searchTerms, searchType),\r\n    );\r\n    const [searchFilterType, setSearchFilterType] = useState<SearchFilterType>('all');\r\n\r\n    const suggestionProviders = useRef<Provider[]>([\r\n        new SearchDateProvider(),\r\n        new SearchChannelProvider(autocompleteChannelsForSearch),\r\n        new SearchUserProvider(autocompleteUsersInTeam),\r\n    ]);\r\n\r\n    const isDesktop = isDesktopApp() && isServerVersionGreaterThanOrEqualTo(getDesktopVersion(), '4.7.0');\r\n    useEffect(() => {\r\n        if (!enableFindShortcut) {\r\n            return undefined;\r\n        }\r\n\r\n        const handleKeyDown = (e: KeyboardEvent) => {\r\n            if (Keyboard.cmdOrCtrlPressed(e) && Keyboard.isKeyPressed(e, Constants.KeyCodes.F)) {\r\n                if (!isDesktop && !e.shiftKey) {\r\n                    return;\r\n                }\r\n\r\n                // Special case for Mac Desktop xApp where Ctrl+Cmd+F triggers full screen view\r\n                if (isMacApp() && e.ctrlKey) {\r\n                    return;\r\n                }\r\n\r\n                e.preventDefault();\r\n                if (hideSearchBar) {\r\n                    openRHSSearch();\r\n                    setKeepInputFocused(true);\r\n                }\r\n                if (currentChannelName) {\r\n                    updateSearchTermsForShortcut();\r\n                }\r\n                handleFocus();\r\n            }\r\n        };\r\n\r\n        document.addEventListener('keydown', handleKeyDown);\r\n        return () => {\r\n            document.removeEventListener('keydown', handleKeyDown);\r\n        };\r\n    }, [hideSearchBar, currentChannelName]);\r\n\r\n    useEffect((): void => {\r\n        if (isMobileView && isSideBarRight) {\r\n            handleFocus();\r\n        }\r\n    }, [isMobileView, isSideBarRight]);\r\n\r\n    useEffect((): void => {\r\n        if (!isMobileView) {\r\n            setVisibleSearchHintOptions(determineVisibleSearchHintOptions(searchTerms, searchType));\r\n        }\r\n    }, [isMobileView, searchTerms, searchType]);\r\n\r\n    useEffect((): void => {\r\n        if (!isMobileView && focused && keepInputFocused) {\r\n            handleBlur();\r\n        }\r\n    }, [isMobileView, searchTerms]);\r\n\r\n    const getMorePostsForSearchCallback = useCallback(() => {\r\n        let team = searchTeam;\r\n        if (isMentionSearch) {\r\n            team = '';\r\n        }\r\n        getMorePostsForSearch(team);\r\n    }, [searchTeam, isMentionSearch, getMorePostsForSearch]);\r\n\r\n    const getMoreFilesForSearchCallback = useCallback(() => {\r\n        let team = searchTeam;\r\n        if (isMentionSearch) {\r\n            team = '';\r\n        }\r\n        getMoreFilesForSearch(team);\r\n    }, [searchTeam, isMentionSearch, getMoreFilesForSearch]);\r\n\r\n    // handle cloding of rhs-flyout\r\n    const handleClose = (): void => closeRightHandSide();\r\n\r\n    // focus the search input\r\n    const handleFocus = (): void => setFocused(true);\r\n\r\n    // release focus from the search input or unset `keepInputFocused` value\r\n    // `keepInputFocused` is used to keep the search input focused when a\r\n    // user selects a suggestion from `SearchHint` with a click\r\n    const handleBlur = (): void => {\r\n        // add time out so that the pinned and member buttons are clickable\r\n        // when focus is released from the search box.\r\n        setTimeout((): void => {\r\n            if (keepInputFocused) {\r\n                setKeepInputFocused(false);\r\n            } else {\r\n                setFocused(false);\r\n            }\r\n        }, 0);\r\n        updateHighlightedSearchHint();\r\n    };\r\n\r\n    const handleDropdownBlur = () => setDropdownFocused(false);\r\n\r\n    const handleDropdownFocus = () => setDropdownFocused(true);\r\n\r\n    const handleSearchHintSelection = (): void => {\r\n        if (focused) {\r\n            setKeepInputFocused(true);\r\n        } else {\r\n            setFocused(true);\r\n        }\r\n    };\r\n\r\n    const handleAddSearchTerm = (term: string): void => {\r\n        const pretextArray = searchTerms?.split(' ') || [];\r\n        pretextArray.pop();\r\n        pretextArray.push(term.toLowerCase());\r\n        handleUpdateSearchTerms(pretextArray.join(' '));\r\n    };\r\n\r\n    const handleUpdateSearchTeamFromResult = async (teamId: string) => {\r\n        updateSearchTeam(teamId);\r\n        const newTerms = searchTerms.\r\n            replace(/\\bin:[^\\s]*/gi, '').replace(/\\s{2,}/g, ' ').\r\n            replace(/\\bfrom:[^\\s]*/gi, '').replace(/\\s{2,}/g, ' ');\r\n\r\n        if (newTerms.trim() !== searchTerms.trim()) {\r\n            updateSearchTerms(newTerms);\r\n        }\r\n\r\n        handleSearch().then(() => {\r\n            setKeepInputFocused(false);\r\n            setFocused(false);\r\n        });\r\n    };\r\n\r\n    const handleUpdateSearchTerms = (terms: string): void => {\r\n        updateSearchTerms(terms);\r\n        updateHighlightedSearchHint();\r\n    };\r\n\r\n    const handleOnSearchTypeSelected = (searchType || searchTerms) ? undefined : (value: SearchType) => {\r\n        updateSearchType(value);\r\n        if (!searchType) {\r\n            setDropdownFocused(false);\r\n        }\r\n        setFocused(true);\r\n    };\r\n\r\n    const handleChange = (e: ChangeEvent<HTMLInputElement>): void => {\r\n        const term = e.target.value;\r\n        updateSearchTerms(term);\r\n    };\r\n\r\n    // call this function without parameters to reset `SearchHint`\r\n    const updateHighlightedSearchHint = (indexDelta = 0, changedViaKeyPress = false): void => {\r\n        if (Math.abs(indexDelta) > 1) {\r\n            return;\r\n        }\r\n\r\n        let newIndex = highlightedSearchHintIndex + indexDelta;\r\n\r\n        switch (indexDelta) {\r\n        case 1:\r\n            // KEY.DOWN\r\n            // is it at the end of the list?\r\n            newIndex = newIndex === visibleSearchHintOptions.length ? 0 : newIndex;\r\n            break;\r\n        case -1:\r\n            // KEY.UP\r\n            // is it at the start of the list (or initial value)?\r\n            newIndex = newIndex < 0 ? visibleSearchHintOptions.length - 1 : newIndex;\r\n            break;\r\n        case 0:\r\n        default:\r\n            // reset the index (e.g. on blur)\r\n            newIndex = -1;\r\n        }\r\n\r\n        setHighlightedSearchHintIndex(newIndex);\r\n        setIndexChangedViaKeyPress(changedViaKeyPress);\r\n    };\r\n\r\n    const handleEnterKey = (e: ChangeEvent<HTMLInputElement>): void => {\r\n        e.preventDefault();\r\n\r\n        if (indexChangedViaKeyPress) {\r\n            setKeepInputFocused(true);\r\n            if (!searchType && !searchTerms) {\r\n                updateSearchType(highlightedSearchHintIndex === 0 ? 'messages' : 'files');\r\n                setHighlightedSearchHintIndex(-1);\r\n            } else {\r\n                handleAddSearchTerm(visibleSearchHintOptions[highlightedSearchHintIndex].searchTerm);\r\n            }\r\n            return;\r\n        }\r\n\r\n        if (isMentionSearch) {\r\n            updateRhsState(RHSStates.SEARCH);\r\n        }\r\n\r\n        handleSearch().then(() => {\r\n            setKeepInputFocused(false);\r\n            setFocused(false);\r\n        });\r\n    };\r\n\r\n    const handleSubmit = (e: FormEvent<HTMLFormElement>): void => {\r\n        e.preventDefault();\r\n\r\n        handleSearch().then(() => {\r\n            setKeepInputFocused(false);\r\n            setFocused(false);\r\n        });\r\n    };\r\n\r\n    const handleSearch = async (): Promise<void> => {\r\n        const terms = searchTerms.trim();\r\n\r\n        if (terms.length === 0) {\r\n            return;\r\n        }\r\n\r\n        const {error} = await showSearchResults(Boolean(isMentionSearch)) as any;\r\n\r\n        if (!error) {\r\n            handleSearchOnSuccess();\r\n        }\r\n    };\r\n\r\n    const handleSearchOnSuccess = (): void => {\r\n        if (isMobileView) {\r\n            handleClear();\r\n        }\r\n    };\r\n\r\n    const handleClear = (): void => {\r\n        if (isMentionSearch) {\r\n            setFocused(false);\r\n            updateRhsState(RHSStates.SEARCH);\r\n        }\r\n        updateSearchTerms('');\r\n        updateSearchTeam(null);\r\n        updateSearchType('');\r\n    };\r\n\r\n    const handleShrink = (): void => {\r\n        setRhsExpanded(false);\r\n    };\r\n\r\n    const handleSetSearchFilter = (filterType: SearchFilterType): void => {\r\n        switch (filterType) {\r\n        case 'documents':\r\n            filterFilesSearchByExt(['doc', 'pdf', 'docx', 'odt', 'rtf', 'txt']);\r\n            break;\r\n        case 'spreadsheets':\r\n            filterFilesSearchByExt(['xls', 'xlsx', 'ods']);\r\n            break;\r\n        case 'presentations':\r\n            filterFilesSearchByExt(['ppt', 'pptx', 'odp']);\r\n            break;\r\n        case 'code':\r\n            filterFilesSearchByExt(['py', 'go', 'java', 'kt', 'c', 'cpp', 'h', 'html', 'js', 'ts', 'cs', 'vb', 'php', 'pl', 'r', 'rb', 'sql', 'swift', 'json']);\r\n            break;\r\n        case 'images':\r\n            filterFilesSearchByExt(['png', 'jpg', 'jpeg', 'bmp', 'tiff', 'svg', 'psd', 'xcf']);\r\n            break;\r\n        case 'audio':\r\n            filterFilesSearchByExt(['ogg', 'mp3', 'wav', 'flac']);\r\n            break;\r\n        case 'video':\r\n            filterFilesSearchByExt(['ogm', 'mp4', 'avi', 'webm', 'mov', 'mkv', 'mpeg', 'mpg']);\r\n            break;\r\n        default:\r\n            filterFilesSearchByExt([]);\r\n        }\r\n        setSearchFilterType(filterType);\r\n        if (isChannelFiles && currentChannel) {\r\n            showChannelFiles(currentChannel.id);\r\n        } else {\r\n            showSearchResults(false);\r\n        }\r\n    };\r\n\r\n    const setHoverHintIndex = (_highlightedSearchHintIndex: number): void => {\r\n        setHighlightedSearchHintIndex(_highlightedSearchHintIndex);\r\n        setIndexChangedViaKeyPress(false);\r\n    };\r\n\r\n    const searchButtonClick = (e: React.MouseEvent) => {\r\n        e.preventDefault();\r\n\r\n        openRHSSearch();\r\n    };\r\n\r\n    const renderHintPopover = (): JSX.Element => {\r\n        let termsUsed = 0;\r\n\r\n        searchTerms?.split(/[: ]/g).forEach((word: string): void => {\r\n            let options = searchHintOptions;\r\n            if (searchType === 'files') {\r\n                options = searchFilesHintOptions;\r\n            }\r\n            if (options.some(({searchTerm}) => searchTerm.toLowerCase() === word.toLowerCase())) {\r\n                termsUsed++;\r\n            }\r\n        });\r\n\r\n        if (visibleSearchHintOptions.length === 0 || isMentionSearch) {\r\n            return <></>;\r\n        }\r\n\r\n        const helpClass = `search-help-popover${((dropdownFocused || focused) && termsUsed <= 2) ? ' visible' : ''}`;\r\n\r\n        return (\r\n            <Popover\r\n                id={`${isSideBarRight ? 'sbr-' : ''}searchbar-help-popup`}\r\n                placement='bottom'\r\n                className={helpClass}\r\n            >\r\n                <SearchHint\r\n                    options={visibleSearchHintOptions}\r\n                    withTitle={true}\r\n                    onOptionSelected={handleAddSearchTerm}\r\n                    onMouseDown={handleSearchHintSelection}\r\n                    highlightedIndex={highlightedSearchHintIndex}\r\n                    onOptionHover={setHoverHintIndex}\r\n                    onSearchTypeSelected={handleOnSearchTypeSelected}\r\n                    onElementBlur={handleDropdownBlur}\r\n                    onElementFocus={handleDropdownFocus}\r\n                    searchType={searchType}\r\n                />\r\n            </Popover>\r\n        );\r\n    };\r\n\r\n    const renderSearchBar = (): JSX.Element => (\r\n        <>\r\n            <div className='sidebar-collapse__container'>\r\n                <button\r\n                    id={isSideBarRight ? 'sbrSidebarCollapse' : 'sidebarCollapse'}\r\n                    className='sidebar-collapse'\r\n                    onClick={handleClose}\r\n                    aria-label={intl.formatMessage({id: 'channel_header.back', defaultMessage: 'Back to channel'})}\r\n                >\r\n                    <span\r\n                        className='fa fa-2x fa-angle-left'\r\n                        title={intl.formatMessage({id: 'generic_icons.back', defaultMessage: 'Back Icon'})}\r\n                        aria-hidden='true'\r\n                    />\r\n                </button>\r\n            </div>\r\n            <SearchBar\r\n                updateHighlightedSearchHint={updateHighlightedSearchHint}\r\n                handleEnterKey={handleEnterKey}\r\n                handleClear={handleClear}\r\n                handleChange={handleChange}\r\n                handleSubmit={handleSubmit}\r\n                handleFocus={handleFocus}\r\n                handleBlur={handleBlur}\r\n                keepFocused={keepInputFocused}\r\n                setKeepFocused={setKeepInputFocused}\r\n                isFocused={focused}\r\n                suggestionProviders={suggestionProviders.current}\r\n                isSideBarRight={isSideBarRight}\r\n                isSearchingTerm={isSearchingTerm}\r\n                getFocus={getFocus}\r\n                searchTerms={searchTerms}\r\n                searchType={searchType}\r\n                clearSearchType={() => updateSearchType('')}\r\n            >\r\n                {!isMobileView && renderHintPopover()}\r\n            </SearchBar>\r\n        </>\r\n    );\r\n\r\n    // when inserted in RHSSearchNav component, just return SearchBar\r\n    if (!isSideBarRight) {\r\n        if (hideSearchBar) {\r\n            return (\r\n                <HeaderIconWrapper\r\n                    buttonId={'channelHeaderSearchButton'}\r\n                    onClick={searchButtonClick}\r\n                    tooltip={intl.formatMessage({id: 'channel_header.search', defaultMessage: 'Search'})}\r\n                >\r\n                    <SearchIcon\r\n                        className='icon icon--standard'\r\n                        aria-hidden='true'\r\n                    />\r\n                </HeaderIconWrapper>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div\r\n                id='searchbarContainer'\r\n                className={'search-bar-container--global'}\r\n            >\r\n                <div className='sidebar-right__table'>\r\n                    {renderSearchBar()}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className='sidebar--right__content'>\r\n            {!hideMobileSearchBarInRHS && (\r\n                <div className='search-bar__container channel-header alt'>\r\n                    <div className='sidebar-right__table'>\r\n                        {renderSearchBar()}\r\n                    </div>\r\n                </div>\r\n            )}\r\n            {searchVisible ? (\r\n                <SearchResults\r\n                    isMentionSearch={isMentionSearch}\r\n                    isFlaggedPosts={isFlaggedPosts}\r\n                    isPinnedPosts={isPinnedPosts}\r\n                    isChannelFiles={isChannelFiles}\r\n                    shrink={handleShrink}\r\n                    channelDisplayName={channelDisplayName}\r\n                    isOpened={isSideBarRightOpen}\r\n                    updateSearchTerms={handleAddSearchTerm}\r\n                    updateSearchTeam={handleUpdateSearchTeamFromResult}\r\n                    handleSearchHintSelection={handleSearchHintSelection}\r\n                    isSideBarExpanded={isRhsExpanded}\r\n                    getMorePostsForSearch={getMorePostsForSearchCallback}\r\n                    getMoreFilesForSearch={getMoreFilesForSearchCallback}\r\n                    setSearchFilterType={handleSetSearchFilter}\r\n                    searchFilterType={searchFilterType}\r\n                    setSearchType={(value: SearchType) => updateSearchType(value)}\r\n                    searchType={searchType || 'messages'}\r\n                    crossTeamSearchEnabled={crossTeamSearchEnabled}\r\n                />\r\n            ) : children}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default React.memo(Search);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {ServerError} from '@mattermost/types/errors';\r\n\r\nimport {getMorePostsForSearch, getMoreFilesForSearch} from 'mattermost-redux/actions/search';\r\nimport {getCurrentChannel} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getIsCrossTeamSearchEnabled} from 'mattermost-redux/selectors/entities/general';\r\n\r\nimport {autocompleteChannelsForSearch} from 'actions/channel_actions';\r\nimport {autocompleteUsersInCurrentTeam} from 'actions/user_actions';\r\nimport {\r\n    updateSearchTerms,\r\n    updateSearchTeam,\r\n    updateSearchTermsForShortcut,\r\n    showSearchResults,\r\n    showChannelFiles,\r\n    closeRightHandSide,\r\n    updateRhsState,\r\n    setRhsExpanded,\r\n    openRHSSearch,\r\n    filterFilesSearchByExt,\r\n    updateSearchType,\r\n} from 'actions/views/rhs';\r\nimport {getRhsState, getSearchTeam, getSearchTerms, getSearchType, getIsSearchingTerm, getIsRhsOpen, getIsRhsExpanded} from 'selectors/rhs';\r\nimport {getIsMobileView} from 'selectors/views/browser';\r\n\r\nimport {RHSStates} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport Search from './search';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const rhsState = getRhsState(state);\r\n    const currentChannel = getCurrentChannel(state);\r\n    const isMobileView = getIsMobileView(state);\r\n    const isRhsOpen = getIsRhsOpen(state);\r\n    const crossTeamSearchEnabled = getIsCrossTeamSearchEnabled(state);\r\n\r\n    return {\r\n        currentChannel,\r\n        isRhsExpanded: getIsRhsExpanded(state),\r\n        isSearchingTerm: getIsSearchingTerm(state),\r\n        searchTerms: getSearchTerms(state),\r\n        searchTeam: getSearchTeam(state),\r\n        searchType: getSearchType(state),\r\n        searchVisible: rhsState !== null && (![\r\n            RHSStates.PLUGIN,\r\n            RHSStates.CHANNEL_INFO,\r\n            RHSStates.CHANNEL_MEMBERS,\r\n            RHSStates.EDIT_HISTORY,\r\n        ].includes(rhsState)),\r\n        hideMobileSearchBarInRHS: isMobileView && isRhsOpen && rhsState === RHSStates.CHANNEL_INFO,\r\n        isMentionSearch: rhsState === RHSStates.MENTION,\r\n        isFlaggedPosts: rhsState === RHSStates.FLAG,\r\n        isPinnedPosts: rhsState === RHSStates.PIN,\r\n        isChannelFiles: rhsState === RHSStates.CHANNEL_FILES,\r\n        isMobileView,\r\n        crossTeamSearchEnabled,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    const autocompleteChannels = (term: string, teamId: string, success?: (channels: Channel[]) => void, error?: (err: ServerError) => void) => {\r\n        return autocompleteChannelsForSearch(term, success, error);\r\n    };\r\n\r\n    return {\r\n        actions: bindActionCreators({\r\n            updateSearchTerms,\r\n            updateSearchTeam,\r\n            updateSearchTermsForShortcut,\r\n            updateSearchType,\r\n            showSearchResults,\r\n            showChannelFiles,\r\n            setRhsExpanded,\r\n            closeRightHandSide,\r\n            autocompleteChannelsForSearch: autocompleteChannels,\r\n            autocompleteUsersInTeam: autocompleteUsersInCurrentTeam,\r\n            updateRhsState,\r\n            getMorePostsForSearch,\r\n            openRHSSearch,\r\n            getMoreFilesForSearch,\r\n            filterFilesSearchByExt,\r\n        }, dispatch),\r\n    };\r\n}\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Search);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback} from 'react';\r\nimport {useIntl} from 'react-intl';\r\nimport {useSelector} from 'react-redux';\r\n\r\nimport {getCurrentChannel} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport SearchResultsHeader from 'components/search_results_header';\r\n\r\nimport Pluggable from 'plugins/pluggable';\r\nimport {popoutRhsPlugin} from 'utils/popouts/popout_windows';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nexport type Props = {\r\n    showPluggable: boolean;\r\n    pluggableId: string;\r\n    title: React.ReactNode;\r\n    pluginId?: string;\r\n}\r\n\r\nconst RhsPlugin = ({showPluggable, pluggableId, title, pluginId}: Props) => {\r\n    const intl = useIntl();\r\n    const currentTeam = useSelector(getCurrentTeam);\r\n    const currentChannel = useSelector(getCurrentChannel);\r\n    const pluginDisplayName = useSelector((state: GlobalState) => (pluginId ? state.plugins.plugins[pluginId]?.name : undefined));\r\n\r\n    const newWindowHandler = useCallback(() => {\r\n        if (pluginId && currentTeam && currentChannel) {\r\n            popoutRhsPlugin(intl, pluginId, pluginDisplayName ?? pluginId, currentTeam.name, currentChannel.name);\r\n        }\r\n    }, [intl, pluginId, currentTeam, currentChannel, pluginDisplayName]);\r\n\r\n    return (\r\n        <div\r\n            id='rhsContainer'\r\n            className='sidebar-right__body'\r\n        >\r\n            <SearchResultsHeader newWindowHandler={newWindowHandler}>\r\n                {title}\r\n            </SearchResultsHeader>\r\n            {\r\n                showPluggable &&\r\n                <Pluggable\r\n                    pluggableName='RightHandSidebarComponent'\r\n                    pluggableId={pluggableId}\r\n                />\r\n            }\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default React.memo(RhsPlugin);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\n\r\nimport {getPluggableId} from 'selectors/rhs';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport RHSPlugin from './rhs_plugin';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const rhsPlugins = state.plugins.components.RightHandSidebarComponent;\r\n    const pluggableId = getPluggableId(state);\r\n    const pluginComponent = rhsPlugins.find((element) => element.id === pluggableId);\r\n    const pluginTitle = pluginComponent ? pluginComponent.title : '';\r\n    const pluginId = pluginComponent ? pluginComponent.pluginId : undefined;\r\n\r\n    return {\r\n        showPluggable: Boolean(pluginComponent),\r\n        pluggableId,\r\n        title: pluginTitle,\r\n        pluginId,\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps)(RHSPlugin);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {ProductIdentifier} from '@mattermost/types/products';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport ChannelInfoRhs from 'components/channel_info_rhs';\r\nimport ChannelMembersRhs from 'components/channel_members_rhs';\r\nimport FileUploadOverlay from 'components/file_upload_overlay';\r\nimport {DropOverlayIdRHS} from 'components/file_upload_overlay/file_upload_overlay';\r\nimport LoadingScreen from 'components/loading_screen';\r\nimport PostEditHistory from 'components/post_edit_history';\r\nimport ResizableRhs from 'components/resizable_sidebar/resizable_rhs';\r\nimport RhsCard from 'components/rhs_card';\r\nimport RhsThread from 'components/rhs_thread';\r\nimport Search from 'components/search/index';\r\n\r\nimport RhsPlugin from 'plugins/rhs_plugin';\r\nimport a11yController from 'utils/a11y_controller_instance';\r\nimport {focusElement, getFirstFocusableChild} from 'utils/a11y_utils';\r\nimport Constants from 'utils/constants';\r\nimport {cmdOrCtrlPressed, isKeyPressed} from 'utils/keyboard';\r\nimport {isMac} from 'utils/user_agent';\r\n\r\nimport type {RhsState} from 'types/store/rhs';\r\n\r\nexport type Props = {\r\n    isExpanded: boolean;\r\n    isOpen: boolean;\r\n    channel?: Channel;\r\n    team?: Team;\r\n    teamId: Team['id'];\r\n    productId: ProductIdentifier;\r\n    postRightVisible: boolean;\r\n    postCardVisible: boolean;\r\n    searchVisible: boolean;\r\n    isPinnedPosts: boolean;\r\n    isChannelFiles: boolean;\r\n    isChannelInfo: boolean;\r\n    isChannelMembers: boolean;\r\n    isPluginView: boolean;\r\n    isPostEditHistory: boolean;\r\n    previousRhsState: RhsState;\r\n    rhsChannel?: Channel;\r\n    selectedPostId: string;\r\n    selectedPostCardId: string;\r\n    isSavedPosts?: boolean;\r\n    isRecentMentions?: boolean;\r\n    ariaLabel?: string;\r\n    ariaLabeledby?: string;\r\n    actions: {\r\n        setRhsExpanded: (expanded: boolean) => void;\r\n        showPinnedPosts: (channelId: string) => void;\r\n        openRHSSearch: () => void;\r\n        closeRightHandSide: () => void;\r\n        openAtPrevious: (previous: Partial<Props> | undefined) => void;\r\n        updateSearchTerms: (terms: string) => void;\r\n        showChannelFiles: (channelId: string) => void;\r\n        showChannelInfo: (channelId: string) => void;\r\n    };\r\n}\r\n\r\ntype State = {\r\n    isOpened: boolean;\r\n}\r\n\r\nexport default class SidebarRight extends React.PureComponent<Props, State> {\r\n    sidebarRight: React.RefObject<HTMLDivElement>;\r\n    sidebarRightWidthHolder: React.RefObject<HTMLDivElement>;\r\n    previous: Partial<Props> | undefined = undefined;\r\n    focusSearchBar?: () => void;\r\n    private previousActiveElement: HTMLElement | null = null;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.sidebarRightWidthHolder = React.createRef<HTMLDivElement>();\r\n        this.sidebarRight = React.createRef<HTMLDivElement>();\r\n        this.state = {\r\n            isOpened: false,\r\n        };\r\n    }\r\n\r\n    setPrevious = () => {\r\n        if (!this.props.isOpen) {\r\n            return;\r\n        }\r\n\r\n        this.previous = {\r\n            searchVisible: this.props.searchVisible,\r\n            isPinnedPosts: this.props.isPinnedPosts,\r\n            isRecentMentions: this.props.isRecentMentions,\r\n            isSavedPosts: this.props.isSavedPosts,\r\n            isChannelFiles: this.props.isChannelFiles,\r\n            isChannelInfo: this.props.isChannelInfo,\r\n            isChannelMembers: this.props.isChannelMembers,\r\n            isPostEditHistory: this.props.isPostEditHistory,\r\n            selectedPostId: this.props.selectedPostId,\r\n            selectedPostCardId: this.props.selectedPostCardId,\r\n            previousRhsState: this.props.previousRhsState,\r\n        };\r\n    };\r\n\r\n    handleShortcut = (e: KeyboardEvent) => {\r\n        const channelInfoShortcutMac = isMac() && e.shiftKey;\r\n        const channelInfoShortcut = !isMac() && e.altKey;\r\n\r\n        if (cmdOrCtrlPressed(e, true)) {\r\n            if (e.shiftKey && isKeyPressed(e, Constants.KeyCodes.PERIOD)) {\r\n                e.preventDefault();\r\n                if (this.props.isOpen) {\r\n                    if (this.props.isExpanded) {\r\n                        this.props.actions.setRhsExpanded(false);\r\n                    } else {\r\n                        this.props.actions.setRhsExpanded(true);\r\n                    }\r\n                } else {\r\n                    this.props.actions.openAtPrevious(this.previous);\r\n                }\r\n            } else if (isKeyPressed(e, Constants.KeyCodes.PERIOD)) {\r\n                e.preventDefault();\r\n                if (this.props.isOpen) {\r\n                    this.props.actions.closeRightHandSide();\r\n                } else {\r\n                    this.props.actions.openAtPrevious(this.previous);\r\n                }\r\n            } else if (isKeyPressed(e, Constants.KeyCodes.I) && (channelInfoShortcutMac || channelInfoShortcut)) {\r\n                e.preventDefault();\r\n                if (this.props.isOpen && this.props.isChannelInfo) {\r\n                    this.props.actions.closeRightHandSide();\r\n                } else if (this.props.channel) {\r\n                    this.props.actions.showChannelInfo(this.props.channel.id);\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    handleRHSFocus(prevProps: Props) {\r\n        const wasOpen = prevProps.isOpen;\r\n        const isOpen = this.props.isOpen;\r\n\r\n        const contentChanged = (\r\n            (this.props.isPinnedPosts !== prevProps.isPinnedPosts) ||\r\n            (this.props.isRecentMentions !== prevProps.isRecentMentions) ||\r\n            (this.props.isSavedPosts !== prevProps.isSavedPosts) ||\r\n            (this.props.isChannelFiles !== prevProps.isChannelFiles) ||\r\n            (this.props.isChannelInfo !== prevProps.isChannelInfo) ||\r\n            (this.props.isChannelMembers !== prevProps.isChannelMembers) ||\r\n            (this.props.isPostEditHistory !== prevProps.isPostEditHistory) ||\r\n            (this.props.rhsChannel?.id !== prevProps.rhsChannel?.id) ||\r\n            (this.props.teamId !== prevProps.teamId)\r\n        );\r\n\r\n        if (this.props.isOpen && (contentChanged || (!wasOpen && isOpen))) {\r\n            this.previousActiveElement = document.activeElement as HTMLElement;\r\n\r\n            // For RHS with textbox, don't auto-focus the first element with this approach.\r\n            // The RHS textbox will focus itself via use_textbox_focus.tsx hook with correct focus logic.\r\n            if (this.props.postRightVisible) {\r\n                return;\r\n            }\r\n\r\n            // Focus the sidebar after a tick\r\n            setTimeout(() => {\r\n                if (this.sidebarRight.current) {\r\n                    const rhsContainer = this.sidebarRight.current.querySelector('#rhsContainer') as HTMLElement;\r\n                    const searchContainer = this.sidebarRight.current.querySelector('#searchContainer') as HTMLElement;\r\n                    if (rhsContainer || searchContainer) {\r\n                        const firstFocusable = getFirstFocusableChild(rhsContainer || searchContainer);\r\n                        focusElement(firstFocusable || rhsContainer, true);\r\n                    } else {\r\n                        // Fallback: if rhsContainer isn't found, use sidebarRight.current directly.\r\n                        const firstFocusable = getFirstFocusableChild(this.sidebarRight.current);\r\n                        focusElement(firstFocusable || this.sidebarRight.current, true);\r\n                    }\r\n                }\r\n            }, 0);\r\n        } else if (!this.props.isOpen && wasOpen) {\r\n            // RHS just was closed, restore focus to the previous element had it\r\n            if (a11yController.originElement) {\r\n                a11yController.restoreOriginFocus();\r\n            } else {\r\n                setTimeout(() => {\r\n                    if (this.previousActiveElement) {\r\n                        focusElement(this.previousActiveElement, true);\r\n                        this.previousActiveElement = null;\r\n                    }\r\n                }, 0);\r\n            }\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        document.addEventListener('keydown', this.handleShortcut);\r\n        document.addEventListener('mousedown', this.handleClickOutside);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        document.removeEventListener('keydown', this.handleShortcut);\r\n        document.removeEventListener('mousedown', this.handleClickOutside);\r\n    }\r\n\r\n    componentDidUpdate(prevProps: Props) {\r\n        this.handleRHSFocus(prevProps);\r\n\r\n        const {actions, isChannelFiles, isPinnedPosts, rhsChannel, channel} = this.props;\r\n        if (isPinnedPosts && prevProps.isPinnedPosts === isPinnedPosts && rhsChannel && rhsChannel.id !== prevProps.rhsChannel?.id) {\r\n            actions.showPinnedPosts(rhsChannel.id);\r\n        }\r\n\r\n        if (isChannelFiles && prevProps.isChannelFiles === isChannelFiles && rhsChannel && rhsChannel.id !== prevProps.rhsChannel?.id) {\r\n            actions.showChannelFiles(rhsChannel.id);\r\n        }\r\n\r\n        // in the case of navigating to another channel\r\n        // or from global threads to a channel\r\n        // we shrink the sidebar\r\n        if (\r\n            (channel && prevProps.channel && (channel.id !== prevProps.channel.id)) ||\r\n            (channel && !prevProps.channel)\r\n        ) {\r\n            this.props.actions.setRhsExpanded(false);\r\n        }\r\n\r\n        // close when changing products or teams\r\n        if (\r\n            (prevProps.teamId && this.props.teamId !== prevProps.teamId) ||\r\n            this.props.productId !== prevProps.productId\r\n        ) {\r\n            this.props.actions.closeRightHandSide();\r\n        }\r\n\r\n        this.setPrevious();\r\n    }\r\n\r\n    handleClickOutside = (e: MouseEvent) => {\r\n        if (\r\n            (this.props.isOpen && this.props.isExpanded) && // can be collapsed\r\n            e.target && // has target\r\n            document.getElementById('root')?.contains(e.target as Element) &&//  within Root\r\n            !this.sidebarRight.current?.contains(e.target as Element) && // not within RHS\r\n            !document.getElementById('global-header')?.contains(e.target as Element) && // not within Global Header\r\n            !document.querySelector('.app-bar')?.contains(e.target as Element) // not within App Bar\r\n        ) {\r\n            this.props.actions.setRhsExpanded(false);\r\n        }\r\n    };\r\n\r\n    handleUpdateSearchTerms = (term: string) => {\r\n        this.props.actions.updateSearchTerms(term);\r\n        this.focusSearchBar?.();\r\n    };\r\n\r\n    getSearchBarFocus = (focusSearchBar: () => void) => {\r\n        this.focusSearchBar = focusSearchBar;\r\n    };\r\n\r\n    render() {\r\n        const {\r\n            team,\r\n            channel,\r\n            rhsChannel,\r\n            postRightVisible,\r\n            postCardVisible,\r\n            previousRhsState,\r\n            searchVisible,\r\n            isPluginView,\r\n            isOpen,\r\n            isChannelInfo,\r\n            isChannelMembers,\r\n            isExpanded,\r\n            isPostEditHistory,\r\n        } = this.props;\r\n\r\n        if (!isOpen) {\r\n            return null;\r\n        }\r\n\r\n        const teamNeeded = true;\r\n        let selectedChannelNeeded;\r\n        let currentChannelNeeded;\r\n        let content = null;\r\n\r\n        if (postRightVisible) {\r\n            selectedChannelNeeded = true;\r\n            content = (\r\n                <div className='post-right__container'>\r\n                    <FileUploadOverlay\r\n                        overlayType='right'\r\n                        id={DropOverlayIdRHS}\r\n                    />\r\n                    <RhsThread previousRhsState={previousRhsState}/>\r\n                </div>\r\n            );\r\n        } else if (postCardVisible) {\r\n            content = <RhsCard previousRhsState={previousRhsState}/>;\r\n        } else if (isPluginView) {\r\n            content = <RhsPlugin/>;\r\n        } else if (isChannelInfo) {\r\n            currentChannelNeeded = true;\r\n            content = <ChannelInfoRhs/>;\r\n        } else if (isChannelMembers) {\r\n            currentChannelNeeded = true;\r\n            content = <ChannelMembersRhs/>;\r\n        } else if (isPostEditHistory) {\r\n            content = <PostEditHistory/>;\r\n        }\r\n\r\n        const isRHSLoading = Boolean(\r\n            (teamNeeded && !team) ||\r\n            (selectedChannelNeeded && !rhsChannel) ||\r\n            (currentChannelNeeded && !channel),\r\n        );\r\n\r\n        const channelDisplayName = rhsChannel ? rhsChannel.display_name : '';\r\n\r\n        const isSidebarRightExpanded = (postRightVisible || postCardVisible || isPluginView || searchVisible || isPostEditHistory) && isExpanded;\r\n        const containerClassName = classNames('sidebar--right', 'move--left is-open', {\r\n            'sidebar--right--expanded expanded': isSidebarRightExpanded,\r\n        });\r\n\r\n        return (\r\n            <>\r\n                <div\r\n                    className={'sidebar--right sidebar--right--width-holder'}\r\n                    ref={this.sidebarRightWidthHolder}\r\n                />\r\n                <ResizableRhs\r\n                    className={containerClassName}\r\n                    id='sidebar-right'\r\n                    role='region'\r\n                    rightWidthHolderRef={this.sidebarRightWidthHolder}\r\n                    ariaLabel={this.props.ariaLabel}\r\n                    ariaLabeledby={this.props.ariaLabeledby}\r\n                >\r\n                    <div\r\n                        tabIndex={-1}\r\n                        className='sidebar-right-container'\r\n                        ref={this.sidebarRight}\r\n                    >\r\n                        {isRHSLoading ? (\r\n                            <div className='sidebar-right__body'>\r\n                                {/* Sometimes the channel/team is not loaded yet, so we need to wait for it */}\r\n                                <LoadingScreen centered={true}/>\r\n                            </div>\r\n                        ) : (\r\n                            <Search\r\n                                isSideBarRight={true}\r\n                                isSideBarRightOpen={true}\r\n                                getFocus={this.getSearchBarFocus}\r\n                                channelDisplayName={channelDisplayName}\r\n                            >\r\n                                {content}\r\n                            </Search>\r\n                        )}\r\n                    </div>\r\n                </ResizableRhs>\r\n            </>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {withRouter} from 'react-router-dom';\r\nimport type {RouteComponentProps} from 'react-router-dom';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {getCurrentChannel} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport {setRhsExpanded, showChannelInfo, showPinnedPosts, showChannelFiles, openRHSSearch, closeRightHandSide, openAtPrevious, updateSearchTerms} from 'actions/views/rhs';\r\nimport {selectCurrentProductId} from 'selectors/products';\r\nimport {\r\n    getIsRhsExpanded,\r\n    getIsRhsOpen,\r\n    getRhsState,\r\n    getSelectedChannel,\r\n    getSelectedPostId,\r\n    getSelectedPostCardId,\r\n    getPreviousRhsState,\r\n} from 'selectors/rhs';\r\n\r\nimport {RHSStates} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport SidebarRight from './sidebar_right';\r\n\r\nfunction mapStateToProps(state: GlobalState, props: RouteComponentProps) {\r\n    const rhsState = getRhsState(state);\r\n    const channel = getCurrentChannel(state);\r\n    const team = getCurrentTeam(state);\r\n    const teamId = team?.id ?? '';\r\n    const productId = selectCurrentProductId(state, props.location.pathname);\r\n\r\n    const selectedPostId = getSelectedPostId(state);\r\n    const selectedPostCardId = getSelectedPostCardId(state);\r\n\r\n    return {\r\n        isExpanded: getIsRhsExpanded(state),\r\n        isOpen: getIsRhsOpen(state),\r\n        channel,\r\n        postRightVisible: Boolean(selectedPostId) && rhsState !== RHSStates.EDIT_HISTORY,\r\n        postCardVisible: Boolean(selectedPostCardId),\r\n        searchVisible: Boolean(rhsState) && rhsState !== RHSStates.PLUGIN,\r\n        previousRhsState: getPreviousRhsState(state),\r\n        isPinnedPosts: rhsState === RHSStates.PIN,\r\n        isChannelFiles: rhsState === RHSStates.CHANNEL_FILES,\r\n        isChannelInfo: rhsState === RHSStates.CHANNEL_INFO,\r\n        isChannelMembers: rhsState === RHSStates.CHANNEL_MEMBERS,\r\n        isPluginView: rhsState === RHSStates.PLUGIN,\r\n        isPostEditHistory: rhsState === RHSStates.EDIT_HISTORY,\r\n        isRecentMention: rhsState === RHSStates.MENTION,\r\n        isSavedPosts: rhsState === RHSStates.FLAG,\r\n        rhsChannel: getSelectedChannel(state),\r\n        selectedPostId,\r\n        selectedPostCardId,\r\n        team,\r\n        teamId,\r\n        productId,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            setRhsExpanded,\r\n            showPinnedPosts,\r\n            openRHSSearch,\r\n            closeRightHandSide,\r\n            openAtPrevious,\r\n            updateSearchTerms,\r\n            showChannelFiles,\r\n            showChannelInfo,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(SidebarRight));\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nexport default function SearchIcon(props: React.HTMLAttributes<HTMLSpanElement>) {\r\n    const {formatMessage} = useIntl();\r\n    return (\r\n        <span {...props}>\r\n            <svg\r\n                width='16px'\r\n                height='16px'\r\n                viewBox='0 0 17 17'\r\n                role='img'\r\n                aria-label={formatMessage({id: 'generic_icons.search', defaultMessage: 'Search Icon'})}\r\n            >\r\n                <path d='M16.398 15.138L13.014 11.754C13.458 11.178 13.8 10.548 14.04 9.86399C14.28 9.14399 14.4 8.40599 14.4 7.64999C14.4 6.42599 14.094 5.29199 13.482 4.24799C12.882 3.22799 12.072 2.41799 11.052 1.81799C10.008 1.20599 8.874 0.899988 7.65 0.899988C6.426 0.899988 5.292 1.20599 4.248 1.81799C3.228 2.41799 2.418 3.22799 1.818 4.24799C1.206 5.29199 0.9 6.42599 0.9 7.64999C0.9 8.87399 1.206 10.008 1.818 11.052C2.418 12.072 3.228 12.882 4.248 13.482C5.292 14.094 6.426 14.4 7.65 14.4C8.406 14.4 9.138 14.274 9.846 14.022C10.53 13.794 11.16 13.458 11.736 13.014L15.138 16.398C15.306 16.566 15.516 16.65 15.768 16.65C16.02 16.65 16.23 16.56 16.398 16.38C16.566 16.212 16.65 16.008 16.65 15.768C16.65 15.528 16.566 15.318 16.398 15.138ZM2.7 7.64999C2.7 6.74999 2.922 5.92199 3.366 5.16599C3.81 4.40999 4.41 3.80999 5.166 3.36599C5.922 2.92199 6.75 2.69999 7.65 2.69999C8.55 2.69999 9.378 2.92199 10.134 3.36599C10.89 3.80999 11.49 4.40999 11.934 5.16599C12.378 5.92199 12.6 6.74999 12.6 7.64999C12.6 8.54999 12.378 9.37799 11.934 10.134C11.49 10.89 10.89 11.49 10.134 11.934C9.378 12.378 8.55 12.6 7.65 12.6C6.75 12.6 5.922 12.378 5.166 11.934C4.41 11.49 3.81 10.89 3.366 10.134C2.922 9.37799 2.7 8.54999 2.7 7.64999Z'/>\r\n            </svg>\r\n        </span>\r\n    );\r\n}\r\n"],"names":["NewChannelWithBoardTourTip","_ref","pulsatingDotPlacement","pulsatingDotTranslate","dispatch","useDispatch","showTip","useSelector","showNewChannelWithBoardPulsatingDot","title","React","FormattedMessage","id","defaultMessage","screen","tipOpened","setTipOpened","useState","handleDismiss","useCallback","e","stopPropagation","setNewChannelWithBoardPreference","Preferences","NEW_CHANNEL_WITH_BOARD_TOUR_SHOWED","handleOpen","preventDefault","overlayPunchOut","useMeasurePunchouts","y","height","x","width","TourTip","show","placement","step","singleTip","showOptOut","interactivePunchOut","handlePrevious","offset","propTypes","_pt","isRequired","HeaderIconWrapper","props","ariaLabelOverride","buttonClass","buttonId","children","onClick","tooltip","tooltipText","tooltipShortcut","isRhsOpen","pluginId","boardsEnabled","suitePluginIds","focalboard","ariaLabelText","WithTooltip","shortcut","className","DEFAULT_COPY_TIMEOUT","useCopyText","text","successCopyTimeout","successCopyTimeoutReceived","copiedRecently","setCopiedRecently","copyError","setCopyError","timerRef","useRef","current","clearTimeout","clipboard","navigator","writeText","then","catch","textField","document","createElement","innerText","style","position","opacity","body","appendChild","select","success","execCommand","err","remove","setTimeout","messages","defineMessages","copy","copied","AlertSvg","toString","viewBox","fill","xmlns","rx","fillOpacity","d","stroke","strokeOpacity","strokeWidth","strokeLinecap","PopoutButton","intl","useIntl","canPopout","type","classNames","formatMessage","SearchResultsHeader","showExpand","previousRhsState","RHSStates","CHANNEL_INFO","sidebarTooltipContent","isExpanded","KeyboardShortcutSequence","KEYBOARD_SHORTCUTS","navExpandSidebar","hideDescription","isInsideTooltip","expandOrCollapseSidebarButtonAriaLabel","canGoBack","actions","goBack","isPopoutWindow","toggleRhsExpanded","newWindowHandler","closeRightHandSide","connect","state","getPreviousRhsState","CHANNEL_MEMBERS","CHANNEL_FILES","PIN","getIsRhsExpanded","channelId","getCurrentChannelId","bindActionCreators","EditButton","styled","withConfig","displayName","EmptyPlace","EditableAreaBase","editable","content","emptyLabel","onEdit","allowEditArea","LineLimiterBase","maxLines","lineHeight","moreText","lessText","errorMargin","maxLineHeight","needLimiter","setNeedLimiter","open","setOpen","maxHeight","setMaxHeight","ref","useEffect","contentHeight","scrollHeight","concat","CSSTransition","in","timeout","ToggleButton","ChannelId","ChannelPurpose","ChannelDescriptionHeading","ChannelHeader","AboutAreaChannel","channel","canEditChannelProperties","purpose","EditableArea","LineLimiter","Markdown","message","editChannelPurpose","header","editChannelHeader","Username","UserInfoContainer","UserAvatar","UserInfo","UsernameContainer","UserPosition","AboutAreaDM","dmUser","ProfilePicture","src","Client4","getProfilePictureUrl","user","last_picture_update","isBot","is_bot","status","undefined","username","display_name","userId","size","BotTag","is_guest","GuestTag","bot_description","Usernames","ProfilePictures","ProfilePictureContainer","UsersArea","AboutAreaGM","gmUsers","map","idx","key","i","_ref2","length","UserProfileElement","Container","AboutArea","Constants","DM_CHANNEL","GM_CHANNEL","OPEN_CHANNEL","PRIVATE_CHANNEL","includes","Icon","HeaderTitle","Header","isArchived","isMobile","onClose","MenuContainer","MenuItemButton","MenuItemText","RightSide","Badge","MenuItem","icon","opensSubpanel","badge","hasRightSide","Menu","channelStats","loadingStats","setLoadingStats","showNotificationPreferences","showMembers","fileCount","files_count","getChannelStats","openNotificationSettings","member_count","showChannelMembers","pinnedpost_count","showPinnedPosts","LoadingSpinner","showChannelFiles","ChannelInfoRhsTopButtons","Button","CopyButton","TopButtons","channelType","channelURL","isFavorite","isMuted","isInvitingPeople","canAddPeople","propsCanAddPeople","copyLink","canCopyLink","favoriteIcon","favoriteText","mutedIcon","mutedText","copyIcon","copyText","toggleFavorite","toggleMute","addPeople","Divider","ChannelInfoRhs","currentTeam","currentUser","channelMembers","canManageMembers","canManageProperties","currentUserId","getSiteURL","name","filter","unfavoriteChannel","favoriteChannel","unmuteChannel","muteChannel","openModal","modalId","ModalIdentifiers","CREATE_DM_CHANNEL","dialogType","MoreDirectChannels","dialogProps","isExistingChannel","focusOriginElement","CHANNEL_INVITE","ChannelInviteModal","EDIT_CHANNEL_HEADER","EditChannelHeaderModal","EDIT_CHANNEL_PURPOSE","EditChannelPurposeModal","CHANNEL_NOTIFICATIONS","ChannelNotificationsModal","memo","EMPTY_CHANNEL_STATS","guest_count","getCurrentChannel","getCurrentUser","getCurrentTeam","getCurrentChannelStats","isCurrentChannelArchived","isCurrentChannelFavorite","isCurrentChannelMuted","isModalOpen","getIsMobileView","isPrivate","haveIChannelPermission","Permissions","MANAGE_PRIVATE_CHANNEL_MEMBERS","MANAGE_PUBLIC_CHANNEL_MEMBERS","MANAGE_PRIVATE_CHANNEL_PROPERTIES","MANAGE_PUBLIC_CHANNEL_PROPERTIES","getProfilesInCurrentChannel","getUser","getUserIdFromChannelId","getDisplayNameByUser","isGuest","roles","getStatusForUserId","RHS","Title","Actions","ButtonIcon","ActionBar","membersCount","editing","showManageButton","handleShortcut","isKeyPressed","KeyCodes","ESCAPE","stopEditing","addEventListener","removeEventListener","values","members_count","startEditing","inviteMembers","SearchBar","terms","onInput","inputSuffix","Input","value","currentTarget","inputPrefix","placeholder","useLegend","ChannelMembersRHS","currentUserIsChannelAdmin","searchTerms","teamUrl","history","useHistory","list","setList","page","setPage","isNextPageLoading","setIsNextPageLoading","structuredAttributes","loading","useAccessControlAttributes","EntityType","Channel","policy_enforced","searching","isDefaultChannel","DEFAULT_CHANNEL","showSearch","setChannelMembersRhsSearchTerm","listcp","memberDone","_member$membership2","member","_member$membership","membership","scheme_admin","push","ListItemType","FirstSeparator","data","Separator","Member","JSON","stringify","rhsAction","loadProfilesAndReloadChannelMembers","ProfilesInChannelSortBy","Admin","loadMyChannelMemberAndRole","doSearch","debounce","async","searchProfilesAndChannelMembers","in_team_id","team_id","in_channel_id","SEARCH_TIMEOUT_MILLISECONDS","openDirectMessage","openDirectChannelToUserId","loadMore","AlertBanner","mode","variant","TagGroup","flatMap","attribute","AlertTag","tooltipTitle","replace","txt","charAt","toUpperCase","substring","toLowerCase","setEditChannelMembers","link","msg","ExternalLink","href","location","MemberList","members","fetchRemoteClusterInfo","hasNextPage","buildProfileList","profilesInCurrentChannel","userStatuses","teammateNameDisplaySetting","membersInCurrentChannel","forEach","profile","remoteDisplayName","remote_id","getRemoteDisplayName","displayUsername","sort","a","b","_a$membership","_b$membership","_a$membership2","localeCompare","getProfiles","createSelector","getActiveProfilesInCurrentChannelWithoutSorting","getUserStatuses","getTeammateNameDisplaySetting","getMembersInCurrentChannel","searchProfiles","search","searchActiveProfilesInCurrentChannel","getMyCurrentChannelMembership","channelAdmins","views","channelMembersRhsSearch","trim","getCurrentRelativeTeamUrl","prevRhsState","hasInfoPrevState","Boolean","getIsEditingMembers","InfoToast","onExited","closeToast","undoTodo","_content$undo","undo","call","toastContainerClassname","timer","mountOnEnter","unmountOnExit","appear","modalMessages","titleQuestion","RestorePostModal","post","postHeader","onHide","modalHeaderText","GenericModal","compassDesign","enforceFocus","handleCancel","cancelButtonClassName","handleConfirm","handleRestore","PostMessageView","overflowType","showPostEditedIndicator","FileAttachmentListContainer","isEditHistory","disableDownload","disableActions","DATE_RANGES","RelativeRanges","itemMessages","helpText","currentVersionText","ariaLabelMessage","EditedPostItem","_post$props","isCurrent","postCurrentVersion","connectionId","getConnectionId","openRestorePostModal","restorePostModalData","RESTORE_POST_MODAL","restorePostVersion","original_id","showInfoTooltip","infoToastModalData","INFO_TOAST","CheckIcon","handleUndo","StoragePrefixes","EDIT_DRAFT","removeDraft","channel_id","root_id","result","getPostEditHistory","previousPostVersion","currentVersionIndicator","profileSrc","imageURLForUser","user_id","overwriteName","ensureString","override_username","Avatar","url","UserProfileComponent","disablePopover","PostMessageContainer","isRHS","isFileDeleted","delete_at","messageContainer","restoreButton","postContainerClass","timeStampValue","edit_at","create_at","togglePost","prevState","PostAriaLabelDiv","Timestamp","ranges","selectedPostId","getSelectedPostId","getPost","editPost","PostEditHistory","channelDisplayName","originalPost","postEditHistory","setPostEditHistory","hasError","setHasError","isLoading","setIsLoading","scrollbars","retrieveErrorHeading","retrieveErrorSubheading","_scrollbars$current","fetchPostEditHistory","scrollTo","top","errorContainer","AlertIcon","LoadingScreen","display","placeContent","flex","postEditItems","postEdited","Scrollbars","_getCurrentChannel","getChannel","ResizableRhs","role","rightWidthHolderRef","ariaLabel","ariaLabeledby","containerRef","rhsSize","getRhsSize","isRhsExpanded","previousRhsExpanded","setPreviousRhsExpanded","defaultWidth","RHS_MIN_MAX_WIDTH","default","shouldRhsOverlap","shouldRhsOverlapChannelView","handleResizeEnd","_","cssVarProp","rightWidthHolderRefElement","removeProperty","containerRefElement","classList","add","ResizableDivider","globalCssVar","CssVarKeyForResizable","dir","ResizeDirection","RIGHT","disabled","onResize","handleResize","cssVarValue","setProperty","onResizeEnd","onDividerDoubleClick","handleDividerDoubleClick","RhsCardHeader","constructor","arguments","_defineProperty","this","SEARCH","showSearchResults","MENTION","showMentions","FLAG","showFlaggedPosts","render","back","expandSidebarTooltip","shrinkSidebarTooltip","handleBack","collapseIconLabel","expandIconLabel","injectIntl","RhsCard","super","isScrolling","setState","scrollStopAction","fireAfter","SCROLL_DELAY","isMobileView","emitCloseRightHandSide","DelayedAction","handleScrollStop","shouldComponentUpdate","nextProps","nextState","_nextProps$selected","_nextProps$selected$p","_this$props$selected","_this$props$selected$","deepEqual","selected","card","pluginPostCardTypes","postType","Object","hasOwn","PluginComponent","component","_selected$props","UserProfile","hideStatus","overrideUsername","enablePostUsernameOverride","avatar","PostProfilePicture","compactDisplay","onScroll","handleScroll","Link","to","handleClick","getSelectedPostCard","getConfig","EnablePostUsernameOverride","plugins","postCardTypes","RhsHeaderPost","setRhsExpanded","relativeTeamUrl","getHistory","rootPostId","isFollowingThread","setThreadFollow","focusPost","popoutThread","postId","returnTo","skipRedirectReplyPermalink","closeSidebarTooltip","backToResultsTooltip","rhsHeaderTooltipContent","channelName","handleJumpClick","isCollapsedThreadsEnabled","FollowButton","isFollowing","handleFollowChange","popout","getThreadOrSynthetic","makeGetThreadOrSynthetic","collapsedThreads","root","getCurrentUserId","thread","is_following","reply_count","currentUserMentionKeys","getCurrentUserMentionKeys","rootMessageMentionKeys","allAtMentions","matchUserMentionTriggersWithMessageMentions","RhsThread","ThreadViewer","useRelativeTimestamp","isThreadView","getSelectedPost","getSelectedChannel","SizeMap","xs","sm","md","lg","Popover","popoverSize","popoverStyle","onMouseOut","onMouseOver","BSPopover","bsStyle","bsClass","bsSize","SearchSuggestionList","SuggestionList","_this$itemsContainerR","_this$itemsContainerR2","itemsContainerRef","parentNode","popoverRef","hasResults","results","SuggestionListContents","selectedTerm","selection","getItemId","term","onItemClick","onCompleteWord","onItemHover","SuggestionDate","matchedPretext","preventClose","handleEscape","ungroupedResults","item","items","Component","components","isSelection","searchForm","overflow","isFocused","keepFocused","suggestionProviders","searchRef","_searchRef$current","focus","_searchRef$current2","blur","endsWith","_searchRef$current3","isSideBarRight","onSubmit","handleSubmit","autoComplete","searchType","onMouseDown","handleFocus","setKeepFocused","clearSearchType","SuggestionBox","node","getFocus","tabIndex","containerClass","onFocus","onBlur","handleBlur","onChange","handleChange","onKeyDown","_searchRef$current4","Keyboard","DOWN","updateHighlightedSearchHint","UP","ENTER","handleEnterKey","BACKSPACE","listComponent","dateComponent","providers","delayInputUpdate","clearable","onClear","handleClear","isSearchingTerm","SearchHint","config","isFileAttachmentEnabled","isFileAttachmentsEnabled","onSearchTypeSelected","chunks","highlighted","highlightedIndex","onElementBlur","onElementFocus","withTitle","onTouchEnd","options","option","optionIndex","searchTerm","onOptionSelected","onOptionHover","handleOnOptionHover","additionalDisplay","FILE_TOOLTIP_RANGES","FileSearchResultItem","teamName","fileInfo","post_id","copyToClipboard","keepOpen","_this$props$pluginMen","enableSharedChannelsPlugins","shared","pluginItems","pluginMenuItems","match","ItemAction","_item$action","action","FILE_PREVIEW_MODAL","FilePreviewModal","fileInfos","startIndex","showPreview","FileThumbnail","Tag","fileSizeToString","defineMessage","MenuWrapper","onToggle","stopPropagationOnToggle","openLeft","jumpToConv","localizeMessage","renderPluginItems","getFileDownloadUrl","ownProps","getFeatureFlagValue","FilesFilterMenu","IconContainer","selectedFilter","FilterVariantIcon","color","onFilter","MessagesOrFilesSelector","searchTeam","getSearchTeam","hasMoreThanOneTeam","getMyTeams","messagesTabRef","filesTabRef","handleTabKeyDown","currentTab","LEFT","nextTab","nextTabRef","DataSearchTypes","MESSAGES_SEARCH_TYPE","FILES_SEARCH_TYPE","dispatchEvent","CustomEvent","A11yCustomEventTypes","FOCUS","detail","target","keyboardOnly","messagesCounter","filesCounter","crossTeamSearchEnabled","SelectTeam","selectedTeamId","onTeamSelected","onTeamChange","PostSearchResultsItem","PostComponent","matches","isFlaggedPosts","isPinnedPosts","isMentionSearch","a11yIndex","Locations","SearchLimitsBanner","serverLimits","useGetServerLimits","searchTruncated","isSearchTruncated","isShowingSearchResults","getRhsState","postHistoryLimit","CenterMessageLock","SearchResults","setSearchType","filesDropdownPluginMenuItems","getFilesDropdownPluginMenuItems","searchFilterType","setSearchFilterType","searchSelectedType","searchPage","isChannelFiles","getMorePostsForSearch","getMoreFilesForSearch","loadMorePosts","loadMoreFiles","fileResults","isCard","isSearchAtEnd","isSearchFilesAtEnd","isSearchingFlaggedPost","isSearchingPinnedPost","isSideBarExpanded","isOpened","updateSearchTerms","handleSearchHintSelection","noResults","Array","isArray","noFileResults","showLoadMore","isMessagesSearch","contentItems","loadingMorePostsComponent","titleDescriptor","sortedResults","noResultsProps","NoResultsVariant","ChannelSearch","Mentions","FlaggedPosts","subtitleValues","buttonText","PinnedPosts","ChannelFiles","ChannelFilesFiltered","titleValues","Files","formattedTitle","handleOptionSelection","LoadingWrapper","searchHintOptions","NoResultsIndicator","assign","padding","index","isDateLine","date","getDateForDateLine","DateSeparator","currentTeamName","MessageOrFileSelector","teamId","updateSearchTeam","isSearchGettingMore","_scrollbars$current2","_scrollbars$current3","_scrollbars$current4","scrollTop","clientHeight","regionTitle","arePropsEqual","nextResults","nextFileResults","files","addDateSeparatorsForSearchResults","makeAddDateSeparatorsForSearchResults","_getCurrentTeam$name","_getCurrentTeam","_currentSearch$params","newResults","getSearchResults","postA","postB","newFilesResults","getSearchFilesResults","file","currentSearch","getCurrentSearchForSearchTeam","getSearchMatches","getSearchResultsTerms","getSearchResultsType","getIsSearchingTerm","getIsSearchingFlaggedPost","getIsSearchingPinnedPost","getIsSearchGettingMore","isEnd","isFilesEnd","params","determineVisibleSearchHintOptions","newVisibleSearchHintOptions","searchFilesHintOptions","pretextArray","split","pretext","penultimatePretext","shouldShowHintOptions","some","RegExp","test","_unused","Search","_ref3","autocompleteChannelsForSearch","autocompleteUsersInTeam","filterFilesSearchByExt","openRHSSearch","updateRhsState","updateSearchTermsForShortcut","updateSearchType","hideMobileSearchBarInRHS","searchVisible","currentChannel","enableFindShortcut","hideSearchBar","isSideBarRightOpen","currentChannelName","getCurrentChannelNameForSearchShortcut","focused","setFocused","dropdownFocused","setDropdownFocused","keepInputFocused","setKeepInputFocused","indexChangedViaKeyPress","setIndexChangedViaKeyPress","highlightedSearchHintIndex","setHighlightedSearchHintIndex","visibleSearchHintOptions","setVisibleSearchHintOptions","SearchDateProvider","SearchChannelProvider","SearchUserProvider","isDesktop","isDesktopApp","isServerVersionGreaterThanOrEqualTo","getDesktopVersion","handleKeyDown","F","shiftKey","isMacApp","ctrlKey","getMorePostsForSearchCallback","team","getMoreFilesForSearchCallback","handleClose","handleDropdownBlur","handleDropdownFocus","handleAddSearchTerm","pop","handleUpdateSearchTerms","join","handleOnSearchTypeSelected","indexDelta","changedViaKeyPress","Math","abs","newIndex","handleSearch","error","handleSearchOnSuccess","setHoverHintIndex","_highlightedSearchHintIndex","renderSearchBar","renderHintPopover","termsUsed","word","_ref4","helpClass","shrink","handleShrink","newTerms","filterType","SearchIcon","rhsState","getIsRhsOpen","getIsCrossTeamSearchEnabled","getSearchTerms","getSearchType","PLUGIN","EDIT_HISTORY","autocompleteChannels","autocompleteUsersInCurrentTeam","RhsPlugin","showPluggable","pluggableId","pluginDisplayName","_state$plugins$plugin","popoutRhsPlugin","Pluggable","pluggableName","rhsPlugins","RightHandSidebarComponent","getPluggableId","pluginComponent","find","element","pluginTitle","RHSPlugin","SidebarRight","isOpen","previous","isRecentMentions","isSavedPosts","isChannelInfo","isChannelMembers","isPostEditHistory","selectedPostCardId","channelInfoShortcutMac","isMac","channelInfoShortcut","altKey","cmdOrCtrlPressed","PERIOD","openAtPrevious","I","showChannelInfo","_document$getElementB","_this$sidebarRight$cu","_document$getElementB2","_document$querySelect","getElementById","contains","sidebarRight","querySelector","_this$focusSearchBar","focusSearchBar","sidebarRightWidthHolder","handleRHSFocus","prevProps","_this$props$rhsChanne","_prevProps$rhsChannel","wasOpen","contentChanged","rhsChannel","previousActiveElement","activeElement","postRightVisible","rhsContainer","searchContainer","firstFocusable","getFirstFocusableChild","focusElement","a11yController","originElement","restoreOriginFocus","componentDidMount","handleClickOutside","componentWillUnmount","componentDidUpdate","_prevProps$rhsChannel2","_prevProps$rhsChannel3","productId","setPrevious","postCardVisible","isPluginView","selectedChannelNeeded","currentChannelNeeded","FileUploadOverlay","overlayType","DropOverlayIdRHS","ChannelMembersRhs","isRHSLoading","isSidebarRightExpanded","containerClassName","centered","getSearchBarFocus","withRouter","_team$id","selectCurrentProductId","pathname","getSelectedPostCardId","isRecentMention"],"sourceRoot":""}