"use strict";(self.webpackChunkmattermost_webapp=self.webpackChunkmattermost_webapp||[]).push([[2794],{22794:(e,t,n)=>{n.r(t),n.d(t,{default:()=>un});var r=n(36418),a=n.n(r),s=n(37270),o=n(3569),l=n(77440),i=n(73969),c=n(7430),d=n(79342),u=n(62844),m=n(2386),p=n(67173),f=n(62688),h=n.n(f),g=n(14778),E=n(63669);const y=a().createElement("svg",{width:"142",height:"80",viewBox:"0 0 142 80",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a().createElement("g",{clipPath:"url(#clip0_4212_90546)"},a().createElement("rect",{x:"15.0059",y:"15",width:"112",height:"44",rx:"3",fill:"var(--button-bg)",fillOpacity:"0.12"}),a().createElement("path",{d:"M28.0059 34L28.0059 52L39.0059 52",stroke:"var(--center-channel-color)",strokeOpacity:"0.8",strokeLinecap:"round",strokeLinejoin:"round"}),a().createElement("path",{d:"M28.0059 31L28.0059 26",stroke:"var(--center-channel-color)",strokeOpacity:"0.8",strokeLinecap:"round",strokeLinejoin:"round"}),a().createElement("path",{d:"M28.0059 23L28.0059 21",stroke:"var(--center-channel-color)",strokeOpacity:"0.8",strokeLinecap:"round",strokeLinejoin:"round"}),a().createElement("path",{d:"M54.6108 67.5638L41.0059 81V12C41.0059 10.8954 41.9013 10 43.0059 10H109.006C110.11 10 111.006 10.8954 111.006 12V64.9868C111.006 66.0914 110.11 66.9868 109.006 66.9868H56.0162C55.4901 66.9868 54.9851 67.1941 54.6108 67.5638Z",fill:"#28427B"}),a().createElement("path",{d:"M49.6108 62.5638L36.0059 76V7C36.0059 5.89543 36.9013 5 38.0059 5H104.006C105.11 5 106.006 5.89543 106.006 7V59.9868C106.006 61.0914 105.11 61.9868 104.006 61.9868H51.0162C50.4901 61.9868 49.9851 62.1941 49.6108 62.5638Z",fill:"var(--center-channel-bg)"}),a().createElement("path",{d:"M49.2595 62.2081L36.5059 74.8035V7C36.5059 6.17157 37.1774 5.5 38.0059 5.5H104.006C104.834 5.5 105.506 6.17157 105.506 7V59.9868C105.506 60.8153 104.834 61.4868 104.006 61.4868H51.0162C50.3585 61.4868 49.7274 61.746 49.2595 62.2081Z",stroke:"var(--center-channel-color)",strokeOpacity:"0.8"}),a().createElement("circle",{cx:"54.0059",cy:"24",r:"9",fill:"var(--center-channel-color)",fillOpacity:"0.32"}),a().createElement("path",{d:"M69.0059 20H85.0059",stroke:"var(--center-channel-color)",strokeOpacity:"0.48",strokeLinecap:"round"}),a().createElement("path",{d:"M46.0059 44H96.0059",stroke:"var(--center-channel-color)",strokeOpacity:"0.48",strokeLinecap:"round"}),a().createElement("path",{d:"M46.0059 51H68.0059",stroke:"var(--center-channel-color)",strokeOpacity:"0.48",strokeLinecap:"round"}),a().createElement("path",{d:"M69.0059 26H94.0059",stroke:"var(--center-channel-color)",strokeOpacity:"0.48",strokeLinecap:"round"}),a().createElement("path",{d:"M46.0059 38H63.0059",stroke:"var(--center-channel-color)",strokeOpacity:"0.48",strokeLinecap:"round"}),a().createElement("path",{d:"M67.0059 38H85.0059",stroke:"var(--center-channel-color)",strokeOpacity:"0.48",strokeLinecap:"round"}),a().createElement("rect",{x:"115.199",y:"45.0278",width:"12.4524",height:"6.22619",transform:"rotate(-135 115.199 45.0278)",fill:"var(--center-channel-bg)",stroke:"var(--center-channel-color)",strokeOpacity:"0.8"}),a().createElement("path",{d:"M117.952 42.2764L109.147 33.4712L113.787 28.8319C114.568 28.0508 115.834 28.0508 116.615 28.8319L122.592 34.8086C123.373 35.5897 123.373 36.856 122.592 37.637L117.952 42.2764Z",fill:"var(--center-channel-color)",fillOpacity:"0.32",stroke:"var(--center-channel-color)",strokeOpacity:"0.8"}),a().createElement("path",{d:"M89.3356 70.8933L80.5305 62.0882L106.946 35.6727L115.751 44.4778L89.3356 70.8933Z",fill:"var(--center-channel-bg)",stroke:"var(--center-channel-color)",strokeOpacity:"0.8",strokeLinejoin:"round"}),a().createElement("path",{d:"M73.1016 78.8725L80.5309 62.0876L89.3361 70.8928L73.1016 78.8725Z",fill:"var(--center-channel-bg)",stroke:"var(--center-channel-color)",strokeOpacity:"0.8",strokeLinejoin:"round"}),a().createElement("path",{d:"M78.3289 76.3964L75.4492 77.9756C74.5896 78.447 73.6355 77.5284 74.0739 76.6516L75.5773 73.6448L78.3289 76.3964Z",fill:"var(--center-channel-color)",fillOpacity:"0.8"}),a().createElement("line",{x1:"82.8065",y1:"64.4976",x2:"109.377",y2:"37.9268",stroke:"var(--center-channel-color)",strokeOpacity:"0.32"}),a().createElement("line",{x1:"86.6825",y1:"68.3725",x2:"113.253",y2:"41.8017",stroke:"var(--center-channel-color)",strokeOpacity:"0.32"})),a().createElement("defs",null,a().createElement("clipPath",{id:"clip0_4212_90546"},a().createElement("rect",{width:"142",height:"80",fill:"var(--center-channel-bg)",transform:"translate(0.00585938)"}))));function _(){const{formatMessage:e}=(0,g.useIntl)();return a().createElement("div",{className:"DraftList Drafts__main"},a().createElement(E.A,{expanded:!0,iconGraphic:y,title:e({id:"drafts.empty.title",defaultMessage:"No drafts at the moment"}),subtitle:e({id:"drafts.empty.subtitle",defaultMessage:"Any messages you’ve started will show here."})}))}n(17046);var v=n(71633),b=n.n(v),C=n(46177),M=n.n(C),N=n(52445),k=n(68789),S=(n(83931),n(43813),n(4290),n(75114)),R=n.n(S),T=n(81911),O=n(34574),P=n(65642),D=n(57898),I=n(55848),w=n(65952),A=n(26614),x=n(52729),L=n(80635),q=n(14776),H=n(62563),j=n(26241),F=n(76497),B=n(21413),U=n(8523),V=n(90661),z=n(95544),K=n(42689),Y=n.n(K),G=n(30413),Z=n(90239),W=n(79751),Q=n(7395),J=n(87131);function X(e){let{name:t,icon:n,onClick:r,id:s,tooltipText:o}=e;return a().createElement("div",{className:"DraftAction"},a().createElement(J.A,{title:o,id:"draft_tooltip_".concat(s)},a().createElement("button",{className:b()("DraftAction__button",{"DraftAction__button--delete":"delete"===t}),id:"draft_".concat(n,"_").concat(s),onClick:r,"aria-labelledby":"draft_tooltip_".concat(s)},a().createElement("i",{className:b()("icon",n)}))))}X.propTypes={icon:h().string.isRequired,id:h().string.isRequired,name:h().string.isRequired,onClick:h().func.isRequired,tooltipText:h().oneOfType([h().element,h().string]).isRequired};const $=X;var ee=n(14696);function te(e){let{channelDisplayName:t,onExited:n,onConfirm:s}=e;const{formatMessage:o}=(0,g.useIntl)(),[l,i]=(0,r.useState)(),c=o({id:"scheduled_post.delete_modal.title",defaultMessage:"Delete scheduled post"}),d=o({id:"drafts.confirm.delete.button",defaultMessage:"Yes, delete"}),u=(0,r.useCallback)((async()=>{const e=await s();e.error?i(e.error):n()}),[s,n]);return a().createElement(ee.zW,{className:"delete_scheduled_post_modal",confirmButtonText:d,handleCancel:R(),handleConfirm:u,modalHeaderText:c,onExited:n,compassDesign:!0,isDeleteModal:!0,autoFocusConfirmButton:!0,autoCloseOnConfirmButton:!1,errorText:l},t&&a().createElement(g.FormattedMessage,{id:"scheduled_post.delete_modal.body",defaultMessage:"Are you sure you want to delete this scheduled post to <strong>{displayName}</strong>?",values:{strong:e=>a().createElement("strong",null,e),displayName:t}}),!t&&a().createElement(g.FormattedMessage,{id:"scheduled_post.delete_modal.body_no_channel",defaultMessage:"Are you sure you want to delete this scheduled post?"}))}function ne(e){let{displayName:t,onConfirm:n,onExited:r}=e;const{formatMessage:s}=(0,g.useIntl)(),o=s({id:"drafts.confirm.send.title",defaultMessage:"Send message now"}),l=s({id:"drafts.confirm.send.button",defaultMessage:"Yes, send now"}),i=a().createElement(g.FormattedMessage,{id:"drafts.confirm.send.text",defaultMessage:"Are you sure you want to send this message to <strong>{displayName}</strong>?",values:{strong:e=>a().createElement("strong",null,e),displayName:t}});return a().createElement(ee.zW,{confirmButtonText:l,handleCancel:()=>{},handleConfirm:n,modalHeaderText:o,onExited:r,compassDesign:!0},i)}te.propTypes={channelDisplayName:h().string,onConfirm:h().func.isRequired,onExited:h().func.isRequired},ne.propTypes={displayName:h().string.isRequired,onConfirm:h().func.isRequired,onExited:h().func.isRequired};const re=ne;var ae=n(78451);const se=a().createElement(g.FormattedMessage,{id:"scheduled_post.action.delete",defaultMessage:"Delete scheduled post"}),oe=a().createElement(g.FormattedMessage,{id:"scheduled_post.action.edit",defaultMessage:"Edit scheduled post"}),le=a().createElement(g.FormattedMessage,{id:"scheduled_post.action.reschedule",defaultMessage:"Reschedule post"}),ie=a().createElement(g.FormattedMessage,{id:"scheduled_post.action.send_now",defaultMessage:"Send now"}),ce=a().createElement(g.FormattedMessage,{id:"scheduled_post.action.copy_text",defaultMessage:"Copy text"});function de(e){let{scheduledPost:t,channel:n,onReschedule:l,onDelete:i,onSend:d,onEdit:u,onCopyText:m}=e;const p=(0,s.useDispatch)(),f=(0,s.useSelector)(Z.FJ),h=(0,s.useSelector)((e=>(0,o.vd)(e))),g=(0,s.useSelector)((e=>(0,c.J1)(e)));(0,r.useEffect)((()=>{(null==n?void 0:n.type)===ae.Ay.DM_CHANNEL&&p((0,G.jh)([n.id]))}),[n,p]);const E=(0,r.useCallback)((()=>{const e=Y().tz(t.scheduled_at,f);p((0,W.q)({modalId:ae.IQ.SCHEDULED_POST_CUSTOM_TIME_MODAL,dialogType:Q.A,dialogProps:{channelId:t.channel_id,onConfirm:l,initialTime:e}}))}),[p,l,t.channel_id,t.scheduled_at,f]),y=(0,r.useCallback)((()=>{p((0,W.q)({modalId:ae.IQ.DELETE_DRAFT,dialogType:te,dialogProps:{channelDisplayName:null==n?void 0:n.display_name,onConfirm:()=>i(t.id)}}))}),[n,p,i,t.id]),_=(0,r.useCallback)((()=>{n&&p((0,W.q)({modalId:ae.IQ.SEND_DRAFT,dialogType:re,dialogProps:{displayName:n.display_name,onConfirm:()=>d(t.id)}}))}),[n,p,d,t.id]),v=Boolean(n&&h[n.id]),b=Boolean(null==n?void 0:n.delete_at),C=!t.error_code&&v&&!b,M=(0,s.useSelector)((e=>(0,w.nO)(e,t.channel_id))),N=(!t.error_code||"unknown"===t.error_code||"unable_to_send"===t.error_code)&&n&&!b&&!M&&v,k=(!t.error_code||"unknown"===t.error_code||"unable_to_send"===t.error_code)&&v&&!b;return a().createElement("div",{className:"ScheduledPostActions"},a().createElement($,{icon:"icon-trash-can-outline",id:"delete",name:"delete",tooltipText:se,onClick:y}),(g||C)&&a().createElement($,{icon:"icon-pencil-outline",id:"edit",name:"edit",tooltipText:oe,onClick:u}),a().createElement($,{icon:"icon-content-copy",id:"copy_text",name:"copy_text",tooltipText:ce,onClick:m}),(g||k)&&a().createElement($,{icon:"icon-clock-send-outline",id:"reschedule",name:"reschedule",tooltipText:le,onClick:E}),(g||N)&&a().createElement($,{icon:"icon-send-outline",id:"sendNow",name:"sendNow",tooltipText:ie,onClick:_}))}de.propTypes={onReschedule:h().func.isRequired,onDelete:h().func.isRequired,onSend:h().func.isRequired,onEdit:h().func.isRequired,onCopyText:h().func.isRequired};const ue=(0,r.memo)(de);function me(e){let t,{type:n}=e;const r=a().createElement("i",{className:"icon icon-pencil-outline"}),s=a().createElement(g.FormattedMessage,{id:"scheduled_posts.row_title_thread.placeholder_tooltip",defaultMessage:"The channel either doesn’t exist or you do not have access to it."});return t="thread"===n?a().createElement(g.FormattedMessage,{id:"scheduled_posts.row_title_thread.placeholder",defaultMessage:"Thread to: {icon} No Destination",values:{icon:r}}):a().createElement(g.FormattedMessage,{id:"scheduled_posts.row_title_channel.placeholder",defaultMessage:"In: {icon} No Destination",values:{icon:r}}),a().createElement(J.A,{title:s},a().createElement("div",null,t))}me.propTypes={type:h().oneOf(["channel","thread"]).isRequired};var pe=n(32446),fe=n(32580),he=n(87778),ge=n(61185),Ee=n(25778),ye=n(38335),_e=n(36598),ve=n(75270),be=(n(76685),n(3188),n(29206),n(85406)),Ce=n(10696),Me=n(41415),Ne=n(79558),ke=n(76683),Se=n(59172),Re=n(19513),Te=n(38564),Oe=n(69819),Pe=n(92008),De=n(62975),Ie=n(85873),we=n(4715);const Ae=e=>{let{onSave:t,onCancel:n}=e;const r=(0,s.useSelector)((e=>(0,l.Jz)(e,D.pm.CATEGORY_ADVANCED_SETTINGS,"send_on_ctrl_enter"))),o=(0,we.cX)()?"⌘+":"CTRL+";return a().createElement("div",{className:"post-body__footer"},a().createElement("button",{onClick:t,className:"save"},a().createElement(g.FormattedMessage,{id:"edit_post.action_buttons.save",defaultMessage:"Save"})),a().createElement("button",{onClick:n,className:"cancel"},a().createElement(g.FormattedMessage,{id:"edit_post.action_buttons.cancel",defaultMessage:"Cancel"})),a().createElement(g.FormattedMessage,{id:"edit_post.helper_text",defaultMessage:"<strong>{key}ENTER</strong> to Save, <strong>ESC</strong> to Cancel",values:{key:r?o:"",strong:e=>a().createElement("strong",null,e)}}))};Ae.propTypes={onSave:h().func.isRequired,onCancel:h().func.isRequired};const xe=(0,r.memo)(Ae),Le=["editingPost","actions","canEditPost","config","channelId","draft","scheduledPost","afterSave","onCancel","onDeleteScheduledPost"];function qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function He(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qe(Object(n),!0).forEach((function(t){je(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function je(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const{KeyCodes:Fe}=ae.YM,Be=e=>{var t,n;let{editingPost:o,actions:l,canEditPost:i,config:c,channelId:d,draft:u,scheduledPost:m,afterSave:p,onCancel:f,onDeleteScheduledPost:h}=e,E=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,Le);const y=(0,s.useSelector)(B.K7),_=(0,s.useSelector)((e=>(0,w.c)(e,d))),v=(0,s.useDispatch)(),[C,M]=(0,r.useState)(u.message||(null==o||null===(t=o.post)||void 0===t?void 0:t.message_source)||(null==o||null===(n=o.post)||void 0===n?void 0:n.message)||(null==m?void 0:m.message)||""),[N,k]=(0,r.useState)({start:C.length,end:C.length}),S=(0,r.useRef)(C.length),[R,T]=(0,r.useState)(null),[O,P]=(0,r.useState)(""),[D,I]=(0,r.useState)(!1),[A,x]=(0,r.useState)(!1),[L,q]=(0,r.useState)(!1),H=(0,r.useRef)(null),j=(0,r.useRef)(null),F=(0,r.useRef)(u),U=(0,r.useRef)(),V=m?m.id:o.postId,z="".concat(ae.eN.EDIT_DRAFT).concat(V),{formatMessage:K}=(0,g.useIntl)(),Y=(0,r.useCallback)((()=>{U.current&&o.postId&&(l.setDraft(z,F.current),clearTimeout(U.current),U.current=null)}),[l,z,o.postId]);(0,r.useEffect)((()=>Y),[Y]),(0,r.useEffect)((()=>{if(U.current&&clearTimeout(U.current),U.current=window.setTimeout((()=>{l.setDraft(z,F.current)}),ae.YM.SAVE_DRAFT_TIMEOUT),!m){const e=(0,De.cS)(C).length>0;q(e)}}),[l,z,C,m]),(0,r.useEffect)((()=>{const e=()=>{var e;return null==H||null===(e=H.current)||void 0===e?void 0:e.focus()};return document.addEventListener(ae.r1.FOCUS_EDIT_TEXTBOX,e),()=>document.removeEventListener(ae.r1.FOCUS_EDIT_TEXTBOX,e)}),[]),(0,r.useEffect)((()=>{var e,t;N.start===N.end?Ie.vZ(null===(e=H.current)||void 0===e?void 0:e.getInputBox(),N.start):Ie.eG(null===(t=H.current)||void 0===t?void 0:t.getInputBox(),N.start,N.end)}),[N]);const G=e=>k({start:e,end:e}),Z=(0,r.useCallback)((e=>{const{clipboardData:t,target:n}=e;if(!t||!t.items||!i||"edit_textbox"!==n.id)return;const r=(0,Oe.ON)(t),a=(0,Oe.OJ)(t);if(!a&&!r)return;e.preventDefault();let s=C,o=N.start;if(a&&(0,Oe.g$)(a.className)){const{formattedMessage:e,formattedCodeBlock:r}=(0,Oe.rW)({selectionStart:n.selectionStart,selectionEnd:n.selectionEnd,message:s,clipboardData:t});s=e,o=N.start+r.length}else s=(0,Oe.uL)(t,C.trim(),o).formattedMessage,o=s.length-(C.length-o);M(s),G(o)}),[i,N,C]),Q=()=>{const{post:e}=o;return e&&e.file_ids&&e.file_ids.length>0||""!==C.trim()?!i:!E.canDeletePost},J=e=>{if(null===e.selectionStart||null===e.selectionEnd)return;const t=(0,Te.uD)(e);M(t.message),k({start:t.selectionStart,end:t.selectionEnd})},X=e=>{if(e){const t=document.getElementById(e);null==t||t.focus()}l.unsetEditingPost()},$=()=>{F.current=He(He({},F.current),{},{message:""}),X(o.refocusId||null)},ee=async()=>{var e,t,n,r;if(m)return await re(),void(null==p||p());if(!o.post||Q())return;let s={message:C,id:o.postId,channel_id:o.post.channel_id};const i=await l.runMessageWillBeUpdatedHooks(s,o.post);if(i.error&&i.error.message)return void T(a().createElement(a().Fragment,null,i.error.message));if(s=i.data,R)return P("animation--highlight"),void setTimeout((()=>P("")),ae.YM.ANIMATION_TIMEOUT);if(s.message===((null===(e=o.post)||void 0===e?void 0:e.message_source)||(null===(t=o.post)||void 0===t?void 0:t.message)))return void $();const c=Boolean((null===(n=o.post)||void 0===n?void 0:n.file_ids)&&(null===(r=o.post)||void 0===r?void 0:r.file_ids.length)>0);if(0!==s.message.trim().length||c)await l.editPost(s),$(),null==p||p();else{X(null);const e={modalId:ae.IQ.DELETE_POST,dialogType:Ne.A,dialogProps:{post:o.post,isRHS:o.isRHS}};v((0,W.q)(e))}},ne=(0,r.useCallback)((()=>{null==f||f(),$()}),[f,$]),re=(0,r.useCallback)((async()=>{if(!m||Q()||!_||!h)return;const e=(0,Ce.h_)(m);let t={message:C,id:m.id,channel_id:null==m?void 0:m.channel_id};const n=await l.runMessageWillBeUpdatedHooks(t,e);if(n.error&&n.error.message)return void T(a().createElement(a().Fragment,null,n.error.message));if(t=n.data,R)return P("animation--highlight"),void setTimeout((()=>P("")),ae.YM.ANIMATION_TIMEOUT);if(t.message===e.message)return void $();const r=Boolean(m.file_ids&&m.file_ids.length>0);if(0===t.message.trim().length&&!r){X(null);const e={modalId:ae.IQ.DELETE_DRAFT,dialogType:te,dialogProps:{channelDisplayName:_.display_name,onConfirm:h}};return void v((0,W.q)(e))}const s=He(He({},m),{},{message:t.message}),o=await l.updateScheduledPost(s,y);o.error?T(o.error.message):($(),null==p||p())}),[l,y,C,$,X,Q,R,m,p,_,h]),{emojiPicker:se,getReferenceProps:oe,setReference:le}=(0,ke.A)({showEmojiPicker:D,setShowEmojiPicker:I,enableGifPicker:"true"===c.EnableGifPicker,onGifClick:e=>{var t;let n=e;C.length>0&&(n=/\s+$/.test(C)?"".concat(C).concat(e):"".concat(C," ").concat(e)),F.current=He(He({},F.current),{},{message:n}),M(n),I(!1),null===(t=H.current)||void 0===t||t.focus()},onEmojiClick:e=>{var t;if(!e)return;const n=(0,Me.Yf)(e);if(!n)return;let r=":".concat(n,": "),a=r.length;if(C.length>0){const{firstPiece:e,lastPiece:t}=(0,Pe.K_)(S.current,C);r=""===e?":".concat(n,": ").concat(t):"".concat(e," :").concat(n,": ").concat(t),a=""===e?":".concat(n,": ").length:"".concat(e," :").concat(n,": ").length}F.current=He(He({},F.current),{},{message:r}),M(r),G(a),I(!1),null===(t=H.current)||void 0===t||t.focus()}});let ie=null;"true"===c.EnableEmojiPicker&&(ie=a().createElement(a().Fragment,null,a().createElement("button",Object.assign({"aria-label":K({id:"emoji_picker.emojiPicker.button.ariaLabel",defaultMessage:"select an emoji"}),id:"editPostEmoji",ref:le,className:"style--none post-action",onClick:e=>{var t;null==e||e.stopPropagation(),I(!D),D&&(null===(t=H.current)||void 0===t||t.focus())}},oe()),a().createElement(be.EmoticonPlusOutlineIcon,{size:18,color:"currentColor"})),se));let ce="";return o.post&&(ce=o.post.root_id||o.post.id),a().createElement("div",{className:b()("post--editing__wrapper",{scroll:A}),ref:j},a().createElement(Se.Ay,{tabIndex:0,rootId:ce,onChange:e=>{const t=e.target.value;F.current=He(He({},F.current),{},{message:t}),M(t)},onKeyPress:e=>{const{ctrlSend:t,codeBlockOnCtrlEnter:n}=E,{allowSending:r,ignoreKeyPress:a}=(0,Pe.zr)(e,C,t,n,Date.now(),0);if(a)return e.preventDefault(),void e.stopPropagation();r&&H.current&&(e.preventDefault(),H.current.blur(),ee())},onKeyDown:e=>{const{ctrlSend:t,codeBlockOnCtrlEnter:n}=E,r=e.ctrlKey||e.metaKey,a=Re.r(e)&&!e.altKey&&!e.shiftKey,s=Re.r(e,!0)&&e.altKey,o=(t||n)&&Re.e(e,Fe.ENTER)&&r,l=Re.e(e,Fe.K),i=Re.r(e,!0)&&e.shiftKey&&Re.e(e,Fe.BACK_SLASH);Ie.qN(e)?(e.stopPropagation(),M(Ie.Co(e.nativeEvent))):o?ee():Re.e(e,Fe.ESCAPE)&&!D?(null==f||f(),$()):s&&l?J({markdownMode:"link",selectionStart:e.currentTarget.selectionStart,selectionEnd:e.currentTarget.selectionEnd,message:e.currentTarget.value}):a&&Re.e(e,Fe.B)?J({markdownMode:"bold",selectionStart:e.currentTarget.selectionStart,selectionEnd:e.currentTarget.selectionEnd,message:e.currentTarget.value}):a&&Re.e(e,Fe.I)?J({markdownMode:"italic",selectionStart:e.currentTarget.selectionStart,selectionEnd:e.currentTarget.selectionEnd,message:e.currentTarget.value}):i&&(e.stopPropagation(),e.preventDefault())},onBlur:e=>{const t=e.target;S.current=t.selectionEnd},onHeightChange:(e,t)=>x(e>t),handlePostError:e=>{e!==R&&T(e)},onPaste:Z,value:C,channelId:d,emojiEnabled:"true"===c.EnableEmojiPicker,createMessage:K({id:"edit_post.editPost",defaultMessage:"Edit the post..."}),supportsCommands:!1,suggestionListPosition:"bottom",id:"edit_textbox",ref:H,characterLimit:E.maxPostSize,useChannelMentions:E.useChannelMentions}),a().createElement("div",{className:"post-body__actions"},ie),L?a().createElement("div",{className:"post-body__info"},a().createElement("span",{className:"post-body__info__icon"},a().createElement(be.InformationOutlineIcon,{size:14,color:"currentColor"})),a().createElement("span",null,K({id:"edit_post.no_notification_trigger_on_mention",defaultMessage:"Editing this message with an '@mention' will not notify the recipient."}))):null,a().createElement(xe,{onSave:ee,onCancel:ne}),R&&a().createElement("div",{className:b()("edit-post-footer",{"has-error":R})},a().createElement("label",{className:b()("post-error",O)},R)))};Be.propTypes={canEditPost:h().bool,canDeletePost:h().bool,readOnlyChannel:h().bool,teamId:h().string.isRequired,channelId:h().string.isRequired,codeBlockOnCtrlEnter:h().bool.isRequired,ctrlSend:h().bool.isRequired,config:h().shape({EnableEmojiPicker:h().string,EnableGifPicker:h().string}).isRequired,maxPostSize:h().number.isRequired,useChannelMentions:h().bool.isRequired,editingPost:h().shape({postId:h().string,refocusId:h().string,title:h().string,isRHS:h().bool}).isRequired,isRHSOpened:h().bool.isRequired,isEditHistoryShowing:h().bool.isRequired,actions:h().shape({addMessageIntoHistory:h().func.isRequired,editPost:h().func.isRequired,setDraft:h().func.isRequired,unsetEditingPost:h().func.isRequired,scrollPostListToBottom:h().func.isRequired,runMessageWillBeUpdatedHooks:h().func.isRequired,updateScheduledPost:h().func.isRequired}).isRequired,afterSave:h().func,onCancel:h().func,onDeleteScheduledPost:h().func};const Ue=Be,Ve=(0,s.connect)((function(e,t){const n=(0,A.zj)(e),r=(0,c.WR)(e);let a,s,o,i;var d,u;t.scheduledPost?(a={post:null},s=t.scheduledPost.channel_id,o=(0,ve.UR)(e,ae.eN.EDIT_DRAFT,t.scheduledPost.id),i=!0):(a=(0,_e.cA)(e),s=a.post.channel_id,o=(0,ve.UR)(e,ae.eN.EDIT_DRAFT,a.postId),i=(null===(d=a)||void 0===d||null===(u=d.post)||void 0===u?void 0:u.user_id)===r);const m=(0,q.Sy)(e),p=i?D.xB.DELETE_POST:D.xB.DELETE_OTHERS_POSTS,f=i?D.xB.EDIT_POST:D.xB.EDIT_OTHERS_POSTS,h=(0,w.c)(e,s),g=(0,L.Ec)(e,m,s,D.xB.USE_CHANNEL_MENTIONS);return{canEditPost:(0,L.Ec)(e,m,s,f),canDeletePost:(0,L.Ec)(e,m,s,p),codeBlockOnCtrlEnter:(0,l.Jz)(e,D.pm.CATEGORY_ADVANCED_SETTINGS,"code_block_ctrl_enter",!0),ctrlSend:(0,l.Jz)(e,D.pm.CATEGORY_ADVANCED_SETTINGS,"send_on_ctrl_enter"),draft:o,config:n,editingPost:a,teamId:m,channelId:s,maxPostSize:parseInt(n.MaxPostSize||"0",10)||ae.Ay.DEFAULT_CHARACTER_LIMIT,readOnlyChannel:!(0,c.J1)(e)&&(null==h?void 0:h.name)===ae.Ay.DEFAULT_CHANNEL,useChannelMentions:g,isRHSOpened:(0,ve.A)(e),isEditHistoryShowing:(0,ve.bM)(e)===ae._n.EDIT_HISTORY,scheduledPost:t.scheduledPost}}),(function(e){return{actions:(0,pe.zH)({scrollPostListToBottom:Ee.oF,addMessageIntoHistory:O.P8,editPost:ye.lD,setDraft:ge.X2,unsetEditingPost:he.K4,runMessageWillBeUpdatedHooks:fe.xO,updateScheduledPost:P.pI},e)}}))(Ue);var ze=n(4607),Ke=n(16230);function Ye(e){let{displayName:t,onExited:n,onConfirm:r}=e;const{formatMessage:s}=(0,g.useIntl)(),o=s({id:"drafts.confirm.delete.title",defaultMessage:"Delete draft"}),l=s({id:"drafts.confirm.delete.button",defaultMessage:"Yes, delete"}),i=a().createElement(g.FormattedMessage,{id:"drafts.confirm.delete.text",defaultMessage:"Are you sure you want to delete this draft to <strong>{displayName}</strong>?",values:{strong:e=>a().createElement("strong",null,e),displayName:t}});return a().createElement(ee.zW,{confirmButtonText:l,handleCancel:R(),handleConfirm:r,modalHeaderText:o,onExited:n,compassDesign:!0,isDeleteModal:!0,autoFocusConfirmButton:!0},i)}Ye.propTypes={displayName:h().string.isRequired,onConfirm:h().func.isRequired,onExited:h().func.isRequired};const Ge=Ye,Ze=a().createElement(g.FormattedMessage,{id:"drafts.actions.scheduled",defaultMessage:"Schedule draft"});function We(e){let{displayName:t,onDelete:n,onEdit:o,onSend:l,canEdit:i,canSend:c,onSchedule:d,channelId:u}=e;const m=(0,s.useDispatch)(),p=(0,r.useCallback)((()=>{m((0,W.q)({modalId:ae.IQ.DELETE_DRAFT,dialogType:Ge,dialogProps:{displayName:t,onConfirm:n}}))}),[m,t,n]),f=(0,r.useCallback)((()=>{m((0,W.q)({modalId:ae.IQ.SEND_DRAFT,dialogType:re,dialogProps:{displayName:t,onConfirm:l}}))}),[m,t,l]),h=(0,r.useCallback)((()=>{m((0,W.q)({modalId:ae.IQ.SCHEDULED_POST_CUSTOM_TIME_MODAL,dialogType:Q.A,dialogProps:{channelId:u,onConfirm:d}}))}),[u,m,d]);return a().createElement(a().Fragment,null,a().createElement($,{icon:"icon-trash-can-outline",id:"delete",name:"delete",tooltipText:a().createElement(g.FormattedMessage,{id:"drafts.actions.delete",defaultMessage:"Delete draft"}),onClick:p}),i&&a().createElement($,{icon:"icon-pencil-outline",id:"edit",name:"edit",tooltipText:a().createElement(g.FormattedMessage,{id:"drafts.actions.edit",defaultMessage:"Edit draft"}),onClick:o}),c&&a().createElement($,{icon:"icon-clock-send-outline",id:"reschedule",name:"reschedule",tooltipText:Ze,onClick:h}),c&&a().createElement($,{icon:"icon-send-outline",id:"send",name:"send",tooltipText:a().createElement(g.FormattedMessage,{id:"drafts.actions.send",defaultMessage:"Send draft"}),onClick:f}))}We.propTypes={displayName:h().string.isRequired,onDelete:h().func.isRequired,onEdit:h().func.isRequired,onSend:h().func.isRequired,canEdit:h().bool.isRequired,canSend:h().bool.isRequired,onSchedule:h().func.isRequired,channelId:h().string.isRequired};const Qe=(0,r.memo)(We),Je=(0,s.connect)((function(e,t){const{channelDisplayName:n,userId:r,channelName:a,channelType:s}=t;let o,i,u=n;return s===ae.YM.DM_CHANNEL&&(o=(0,Ke.r4)(r,a),i=(0,c.wz)(e,o),u=(0,d.R4)(i,(0,l.K3)(e))),{displayName:u}}))(Qe);var Xe=n(17085),$e=n(41468);function et(e){let{channel:t,membersCount:n,selfDraft:o,teammate:l,teammateId:i,type:c}=e;const d=(0,s.useDispatch)();(0,r.useEffect)((()=>{null!=l&&l.id||!i||d((0,Xe.WA)([i]))}),[null==l?void 0:l.id,i]),(0,r.useEffect)((()=>{t.type!==ae.YM.GM_CHANNEL||n||d((0,Xe.tF)(t.id))}),[t.id,t.type,d,n]);let u=null,m=null;o&&(u=a().createElement(a().Fragment,null," ",a().createElement(g.FormattedMessage,{id:"drafts.draft_title.you",defaultMessage:"(you)"})));let p=a().createElement("i",{className:"icon icon-globe"});return t.type===ae.YM.PRIVATE_CHANNEL&&(p=a().createElement("i",{className:"icon icon-lock-outline"})),t.type===ae.YM.DM_CHANNEL&&l&&(p=a().createElement($e.A,{size:"xs",username:l.username,url:(0,Ie.RG)(l.id,l.last_picture_update),className:"DraftTitle__avatar"})),t.type===ae.YM.GM_CHANNEL&&(p=a().createElement("div",{className:"DraftTitle__group-icon"},n)),m="thread"===c?t.type!==ae.YM.GM_CHANNEL&&t.type!==ae.YM.DM_CHANNEL?a().createElement(g.FormattedMessage,{id:"drafts.draft_title.channel_thread",defaultMessage:"Thread in: {icon} <span>{channelName}</span>",values:{icon:p,channelName:t.display_name,span:e=>a().createElement("span",null,e)}}):a().createElement(g.FormattedMessage,{id:"drafts.draft_title.direct_thread",defaultMessage:"Thread to: {icon} <span>{channelName}</span>",values:{icon:p,channelName:t.display_name,span:e=>a().createElement("span",null,e)}}):t.type!==ae.YM.GM_CHANNEL&&t.type!==ae.YM.DM_CHANNEL?a().createElement(g.FormattedMessage,{id:"drafts.draft_title.channel",defaultMessage:"In: {icon} <span>{channelName}</span>",values:{icon:p,channelName:t.display_name,span:e=>a().createElement("span",null,e)}}):a().createElement(g.FormattedMessage,{id:"drafts.draft_title.direct_channel",defaultMessage:"To: {icon} <span>{channelName}</span>",values:{icon:p,channelName:t.display_name,span:e=>a().createElement("span",null,e)}}),a().createElement(a().Fragment,null,m,u)}et.propTypes={membersCount:h().number,selfDraft:h().bool.isRequired,teammateId:h().string,type:h().oneOf(["channel","thread"]).isRequired};const tt=(0,r.memo)(et),nt=(0,s.connect)((function(){const e=(0,w.fV)();return(t,n)=>{const{channel:r,userId:a}=n;let s,o,l;return r.type===ae.YM.GM_CHANNEL&&(l=e(t,r)),r.type===ae.YM.DM_CHANNEL&&(s=(0,Ke.r4)(a,r.name),o=(0,c.wz)(t,s)),{channel:r,membersCount:l,selfDraft:s===a,teammate:o,teammateId:s}}}))(tt),rt=(0,Ie.NL)(".hljs, code");function at(e){let{children:t,onClick:n,hasError:r,innerRef:s,isHighlighted:o,style:l,className:i,dataTestId:c,dataPostId:d,ariaLabel:u}=e;return a().createElement("div",{"data-testid":c,"data-postid":d,className:b()("Panel",{draftError:r,highlighted:o},i),style:l,onClick:e=>{rt(e)&&n()},onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||n()},role:"link",tabIndex:0,ref:s,"aria-label":u},t)}at.propTypes={children:h().node.isRequired,onClick:h().func.isRequired,hasError:h().bool.isRequired,innerRef:h().oneOfType([h().string,h().func,h().object]),isHighlighted:h().bool,className:h().string,dataTestId:h().string,dataPostId:h().string,ariaLabel:h().string};const st=(0,r.memo)(at);var ot=n(35813),lt=n(58339),it=n(85234),ct=n(18515),dt=n(17001),ut=n(61767);const mt={disableGroupHighlight:!0,mentionHighlight:!1};function pt(e){let{channelId:t,displayName:n,fileInfos:o,message:l,priority:i,burnOnRead:c,burnOnReadDurationMinutes:d=10,status:u,uploadsInProgress:m,userId:p,username:f}=e;const h=(0,s.useSelector)(q._p),g=(0,s.useSelector)(F.Ui),E=(0,r.useCallback)((e=>{(0,Ie.oO)(e,h)}),[h]);return a().createElement("div",{className:"DraftPanelBody post"},a().createElement("div",{className:"DraftPanelBody__left post__img"},a().createElement(ut.A,{status:u,channelId:t,username:f,userId:p,size:"md",src:(0,Ie.RG)(p)})),a().createElement("div",{className:"DraftPanelBody__post_body"},a().createElement(dt.A,{text:l},a().createElement("div",{onClick:E,className:"post__content"},a().createElement("div",{className:"DraftPanelBody__right"},a().createElement("div",{className:"post__header"},a().createElement("strong",null,n),i&&a().createElement(ot.A,{canRemove:!1,hasError:!1,persistentNotifications:i.persistent_notifications,priority:i.priority,requestedAck:i.requested_ack}),(null==c?void 0:c.enabled)&&g&&a().createElement(lt.A,{canRemove:!1,onRemove:()=>{},durationMinutes:d})),a().createElement("div",{className:"post__body"},a().createElement(ct.A,{options:mt,message:l}))))),(o.length>0||(null==m?void 0:m.length)>0)&&a().createElement(it.A,{fileInfos:o,uploadsInProgress:m})))}pt.propTypes={channelId:h().string,displayName:h().string.isRequired,message:h().string.isRequired,burnOnRead:h().shape({enabled:h().bool.isRequired}),burnOnReadDurationMinutes:h().number};const ft=pt;var ht=n(9783);const gt=(0,g.defineMessages)({unknown:{id:"scheduled_post.error_code.unknown_error",defaultMessage:"Unknown Error"},channel_archived:{id:"scheduled_post.error_code.channel_archived",defaultMessage:"Channel Archived"},channel_not_found:{id:"scheduled_post.error_code.channel_removed",defaultMessage:"Channel Removed"},user_missing:{id:"scheduled_post.error_code.user_missing",defaultMessage:"User Deleted"},user_deleted:{id:"scheduled_post.error_code.user_deleted",defaultMessage:"User Deleted"},no_channel_permission:{id:"scheduled_post.error_code.no_channel_permission",defaultMessage:"Missing Permission"},no_channel_member:{id:"scheduled_post.error_code.no_channel_member",defaultMessage:"Not In Channel"},thread_deleted:{id:"scheduled_post.error_code.thread_deleted",defaultMessage:"Thread Deleted"},unable_to_send:{id:"scheduled_post.error_code.unable_to_send",defaultMessage:"Unable to Send"},invalid_post:{id:"scheduled_post.error_code.invalid_post",defaultMessage:"Invalid Post"}});function Et(e){var t;const n=null!==(t=gt[arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unknown"])&&void 0!==t?t:gt.unknown;return e.formatMessage(n).toUpperCase()}function yt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _t(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yt(Object(n),!0).forEach((function(t){vt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function vt(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const bt={current:0};function Ct(e){var t;let{item:n,user:o,status:l,displayName:i,isRemote:c,scrollIntoView:d,containerClassName:u}=e;const[p,f]=(0,r.useState)(!1),h="scheduled_at"in n,E=(0,g.useIntl)(),y="rootId"in n?n.rootId:n.root_id,_="channelId"in n?n.channelId:n.channel_id,[v,b]=(0,r.useState)(null),C=(0,T.useHistory)(),M=(0,s.useDispatch)(),N=(0,r.useMemo)((()=>(0,w.s9)()),[]),k=(0,s.useSelector)((e=>N(e,_))),S=(0,r.useMemo)((()=>(0,H.pL)()),[]),K=(0,s.useSelector)((e=>{if(!y)return!1;const t=(0,x.f5)(e,y);return!t||t.delete_at>0||"DELETED"===t.state})),Y=(0,s.useSelector)((e=>{const t=parseInt((0,A.zj)(e).MaxPostSize||"",10)||ae.Ay.DEFAULT_CHARACTER_LIMIT;return n.message.length>t})),G=!(0,s.useSelector)((e=>!!k&&(0,L.Ec)(e,k.team_id,k.id,D.xB.CREATE_POST))),Z=(0,s.useSelector)(B.K7),W=(0,s.useSelector)(F.e0),Q=Boolean(null==k?void 0:k.delete_at),J=(0,s.useSelector)((e=>(0,w.nO)(e,_)));let X="";h?n.error_code?X=Et(E,n.error_code):(Q||J)&&(X=Et(E,"channel_archived")):K?X=E.formatMessage({id:"drafts.error.post_not_found",defaultMessage:"Thread not found"}):Y?X=E.formatMessage({id:"drafts.error.too_long",defaultMessage:"Message too long"}):G&&(X=E.formatMessage({id:"drafts.error.read_only",defaultMessage:"Channel is read only"}));const $=!X,ee=!(K||G),te=(0,s.useSelector)((e=>{if(!k)return"";const t=(0,q.Sy)(e);return(0,U.H)(e,k,t)})),ne=(0,r.useCallback)((async()=>{if(!p)if(y){if(K)return;await M((0,m.n0)(y))}else C.push(te)}),[te,M,C,y,K,p]),re=(0,r.useRef)(!1),se=(0,r.useRef)(!1),oe=(0,s.useSelector)((e=>{if(!y)return;const t=(0,x.f5)(e,y);return t?S(e,t):void 0})),le=(0,r.useCallback)((()=>{let e="".concat(ae.eN.DRAFT).concat(_);y&&(e="".concat(ae.eN.COMMENT_DRAFT).concat(y)),M((0,j.AB)(e,_,y))}),[M,_,y]),ie=(0,r.useCallback)((e=>{if(re.current&&e.created&&!e.error&&(le(),re.current=!1),se.current&&e.created&&!e.error){const e=n;M((0,P.FF)(e.user_id,e.id,Z)),se.current=!1}}),[Z,M,le,n]),{onSubmitCheck:ce}=(0,V.A)(n,R(),R(),!1),[de]=(0,z.A)(n,X,_,y,v,bt,R(),b,R(),R(),ce,ne,ie,!0),pe=(0,r.useCallback)((async e=>(re.current=!0,await de(n,{scheduled_at:e}),Promise.resolve({}))),[n,de]),fe=(0,r.useMemo)((()=>k?a().createElement(Je,{channelDisplayName:k.display_name,channelName:k.name,channelType:k.type,channelId:k.id,userId:o.id,onDelete:le,onEdit:ne,onSend:de,canEdit:ee,canSend:$,onSchedule:pe}):null),[ee,$,k,ne,le,de,o.id,pe]),he=(0,r.useCallback)((()=>{f(!1)}),[]),ge=(0,r.useCallback)((async e=>{var t;he();const r=_t(_t({},n),{},{scheduled_at:e});return{error:null===(t=(await M((0,P.pI)(r,Z))).error)||void 0===t?void 0:t.message}}),[Z,M,n,he]),Ee=(0,r.useCallback)((async()=>{var e;he();const t=n;return{error:null===(e=(await M((0,P.FF)(t.user_id,t.id,Z))).error)||void 0===e?void 0:e.message}}),[n,M,Z,he]),ye=(0,r.useCallback)((()=>{f((e=>!e))}),[]),_e=(0,r.useCallback)((()=>{(0,Ie.lW)(n.message)}),[n]),ve=(0,r.useCallback)((()=>{he(),se.current=!0;const e=(0,ze.Y)(n);return de(e,void 0,{keepDraft:!0,ignorePostError:!0}),Promise.resolve({})}),[de,n,he]),be=(0,r.useMemo)((()=>a().createElement(ue,{scheduledPost:n,channel:k,onReschedule:ge,onDelete:Ee,onSend:ve,onEdit:ye,onCopyText:_e})),[k,Ee,ge,ve,ye,_e,n]);(0,r.useEffect)((()=>{!y||null!=oe&&oe.id||M((0,O.f5)(y))}),[null==oe?void 0:oe.id,y]);const Ce=function(){const e=a().useRef(null);return a().useEffect((()=>{e.current&&e.current.scrollIntoView({behavior:"smooth"})}),[]),e}();if(!k&&!h)return null;let Me,Ne,ke,Se;var Re;h?(Me=n.scheduled_at,Ne=(null===(Re=n.metadata)||void 0===Re?void 0:Re.files)||[],ke=[],Se=be):(Me=n.updateAt,Ne=n.fileInfos,ke=n.uploadsInProgress,Se=fe);const Te=n.type,Oe=y||Te!==I.w.BURN_ON_READ?void 0:{enabled:!0};let Pe;Pe=k?a().createElement(nt,{type:y?"thread":"channel",channel:k,userId:o.id}):a().createElement(me,{type:y?"thread":"channel"});const De=h?"scheduledPost":"draft";return a().createElement(st,{dataTestId:"".concat(De,"View"),dataPostId:n.id,onClick:ne,hasError:Boolean(X),innerRef:d?Ce:void 0,isHighlighted:d,className:u,ariaLabel:h?E.formatMessage({id:"drafts.draft_row.aria_label.scheduled_post",defaultMessage:"scheduled post in {channelName}"},{channelName:null==k?void 0:k.display_name}):E.formatMessage({id:"drafts.draft_row.aria_label.draft",defaultMessage:"draft in {channelName}"},{channelName:null==k?void 0:k.display_name})},a().createElement(ht.Ay,{kind:De,actions:Se,title:Pe,timestamp:Me,remote:c||!1,error:X||(null==v?void 0:v.message)}),p&&a().createElement(Ve,{scheduledPost:n,onCancel:he,afterSave:he,onDeleteScheduledPost:Ee}),!p&&a().createElement(ft,{channelId:null==k?void 0:k.id,displayName:i,fileInfos:Ne,message:n.message,status:l,priority:y||null===(t=n.metadata)||void 0===t?void 0:t.priority,burnOnRead:Oe,burnOnReadDurationMinutes:W,uploadsInProgress:ke,userId:o.id,username:o.username}))}Ct.propTypes={displayName:h().string.isRequired,isRemote:h().bool,scrollIntoView:h().bool,containerClassName:h().string,dataTestId:h().string,dataPostId:h().string};const Mt=(0,r.memo)(Ct);function Nt(e){const t=(0,r.useRef)(null),n=(0,r.useRef)(new Map),s=(0,r.useCallback)(((e,r,a)=>{const s=n.current.get(r);(!s||Math.abs(s-a)>4)&&(n.current.set(r,a),t.current&&t.current.resetAfterIndex(e))}),[]),o=(0,r.useCallback)((t=>{const r=t<e.drafts.length?e.drafts[t].key:"";return r&&n.current.get(r)||0}),[e.drafts]),l=(0,r.useMemo)((()=>({drafts:e.drafts,userDisplayName:e.userDisplayName,draftRemotes:e.draftRemotes,currentUser:e.currentUser,userStatus:e.userStatus,setRowHeight:s})),[e.drafts,e.userDisplayName,e.draftRemotes,e.currentUser,e.userStatus,s]);return a().createElement("div",{className:"DraftList Drafts__main"},a().createElement(N.Ay,null,(n=>{let{height:r,width:s}=n;return a().createElement(k._m,{ref:t,height:r,width:s,itemCount:e.drafts.length,itemSize:o,itemData:l,overscanCount:6},St)})))}function kt(e){let{index:t,style:n,data:{drafts:s,userDisplayName:o,draftRemotes:l,currentUser:i,userStatus:c,setRowHeight:d}}=e;const u=s[t],m=(0,r.useRef)(null),p=(0,r.useRef)(t),f=(0,r.useRef)(u.key),h=(0,r.useRef)(d);return(0,r.useEffect)((()=>{p.current=t,f.current=u.key,h.current=d}),[t,u.key,d]),(0,r.useEffect)((()=>{if(!m.current)return;const e=requestAnimationFrame((()=>{if(!m.current)return;const e=m.current.getBoundingClientRect().height;d(t,u.key,e)}));return()=>{cancelAnimationFrame(e)}}),[u,d,t]),(0,r.useEffect)((()=>{if(!m.current)return;let e=!0;const t=M()((t=>{e&&m.current&&h.current(p.current,f.current,t)}),120),n=new ResizeObserver((n=>{if(e&&m.current&&1===n.length&&n[0].target===m.current){const e=n[0].borderBoxSize[0].blockSize;t(e)}}));return n.observe(m.current),()=>{e=!1,t.cancel(),n.disconnect()}}),[]),a().createElement("div",{style:n}," ",a().createElement("div",{ref:m,className:b()("virtualizedVariableListRowWrapper",{firstRow:0===t})},a().createElement(Mt,{key:u.key,item:u.value,displayName:o,user:i,status:c,isRemote:null==l?void 0:l[u.key]})))}Nt.propTypes={drafts:h().array.isRequired,userDisplayName:h().string.isRequired,draftRemotes:h().objectOf(h().bool).isRequired},kt.propTypes={index:h().number.isRequired,data:h().shape({drafts:h().array.isRequired,userDisplayName:h().string.isRequired,draftRemotes:h().objectOf(h().bool).isRequired,userStatus:h().string.isRequired,setRowHeight:h().func.isRequired}).isRequired};const St=(0,r.memo)(kt);function Rt(e){const t=(0,s.useSelector)(p.L9);return 0===e.drafts.length?a().createElement(_,null):a().createElement(Nt,{drafts:e.drafts,currentUser:e.currentUser,userDisplayName:e.userDisplayName,userStatus:e.userStatus,draftRemotes:t})}Rt.propTypes={drafts:h().array.isRequired,userDisplayName:h().string.isRequired};var Tt=n(93725),Ot=n(41125);function Pt(e){return a().createElement("div",{id:"app-content",className:"Drafts app__content"},a().createElement(Ot.A,{level:2,className:"Drafts__header",heading:a().createElement(g.FormattedMessage,{id:"drafts.heading",defaultMessage:"Drafts"}),subtitle:a().createElement(g.FormattedMessage,{id:"drafts.subtitle",defaultMessage:"Any messages you've started will show here"})}),e.children)}n(57406),n(55448);var Dt=n(68102),It=n(49257),wt=n(81023);var At=n(29009),xt=n(12356);function Lt(e){return(0,xt.Ay)("MuiBadge",e)}(0,At.A)("MuiBadge",["root","badge","invisible"]);var qt=n(95591),Ht=n(68017);function jt(e){if(void 0===e)return{};const t={};return Object.keys(e).filter((t=>!(t.match(/^on[A-Z]/)&&"function"==typeof e[t]))).forEach((n=>{t[n]=e[n]})),t}const Ft=["elementType","externalSlotProps","ownerState"];function Bt(e){var t;const{elementType:n,externalSlotProps:r,ownerState:a}=e,s=(0,It.A)(e,Ft),o=function(e,t){return"function"==typeof e?e(t):e}(r,a),{props:l,internalRef:i}=function(e){const{getSlotProps:t,additionalProps:n,externalSlotProps:r,externalForwardedProps:a,className:s}=e;if(!t){const e=(0,Ht.A)(null==a?void 0:a.className,null==r?void 0:r.className,s,null==n?void 0:n.className),t=(0,Dt.A)({},null==n?void 0:n.style,null==a?void 0:a.style,null==r?void 0:r.style),o=(0,Dt.A)({},n,a,r);return e.length>0&&(o.className=e),Object.keys(t).length>0&&(o.style=t),{props:o,internalRef:void 0}}const o=function(e,t=[]){if(void 0===e)return{};const n={};return Object.keys(e).filter((n=>n.match(/^on[A-Z]/)&&"function"==typeof e[n]&&!t.includes(n))).forEach((t=>{n[t]=e[t]})),n}((0,Dt.A)({},a,r)),l=jt(r),i=jt(a),c=t(o),d=(0,Ht.A)(null==c?void 0:c.className,null==n?void 0:n.className,s,null==a?void 0:a.className,null==r?void 0:r.className),u=(0,Dt.A)({},null==c?void 0:c.style,null==n?void 0:n.style,null==a?void 0:a.style,null==r?void 0:r.style),m=(0,Dt.A)({},c,n,i,l);return d.length>0&&(m.className=d),Object.keys(u).length>0&&(m.style=u),{props:m,internalRef:c.ref}}((0,Dt.A)({},s,{externalSlotProps:o})),c=(0,qt.A)(i,null==o?void 0:o.ref,null==(t=e.additionalProps)?void 0:t.ref),d=function(e,t,n){return void 0===e||"string"==typeof e?t:(0,Dt.A)({},t,{ownerState:(0,Dt.A)({},t.ownerState,n)})}(n,(0,Dt.A)({},l,{ref:c}),a);return d}var Ut=n(62540);const Vt={disableDefaultClasses:!1},zt=r.createContext(Vt),Kt=["badgeContent","component","children","invisible","max","slotProps","slots","showZero"],Yt=r.forwardRef((function(e,t){const{component:n,children:a,max:s=99,slotProps:o={},slots:l={},showZero:i=!1}=e,c=(0,It.A)(e,Kt),{badgeContent:d,max:u,displayValue:m,invisible:p}=function(e){const{badgeContent:t,invisible:n=!1,max:a=99,showZero:s=!1}=e,o=(e=>{const t=r.useRef({});return r.useEffect((()=>{t.current=e})),t.current})({badgeContent:t,max:a});let l=n;!1!==n||0!==t||s||(l=!0);const{badgeContent:i,max:c=a}=l?o:e;return{badgeContent:i,invisible:l,max:c,displayValue:i&&Number(i)>c?`${c}+`:i}}((0,Dt.A)({},e,{max:s})),f=(0,Dt.A)({},e,{badgeContent:d,invisible:p,max:u,showZero:i}),h=(e=>{const{invisible:t}=e,n={root:["root"],badge:["badge",t&&"invisible"]};return(0,wt.A)(n,function(e){const{disableDefaultClasses:t}=r.useContext(zt);return n=>t?"":e(n)}(Lt))})(f),g=n||l.root||"span",E=Bt({elementType:g,externalSlotProps:o.root,externalForwardedProps:c,additionalProps:{ref:t},ownerState:f,className:h.root}),y=l.badge||"span",_=Bt({elementType:y,externalSlotProps:o.badge,ownerState:f,className:h.badge});return(0,Ut.jsxs)(g,(0,Dt.A)({},E,{children:[a,(0,Ut.jsx)(y,(0,Dt.A)({},_,{children:m}))]}))}));var Gt=n(60853);const Zt=a().createElement("svg",{width:"142",height:"87",viewBox:"0 0 142 87",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a().createElement("g",{clipPath:"url(#clip0_4212_90995)"},a().createElement("rect",{x:"15",y:"15",width:"112",height:"44",rx:"3",fill:"var(--button-bg)",fillOpacity:"0.12"}),a().createElement("path",{d:"M29.5 75L29.5 47L40 47",stroke:"var(--center-channel-color)",strokeOpacity:"0.32",strokeLinecap:"round"}),a().createElement("path",{d:"M45 43H29.5V9.5L22.5 2.5",stroke:"var(--center-channel-color)",strokeOpacity:"0.32",strokeLinecap:"round"}),a().createElement("circle",{cx:"2.5",cy:"2.5",r:"2.5",transform:"matrix(1 0 0 -1 20 5)",fill:"var(--center-channel-color)",fillOpacity:"0.48"}),a().createElement("circle",{cx:"2.5",cy:"2.5",r:"2.5",transform:"matrix(1 0 0 -1 27 78)",fill:"var(--center-channel-color)",fillOpacity:"0.48"}),a().createElement("path",{d:"M127 22.5L117 22.5L117 49",stroke:"var(--center-channel-color)",strokeOpacity:"0.32",strokeLinecap:"round"}),a().createElement("circle",{cx:"128.5",cy:"22.5",r:"2.5",fill:"var(--center-channel-color)",fillOpacity:"0.48"}),a().createElement("path",{d:"M54.605 67.5638L41 81V12C41 10.8954 41.8954 10 43 10H109C110.105 10 111 10.8954 111 12V64.9868C111 66.0914 110.105 66.9868 109 66.9868H56.0103C55.4842 66.9868 54.9793 67.1941 54.605 67.5638Z",fill:"#28427B"}),a().createElement("path",{d:"M49.605 62.5638L36 76V7C36 5.89543 36.8954 5 38 5H104C105.105 5 106 5.89543 106 7V59.9868C106 61.0914 105.105 61.9868 104 61.9868H51.0103C50.4842 61.9868 49.9793 62.1941 49.605 62.5638Z",fill:"var(--center-channel-bg)"}),a().createElement("path",{d:"M49.2536 62.2081L36.5 74.8035V7C36.5 6.17157 37.1716 5.5 38 5.5H104C104.828 5.5 105.5 6.17157 105.5 7V59.9868C105.5 60.8153 104.828 61.4868 104 61.4868H51.0103C50.3527 61.4868 49.7215 61.746 49.2536 62.2081Z",stroke:"var(--center-channel-color)",strokeOpacity:"0.8"}),a().createElement("circle",{cx:"54",cy:"24",r:"9",fill:"var(--center-channel-color)",fillOpacity:"0.32"}),a().createElement("path",{d:"M69 20H85",stroke:"var(--center-channel-color)",strokeOpacity:"0.48",strokeLinecap:"round"}),a().createElement("path",{d:"M46 44H96",stroke:"var(--center-channel-color)",strokeOpacity:"0.48",strokeLinecap:"round"}),a().createElement("path",{d:"M46 51H68",stroke:"var(--center-channel-color)",strokeOpacity:"0.48",strokeLinecap:"round"}),a().createElement("path",{d:"M69 26H94",stroke:"var(--center-channel-color)",strokeOpacity:"0.48",strokeLinecap:"round"}),a().createElement("path",{d:"M46 38H63",stroke:"var(--center-channel-color)",strokeOpacity:"0.48",strokeLinecap:"round"}),a().createElement("path",{d:"M67 38H85",stroke:"var(--center-channel-color)",strokeOpacity:"0.48",strokeLinecap:"round"}),a().createElement("path",{opacity:"0.32",d:"M114.218 87.29C106.772 87.1409 100.598 84.5917 95.6936 79.6423C90.7897 74.6929 88.2252 68.5281 88 61.1479C88.2213 53.7639 90.7859 47.5971 95.6936 42.6477C100.601 37.6983 106.776 35.1491 114.218 35C121.591 35.1529 127.73 37.7021 132.633 42.6477C137.537 47.5933 140.102 53.76 140.327 61.1479C140.098 68.5319 137.534 74.6967 132.633 79.6423C127.733 84.5879 121.595 87.1371 114.218 87.29Z",fill:"var(--center-channel-color)",fillOpacity:"0.32"}),a().createElement("path",{d:"M111.218 82.7899C103.897 82.6411 97.8524 80.1385 93.0488 75.2904C88.243 70.4399 85.7248 64.403 85.5002 57.1477C85.7211 49.8888 88.2392 43.8501 93.0487 38.9998C97.8561 34.1515 103.901 31.6489 111.218 31.5001C118.465 31.6526 124.474 34.1544 129.278 38.9998C134.084 43.8462 136.602 49.8848 136.827 57.1477C136.598 64.407 134.08 70.4439 129.278 75.2904C124.478 80.1356 118.469 82.6374 111.218 82.7899Z",fill:"var(--center-channel-bg)",stroke:"var(--center-channel-color)"}),a().createElement("path",{d:"M111.042 77C105.35 76.886 100.63 74.9359 96.8812 71.1498C93.1325 67.3636 91.1721 62.6478 91 57.0022C91.1692 51.3537 93.1296 46.6364 96.8812 42.8502C100.633 39.0641 105.353 37.114 111.042 37C116.678 37.1169 121.37 39.067 125.119 42.8502C128.867 46.6334 130.828 51.3508 131 57.0022C130.825 62.6507 128.865 67.3666 125.119 71.1498C121.373 74.933 116.681 76.8831 111.042 77Z",fill:"var(--center-channel-bg)"}),a().createElement("path",{d:"M111.041 76.4999C105.475 76.3862 100.885 74.4827 97.2365 70.798C93.5858 67.1108 91.6718 62.5228 91.5002 57.0021C91.6689 51.4785 93.583 46.8892 97.2364 43.2022C100.888 39.5172 105.478 37.6138 111.041 37.5001C116.552 37.6167 121.114 39.5192 124.764 43.2022C128.414 46.8862 130.328 51.4754 130.5 57.0021C130.325 62.5259 128.411 67.1139 124.763 70.798C121.117 74.4807 116.555 76.3833 111.041 76.4999Z",stroke:"var(--center-channel-color)",strokeOpacity:"0.32"}),a().createElement("path",{d:"M111 35.5V57L120.5 66.5",stroke:"var(--center-channel-color)",strokeOpacity:"0.8",strokeLinejoin:"round"}),a().createElement("circle",{cx:"111",cy:"57",r:"2",fill:"var(--center-channel-color)",fillOpacity:"0.8"})),a().createElement("defs",null,a().createElement("clipPath",{id:"clip0_4212_90995"},a().createElement("rect",{width:"142",height:"87",fill:"white"}))));function Wt(){const{formatMessage:e}=(0,g.useIntl)();return a().createElement(Gt.A,{expanded:!0,iconGraphic:Zt,title:e({id:"Schedule_post.empty_state.title",defaultMessage:"No scheduled drafts at the moment"}),subtitle:e({id:"Schedule_post.empty_state.subtitle",defaultMessage:"Schedule drafts to send messages at a later time. Any scheduled drafts will show up here and can be modified after being scheduled."})})}var Qt=n(54302);function Jt(e){const t=(0,Qt.I)().get("target_id"),n=(0,r.useRef)();return a().createElement(a().Fragment,null,e.scheduledPosts.map(((r,s)=>{const o=r.channel_id===t||r.root_id===t,l=Boolean(r.error_code);return!n.current&&o&&!l&&(n.current=r.id),a().createElement(Mt,{key:r.id,item:r,displayName:e.userDisplayName,status:e.userStatus,user:e.currentUser,scrollIntoView:n.current===r.id,containerClassName:b()("nonVirtualizedScheduledPostRow",{firstRow:0===s})})})))}Jt.propTypes={scheduledPosts:h().array.isRequired,userDisplayName:h().string.isRequired};var Xt=n(44553);function $t(){return a().createElement(Xt.A,{mode:"danger",className:"scheduledPostListErrorIndicator",message:a().createElement(g.FormattedMessage,{id:"scheduled_post.panel.error_indicator.message",defaultMessage:"One of your scheduled drafts cannot be sent."})})}function en(e){const t=(0,s.useDispatch)(),n=(0,s.useSelector)(q.Sy),o=(0,s.useSelector)((e=>(0,i.U)(e,n)));return(0,r.useEffect)((()=>{e.scheduledPosts.length>0&&t((0,G.jh)(e.scheduledPosts.map((e=>e.channel_id))))}),[t,e.scheduledPosts]),0===e.scheduledPosts.length?a().createElement(Wt,null):a().createElement("div",{className:"ScheduledPostList nonVirtualizedScheduledPostList"},o&&a().createElement($t,null),a().createElement(Jt,{scheduledPosts:e.scheduledPosts,currentUser:e.currentUser,userDisplayName:e.userDisplayName,userStatus:e.userStatus}))}en.propTypes={scheduledPosts:h().array.isRequired,userDisplayName:h().string.isRequired};var tn=n(89735);function nn(e){let{children:t,title:n,unmountOnExit:r,tabClassName:s,eventKey:o,tabIndex:l=-1}=e;return a().createElement(tn.Tab,{eventKey:o,title:n,unmountOnExit:r,tabClassName:s,tabIndex:l},t)}function rn(e){let{children:t,id:n,activeKey:r,unmountOnExit:s,onSelect:o,className:l,mountOnEnter:i}=e;return a().createElement(tn.Tabs,{id:n,activeKey:r,unmountOnExit:s,onSelect:o,className:b()("tabs",l),mountOnEnter:i,autoFocus:!0},t)}nn.propTypes={children:h().node,eventKey:h().any,tabIndex:h().number},rn.propTypes={children:h().node,id:h().string,activeKey:h().any,mountOnEnter:h().bool,unmountOnExit:h().bool,className:h().string};const an=[],sn="drafts",on="scheduled_posts";function ln(e){var t,n;const o=(0,T.useHistory)(),l=(0,T.useLocation)(),c=l.pathname.includes(ae.Mm),d=l.pathname.includes(ae.pj),u=(0,s.useSelector)(q.H7),m=null!==(t=null==u?void 0:u.name)&&void 0!==t?t:"",p=null!==(n=null==u?void 0:u.id)&&void 0!==n?n:"",f=(0,r.useMemo)((()=>(0,i.TY)()),[]),h=(0,s.useSelector)((e=>f(e,p,!0))),E=(0,r.useCallback)((e=>{e===sn?o.push("/".concat(m,"/drafts")):e===on&&o.push("/".concat(m,"/scheduled_posts"))}),[o,m]),y=(0,r.useMemo)((()=>a().createElement("div",{className:"drafts_tab_title"},a().createElement(g.FormattedMessage,{id:"schedule_post.tab.heading",defaultMessage:"Scheduled"}),(null==h?void 0:h.length)>0&&a().createElement(Yt,{className:"badge",badgeContent:h.length}))),[null==h?void 0:h.length]),_=(0,r.useMemo)((()=>a().createElement("div",{className:"drafts_tab_title"},a().createElement(g.FormattedMessage,{id:"drafts.heading",defaultMessage:"Drafts"}),e.drafts.length>0&&a().createElement(Yt,{className:"badge",badgeContent:e.drafts.length}))),[e.drafts.length]),v=(0,r.useMemo)((()=>c?sn:d?on:""),[c,d]);return a().createElement(rn,{id:"draft_tabs",activeKey:v,mountOnEnter:!0,unmountOnExit:!0,onSelect:E},a().createElement(nn,{eventKey:sn,title:_,unmountOnExit:!0,tabClassName:"drafts_tab",tabIndex:0},a().createElement(Rt,{drafts:e.drafts,currentUser:e.currentUser,userDisplayName:e.userDisplayName,userStatus:e.userStatus})),a().createElement(nn,{eventKey:on,title:y,unmountOnExit:!0,tabClassName:"drafts_tab"},a().createElement(en,{scheduledPosts:h||an,currentUser:e.currentUser,userDisplayName:e.userDisplayName,userStatus:e.userStatus})))}ln.propTypes={drafts:h().array.isRequired,userDisplayName:h().string.isRequired};const cn=[];function dn(){const e=(0,s.useDispatch)(),t=(0,s.useSelector)(i.Ck),n=(0,r.useMemo)((()=>(0,p.$P)()),[]),f=(0,s.useSelector)(n),h=(0,s.useSelector)(o.HW),g=(0,s.useSelector)((e=>(0,c.CB)(e,h.id))),E=(0,s.useSelector)(l.K3),y=(0,r.useMemo)((()=>(0,d.R4)(h,E)),[h,E]);return(0,r.useEffect)((()=>(e((0,u.bT)(Tt.L.Page,Tt.j.Drafts)),e(m.tU),()=>{e(m.ED)})),[e]),t?a().createElement(Pt,null,a().createElement(ln,{drafts:f||cn,currentUser:h,userDisplayName:y,userStatus:g})):a().createElement(Pt,null,a().createElement(Rt,{drafts:f||cn,currentUser:h,userDisplayName:y,userStatus:g}))}const un=(0,r.memo)(dn)},41125:(e,t,n)=>{n.d(t,{A:()=>c}),n(29206);var r=n(71633),a=n.n(r),s=n(36418),o=n.n(s);const l=["level","heading","subtitle","right"],i=[s.Fragment,"h1","h2","h3","h4","h5","h6"],c=e=>{let{level:t=0,heading:n,subtitle:r,right:s}=e,c=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,l);const d=i[t];return o().createElement("div",Object.assign({},c,{className:a()("Header",c.className)}),o().createElement("div",{className:"left"},o().createElement(d,null,n),r?o().createElement("p",null,r):null),o().createElement("div",{className:"spacer"}),s)}},54302:(e,t,n)=>{n.d(t,{I:()=>s}),n(3188),n(30973),n(17046),n(36169);var r=n(36418),a=n(81911);function s(){const{search:e}=(0,a.useLocation)();return(0,r.useMemo)((()=>new URLSearchParams(e)),[e])}}}]);
//# sourceMappingURL=2794.9d3b188dfa5038b79cb9.js.map