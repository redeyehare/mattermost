{"version":3,"file":"1428.e00bb22210de7a5edc5e.js","mappings":"iUAMA,MAiBA,EAjBqBA,GAEbC,IAAAA,cAAA,MAAAC,OAAAC,OAAA,CACIC,MAAM,KACNC,OAAO,KACPC,QAAQ,YACRC,KAAK,OACLC,MAAM,8BACFR,GAEJC,IAAAA,cAAA,QACIQ,EAAE,wf,cCUlB,MA4EA,EA5E0BC,KACtB,MAAM,cAACC,IAAiBC,EAAAA,EAAAA,WAClBC,GAAWC,EAAAA,EAAAA,eACXC,GAAmBC,EAAAA,EAAAA,aAAYC,EAAAA,KAE/B,IAACC,IAAOC,EAAAA,EAAAA,kBACR,SAACC,IAAYC,EAAAA,EAAAA,eACbC,EAAsF,OAApEC,EAAAA,EAAAA,WAAUH,EAAU,CAACI,KAAM,uCAC7C,cAACC,EAAa,cAAEC,IAAiBC,EAAAA,EAAAA,KAEjCC,GAASZ,EAAAA,EAAAA,aAAYa,EAAAA,IACrBC,EAAoBF,aAAM,EAANA,EAAQG,qBAC5BC,GAAUhB,EAAAA,EAAAA,aAAYiB,EAAAA,GACtBC,GAAWlB,EAAAA,EAAAA,aAAYmB,EAAAA,IACvBC,GAAcC,EAAAA,EAAAA,cAAaC,IAC7BA,EAAEC,kBAEFC,YAAYC,KAAKC,EAAAA,GAAKC,0BAElBX,GAAWE,IAAaU,EAAAA,GAAUC,cAClChC,GAASiC,EAAAA,EAAAA,MACb,GACD,CAACd,EAASE,IASb,OAPAa,EAAAA,EAAAA,YAAU,KAEFhC,GACAF,GAASmC,EAAAA,EAAAA,IAAgBtB,EAAeD,GAC5C,GACD,CAACC,EAAeD,EAAeV,IAE7BA,EAMDd,IAAAA,cAAA,MAAIgD,UAAU,iEACVhD,IAAAA,cAAA,MACIiD,GAAI,yBACJD,UAAWE,IAAW,iBAAkB,CACpCC,OAAQ9B,EACR+B,OAAQvB,IAEZwB,UAAW,GAEXrD,IAAAA,cAACsD,EAAAA,KAAI,CACDC,QAASpB,EACTqB,GAAE,GAAAC,OAAKxC,EAAG,YACVgC,GAAG,sBACHS,UAAU,QACVV,UAAWE,IAAW,2BAA4B,CAC9C,eAAgBS,QAAQ9B,KAE5BwB,SAAU,GAEVrD,IAAAA,cAAA,QAAMgD,UAAU,QACZhD,IAAAA,cAAC4D,EAAW,OAEhB5D,IAAAA,cAAA,OAAKgD,UAAU,mCACXhD,IAAAA,cAAA,QAAMgD,UAAU,8CACXtC,EAAc,CAACuC,GAAI,4BAA6BY,eAAgB,eAGxElC,aAAM,EAANA,EAAQmC,uBAAwB,GAC7B9D,IAAAA,cAAC+D,EAAAA,EAAmB,CAChBC,eAAgBrC,EAAOmC,sBACvBG,UAAWN,QAAQhC,aAAM,EAANA,EAAQuC,mCAlCxC,IAuCF,C,6GCnFN,SAASxC,IACZ,MAAMyC,GAAcC,EAAAA,EAAAA,aACdC,GAASC,EAAAA,EAAAA,UAAQ,IAAMH,GAAa,CAACA,EAAYI,iBAAkBJ,EAAYK,OAC/EC,GAAUC,EAAAA,EAAAA,cAEVlD,GAAgBT,EAAAA,EAAAA,aAAY4D,EAAAA,GAAkBC,EAAAA,cAC9CnD,GAAgBV,EAAAA,EAAAA,aAAY8D,EAAAA,GAAkBD,EAAAA,cAE9CE,GAAS1C,EAAAA,EAAAA,cAAa2C,GACjBN,EAAQO,KAAK,IAADvB,OAAKY,EAAOG,KAAI,YAAAf,OAAWsB,EAAW,IAAMA,EAAW,MAC3E,CAACV,EAAOG,OAELS,GAAQ7C,EAAAA,EAAAA,cAAY,IAAMqC,EAAQS,QAAQ,IAADzB,OAAKY,EAAOG,KAAI,cAAa,CAACH,EAAOG,OAE9EW,GAAgB/C,EAAAA,EAAAA,cAAY,SAAC2C,GAAsE,IAAzCK,EAAsBC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAGhB,EAAOG,KAC5F,OAAOC,EAAQO,KAAK,IAADvB,OAAK2B,EAAQ,QAAA3B,OAAOsB,QAAAA,EAAYV,EAAOE,kBAC9D,GAAG,CAACF,EAAOE,iBAAkBF,EAAOG,OAEpC,MAAO,CACHH,SACAI,UACAjD,gBACAC,gBACAwD,QACAH,SACAK,gBAER,C","sources":["webpack://mattermost-webapp/./src/components/threading/global_threads_link/threads_icon.tsx","webpack://mattermost-webapp/./src/components/threading/global_threads_link/global_threads_link.tsx","webpack://mattermost-webapp/./src/components/threading/hooks.ts"],"sourcesContent":["// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport type {HTMLAttributes} from 'react';\r\n\r\nconst ThreadsIcon = (attrs: HTMLAttributes<SVGElement>) => {\r\n    return (\r\n        <svg\r\n            width='18'\r\n            height='18'\r\n            viewBox='0 0 14 13'\r\n            fill='none'\r\n            xmlns='http://www.w3.org/2000/svg'\r\n            {...attrs}\r\n        >\r\n            <path\r\n                d='M11.7952 0.00524884C12.1312 0.00524884 12.4144 0.125249 12.6448 0.365248C12.8848 0.595648 13.0048 0.878848 13.0048 1.21485V8.41485C13.0048 8.75085 12.8848 9.03405 12.6448 9.26445C12.4144 9.49485 12.1312 9.61005 11.7952 9.61005H3.4L0.9952 12.0148V1.21485C0.9952 0.878848 1.1104 0.595648 1.3408 0.365248C1.5808 0.125249 1.8688 0.00524884 2.2048 0.00524884H11.7952ZM2.2048 1.21485V9.10605L2.896 8.41485H11.7952V1.21485H2.2048ZM3.4 3.01485H10.6V4.21005H3.4V3.01485ZM3.4 5.40525H8.8V6.61485H3.4V5.40525Z'\r\n            />\r\n        </svg>\r\n    );\r\n};\r\n\r\nexport default ThreadsIcon;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React, {useCallback, useEffect} from 'react';\r\nimport {useIntl} from 'react-intl';\r\nimport {useSelector, useDispatch} from 'react-redux';\r\nimport {Link, useRouteMatch, useLocation, matchPath} from 'react-router-dom';\r\n\r\nimport {getThreadCounts} from 'mattermost-redux/actions/threads';\r\nimport {isCollapsedThreadsEnabled} from 'mattermost-redux/selectors/entities/preferences';\r\nimport {getThreadCountsInCurrentTeam} from 'mattermost-redux/selectors/entities/threads';\r\n\r\nimport {closeRightHandSide} from 'actions/views/rhs';\r\nimport {getIsRhsOpen, getRhsState} from 'selectors/rhs';\r\n\r\nimport ChannelMentionBadge from 'components/sidebar/sidebar_channel/channel_mention_badge';\r\n\r\nimport {RHSStates} from 'utils/constants';\r\nimport {Mark} from 'utils/performance_telemetry';\r\n\r\nimport ThreadsIcon from './threads_icon';\r\n\r\nimport {useThreadRouting} from '../hooks';\r\n\r\nimport './global_threads_link.scss';\r\n\r\nconst GlobalThreadsLink = () => {\r\n    const {formatMessage} = useIntl();\r\n    const dispatch = useDispatch();\r\n    const isFeatureEnabled = useSelector(isCollapsedThreadsEnabled);\r\n\r\n    const {url} = useRouteMatch();\r\n    const {pathname} = useLocation();\r\n    const inGlobalThreads = matchPath(pathname, {path: '/:team/threads/:threadIdentifier?'}) != null;\r\n    const {currentTeamId, currentUserId} = useThreadRouting();\r\n\r\n    const counts = useSelector(getThreadCountsInCurrentTeam);\r\n    const someUnreadThreads = counts?.total_unread_threads;\r\n    const rhsOpen = useSelector(getIsRhsOpen);\r\n    const rhsState = useSelector(getRhsState);\r\n    const openThreads = useCallback((e: React.MouseEvent) => {\r\n        e.stopPropagation();\r\n\r\n        performance.mark(Mark.GlobalThreadsLinkClicked);\r\n\r\n        if (rhsOpen && rhsState === RHSStates.EDIT_HISTORY) {\r\n            dispatch(closeRightHandSide());\r\n        }\r\n    }, [rhsOpen, rhsState]);\r\n\r\n    useEffect(() => {\r\n        // load counts if necessary\r\n        if (isFeatureEnabled) {\r\n            dispatch(getThreadCounts(currentUserId, currentTeamId));\r\n        }\r\n    }, [currentUserId, currentTeamId, isFeatureEnabled]);\r\n\r\n    if (!isFeatureEnabled) {\r\n        // hide link if feature disabled\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <ul className='SidebarGlobalThreads NavGroupContent nav nav-pills__container'>\r\n            <li\r\n                id={'sidebar-threads-button'}\r\n                className={classNames('SidebarChannel', {\r\n                    active: inGlobalThreads,\r\n                    unread: someUnreadThreads,\r\n                })}\r\n                tabIndex={-1}\r\n            >\r\n                <Link\r\n                    onClick={openThreads}\r\n                    to={`${url}/threads`}\r\n                    id='sidebarItem_threads'\r\n                    draggable='false'\r\n                    className={classNames('SidebarLink sidebar-item', {\r\n                        'unread-title': Boolean(someUnreadThreads),\r\n                    })}\r\n                    tabIndex={0}\r\n                >\r\n                    <span className='icon'>\r\n                        <ThreadsIcon/>\r\n                    </span>\r\n                    <div className='SidebarChannelLinkLabel_wrapper'>\r\n                        <span className='SidebarChannelLinkLabel sidebar-item__name'>\r\n                            {formatMessage({id: 'globalThreads.sidebarLink', defaultMessage: 'Threads'})}\r\n                        </span>\r\n                    </div>\r\n                    {counts?.total_unread_mentions > 0 && (\r\n                        <ChannelMentionBadge\r\n                            unreadMentions={counts.total_unread_mentions}\r\n                            hasUrgent={Boolean(counts?.total_unread_urgent_mentions)}\r\n                        />\r\n                    )}\r\n                </Link>\r\n            </li>\r\n        </ul>\r\n    );\r\n};\r\n\r\nexport default GlobalThreadsLink;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {useMemo, useCallback} from 'react';\r\nimport {useSelector, shallowEqual} from 'react-redux';\r\nimport {useParams, useHistory} from 'react-router-dom';\r\n\r\nimport type {Team} from '@mattermost/types/teams';\r\nimport type {UserThread} from '@mattermost/types/threads';\r\n\r\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\r\n\r\n/**\r\n * GlobalThreads-specific hook for nav/routing, selection, and common data needed for actions.\r\n */\r\nexport function useThreadRouting() {\r\n    const matchParams = useParams<{team: string; threadIdentifier?: UserThread['id']}>();\r\n    const params = useMemo(() => matchParams, [matchParams.threadIdentifier, matchParams.team]);\r\n    const history = useHistory();\r\n\r\n    const currentTeamId = useSelector(getCurrentTeamId, shallowEqual);\r\n    const currentUserId = useSelector(getCurrentUserId, shallowEqual);\r\n\r\n    const select = useCallback((threadId?: UserThread['id']) => {\r\n        return history.push(`/${params.team}/threads${threadId ? '/' + threadId : ''}`);\r\n    }, [params.team]);\r\n\r\n    const clear = useCallback(() => history.replace(`/${params.team}/threads`), [params.team]);\r\n\r\n    const goToInChannel = useCallback((threadId?: UserThread['id'], teamName: Team['name'] = params.team) => {\r\n        return history.push(`/${teamName}/pl/${threadId ?? params.threadIdentifier}`);\r\n    }, [params.threadIdentifier, params.team]);\r\n\r\n    return {\r\n        params,\r\n        history,\r\n        currentTeamId,\r\n        currentUserId,\r\n        clear,\r\n        select,\r\n        goToInChannel,\r\n    };\r\n}\r\n"],"names":["attrs","React","Object","assign","width","height","viewBox","fill","xmlns","d","GlobalThreadsLink","formatMessage","useIntl","dispatch","useDispatch","isFeatureEnabled","useSelector","isCollapsedThreadsEnabled","url","useRouteMatch","pathname","useLocation","inGlobalThreads","matchPath","path","currentTeamId","currentUserId","useThreadRouting","counts","getThreadCountsInCurrentTeam","someUnreadThreads","total_unread_threads","rhsOpen","getIsRhsOpen","rhsState","getRhsState","openThreads","useCallback","e","stopPropagation","performance","mark","Mark","GlobalThreadsLinkClicked","RHSStates","EDIT_HISTORY","closeRightHandSide","useEffect","getThreadCounts","className","id","classNames","active","unread","tabIndex","Link","onClick","to","concat","draggable","Boolean","ThreadsIcon","defaultMessage","total_unread_mentions","ChannelMentionBadge","unreadMentions","hasUrgent","total_unread_urgent_mentions","matchParams","useParams","params","useMemo","threadIdentifier","team","history","useHistory","getCurrentTeamId","shallowEqual","getCurrentUserId","select","threadId","push","clear","replace","goToInChannel","teamName","arguments","length","undefined"],"sourceRoot":""}