{"version":3,"file":"6676.078c12aca657f180d333.js","mappings":"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","sources":["webpack://mattermost-webapp/./src/components/system_notice/notices.tsx","webpack://mattermost-webapp/./src/components/system_notice/system_notice.tsx","webpack://mattermost-webapp/./src/components/system_notice/index.ts"],"sourcesContent":["// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {Notice} from 'components/system_notice/types';\r\n\r\n// Notices are objects with the following fields:\r\n//  - name - string identifier\r\n//  - adminOnly - set to true if only system admins should see this message\r\n//  - icon - the image to display for the notice icon\r\n//  - title - JSX node to display for the notice title\r\n//  - body - JSX node to display for the notice body\r\n//  - allowForget - boolean to allow forget the notice\r\n//  - show - function that check if we need to show the notice\r\n//\r\n// Order is important! The notices at the top are shown first.\r\n\r\n// All legacy notices have been deprecated and removed.\r\n// Add new notices to this array as needed.\r\nconst notices: Notice[] = [];\r\n\r\nexport default notices;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage, injectIntl, type WrappedComponentProps} from 'react-intl';\r\n\r\nimport type {AnalyticsState} from '@mattermost/types/admin';\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {ClientConfig, ClientLicense} from '@mattermost/types/config';\r\nimport type {PreferenceType} from '@mattermost/types/preferences';\r\n\r\nimport type {Notice} from 'components/system_notice/types';\r\nimport MattermostLogo from 'components/widgets/icons/mattermost_logo';\r\n\r\nimport {Preferences} from 'utils/constants';\r\n\r\nexport interface Props extends WrappedComponentProps {\r\n    currentUserId: string;\r\n    notices: Notice[];\r\n    preferences: {[key: string]: any};\r\n    dismissedNotices: any;\r\n    isSystemAdmin?: boolean;\r\n    serverVersion: string;\r\n    config: Partial<ClientConfig>;\r\n    license: ClientLicense;\r\n    analytics?: AnalyticsState;\r\n    currentChannel?: Channel;\r\n    actions: {\r\n        savePreferences(userId: string, preferences: PreferenceType[]): void;\r\n        dismissNotice(type: string): void;\r\n        getStandardAnalytics(teamId?: string): void;\r\n    };\r\n}\r\nexport class SystemNotice extends React.PureComponent<Props> {\r\n    componentDidMount() {\r\n        if (this.props.isSystemAdmin) {\r\n            this.props.actions.getStandardAnalytics();\r\n        }\r\n    }\r\n\r\n    componentDidUpdate(prevProps: Props) {\r\n        if (prevProps.isSystemAdmin !== this.props.isSystemAdmin && this.props.isSystemAdmin) {\r\n            this.props.actions.getStandardAnalytics();\r\n        }\r\n    }\r\n\r\n    getCurrentNotice = () => {\r\n        for (const notice of this.props.notices) {\r\n            // Skip if dismissed previously this session\r\n            if (this.props.dismissedNotices[notice.name]) {\r\n                continue;\r\n            }\r\n\r\n            // Skip if dismissed forever\r\n            if (this.props.preferences[notice.name]) {\r\n                continue;\r\n            }\r\n\r\n            if (notice.adminOnly && !this.props.isSystemAdmin) {\r\n                continue;\r\n            }\r\n\r\n            if (!notice.show?.(\r\n                this.props.serverVersion,\r\n                this.props.config,\r\n                this.props.license,\r\n                this.props.analytics,\r\n                this.props.currentChannel,\r\n            )) {\r\n                continue;\r\n            }\r\n\r\n            return notice;\r\n        }\r\n        return null;\r\n    };\r\n\r\n    hide = (remind = false) => {\r\n        const notice = this.getCurrentNotice();\r\n        if (!notice) {\r\n            return;\r\n        }\r\n\r\n        if (!remind) {\r\n            this.props.actions.savePreferences(this.props.currentUserId, [{\r\n                user_id: this.props.currentUserId,\r\n                category: Preferences.CATEGORY_SYSTEM_NOTICE,\r\n                name: notice.name,\r\n                value: 'dismissed',\r\n            }]);\r\n        }\r\n\r\n        this.props.actions.dismissNotice(notice.name);\r\n    };\r\n\r\n    hideAndRemind = () => {\r\n        this.hide(true);\r\n    };\r\n\r\n    hideAndForget = () => {\r\n        this.hide(false);\r\n    };\r\n\r\n    render() {\r\n        const notice = this.getCurrentNotice();\r\n\r\n        if (notice == null) {\r\n            return null;\r\n        }\r\n\r\n        let visibleMessage;\r\n        if (notice.adminOnly) {\r\n            visibleMessage = (\r\n                <div className='system-notice__info'>\r\n                    <i\r\n                        className='fa fa-eye'\r\n                        title={this.props.intl.formatMessage({id: 'system_notice.adminVisible.icon', defaultMessage: 'Only visible to System Admins Icon'})}\r\n                    />\r\n                    <FormattedMessage\r\n                        id='system_notice.adminVisible'\r\n                        defaultMessage='Only visible to System Admins'\r\n                    />\r\n                </div>\r\n            );\r\n        }\r\n\r\n        const icon = notice.icon || <MattermostLogo/>;\r\n\r\n        return (\r\n            <div\r\n                className='system-notice bg--white'\r\n            >\r\n                <div className='system-notice__logo'>\r\n                    {icon}\r\n                </div>\r\n                <div className='system-notice__body'>\r\n                    <div className='system-notice__title'>\r\n                        {notice.title}\r\n                    </div>\r\n                    {notice.body}\r\n                    {visibleMessage}\r\n                    <div className='system-notice__footer'>\r\n                        <button\r\n                            id='systemnotice_remindme'\r\n                            className='btn btn-sm btn-primary'\r\n                            onClick={this.hideAndRemind}\r\n                        >\r\n                            <FormattedMessage\r\n                                id='system_notice.remind_me'\r\n                                defaultMessage='Remind Me Later'\r\n                            />\r\n                        </button>\r\n                        {notice.allowForget &&\r\n                            <button\r\n                                id='systemnotice_dontshow'\r\n                                className='btn btn-sm btn-tertiary'\r\n                                onClick={this.hideAndForget}\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='system_notice.dont_show'\r\n                                    defaultMessage=\"Don't Show Again\"\r\n                                />\r\n                            </button>}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default injectIntl(SystemNotice);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {PreferenceType} from '@mattermost/types/preferences';\r\n\r\nimport {getStandardAnalytics} from 'mattermost-redux/actions/admin';\r\nimport {savePreferences} from 'mattermost-redux/actions/preferences';\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {createSelector} from 'mattermost-redux/selectors/create_selector';\r\nimport {getCurrentChannel} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getConfig, getLicense} from 'mattermost-redux/selectors/entities/general';\r\nimport {makeGetCategory} from 'mattermost-redux/selectors/entities/preferences';\r\nimport {haveISystemPermission} from 'mattermost-redux/selectors/entities/roles';\r\n\r\nimport {dismissNotice} from 'actions/views/notice';\r\n\r\nimport Notices from 'components/system_notice/notices';\r\nimport SystemNotice from 'components/system_notice/system_notice';\r\n\r\nimport {Preferences} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nconst getSystemNoticePreferences = makeGetCategory('getSystemNoticePreferences', Preferences.CATEGORY_SYSTEM_NOTICE);\r\nconst getPreferenceNameMap = createSelector(\r\n    'getPreferenceNameMap',\r\n    getSystemNoticePreferences,\r\n    (preferences) => {\r\n        const nameMap: {[key: string]: PreferenceType} = {};\r\n        preferences.forEach((p) => {\r\n            nameMap[p.name] = p;\r\n        });\r\n        return nameMap;\r\n    },\r\n);\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const license = getLicense(state);\r\n    const config = getConfig(state);\r\n    const serverVersion = state.entities.general.serverVersion;\r\n    const analytics = state.entities.admin.analytics;\r\n\r\n    return {\r\n        currentUserId: state.entities.users.currentUserId,\r\n        preferences: getPreferenceNameMap(state),\r\n        dismissedNotices: state.views.notice.hasBeenDismissed,\r\n        isSystemAdmin: haveISystemPermission(state, {permission: Permissions.MANAGE_SYSTEM}),\r\n        notices: Notices,\r\n        config,\r\n        license,\r\n        serverVersion,\r\n        analytics,\r\n        currentChannel: getCurrentChannel(state),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            savePreferences,\r\n            dismissNotice,\r\n            getStandardAnalytics,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(SystemNotice);\r\n"],"names":["SystemNotice","React","constructor","_this","arguments","this","_defineProperty","notice","props","notices","_notice$show","dismissedNotices","name","preferences","adminOnly","isSystemAdmin","show","call","serverVersion","config","license","analytics","currentChannel","remind","length","undefined","getCurrentNotice","actions","savePreferences","currentUserId","user_id","category","Preferences","CATEGORY_SYSTEM_NOTICE","value","dismissNotice","hide","componentDidMount","getStandardAnalytics","componentDidUpdate","prevProps","render","visibleMessage","className","title","intl","formatMessage","id","defaultMessage","FormattedMessage","icon","MattermostLogo","body","onClick","hideAndRemind","allowForget","hideAndForget","_pt","isRequired","injectIntl","getSystemNoticePreferences","makeGetCategory","getPreferenceNameMap","createSelector","nameMap","forEach","p","connect","state","getLicense","getConfig","entities","general","admin","users","views","hasBeenDismissed","haveISystemPermission","permission","Permissions","MANAGE_SYSTEM","Notices","getCurrentChannel","dispatch","bindActionCreators"],"sourceRoot":""}