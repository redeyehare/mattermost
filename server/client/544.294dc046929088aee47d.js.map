{"version":3,"file":"544.294dc046929088aee47d.js","mappings":"0PAWO,SAASA,EAAeC,EAAmBC,GAC9C,MAAO,CAACC,EAAUC,KACd,MAAMC,EAAQD,IACRE,GAAeC,EAAAA,EAAAA,IAAgBF,GACrC,OAAOF,ECFR,SAAwBF,EAAmBC,EAAYI,GAC1D,OAAOE,MAAOL,EAAUC,KACpB,MAAMC,EAAQD,IACRK,GAAWC,EAAAA,EAAAA,GAAmBL,EAAOJ,EAAWC,GAEtD,UACUS,EAAAA,GAAQC,sBAAsBX,EAAWC,EAAII,GAEnDH,EAAS,CACLU,KAAMC,EAAAA,GAAqBC,iBAC3BC,KAAMP,GAEd,CAAE,MAAOQ,GACL,MAAO,CACHD,MAAM,EACNC,QAER,CAEA,MAAO,CAACD,MAAM,EAAK,CAE3B,CDnBwBE,CAAuBjB,EAAWC,EAAII,GAAc,CAE5E,CAEO,SAASa,EAAelB,EAAmBQ,GAC9C,MAAO,CAACN,EAAUC,KACd,MAAMC,EAAQD,IACRE,GAAeC,EAAAA,EAAAA,IAAgBF,GACrC,OAAOF,ECaR,SAAwBF,EAAmBQ,EAAiCH,GAC/E,OAAOE,UACH,IACI,MAAMY,QAAwBT,EAAAA,GAAQU,sBAAsBpB,EAAWQ,EAAUH,GAEjFH,EAAS,CACLU,KAAMC,EAAAA,GAAqBQ,kBAC3BN,KAAMI,GAEd,CAAE,MAAOH,GACL,MAAO,CACHD,MAAM,EACNC,QAER,CAEA,MAAO,CAACD,MAAM,EAAK,CAE3B,CD/BwBE,CAAuBjB,EAAWQ,EAAUH,GAAc,CAElF,CAEO,SAASiB,EAAatB,EAAmBC,EAAYsB,GACxD,OAAOhB,MAAOL,EAAUC,KACpB,MAAMC,EAAQD,IACRE,GAAeC,EAAAA,EAAAA,IAAgBF,GACrC,OAAOF,ECyBR,SAAsBF,EAAmBC,EAAYsB,EAA6BlB,GACrF,OAAOE,UACH,IACI,MAAM,QAACiB,EAAO,QAAEC,SAAiBf,EAAAA,GAAQgB,sBAAsB1B,EAAWC,EAAIsB,EAAOlB,GAEjFmB,GACAtB,EAAS,CACLU,KAAMC,EAAAA,GAAqBQ,kBAC3BN,KAAMS,IAIVC,GACAvB,EAAS,CACLU,KAAMC,EAAAA,GAAqBC,iBAC3BC,KAAMU,GAGlB,CAAE,MAAOT,GACL,MAAO,CACHD,MAAM,EACNC,QAER,CAEA,MAAO,CAACD,MAAM,EAAK,CAE3B,CDpDwBE,CAAqBjB,EAAWC,EAAIsB,EAAOlB,GAAc,CAEjF,CAEO,SAASsB,EAAgB3B,EAAmBC,EAAY2B,GAC3D,MAAO,CAAC1B,EAAUC,KACd,MAAMC,EAAQD,IACRE,GAAeC,EAAAA,EAAAA,IAAgBF,GACrC,OAAOF,EC8CR,SAAyBF,EAAmBC,EAAY2B,EAAkBvB,GAC7E,OAAOE,UACH,IACI,MAAMsB,QAAkBnB,EAAAA,GAAQoB,+BAA+B9B,EAAWC,EAAI2B,EAAUvB,GAExFH,EAAS,CACLU,KAAMC,EAAAA,GAAqBkB,mBAC3BhB,KAAM,CAACf,YAAW6B,cAE1B,CAAE,MAAOb,GACL,MAAO,CACHD,MAAM,EACNC,QAER,CAEA,MAAO,CAACD,MAAM,EAAK,CAE3B,CDhEwBE,CAAwBjB,EAAWC,EAAI2B,EAAUvB,GAAc,CAEvF,CAEO,SAAS2B,EAAsBhC,GAClC,OC6DG,SAA+BA,GAClC,OAAOO,MAAOL,EAAUC,KACpB,IAAI0B,EACJ,IACIA,QAAkBnB,EAAAA,GAAQuB,oBAAoBjC,GAE9CE,EAAS,CACLU,KAAMC,EAAAA,GAAqBkB,mBAC3BhB,KAAM,CAACf,YAAW6B,cAE1B,CAAE,MAAOb,GAGL,OAFAkB,EAAAA,EAAAA,IAAuBlB,EAAOd,EAAUC,GACxCD,GAASiC,EAAAA,EAAAA,IAASnB,IACX,CAACA,QACZ,CAEA,MAAO,CAACD,KAAMc,EAAU,CAEhC,CD/EWZ,CAA8BjB,EACzC,C,uNE7BO,SAASoC,EAAuBC,GACnC,MAAO,CACHzB,KAAM0B,EAAAA,GAAYC,0BAClBF,UAER,CAEO,SAASG,EAAiBzB,GAC7B,MAAO,CACHH,KAAM0B,EAAAA,GAAYG,2BAClB1B,OAER,CAEO,SAAS2B,IACZ,MAAO,CAAC9B,KAAM0B,EAAAA,GAAYK,sBAC9B,CAEO,SAASC,EAAeC,EAAgBC,EAAqBC,GAChE,OAAOxC,MAAOL,EAAUC,KACpB,GAAI4C,EAAY,CACZ,MACMC,EADQ7C,IACwB8C,MAAMC,eAAeF,wBAC3DD,EAAWI,SAASnD,IACZgD,EAAwBI,QAAQpD,IAAc,GAC9CE,EAASmD,EAAsBrD,GACnC,GAER,CAEA,MAAMsD,QAAepD,GAASqD,EAAAA,EAAAA,IAAoBV,EAAQC,EAAaC,IACvE,OAAO7C,EAAS,CACZU,KAAM0B,EAAAA,GAAYkB,oBAClBzC,KAAMuC,EAAOvC,KAAMd,IACrB,CAEV,CAIO,SAASwD,EAAqBC,EAAoB1D,GACrD,OAAO2D,EAAsBD,EAAY,EAAG1D,GAAW,EAC3D,CAIO,SAAS2D,EAAsBD,EAAoBE,EAAqBC,GAA+E,IAAnDC,IAAgBC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,KAAAA,UAAA,GACvH,MAAO,CAAC7D,EAAUC,KACd,MAAMC,EAAQD,IACR6C,EAA0B5C,EAAM6C,MAAMC,eAAeF,wBAC3D,IAAID,EAAa,GAGjB,GAAIC,EAAwBgB,SAAmE,IAAzDhB,EAAwBI,QAAQS,GAA4B,CAC9F,MAAMK,GAAaC,EAAAA,EAAAA,IAA4B/D,GACzCgE,GAAoBC,EAAAA,EAAAA,IAAqBjE,GAE/C,IAAIkE,EAAiB,CAACT,GAGtB,MAAMU,EAAiBL,EAAWM,MAAMC,GAAaA,EAASxE,KAAOyD,IACrEY,EAAiBtB,EAAwB0B,QAAQ1E,IAC7C,MAAM2E,EAAkBP,EAAkBI,MAAMI,GAAY5E,IAAc4E,EAAQ3E,KAC5E4E,GAASF,aAAe,EAAfA,EAAiB/D,QAASkE,EAAAA,GAAQC,aAAcJ,aAAe,EAAfA,EAAiB/D,QAASkE,EAAAA,GAAQE,WACjG,OAAOT,aAAc,EAAdA,EAAgB3D,QAASqE,EAAAA,EAAcC,SAAUX,aAAc,EAAdA,EAAgB3D,QAASqE,EAAAA,EAAcE,WAAcN,IAAUN,aAAc,EAAdA,EAAgB3D,QAASqE,EAAAA,EAAcG,kBAAsBP,IAAUN,aAAc,EAAdA,EAAgB3D,QAASqE,EAAAA,EAAcG,eAAgB,IAIzP,MAAMC,EAAsBjB,EAAkBkB,KAAKV,GAAYA,EAAQ3E,KACvEqE,EAAeiB,MAAK,CAACC,EAAGC,IAAMJ,EAAoBjC,QAAQoC,GAAKH,EAAoBjC,QAAQqC,KAG3FnB,EAAenB,SAASnD,GAAcE,EAASmD,EAAsBrD,MACrE+C,EAAauB,CACjB,MACIvB,EAAa,CAACc,GAGlB,MAAM6B,EAKP,SAAkCtF,EAAoBsD,EAAoBX,EAAsBa,EAAqBC,GACxH,GAAoB,IAAhBD,EAEA,OAAO,EAGX,MAAMa,GAAWkB,EAAAA,EAAAA,IAAYvF,EAAOsD,GAC9BkC,GAAqBC,EAAAA,EAAAA,KAAAA,CAA+BzF,EAAOqE,GAI3DqB,EAA6BF,EAAmBlB,QAAO,CAACE,EAASmB,IAAUnB,IAAYf,IAAuD,IAAjCd,EAAWK,QAAQwB,IAAmBmB,GAASnC,IAC5JoC,EAAepC,EAAckC,EAA2B9B,OAE9D,GAAIS,EAASwB,YAAYjC,SAAW4B,EAAmB5B,OAEnD,OAAOgC,EAGX,MAAME,GAAoBC,EAAAA,EAAAA,IAAgCP,EAAoB7C,EAAYiD,GAGpFI,EAAoBF,EAAkBA,EAAkB9C,QAAQL,EAAW,IAAM,GAGvF,IAAI2C,EAAWjB,EAASwB,YAAY7C,QAAQgD,GAAqB,EAMjE,MAAMC,EAAc5B,EAASwB,YAAY7C,QAAQL,EAAW,IAK5D,OAJqB,IAAjBsD,GAAsBA,EAAcX,IACpCA,GAAY,GAGTY,KAAKC,IAAIb,EAAWI,EAA2B9B,OAAQ,EAClE,CA1CyBwC,CAAyBpG,EAAOsD,EAAYX,EAAYa,EAAaC,GACtF,OAAO3D,GAASuG,EAAAA,EAAAA,IAAuB/C,EAAYX,EAAY2C,EAAU5B,GAAkB,CAEnG,CAyCO,SAAS4C,IACZ,MAAO,CAACxG,EAAUC,IAGoD,IAFpDA,IAEJ8C,MAAMC,eAAeF,wBAAwBgB,OAE5C,CAACjD,MAAM,IAGlBb,EAAS,CACLU,KAAM0B,EAAAA,GAAYqE,4BAGf,CAAC5F,MAAM,GAEtB,CAEO,SAASsC,EAAsBrD,GAClC,MAAO,CAACE,EAAUC,KACd,MAAMC,EAAQD,IAId,IAHgCC,EAAM6C,MAAMC,eAAeF,wBAG9BgB,OAAQ,CACjC,MAAM4C,GAAiBC,EAAAA,EAAAA,IAAoBzG,GAC3CF,EAAS,CACLU,KAAM0B,EAAAA,GAAYwE,oBAClB/F,KAAM6F,GAEd,CAEA,OAAO1G,EAAS,CACZU,KAAM0B,EAAAA,GAAYyE,wBAClBhG,KAAMf,GACR,CAEV,CAIO,SAASgH,EAAqBhH,GACjC,MAAO,CAACE,EAAUC,KACd,MAAMC,EAAQD,IACR6C,EAA0B5C,EAAM6C,MAAMC,eAAeF,wBAC3D,IAAIiE,EAAe7G,EAAM6C,MAAMC,eAAegE,oBAG9C,IAAKlE,EAAwBgB,OAAQ,CACjC,MAAM4C,GAAiBC,EAAAA,EAAAA,IAAoBzG,GAC3CF,EAAS,CACLU,KAAM0B,EAAAA,GAAYwE,oBAClB/F,KAAM6F,IAEVK,EAAeL,CACnB,CAEA,MAAMO,GAAwBC,EAAAA,EAAAA,IAA2BhH,GAAOkF,KAAKV,GAAYA,EAAQ3E,KACnFoH,EAAqBF,EAAsB/D,QAAQpD,GACnDsH,EAAsBH,EAAsB/D,QAAQ6D,GAM1D,GAAII,IAAeC,EACf,MAAO,CAACvG,MAAM,GAGlB,MAAMwG,EAAgBjB,KAAKkB,IAAIF,EAAaD,GACtCI,EAAcnB,KAAKC,IAAIe,EAAaD,GAEpCK,EAAYP,EAAsBQ,MAAMJ,EAAOE,EAAM,GAK3D,OAAOvH,EAAS,CACZU,KAAM0B,EAAAA,GAAYsF,uBAClB7G,KAAM2G,GACR,CAEV,C,06BClKO,MAAMG,UAA8BC,IAAAA,cAKvC,+BAAOC,CAAyBC,EAAc5H,GAC1C,MAAO,CAAC6H,SAAUD,EAAMC,SAAUC,KAAMF,EAAMC,WAAa7H,EAAM6H,SAAW,EAAI7H,EAAM8H,KAC1F,CAEAC,WAAAA,CAAYH,GACRI,MAAMJ,GAAOK,EAAA,kBA2BJC,IACT,MAAMC,EAASD,EAAEC,OACXC,GAAoBC,EAAAA,EAAAA,GAAaH,EAAGI,EAAAA,GAAUC,SAASC,OACzDJ,IAAsBF,EAAEO,UAAYP,EAAEQ,SAAWR,EAAES,SAGnDP,SAAqBD,GAAAA,EAAQS,UAAUC,SAAS,oBAChDV,EAAOW,OACX,IACHb,EAAA,mBAEY,CAACzD,EAAkB0D,KAC5BA,EAAEa,kBACFC,KAAKC,SAAS,CAACC,eAAgB1E,EAAQ3E,KACvCmJ,KAAKpB,MAAMuB,WACP3E,GACA,KACIwE,KAAKC,SAAS,CAACC,eAAgB,IAAI,IAGvCF,KAAKI,kBAAkB5E,EAAQ3E,KAC/BmJ,KAAKpB,MAAMyB,WAAWC,EAAAA,GAAiBC,cAC3C,IACHtB,EAAA,yBAMmBzD,IAAqB,IAAAgF,EACrC,MAAMC,EAAY,GAAAC,OAAGlF,EAAQmF,aAAY,MAAAD,OAAKlF,EAAQoF,SAAUC,cAChE,IAAIC,EAGAA,GADAC,EAAAA,EAAAA,IAAkBvF,GACAkD,IAAAA,cAACsC,EAAAA,mBAAkB,CAACC,KAAM,MACrCC,EAAAA,EAAAA,IAAiB1F,GACNkD,IAAAA,cAACyC,EAAAA,gBAAe,CAACF,KAAM,KAEvBvC,IAAAA,cAAC0C,EAAAA,UAAS,CAACH,KAAM,KAEvC,IAAII,EAAc,EACgB,QAAlCb,EAAIR,KAAKpB,MAAM0C,2BAAmB,IAAAd,GAA9BA,EAAiChF,EAAQ3E,MACzCwK,EAAcrB,KAAKpB,MAAM0C,oBAAoB9F,EAAQ3E,KAGzD,MAAM0K,EAAsBvB,KAAKI,kBAAkB5E,EAAQ3E,IACvD6H,IAAAA,cAAA,OACI7H,GAAG,+BACH,aAAYmJ,KAAKpB,MAAM4C,KAAKC,cAAc,CAAC5K,GAAI,qCAAsC6K,eAAgB,kCAErGhD,IAAAA,cAACiD,EAAAA,UAAS,CAACV,KAAM,KACjBvC,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAI,uBACJ6K,eAAgB,YAGxB,KAEEG,EAAmC7B,KAAKpB,MAAM4C,KAAKC,cACrDK,EAASC,eACT,CAACV,cAAaU,eAAgBvG,EAAQoF,SAAW,KAG/CoB,EACFtD,IAAAA,cAAA,OACI7H,GAAG,0BACH,aAAYgL,GAEXN,EACAA,EAAsB7C,IAAAA,cAAA,QAAMuD,UAAU,QAAU,KACjDvD,IAAAA,cAACwD,EAAAA,mBAAkB,CAACjB,KAAM,KAC1BvC,IAAAA,cAAA,QAAM,oCAAAgC,OAAmClF,EAAQ2G,OAAUd,GAC1D7F,EAAQoF,QAAQhG,OAAS,EAAI8D,IAAAA,cAAA,QAAMuD,UAAU,QAAU,KACxDvD,IAAAA,cAAA,QAAMuD,UAAU,2BAA2BzG,EAAQoF,UAIrDwB,EAA6BC,IAAW,aAAc,CACxD,8BAA+BrC,KAAKI,kBAAkB5E,EAAQ3E,IAC9D,6BAA8BmJ,KAAKI,kBAAkB5E,EAAQ3E,MAG3DyL,EACF5D,IAAAA,cAAA,UACI7H,GAAG,wBACH0L,QAAUrD,GAAMc,KAAKG,WAAW3E,EAAS0D,GACzC+C,UAAWG,EACXI,SAAUC,QAAQzC,KAAKhJ,MAAMkJ,gBAC7BwC,UAAW,EACX,aAAY1C,KAAKI,kBAAkB5E,EAAQ3E,IAAMmJ,KAAKpB,MAAM4C,KAAKC,cAAc,CAAC5K,GAAI,qBAAsB6K,eAAgB,SAAW1B,KAAKpB,MAAM4C,KAAKC,cAAc,CAAC5K,GAAI,yBAA0B6K,eAAgB,UAElNhD,IAAAA,cAACiE,EAAAA,EAAc,CACXC,QAAS5C,KAAKhJ,MAAMkJ,iBAAmB1E,EAAQ3E,GAC/CgM,KAAMf,EAASgB,eAEfpE,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAImJ,KAAKI,kBAAkB5E,EAAQ3E,IAAM,qBAAuB,yBAChE6K,eAAgB1B,KAAKI,kBAAkB5E,EAAQ3E,IAAM,OAAS,WAMxEkM,EAAoBvH,EAAQwH,OAC9BtE,IAAAA,cAACuE,EAAAA,EAAsB,CACnBhB,UAAU,sBACViB,aAAa,IAEjB,KAEJ,OACIxE,IAAAA,cAAA,OACIuD,UAAU,kBACVkB,IAAK3H,EAAQ3E,GACbA,GAAE,cAAA6J,OAAgBlF,EAAQ2G,MAC1B,4BAAAzB,OAA2BlF,EAAQ2G,MACnC,aAAY1B,EACZ8B,QAAUrD,GAAMc,KAAKG,WAAW3E,EAAS0D,GACzCwD,SAAU,GAEVhE,IAAAA,cAAA,OAAKuD,UAAU,uBACXvD,IAAAA,cAAA,OAAKuD,UAAU,gCACVnB,EACDpC,IAAAA,cAAA,QAAM7H,GAAG,eAAe2E,EAAQmF,cAC/BoC,GAEJf,GAELtD,IAAAA,cAAA,OAAKuD,UAAU,uBACVK,EACAtC,KAAKhJ,MAAMkJ,iBAAmB1E,EAAQ3E,KAAOmJ,KAAKI,kBAAkB5E,EAAQ3E,KACzE6H,IAAAA,cAAA,QACIuD,UAAU,UACVmB,KAAK,SAEL1E,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,8BACH6K,eAAe,+BACf2B,OAAQ,CACJC,YAAa9H,EAAQmF,kBAMvC,IAEb1B,EAAA,iBAEWC,IAAwB,IAAAqE,EAChCrE,EAAEsE,iBACFxD,KAAKC,SAAS,CAACnB,KAAMkB,KAAKhJ,MAAM8H,KAAO,EAAG2E,cAAc,IACxDzD,KAAK0D,cAAgBC,YAAW,IAAM3D,KAAKC,SAAS,CAACwD,cAAc,KAzNlC,KA0NjCzD,KAAKpB,MAAMgF,SAAS5D,KAAKhJ,MAAM8H,KAAO,GACR,QAA9ByE,EAAAvD,KAAK6D,kBAAkBC,eAAO,IAAAP,GAA9BA,EAAgCQ,SAAS,CAACC,IAAK,GAAG,IACrD/E,EAAA,qBAEeC,IAAwB,IAAA+E,EACpC/E,EAAEsE,iBACFxD,KAAKC,SAAS,CAACnB,KAAMkB,KAAKhJ,MAAM8H,KAAO,IACT,QAA9BmF,EAAAjE,KAAK6D,kBAAkBC,eAAO,IAAAG,GAA9BA,EAAgCF,SAAS,CAACC,IAAK,GAAG,IACrD/E,EAAA,iBAEU,KACPe,KAAKpB,MAAMsF,OAAOlE,KAAKhJ,MAAMmN,oBACS,KAAlCnE,KAAKhJ,MAAMmN,oBACXnE,KAAKC,SAAS,CAACnB,KAAM,GACzB,IACHG,EAAA,qBACemF,IACZpE,KAAKpB,MAAMyF,aAAaD,GACpBpE,KAAKpB,MAAMtD,SAAW8I,GACtBpE,KAAKC,SAAS,CAACnB,KAAM,GACzB,IACHG,EAAA,qBACeC,IACRA,SAAAA,EAAGoF,eACHtE,KAAKC,SAAS,CAACkE,mBAAoBjF,aAAC,EAADA,EAAGoF,cAAcC,QAAQ,IAAMvE,KAAKwE,YAC3E,IACHvF,EAAA,oBACa,KACVe,KAAKC,SAAS,CAACkE,mBAAoB,KAAK,IAAMnE,KAAKwE,YAAW,IACjEvF,EAAA,sBACe,KAERe,KAAKpB,MAAM6F,kCACXzE,KAAKpB,MAAM8F,8BAA6B,GAExC1E,KAAKpB,MAAM8F,8BAA6B,EAC5C,IACHzF,EAAA,6BACsB,KACnB,GAAIe,KAAKhJ,MAAMmN,mBAAmBvJ,OAAS,EACvC,OACI8D,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,uBACH8N,QAAQ,SACRjD,eAAe,wBACf2B,OAAQ,CAACR,KAAM7C,KAAKhJ,MAAMmN,sBAItC,OAAQnE,KAAKpB,MAAMtD,QACnB,KAAKsJ,EAAOC,SACR,OACInG,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAI,2BACJ8N,QAAQ,SACRjD,eAAgB,yBAG5B,KAAKkD,EAAOE,QACR,OACIpG,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAI,0BACJ8N,QAAQ,SACRjD,eAAgB,wBAG5B,KAAKkD,EAAOG,OACR,OACIrG,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAI,yBACJ8N,QAAQ,SACRjD,eAAgB,uBAG5B,QACI,OACIhD,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAI,2BACJ8N,QAAQ,SACRjD,eAAgB,gBAG5B,IACHzC,EAAA,uBACgB,KACb,OAAQe,KAAKpB,MAAMtD,QACnB,KAAKsJ,EAAOC,SACR,OACInG,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,uCACH6K,eAAe,2BAG3B,KAAKkD,EAAOG,OACR,OACIrG,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,qCACH6K,eAAe,yBAG3B,KAAKkD,EAAOE,QACR,OACIpG,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,sCACH6K,eAAe,0BAG3B,QACI,OACIhD,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,kCACH6K,eAAe,sBAG3B,IApSA1B,KAAK0D,cAAgB,EAErB1D,KAAKhJ,MAAQ,CACTkJ,eAAgB,GAChBpB,KAAM,EACN2E,cAAc,EACdU,mBAAoB,IAGxBnE,KAAK1E,OAASoD,IAAAA,YACdsB,KAAK6D,kBAAoBnF,IAAAA,WAC7B,CAEAsG,iBAAAA,IAESC,EAAAA,MAAwBjF,KAAK1E,OAAOwI,SACrC9D,KAAK1E,OAAOwI,QAAQoB,QAExBC,SAASC,iBAAiB,UAAWpF,KAAKqF,UAC9C,CAEAC,oBAAAA,GACIH,SAASI,oBAAoB,UAAWvF,KAAKqF,UACjD,CA2BAjF,iBAAAA,CAAkBxJ,GACd,OAAOoJ,KAAKpB,MAAM4G,qBAAqB5O,EAC3C,CAmPA6O,MAAAA,GACI,MAAMC,EAAW1F,KAAKpB,MAAM8G,SAC5B,IAAIC,EACAC,EACAC,EAEJ,GAAI7F,KAAKpB,MAAMgE,SAA+B,IAApB8C,EAAS9K,OAC/B+K,EAAcjH,IAAAA,cAACoH,EAAAA,EAAa,WACzB,GAAwB,IAApBJ,EAAS9K,OAChB+K,EACIjH,IAAAA,cAAA,OACIuD,UAAU,qBACV,aAAYjC,KAAKhJ,MAAMmN,mBAAmBvJ,OAAS,EAAIoF,KAAKpB,MAAM4C,KAAKC,cAAcK,EAASiE,OAAQ,CAAClD,KAAM7C,KAAKhJ,MAAMmN,qBAAuBnE,KAAKpB,MAAM4C,KAAKC,cAAc,CAAC5K,GAAI,+BAAgC6K,eAAgB,uBAGlOhD,IAAAA,cAACsH,EAAAA,EAAkB,MACnBtH,IAAAA,cAAA,MAAIuD,UAAU,mBACTjC,KAAKiG,wBAETjG,KAAKpB,MAAMsH,mBAGjB,CACH,MAAMC,EAAYnG,KAAKhJ,MAAM8H,KAAOkB,KAAKpB,MAAMwH,gBACzCC,EAAUF,EAAYnG,KAAKpB,MAAMwH,gBACjCE,EAAoBtG,KAAKpB,MAAM8G,SAASnH,MAAM4H,EAAWE,GAC/DV,EAAcW,EAAkBpK,IAAI8D,KAAKuG,kBAErCD,EAAkB1L,QAAUoF,KAAKpB,MAAMwH,iBAAmBC,EAAUrG,KAAKpB,MAAM8G,SAAS9K,SACxFgL,EACIlH,IAAAA,cAAA,UACIuD,UAAU,8DACVM,QAASvC,KAAK4D,SACdpB,SAAUxC,KAAKhJ,MAAMyM,aACrB,aAAYzD,KAAKpB,MAAM4C,KAAKC,cAAc,CAAC5K,GAAI,qBAAsB6K,eAAgB,UAErFhD,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,qBACH6K,eAAe,WAM3B1B,KAAKhJ,MAAM8H,KAAO,IAClB+G,EACInH,IAAAA,cAAA,UACIuD,UAAU,8DACVM,QAASvC,KAAKwG,aACd,aAAYxG,KAAKpB,MAAM4C,KAAKC,cAAc,CAAC5K,GAAI,qBAAsB6K,eAAgB,cAErFhD,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,qBACH6K,eAAe,cAKnC,CAEA,MAAM+E,EACF/H,IAAAA,cAAA,OAAKuD,UAAU,cACXvD,IAAAA,cAAA,QACI7H,GAAG,aACH,cAAY,QAEZ6H,IAAAA,cAAA,KAAGuD,UAAU,uBAEjBvD,IAAAA,cAACgI,EAAAA,EAAU,CACP7P,GAAG,wBACH8P,IAAK3G,KAAK1E,OACV2G,UAAU,8BACV2E,YAAa5G,KAAKpB,MAAM4C,KAAKC,cAAc,CAAC5K,GAAI,gCAAiC6K,eAAgB,oBACjGmF,QAAS7G,KAAK8G,aACdC,WAAW,EACXC,QAAShH,KAAKiH,YACd1C,MAAOvE,KAAKhJ,MAAMmN,mBAClB,aAAYnE,KAAKpB,MAAM4C,KAAKC,cAAc,CAAC5K,GAAI,gCAAiC6K,eAAgB,uBAKtGwF,EACFxI,IAAAA,cAACiD,EAAAA,UAAS,CACNV,KAAM,GACNkG,MAAO,qBAGTC,EAAuB,CACzB1I,IAAAA,cAAC2I,EAAAA,GAAS,CACNlE,IAAI,0BACJtM,GAAG,0BACH0L,QAASA,IAAMvC,KAAKsH,aAAa1C,EAAO2C,KACxCC,eAAgB9I,IAAAA,cAAC+I,EAAAA,iBAAgB,CAACxG,KAAM,KACxCyG,OACIhJ,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,iBACH6K,eAAe,sBAGvBiG,iBAAkB3H,KAAKpB,MAAMtD,SAAWsJ,EAAO2C,IAAML,EAAY,KACjE,aAAYlH,KAAKpB,MAAM4C,KAAKC,cAAc,CAAC5K,GAAI,iBAAkB6K,eAAgB,wBAErFhD,IAAAA,cAAC2I,EAAAA,GAAS,CACNlE,IAAI,6BACJtM,GAAG,6BACH0L,QAASA,IAAMvC,KAAKsH,aAAa1C,EAAOG,QACxCyC,eAAgB9I,IAAAA,cAAC0C,EAAAA,UAAS,CAACH,KAAM,KACjCyG,OACIhJ,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,oBACH6K,eAAe,oBAGvBiG,iBAAkB3H,KAAKpB,MAAMtD,SAAWsJ,EAAOG,OAASmC,EAAY,KACpE,aAAYlH,KAAKpB,MAAM4C,KAAKC,cAAc,CAAC5K,GAAI,oBAAqB6K,eAAgB,sBAExFhD,IAAAA,cAAC2I,EAAAA,GAAS,CACNlE,IAAI,8BACJtM,GAAG,8BACH0L,QAASA,IAAMvC,KAAKsH,aAAa1C,EAAOE,SACxC0C,eAAgB9I,IAAAA,cAACyC,EAAAA,gBAAe,CAACF,KAAM,KACvCyG,OACIhJ,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,qBACH6K,eAAe,qBAGvBiG,iBAAkB3H,KAAKpB,MAAMtD,SAAWsJ,EAAOE,QAAUoC,EAAY,KACrE,aAAYlH,KAAKpB,MAAM4C,KAAKC,cAAc,CAAC5K,GAAI,qBAAsB6K,eAAgB,wBAI7F0F,EAAqBQ,KACjBlJ,IAAAA,cAAC2I,EAAAA,GAAc,CAAClE,IAAI,kCACpBzE,IAAAA,cAAC2I,EAAAA,GAAS,CACNlE,IAAI,+BACJtM,GAAG,+BACH0L,QAASA,IAAMvC,KAAKsH,aAAa1C,EAAOC,UACxC2C,eAAgB9I,IAAAA,cAACsC,EAAAA,mBAAkB,CAACC,KAAM,KAC1CyG,OACIhJ,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,qBACH6K,eAAe,sBAGvBiG,iBAAkB3H,KAAKpB,MAAMtD,SAAWsJ,EAAOC,SAAWqC,EAAY,KACtE,aAAYlH,KAAKpB,MAAM4C,KAAKC,cAAc,CAAC5K,GAAI,qBAAsB6K,eAAgB,yBAG7F,MAAMmG,EACFnJ,IAAAA,cAAAA,IAAAA,SAAA,KACKsB,KAAK8H,iBACNpJ,IAAAA,cAACqJ,EAAAA,gBAAe,CACZZ,MAAO,8CACPlG,KAAM,MAIZ+G,EACFtJ,IAAAA,cAAAA,IAAAA,SAAA,KACIA,IAAAA,cAAA,OACI0E,KAAK,SACL,cAAY,OACZnB,UAAU,WAETjC,KAAKpB,MAAM4C,KAAKC,cAAc,CAC3B5K,GAAI,oDACJ6K,eAAgB,2CACjB,CACC0C,WAAYpE,KAAKpB,MAAMtD,UAG/BoD,IAAAA,cAAC2I,EAAAA,GAAc,CACXQ,WAAY,CACRhR,GAAI,cACJoR,SAAUJ,EACV,aAAc7H,KAAKpB,MAAM4C,KAAKC,cAAc,CAAC5K,GAAI,oCAAqC6K,eAAgB,yBAE1GwG,KAAM,CACFrR,GAAI,yBACJ,aAAcmJ,KAAKpB,MAAM4C,KAAKC,cAAc,CAAC5K,GAAI,oCAAqC6K,eAAgB,0BAGzG0F,EAAqBlL,KAAKiM,GAASA,MAK1CC,EAAwB/F,IAAW,oBAAqB,CAACgG,QAASrI,KAAKpB,MAAM6F,oCAC7E6D,EACF5J,IAAAA,cAAA,OACI7H,GAAI,+BACJ0L,QAASvC,KAAKuI,cACdlD,UAAYnG,IACRA,EAAEa,kBACY,UAAVb,EAAEiE,KAA6B,MAAVjE,EAAEiE,KACvBnD,KAAKuI,eACT,EAEJnF,KAAK,WACL,eAAcpD,KAAKpB,MAAM6F,kCACzB,aAAYzE,KAAKpB,MAAM4C,KAAKC,cAAc,CAAC5K,GAAI,qCAAsC6K,eAAgB,yBACrGgB,SAAU,GAEVhE,IAAAA,cAAA,OAAKuD,UAAWmG,GACXpI,KAAKpB,MAAM6F,kCAAoC/F,IAAAA,cAAC8J,EAAAA,EAAmB,MAAK,MAE7E9J,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,4BACH6K,eAAe,iBAK3B,IAAI+G,EAEAA,EADoB,IAApB/C,EAAS9K,OACWoF,KAAKpB,MAAM4C,KAAKC,cAAc,CAAC5K,GAAI,2BAA4B6K,eAAgB,cACxE,IAApBgE,EAAS9K,OACIoF,KAAKpB,MAAM4C,KAAKC,cAAc,CAAC5K,GAAI,0BAA2B6K,eAAgB,aAC3FgE,EAAS9K,OAAS,EACLoF,KAAKpB,MAAM4C,KAAKC,cAAcK,EAAS4G,aAAc,CAACC,MAAOjD,EAAS9K,SAEtEoF,KAAKpB,MAAM4C,KAAKC,cAAc,CAAC5K,GAAI,2BAA4B6K,eAAgB,cAGvG,MAAMkH,EACFlK,IAAAA,cAAA,OAAKuD,UAAU,wBACXvD,IAAAA,cAAA,QAAM7H,GAAG,qBAAqB4R,GAC9B/J,IAAAA,cAAA,QACIuD,UAAU,UACVmB,KAAK,SACL,YAAU,UAETqF,GAEL/J,IAAAA,cAAA,OAAK7H,GAAG,4BACHmR,EACAM,IAKb,OACI5J,IAAAA,cAAA,OAAKuD,UAAU,sBACVwE,EACAmC,EACDlK,IAAAA,cAAA,OACI0E,KAAK,SACLnB,UAAU,mBACVS,UAAW,GAEXhE,IAAAA,cAAA,OACI7H,GAAG,mBACH6L,UAAW,EACXiE,IAAK3G,KAAK6D,mBAET8B,IAGTjH,IAAAA,cAAA,OAAKuD,UAAU,mBACV4D,EACAD,GAIjB,EACH3G,EA9jBYR,EAAqB,aAzB9BiH,SAAQmD,IAAAA,MAAAC,WACR1C,gBAAeyC,IAAAA,OAAAC,WACflF,SAAQiF,IAAAA,KAAAC,WACRjK,SAAQgK,IAAAA,KAAAC,WACR5E,OAAM2E,IAAAA,KAAAC,WACN3I,WAAU0I,IAAAA,KAAAC,WACV5C,cAAa2C,IAAAA,QAAAC,WACbzE,aAAYwE,IAAAA,KAAAC,WAGZzI,WAAUwI,IAAAA,KAAAC,WACVpE,6BAA4BmE,IAAAA,KAAAC,WAC5BrE,kCAAiCoE,IAAAA,KAAAC,WACjClG,QAAOiG,IAAAA,KACPvH,oBAAmBuH,IAAAA,SAAAA,IAAAA,UA2kBvB,MAAM/G,GAAWiH,EAAAA,EAAAA,gBAAe,CAC5BL,aAAc,CACV7R,GAAI,sBACJ6K,eAAgB,mBAEpBK,eAAgB,CACZlL,GAAI,gCACJ6K,eAAgB,6GAEpBoB,cAAe,CACXjM,GAAI,4BACJ6K,eAAgB,cAEpBqE,OAAQ,CACJlP,GAAI,uBACJ6K,eAAgB,2BAIxB,GAAesH,EAAAA,EAAAA,YAAWvK,G,8bC5mBnB,IAAKmG,EAAM,SAANA,GAAM,OAANA,EAAM,UAANA,EAAM,gBAANA,EAAM,kBAANA,EAAM,oBAANA,CAAM,MAmDH,MAAMqE,UAAuBvK,IAAAA,cAIxCK,WAAAA,CAAYH,GACRI,MAAMJ,GAAOK,EAAA,sBAHW,IAAEA,EAAA,qBA0Cf,KACXe,KAAKC,SAAS,CAAC2C,SAAS,GAAO,IAClC3D,EAAA,yBAEkB,KACfe,KAAKkJ,aACLlJ,KAAKmJ,eACLnJ,KAAKpB,MAAMwK,QAAQC,UAAU,CACzBC,QAAShJ,EAAAA,GAAiBiJ,kBAC1BC,WAAYC,EAAAA,SACd,IACLxK,EAAA,mBAEY,KACTe,KAAKpB,MAAMwK,QAAQ/I,WAAWC,EAAAA,GAAiBC,cAAc,IAChEtB,EAAA,qBAEc,KACPe,KAAKpB,MAAM8K,SAAW1J,KAAKpB,MAAM+K,WAAaC,EAAAA,GAAUC,cACxD7J,KAAKpB,MAAMwK,QAAQU,oBACvB,IACH7K,EAAA,iBAEW8K,IACJ/J,KAAKhJ,MAAMkN,SAAW6F,GAI1B/J,KAAKC,SAAS,CACV+J,iBAAkB,GAClBC,YAAa,MACf,IACLhL,EAAA,iBAEWH,IACRkB,KAAKpB,MAAMwK,QAAQc,YAAYlK,KAAKpB,MAAMnF,OAAQqF,EAAO,EApIvC,IAoI6DqL,MAAMjQ,IAC7EA,EAAOvC,MAAQuC,EAAOvC,KAAKiD,OAAS,GACpCoF,KAAKpB,MAAMwK,QAAQgB,uBAAuBlQ,EAAOvC,KAAKuE,KAAKV,GAAYA,EAAQ3E,KACnF,GACF,IACLoI,EAAA,mBAEY9H,MAAOqE,EAAkB6O,KAAqB,IAAAC,EACvD,MAAM,QAAClB,EAAO,cAAEmB,EAAa,OAAE9Q,EAAM,SAAE+Q,GAAYxK,KAAKpB,MACxD,IAAI1E,EAEC8F,KAAKI,kBAAkB5E,EAAQ3E,MAChCqD,QAAekP,EAAQqB,YAAYF,EAAe9Q,EAAQ+B,EAAQ3E,KAG5D,QAAVyT,EAAIpQ,SAAM,IAAAoQ,GAANA,EAAQ1S,MACRoI,KAAKC,SAAS,CAACgK,YAAa/P,EAAOtC,MAAM8S,WAEzC1K,KAAKpB,MAAMwK,QAAQgB,uBAAuB,CAAC5O,EAAQ3E,MACnD8T,EAAAA,EAAAA,KAAa/C,MAAKgD,EAAAA,EAAAA,IAAsBJ,EAAWhP,EAAQ2G,OAC3DnC,KAAKmJ,gBAGLkB,GACAA,GACJ,IACHpL,EAAA,eAES4L,IAGN,GAFAC,aAAa9K,KAAK+K,iBAEL,KAATF,EAIA,OAHA7K,KAAKgL,UAAS,GACdhL,KAAKC,SAAS,CAACiE,QAAQ,EAAO8F,iBAAkB,GAAIiB,WAAW,EAAOC,WAAYL,SAClF7K,KAAK+K,gBAAkB,GAG3B/K,KAAKC,SAAS,CAACiE,QAAQ,EAAM+G,WAAW,EAAMC,WAAYL,IAE1D,MAAME,EAAkBI,OAAOxH,YAC3BxM,UACI,IACI,MAAM,KAACQ,SAAcqI,KAAKpB,MAAMwK,QAAQgC,kBAAkBP,EAAM,CAACQ,SAAU,CAACrL,KAAKpB,MAAMnF,QAAS6R,gBAAgB,EAAMC,iBAAiB,IACvI,GAAIR,IAAoB/K,KAAK+K,gBACzB,OAGJ,GAAIpT,EAAM,CACN,MAAM6T,EAA2B7T,EAAKuE,KAAKV,GAAqBA,EAAQ3E,KACpE2U,EAAyB5Q,OAAS,GAClCoF,KAAKpB,MAAMwK,QAAQgB,uBAAuBoB,GAE9CxL,KAAKyL,iBAAiB9T,EAAK2D,QAAQE,GAAYA,EAAQkQ,UAAY1L,KAAKpB,MAAMnF,SAClF,MACIuG,KAAKC,SAAS,CAAC+J,iBAAkB,GAAIiB,WAAW,GAExD,CAAE,MAAOU,GACL3L,KAAKC,SAAS,CAAC+J,iBAAkB,GAAIiB,WAAW,GACpD,IA7LoB,KAkM5BjL,KAAK+K,gBAAkBA,CAAe,IACzC9L,EAAA,yBAEmByG,IAEhB,IAAIsE,EAAmBtE,EAASpK,QAAQsQ,GAAMA,EAAEpU,OAAS8H,EAAAA,GAAUuM,iBAAmB7L,KAAKI,kBAAkBwL,EAAE/U,MAC3GmJ,KAAKhJ,MAAMsE,SAAWsJ,EAAOE,UAC7BkF,EAAmBtE,EAASpK,QAAQsQ,GAAMA,EAAEpU,OAAS8H,EAAAA,GAAUuM,iBAAmB7L,KAAKI,kBAAkBwL,EAAE/U,OAE3GmJ,KAAKhJ,MAAMsE,SAAWsJ,EAAOG,SAC7BiF,EAAmBtE,EAASpK,QAAQsQ,GAAMA,EAAEpU,OAAS8H,EAAAA,GAAUwM,cAAgC,IAAhBF,EAAEG,aAEjF/L,KAAKhJ,MAAMsE,SAAWsJ,EAAOC,WAC7BmF,EAAmBtE,EAASpK,QAAQsQ,GAAsB,IAAhBA,EAAEG,aAE5C/L,KAAKpB,MAAMoN,2BACXhC,EAAmBhK,KAAKiM,yBAAyBjC,IAErDhK,KAAKC,SAAS,CAAC+J,mBAAkBiB,WAAW,GAAO,IACtDhM,EAAA,qBAEe3D,IAEZ0E,KAAKkE,OAAOlE,KAAKhJ,MAAMkU,YACvBlL,KAAKC,SAAS,CAAC3E,UAAQ,IAC1B2D,EAAA,2CAMqC+M,IAElChM,KAAKkE,OAAOlE,KAAKhJ,MAAMkU,YACvBlL,KAAKpB,MAAMwK,QAAQ8C,cAAcC,EAAAA,GAAgBC,qBAAsBJ,EAAyBK,WAAW,IAC9GpN,EAAA,iCAE2BqN,GAA2BA,EAAYhR,QAAQE,IAAawE,KAAKI,kBAAkB5E,EAAQ3E,QAAIoI,EAAA,0BAEvG,KAChB,MAAM,SAACyG,EAAQ,iBAAE6G,EAAgB,yBAAEP,EAAwB,gBAAEQ,GAAmBxM,KAAKpB,OAC/E,OAACsF,EAAM,iBAAE8F,EAAgB,OAAE1O,GAAU0E,KAAKhJ,MAE1CyV,EAAc/G,EAAShF,OAAO8L,GAAiBrQ,MAAK,CAACC,EAAGC,IAAMD,EAAEuE,aAAa+L,cAAcrQ,EAAEsE,gBAC7FgM,EAA2B3M,KAAKiM,yBAAyBQ,GACzDG,EAA8B5M,KAAKiM,yBAAyBvG,GAC5DmH,EAAgC7M,KAAKiM,yBAAyBM,GAC9DO,EAA+B9M,KAAKiM,yBAAyBO,GAE7DO,EAAgB,CAClB,CAACnI,EAAO2C,KAAMyE,EAA2BW,EAA2BF,EACpE,CAAC7H,EAAOC,UAAWmH,EAA2Ba,EAAgCN,EAC9E,CAAC3H,EAAOE,SAAUkH,EAA2Bc,EAA+BN,EAC5E,CAAC5H,EAAOG,QAASiH,EAA2BY,EAA8BlH,GAG9E,OAAIxB,EACO8F,EAGJ+C,EAAczR,IAAWyR,EAAcnI,EAAO2C,IAAI,IAnMzDvH,KAAK+K,gBAAkB,EAEvB/K,KAAKhJ,MAAQ,CACT4L,SAAS,EACTtH,OAAQsJ,EAAO2C,IACfrD,QAAQ,EACR8F,iBAAkB,GAClBC,YAAa,KACbgB,WAAW,EACXC,WAAY,GAEpB,CAEAlG,iBAAAA,GACI,IAAKhF,KAAKpB,MAAMnF,OAEZ,YADAuG,KAAKgN,eAIT,MAAMC,EAAW,CACbjN,KAAKpB,MAAMwK,QAAQc,YAAYlK,KAAKpB,MAAMnF,OAAQ,EAAGyT,KACrDlN,KAAKpB,MAAMwK,QAAQ+D,oBAAoBnN,KAAKpB,MAAMnF,OAAQ,EAAGyT,MAGjEE,QAAQC,IAAIJ,GAAU9C,MAAMmD,IACxB,MAAM9B,EAA2B8B,EAAQC,SAASrT,GACvCA,EAAOvC,KAAOuC,EAAOvC,KAAKuE,KAAKV,GAAYA,EAAQ3E,KAAM,KAGpEmJ,KAAKpB,MAAM4N,gBAAgBzS,SAASyB,GAAYgQ,EAAyB5D,KAAKpM,EAAQ3E,MAClF2U,EAAyB5Q,OAAS,GAClCoF,KAAKpB,MAAMwK,QAAQgB,uBAAuBoB,EAC9C,IAEJxL,KAAKgN,cACT,CA+HA5M,iBAAAA,CAAkBxJ,GACd,OAAOoJ,KAAKpB,MAAM4G,qBAAqB5O,EAC3C,CAkCA6O,MAAAA,GACI,MAAM,OAAChM,EAAM,uBAAE+T,EAAsB,yBAAExB,GAA4BhM,KAAKpB,OAClE,OAACsF,EAAQ+F,YAAawD,EAAgB,UAAExC,GAAajL,KAAKhJ,MAIhE,IAAIiT,EAFJjK,KAAK0N,eAAiB1N,KAAK2N,oBAGvBF,IACAxD,EACIvL,IAAAA,cAAA,OAAKuD,UAAU,wBAAuBvD,IAAAA,cAAA,SAAOuD,UAAU,iBAAiBwL,KAGhF,MAAMG,EAAyBA,CAAC3L,EAAmB4L,KAC/C,MAAMC,EAAkBzL,IAAW,MAAOJ,GAC1C,OACIvD,IAAAA,cAACqP,EAAAA,EAAkB,CACftU,OAAQA,EACRuU,YAAa,CAACC,EAAAA,EAAYC,wBAE1BxP,IAAAA,cAAA,UACIlH,KAAK,SACLX,GAAG,yBACHoL,UAAW6L,EACXvL,QAASvC,KAAKmO,iBACd,cAAYC,EAAAA,EAAAA,IAAgB,CAACvX,GAAI,uBAAwB6K,eAAgB,wBAExEmM,EACDnP,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,uBACH6K,eAAe,wBAGN,EAIvBwE,EACFxH,IAAAA,cAAAA,IAAAA,SAAA,KACIA,IAAAA,cAAA,KAAGuD,UAAU,qBACTvD,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,4BACH6K,eAAe,oFAGtBkM,EAAuB,cAAelP,IAAAA,cAAA,KAAGuD,UAAU,gBAItDoM,EAAOrO,KAAKhJ,MAAM4L,QAAUlE,IAAAA,cAACoH,EAAAA,EAAa,MAC5CpH,IAAAA,cAAAA,IAAAA,SAAA,KACIA,IAAAA,cAACD,EAAqB,CAClBiH,SAAU1F,KAAK0N,eACftH,gBAtTM,GAuTNxC,SAAU5D,KAAK4D,SACf/E,SAAUqF,EACVA,OAAQlE,KAAKkE,OACb/D,WAAYH,KAAKG,WACjB+F,cAAeA,EACftD,QAASsB,EAAS+G,EAAYuC,EAC9BnJ,aAAcrE,KAAKqE,aACnB/I,OAAQ0E,KAAKhJ,MAAMsE,OACnBkK,qBAAsBxF,KAAKpB,MAAM4G,qBACjCnF,WAAYL,KAAKpB,MAAMwK,QAAQ/I,WAC/BqE,6BAA8B1E,KAAKsO,mCACnC7J,kCAAmCuH,EACnC1K,oBAAqBtB,KAAKpB,MAAM0C,sBAEnC2I,GAIHsE,EACF7P,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,sBACH6K,eAAe,oBAIvB,OACIhD,IAAAA,cAAC8P,EAAAA,GAAY,CACT3X,GAAG,sBACH4X,SAAUzO,KAAKkJ,WACfwF,eAAe,EACfC,gBAAiBJ,EACjBK,aAAchB,EAAuB,wBACrCiB,0BAA0B,EAC1B,cAAY,EACZC,cAAc,EACdC,aAAa,GAEZV,EAGb,EACHpP,EA3SoBgK,EAAc,aAzB/BvD,SAAQmD,IAAAA,MAAAC,WACRyD,iBAAgB1D,IAAAA,MAAAC,WAChB0D,gBAAe3D,IAAAA,MAAAC,WACfyB,cAAa1B,IAAAA,OAAAC,WACbrP,OAAMoP,IAAAA,OAAAC,WACN0B,SAAQ3B,IAAAA,OACR2E,uBAAsB3E,IAAAA,KAEtBmD,yBAAwBnD,IAAAA,KAAAC,WAExBY,QAAOb,IAAAA,KACPvH,oBAAmBuH,IAAAA,SAAAA,IAAAA,QACnBO,QAAOP,IAAAA,MAAA,CA5BPqB,YAAWrB,IAAAA,KAAAC,WACXqE,oBAAmBtE,IAAAA,KAAAC,WACnB2B,YAAW5B,IAAAA,KAAAC,WACXsC,kBAAiBvC,IAAAA,KAAAC,WACjBO,UAASR,IAAAA,KAAAC,WACTzI,WAAUwI,IAAAA,KAAAC,WAKVoD,cAAarD,IAAAA,KAAAC,WACbgB,mBAAkBjB,IAAAA,KAAAC,WAClBsB,uBAAsBvB,IAAAA,KAAAC,aAAAA,aC1B1B,MAAMkG,GAA6BC,EAAAA,EAAAA,IAC/B,6BACAC,EAAAA,IACCxJ,GAAwBA,GAAYA,EAASpK,QAAQsQ,GAAsB,IAAhBA,EAAEG,WAAmBH,EAAEpU,OAAS8H,EAAAA,GAAUuM,oBAGpGsD,GAA2BF,EAAAA,EAAAA,IAC7B,2BACAC,EAAAA,IACCxJ,GAAwBA,GAAYA,EAASpK,QAAQsQ,GAAsB,IAAhBA,EAAEG,cAG5DqD,GAA6BH,EAAAA,EAAAA,IAC/B,6BACAC,EAAAA,IACCxJ,GAAwBA,GAAYA,EAASpK,QAAQsQ,GAAMA,EAAEpU,OAAS8H,EAAAA,GAAUuM,oBAuCrF,GAAewD,EAAAA,EAAAA,UApCf,SAAyBrY,GACrB,MAAMsY,GAAOC,EAAAA,EAAAA,IAAevY,GACtBwY,GAAgBC,EAAAA,EAAAA,IAAkBtD,EAAAA,GAAgBC,qBAAsB,SAE9E,MAAO,CACH1G,SAAUsJ,EAA2BhY,IAAU,GAC/CuV,iBAAkB4C,EAAyBnY,IAAU,GACrDwV,gBAAiB4C,EAA2BpY,IAAU,GACtDuT,eAAemF,EAAAA,EAAAA,IAAiB1Y,GAChCyC,QAAQkW,EAAAA,EAAAA,IAAiB3Y,GACzBwT,SAAU8E,aAAI,EAAJA,EAAMnN,KAChBqL,uBAAwBxW,EAAM4Y,SAASlK,SAASwE,YAAY2F,SAAWC,EAAAA,GAAcC,QACrFvK,sBAAsBwK,EAAAA,EAAAA,IAAwBhZ,IAAU,CAAC,EACzDgV,yBAAmD,SAAzBwD,EAAcxY,GACxC2S,UAAUsG,EAAAA,EAAAA,IAAYjZ,GACtB0S,SAASwG,EAAAA,EAAAA,GAAalZ,GACtBsK,qBAAqB6O,EAAAA,EAAAA,IAA+BnZ,GAE5D,IAEA,SAA4BF,GACxB,MAAO,CACHsS,SAASgH,EAAAA,EAAAA,IAAmB,CACxBlG,YAAW,KACXiD,oBAAmB,KACnB1C,YAAW,KACXW,kBAAiB,KACjB/B,UAAS,IACThJ,WAAU,IACV6L,cAAa,KACbpC,mBAAkB,KAClBM,uBAAsBA,EAAAA,IACvBtT,GAEX,GAEA,CAA4DmS,E,wQC3DrD,MAAMoH,EAA4B,IAEnC,aAACvE,EAAY,gBAAED,EAAe,WAAEjQ,EAAU,WAAED,GAAc2D,EAAAA,GAK1D6D,EAAMA,CAAC/G,EAAYwP,IACd,GAAPlL,OAAUtE,GAACsE,OAAGkL,GAGZ0E,EAAsB,CAGxB,CAACnN,EAAI,MAAO2I,IAAgBmC,EAAAA,GAAYsC,4BACxC,CAACpN,EAAI,OAAQ2I,IAAgBmC,EAAAA,GAAYuC,6BACzC,CAACrN,EAAI,SAAU2I,IAAgBmC,EAAAA,GAAYwC,+BAC3C,CAACtN,EAAI,QAAS2I,IAAgBmC,EAAAA,GAAYyC,8BAG1C,CAACvN,EAAI,MAAO0I,IAAmBoC,EAAAA,GAAY0C,6BAC3C,CAACxN,EAAI,OAAQ0I,IAAmBoC,EAAAA,GAAY2C,8BAC5C,CAACzN,EAAI,SAAU0I,IAAmBoC,EAAAA,GAAY4C,gCAC9C,CAAC1N,EAAI,QAAS0I,IAAmBoC,EAAAA,GAAY6C,gCAGpCC,EAA+BA,CAACna,EAAmBoa,KACrDC,EAAAA,EAAAA,cAAaja,GAAuBka,EAAkCla,EAAOJ,EAAWoa,KAGtFE,EAAoCA,CAACla,EAAoBJ,EAAmBoa,KACrF,MAAMxV,GAA+B2V,EAAAA,EAAAA,GAAWna,EAAOJ,GAEvD,IAAK4E,EACD,OAAO,EAGX,GAA0B,IAAtBA,EAAQuQ,UACR,OAAO,EAGX,MAAM,KAACvU,GAAQgE,EAEf,GAAa,YAAThE,EACA,OAAO,EAGX,GAAIA,IAASoE,GAAcpE,IAASmE,EAAY,CAC5C,MAAMyV,GAAeC,EAAAA,EAAAA,IAAmBra,EAAOJ,GAC/C,OAAOwa,aAAY,EAAZA,EAAcE,cAAe1a,CACxC,CAEA,MAAM2a,EAAajB,EAAoBnN,EAAI6N,EAAQxZ,IAEnD,OAAOgE,GAAW+V,IAAcC,EAAAA,EAAAA,IAAuBxa,EAAOwE,EAAQkQ,QAAS9U,EAAW2a,EAAW,EAG5FE,EAAoBA,KACtBR,EAAAA,EAAAA,cAAaja,IAAuB0a,EAAAA,EAAAA,KAAeC,EAAAA,EAAAA,IAAU3a,MAG3D4a,EAAsBA,KACxBX,EAAAA,EAAAA,cAAaja,IAAuB6a,EAAAA,EAAAA,KAAqBF,EAAAA,EAAAA,IAAU3a,MAOjE8a,EAAgC9a,IAGzC,GAFqE,UAAnD+a,EAAAA,EAAAA,IAAoB/a,EAAO,oBAGzC,OAAO,EAGX,MAAMgb,GAAUC,EAAAA,EAAAA,IAAWjb,GAE3B,MAA+B,UAAxBgb,aAAO,EAAPA,EAASE,WAAqB,EAG5BC,EAAuBvb,IAChC,MAAME,GAAWsb,EAAAA,EAAAA,eACX3Z,GAAYwY,EAAAA,EAAAA,cAAaja,IAAuB6B,EAAAA,EAAAA,GAAoB7B,EAAOJ,KAE3Eyb,GAAQC,EAAAA,EAAAA,UAAQ,IACXC,OAAOC,KAAK/Z,GAAW0D,MAAK,CAACC,EAAGC,IAAM5D,EAAU2D,GAAGqW,WAAaha,EAAU4D,GAAGoW,cACrF,CAACha,KACGia,EAAWC,IAAgBC,EAAAA,EAAAA,YAqClC,OAnCAC,EAAAA,EAAAA,YAAU,KACFH,GACAC,OAAa9X,EACjB,GACD,CAACwX,KAEJQ,EAAAA,EAAAA,YAAU,KACFjc,GACAE,GAAS8B,EAAAA,EAAAA,IAAsBhC,GACnC,GACD,CAACA,KAEJic,EAAAA,EAAAA,YAAU,KACN,MAAMC,EAASP,OAAOlP,OAAO5K,GAAWsa,QAAiB,CAAC7Y,EAAM8Y,KAAc,IAAZ,MAACC,GAAMD,EAKrE,OAJIC,GACA/Y,EAAO0N,MAAKsL,EAAAA,EAAAA,IAAiBD,IAG1B/Y,CAAM,GACd,IAEC4Y,EAAOlY,QACP9D,GAASqc,EAAAA,EAAAA,IAAyBL,GACtC,GACD,CAACra,IAWG,CACHA,YACA4Z,MAAOK,QAAAA,EAAaL,EACpBe,QAZYjc,MAAON,EAAYwc,EAAmBC,KAClDX,GAAaY,EAAAA,EAAAA,IAAwBlB,EAAOxb,EAAIyc,IAChD,MAAM,MAAC1b,SAAed,GAASyB,EAAAA,EAAAA,IAAgB3B,EAAWC,EAAIyc,IAE1D1b,GACA+a,OAAa9X,EACjB,EAOH,C,mOCjHL,MAAM2Y,EAAwB5U,IAC1B,MAAM,cAAC6C,IAAiBgS,EAAAA,EAAAA,WAElB3c,GAAWsb,EAAAA,EAAAA,eAEX3F,GAAcwE,EAAAA,EAAAA,aAAYyC,EAAAA,IAC1B9Z,GAA0BqX,EAAAA,EAAAA,cAAaja,GAAuBA,EAAM6C,MAAMC,eAAeF,0BAEzF+Z,GAAc1C,EAAAA,EAAAA,aAAY1B,EAAAA,IAC1BzU,GAAamW,EAAAA,EAAAA,cAAaja,GACrB2c,GAAc5Y,EAAAA,EAAAA,IAA4B/D,QAAS6D,IAExD+Y,GAAkB3C,EAAAA,EAAAA,cAAaja,GAC1B2c,GAAcE,EAAAA,EAAAA,IAA6B7c,GAAO2c,aAAW,EAAXA,EAAa9c,KAAM,GAAI+H,EAAMpD,QAAQ3E,SAAMgE,IAGxG,SAASiZ,EAAqBC,EAAiEzZ,GAC3FyZ,EAAMvQ,kBAEFoQ,aAAe,EAAfA,EAAiB/c,MAAOyD,GACxBxD,GAASuD,EAAAA,EAAAA,IAAqBC,EAAYsE,EAAMpD,QAAQ3E,IAEhE,CAEA,SAASmd,IACLld,GAASuS,EAAAA,EAAAA,GAAU,CACfC,QAAShJ,EAAAA,GAAiB2T,cAC1BzK,WAAY0K,EAAAA,QACZC,YAAa,CACTC,iBAAwE,IAAvDxa,EAAwBI,QAAQ4E,EAAMpD,QAAQ3E,IAAa,CAAC+H,EAAMpD,QAAQ3E,IAAM+C,KAG7G,CAEA,SAASya,EAAmCvZ,EAA+B8Y,GA4DvE,MAAO,IA3De9Y,EAAWoB,KAAKb,IAClC,IAAIwH,EAAOnE,IAAAA,cAAA,YAAOrD,EAASsF,cAEvBtF,EAAS7D,OAASqE,EAAAA,EAAcE,YAChC8G,EACInE,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,8CACH6K,eAAe,eAIvBrG,EAAS7D,OAASqE,EAAAA,EAAcyY,WAChCzR,EACInE,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,6CACH6K,eAAe,cAK3B,IAAI6S,EAAmB,KAUvB,OATIX,GAAmBA,EAAgBjT,eAAiBtF,EAASsF,eAC7D4T,EACI7V,IAAAA,cAACiD,EAAAA,UAAS,CACNwF,MAAM,mBACNlG,KAAM,MAMdvC,IAAAA,cAAC2I,EAAAA,GAAS,CACNxQ,GAAE,kBAAA6J,OAAoB9B,EAAMpD,QAAQ3E,GAAE,KAAA6J,OAAIrF,EAASxE,IACnDsM,IAAG,kBAAAzC,OAAoB9B,EAAMpD,QAAQ3E,GAAE,KAAA6J,OAAIrF,EAASxE,IACpD2Q,eAAgBnM,EAAS7D,OAASqE,EAAAA,EAAcE,UAAa2C,IAAAA,cAAC8V,EAAAA,gBAAe,CAACvT,KAAM,KAAUvC,IAAAA,cAAC+V,EAAAA,kBAAiB,CAACxT,KAAM,KACvHyG,OAAQ7E,EACR8E,iBAAkB4M,EAClBhS,QAAUwR,GAAUD,EAAqBC,EAAO1Y,EAASxE,KAC3D,IAKN6H,IAAAA,cAAC2I,EAAAA,GAAc,CAAClE,IAAI,8BACpBzE,IAAAA,cAAC2I,EAAAA,GAAS,CACNxQ,GAAE,qBAAA6J,OAAuB9B,EAAMpD,QAAQ3E,IACvCsM,IAAG,qBAAAzC,OAAuB9B,EAAMpD,QAAQ3E,IACxC,iBAAe,EACf2Q,eAAgB9I,IAAAA,cAACgW,EAAAA,sBAAqB,CAACzT,KAAM,KAC7CyG,OACIhJ,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,sDACH6K,eAAe,iBAGvBa,QAASyR,IAKrB,CAEA,SAASW,EAAmC7Z,GACxC,OAD+EH,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,GAEpEG,EAAWQ,QAAQD,GAAaA,EAAS7D,OAASqE,EAAAA,EAAcyY,WAGpExZ,EAAWQ,QAAQD,GAAaA,EAAS7D,OAASqE,EAAAA,EAAcG,iBAC3E,CA6BA,OAAKlB,EAKD4D,IAAAA,cAAC2I,EAAAA,GAAY,CACTxQ,GAAE,UAAA6J,OAAY9B,EAAMpD,QAAQ3E,IAC5B6Q,OACIhJ,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,2CACH6K,eAAe,eAGvB8F,eAAgB5I,EAAMgW,iBAAmB,KAAOlW,IAAAA,cAACgW,EAAAA,sBAAqB,CAACzT,KAAM,KAC7E0G,iBAAkBjJ,IAAAA,cAACmW,EAAAA,iBAAgB,CAAC5T,KAAM,KAC1C6T,OAAM,UAAApU,OAAY9B,EAAMpD,QAAQ3E,GAAE,SAClCke,cAAetT,EAAc,CAAC5K,GAAI,6DAA8D6K,eAAgB,qBA3CxH,SAAuC5G,EAA+B8Y,GAClE,MAAMoB,EAAiCpb,EAAwBqb,SAASrW,EAAMpD,QAAQ3E,IAGtF,OAAI+H,EAAMgW,mBAAqBI,EAGpBX,EADoBM,EAAmC7Z,EAD7C8D,EAAMpD,QAAQhE,OAAS8H,EAAAA,GAAU3D,YAAciD,EAAMpD,QAAQhE,OAAS8H,EAAAA,GAAU1D,YAEnCgY,GAG7Bha,EAAwBsb,OAAOte,GAAc6V,EAAY7V,GAAWY,OAAS8H,EAAAA,GAAU3D,YAAc8Q,EAAY7V,GAAWY,OAAS8H,EAAAA,GAAU1D,aAGzKyY,EADoBM,EAAmC7Z,GAAY,GACZ8Y,GAGvBha,EAAwBsb,OAAOte,GAAc6V,EAAY7V,GAAWY,OAAS8H,EAAAA,GAAU3D,YAAc8Q,EAAY7V,GAAWY,OAAS8H,EAAAA,GAAU1D,aAG/KyY,EADoBM,EAAmC7Z,GAAY,GACZ8Y,GAK3DS,EADoBvZ,EAAWQ,QAAQD,GAAaA,EAAS7D,OAASqE,EAAAA,EAAcyY,UAAYjZ,EAAS7D,OAASqE,EAAAA,EAAcG,kBACzE4X,EAClE,CAoBSuB,CAA8Bra,EAAY8Y,IAjBxC,IAkBQ,EAIvB,GAAewB,EAAAA,EAAAA,MAAK5B,E,imBCjKL,MAAMU,UAA0BxV,IAAAA,cAG3CK,WAAAA,CAAYH,GACRI,MAAMJ,GAAOK,EAAA,iBAHkB,MAAIA,EAAA,qBACxB,GAAKA,EAAA,oBASN,KACVe,KAAKC,SAAS,CAACoV,aAAc,IAAI,IACpCpW,EAAA,qBAEeC,IACZc,KAAKC,SAAS,CAACoV,aAAcnW,EAAEC,OAAOoF,OAAO,IAChDtF,EAAA,qBAEc,KACXe,KAAKiH,aAAa,IACrBhI,EAAA,sBAQe,KACRe,KAAKsV,eAGTtV,KAAKsV,cAAe,EACpBtV,KAAKuV,UAAY5R,YAAW,KACxB3D,KAAKsV,cAAe,CAAK,GArDd,KAwDXtV,KAAKpB,MAAMtE,WACX0F,KAAKpB,MAAMwK,QAAQoM,eAAexV,KAAKpB,MAAMtE,WAAY0F,KAAKhJ,MAAMqe,cAEpErV,KAAKpB,MAAMwK,QAAQ5P,eAAewG,KAAKpB,MAAM6W,cAAezV,KAAKhJ,MAAMqe,aAAcrV,KAAKpB,MAAMwV,iBACpG,IACHnV,EAAA,0BAEmB,KACRe,KAAKhJ,MAAMqe,cACd5S,QAAQzC,KAAKpB,MAAM8W,sBAAwB1V,KAAKpB,MAAM8W,sBAAwB1V,KAAKhJ,MAAMqe,cAAiBrV,KAAKhJ,MAAMqe,aAAaza,OAlE5H,KAmEdqE,EAAA,gBAES,KACN,IAAI0P,EACAgH,EACAC,EAoCJ,OAlCI5V,KAAKpB,MAAMtE,YACXqU,EACIjQ,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,uCACH6K,eAAe,oBAGvBiU,EACIjX,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,+BACH6K,eAAe,aAIvBiN,EACIjQ,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,uCACH6K,eAAe,wBAGvBiU,EACIjX,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,+BACH6K,eAAe,WAGvBkU,EACIlX,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,+BACH6K,eAAe,gEAKpB,CACHiN,kBACAgH,iBACAC,WACH,IAvFD5V,KAAKhJ,MAAQ,CACTqe,aAAczW,EAAM8W,qBAAuB,GAEnD,CAcApQ,oBAAAA,GACQtF,KAAKuV,WACLzK,aAAa9K,KAAKuV,UAE1B,CAqEA9P,MAAAA,GACI,MAAM,gBACFkJ,EAAe,eACfgH,EAAc,SACdC,GACA5V,KAAK6V,UAET,OACInX,IAAAA,cAAC8P,EAAAA,GAAY,CACT3X,GAAG,oBACH8X,gBAAiBA,EACjBmH,kBAAmBH,EACnBjH,eAAe,EACfD,SAAUzO,KAAKpB,MAAM6P,SACrBsH,oBAAqB/V,KAAKgW,cAC1BA,cAAehW,KAAKgW,cACpBC,aAAcjW,KAAKiW,aACnBC,kBAAmBlW,KAAKkW,qBAExBxX,IAAAA,cAACgI,EAAAA,EAAU,CACPyP,eAAgBC,EAAAA,EAChBC,WAAW,EACXpU,UAAU,8BACVzK,KAAK,OACL+M,MAAOvE,KAAKhJ,MAAMqe,aAClBzO,aAAawH,EAAAA,EAAAA,IAAgB,CAACvX,GAAI,kCAAmC6K,eAAgB,uBACrFqF,WAAW,EACXC,QAAShH,KAAKiH,YACd+D,SAAUhL,KAAK8G,aACfwP,UAhJD,KAkJF7T,QAAQmT,IAAalX,IAAAA,cAAA,QAAMuD,UAAU,2BACjC2T,GAIjB,EACH3W,EArIoBiV,EAAiB,aAflCzF,SAAQ5F,IAAAA,KAAAC,WACR2M,cAAa5M,IAAAA,OAAAC,WACbxO,WAAUuO,IAAAA,OACV6M,oBAAmB7M,IAAAA,OACnBuL,gBAAevL,IAAAA,QAAAA,IAAAA,QACfO,QAAOP,IAAAA,MAAA,CACHrP,eAAcqP,IAAAA,KAAAC,WACd0M,eAAc3M,IAAAA,KAAAC,aAAAA,aCMtB,SAAeuG,EAAAA,EAAAA,UAff,SAAyBrY,GACrB,MAAO,CACHye,eAAe9F,EAAAA,EAAAA,IAAiB3Y,GAExC,IAEA,SAA4BF,GACxB,MAAO,CACHsS,SAASgH,EAAAA,EAAAA,IAAmB,CACxB5W,eAAc,KACdgc,eAAcA,EAAAA,IACf1e,GAEX,GAEA,CAA4Dod,E,qnBCA7C,MAAMqC,UAAuB7X,IAAAA,cACxCK,WAAAA,CAAYH,GACRI,MAAMJ,GAAOK,EAAA,mBAeJ,KACTe,KAAKC,SAAS,CACVuW,MAAM,GACR,IACLvX,EAAA,uBAEiBC,KACVG,EAAAA,EAAAA,GAAaH,EAAGI,EAAAA,GAAUC,SAASC,QACnCQ,KAAKyW,cACT,IACHxX,EAAA,qBAEc,KACXe,KAAK0W,aAEL1W,KAAKpB,MAAMwK,QAAQuN,UACf3W,KAAKpB,MAAM6W,cACXzV,KAAKpB,MAAM2L,eAEfvK,KAAKpB,MAAMwK,QAAQwN,wBAAwB,IAhC3C5W,KAAKhJ,MAAQ,CACTwf,MAAM,EAEd,CAEAxR,iBAAAA,GACIG,SAASC,iBAAiB,WAAYpF,KAAK6W,eAC/C,CAEAvR,oBAAAA,GACIH,SAASI,oBAAoB,WAAYvF,KAAK6W,eAClD,CAwBApR,MAAAA,GACI,MAAM,YACFqR,EAAW,qBACXC,EAAoB,oBACpBC,GACAhX,KAAKpB,MAIT,IAAIqY,EAyEJ,OAtEQA,EALQC,EAAAA,EAAkBJ,EAAYK,OAId,IAAxBH,GAAsD,IAAzBD,EAEzBrY,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,qCACH6K,eAAe,4VACf2B,OAAQ,CACJ+T,uBAAwBJ,EACxBK,wBAAyBN,EACzBO,OAASC,GAA4B7Y,IAAAA,cAAA,cAAS6Y,MAI3B,IAAxBP,EAEHtY,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,kDACH6K,eAAe,yPACf2B,OAAQ,CACJgU,wBAAyBN,EACzBO,OAASC,GAA4B7Y,IAAAA,cAAA,cAAS6Y,MAMtD7Y,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,iDACH6K,eAAe,sPACf2B,OAAQ,CACJ+T,uBAAwBJ,EACxBM,OAASC,GAA4B7Y,IAAAA,cAAA,cAAS6Y,MAK/B,IAAxBP,GAAsD,IAAzBD,EAEhCrY,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,+BACH6K,eAAe,mXACf2B,OAAQ,CACJ+T,uBAAwBJ,EACxBK,wBAAyBN,EACzBO,OAASC,GAA4B7Y,IAAAA,cAAA,cAAS6Y,MAI3B,IAAxBP,EAEHtY,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,uCACH6K,eAAe,gRACf2B,OAAQ,CACJgU,wBAAyBN,EACzBO,OAASC,GAA4B7Y,IAAAA,cAAA,cAAS6Y,MAMtD7Y,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,sCACH6K,eAAe,uKACf2B,OAAQ,CACJ+T,uBAAwBJ,EACxBM,OAASC,GAA4B7Y,IAAAA,cAAA,cAAS6Y,MAO1D7Y,IAAAA,cAAC8Y,EAAAA,MAAK,CACFC,gBAAgB,cAChBxV,UAAU,gBACVuU,KAAMxW,KAAKhJ,MAAMwf,KACjB/H,SAAUzO,KAAKpB,MAAM6P,SACrBiJ,OAAQ1X,KAAK0W,WACb7f,GAAG,iBACHuM,KAAK,OACL,kBAAgB,uBAEhB1E,IAAAA,cAAC8Y,EAAAA,MAAMG,OAAM,CAACC,aAAa,GACvBlZ,IAAAA,cAAC8Y,EAAAA,MAAMK,MAAK,CACRC,eAAe,KACfjhB,GAAG,uBAEH6H,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,yBACH6K,eAAe,sBAI3BhD,IAAAA,cAAC8Y,EAAAA,MAAMO,KAAI,KACNd,GAELvY,IAAAA,cAAC8Y,EAAAA,MAAMQ,OAAM,KACTtZ,IAAAA,cAAA,UACIlH,KAAK,SACLyK,UAAU,mBACVM,QAASvC,KAAK0W,WACd7f,GAAG,eAEH6H,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,sBACH6K,eAAe,QAGvBhD,IAAAA,cAAA,UACIlH,KAAK,SACLyK,UAAU,iBACVM,QAASvC,KAAKyW,aACd5f,GAAG,gBAEH6H,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,uBACH6K,eAAe,UAMvC,ECvLJ,SAASuW,EAAwBjhB,GAG7B,OAFiBkhB,EAAAA,EAAAA,IAAclhB,GAEfsE,QAAQE,GAAYA,EAAQhE,OAAS8H,EAAAA,GAAUuM,kBAAiBjR,MACpF,CAEA,SAASud,EAAuBnhB,GAG5B,OAFiBkhB,EAAAA,EAAAA,IAAclhB,GAEfsE,QAAQE,GAAYA,EAAQhE,OAAS8H,EAAAA,GAAUwM,eAAclR,MACjF,CD8KCqE,EA7KoBsX,EAAc,aAf/BhM,cAAa1B,IAAAA,OAAAC,WACb2M,cAAa5M,IAAAA,OAAAC,WACbkO,oBAAmBnO,IAAAA,OAAAC,WACnBiO,qBAAoBlO,IAAAA,OAAAC,WACpB2F,SAAQ5F,IAAAA,KAAAC,WACRM,QAAOP,IAAAA,MAAA,CACH8N,UAAS9N,IAAAA,KAAAC,WACT8N,uBAAsB/N,IAAAA,KAAAC,aAAAA,aCgC9B,SAAeuG,EAAAA,EAAAA,UAvBf,SAAyBrY,GAKrB,MAAO,CACHuT,eALkBmF,EAAAA,EAAAA,IAAiB1Y,GAMnCye,eALkB9F,EAAAA,EAAAA,IAAiB3Y,GAMnC8f,aALgBsB,EAAAA,EAAAA,IAAephB,GAM/B+f,qBAAsBkB,EAAwBjhB,GAC9CggB,oBAAqBmB,EAAuBnhB,GAEpD,IAEA,SAA4BF,GACxB,MAAO,CACHsS,SAASgH,EAAAA,EAAAA,IAAmB,CACxBuG,UAAS,KACTC,uBAAwByB,EAAAA,IACzBvhB,GAEX,GAEA,CAA4Dyf,E,kiBC5CrD,MAAM+B,EAAuB,GAgFrB,MAAMC,UAAkB7Z,IAAAA,cAMnCK,WAAAA,CAAYH,GACRI,MAAMJ,GAAOK,EAAA,mBAmBJ,KACTe,KAAKC,SAAS,CAACuW,MAAM,GAAO,IAC/BvX,EAAA,mBAEY,KACLe,KAAKpB,MAAM8Y,QACX1X,KAAKpB,MAAM8Y,QACf,IACHzY,EAAA,eAkBQ,KACL,MAAM2E,EAAW5D,KAAKhJ,MAAM8H,KAAO,EACnCkB,KAAKwY,aAAa5U,EAAS,IAC9B3E,EAAA,eAEQ,KACL,MAAMwZ,EAAWzY,KAAKhJ,MAAM8H,KAAO,EACnCkB,KAAKwY,aAAaC,EAAS,IAC9BxZ,EAAA,qBAEc9H,UACX6I,KAAKC,SAAS,CAAC2C,SAAS,IACxB,MAAM1I,QAAe8F,KAAKpB,MAAM8Z,UAAU5Z,EAAMkB,KAAKhJ,MAAMkU,YAC3DlL,KAAKC,SAAS,CAACnB,OAAM6Z,MAAOze,EAAOye,MAAO/V,SAAS,GAAO,IAC7D3D,EAAA,sBAEe9H,UACZ,MAAM,OAACgI,GAAU4U,EACX7I,EAAa/L,EAAOoF,MAC1BvE,KAAKC,SAAS,CAAC2C,SAAS,EAAMsI,eAC9B,MAAMhR,QAAe8F,KAAKpB,MAAM8Z,UAAU,EAAGxN,IACvC,MAACyN,EAAK,WAAEC,GAAc1e,EAC5B8F,KAAKC,SAAS,CAAC2C,SAAS,EAAO+V,QAAOC,cAAY,IAjElD5Y,KAAK6Y,WAAaja,EAAMia,YAAcP,EAEtCtY,KAAKhJ,MAAQ,CACTwf,MAAM,EACN1X,KAAM,EACN6Z,MAAO,GACPC,WAAY,EACZhW,SAAS,EACTsI,WAAY,GAEpB,CAEA,uBAAMlG,GACF,MAAM,WAAC4T,EAAU,MAAED,SAAe3Y,KAAKpB,MAAM8Z,UAAU,EAAG,IAC1D1Y,KAAKC,SAAS,CAAC2Y,aAAYD,QAAO/V,SAAS,GAC/C,CAYAkW,UAAAA,GACI,OAAI9Y,KAAKhJ,MAAM4L,QAEPlE,IAAAA,cAAA,WACIA,IAAAA,cAACoH,EAAAA,EAAa,CACViT,SAAS,WACT5V,IAAI,aAKbnD,KAAKhJ,MAAM2hB,MAAMzc,KAAKiM,GACzBnI,KAAKpB,MAAMoa,UAAU7Q,EAAMnI,OAEnC,CA2BAiZ,eAAAA,GACI,IAAIC,EAAclZ,KAAKhJ,MAAM8H,KAAOkB,KAAK6Y,WAAc,EACvD,MAAMM,EAAYD,EAAalZ,KAAKhJ,MAAM2hB,MAAM/d,OAAU,EAI1D,OAHiB,IAAbue,IACAD,EAAa,GAEV,CAACA,aAAYC,WACxB,CAEA1T,MAAAA,GACI,IAAKzF,KAAKpB,MAAM4X,KACZ,OAAO,KAEX,MAAM,SAAC2C,EAAQ,WAAED,GAAclZ,KAAKiZ,kBACpC,OACIva,IAAAA,cAAA,WACIA,IAAAA,cAAC8Y,EAAAA,MAAK,CACFC,gBAAgB,4CAChBjB,KAAMxW,KAAKhJ,MAAMwf,KACjBkB,OAAQ1X,KAAK0W,WACbjI,SAAUzO,KAAKkJ,YAEfxK,IAAAA,cAAC8Y,EAAAA,MAAMG,OAAM,CAACC,aAAa,GACvBlZ,IAAAA,cAAC8Y,EAAAA,MAAMK,MAAK,CAACC,eAAe,MACxBpZ,IAAAA,cAAA,QAAMuD,UAAU,QAAQjC,KAAKpB,MAAMwa,YAEtCpZ,KAAKpB,MAAMya,oBAAsBrZ,KAAKpB,MAAM0a,uBACzC5a,IAAAA,cAAA,KACIuD,UAAU,yBACVsX,KAAK,IACLhX,QAASvC,KAAKpB,MAAM0a,uBAEnBtZ,KAAKpB,MAAMya,qBAGxB3a,IAAAA,cAAC8Y,EAAAA,MAAMO,KAAI,KACPrZ,IAAAA,cAAA,OAAKuD,UAAU,sBACXvD,IAAAA,cAAA,OAAKuD,UAAU,cACXvD,IAAAA,cAAA,OAAKuD,UAAU,aACXvD,IAAAA,cAAA,SACIuD,UAAU,eACVuX,QAAQ,oBAEPxZ,KAAKpB,MAAM6a,uBAEhB/a,IAAAA,cAAA,SACI7H,GAAG,mBACHoL,UAAU,8BACV2E,YAAa5G,KAAKpB,MAAM6a,sBACxBzO,SAAUhL,KAAK0Z,iBAGvBhb,IAAAA,cAAA,OAAKuD,UAAU,aACXvD,IAAAA,cAAA,QAAMuD,UAAU,0BACZvD,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,4BACH6K,eAAe,qEACf2B,OAAQ,CACJ6V,aACAC,WACAQ,MAAO3Z,KAAKhJ,MAAM4hB,iBAMtCla,IAAAA,cAAA,OAAKuD,UAAU,oBACXvD,IAAAA,cAAA,WACKsB,KAAK8Y,eAGdpa,IAAAA,cAAA,OAAKuD,UAAU,mBACVjC,KAAKhJ,MAAM8H,KAAO,GACnBJ,IAAAA,cAAA,UACI6D,QAASvC,KAAK4Z,OACd3X,UAAU,+DAEVvD,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,0BACH6K,eAAe,cAGtB1B,KAAKpB,MAAMia,YAAe7Y,KAAKhJ,MAAM2hB,MAAM/d,QAAUoF,KAAKpB,MAAMia,YAAeM,IAAanZ,KAAKhJ,MAAM4hB,YACxGla,IAAAA,cAAA,UACI6D,QAASvC,KAAK6Z,OACd5X,UAAU,+DAEVvD,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,0BACH6K,eAAe,cASnD,EACHzC,EAhLoBsZ,EAAS,aAzE1Ba,UAASvQ,IAAAA,OAKT4Q,sBAAqB5Q,IAAAA,OAKrBwQ,mBAAkBxQ,IAAAA,OAMlBgQ,WAAUhQ,IAAAA,OAKV2N,KAAI3N,IAAAA,KAKJyQ,sBAAqBzQ,IAAAA,KAiBrB6P,UAAS7P,IAAAA,KAAAC,WAQT4O,OAAM7O,IAAAA,KAUNmQ,UAASnQ,IAAAA,KAAAC,aAAA7J,EAYQsZ,EAAS,eACJ,CAClB/B,MAAM,G,wHC5EP,MAAMsD,EAAiB9G,IAA+C,IAA9C,UAAC/Q,EAAS,QAAE8X,GAA6B/G,EACpE,MAAMgH,GAAaC,EAAAA,EAAAA,MAAU,IAAM,OAC7BC,EAAqBH,GAAWI,EAAAA,EAAmBC,SAEzD,OACI1b,IAAAA,cAAA,QAAMuD,UAAWI,IAAW,kBAAmBJ,IAC3CvD,IAAAA,cAAC2b,EAAAA,EAAW,CAACN,QAASG,GAAqBF,KACzCM,EAAAA,EAAAA,OAAkB5b,IAAAA,cAAC2b,EAAAA,EAAW,CAACN,QAASG,GAAqB,SAC/Dxb,IAAAA,cAAC2b,EAAAA,EAAW,CAACN,QAASG,GAAqB,KACxC,EAEbJ,EAAAS,UAAA,CAfEtY,UAAS4G,IAAAA,O,sLCOP2R,EAA4BxH,IAGrB,IAHsB,GAC/Bnc,GAEImc,EADDyH,E,6WAAUC,CAAA1H,EAAA2H,GAEb,MAAM7jB,GAAWsb,EAAAA,EAAAA,eACXwI,GAAuBC,EAAAA,EAAAA,cAAY,KACrC/jB,GAASuS,EAAAA,EAAAA,GAAU,CACfC,QAAShJ,EAAAA,GAAiB2T,cAC1BzK,WAAY0K,EAAAA,UACb,GACJ,CAACpd,IAEJ,OACI4H,IAAAA,cAAC2I,EAAAA,GAASkL,OAAAuI,OAAA,CACNjkB,GAAE,UAAA6J,OAAY7J,GACd0L,QAASqY,EACT,iBAAe,EACfpT,eAAgB9I,IAAAA,cAACqc,EAAAA,sBAAqB,CAAC9Z,KAAM,KAC7CyG,OACIhJ,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,oDACH6K,eAAe,yBAGnB+Y,GACN,EAERD,EAAAD,UAAA,CA9BE1jB,GAAEgS,IAAAA,OAAAC,YAgCN,S,uKCjCA,MAAMmN,EAAeA,IAAM,KAErB+E,EAAyBhI,IAIlB,IAJmB,cAC5BgD,EAAa,YACbiF,EAAW,SACXxM,GACIuE,EACJ,MAAMxR,GAAOiS,EAAAA,EAAAA,WAEPyH,EAAS1Z,EAAKC,cAAc,CAAC5K,GAAI,oCAAqC6K,eAAgB,iBACtF2M,EAAO7M,EAAKC,cAAc,CAAC5K,GAAI,kCAAmC6K,eAAgB,iEAAkE,CAACuZ,gBACrJE,EAAU3Z,EAAKC,cAAc,CAAC5K,GAAI,qCAAsC6K,eAAgB,iBAE9F,OACIhD,IAAAA,cAAC8P,EAAAA,GAAY,CACT/N,UAAWya,EACXxM,eAAe,EACfC,gBAAiBuM,EACjBlF,cAAeA,EACfC,aAAcA,EACdxH,SAAUA,EACVqH,kBAAmBqF,GAEnBzc,IAAAA,cAAA,QAAMuD,UAAU,0BACXoM,GAEM,EAErB2M,EAAAT,UAAA,CAjCEvE,cAAanN,IAAAA,KAAAC,WACbmS,YAAWpS,IAAAA,OAAAC,WACX2F,SAAQ5F,IAAAA,KAAAC,YAiCZ,U,4CCvBMsS,EAAmBpI,IAKZ,IALa,GACtBnc,EAAE,mBACFwkB,EAAkB,YAClBJ,GAEIjI,EADDyH,E,6WAAUC,CAAA1H,EAAA2H,GAEb,MAAM7jB,GAAWsb,EAAAA,EAAAA,eAEX7P,GAAUsY,EAAAA,EAAAA,cAAY,KACpBI,GAAe,IAIC,IAAhBA,EAKJnkB,GAASuS,EAAAA,EAAAA,GAAU,CACfC,QAAShJ,EAAAA,GAAiBgb,gBAC1B9R,WAAYwR,EACZ7G,YAAa,CACT6B,cAAeqF,EACfJ,kBATJI,IAWD,GACJ,CAACvkB,EAAUukB,EAAoBJ,IAElC,OACIvc,IAAAA,cAAC2I,EAAAA,GAASkL,OAAAuI,OAAA,CACNjkB,GAAE,QAAA6J,OAAU7J,GACZ0L,QAASA,EACT,gBAAe0Y,EAAc,EAC7BzT,eAAgB9I,IAAAA,cAAC6c,EAAAA,iBAAgB,CAACta,KAAM,KACxCyG,OACIhJ,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,kDACH6K,eAAe,2BAGnB+Y,GACN,EAERW,EAAAb,UAAA,CAhDE1jB,GAAEgS,IAAAA,OAAAC,WACFuS,mBAAkBxS,IAAAA,KAAAC,WAClBmS,YAAWpS,IAAAA,OAAAC,YAgDf,S,+ICjDA,MAAM0S,EAA6BxI,IAItB,IAJuB,GAChCnc,EAAE,SACFoR,EAAQ,KACR9F,GACI6Q,EACJ,MAAOyI,EAAYC,IAAiB9I,EAAAA,EAAAA,WAAS,IAEvC,cAACnR,IAAiBgS,EAAAA,EAAAA,WAMxB,OACI/U,IAAAA,cAAA,OACIuD,UAAWI,IACP,cACA,cACA,CACI,oBAAqBoZ,EACrBE,SAAUF,KAIlB/c,IAAAA,cAAC2I,EAAAA,GAAc,CACXQ,WAAY,CACRhR,GAAI,8BAAF6J,OAAgC7J,GAClC,aAAc4K,EAAc,CAAC5K,GAAI,kDAAmD6K,eAAgB,oBAAqB,CAACS,SAC1HyZ,MAAO,yBACP3T,SAAUvJ,IAAAA,cAACmd,EAAAA,iBAAgB,CAAC5a,KAAM,MAEtC6a,kBAAmB,CACfjZ,KAAMpB,EAAc,CAAC5K,GAAI,kDAAmD6K,eAAgB,oBAAqB,CAACS,SAClHyZ,MAAO,aAEX1T,KAAM,CACFrR,GAAI,+BAAF6J,OAAiC7J,GACnC,aAAc4K,EAAc,CAAC5K,GAAI,uDAAwD6K,eAAgB,uBACzGqa,SA7BhB,SAA0BC,GACtBN,EAAcM,EAClB,IA8Ba/T,GAEH,EAEZuT,EAAAjB,UAAA,CAlDE1jB,GAAEgS,IAAAA,OAAAC,WACFb,SAAQY,IAAAA,QAAAA,IAAAA,MAAAC,WACR3G,KAAI0G,IAAAA,OAAAC,YAkDR,SAAesM,EAAAA,EAAAA,MAAKoG,E,iICpDb,MAAMS,EAA8Bvd,IAAAA,YAAiB,CAACE,EAAoB+H,IAEzEjI,IAAAA,cAAA,OAAKuD,UAAU,+DACXvD,IAAAA,cAAA,OACIiI,IAAKA,EACL1E,UAAU,yCAEVvD,IAAAA,cAAA,OAAKuD,UAAU,mCACVia,EAAAA,EAAAA,IAAWtd,EAAMlF,cAErBkF,EAAMqJ,aAIpBgU,EAAA1B,UAAA,CAlBCtS,SAAQY,IAAAA,KACRnP,YAAWmP,IAAAA,OAAAC,YAkBfmT,EAA4BviB,YAAc,8BAYnC,MAAMyiB,EAAwBzd,IAAAA,YAAiB,CAAAsU,EAS5CrM,KAAuC,IATM,SACnDsB,EAAQ,YACRvO,EAAW,gBACX0iB,EAAe,YACfC,EAAW,cACXC,GAAgB,EAAI,WACpBC,GAAa,EAAK,MAClBC,EAAK,QACLja,GACIyQ,EAOJ,OAJIoJ,GAAmBA,EAAgBhZ,MACnCqZ,QAAQC,eAAeN,EAAiB,QAIxC1d,IAAAA,cAAA,OACIuD,UAAWI,IAAW,4BAA6B,CAC/Cma,QACAG,SAAUJ,KAGd7d,IAAAA,cAAA,UACIiI,IAAKA,EACL1E,UAAWI,IAAW,yCACtB,aAAY3I,EACZ6I,QAASA,EACT,iBAAgB8Z,GAEhB3d,IAAAA,cAAA,KACIuD,UAAWI,IAAW,yBAA0B,CAC5C,uBAAwBga,EACxB,cAAeC,MAGvB5d,IAAAA,cAAA,MAAA6T,OAAAuI,OAAA,CACI7Y,UAAU,kCACNma,EAAe,CACnB1Z,UAAW,KAEVwZ,EAAAA,EAAAA,IAAWxiB,KAGnBuO,EACC,IAEXkU,EAAA5B,UAAA,CA9ECtS,SAAQY,IAAAA,KACRnP,YAAWmP,IAAAA,OAAAC,WAsBXuT,YAAWxT,IAAAA,KAAAC,WACXwT,cAAazT,IAAAA,KAAAC,WACbyT,WAAU1T,IAAAA,KACV+T,eAAc/T,IAAAA,KACd2T,MAAK3T,IAAAA,KAAAC,WACLvG,QAAOsG,IAAAA,KAAAC,YAmDXqT,EAAsBziB,YAAc,uB,mGC5ErB,SAASmjB,EAAmB7J,GAAsD,IAArD,eAAC8J,EAAc,UAAEC,EAAS,KAAElP,EAAI,UAAE5L,GAAiB+Q,EAC3F,OAAI8J,EAAiB,EAEbpe,IAAAA,cAAA,QACI7H,GAAG,iBACHoL,UAAWI,IAAW,CAAC2a,OAAO,EAAMC,OAAQF,GAAY9a,IAEvD4L,EACDnP,IAAAA,cAAA,QAAMuD,UAAU,kBACX6a,IAMV,IACX,CAACD,EAAAtC,UAAA,CAtBGuC,eAAcjU,IAAAA,OAAAC,WACdiU,UAASlU,IAAAA,KACTgF,KAAIhF,IAAAA,KACJ5G,UAAS4G,IAAAA,O,6fCCb,SAASqU,EAAiBlK,GAAoB,IAAnB,SAACmK,GAAgBnK,EACxC,OAAImK,EAEIze,IAAAA,cAAA,KACI,cAAY,YACZuD,UAAU,iDAIf,IACX,C,SAACib,EAAA3C,UAAA,CAbG4C,SAAQtU,IAAAA,KAAAC,YAeZ,SAAesM,EAAAA,EAAAA,MAAK8H,GCDpB,SAASC,EAASC,EAAuBvmB,EAAmBwmB,GACxD,OAAc,OAAVD,GAIG3a,QAAQ2a,EAAM1S,QAAQ4S,QAAUF,EAAMG,UAAU3iB,QAAUwiB,EAAMI,kBAAkB5iB,SAAWyiB,IAAqBxmB,CAC7H,CAWA,SAAewY,EAAAA,EAAAA,UATf,SAAyBrY,EAAoBymB,GACzC,MAAMJ,GAAmB5f,EAAAA,EAAAA,IAAoBzG,GAG7C,MAAO,CACHmmB,SAAUA,GAHAO,EAAAA,EAAAA,IAAa1mB,EAAOmV,EAAAA,GAAgBwR,MAAOF,EAAS5mB,IAGpC4mB,EAAS5mB,GAAIwmB,GAE/C,GAEA,CAAwCH,GC7BxC,SAASU,EAAkB5K,GAA2B,IAA1B,UAAC6K,EAAS,KAAEhQ,GAAYmF,EAChD,OAAI6K,EAEInf,IAAAA,cAAA,KAAGuD,UAAU,8BAGd4L,CACX,CAAC+P,EAAArD,UAAA,CAXG1M,KAAIhF,IAAAA,UAAA,CAAAA,IAAAA,QAAAA,IAAAA,MAAA,UACJgV,UAAShV,IAAAA,KAAAC,YAYb,U,qHCUA,MAAMgV,GAAqB9K,IAkBd,IAlBe,QACxBxX,EAAO,YACPuiB,EAAW,cACXxT,EAAa,gBACbyT,EAAe,WACfC,EAAU,QACVC,EAAO,SACPC,EAAQ,4BACRC,EAA2B,2BAC3BC,EAA0B,qBAC1BC,EAAoB,oCACpBC,EAAmC,YACnCC,EAAW,aACXC,EAAY,UACZpV,EAAS,kBACTqV,EAAiB,cACjBC,EAAa,oBACbC,GACI5L,EACJ,MAAM6L,GAAYC,EAAAA,EAAAA,SAAO,IAEnB,cAACrd,IAAiBgS,EAAAA,EAAAA,WAExB,IAAIsL,EAA+C,KACnD,GAAIZ,EAAU,CACV,SAASa,IAELV,EAAqB,CAAC9iB,EAAQ3E,IAClC,CAEAkoB,EACIrgB,IAAAA,cAAC2I,GAAAA,GAAS,CACNxQ,GAAE,cAAA6J,OAAgBlF,EAAQ3E,IAC1B0L,QAASyc,EACTxX,eAAgB9I,IAAAA,cAAC6c,GAAAA,iBAAgB,CAACta,KAAM,KACxCyG,OACIhJ,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,+CACH6K,eAAe,kBAMnC,KAAO,CACH,SAASud,IACLV,EAAoC/iB,EAAQ3E,GAChD,CAEAkoB,EACIrgB,IAAAA,cAAC2I,GAAAA,GAAS,CACNxQ,GAAE,gBAAA6J,OAAkBlF,EAAQ3E,IAC5B0L,QAAS0c,EACTzX,eAAgB9I,IAAAA,cAAC6c,GAAAA,iBAAgB,CAACta,KAAM,KACxCyG,OACIhJ,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,iDACH6K,eAAe,oBAKnC,CAEA,IAAIwd,EAAiD,KACrD,GAAIjB,EAAY,CACZ,SAASkB,IACLT,EAAkBljB,EAAQ3E,GAC9B,CAEAqoB,EACIxgB,IAAAA,cAAC2I,GAAAA,GAAS,CACNxQ,GAAE,cAAA6J,OAAgBlF,EAAQ3E,IAC1B0L,QAAS4c,EACT3X,eAAgB9I,IAAAA,cAAC0gB,GAAAA,SAAQ,CAACne,KAAM,KAChCyG,OACIhJ,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,sDACH6K,eAAe,gBAKnC,KAAO,CACH,SAAS2d,IACLrB,EAAgBxiB,EAAQ3E,GAC5B,CAEAqoB,EAEIxgB,IAAAA,cAAC2I,GAAAA,GAAS,CACNxQ,GAAE,YAAA6J,OAAclF,EAAQ3E,IACxB0L,QAAS8c,EACT7X,eAAgB9I,IAAAA,cAAC8V,GAAAA,gBAAe,CAACvT,KAAM,KACvCyG,OACIhJ,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,oDACH6K,eAAe,cAKnC,CAEA,IAAI4d,EAAgD,KACpD,GAAIpB,EAAS,CACT,IAAIqB,EACA7gB,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,kDACH6K,eAAe,mBAYvB,SAAS8d,IACLb,EAAcpU,EAAe/O,EAAQ3E,GACzC,CAXI2E,EAAQhE,OAAS8H,EAAAA,GAAU3D,YAAcH,EAAQhE,OAAS8H,EAAAA,GAAU1D,aACpE2jB,EACI7gB,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,2CACH6K,eAAe,YAS3B4d,EACI5gB,IAAAA,cAAC2I,GAAAA,GAAS,CACNxQ,GAAE,UAAA6J,OAAYlF,EAAQ3E,IACtB0L,QAASid,EACThY,eAAgB9I,IAAAA,cAAC+gB,GAAAA,mBAAkB,CAACxe,KAAM,KAC1CyG,OAAQ6X,GAGpB,KAAO,CACH,IAAIA,EACA7gB,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,gDACH6K,eAAe,iBAYvB,SAASge,IACLlB,EAAYjU,EAAe/O,EAAQ3E,GACvC,CAXI2E,EAAQhE,OAAS8H,EAAAA,GAAU3D,YAAcH,EAAQhE,OAAS8H,EAAAA,GAAU1D,aACpE2jB,EACI7gB,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,yCACH6K,eAAe,UAS3B4d,EACI5gB,IAAAA,cAAC2I,GAAAA,GAAS,CACNxQ,GAAE,QAAA6J,OAAUlF,EAAQ3E,IACpB0L,QAASmd,EACTlY,eAAgB9I,IAAAA,cAACihB,GAAAA,gBAAe,CAAC1e,KAAM,KACvCyG,OAAQ6X,GAGpB,CAEA,IAAIK,EAAuC,KAC3C,GAAIpkB,EAAQhE,OAAS8H,EAAAA,GAAUwM,cAAgBtQ,EAAQhE,OAAS8H,EAAAA,GAAUuM,gBAAiB,CACvF,SAASgU,KACLC,EAAAA,GAAAA,IAAgB/B,EACpB,CAEA6B,EACIlhB,IAAAA,cAAC2I,GAAAA,GAAS,CACNxQ,GAAE,YAAA6J,OAAclF,EAAQ3E,IACxB0L,QAASsd,EACTrY,eAAgB9I,IAAAA,cAACqhB,GAAAA,gBAAe,CAAC9e,KAAM,KACvCyG,OACIhJ,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,6CACH6K,eAAe,eAKnC,CAEA,IAAIse,EAAyC,KAC7C,GAAKxkB,EAAQhE,OAAS8H,EAAAA,GAAUuM,iBAAmBuS,GAAiC5iB,EAAQhE,OAAS8H,EAAAA,GAAUwM,cAAgBuS,EAA6B,CACxJ,SAAS4B,IACL5W,EAAU,CACNC,QAAShJ,EAAAA,GAAiB4f,eAC1B1W,WAAY2W,GAAAA,EACZhM,YAAa,CAAC3Y,YAEtB,CAEAwkB,EACIthB,IAAAA,cAAC2I,GAAAA,GAAS,CACNxQ,GAAE,cAAA6J,OAAgBlF,EAAQ3E,IAC1B0L,QAAS0d,EACT,gBAAc,OACdzY,eAAgB9I,IAAAA,cAAC0hB,GAAAA,uBAAsB,CAACnf,KAAM,KAC9CyG,OACIhJ,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,+CACH6K,eAAe,iBAKnC,CAEA,IAAI2e,EAA2C,KAC/C,GAAI7kB,EAAQ2G,OAAS7C,EAAAA,GAAUghB,gBAAiB,CAC5C,IAAIC,EACA7hB,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,iDACH6K,eAAe,kBAYvB,SAAS8e,KACD3B,EAAU/a,SAAY8a,IAI1BC,EAAU/a,SAAU,EAEpB8a,GAAoB,KAChBC,EAAU/a,SAAU,CAAK,IAEjC,CAnBItI,EAAQhE,OAAS8H,EAAAA,GAAU3D,YAAcH,EAAQhE,OAAS8H,EAAAA,GAAU1D,aACpE2kB,EACI7hB,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,sDACH6K,eAAe,wBAiB3B2e,EACI3hB,IAAAA,cAAC2I,GAAAA,GAAS,CACNxQ,GAAE,SAAA6J,OAAWlF,EAAQ3E,IACrB0L,QAASie,EACThZ,eAAgB9I,IAAAA,cAAC+hB,GAAAA,cAAa,CAACxf,KAAM,KACrCyG,OAAQ6Y,EACRG,eAAe,GAG3B,CAEA,OACIhiB,IAAAA,cAAC2I,GAAAA,GAAc,CACXQ,WAAY,CACRhR,GAAI,6BAAF6J,OAA+BlF,EAAQ3E,IACzC+kB,MAAO,yBACP,aAAcna,EAAc,CACxB5K,GAAI,0DACJ6K,eAAgB,qCACjB,CAAC4B,YAAa9H,EAAQ2G,OACzB8F,SAAUvJ,IAAAA,cAACmd,GAAAA,iBAAgB,CAAC5a,KAAM,MAEtC6a,kBAAmB,CACfF,MAAO,YACP/Y,KAAMpB,EAAc,CAAC5K,GAAI,gDAAiD6K,eAAgB,qBAE9FwG,KAAM,CACFrR,GAAI,+BAAF6J,OAAiClF,EAAQ3E,IAC3C,aAAc4K,EAAc,CAAC5K,GAAI,sDAAuD6K,eAAgB,sBACxGqa,SAAU0C,IAGbM,EACAG,EACAI,EACD5gB,IAAAA,cAAC2I,GAAAA,GAAc,MACf3I,IAAAA,cAACiiB,GAAAA,EAAoB,CAACnlB,QAASA,KAC7BokB,GAAoBI,IAAuBthB,IAAAA,cAAC2I,GAAAA,GAAc,MAC3DuY,EACAI,EACAK,GAAwB3hB,IAAAA,cAAC2I,GAAAA,GAAc,MACvCgZ,EACY,EAIzB,IAAejL,EAAAA,EAAAA,MAAK0I,IClQd8C,GAAqB,CACvBtC,qBAAoB,KACpBC,oCAAmC,KACnCP,gBAAe,KACfU,kBAAiB,KACjBF,YAAW,KACXG,cAAa,KACbtV,UAASA,EAAAA,GAOb,IAJkBgG,EAAAA,EAAAA,UAhClB,SAAyBrY,EAAoBymB,GACzC,MAAMoD,GAAS7Q,EAAAA,EAAAA,IAAwBhZ,GAAOymB,EAASjiB,QAAQ3E,IACzD8c,GAAcpE,EAAAA,EAAAA,IAAevY,GAEnC,IAAIqnB,GAA6B,EAC7BD,GAA8B,EAOlC,OALIzK,IACA0K,GAA6B7M,EAAAA,EAAAA,IAAuBxa,EAAO2c,EAAY9c,GAAI4mB,EAASjiB,QAAQ3E,GAAIoX,EAAAA,EAAY6S,+BAC5G1C,GAA8B5M,EAAAA,EAAAA,IAAuBxa,EAAO2c,EAAY9c,GAAI4mB,EAASjiB,QAAQ3E,GAAIoX,EAAAA,EAAY8S,iCAG1G,CACHxW,eAAemF,EAAAA,EAAAA,IAAiB1Y,GAChCinB,YAAY+C,EAAAA,EAAAA,IAAkBhqB,EAAOymB,EAASjiB,QAAQ3E,IACtDqnB,SAAS+C,EAAAA,EAAAA,IAAeJ,GACxB9C,YAAa,GAAFrd,QAAKwgB,EAAAA,GAAAA,OAAYxgB,OAAG+c,EAASM,aACxCM,6BACAD,8BAER,GAY2CwC,GAI3C,CAAyB9C,I,0ZCalB,MAAMqD,WAA2BziB,IAAAA,cAGpCK,WAAAA,CAAYH,GACRI,MAAMJ,GAAOK,GAAA,8BA+BO,KACpB,MAAMmiB,EAAUphB,KAAKqhB,SAASvd,QACxBwd,EAAcF,GAAWA,EAAQG,YAAcH,EAAQI,YAC7DxhB,KAAKC,SAAS,CAACqhB,YAAa7e,QAAQ6e,IAAc,IACrDriB,GAAA,qBAEc,KACX,MAAM,MAACwiB,EAAK,gBAAEC,EAAe,eAAE5E,EAAc,KAAEtb,GAAQxB,KAAKpB,MAE5D,IAAI6B,EAAYghB,EAgBhB,OAdIC,IACAjhB,GAAa,IAAJC,OAAQghB,IAGE,IAAnB5E,EACArc,GAAa,IAAJC,OAAQoc,EAAc,KAAApc,OAAIc,EAAKC,cAAc,CAAC5K,GAAI,sCAAuC6K,eAAgB,aAC3Gob,EAAiB,IACxBrc,GAAa,IAAJC,OAAQoc,EAAc,KAAApc,OAAIc,EAAKC,cAAc,CAAC5K,GAAI,uCAAwC6K,eAAgB,eAGnH1B,KAAKpB,MAAMuf,UAA+B,IAAnBrB,IACvBrc,GAAa,IAAJC,OAAQc,EAAKC,cAAc,CAAC5K,GAAI,qCAAsC6K,eAAgB,aAG5FjB,EAAUI,aAAa,IACjC5B,GAAA,2BAEqB8U,KAClB4N,EAAAA,EAAAA,IAAKC,EAAAA,GAAKC,oBACV7hB,KAAK8hB,oBAAoB/N,GAErB/T,KAAKpB,MAAM8K,SAAW1J,KAAKpB,MAAM+K,WAAaC,EAAAA,GAAUC,cACxD7J,KAAKpB,MAAMwK,QAAQU,oBACvB,IACH7K,GAAA,4BAEsB8U,IACfA,EAAMgO,kBAAqC,IAAjBhO,EAAMiO,UAIhCC,EAAAA,EAAAA,GAAiBlO,IACjBA,EAAMvQ,iBACNxD,KAAKpB,MAAMwK,QAAQnP,sBAAsB+F,KAAKpB,MAAMpD,QAAQ3E,KACrDkd,EAAMtU,UACbsU,EAAMvQ,iBACNxD,KAAKpB,MAAMwK,QAAQxL,qBAAqBoC,KAAKpB,MAAMpD,QAAQ3E,KACpDkd,EAAMpU,SAAWK,KAAKpB,MAAMuf,UACnCpK,EAAMvQ,iBACNxD,KAAKpB,MAAMwK,QAAQmV,oCAAoCve,KAAKpB,MAAMpD,QAAQ3E,KAE1EmJ,KAAKpB,MAAMwK,QAAQ9L,wBACvB,IACH2B,GAAA,yBAEmBwc,IAChBzb,KAAKC,SAAS,CAACwb,cAAY,IAtF3Bzb,KAAKqhB,SAAW3iB,IAAAA,YAEhBsB,KAAKhJ,MAAQ,CACTykB,YAAY,EACZ6F,aAAa,EAErB,CAEAtc,iBAAAA,GAA0B,IAAAkd,EACtBliB,KAAKmiB,wBAEDniB,KAAKpB,MAAMwjB,iBAAqC,QAAtBF,EAAIliB,KAAKpB,MAAMpD,eAAO,IAAA0mB,GAAlBA,EAAoBrrB,IAAwC,IAAlCmJ,KAAKpB,MAAMyjB,YAAYznB,QAC/EoF,KAAKpB,MAAMwK,QAAQkZ,oBAAoBtiB,KAAKpB,MAAMpD,QAAQ3E,GAElE,CAEA0rB,kBAAAA,CAAmBC,GAAwB,IAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EACnCL,EAAUf,QAAUzhB,KAAKpB,MAAM6iB,OAC/BzhB,KAAKmiB,wBAGLniB,KAAKpB,MAAMwjB,mBACO,QAAjBK,EAAAD,EAAUhnB,eAAO,IAAAinB,OAAA,EAAjBA,EAAmB5rB,OAAyB,QAAvB6rB,EAAK1iB,KAAKpB,MAAMpD,eAAO,IAAAknB,OAAA,EAAlBA,EAAoB7rB,MAAuB,QAAjB8rB,EAAAH,EAAUhnB,eAAO,IAAAmnB,OAAA,EAAjBA,EAAmBjX,YAA8B,QAAvBkX,EAAK5iB,KAAKpB,MAAMpD,eAAO,IAAAonB,OAAA,EAAlBA,EAAoBlX,WACtE,IAAlC1L,KAAKpB,MAAMyjB,YAAYznB,QACL,QADiBioB,EACnC7iB,KAAKpB,MAAMpD,eAAO,IAAAqnB,GAAlBA,EAAoBhsB,IACpBmJ,KAAKpB,MAAMwK,QAAQkZ,oBAAoBtiB,KAAKpB,MAAMpD,QAAQ3E,GAElE,CA8DA4O,MAAAA,GACI,MAAM,QACFjK,EAAO,KACPqS,EAAI,kBACJiV,EAAiB,QACjB5E,EAAO,SACPC,EAAQ,MACRsD,EAAK,KACLsB,EAAI,eACJjG,EAAc,iBACdkG,EAAgB,yBAChBC,EAAwB,UACxBlG,GACA/c,KAAKpB,MAET,IAAIskB,EAA0C,MAI1CF,IAAqBxnB,EAAQ2G,OAAU6gB,GAAoBC,GAA4BznB,EAAQ2G,OAAS7C,EAAAA,GAAUghB,mBAClH4C,EAAsBF,EAAoBtkB,IAAAA,cAACykB,EAAAA,GAA6B,CAACH,iBAAkBxnB,EAAQmF,eAAmBjC,IAAAA,cAACykB,EAAAA,GAA6B,OAGxJ,IAAIC,EACA1kB,IAAAA,cAAA,QACIiI,IAAK3G,KAAKqhB,SACVpf,UAAU,4BAETia,EAAAA,EAAAA,IAAWuF,IAGhBzhB,KAAKhJ,MAAMsqB,cACX8B,EACI1kB,IAAAA,cAAC2kB,EAAAA,EAAW,CACR9U,MAAOkT,GAEN2B,IAKb,MAAME,EAAetjB,KAAKpB,MAAM2kB,WAC5B7kB,IAAAA,cAAC8kB,EAAAA,EAAiB,CACdC,OAAQzjB,KAAKpB,MAAM2kB,WACnBjC,aAAa,EACboC,UAAW,CACPC,OAAQ,IAEZC,WAAY,CACRC,WAAY,EACZC,aAAc,EACdC,QAAS,MAGjB,KAEEhhB,EAAoB/C,KAAKpB,MAAMwjB,gBACjC1jB,IAAAA,cAACuE,EAAAA,EAAsB,CACnBhB,UAAU,OACViB,aAAa,EACbmf,YAAariB,KAAKpB,MAAMyjB,cAE5B,KAEE2B,EACFtlB,IAAAA,cAAAA,IAAAA,SAAA,KACIA,IAAAA,cAACkf,EAAkB,CACfC,UAAiC,IAAtBriB,EAAQuQ,UACnB8B,KAAMA,IAEVnP,IAAAA,cAAA,OACIuD,UAAU,mCAETmhB,EACAE,EACD5kB,IAAAA,cAACulB,EAAAA,QAAS,CACNC,cAAc,0BACd1oB,QAASwE,KAAKpB,MAAMpD,UAEvBuH,GAELrE,IAAAA,cAACwe,EAAiB,CAACrmB,GAAI2E,EAAQ3E,KAC/B6H,IAAAA,cAACme,EAAAA,EAAmB,CAChBC,eAAgBA,EAChBC,UAAWA,IAEfre,IAAAA,cAAA,OACIuD,UAAWI,IACP,cACA,cACA,CAACsZ,SAAU3b,KAAKhJ,MAAMykB,YACtB,CAAC,oBAAqBzb,KAAKhJ,MAAMykB,cAGrC/c,IAAAA,cAACof,GAAkB,CACftiB,QAASA,EACTuiB,YAAagF,EACb5E,SAAUA,EACVS,oBAAqB5e,KAAKpB,MAAMggB,oBAChCH,aAAcze,KAAKmkB,qBAO7BliB,EAAYI,IAAW,CACzB,cACA,CACIsZ,SAAU3b,KAAKhJ,MAAMykB,WACrBe,MAAO0B,EACP,eAAgBle,KAAKpB,MAAMuf,SAC3BiG,SAAUtB,KAGlB,OACIpkB,IAAAA,cAAC2lB,EAAAA,KAAI,CACDpiB,UAAWA,EACXpL,GAAE,eAAA6J,OAAiBlF,EAAQ2G,MAC3B,aAAYnC,KAAKskB,eACjBC,GAAIxB,EACJxgB,QAASvC,KAAKwkB,mBACd9hB,SAAU,GAETshB,EACAd,EAGb,EACHjkB,GAhOYkiB,GAAkB,aAnD3B4B,KAAIla,IAAAA,OAAAC,WACJ2Y,MAAK5Y,IAAAA,OAAAC,WACL4Y,gBAAe7Y,IAAAA,OACf+V,oBAAmB/V,IAAAA,KACnBgF,KAAIhF,IAAAA,UAAA,CAAAA,IAAAA,QAAAA,IAAAA,MAAA,UAKJiU,eAAcjU,IAAAA,OAAAC,WAKdqV,SAAQtV,IAAAA,KAAAC,WAKRoV,QAAOrV,IAAAA,KAAAC,WAEPga,kBAAiBja,IAAAA,KAAAC,WAEjBya,WAAU1a,IAAAA,OAEVma,iBAAgBna,IAAAA,OAEhBoa,yBAAwBpa,IAAAA,KAAAC,WAExBiU,UAASlU,IAAAA,KAAAC,WAETY,QAAOb,IAAAA,KACPuZ,gBAAevZ,IAAAA,KACfwZ,YAAWxZ,IAAAA,QAAAA,IAAAA,QAAAC,WAEXM,QAAOP,IAAAA,MAAA,CACH0V,oCAAmC1V,IAAAA,KAAAC,WACnCxL,sBAAqBuL,IAAAA,KAAAC,WACrBlL,qBAAoBiL,IAAAA,KAAAC,WACpB7O,sBAAqB4O,IAAAA,KAAAC,WACrB2b,iBAAgB5b,IAAAA,KAAAC,WAChBgB,mBAAkBjB,IAAAA,KAAAC,WAClBwZ,oBAAmBzZ,IAAAA,KAAAC,aAAAA,aA2O3B,UAAeE,EAAAA,EAAAA,YAAWmY,IC7N1B,IAAe9R,EAAAA,EAAAA,UAjDf,WACI,MAAMqV,GAAiBC,EAAAA,EAAAA,MAEvB,MAAO,CAAC3tB,EAAoBymB,KAAuB,IAAAmH,EAC/C,MAAM/D,GAAS7Q,EAAAA,EAAAA,IAAwBhZ,GAAOymB,EAASjiB,QAAQ3E,IACzDguB,EAAcH,EAAe1tB,EAAOymB,EAASjiB,QAAQ3E,IACrDiuB,GAASnT,EAAAA,EAAAA,IAAU3a,GACnB+tB,EAA2C,SAA1BD,EAAOE,eACxBza,GAAgBmF,EAAAA,EAAAA,IAAiB1Y,GACjCiuB,GAAeC,EAAAA,EAAAA,IAAOluB,EAAOmuB,EAAAA,GAAiBC,yBAA0B7a,EAAe,GAEvF8a,GADcH,EAAAA,EAAAA,IAAOluB,EAAOsuB,EAAAA,GAAwBC,EAAAA,EAAoBC,cAAeC,EAAAA,MAChDC,EAAAA,GAAiB3V,QACxD4V,EAA0Bb,EAAOc,qBAEjC3C,EADmB8B,GAAkBE,IAAiBY,EAAAA,GAAoBC,8BAC3BT,GAAoD,SAA5BM,EAEvEtD,EAA8B,QAAhBuC,EAAAnH,EAASjiB,eAAO,IAAAopB,GAAhBA,EAAkB5hB,QAClC+iB,EAAAA,EAAAA,IAAyB/uB,EAAOymB,EAASjiB,QAAQ3E,IAAM,GAE3D,MAAO,CACHimB,eAAgB+H,EAAYmB,SAC5BC,WAAYpB,EAAY/iB,SACxBqc,SAAU0G,EAAYqB,WACtBhI,SAAS+C,EAAAA,EAAAA,IAAeJ,GACxB9D,UAAW8H,EAAY9H,UACvB+F,mBAAmBA,EAAAA,EAAAA,IAAkB9rB,EAAOymB,EAASjiB,QAAQ3E,IAC7DmsB,iBAAkBC,GAA2BkD,EAAAA,EAAAA,IAAoBnvB,GAAS,GAC1EisB,2BACAtZ,UAAUsG,EAAAA,EAAAA,IAAYjZ,GACtB0S,SAASwG,EAAAA,EAAAA,GAAalZ,GACtBqrB,cACH,CAET,IAEA,SAA4BvrB,GACxB,MAAO,CACHsS,SAASgH,EAAAA,EAAAA,IAAmB,CACxBmO,oCAAmC,KACnCkG,iBAAgB,KAChBnnB,sBAAqB,KACrBM,qBAAoB,KACpB3D,sBAAqB,KACrB6P,mBAAkB,KAClBwY,oBAAmBA,EAAAA,IACpBxrB,GAEX,GAEA,CAAgEqqB,I,eClEhE,MAAMiF,GAAqBpT,IAId,IAJe,QACxBxX,EAAO,gBACP6qB,EAAe,QACfjd,GACI4J,EACJ,MAAMxR,GAAOiS,EAAAA,EAAAA,WAEP6S,GAA2BzL,EAAAA,EAAAA,cAAa0L,IAC1Cnd,EAAQod,aAAahrB,EAAQ3E,IAC7B0vB,GAAU,GACX,CAAC/qB,EAAQ3E,GAAIuS,EAAQod,eAElBC,GAA4B5L,EAAAA,EAAAA,cAAa0L,IAC3Cnd,EAAQC,UAAU,CAACC,QAAShJ,EAAAA,GAAiBomB,4BAA6Bld,WAAYmd,EAAAA,EAAmBxS,YAAa,CAAC3Y,aACvH+qB,GAAU,GACX,CAAC/qB,EAAS4N,EAAQC,YAErB,IAAIuV,EAAsB,KACtBpjB,EAAQhE,OAAS8H,EAAAA,GAAUwM,cAAgBtQ,EAAQ2G,OAAS7C,EAAAA,GAAUghB,gBACtE1B,EAAsB0H,EACf9qB,EAAQhE,OAAS8H,EAAAA,GAAUuM,kBAClC+S,EAAsB6H,GAG1B,MAAMG,EACFloB,IAAAA,cAACmoB,GAAAA,EAAsB,CACnBC,YAAatrB,EAAQhE,OAI7B,IAAIkqB,EAOJ,OANIlmB,EAAQhE,OAAS8H,EAAAA,GAAUwM,aAC3B4V,EAAkBlgB,EAAKC,cAAc,CAAC5K,GAAI,qCAAsC6K,eAAgB,mBACzFlG,EAAQhE,OAAS8H,EAAAA,GAAUuM,kBAClC6V,EAAkBlgB,EAAKC,cAAc,CAAC5K,GAAI,sCAAuC6K,eAAgB,qBAIjGhD,IAAAA,cAACyiB,GAAkB,CACf3lB,QAASA,EACTunB,KAAI,IAAAriB,OAAM2lB,EAAe,cAAA3lB,OAAalF,EAAQ2G,MAC9Csf,MAAOjmB,EAAQmF,aACf+gB,gBAAiBA,EACjB9C,oBAAqBA,EACrB/Q,KAAM+Y,EACNxE,gBAAiB5mB,EAAQwH,QAC3B,EAERojB,GAAA7L,UAAA,CAnDE8L,gBAAexd,IAAAA,OAAAC,YAqDnB,YC9CA,IAJkBuG,EAAAA,EAAAA,SAAQ,MAT1B,SAA4BvY,GACxB,MAAO,CACHsS,SAASgH,EAAAA,EAAAA,IAAmB,CACxBoW,aAAY,KACZnd,UAASA,EAAAA,GACVvS,GAEX,GAMA,CAAyBsvB,I,ydCSzB,MAAMW,WAA6BroB,IAAAA,cAA2BK,WAAAA,GAAA,SAAApE,WAAAsE,GAAA,2BACpCsnB,IAClB,MAAM1vB,EAAKmJ,KAAKpB,MAAMpD,QAAQwrB,YACxB3rB,EAAWiE,EAAAA,GAAU2nB,YAAYC,6BAEjC3c,EAAgBvK,KAAKpB,MAAM2L,cACjCvK,KAAKpB,MAAMwK,QAAQ+d,gBAAgB5c,EAAe,CAAC,CAAC6c,QAAS7c,EAAelP,WAAU8G,KAAMtL,EAAK0N,MAAO,WAAW4F,KAAKoc,GACxHvmB,KAAKpB,MAAMwK,QAAQie,mBAAmBrnB,KAAKpB,MAAMpD,QAAQ2G,MAErDnC,KAAKpB,MAAM0oB,SACX3c,EAAAA,GAAAA,KAAa/C,KAAK,IAADlH,OAAKV,KAAKpB,MAAMynB,gBAAe,cAAA3lB,OAAaV,KAAKpB,MAAM2oB,iBAC5E,IACHtoB,GAAA,gBAES,KACN,MAAM,QAACzD,EAAO,SAAEgsB,GAAYxnB,KAAKpB,MAEjC,IAAK4oB,EACD,OAAO,KAGX,GAAIA,EAAS3wB,IAAM2wB,EAASzb,UACxB,OACIrN,IAAAA,cAAA,KAAGuD,UAAU,8BAIrB,IAAIA,EAAY,GAShB,MARuB,WAAnBzG,EAAQqU,OACR5N,EAAY,gBACc,SAAnBzG,EAAQqU,OACf5N,EAAY,cACc,QAAnBzG,EAAQqU,SACf5N,EAAY,cAIZvD,IAAAA,cAAC+oB,GAAAA,EAAc,CACXC,IAAKpwB,GAAAA,GAAQqwB,qBAAqBH,EAAS3wB,GAAI2wB,EAASI,qBACxD3mB,KAAM,KACN4O,OAAQ2X,EAASK,OAAS,GAAKrsB,EAAQqU,OACvCiY,aAAa,iCACbC,eAAe,EACfC,YAAW,8BAAAtnB,OAAgCuB,IAC7C,GAET,CAEDwD,MAAAA,GACI,MAAM,QAACjK,EAAO,SAAEgsB,EAAQ,gBAAEnB,GAAmBrmB,KAAKpB,MAElD,IAAK4oB,EACD,OAAO,KAGX,IAAI9tB,EAAc8B,EAAQmF,aAU1B,OATIX,KAAKpB,MAAM2L,gBAAkBid,EAAS3wB,KACtC6C,EAAcsG,KAAKpB,MAAM4C,KAAKC,cAAc,CACxC5K,GAAI,4BACJ6K,eAAgB,uBACjB,CACCumB,YAAazsB,EAAQmF,gBAKzBjC,IAAAA,cAACyiB,GAAkB,CACfoC,WAAYiE,EAAS3wB,GACrB2E,QAASA,EACTunB,KAAI,IAAAriB,OAAM2lB,EAAe,eAAA3lB,OAAc8mB,EAASU,UAChDzG,MAAO/nB,EACPklB,oBAAqB5e,KAAKwgB,mBAC1B3S,KAAM7N,KAAKmoB,UACX/F,gBAAiB3f,QAAQ+kB,EAASY,YAG9C,EACHnpB,GA7EK8nB,GAAoB,aAVtBV,gBAAexd,IAAAA,OAAAC,WACfyB,cAAa1B,IAAAA,OAAAC,WACbye,gBAAe1e,IAAAA,OAAAC,WACfwe,OAAMze,IAAAA,KAAAC,WACNM,QAAOP,IAAAA,MAAA,CACHse,gBAAete,IAAAA,KAAAC,WACfue,mBAAkBxe,IAAAA,KAAAC,aAAAA,aAmF1B,UAAeE,EAAAA,EAAAA,YAAW+d,ICjE1B,IAAe1X,EAAAA,EAAAA,UAzBf,SAAyBrY,EAAoBymB,GACzC,MAAM+J,GAAWa,EAAAA,GAAAA,IAAQrxB,EAAOymB,EAASjiB,QAAQwrB,aAC3ClQ,GAAcsB,EAAAA,GAAAA,IAAephB,GAC7B2c,GAAcpE,EAAAA,EAAAA,IAAevY,GAC7BuwB,EAAkB5T,GAAc2U,EAAAA,EAAAA,IAA8BtxB,EAAO2c,EAAY9c,IAAM,GACvFwmB,GAAmB5f,EAAAA,EAAAA,IAAoBzG,GACvCswB,EAAS7J,EAASjiB,QAAQ3E,KAAOwmB,EAEvC,MAAO,CACHmK,WACAjd,cAAeuM,EAAYjgB,GAC3B0wB,kBACAD,SAER,IAEA,SAA4BxwB,GACxB,MAAO,CACHsS,SAASgH,EAAAA,EAAAA,IAAmB,CACxB+W,gBAAe,MACfE,mBAAkBA,EAAAA,IACnBvwB,GAEX,GAEA,CAA4DiwB,ICtBtDwB,GAAsBvV,IAQf,IARgB,QACzBxX,EAAO,cACP+O,EAAa,QACbnB,EAAO,OACPke,EAAM,gBACNjB,EAAe,gBACfkB,EAAe,aACfiB,GACIxV,EACJ,MAAMwN,GAAqB3F,EAAAA,EAAAA,cAAa0L,IACpC,MAAM1vB,EAAK2E,EAAQ3E,GACbwE,EAAWiE,EAAAA,GAAAA,YAAsBmpB,4BAEvCrf,EAAQ+d,gBAAgB5c,EAAe,CAAC,CAAC6c,QAAS7c,EAAelP,WAAU8G,KAAMtL,EAAI0N,MAAO,WAAW4F,KAAKoc,GAExGe,IACA3c,EAAAA,GAAAA,KAAa/C,KAAK,IAADlH,OAAK2lB,EAAe,cAAA3lB,OAAa6mB,GACtD,GACD,CAAC/rB,EAAQ3E,GAAIuS,EAASke,EAAQjB,EAAiBkB,EAAiBhd,IAQnE,OACI7L,IAAAA,cAACyiB,GAAkB,CACf3lB,QAASA,EACTunB,KAAI,IAAAriB,OAAM2lB,EAAe,cAAA3lB,OAAalF,EAAQ2G,MAC9Csf,MAAOjmB,EAAQmF,aACfie,oBAAqB4B,EACrB3S,KAVAnP,IAAAA,cAAA,OAAKuD,UAAU,wBAAwBumB,IAWzC,EAERD,GAAAhO,UAAA,CA7CE8L,gBAAexd,IAAAA,OAAAC,WACfyB,cAAa1B,IAAAA,OAAAC,WACbye,gBAAe1e,IAAAA,OAAAC,WACfwe,OAAMze,IAAAA,KAAAC,WACN0f,aAAY3f,IAAAA,OAAAC,WACZM,QAAOP,IAAAA,MAAA,CACHse,gBAAete,IAAAA,KAAAC,aAAAA,YAyCvB,UAAesM,EAAAA,EAAAA,MAAKmT,ICfpB,IAAelZ,EAAAA,EAAAA,UA5Bf,WACI,MAAMqZ,GAAiBC,EAAAA,EAAAA,MAEvB,MAAO,CAAC3xB,EAAoBymB,KACxB,MAAMlT,GAAgBmF,EAAAA,GAAAA,IAAiB1Y,GACjC2c,GAAcpE,EAAAA,EAAAA,IAAevY,GAC7BuwB,EAAkB5T,GAAc2U,EAAAA,EAAAA,IAA8BtxB,EAAO2c,EAAY9c,IAAM,GACvFwmB,GAAmB5f,EAAAA,EAAAA,IAAoBzG,GACvCwxB,EAAeE,EAAe1xB,EAAOymB,EAASjiB,SAGpD,MAAO,CACH+O,gBACAgd,kBACAD,OALW7J,EAASjiB,QAAQ3E,KAAOwmB,EAMnCmL,eACH,CAET,IAEA,SAA4B1xB,GACxB,MAAO,CACHsS,SAASgH,EAAAA,EAAAA,IAAmB,CACxB+W,gBAAeA,GAAAA,IAChBrwB,GAEX,GAEA,CAAgEyxB,ICM1DK,IAAYvZ,EAAAA,EAAAA,UA1BlB,WACI,MAAM8B,GAAa0X,EAAAA,EAAAA,MACbnE,GAAiBC,EAAAA,EAAAA,MAEvB,MAAO,CAAC3tB,EAAoBymB,KACxB,MAAMjiB,EAAU2V,EAAWna,EAAOymB,EAAS7mB,WACrC+c,GAAcpE,EAAAA,EAAAA,IAAevY,GAE7BqmB,GAAmB5f,EAAAA,EAAAA,IAAoBzG,GAEvC6tB,EAAcH,EAAe1tB,GAAOwE,aAAO,EAAPA,EAAS3E,KAAM,IAEzD,MAAO,CACH2E,UACAstB,kBAAkBttB,aAAO,EAAPA,EAAS3E,MAAOwmB,EAClCgJ,gBAAiB1S,aAAW,EAAXA,EAAaxR,KAC9B2a,eAAgB+H,EAAYmB,SAC5B7H,SAAU0G,EAAYqB,WACtB6C,eAAeC,EAAAA,EAAAA,IAAiBhyB,GAChC8rB,mBAAmBA,EAAAA,EAAAA,IAAkB9rB,EAAOymB,EAAS7mB,WACrDgD,wBAAyB5C,EAAM6C,MAAMC,eAAeF,wBACpDqvB,uBAAuBC,EAAAA,EAAAA,IAAyBlyB,GACnD,CAET,IAQA,GAAe4xB,IC5Cf,SAAuB5V,GAeb,IAfc,oBACpBmW,EAAmB,kBACnBC,EAAiB,SACjBjL,EAAQ,iBACR2K,EAAgB,cAChBO,EAAa,QACb7tB,EAAO,gBACP6qB,EAAe,YACfiD,EAAW,kBACXxG,EAAiB,cACjBiG,EAAa,wBACbnvB,EAAuB,aACvB2vB,EAAY,qBACZC,EAAoB,sBACpBP,GACIjW,EACJ,MAAOwD,EAAMiT,IAAW7W,EAAAA,EAAAA,WAAS,GACjC,IAAKpX,EACD,OAAO,KAGX,IAAK6qB,EACD,OAAO,KAGX,SAAShK,IACL,OAAO+M,GAAsBD,IAAwBhL,IAAa2K,CACtE,CAEA,SAASY,EAAOC,GACZ,OAAQhjB,IACJ0iB,GAAc7tB,aAAO,EAAPA,EAAS3E,KAAM,GAAI8P,GACjCgjB,SAAAA,EAAYhjB,EAAI,CAExB,CAEA,SAASijB,EAAqB7V,GACtBA,GAAiC,sBAAxBA,EAAM8V,gBAA0CxN,KACzDoN,GAAQ,EAEhB,CAEA,SAASK,EAAmB/V,GACpBA,GAAiC,2BAAxBA,EAAM8V,eAA8CxN,KAC7DoN,GAAQ,EAEhB,CAEA,IAAIM,EA0BJ,GAtBIA,EAHCvT,EAEMhb,EAAQhE,OAAS8H,EAAAA,GAAU3D,WAE9B+C,IAAAA,cAACqoB,GAAoB,CACjBvrB,QAASA,EACT6qB,gBAAiBA,IAGlB7qB,EAAQhE,OAAS8H,EAAAA,GAAU1D,WAE9B8C,IAAAA,cAAC6pB,GAAmB,CAChB/sB,QAASA,EACT6qB,gBAAiBA,IAKrB3nB,IAAAA,cAAC0nB,GAAkB,CACf5qB,QAASA,EACT6qB,gBAAiBA,IAnBb,KAwBZiD,EAAa,CACb,IAAIU,EAaJ,OAZIlH,GAAqBiG,EAAc/xB,OAAS+xB,EAAclyB,KAAO2E,EAAQ3E,IAAM+C,EAAwBgB,OAAS,IAChHovB,EAAgBxT,EACZ9X,IAAAA,cAAA,OAAKuD,UAAU,iCACXvD,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,6CACH6K,eAAe,mBACf2B,OAAQ,CAACsF,MAAO/O,EAAwBgB,WAGhD,MAIJ8D,IAAAA,cAACurB,EAAAA,UAAS,CACNC,YAAa1uB,EAAQ3E,GACrB8F,MAAO4sB,IAEN,CAACY,EAAUC,IAEJ1rB,IAAAA,cAAA,KAAA6T,OAAAuI,OAAA,CACIuP,UAAU,QACV1jB,IAAK+iB,EAAOS,EAASG,UACrBroB,UAAWI,IAAW,iBAAkB,CACpCkoB,UAAWlO,IACXmO,UAAWnO,IACXoO,OAAQtM,EACRmJ,OAAQwB,EACRnM,SAAUyN,EAAS7N,WACnBmO,iBAAkB5H,GAAqBiG,EAAc/xB,OAAS+xB,EAAclyB,KAAO2E,EAAQ3E,GAC3F8zB,WAAYP,EAASQ,iBAAmBR,EAASS,cAAgB5B,EAAsB6B,IAAIV,EAASS,cACpGE,QAASvB,IAAyBY,EAAS7N,cAE3C4N,EAASa,eACTb,EAAS/N,gBAAe,CAC5B6O,iBAAkBrB,EAClBsB,eAAgBpB,EAChB1mB,KAAK,WACLV,UAAW,IAEVqnB,EACAC,IAMzB,CAEA,OACItrB,IAAAA,cAAA,MACIiI,IAAK+iB,IACLznB,UAAWI,IAAW,iBAAkB,CACpCkoB,UAAWlO,IACXmO,UAAWnO,IACXoO,OAAQtM,EACRmJ,OAAQwB,IAEZmC,iBAAkBrB,EAClBsB,eAAgBpB,EAChB1mB,KAAK,YAEJ2mB,EAGb,G,8vCCrIO,SAASoB,EAAe7b,GAC3B,OAAOnY,MAAOL,EAAUC,KACpBD,GAASs0B,EAAAA,EAAAA,IAAW9b,EAAKzY,KAEzB,MAAMG,EAAQD,IACR+f,GAAcsB,EAAAA,EAAAA,IAAephB,GACnCq0B,EAAAA,EAAkBC,kBAAkBxU,EAAYjgB,GAAIyY,EAAKzY,KAE7B00B,EAAAA,EAAAA,IAA+Bv0B,IAEvDF,GAAS00B,EAAAA,EAAAA,OAGb,MAAMxZ,GAAUC,EAAAA,EAAAA,IAAWjb,GACrBy0B,GAAqBC,EAAAA,EAAAA,IAAsB10B,GACjD,GAAIgb,GACuB,SAAvBA,EAAQE,aACgB,SAAvBF,EAAQ2Z,YAAyBF,GAAqB,CACvD,MAAMG,EAAgC,CAClCC,wBAAwB,EACxB/sB,KAAM,EACNgtB,SAAU,GACVC,sBAAsB,EACtBC,oBAAoB,EACpBC,kBAAkB,GAEhBC,EAAsCC,EAAAA,EAAA,GACrCP,GAAY,IACfQ,kBAAmBtV,EAAYjgB,KAG/BigB,GACAhgB,GAASu1B,EAAAA,EAAAA,IAA2BH,IAGb,SAAvBla,EAAQ2Z,YACR70B,GAASw1B,EAAAA,EAAAA,IAAuChd,EAAKzY,IAAI,IAGzDyY,EAAKid,mBAA4C,SAAvBva,EAAQ2Z,WAClC70B,GAAS01B,EAAAA,EAAAA,IAA6Bld,EAAKzY,IAAI,IAE/CC,GAAS21B,EAAAA,EAAAA,GAAUb,GAE3B,CAEA,MAAO,CAACj0B,KAAM2X,EAAK,CAE3B,C,yXC9CA,MAGMod,GAAsB,IAAIC,OAAO,gBAADjsB,OAHjB,GAG8C,mBAAAA,OAH9C,GAG4E,OAE1F,SAASksB,GAA0B5Z,GAAqD,IAApD,MAAC6Z,EAAK,QAAEC,GAAyB9Z,EACxE,OAAO7b,MAAOL,EAAUC,KACpB,MAAMC,EAAQD,KACR,KAACg2B,EAAI,WAAEC,EAAU,KAAE1d,GAAQud,EAAMI,OAEvC,IAAKD,EACD,MAAO,CAACr1B,UAAMkD,GAGlB,MAAMqyB,GAAUC,EAAAA,EAAAA,IAAcn2B,EAAOsY,GACrC,IAAK4d,EACD,MAAO,CAACv1B,UAAMkD,GAGlB,MAAMuyB,QAiCPj2B,eAAqCH,EAAoB+1B,EAAcC,GAC1E,GAAa,aAATD,EAAqB,CAGrB,MAAMM,GAAiBC,EAAAA,EAAAA,IAAiBt2B,EAAOg2B,GACzCO,GAAqBC,EAAAA,EAAAA,IAAiBx2B,GAAOoE,MAAMqyB,GAASA,EAAKtrB,OAAS6qB,IAEhF,GA3Da,KA2DTA,EAAWpyB,OAAyB,CACpC,IAAKyyB,IAAmBE,EACpB,IAEI,aADMj2B,EAAAA,GAAQ6Z,WAAW6b,GAClB,YACX,CAAE,MAAO9tB,GACL,OAAsB,MAAlBA,EAAEwuB,YACK,eAEJ,OACX,CAEJ,MAAO,cACX,CAAO,OACDL,IAAmBE,GAxEN,KAwE4BP,EAAWpyB,QAEjDyyB,GAAkBA,EAAe71B,OAAS8H,EAAAA,GAAU1D,YACpD2xB,GAAsBA,EAAmB/1B,OAAS8H,EAAAA,GAAU1D,WAG1D,yBA4PnB,SAAmCoxB,GAC/B,OA1U2B,KA0UpBA,EAAWpyB,QAAqC8xB,GAAoBiB,KAAKX,EACpF,CA7PmBY,CAA0BZ,GAC1B,0BAEJ,cACX,CAAO,MAAa,aAATD,EACyB,IAA5BC,EAAWhzB,QAAQ,KACZ,0BACAgzB,EAAWhzB,QAAQ,KAAO,EAC1B,uBAxFE,KAyFFgzB,EAAWpyB,OACX,yBAzFQ,KA0FRoyB,EAAWpyB,OACX,yBAEJ,QAGJ,OACX,CA/EkCizB,CAAsB72B,EAAO+1B,EAAMC,GAE7D,OAAQI,GACR,IAAK,eACDt2B,EA2GL,SAAkC+1B,EAAcC,GACnD,OAAO31B,MAAOL,EAAUC,KACpB,MAAMC,EAAQD,KACR,KAACuY,EAAI,WAAE0d,GAAcH,EAAMI,OAC3B3pB,EAAc0pB,EAAWnsB,cAEzBqsB,GAAUC,EAAAA,EAAAA,IAAcn2B,EAAOsY,GACrC,IAAK4d,EACD,MAAO,CAACv1B,UAAMkD,GAGlB,IAQIgmB,EARArlB,GAAUsyB,EAAAA,EAAAA,IAAyB92B,EAAOk2B,EAASr2B,IAAIyM,GAC3D,IAAK9H,EAAS,CACV,MAAMuyB,QAAiCj3B,GAASk3B,EAAAA,EAAAA,IAA4B1e,EAAMhM,GAAa,IAC3F,SAAUyqB,IACVvyB,EAAUuyB,EAAyBp2B,KAE3C,CAGA,GAAI6D,IACAqlB,EAAS7pB,EAAMi3B,SAASvoB,SAASwoB,UAAU1yB,EAAQ3E,KAC9CgqB,GAAQ,CACT,MAAMsN,QAAmBr3B,GAASs3B,EAAAA,EAAAA,IAAiB5yB,EAAQ3E,IAAI6Y,EAAAA,EAAAA,IAAiB1Y,KAC5E,SAAUm3B,IACVtN,EAASsN,EAAWx2B,KAE5B,CAGJ,IAAK6D,IAAYqlB,EAAQ,KAAAwN,EAAAC,EACrB,IAAW,QAAPD,EAAA7yB,SAAO,IAAA6yB,OAAA,EAAPA,EAAS72B,QAAS8H,EAAAA,GAAUuM,gBAAiB,CAG7C,MAAM0iB,QAAyBz3B,GAAS03B,EAAAA,EAAAA,IAAyBtB,EAAS1xB,EAAQmF,eAClF,GAAI,SAAU4tB,IAAqBA,EAAiB52B,KAAM82B,KACtD,MAAO,CAAC92B,UAAMkD,EAEtB,CAEA,MAAM6zB,QAAkC53B,GAAS2T,EAAAA,EAAAA,KAAYiF,EAAAA,EAAAA,IAAiB1Y,GAAQk2B,EAASr2B,IAAW,QAAPy3B,EAAA9yB,SAAO,IAAA8yB,OAAA,EAAPA,EAASz3B,KAAM,GAAIyM,IACtH,GAAI,UAAWorB,GACX,IAAKlzB,EAAS,CACV,MAAMuyB,QAAiCj3B,GAASk3B,EAAAA,EAAAA,IAA4B1e,EAAMhM,GAAa,IAC/F,GAAI,UAAWyqB,GAAyE,IAA7CA,EAAyBp2B,KAAMoU,UAGtE,aAFMjV,GAAS63B,EAAAA,EAAAA,IAAwBzB,EAASr2B,KAChD+3B,GAAuB/B,EAAOC,GAASxE,EAAAA,EAAAA,IAA8BtxB,EAAOk2B,EAASr2B,KAC9E,CAACc,UAAMkD,GAElBW,EAAUuyB,EAAyBp2B,IACvC,OAEA6D,EAAUkzB,EAA0B/2B,KAAM6D,OAElD,CASA,OAPIA,EAAQhE,OAAS8H,EAAAA,GAAU3D,WAC3B7E,EAAS+3B,GAA2BhC,EAAOC,IACpCtxB,EAAQhE,OAAS8H,EAAAA,GAAU1D,WAClCkxB,EAAQgC,QAAQ,IAADpuB,OAAK4O,EAAI,cAAA5O,OAAalF,EAAQ2G,OAE7C4sB,GAAgBvzB,GAEb,CAAC7D,UAAMkD,EAAU,CAEhC,CA5KqBm0B,CAAyBnC,EAAOC,IACzC,MACJ,IAAK,aACDh2B,EA0EL,SAAgC+1B,EAAcC,GACjD,OAAO31B,MAAOL,EAAUC,KACpB,MAAMC,EAAQD,KACR,KAACuY,EAAI,WAAE0d,GAAcH,EAAMI,OAC3Br2B,EAAYo2B,EAAWnsB,cAE7B,IAAIrF,GAAU2V,EAAAA,EAAAA,GAAWna,EAAOJ,GAChC,MAAMiqB,EAAS7pB,EAAMi3B,SAASvoB,SAASwoB,UAAUt3B,GAC3Cs2B,GAAUC,EAAAA,EAAAA,IAAcn2B,EAAOsY,GACrC,IAAK9T,IAAYqlB,EAAQ,CACrB,MAAMoO,QAAuBn4B,GAAS2T,EAAAA,EAAAA,KAAYiF,EAAAA,EAAAA,IAAiB1Y,GAAQk2B,EAASr2B,GAAID,EAAW,KACnG,GAAI,UAAWq4B,EAGX,aAFMn4B,GAAS63B,EAAAA,EAAAA,IAAwBzB,EAASr2B,KAChD+3B,GAAuB/B,EAAOC,GAASxE,EAAAA,EAAAA,IAA8BtxB,EAAOk2B,EAASr2B,KAC9E,CAACc,UAAMkD,GAElBW,EAAUyzB,EAAet3B,KAAM6D,OACnC,CASA,OAPIA,EAAQhE,OAAS8H,EAAAA,GAAU3D,WAC3B7E,EAASo4B,GAA0BrC,EAAOC,EAASqC,EAAAA,GAA6B3zB,EAAQ2G,MAAMuN,EAAAA,EAAAA,IAAiB1Y,MACxGwE,EAAQhE,OAAS8H,EAAAA,GAAU1D,WAClCkxB,EAAQgC,QAAQ,IAADpuB,OAAK4O,EAAI,cAAA5O,OAAalF,EAAQ2G,OAE7C2qB,EAAQgC,QAAQ,IAADpuB,OAAK4O,EAAI,cAAA5O,OAAalF,EAAQ2G,OAE1C,CAACxK,UAAMkD,EAAU,CAEhC,CAtGqBu0B,CAAuBvC,EAAOC,IACvC,MACJ,IAAK,yBACDh2B,EA0QZ,SAAmC+1B,EAAcC,GAC7C,OAAO31B,MAAOL,EAAUC,KACpB,MAAMC,EAAQD,KACR,WAACi2B,EAAU,KAAE1d,GAAQud,EAAMI,OAC3BoC,EAAUrC,EAAWnsB,cAE3BisB,EAAQgC,QAAQjC,EAAMyC,IAAIR,QAAQ,aAAc,eAEhD,IAAItzB,GAAU8xB,EAAAA,EAAAA,IAAiBt2B,EAAOq4B,GACtC,MAAMnC,GAAUC,EAAAA,EAAAA,IAAcn2B,EAAOsY,GACrC,IAAK9T,EAAS,CACV,MAAMyzB,QAAuBn4B,GAAS2T,EAAAA,EAAAA,KAAYiF,EAAAA,EAAAA,IAAiB1Y,GAAQk2B,EAASr2B,GAAI,GAAIw4B,IAC5F,GAAI,UAAWJ,EAGX,aAFMn4B,GAAS63B,EAAAA,EAAAA,IAAwBzB,EAASr2B,KAChD04B,GAAY1C,EAAOC,GAASxE,EAAAA,EAAAA,IAA8BtxB,EAAOk2B,EAASr2B,KACnE,CAACc,UAAMkD,GAElBW,EAAUyzB,EAAet3B,KAAM6D,OACnC,CAKA,OAHA1E,GAAS04B,EAAAA,EAAAA,IAAqBh0B,EAAS3E,KAEvCk4B,GAAgBvzB,GACT,CAAC7D,UAAMkD,EAAU,CAEhC,CAnSqB40B,CAA0B5C,EAAOC,IAC1C,MACJ,IAAK,0BACDh2B,EAqKZ,SAAqC+1B,EAAcC,GAC/C,OAAO31B,MAAOL,EAAUC,KACpB,MAAMC,EAAQD,KACR,KAACuY,EAAI,WAAE0d,GAAcH,EAAMI,OAC3B/E,EAAW8E,EAAWzuB,MAAM,EAAGyuB,EAAWpyB,QAAQiG,cAClDqsB,GAAUC,EAAAA,EAAAA,IAAcn2B,EAAOsY,GAErC,IAAIogB,GAAOC,EAAAA,EAAAA,IAAqB34B,EAAOkxB,GACvC,IAAKwH,EAAM,CACP,MAAMT,QAAuBn4B,GAAS84B,EAAAA,EAAAA,IAAkB1H,IACxD,GAAI,UAAW+G,EAGX,aAFMn4B,GAAS63B,EAAAA,EAAAA,IAAwBzB,EAASr2B,KAChD04B,GAAY1C,EAAOC,GAASxE,EAAAA,EAAAA,IAA8BtxB,EAAOk2B,EAASr2B,KACnE,CAACc,UAAMkD,GAElB60B,EAAOT,EAAet3B,IAC1B,CAEA,MAAMk4B,QAAiC/4B,GAASg5B,EAAAA,EAAAA,IAA0BJ,EAAK74B,KAC/E,MAAI,UAAWg5B,SACL/4B,GAAS63B,EAAAA,EAAAA,IAAwBzB,EAASr2B,KAChD04B,GAAY1C,EAAOC,GAASxE,EAAAA,EAAAA,IAA8BtxB,EAAOk2B,EAASr2B,KACnE,CAACc,UAAMkD,KAGlBk0B,GAAgBc,EAAyBl4B,MAClC,CAACA,UAAMkD,GAAU,CAEhC,CAjMqBk1B,CAA4BlD,EAAOC,IAC5C,MACJ,IAAK,uBACDh2B,EA6OL,SAAkC+1B,EAAcC,GACnD,OAAO31B,MAAOL,EAAUC,KACpB,MAAMC,EAAQD,KACR,KAACuY,EAAI,WAAE0d,GAAcH,EAAMI,OAC3B+C,EAAQhD,EAAWnsB,cACnBqsB,GAAUC,EAAAA,EAAAA,IAAcn2B,EAAOsY,GAErC,IAAIogB,GAAOO,EAAAA,EAAAA,IAAkBj5B,EAAOg5B,GACpC,IAAKN,EAAM,CACP,MAAMT,QAAuBn4B,GAASo5B,EAAAA,EAAAA,IAAeF,IACrD,GAAI,UAAWf,EAGX,aAFMn4B,GAAS63B,EAAAA,EAAAA,IAAwBzB,EAASr2B,KAChD04B,GAAY1C,EAAOC,GAASxE,EAAAA,EAAAA,IAA8BtxB,EAAOk2B,EAASr2B,KACnE,CAACc,UAAMkD,GAElB60B,EAAOT,EAAet3B,IAC1B,CAGA,OADAm1B,EAAQgC,QAAQ,IAADpuB,OAAK4O,EAAI,eAAA5O,OAAcgvB,EAAKxH,WACpC,CAACvwB,UAAMkD,EAAU,CAEhC,CAlQqBs1B,CAAyBtD,EAAOC,IACzC,MACJ,IAAK,0BACDh2B,EAAS+3B,GAA2BhC,EAAOC,IAC3C,MACJ,IAAK,yBACDh2B,EAASo4B,GAA0BrC,EAAOC,EAASE,IACnD,MACJ,IAAK,cACKl2B,GAAS63B,EAAAA,EAAAA,IAAwBzB,EAASr2B,KAChD04B,GAAY1C,EAAOC,GAASxE,EAAAA,EAAAA,IAA8BtxB,EAAOk2B,EAASr2B,KAG9E,MAAO,CAACc,UAAMkD,EAAU,CAEhC,CAiLO,SAASq0B,GAA0BrC,EAAcC,EAAkBsD,GACtE,OAAOj5B,MAAOL,EAAUC,KACpB,MAAMC,EAAQD,KACR,KAACuY,GAAQud,EAAMI,OACfC,GAAUC,EAAAA,EAAAA,IAAcn2B,EAAOsY,GAErC,IAAIogB,GAAOW,EAAAA,EAAAA,IAAWr5B,EAAOo5B,GAC7B,IAAKV,EAAM,CACP,MAAMT,QAAuBn4B,GAASuxB,EAAAA,EAAAA,IAAQ+H,IAC9C,GAAI,UAAWnB,EAGX,aAFMn4B,GAAS63B,EAAAA,EAAAA,IAAwBzB,EAASr2B,KAChD04B,GAAY1C,EAAOC,GAASxE,EAAAA,EAAAA,IAA8BtxB,EAAOk2B,EAASr2B,KACnE,CAACc,UAAMkD,GAElB60B,EAAOT,EAAet3B,IAC1B,CAGA,OADAm1B,EAAQgC,QAAQ,IAADpuB,OAAK4O,EAAI,eAAA5O,OAAcgvB,EAAKxH,WACpC,CAACvwB,UAAMkD,EAAU,CAEhC,CAEO,SAASg0B,GAA2BhC,EAAcC,GACrD,OAAO31B,MAAOL,EAAUC,KACpB,MAAMC,EAAQD,KACR,KAACuY,EAAI,WAAE0d,GAAcH,EAAMI,OAC3BmD,EAASjB,EAAAA,GAA6BnC,EAAWnsB,eAAe6O,EAAAA,EAAAA,IAAiB3Y,MACjFm2B,GAAUC,EAAAA,EAAAA,IAAcn2B,EAAOsY,GAErC,IAAIogB,GAAOW,EAAAA,EAAAA,IAAWr5B,EAAOo5B,GAC7B,IAAKV,EAAM,CACP,MAAMT,QAAuBn4B,GAASuxB,EAAAA,EAAAA,IAAQ+H,IAC9C,GAAI,UAAWnB,EAGX,aAFMn4B,GAAS63B,EAAAA,EAAAA,IAAwBzB,EAASr2B,KAChD04B,GAAY1C,EAAOC,GAASxE,EAAAA,EAAAA,IAA8BtxB,EAAOk2B,EAASr2B,KACnE,CAACc,UAAMkD,GAElB60B,EAAOT,EAAet3B,IAC1B,CAGA,OADAm1B,EAAQgC,QAAQ,IAADpuB,OAAK4O,EAAI,eAAA5O,OAAcgvB,EAAKxH,WACpC,CAACvwB,UAAMkD,EAAU,CAEhC,CAoDA,SAASk0B,GAAgBvzB,GACrB80B,EAAAA,GAAoC90B,EACxC,CAEA,SAAS+zB,GAAY1C,EAAcC,EAAkByD,GACjD,MAAM,KAACjhB,GAAQud,EAAMI,OACrBH,EAAQllB,KAAK0H,EAAO,IAAH5O,OAAO4O,EAAI,cAAA5O,OAAa6vB,GAAmB,IAChE,CAMAp5B,eAAey3B,GAAuB/B,EAAcC,EAAkByD,GAClE,MAAM,KAACjhB,GAAQud,EAAMI,OACrBH,EAAQllB,KAAK0H,EAAO,2CAAH5O,OAA8C4O,EAAI,cAAA5O,OAAa6vB,GAAmB,IACvG,C,yTClWA,MAAMC,GAA0B5xB,IAAe,IAAA6xB,EAAAC,EAAA,OAC3ChyB,EAAAA,cAAA,MAAA6T,OAAAuI,OAAA,CACI6V,MAAkB,QAAbF,EAAE7xB,EAAM+xB,aAAK,IAAAF,EAAAA,EAAI,MACtB9M,OAAoB,QAAd+M,EAAE9xB,EAAM+kB,cAAM,IAAA+M,EAAAA,EAAI,MACxBE,QAAQ,cACRC,KAAK,OACLC,MAAM,6BACNC,WAAW,gCACPnyB,GAEJF,EAAAA,cAAA,KAAGsyB,SAAS,0BACRtyB,EAAAA,cAAA,QACIuyB,EAAE,6CACFC,OAAO,8BACPC,cAAc,OACdC,cAAc,UAElB1yB,EAAAA,cAAA,QACIuyB,EAAE,uBACFC,OAAO,8BACPC,cAAc,OACdC,cAAc,UAElB1yB,EAAAA,cAAA,QACIuyB,EAAE,gCACFC,OAAO,8BACPC,cAAc,OACdC,cAAc,UAElB1yB,EAAAA,cAAA,UACI2yB,GAAG,MACHC,GAAG,MACHC,EAAE,MACFC,UAAU,4CACVX,KAAK,8BACLY,YAAY,SAEhB/yB,EAAAA,cAAA,UACI2yB,GAAG,MACHC,GAAG,MACHC,EAAE,MACFC,UAAU,4CACVX,KAAK,8BACLY,YAAY,SAEhB/yB,EAAAA,cAAA,UACI2yB,GAAG,MACHC,GAAG,MACHC,EAAE,MACFC,UAAU,6CACVX,KAAK,8BACLY,YAAY,SAEhB/yB,EAAAA,cAAA,UACI2yB,GAAG,KACHC,GAAG,KACHC,EAAE,KACFV,KAAK,8BACLY,YAAY,SAEhB/yB,EAAAA,cAAA,QACIuyB,EAAE,2NACFJ,KAAK,YAETnyB,EAAAA,cAAA,UACIqlB,QAAQ,OACRsN,GAAG,SACHC,GAAG,SACHC,EAAE,UACFV,KAAK,wBAETnyB,EAAAA,cAAA,QACIqlB,QAAQ,MACRkN,EAAE,aACFC,OAAO,0BACPE,cAAc,UAElB1yB,EAAAA,cAAA,QACIqlB,QAAQ,MACRkN,EAAE,gBACFC,OAAO,gCACPE,cAAc,UAElB1yB,EAAAA,cAAA,QACIqlB,QAAQ,MACRkN,EAAE,iBACFC,OAAO,gCACPE,cAAc,UAElB1yB,EAAAA,cAAA,QACIqlB,QAAQ,MACRkN,EAAE,aACFC,OAAO,gCACPE,cAAc,UAElB1yB,EAAAA,cAAA,QACIqlB,QAAQ,MACRkN,EAAE,iBACFC,OAAO,gCACPE,cAAc,UAElB1yB,EAAAA,cAAA,QACIqlB,QAAQ,MACRkN,EAAE,sBACFC,OAAO,gCACPE,cAAc,UAElB1yB,EAAAA,cAAA,QACIuyB,EAAE,4LACFJ,KAAK,6BAETnyB,EAAAA,cAAA,QACIuyB,EAAE,kNACFC,OAAO,8BACPC,cAAc,QAElBzyB,EAAAA,cAAA,UACI2yB,GAAG,KACHC,GAAG,KACHC,EAAE,IACFV,KAAK,8BACLY,YAAY,QAEhB/yB,EAAAA,cAAA,QACIuyB,EAAE,YACFC,OAAO,8BACPC,cAAc,MACdC,cAAc,UAElB1yB,EAAAA,cAAA,QACIuyB,EAAE,YACFC,OAAO,8BACPC,cAAc,MACdC,cAAc,UAElB1yB,EAAAA,cAAA,QACIuyB,EAAE,YACFC,OAAO,8BACPC,cAAc,MACdC,cAAc,UAElB1yB,EAAAA,cAAA,QACIuyB,EAAE,YACFC,OAAO,8BACPC,cAAc,MACdC,cAAc,UAElB1yB,EAAAA,cAAA,QACIuyB,EAAE,YACFC,OAAO,8BACPC,cAAc,MACdC,cAAc,UAElB1yB,EAAAA,cAAA,QACIuyB,EAAE,YACFC,OAAO,8BACPC,cAAc,MACdC,cAAc,UAElB1yB,EAAAA,cAAA,UACI2yB,GAAG,KACHC,GAAG,KACHC,EAAE,KACFV,KAAK,YAETnyB,EAAAA,cAAA,QACIuyB,EAAE,eACFC,OAAO,8BACPC,cAAc,MACdC,cAAc,QACdM,eAAe,UAEnBhzB,EAAAA,cAAA,QACIuyB,EAAE,eACFC,OAAO,8BACPC,cAAc,MACdC,cAAc,QACdM,eAAe,UAEnBhzB,EAAAA,cAAA,QACIuyB,EAAE,eACFC,OAAO,8BACPC,cAAc,MACdC,cAAc,QACdM,eAAe,UAEnBhzB,EAAAA,cAAA,UACI2yB,GAAG,KACHC,GAAG,KACHC,EAAE,IACFV,KAAK,8BACLY,YAAY,SAEhB/yB,EAAAA,cAAA,UACI2yB,GAAG,KACHC,GAAG,KACHC,EAAE,IACFV,KAAK,8BACLY,YAAY,SAEhB/yB,EAAAA,cAAA,UACI2yB,GAAG,KACHC,GAAG,KACHC,EAAE,IACFV,KAAK,8BACLY,YAAY,SAEhB/yB,EAAAA,cAAA,QACIizB,EAAE,OACFC,EAAE,OACFjB,MAAM,KACNhN,OAAO,KACPkO,GAAG,MACHX,OAAO,wBAEXxyB,EAAAA,cAAA,QACIuyB,EAAE,sEACFC,OAAO,yBAGfxyB,EAAAA,cAAA,YACIA,EAAAA,cAAA,YAAU7H,GAAG,oBACT6H,EAAAA,cAAA,QACIiyB,MAAM,MACNhN,OAAO,MACPkN,KAAK,YAIf,EACRL,GAAAjW,UAAA,CA1OEoW,MAAK9nB,IAAAA,OACL8a,OAAM9a,IAAAA,QA2OV,YCxOMipB,GAAyBlzB,IAAe,IAAA6xB,EAAAC,EAAA,OAC1ChyB,IAAAA,cAAA,OACIiyB,MAAkB,QAAbF,EAAE7xB,EAAM+xB,aAAK,IAAAF,EAAAA,EAAI,MACtB9M,OAAoB,QAAd+M,EAAE9xB,EAAM+kB,cAAM,IAAA+M,EAAAA,EAAI,MACxBE,QAAQ,cACRC,KAAK,OACLC,MAAM,6BACNC,WAAW,gCAEXryB,IAAAA,cAAA,KAAGsyB,SAAS,0BACRtyB,IAAAA,cAAA,QACIuyB,EAAE,6CACFC,OAAO,8CACPE,cAAc,UAElB1yB,IAAAA,cAAA,QACIuyB,EAAE,uBACFC,OAAO,8CACPE,cAAc,UAElB1yB,IAAAA,cAAA,QACIuyB,EAAE,gCACFC,OAAO,8CACPE,cAAc,UAElB1yB,IAAAA,cAAA,UACI2yB,GAAG,MACHC,GAAG,MACHC,EAAE,MACFC,UAAU,4CACVX,KAAK,gDAETnyB,IAAAA,cAAA,UACI2yB,GAAG,MACHC,GAAG,MACHC,EAAE,MACFC,UAAU,4CACVX,KAAK,gDAETnyB,IAAAA,cAAA,UACI2yB,GAAG,MACHC,GAAG,MACHC,EAAE,MACFC,UAAU,6CACVX,KAAK,gDAETnyB,IAAAA,cAAA,UACI2yB,GAAG,KACHC,GAAG,KACHC,EAAE,KACFV,KAAK,gDAETnyB,IAAAA,cAAA,QACIuyB,EAAE,2NACFJ,KAAK,YAETnyB,IAAAA,cAAA,UACIqlB,QAAQ,OACRsN,GAAG,SACHC,GAAG,SACHC,EAAE,UACFV,KAAK,wBAETnyB,IAAAA,cAAA,QACIqlB,QAAQ,MACRkN,EAAE,aACFC,OAAO,0BACPE,cAAc,UAElB1yB,IAAAA,cAAA,QACIqlB,QAAQ,MACRkN,EAAE,gBACFC,OAAO,gCACPE,cAAc,UAElB1yB,IAAAA,cAAA,QACIqlB,QAAQ,MACRkN,EAAE,iBACFC,OAAO,gCACPE,cAAc,UAElB1yB,IAAAA,cAAA,QACIqlB,QAAQ,MACRkN,EAAE,aACFC,OAAO,gCACPE,cAAc,UAElB1yB,IAAAA,cAAA,QACIqlB,QAAQ,MACRkN,EAAE,iBACFC,OAAO,gCACPE,cAAc,UAElB1yB,IAAAA,cAAA,QACIqlB,QAAQ,MACRkN,EAAE,sBACFC,OAAO,gCACPE,cAAc,UAElB1yB,IAAAA,cAAA,QACIuyB,EAAE,4LACFJ,KAAK,uCAETnyB,IAAAA,cAAA,QACIuyB,EAAE,kNACFC,OAAO,+CAEXxyB,IAAAA,cAAA,UACI2yB,GAAG,KACHC,GAAG,KACHC,EAAE,IACFV,KAAK,+CAETnyB,IAAAA,cAAA,QACIuyB,EAAE,YACFC,OAAO,6CACPE,cAAc,UAElB1yB,IAAAA,cAAA,QACIuyB,EAAE,YACFC,OAAO,6CACPE,cAAc,UAElB1yB,IAAAA,cAAA,QACIuyB,EAAE,YACFC,OAAO,6CACPE,cAAc,UAElB1yB,IAAAA,cAAA,QACIuyB,EAAE,YACFC,OAAO,6CACPE,cAAc,UAElB1yB,IAAAA,cAAA,QACIuyB,EAAE,YACFC,OAAO,6CACPE,cAAc,UAElB1yB,IAAAA,cAAA,QACIuyB,EAAE,YACFC,OAAO,6CACPE,cAAc,UAElB1yB,IAAAA,cAAA,UACI2yB,GAAG,KACHC,GAAG,KACHC,EAAE,KACFV,KAAK,YAETnyB,IAAAA,cAAA,QACIuyB,EAAE,eACFC,OAAO,6CACPE,cAAc,QACdM,eAAe,UAEnBhzB,IAAAA,cAAA,QACIuyB,EAAE,eACFC,OAAO,6CACPE,cAAc,QACdM,eAAe,UAEnBhzB,IAAAA,cAAA,QACIuyB,EAAE,eACFC,OAAO,6CACPE,cAAc,QACdM,eAAe,UAEnBhzB,IAAAA,cAAA,UACI2yB,GAAG,KACHC,GAAG,KACHC,EAAE,IACFV,KAAK,gDAETnyB,IAAAA,cAAA,UACI2yB,GAAG,KACHC,GAAG,KACHC,EAAE,IACFV,KAAK,gDAETnyB,IAAAA,cAAA,UACI2yB,GAAG,KACHC,GAAG,KACHC,EAAE,IACFV,KAAK,gDAETnyB,IAAAA,cAAA,UACI2yB,GAAG,KACHC,GAAG,KACHC,EAAE,MACFL,OAAO,kCAEXxyB,IAAAA,cAAA,QACIuyB,EAAE,yFACFC,OAAO,kCAEXxyB,IAAAA,cAAA,QACIuyB,EAAE,qFACFC,OAAO,kCAEXxyB,IAAAA,cAAA,QACIuyB,EAAE,2gBACFC,OAAO,mCAGfxyB,IAAAA,cAAA,YACIA,IAAAA,cAAA,YAAU7H,GAAG,oBACT6H,IAAAA,cAAA,QACIiyB,MAAM,MACNhN,OAAO,MACPkN,KAAK,yCAIf,EAERiB,GAAAvX,UAAA,CA3NEoW,MAAK9nB,IAAAA,OACL8a,OAAM9a,IAAAA,QA4NV,YCzNMkpB,GAAgBnzB,IAAe,IAAA6xB,EAAAC,EAAA,OACjChyB,EAAAA,cAAA,MAAA6T,OAAAuI,OAAA,CACI6V,MAAkB,QAAbF,EAAE7xB,EAAM+xB,aAAK,IAAAF,EAAAA,EAAI,MACtB9M,OAAoB,QAAd+M,EAAE9xB,EAAM+kB,cAAM,IAAA+M,EAAAA,EAAI,KACxBE,QAAQ,aACRC,KAAK,OACLC,MAAM,6BACNC,WAAW,gCACPnyB,GAEJF,EAAAA,cAAA,KAAGsyB,SAAS,0BACRtyB,EAAAA,cAAA,QACIuyB,EAAE,kDACFC,OAAO,8BACPC,cAAc,OACdC,cAAc,UAElB1yB,EAAAA,cAAA,QACIuyB,EAAE,+BACFC,OAAO,8BACPC,cAAc,OACdC,cAAc,UAElB1yB,EAAAA,cAAA,QACIuyB,EAAE,gCACFC,OAAO,8BACPC,cAAc,OACdC,cAAc,UAElB1yB,EAAAA,cAAA,UACI2yB,GAAG,MACHC,GAAG,MACHC,EAAE,MACFC,UAAU,2CACVX,KAAK,8BACLY,YAAY,SAEhB/yB,EAAAA,cAAA,UACI2yB,GAAG,MACHC,GAAG,MACHC,EAAE,MACFC,UAAU,4CACVX,KAAK,8BACLY,YAAY,SAEhB/yB,EAAAA,cAAA,UACI2yB,GAAG,MACHC,GAAG,MACHC,EAAE,MACFC,UAAU,6CACVX,KAAK,8BACLY,YAAY,QAEhB/yB,EAAAA,cAAA,UACI2yB,GAAG,KACHC,GAAG,KACHC,EAAE,KACFV,KAAK,8BACLY,YAAY,SAEhB/yB,EAAAA,cAAA,QACIuyB,EAAE,sOACFJ,KAAK,YAETnyB,EAAAA,cAAA,UACIqlB,QAAQ,OACRsN,GAAG,UACHC,GAAG,SACHC,EAAE,UACFV,KAAK,YAETnyB,EAAAA,cAAA,QACIqlB,QAAQ,MACRkN,EAAE,kBACFC,OAAO,UACPE,cAAc,UAElB1yB,EAAAA,cAAA,QACIqlB,QAAQ,MACRkN,EAAE,qBACFC,OAAO,UACPE,cAAc,UAElB1yB,EAAAA,cAAA,QACIqlB,QAAQ,MACRkN,EAAE,sBACFC,OAAO,UACPE,cAAc,UAElB1yB,EAAAA,cAAA,QACIqlB,QAAQ,MACRkN,EAAE,kBACFC,OAAO,UACPE,cAAc,UAElB1yB,EAAAA,cAAA,QACIqlB,QAAQ,MACRkN,EAAE,qBACFC,OAAO,UACPE,cAAc,UAElB1yB,EAAAA,cAAA,QACIqlB,QAAQ,MACRkN,EAAE,sBACFC,OAAO,UACPE,cAAc,UAElB1yB,EAAAA,cAAA,QACIuyB,EAAE,wLACFJ,KAAK,6BAETnyB,EAAAA,cAAA,QACIuyB,EAAE,6MACFC,OAAO,8BACPC,cAAc,QAElBzyB,EAAAA,cAAA,UACI2yB,GAAG,KACHC,GAAG,KACHC,EAAE,IACFV,KAAK,8BACLY,YAAY,QAEhB/yB,EAAAA,cAAA,QACIuyB,EAAE,YACFC,OAAO,8BACPC,cAAc,MACdC,cAAc,UAElB1yB,EAAAA,cAAA,QACIuyB,EAAE,YACFC,OAAO,8BACPC,cAAc,MACdC,cAAc,UAElB1yB,EAAAA,cAAA,QACIuyB,EAAE,YACFC,OAAO,8BACPC,cAAc,MACdC,cAAc,UAElB1yB,EAAAA,cAAA,QACIuyB,EAAE,YACFC,OAAO,8BACPC,cAAc,MACdC,cAAc,UAElB1yB,EAAAA,cAAA,QACIuyB,EAAE,YACFC,OAAO,8BACPC,cAAc,MACdC,cAAc,UAElB1yB,EAAAA,cAAA,QACIuyB,EAAE,YACFC,OAAO,8BACPC,cAAc,MACdC,cAAc,UAElB1yB,EAAAA,cAAA,UACI2yB,GAAG,KACHC,GAAG,KACHC,EAAE,IACFV,KAAK,8BACLY,YAAY,SAEhB/yB,EAAAA,cAAA,UACI2yB,GAAG,KACHC,GAAG,KACHC,EAAE,IACFV,KAAK,8BACLY,YAAY,SAEhB/yB,EAAAA,cAAA,UACI2yB,GAAG,KACHC,GAAG,KACHC,EAAE,IACFV,KAAK,8BACLY,YAAY,SAEhB/yB,EAAAA,cAAA,QACIuyB,EAAE,gBACFC,OAAO,8BACPC,cAAc,MACdC,cAAc,QACdM,eAAe,UAEnBhzB,EAAAA,cAAA,QACIuyB,EAAE,eACFC,OAAO,8BACPC,cAAc,MACdC,cAAc,QACdM,eAAe,UAEnBhzB,EAAAA,cAAA,QACIuyB,EAAE,eACFC,OAAO,8BACPC,cAAc,MACdC,cAAc,QACdM,eAAe,WAGvBhzB,EAAAA,cAAA,YACIA,EAAAA,cAAA,YAAU7H,GAAG,oBACT6H,EAAAA,cAAA,QACIiyB,MAAM,MACNhN,OAAO,KACPkN,KAAK,YAIf,EACRkB,GAAAxX,UAAA,CAxNEoW,MAAK9nB,IAAAA,OACL8a,OAAM9a,IAAAA,QAyNV,Y,qICjMA,MAAMmpB,GAAoDhf,IAA6E,IAA5E,WAACif,EAAU,WAAEC,EAAU,QAAE12B,EAAO,cAAE22B,GAAqCnf,EAC9H,MAAMyC,GAAgBxE,EAAAA,EAAAA,aAAYtB,EAAAA,IAElC,IAAKsiB,EACD,OAAQvzB,IAAAA,cAAC0zB,GAAAA,EAAc,MAG3B,MAAMC,EAAcJ,EAAaC,EAEjC,OACIxzB,IAAAA,cAACqP,GAAAA,EAAkB,CACftU,OAAQgc,EACRzH,YAAa,CAACC,GAAAA,GAAYqkB,iBAAkBrkB,GAAAA,GAAYskB,eAEvDF,EACG3zB,IAAAA,cAAC8zB,GAAoB,CACjBL,cAAeA,IAGnBzzB,IAAAA,cAAC+zB,GAAoB,CACjBj3B,QAASA,EACT22B,cAAeA,IAGN,EAE3BH,GAAAzX,UAAA,CAhCE0X,WAAUppB,IAAAA,OACVqpB,WAAUrpB,IAAAA,OAAAC,WAEVqpB,cAAatpB,IAAAA,MA+BjB,MAAM2pB,GAAuBE,IAAuD,IAAtD,cAACP,GAAgDO,EAC3E,MAAM,cAACjxB,IAAiBgS,EAAAA,GAAAA,WAExB,OACI/U,IAAAA,cAAAA,IAAAA,SAAA,KACKyzB,EACDzzB,IAAAA,cAAA,OAAKuD,UAAU,wBACXvD,IAAAA,cAACi0B,GAAAA,EAAiB,CACd97B,GAAG,kBACHoL,UAAU,yBACVqH,QAAShJ,EAAAA,GAAiBsyB,WAC1BppB,WAAYqpB,GAAAA,QACZ1e,YAAa,CAAC2e,mBAAoB,iCAElCp0B,IAAAA,cAAA,KACIuD,UAAU,0BACVsM,MAAO9M,EAAc,CAAC5K,GAAI,oBAAqB6K,eAAgB,aAC/D,cAAY,SAEhBhD,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,gDACH6K,eAAe,qCAI5B,EAIL+wB,GAAuBM,IAAkF,IAAjF,QAACv3B,EAAO,cAAE22B,GAAkEY,EACtG,MAAM,cAACtxB,IAAiBgS,EAAAA,GAAAA,WAElBnK,EAAU9N,EAAQ+wB,kBAAoBjsB,EAAAA,GAAiB0yB,sBAAwB1yB,EAAAA,GAAiB4f,eAChG+S,EAAQz3B,EAAQ+wB,kBAAoB2G,GAAAA,EAA0B/S,GAAAA,EAEpE,GADgD,IAAtB3kB,EAAQuQ,UAE9B,OAAO,KAEX,MAAMonB,EAAY33B,EAAQhE,OAAS8H,EAAAA,GAAUuM,gBAE7C,OACInN,IAAAA,cAAA,OAAKuD,UAAU,+BACXvD,IAAAA,cAAA,OAAKuD,UAAU,wBACXvD,IAAAA,cAAC00B,GAAAA,EAAqB,CAClBx8B,UAAW4E,EAAQ3E,GACnB4C,OAAQ+B,EAAQkQ,QAChBsC,YAAa,CAACmlB,EAAYllB,GAAAA,GAAY8S,+BAAiC9S,GAAAA,GAAY6S,gCAEnFpiB,IAAAA,cAACi0B,GAAAA,EAAiB,CACd1wB,UAAU,gBACVqH,QAASA,EACTE,WAAYypB,EACZ9e,YAAa,CAAC3Y,YAEdkD,IAAAA,cAAA,KACIuD,UAAU,4BACVsM,MAAO9M,EAAc,CAAC5K,GAAI,oBAAqB6K,eAAgB,aAC/D,cAAY,SAEflG,EAAQ+wB,mBACL7tB,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,8CACH6K,eAAe,gBAErBlG,EAAQ+wB,mBACN7tB,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,+CACH6K,eAAe,kBAKlCywB,EACC,EAId,GAAezzB,IAAAA,KAAWszB,I,4BCvH1B,MAAMqB,GAAwB30B,IAAAA,MAAWsU,IAI5B,IAJ6B,QACtCxX,EAAO,cACP22B,EAAa,cACbmB,GACItgB,EACJ,MAAMugB,EAA0C,IAAtB/3B,EAAQuQ,UAGlC,KAF2BynB,EAAAA,GAAAA,GAAmCh4B,EAAQ3E,IAGlE,OAAO,KAGX,GAAI08B,GAA8C,IAAzBpB,EAAcv3B,SAAiB04B,EACpD,OAAO,KAGX,MAAMG,EAAUtB,EAAcj2B,KAAKw3B,GAE3Bh1B,IAAAA,cAAA,UACIyE,IAAKuwB,EAAY78B,GACjBoL,UAAW,gBACXM,QAASA,KAAA,IAAAoxB,EAAA,OAAwB,QAAxBA,EAAMD,EAAY1iB,cAAM,IAAA2iB,OAAA,EAAlBA,EAAAC,KAAAF,EAAqBl4B,EAAS83B,EAAc,GAE1DI,EAAY7lB,KACZ6lB,EAAY7wB,QAKzB,OAAOnE,IAAAA,cAAAA,IAAAA,SAAA,KAAG+0B,EAAW,IACtBJ,GAAA9Y,UAAA,CAjCC4X,cAAatpB,IAAAA,MAAAC,YAkCjBuqB,GAAsB35B,YAAc,wBAEpC,YCxBA,IAAe2V,EAAAA,EAAAA,UAPf,SAAyBrY,EAAoBymB,GACzC,MAAO,CACH6V,eAAeO,EAAAA,EAAAA,IAAuB78B,EAAOymB,EAASjiB,QAAQ3E,IAC9Ds7B,eAAe2B,EAAAA,GAAAA,IAA6B98B,GAEpD,GAEA,CAAwCq8B,I,0ZCgCzB,MAAMU,WAA4Br1B,IAAAA,cAA2BK,WAAAA,GAAA,SAAApE,WAAAsE,GAAA,uBACvD,KACRe,KAAKpB,MAAMpD,UAIZwE,KAAKpB,MAAMqf,WACXje,KAAKpB,MAAMwK,QAAQsV,kBAAkB1e,KAAKpB,MAAMpD,QAAQ3E,IAExDmJ,KAAKpB,MAAMwK,QAAQ4U,gBAAgBhe,KAAKpB,MAAMpD,QAAQ3E,IAC1D,GACH,CAEDmO,iBAAAA,GAAoB,IAAAgvB,EACK,QAAjBA,EAACh0B,KAAKpB,MAAMq1B,aAAK,IAAAD,GAAhBA,EAAkBE,mBACnBl0B,KAAKpB,MAAMwK,QAAQ+qB,oBAE3B,CAEA1uB,MAAAA,GACI,MAAM,cACF8E,EAAa,QACb/O,EAAO,UACP44B,EAAS,OACTC,EAAM,gBACNC,EAAe,mBACfC,EAAkB,WAClBC,EAAU,WACVvW,EAAU,uBACVwW,EAAsB,YACtBC,EAAW,SACXlN,EAAQ,aACRmN,EAAY,YACZ7d,EAAW,MACXmd,EAAK,WACL/B,EAAU,cACVoB,EAAa,aACbsB,GACA50B,KAAKpB,MAET,IAAIi2B,EAAgB,GAKpB,OAJKT,IACDS,EAAgB,2BAGfr5B,EAIDA,EAAQhE,OAAS8H,EAAAA,GAAU3D,WAkIvC,SACIH,EACAq5B,EACA/d,EACAmH,EACA2W,EACAE,EACAtN,EACAmN,GAEA,MAAMI,EAAiB,eACvB,GAAIvN,EAAU,CACV,MAAME,EAAMF,EAAW2H,EAAAA,GAAsB3H,EAAS3wB,GAAI2wB,EAASI,qBAAuB,GAE1F,IAAIoN,EAAkB,KAClBC,EAAkB,KACjBzN,SAAAA,EAAUK,SACXmN,EAAkBt2B,IAAAA,cAAC20B,GAAqB,CAAC73B,QAASA,IAClDy5B,EAAkBC,GAAsB15B,IAG5C,MAAM25B,EACFz2B,IAAAA,cAAA,OAAKuD,UAAU,0BACVmzB,GAAqBnX,EAAY6W,GACjCG,EACAD,GAIT,OACIt2B,IAAAA,cAAA,OACI7H,GAAIk+B,EACJ9yB,UAAW,iBAAmB4yB,GAE9Bn2B,IAAAA,cAAA,OAAKuD,UAAU,iDACXvD,IAAAA,cAAC+oB,GAAAA,EAAc,CACXC,IAAKA,EACLzmB,KAAK,eACL4O,OAAQ2X,EAASK,OAAS,GAAKrsB,EAAQqU,OACvCugB,OAAQ5I,aAAQ,EAARA,EAAU3wB,GAClBqxB,SAAUV,aAAQ,EAARA,EAAUU,YAG5BxpB,IAAAA,cAAA,MAAIuD,UAAU,wBACVvD,IAAAA,cAAC22B,GAAAA,EAAW,CACRjF,OAAQ5I,aAAQ,EAARA,EAAU3wB,MAG1B6H,IAAAA,cAAA,KAAGuD,UAAU,uBACTvD,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,oBACH6K,eAAe,iIACf2B,OAAQ,CACJmkB,SAAUmN,MAIrBQ,EAGb,CAEA,OACIz2B,IAAAA,cAAA,OACI7H,GAAIk+B,EACJ9yB,UAAW,iBAAmB4yB,GAE9Bn2B,IAAAA,cAAA,KAAGuD,UAAU,uBACTvD,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,0BACH6K,eAAe,uIAKnC,CA5MmB4zB,CAAqB95B,EAASq5B,EAAe/d,EAAamH,EAAY2W,EAAc50B,KAAK80B,eAAgBtN,EAAUmN,GACnHn5B,EAAQhE,OAAS8H,EAAAA,GAAU1D,WAqD9C,SACIJ,EACAq5B,EACA5W,EACA2W,EACAE,EACAS,EACAhrB,EACAuM,EACA0e,GAEA,MAAMT,EAAiB,eAEvB,GAAIQ,EAAS36B,OAAS,EAAG,CACrB,MAAM66B,EAAqBF,EAASn6B,MAAMs6B,GAAMA,EAAE7+B,KAAO0T,IAEnDorB,EAAWJ,EACbj6B,QAAQs6B,GAAYA,EAAQ/+B,KAAO0T,IACnCrO,KAAK05B,GACDl3B,IAAAA,cAAC+oB,GAAAA,EAAc,CACXtkB,IAAK,sBAAwByyB,EAAQ/+B,GACrC6wB,IAAKyH,EAAAA,GAAsByG,EAAQ/+B,GAAI++B,EAAQhO,qBAC/C3mB,KAAK,eACLmvB,OAAQwF,EAAQ/+B,GAChBqxB,SAAU0N,EAAQ1N,aAIxBiN,EACFz2B,IAAAA,cAAA,OAAKuD,UAAU,0BACVmzB,GAAqBnX,EAAY6W,GACjCI,GAAsB15B,IACrBo5B,GAAgBiB,GAAoCr6B,EAASsb,GAC/DpY,IAAAA,cAAC20B,GAAqB,CAAC73B,QAASA,KAIxC,OACIkD,IAAAA,cAAA,OACI7H,GAAIk+B,EACJ9yB,UAAW,iBAAmB4yB,GAE9Bn2B,IAAAA,cAAA,OAAKuD,UAAU,0EACV0zB,GAELj3B,IAAAA,cAAA,MAAIuD,UAAU,wBACTzG,EAAQmF,cAEbjC,IAAAA,cAAA,KAAGuD,UAAU,uBACTvD,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,+BACH6K,eAAgB,2EAEnBo0B,GAA8BL,EAAoBD,IAEtDL,EAGb,CAEA,OACIz2B,IAAAA,cAAA,OACI7H,GAAIk+B,EACJ9yB,UAAW,iBAAmB4yB,GAE9Bn2B,IAAAA,cAAA,KAAGuD,UAAU,uBACTvD,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,+BACH6K,eAAe,qJAKnC,CA7HmBq0B,CAAqBv6B,EAASq5B,EAAe5W,EAAY2W,EAAc50B,KAAK80B,eAAgBR,EAAiB/pB,EAAeuM,EAAawc,GACzI93B,EAAQ2G,OAAS7C,EAAAA,GAAUghB,gBAyR9C,SACI9kB,EACAq5B,EACA/d,EACAmH,EACA2W,EACAE,EACAb,EACA/B,EACAqC,EACAC,EACAC,GAEA,IAAIuB,EAAiB,KACrB,MAAM/D,EAAagC,EAAMC,kBACnBf,EAAY33B,EAAQhE,OAAS8H,EAAAA,GAAUuM,gBACvCwmB,EAAcJ,EAAaC,EAEjC,IAAI+C,EAAkB,KAClB9C,EAAgB,KAChBgD,EAAgB,KAEpB,IAAKX,EAAY,CACbrC,EAAgBzzB,IAAAA,cAAC20B,GAAqB,CAAC73B,QAASA,IAChD,MAAMyM,EAAWitB,GAAsB15B,GACnCyM,IACAgtB,EACIv2B,IAAAA,cAAC00B,GAAAA,EAAqB,CAClB35B,OAAQ+B,EAAQkQ,QAChB9U,UAAW4E,EAAQ3E,GACnBmX,YAAa,CAACmlB,EAAYllB,GAAAA,GAAYgoB,kCAAoChoB,GAAAA,GAAYioB,mCAErFjuB,GAIjB,CA0DA,OAxDKusB,GAAcD,IACfyB,EACIt3B,IAAAA,cAACqP,GAAAA,EAAkB,CACftU,OAAQ+B,EAAQkQ,QAChBsC,YAAa,CAACC,GAAAA,GAAYkoB,cAE1Bz3B,IAAAA,cAACqP,GAAAA,EAAkB,CACftU,OAAQ+B,EAAQkQ,QAChBsC,YAAa,CAACC,GAAAA,GAAYqkB,oBAExBmC,GACE/1B,IAAAA,cAACszB,GAAgB,CACbC,WAAYA,EACZC,WAAYA,EACZ12B,QAASA,EACT22B,cAAeA,IAGtBsC,GACD/1B,IAAAA,cAACi0B,GAAAA,EAAiB,CACd1wB,UAAU,0BACVqH,QAAShJ,EAAAA,GAAiB81B,mBAC1B5sB,WAAY6sB,GAAAA,EACZliB,YAAa,CAAC3Y,YAEdkD,IAAAA,cAAA,KACIuD,UAAU,oBAEdvD,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,iCACH6K,eAAe,sCAUnCyzB,EADA9C,EAEI3zB,IAAAA,cAAA,OAAKuD,UAAU,0BACVkzB,EAAgBa,GAKrBt3B,IAAAA,cAAA,OAAKuD,UAAU,0BACVmzB,GAAqBnX,EAAY6W,GACjCG,EACAY,GAAoCr6B,EAASsb,GAC7C2d,GAA0BtC,GAMnCzzB,IAAAA,cAAA,OACI7H,GAAG,eACHoL,UAAW,iBAAmB4yB,GAE9Bn2B,IAAAA,cAAC43B,GAAyB,MAC1B53B,IAAAA,cAAA,MAAIuD,UAAU,wBACTzG,EAAQmF,cAEbjC,IAAAA,cAAA,KAAGuD,UAAU,wBACPuyB,GACE91B,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,yBACH6K,eAAe,gKACf2B,OAAQ,CACJ1C,aAAcnF,EAAQmF,gBAIjC6zB,GACG91B,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,kCACH6K,eAAe,+JACf2B,OAAQ,CACJ1C,aAAcnF,EAAQmF,iBAKrCw0B,EAGb,CAtZmBoB,CAA0B/6B,EAASq5B,EAAe/d,EAAamH,EAAY2W,EAAc50B,KAAK80B,eAAgBb,EAAO/B,EAAYqC,EAAoBC,EAAYC,GACjKj5B,EAAQ2G,OAAS7C,EAAAA,GAAUk3B,iBAyM9C,SACIh7B,EACAq5B,EACA5W,EACA2W,EACA9d,EACAge,EACAb,EACA/B,GAEA,MAAMiB,EAAY33B,EAAQhE,OAAS8H,EAAAA,GAAUuM,gBACvC5D,EAAWitB,GAAsB15B,GACjCy2B,EAAagC,EAAMC,kBACnB7B,EAAcJ,EAAaC,EAEjC,IAAI+C,EAAkB,KAClBE,EAAgB,KAEhBltB,IACAgtB,EACIv2B,IAAAA,cAAC00B,GAAAA,EAAqB,CAClB35B,OAAQ+B,EAAQkQ,QAChB9U,UAAW4E,EAAQ3E,GACnBmX,YAAa,CAACmlB,EAAYllB,GAAAA,GAAYgoB,kCAAoChoB,GAAAA,GAAYioB,mCAErFjuB,IAKb,MAAMwuB,EACF/3B,IAAAA,cAACszB,GAAgB,CACbC,WAAYA,EACZC,WAAYA,EACZ12B,QAASA,EACT22B,cAAezzB,IAAAA,cAAC20B,GAAqB,CAAC73B,QAASA,MAoBvD,OAfI25B,EADA9C,EAEI3zB,IAAAA,cAAA,OAAKuD,UAAU,0BACVkzB,EAAgBsB,GAKrB/3B,IAAAA,cAAA,OAAKuD,UAAU,0BACVmzB,GAAqBnX,EAAY6W,GACjCG,EACAY,GAAoCr6B,EAASsb,IAMtDpY,IAAAA,cAAA,OACI7H,GAAG,eACHoL,UAAW,iBAAmB4yB,GAE9Bn2B,IAAAA,cAACg4B,GAAqB,MACtBh4B,IAAAA,cAAA,MAAIuD,UAAU,wBACTzG,EAAQmF,cAEbjC,IAAAA,cAAA,KAAGuD,UAAU,uBACTvD,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,0BACH6K,eAAe,qFACf2B,OAAQ,CACJ1C,aAAcnF,EAAQmF,iBAIjCw0B,EAGb,CApRmBwB,CAA2Bn7B,EAASq5B,EAAe5W,EAAY2W,EAAc9d,EAAa9W,KAAK80B,eAAgBb,EAAO/B,GACtH12B,EAAQhE,OAAS8H,EAAAA,GAAUwM,cAAgBtQ,EAAQhE,OAAS8H,EAAAA,GAAUuM,gBAqZzF,SACIrQ,EACAq5B,EACA/d,EACAmH,EACA2W,EACAE,EACAb,EACA/B,EACAmC,EACAK,GAEA,MAAMkC,EAASp7B,EAAQmF,aACvB,IAAIk2B,EACAb,EAAiB,KACrB,MAAMzC,EAA0C,IAAtB/3B,EAAQuQ,UAC5BkmB,EAAagC,EAAMC,kBACnB7B,EAAcJ,EAAaC,EAG7B2E,EADAtD,EACgB,GACT/3B,EAAQhE,OAAS8H,EAAAA,GAAUuM,gBAE9BnN,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,6BACH6K,eAAe,0FACf2B,OAAQ,CACJ1C,aAAcnF,EAAQmF,gBAM9BjC,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,2BACH6K,eAAe,uFACf2B,OAAQ,CACJ1C,aAAcnF,EAAQmF,gBAMtC,MAAMm2B,EACFp4B,IAAAA,cAACq4B,GAAAA,cAAa,CACVxyB,MAAO/I,EAAQw7B,UACfC,OAAOC,EAAAA,GAAAA,IAAa7C,GACpB8C,IAAI,UACJC,KAAK,YAIb,IAAIC,EAiDAC,EAhDgB,KAAhB5C,EACIl5B,EAAQhE,OAAS8H,EAAAA,GAAUuM,gBAC3BwrB,EACI34B,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,kCACH6K,eAAe,qCACf2B,OAAQ,CAAClB,KAAOy0B,EAASE,UAG1Bt7B,EAAQhE,OAAS8H,EAAAA,GAAUwM,eAClCurB,EACI34B,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,2BACH6K,eAAe,oCACf2B,OAAQ,CAAClB,KAAOy0B,EAASE,WAI9Bt7B,EAAQhE,OAAS8H,EAAAA,GAAUuM,gBAClCwrB,EACI34B,IAAAA,cAAA,YACIA,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,gCACH6K,eAAe,kDACf2B,OAAQ,CACJlB,KAAOy0B,EACPW,QAAU7C,EACVoC,WAKTt7B,EAAQhE,OAAS8H,EAAAA,GAAUwM,eAClCurB,EACI34B,IAAAA,cAAA,YACIA,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,yBACH6K,eAAe,iDACf2B,OAAQ,CACJlB,KAAOy0B,EACPW,QAAU7C,EACVoC,YAQhBt7B,EAAQoF,SAA+B,KAApBpF,EAAQoF,UAC3B02B,EACI54B,IAAAA,cAAA,YACIA,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,yBACH6K,eAAe,wCACf2B,OAAQ,CAACzC,QAASpF,EAAQoF,aAM1C,MAAMuyB,EAAY33B,EAAQhE,OAAS8H,EAAAA,GAAUuM,gBAC7C,IAAIopB,EAAkB,KAClBE,EAAgB,KACpB,MAAMltB,EAAWitB,GAAsB15B,GAwCvC,OAvCIyM,IACAgtB,EACIv2B,IAAAA,cAAC00B,GAAAA,EAAqB,CAClB35B,OAAQ+B,EAAQkQ,QAChB9U,UAAW4E,EAAQ3E,GACnBmX,YAAa,CAACmlB,EAAYllB,GAAAA,GAAYgoB,kCAAoChoB,GAAAA,GAAYioB,mCAErFjuB,IAKb+tB,EACIt3B,IAAAA,cAACszB,GAAgB,CACbC,WAAYA,EACZC,WAAYA,EACZ12B,QAASA,EACT22B,cAAezzB,IAAAA,cAAC20B,GAAqB,CAAC73B,QAASA,MAKnD25B,EADA9C,EAEI3zB,IAAAA,cAAA,OAAKuD,UAAU,0BACVkzB,EAAgBa,GAKrBt3B,IAAAA,cAAA,OAAKuD,UAAU,0BACVmzB,GAAqBnX,EAAY6W,GACjCkB,EACAf,GACCL,GAAgBiB,GAAoCr6B,EAASsb,GAC/DpY,IAAAA,cAAC20B,GAAqB,CAAC73B,QAASA,KAMxCkD,IAAAA,cAAA,OACI7H,GAAG,eACHoL,UAAW,iBAAmB4yB,GAE7B1B,EAAYz0B,IAAAA,cAAC84B,GAAsB,MAAK94B,IAAAA,cAACg4B,GAAqB,MAC/Dh4B,IAAAA,cAAA,MAAIuD,UAAU,wBACTzG,EAAQmF,cAEbjC,IAAAA,cAAA,OAAKuD,UAAU,0BACVkxB,EAAYz0B,IAAAA,cAACyC,GAAAA,gBAAe,CAACF,KAAM,KAAQvC,IAAAA,cAAC0C,GAAAA,UAAS,CAACH,KAAM,KAC5Do2B,GAEL34B,IAAAA,cAAA,KAAGuD,UAAU,uBACR40B,EACAS,GAEJnC,EAGb,CArkBmBsC,CAA2Bj8B,EAASq5B,EAAe/d,EAAamH,EAAY2W,EAAc50B,KAAK80B,eAAgBb,EAAO/B,EAAYmC,EAAQK,GAE9I,KAdI,IAef,EACHz1B,GA9DoB80B,GAAmB,aAxBpCxpB,cAAa1B,IAAAA,OAAAC,WAEbsrB,UAASvrB,IAAAA,KAAAC,WACTurB,OAAMxrB,IAAAA,OAAAC,WACNwrB,gBAAezrB,IAAAA,MAAAC,WACfyrB,mBAAkB1rB,IAAAA,KAClB2rB,WAAU3rB,IAAAA,KACVoV,WAAUpV,IAAAA,KAAAC,WACV2rB,uBAAsB5rB,IAAAA,KACtB6rB,YAAW7rB,IAAAA,OAAAC,WAEX6rB,aAAY9rB,IAAAA,OAEZorB,MAAKprB,IAAAA,IAAAC,WACLopB,WAAUrpB,IAAAA,OAAAC,WAEV8rB,aAAY/rB,IAAAA,KAAAC,WACZM,QAAOP,IAAAA,MAAA,CACHsrB,mBAAkBtrB,IAAAA,KAAAC,WAClBkV,gBAAenV,IAAAA,KAAAC,WACf4V,kBAAiB7V,IAAAA,KAAAC,aAAAA,aAoEzB,MAAM4uB,IAAkB3uB,EAAAA,GAAAA,gBAAe,CACnCyT,MAAO,CAAC3lB,GAAI,0BAA2B6K,eAAgB,8EACvD,CAACi2B,GAAAA,EAAkBC,KAAM,CAAC/gC,GAAI,wBAAyB6K,eAAgB,qEACvE,CAACi2B,GAAAA,EAAkBE,SAAU,CAAChhC,GAAI,wBAAyB6K,eAAgB,qEAC3E,CAACi2B,GAAAA,EAAkBG,SAAU,CAACjhC,GAAI,4BAA6B6K,eAAgB,sFAC/E,CAACi2B,GAAAA,EAAkBI,MAAO,CAAClhC,GAAI,yBAA0B6K,eAAgB,0EAGvEo0B,GAAgCA,CAACkC,EAA0C7J,KAA8C,IAAA8J,EAAAC,EAE3H,IADgBjX,EAAAA,GAAAA,IAAekN,GAE3B,OACIzvB,IAAAA,cAACkD,GAAAA,iBAAgB2Q,OAAAuI,OAAA,GACT4c,GAAgBlb,MAAK,CACzBnZ,OAAQ,CACJhH,EAAIkb,GAAW7Y,IAAAA,cAAA,SAAI6Y,OAKnC,MAAM4gB,GAAoBhK,SAAwB,QAAd8J,EAAV9J,EAAYiK,oBAAY,IAAAH,OAAd,EAAVA,EAA0BI,UAAWV,GAAAA,EAAkBE,QAC3ES,GAAiBN,SAAyB,QAAdE,EAAXF,EAAaI,oBAAY,IAAAF,OAAd,EAAXA,EAA2BG,UAAWV,GAAAA,EAAkBG,QAC/E,IAAIS,EAAmBJ,EAQvB,OAPII,IAAqBZ,GAAAA,EAAkBE,UACvCU,EAAmBD,GAEnBH,IAAsBR,GAAAA,EAAkBE,SAAWS,IAAmBX,GAAAA,EAAkBG,UACxFS,EAAmBZ,GAAAA,EAAkBC,KAIrCl5B,IAAAA,cAACkD,GAAAA,iBAAgB2Q,OAAAuI,OAAA,GACT4c,GAAgBa,GAAiB,CACrCl1B,OAAQ,CACJhH,EAAIkb,GAAW7Y,IAAAA,cAAA,SAAI6Y,MAEzB,EA6hBV,SAAS2d,GAAsB15B,GAE3B,OADgD,IAAtBA,EAAQuQ,UAEvB,KAIPrN,IAAAA,cAACi0B,GAAAA,EAAiB,CACdrpB,QAAShJ,EAAAA,GAAiBk4B,oBAC1B/3B,UAAW0uB,EAAAA,GAAsB,CAACt4B,GAAI,2BAA4B6K,eAAgB,eAClFO,UAAW,gBACXuH,WAAYivB,GAAAA,EACZtkB,YAAa,CAAC3Y,YAEdkD,IAAAA,cAACg6B,GAAAA,kBAAiB,CACdz3B,KAAM,KAEVvC,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,2BACH6K,eAAe,eAI/B,CAEA,SAAS0zB,GAAqBnX,EAAqB6W,EAA4B6D,GAC3E,IAAIC,EAcJ,OAZIA,EADA3a,EAEIvf,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,yCACH6K,eAAe,cAInBhD,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,wCACH6K,eAAe,aAIvBhD,IAAAA,cAAA,UACI7H,GAAG,4BACHoL,UAAS,iBAAAvB,OAAmBud,EAAa,SAAW,GAAE,MAAAvd,OAAKi4B,GAC3Dp2B,QAASuyB,EACT,aAAY,YAEX7W,EAAavf,IAAAA,cAAC0gB,GAAAA,SAAQ,CAACne,KAAM,KAAQvC,IAAAA,cAAC8V,GAAAA,gBAAe,CAACvT,KAAM,KAC5D23B,EAGb,CAEA,SAAS/C,GAAoCr6B,EAAkBsb,GAC3D,OACIpY,IAAAA,cAACi0B,GAAAA,EAAiB,CACd97B,GAAG,4CACHyS,QAAShJ,EAAAA,GAAiBu4B,sBAC1Bp4B,UAAW0uB,EAAAA,GAAsB,CAACt4B,GAAI,yCAA0C6K,eAAgB,6BAChGO,UAAW,gBACXuH,WAAYsvB,GAAAA,EACZ3kB,YAAa,CAAC3Y,UAASsb,cAAagc,mBAAoB,8CAExDp0B,IAAAA,cAACq6B,GAAAA,oBAAmB,CAAC93B,KAAM,KAC3BvC,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,yCACH6K,eAAe,kBAI/B,CC1rBA,UAAe2N,EAAAA,EAAAA,UA9Cf,SAAyBrY,GACrB,MACMu9B,EAAmD,UAD1C5iB,EAAAA,EAAAA,IAAU3a,GACSgiC,mBAE5B1pB,GAAOC,EAAAA,EAAAA,IAAevY,GACtBwE,GAAUy9B,EAAAA,EAAAA,IAAkBjiC,GAC5Bs8B,GAAgB4F,EAAAA,EAAAA,IAA8BliC,GAC9CwwB,EAAWhsB,GAAU29B,EAAAA,EAAAA,IAAkBniC,EAAOwE,EAAQ3E,SAAMgE,EAC5Dic,GAAcsB,EAAAA,EAAAA,IAAephB,GAC7BugC,EAAU/7B,GAAU6sB,EAAAA,EAAAA,IAAQrxB,EAAOwE,EAAQ49B,iBAAcv+B,EAIzDo5B,GAAQoF,EAAAA,EAAAA,IAA2BriC,IAAU,CAACk9B,kBAAmB,GAEvE,MAAO,CACH3pB,eAAemF,EAAAA,EAAAA,IAAiB1Y,GAChCwE,UACA44B,WAAWkF,EAAAA,EAAAA,IAAItiC,EAAOiwB,EAAAA,GAAYsS,0BAA2BtS,EAAAA,GAAYuS,qBAAsBvS,EAAAA,GAAYwS,gCAAkCxS,EAAAA,GAAYyS,iCACzJrF,QAAQsF,EAAAA,GAAAA,GAAiB3iC,GACzBs9B,iBAAiBsF,EAAAA,EAAAA,IAA4B5iC,GAC7Cu9B,qBACAC,YAnBe,EAoBfvW,YAAY4b,EAAAA,EAAAA,IAAyB7iC,GACrCy9B,uBAAwBhyB,QAAQ6M,aAAI,EAAJA,EAAMid,mBACtCmI,aAAaoF,EAAAA,EAAAA,IAAqB9iC,EAAOugC,GACzC/P,WACAmN,cAAcmF,EAAAA,EAAAA,IAAqB9iC,EAAOwwB,GAC1C1Q,cACAmd,QACA/B,WAnBe,GAoBfoB,gBACAsB,cAAcmF,EAAAA,EAAAA,IAAgB/iC,GAEtC,IAEA,SAA4BF,GACxB,MAAO,CACHsS,SAASgH,EAAAA,EAAAA,IAAmB,CACxB+jB,mBAAkB,KAClBnW,gBAAe,KACfU,kBAAiBA,EAAAA,IAClB5nB,GAEX,GAEA,CAA4Di9B,I,iDCJ7C,MAAMiG,WAAoBt7B,IAAAA,cACrCu7B,0CAAAA,CAA2CC,GACvC,MAAO9wB,SAAS,gCAAC+wB,IAAoCn6B,KAAKpB,OAEtDw7B,EAAAA,GAAAA,IAAYF,IAEZC,EAAgCE,EAAAA,GAAUC,SAElD,CAEA/X,kBAAAA,CAAmBC,GACf,MAAM,OAAC0X,EAAM,WAAEK,EAAU,mCAAEC,GAAsCx6B,KAAKpB,MAEhE67B,EAA2CjY,EAAUgY,qCAAuCA,GAC9FA,IAAuCH,EAAAA,GAAUK,OAGjDH,GAAcE,GACdz6B,KAAKi6B,2CAA2CC,EAExD,CAEAz0B,MAAAA,GACI,MAAM,OAACy0B,EAAM,eAAES,EAAc,kBAAEC,EAAiB,kBAAEC,GAAqB76B,KAAKpB,OACtE,sBACFk8B,EAAqB,sBACrBC,EAAqB,sBACrBC,EAAqB,4BACrBC,EAA2B,4BAC3BC,GACAC,EAAAA,GAEJ,GAAIC,GAAAA,GAAyBlB,GAAS,CAClC,MAAMpD,EAAOsE,GAAAA,GAAiClB,GAE9C,OACIx7B,IAAAA,cAAC28B,GAAAA,EAAa,CACVl4B,IAAK2zB,EACLA,KAAMA,GAGlB,CAEA,GAAIsE,GAAAA,GAAmClB,GACnC,OACIx7B,IAAAA,cAAC48B,GAAAA,EAAmB,CAChBC,YAAarB,EACbsB,4BAA6Bx7B,KAAKpB,MAAM48B,4BACxC5kC,UAAWoJ,KAAKpB,MAAMhI,YAKlC,GAAIoJ,KAAKpB,MAAM68B,uBACX,OACI/8B,IAAAA,cAACg9B,GAAAA,EAAiB,MAI1B,GAAIxB,IAAWc,EACX,OACIt8B,IAAAA,cAACq1B,GAAmB,MAI5B,GAAImG,IAAWe,GAA+Bf,IAAWgB,EACrD,OACIx8B,IAAAA,cAAA,UACIuD,UAAU,mDACVM,QAAS23B,IAAWe,EAA8Bj7B,KAAKpB,MAAM+8B,eAAiB37B,KAAKpB,MAAMg9B,gBAEzFl9B,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,sBACH6K,eAAe,wBAQ/B,GAF8Bw4B,IAAWY,GACXZ,IAAWa,EACW,CAChD,MAAMc,GAAuBjB,IAAsBC,EAEnD,OACIn8B,IAAAA,cAAA,OACIuD,UAAU,kBAEVvD,IAAAA,cAAA,OAAKuD,UAAWI,IAAW,mBAAoB,CAACy5B,cAAeD,KAC3Dn9B,IAAAA,cAAA,OAAKuD,UAAU,kBACfvD,IAAAA,cAAA,OAAKuD,UAAU,kBACfvD,IAAAA,cAAA,OAAKuD,UAAU,mBAI/B,CAEA,MAAM85B,EAAY,CACdC,eAAgBrB,EAChBsB,gBAAiBx5B,QAAQzC,KAAKpB,MAAMq9B,iBACpCC,eAAgBl8B,KAAKpB,MAAMs9B,eAC3B3B,WAAYv6B,KAAKpB,MAAM27B,YAG3B,OAAIa,GAAAA,GAAyClB,GAErCx7B,IAAAA,cAACy9B,GAAAA,EAAwB5pB,OAAAuI,OAAA,CACrBshB,SAAU/B,EAAAA,GAAUK,OACpB2B,WAAYnC,GACR6B,IAMX/7B,KAAKpB,MAAM09B,KAKZ59B,IAAAA,cAAC69B,GAAAA,EAAahqB,OAAAuI,OAAA,CACVwhB,KAAMt8B,KAAKpB,MAAM09B,KACjBF,SAAU/B,EAAAA,GAAUK,QAChBqB,IAPD,IAUf,E,GA9HiB/B,G,GAAW,Y,GAAA,CAxC5BE,OAAMrxB,IAAAA,OAAAC,WACN6xB,eAAc9xB,IAAAA,OACdurB,UAASvrB,IAAAA,KACTozB,gBAAepzB,IAAAA,KACf8yB,eAAc9yB,IAAAA,KAAAC,WACd8yB,eAAc/yB,IAAAA,KAAAC,WACdozB,eAAcrzB,IAAAA,KAAAC,WAOdyxB,WAAU1xB,IAAAA,KAAAC,WAKV0xB,mCAAkC3xB,IAAAA,OAAAC,WAKlC+xB,kBAAiBhyB,IAAAA,KAAAC,WACjB8xB,kBAAiB/xB,IAAAA,KAAAC,WACjB2yB,uBAAsB5yB,IAAAA,OACtB2zB,0BAAyB3zB,IAAAA,OACzBjS,UAASiS,IAAAA,OAAAC,WAET0yB,4BAA2B3yB,IAAAA,MAAAC,WAE3BM,QAAOP,IAAAA,MAAA,CAKHsxB,gCAA+BtxB,IAAAA,IAAAC,aAAAA,a,uYCNvC,UAAeuG,EAAAA,EAAAA,UAnCf,SAAyBrY,EAAoBymB,GACzC,MAKM7e,EAGF,CACA47B,oCATuCiC,EAAAA,GAAAA,IAAsCzlC,GAU7EslC,MATSI,EAAAA,GAAAA,IAAQ1lC,EAAOymB,EAASyc,QAUjC3vB,eATkBmF,EAAAA,EAAAA,IAAiB1Y,GAUnCwkC,4BATgCxkC,EAAM2lC,QAAQC,WAAWC,4BAW7D,GAAKpf,EAASyc,SAAWiB,EAAAA,GAAmBL,uBAAyBrd,EAASyc,SAAWiB,EAAAA,GAAmBH,sBAAwB,CAChI,MAAM3d,GAAmB5f,EAAAA,EAAAA,IAAoBzG,GACvCwlC,GAA4BM,EAAAA,GAAAA,IAAgB9lC,GAAO0O,SAAS2X,IACrC5a,QAAQ+5B,IAA4D,IAA9BA,KAE/D59B,EAAM68B,uBAAyBpe,EAC/Bze,EAAM49B,0BAA4BA,EAE1C,CACA,OAAO59B,CACX,IAEA,SAA4B9H,GACxB,MAAO,CACHsS,SAASgH,EAAAA,EAAAA,IAAmB,CACxB+pB,gCAA+BA,GAAAA,IAChCrjC,GAEX,GAEA,CAA4DkjC,ICnD7C,SAAS+C,GAAmBn+B,GACvC,MAAM,cAAC6C,IAAiBgS,EAAAA,GAAAA,WACxB,OACI/U,IAAAA,cAAA,OAAUE,EACNF,IAAAA,cAAA,OACIizB,EAAE,MACFC,EAAE,MACFhB,QAAQ,iBACRoM,iBAAiB,qBACjB55B,KAAK,MACL,aAAY3B,EAAc,CAAC5K,GAAI,2BAA4B6K,eAAgB,qBAE3EhD,IAAAA,cAAA,QAAMuyB,EAAE,mJAIxB,CCRA,MAAMgM,GAAuBjqB,IAA6C,IAA5C,YAACkqB,EAAW,SAAEC,EAAQ,QAAE56B,GAAeyQ,EAEjE,OAAI7H,OAAOiyB,WAAa,IACb,KAIP1+B,IAAAA,cAAA,OACIuD,UAAWI,IAAW,oBAAqB,CACvCg7B,UAAWH,IAA4B,IAAbC,IAE9B56B,QAASA,GAET7D,IAAAA,cAACq+B,GAAkB,MACjB,EAEZE,GAAA1iB,UAAA,CArBE2iB,YAAWr0B,IAAAA,KAAAC,WACXq0B,SAAQt0B,IAAAA,KACRtG,QAAOsG,IAAAA,KAAAC,YAqBX,Y,oCCvBO,MAOMw0B,GAA6BtqB,IAAkC,IAAjC,SAAC/K,EAAQ,UAAEs1B,GAAiBvqB,EAOnE,OACItU,IAAAA,cAAA,OACI,cAhBqB,aAiBrBuD,UAAU,cAEVvD,IAAAA,cAAA,OACIuD,UAAU,uBAETgG,GAELvJ,IAAAA,cAAA,OACIuD,UAAU,sBACVM,QAlBUi7B,KACO,mBAAdD,GACPA,GACJ,EAgBQ,cAAY,oBAEZ7+B,IAAAA,cAAC++B,GAAAA,EAAS,CACNx7B,UAAU,YACVpL,GAAG,sBAGT,EAEZymC,GAAA/iB,UAAA,CAjCEtS,SAAQY,IAAAA,KAAAC,WACRy0B,UAAS10B,IAAAA,KAAAC,Y,gBCFN,MAQM40B,GAAsB1qB,IAAoD,IAAnD,UAACuqB,EAAS,QAAEh7B,GAAkCyQ,EAC9E,MAAM,cAACvR,IAAiBgS,EAAAA,GAAAA,WAElBkqB,EAAuBl8B,EAAc,CACvC5K,GAAI,gCACJ6K,eAAgB,oBAcpB,OACIhD,IAAAA,cAAA,OACI,cA7BiC,yBA8BjCuD,UAAU,yCACVM,QAf+DrD,IACnEA,EAAEsE,iBACFjB,GAAS,GAeL7D,IAAAA,cAACk/B,GAAAA,EAAe,MACfD,EACDj/B,IAAAA,cAAA,OACIuD,UAAU,kCACVM,QAhBoDrD,IAC5DA,EAAEsE,iBACFtE,EAAEa,kBACFw9B,GAAW,EAcH,cArCsC,0CAuCtC7+B,IAAAA,cAAC++B,GAAAA,EAAS,CACNx7B,UAAU,YACVpL,GAAG,gCAGT,EAEZ6mC,GAAAnjB,UAAA,CA3CEgjB,UAAS10B,IAAAA,KAAAC,WACTvG,QAAOsG,IAAAA,KAAAC,YA4CX,MCvDA,GDuDA,G,seEnCA,MAEM+0B,GAAmB,CACrBC,GAAAA,GAAAA,IAkDG,MAAMC,WAA0Br/B,IAAAA,cAMnCK,WAAAA,CAAYH,GAAc,IAAAo/B,EACtBh/B,MAAMJ,GAAMo/B,EAAAh+B,KAAAf,GAAA,uBAsJEC,KACVG,EAAAA,GAAAA,GAAaH,EAAGI,EAAAA,GAAUC,SAAS0+B,UAC/Bj+B,KAAKhJ,MAAMknC,gBACXl+B,KAAKm+B,kBACEn+B,KAAKhJ,MAAMonC,qBAClBp+B,KAAKq+B,uBACEr+B,KAAKhJ,MAAMsnC,+BAClBt+B,KAAKu+B,iCAELv+B,KAAKw+B,mBAEb,IACHv/B,GAAA,wBAEiB,KACVe,KAAKhJ,MAAMknC,iBACXl+B,KAAKC,SAAS,CACVi+B,iBAAiB,GAEzB,IACHj/B,GAAA,yBAEkB,KACXe,KAAKhJ,MAAMynC,yBACXz+B,KAAKC,SAAS,CACVw+B,yBAAyB,GAEjC,IACHx/B,GAAA,6BAEsB,WAAqC,IAApCy/B,IAAwB/jC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,KAAAA,UAAA,GACxCqjC,EAAKhnC,MAAMonC,uBACXJ,EAAK/9B,SAAS,CACVm+B,sBAAsB,IAEtBM,GACAV,EAAKp/B,MAAM8/B,2BAGvB,IAACz/B,GAAA,4BAEqB,KACde,KAAKpB,MAAM+/B,qBACX3+B,KAAKpB,MAAM+/B,qBACf,IACH1/B,GAAA,uCAEgC,KACzBe,KAAKhJ,MAAMsnC,gCACXt+B,KAAKC,SAAS,CACVq+B,gCAAgC,GAExC,IACHr/B,GAAA,6BAEsB,CAAC0J,EAA2Bi2B,IAC3C5+B,KAAKpB,MAAM+xB,MA1QW,UA0Q2C,IAAViO,EAEnDlgC,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,kCACH6K,eAAe,sHACf2B,OAAQ,CACJsF,QACAk2B,SAASA,EAAAA,GAAAA,IAAQ,IAAIC,KAAKF,IAAQvyB,WAClCyqB,KACIp4B,IAAAA,cAACqgC,GAAAA,GAAS,CACNx6B,MAAOq6B,EACPI,SAAS,EACTC,OAAQpB,QAQ5Bn/B,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,6BACH6K,eAAgB,sEAChB2B,OAAQ,CAACsF,aAGpB1J,GAAA,yBAEkB,IAEXP,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,yBACH6K,eAAe,8BAG1BzC,GAAA,+BAEwB,IAEjBP,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,4BACH6K,eAAe,mDACf2B,OAAQ,CACJ67B,eAAgBxgC,IAAAA,cAACob,GAAAA,EAAc,WAI9C7a,GAAA,sCAE+B,KAC5B,MAAM,MAAC4tB,GAAS7sB,KAAKpB,OAIrB+L,EAAAA,GAAAA,KAAamkB,QAAQ,IAADpuB,OAAKmsB,EAAMI,OAAO3d,MAAO,IAChDrQ,GAAA,2BAEoB,KACjB,MAAM,cAACkgC,EAAa,aAAEC,EAAY,mBAAEC,EAAkB,yBAAEX,GAA4B1+B,KAAKpB,OAKrFugC,GAAkBC,GAKtBC,IACAX,IACA1+B,KAAKq+B,wBANDr+B,KAAKs/B,+BAMkB,IAC9BrgC,GAAA,+BAEwB,KAAM,IAAAsgC,EAAAC,EAC3B,MAAM,cAACL,EAAa,aAAEC,EAAY,uBAAEK,GAA0Bz/B,KAAKpB,MAEnE,GAAIugC,EAAe,CACf,IAAKC,EAED,YADAp/B,KAAKs/B,gCAGTt/B,KAAKw+B,kBACT,CAEAiB,IACAz/B,KAAKm+B,kBAC6B,QAAlCoB,GAAAC,EAAAx/B,KAAKpB,OAAM8gC,+BAAuB,IAAAH,GAAlCA,EAAA3L,KAAA4L,EAAsC,IACzCvgC,GAAA,+BAEwB,KACrBe,KAAKpB,MAAM+gC,yBACX3/B,KAAKu+B,gCAAgC,IAxSrCv+B,KAAKhJ,MAAQ,CACT4oC,qBAAsBhhC,EAAMghC,qBAC5B/a,YAAa,EAErB,CAcA,+BAAOlmB,CAAyBC,EAAcihC,GAC1C,IACIhb,GADA,gBAACqZ,EAAe,qBAAEE,EAAoB,wBAAEK,EAAuB,+BAAEH,GAAkCuB,EAmEvG,OA9DQhb,EAFJjmB,EAAMwgC,aACFxgC,EAAMkhC,uBAAyB7Y,GAAAA,GAAY8Y,0CAA4CF,EAAUD,qBACnFC,EAAUD,qBAAuBhhC,EAAMohC,uBAEvCjC,GAAkBkC,iBAAiBrhC,EAAMshC,UAAWthC,EAAMuhC,0BAA2BvhC,EAAMwhC,aAEtGxhC,EAAMyhC,sBACTzhC,EAAMkhC,uBAAyB7Y,GAAAA,GAAY8Y,yCAC7BnhC,EAAMghC,qBAAuBhhC,EAAMohC,uBAEnCH,EAAUD,qBAGdC,EAAUD,qBAAuBhhC,EAAMohC,4BAI1B,IAApB9B,GAAsD,OAAnBt/B,EAAMu+B,WAChDe,EAAkBrZ,EAAc,IAAMjmB,EAAMu+B,eAGT,IAA5BsB,GAAmE,KAAxB7/B,EAAMugC,eAA2C,OAAnBvgC,EAAMu+B,WACtFsB,EAA0B7/B,EAAM0hC,2BAA6B,MAAS1hC,EAAMwgC,eAI5ExgC,EAAMyhC,wBAA6C,IAAnBzhC,EAAMu+B,UAAwB0C,EAAUQ,uBAA0BR,EAAU3B,kBAC5GA,GAAkB,GAKlBt/B,EAAMyhC,uBAAyBzhC,EAAM2hC,eAAiBV,EAAUU,eAAoC,IAAnB3hC,EAAMu+B,WACvFe,GAAkB,IAGjBA,GAAmBrZ,EAAc,IAAyB,IAAnBjmB,EAAMu+B,UAAuBv+B,EAAM4hC,qBAAwB5hC,EAAM6hC,iBAAmB7hC,EAAM4hC,sBAClIpC,GAAuB,GAGvBx/B,EAAMkhC,uBAAyB7Y,GAAAA,GAAY8Y,0CAA6CnhC,EAAMyhC,wBAC9FnC,GAAkB,GAGjBrZ,IACDqZ,GAAkB,EAClBE,GAAuB,GAGvBx/B,EAAM8hC,0BACNpC,GAAiC,QAIS,IAAnCA,GACP1/B,EAAM2hC,cACN3hC,EAAM2hC,eAAiBV,EAAUU,cACjC3hC,EAAM+hC,iCACN9b,EAAc,IACbjmB,EAAM8hC,0BAEPpC,GAAiC,GAG9B,CACHzZ,cACAqZ,kBACAE,uBACAE,iCACAiC,aAAc3hC,EAAM2hC,aACpBpD,SAAUv+B,EAAMu+B,SAChBkD,sBAAuBzhC,EAAMyhC,sBAC7B5B,0BAER,CAEAz5B,iBAAAA,GACIhF,KAAK4gC,SAAU,EACf,MAAM,gBAAC1C,EAAe,qBAAEE,EAAoB,wBAAEK,EAAuB,+BAAEH,GAAkCt+B,KAAKhJ,MACxG6pC,EAAep+B,QAAQy7B,GAAmBE,GAAwBK,GAA2BH,GACnGn5B,SAASC,iBAAiB,UAAWpF,KAAK8gC,gBAC1C9gC,KAAKpB,MAAMwK,QAAQ23B,kBAAkBF,EACzC,CAEAte,kBAAAA,CAAmBC,EAAkBqd,GACjC,MAAM,gBAAC3B,EAAe,qBAAEE,EAAoB,wBAAEK,EAAuB,+BAAEH,GAAkCt+B,KAAKhJ,OACxG,SACFmmC,EAAQ,aACRiC,EAAY,YACZgB,EAAW,iBACXK,EAAgB,6BAChBO,EAA4B,QAC5B53B,GACApJ,KAAKpB,OAEJ4jB,EAAU2a,UAAYA,GAAYiC,IACnCp/B,KAAKq+B,sBAAqB,GAC1Br+B,KAAKm+B,kBACLn+B,KAAKw+B,oBAGT,MAAMyC,EAAiBze,EAAU4d,YAAYxlC,OACvCsmC,EAAoBd,EAAYxlC,OAetC,GAd2BsmC,IAAsBD,GAAkBb,EAAY,KAAO5d,EAAU4d,YAAY,KAC9D,IAAbjD,GAAsBiC,GAAgB8B,EAAoB,IAIpChD,GACnD8C,EAA6BP,GAGPZ,EAAU3B,kBAAoBA,GAC9B2B,EAAUzB,uBAAyBA,GACnCyB,EAAUpB,0BAA4BA,GACtCoB,EAAUvB,iCAAmCA,EAEhD,CACnB,MAAMuC,EAAep+B,QAAQy7B,GAAmBE,GAAwBK,GAA2BH,GACnGl1B,EAAQ23B,kBAAkBF,EAC9B,CACJ,CAEAv7B,oBAAAA,GACIH,SAASI,oBAAoB,UAAWvF,KAAK8gC,eACjD,CAwJAK,gBAAAA,GACI,MAAM,aAAC/B,EAAY,SAAEjC,EAAQ,MAAExM,EAAK,aAAE4P,EAAY,oBAAEa,EAAmB,wBAAEC,GAA2BrhC,KAAKpB,OACnG,gBAACs/B,EAAe,qBAAEE,EAAoB,wBAAEK,EAAuB,+BAAEH,EAA8B,YAAEzZ,GAAe7kB,KAAKhJ,MAErHsqC,EAAmB,CACrB9qB,MAAM,EACNma,QACA4M,UAAWv9B,KAAKm+B,gBAChB57B,QAASvC,KAAKy/B,uBACd8B,eACI7iC,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,gCACH6K,eAAe,oBAGvB8/B,aAAcpC,GAAiBA,IAA8B,IAAbjC,GAGpD,GAAIe,GAAmBrZ,EAAc,EACjC,OACInmB,IAAAA,cAAC+iC,GAAAA,EAAUH,EACNthC,KAAK0hC,qBAAqB7c,EAAa0b,IAKpD,MAAMoB,EAAkC,CACpCnrB,MAAM,EACNma,QACA4M,UAAWv9B,KAAKu+B,+BAChBh8B,QAASvC,KAAK2/B,uBACd4B,eACI7iC,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,gCACH6K,eAAe,oBAGvB8/B,aAAa,EACbI,cAAe,MAGnB,GAAItD,GAAkCzZ,EAAc,EAChD,OACInmB,IAAAA,cAAC+iC,GAAAA,EAAUE,EACN3hC,KAAK0hC,qBAAqB7c,EAAa0b,IAKpD,GAAInC,EAAsB,CACtB,MAAMyD,EAAgC,CAClCtE,UAAWv9B,KAAKq+B,qBAChB97B,QAASvC,KAAKq/B,mBACdkC,eACI7iC,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,gCACH6K,eAAe,0BAK3B,OACIhD,IAAAA,cAAC+iC,GAAAA,EAAKlvB,OAAAuI,OAAA,GACEwmB,EACAO,GAEH7hC,KAAK0hC,qBAAqB7c,EAAa0b,GAGpD,CAEA,GAAI9B,EAAyB,CACzB,MAAMqD,EAAoB,CACtBtrB,MAAM,EACNma,QACA4M,UAAWv9B,KAAKw+B,iBAChBj8B,QAASvC,KAAKy/B,uBACd8B,eACI7iC,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,gCACH6K,eAAe,oBAGvB8/B,aAAa,EACbO,aAAc,kBAGlB,OACIrjC,IAAAA,cAAC+iC,GAAAA,EAAUK,EACN9hC,KAAKgiC,mBAGlB,CAEA,MAAMC,EAAS,GAsBf,OArBIZ,GACAY,EAAOr6B,KACHlJ,IAAAA,cAACg/B,GAAmB,CAChBv6B,IAAI,yBACJZ,QAASvC,KAAKy/B,uBACdlC,UAAWv9B,KAAKpB,MAAMsjC,gCAK9Bd,GACAa,EAAOr6B,KACHlJ,IAAAA,cAAC4+B,GAAS,CACNn6B,IAAI,oBACJo6B,UAAWv9B,KAAKmiC,qBAEfniC,KAAKoiC,2BAKdH,EAAOrnC,OAAS,EAEZ8D,IAAAA,cAAA,OAAKuD,UAAU,kBACVggC,GAKN,IACX,CAEAx8B,MAAAA,GACI,MAAM48B,EAAgBriC,KAAKmhC,mBAE3B,OACIziC,IAAAA,cAAAA,IAAAA,SAAA,KACK2jC,EAGb,EACHpjC,GA3bY8+B,GAAiB,aA9C1BsC,sBAAqBx3B,IAAAA,KACrBu3B,YAAWv3B,IAAAA,QAAAA,IAAAA,QAAAC,WACX03B,oBAAmB33B,IAAAA,OACnBs0B,SAAQt0B,IAAAA,UAAA,CAAAA,IAAAA,KAAAA,IAAAA,MAAA,UACR43B,iBAAgB53B,IAAAA,OAAAC,WAChB6nB,MAAK9nB,IAAAA,OAAAC,WACLq2B,cAAat2B,IAAAA,OACby3B,2BAA0Bz3B,IAAAA,OAAAC,WAC1Bk4B,6BAA4Bn4B,IAAAA,KAAAC,WAC5Bu2B,mBAAkBx2B,IAAAA,KAAAC,WAClB22B,uBAAsB52B,IAAAA,KAAAC,WACtB62B,uBAAsB92B,IAAAA,KAAAC,WACtB41B,yBAAwB71B,IAAAA,KAAAC,WACxBs4B,oBAAmBv4B,IAAAA,KAAAC,WACnB61B,oBAAmB91B,IAAAA,KAAAC,WACnBu4B,wBAAuBx4B,IAAAA,KAAAC,WACvBo5B,6BAA4Br5B,IAAAA,KAAAC,WAC5B42B,wBAAuB72B,IAAAA,KAAAC,WACvB63B,gCAA+B93B,IAAAA,KAAAC,WAC/B43B,wBAAuB73B,IAAAA,KAAAC,WACvBo3B,UAASr3B,IAAAA,SAAAA,IAAAA,MAAAC,WACTy3B,aAAY13B,IAAAA,OAAAC,WACZk3B,uBAAsBn3B,IAAAA,OAAAC,WACtBg3B,qBAAoBj3B,IAAAA,OAAAC,WACpBq3B,0BAAyBt3B,IAAAA,KAAAC,aAAA7J,GAsBhB8+B,GAAiB,eAEJ,CAClBoB,cAAe,KAClBlgC,GAJQ8+B,GAAiB,oBAcA,SAACmC,EAAoCC,GAAmE,IAA/BC,EAAqBzlC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,GACvH,MAAMgnB,GAAO2gB,EAAAA,GAAAA,GAAoBlC,GACjC,GAAIze,GAAQ,EACR,OAAO,EAEX,IAAI4gB,EAAcnC,EAAY7hC,MAAM,EAAGojB,GAAMrmB,QAAQzE,KAAQujC,EAAAA,GAAAA,IAAYvjC,KAIzE,OAHIspC,IACAoC,EAAcA,EAAYjnC,QAAQzE,GAAOqpC,EAAUrpC,MAEhD0rC,EAAY3nC,MACvB,IAqaJ,UAAeoO,EAAAA,GAAAA,YAAW+0B,ICnZ1B,IAAeyE,EAAAA,EAAAA,aAAWnzB,EAAAA,EAAAA,UApC1B,WACI,MAAMozB,GAnCCxzB,EAAAA,GAAAA,IACH,wBACAyzB,GAAAA,GACAhzB,EAAAA,IACA,CAAC1Y,EAAoB2rC,IAAsBA,IAC3C,CAAC3rC,EAAoB2rC,EAASlC,IAA6BA,GAC3DN,EAAAA,IACA,CAACyC,EAAUr4B,EAAeo4B,EAASlC,EAAkBpkB,IAC5CsmB,EAKEA,EAAQzmC,KAAKrF,GAAO+rC,EAAS/rC,KAAKyE,QAAQghC,GACtCA,GACHA,EAAKlV,UAAY7c,GACjB+xB,EAAKtlC,QAAU6rC,GAAAA,GAAMC,cACrBxG,EAAKtF,UAAYyJ,KAChBpkB,GAA+B,KAAjBigB,EAAKyG,WACzBnoC,OAVQ,IA2BbooC,GA1DC/zB,EAAAA,GAAAA,IACH,mBACAyzB,GAAAA,GACAhzB,EAAAA,GACAupB,EAAAA,IACA,CAAC2J,EAAUr4B,EAAe/O,IAEf+W,OAAOlP,OAAOu/B,GAAUtnC,QAAQghC,GAEd,KAAjBA,EAAKyG,SACLzG,EAAKhrB,cAAe9V,aAAO,EAAPA,EAAS3E,KAC7BylC,EAAKtlC,QAAU6rC,GAAAA,GAAMC,eAE1B/vB,QAAO,CAAC7W,EAA8B+mC,KACrC/mC,EAAI+mC,EAAIpsC,KAAM,EACPqF,IACR,CAAC,KA2CNgnC,GAA4BC,EAAAA,GAAAA,MAClC,OAAO,SAAyBnsC,EAAoBymB,GAChD,IAAIuiB,EAAyB,EAC7B,MAAMK,GAAwB+C,EAAAA,EAAAA,IAAiBpsC,EAAOymB,EAAS7mB,WACzD2pC,EAAevpC,EAAM6C,MAAM2B,QAAQ6nC,oBAAoB5lB,EAAS7mB,WAChEkpC,GAAuBwD,EAAAA,EAAAA,IAAkCtsC,GAC/D,IAAKymB,EAAS2hB,aAAc,CACxB,IAAIuD,GAAUY,EAAAA,GAAAA,IAAoBvsC,EAAOymB,EAAS7mB,YAAc,GAC5D+rC,IACAA,EAAUO,EAA0BlsC,EAAO,CAAC2rC,UAASpC,kBAEzDP,EAAyByC,EAAkBzrC,EAAO2rC,EAASpC,EAC/D,CACA,MAAO,CACHL,UAAW8C,EAAahsC,GACxBupC,eACAP,yBACAF,uBACAK,2BAA2BA,EAAAA,EAAAA,IAA0BnpC,GACrD4oC,sBAAsB4D,EAAAA,EAAAA,IAAkCxsC,GACxDqpC,wBAER,CACJ,IAEA,SAA4BvpC,GACxB,MAAO,CACHsS,SAASgH,EAAAA,EAAAA,IAAmB,CACxB2wB,kBAAiBA,EAAAA,IAClBjqC,GAEX,GAE0BuY,CAAiDo0B,K,0BCtG3E,MAAMC,GAAoB9kC,IACtB,MAAM,QAAC+jC,GAAW/jC,EACZ+kC,GAAerxB,EAAAA,EAAAA,UAAQ,KAAMsxB,EAAAA,GAAAA,IAAgBjB,GAAW,KAAK,CAACA,IAC9DkB,GAAa5yB,EAAAA,EAAAA,cAAgCja,IAAU0lC,EAAAA,GAAAA,IAAQ1lC,EAAO2sC,KAEtEljC,GAAYqjC,EAAAA,GAAAA,IAAiBD,GAEnC,OACInlC,IAAAA,cAAA,QACIuD,UAAU,UACV,YAAU,UAETxB,EACE,EAEbijC,GAAAnpB,UAAA,CAlBEooB,QAAO95B,IAAAA,QAAAA,IAAAA,SAoBX,Y,89BCRA,MAUMk7B,GAAgB,CAClBC,QAAS,gBAGPC,GAAiB,CACnBlrB,SAAU,WACVmrB,OAAQ,IACRC,UAAW,QAqGA,MAAMC,WAAiB1lC,IAAAA,cASlCK,WAAAA,CAAYH,GAAc,IAAAo/B,EACtBh/B,MAAMJ,GAAMo/B,EAAAh+B,KAAAf,GAAA,wBAPyB,MAAIA,GAAA,2BAiKxB,KACjBe,KAAKqkC,wBAA0BrkC,KAAKskC,4BAA4B,IACnErlC,GAAA,uBAEiBslC,IACd,IAAIC,EAAmBxkC,KAAKhJ,MAAMwtC,iBAC9BxkC,KAAKpB,MAAMg2B,eACX4P,EAAgBrY,GAAAA,GAAA,GACTqY,GAAgB,IACnBC,WAAYF,EAAS,QAAU,eAIvCvkC,KAAKC,SAAS,CACVykC,eAAgBH,EAChBC,oBACF,IACLvlC,GAAA,gCAEyB,KACtBe,KAAKC,SAAS,CACVygC,yBAAyB,GAC3B,IACLzhC,GAAA,kBAEW+T,IAA4F,IAA3F,KAACrb,EAAI,OAAEgtC,EAAM,MAAEC,GAAuE5xB,EAC/F,MAAMrW,EAAQhF,EAAKqC,QAAQ2qC,GAC3B,IAAI1iC,EAAY,GAChB,MAAM4iC,EAAmB,oBACnBC,GAA6B,IAAXnoC,GAAgBA,EAAQhF,EAAKiD,OAAS,EAAKjD,EAAKgF,EAAQ,GAAK,GAC/EooC,EAAcpoC,EAAQ,GAAKA,EAAQhF,EAAKiD,OAAUjD,EAAKgF,EAAQ,GAAK,KAEtEqoC,EAAAA,GAAAA,IAAWD,KAAeE,EAAAA,GAAAA,IAAqBF,MAC/C9iC,GAAa4iC,EAAmB,aAGhCG,EAAAA,GAAAA,IAAWF,KAAmBG,EAAAA,GAAAA,IAAqBH,MAC/C7iC,EAAUgT,SAAS4vB,GACnB5iC,GAAa,OAEbA,GAAa4iC,EAAmB,QAKxC,MAAMtK,EAAaoK,IAAW3kC,KAAKhJ,MAAMopC,YAAY,GAI/C8E,EAFWP,IAAWxJ,EAAAA,GAAmBL,uBAAyB6J,IAAWxJ,EAAAA,GAAmBJ,uBAChE/6B,KAAKpB,MAAMg8B,mBAAsB56B,KAAKpB,MAAMi8B,kBAChB+J,EAAjCzY,GAAAA,GAAA,GAAOyY,GAAK,IAAEO,QAAS,SAExD,OACIzmC,IAAAA,cAAA,OACIkmC,MAAOM,EACPjjC,UAAWA,GAEXvD,IAAAA,cAACs7B,GAAW,CACRE,OAAQyK,EACRhK,gBAAgByK,EAAAA,GAAAA,IAAkBztC,EAAMgF,GACxCs/B,gBAAiB0I,IAAW3kC,KAAKpB,MAAMugC,cACvCxD,eAAgB37B,KAAKpB,MAAMwK,QAAQuyB,eACnCC,eAAgB57B,KAAKpB,MAAMwK,QAAQwyB,eACnCM,eAAgBl8B,KAAKk8B,eACrB3B,WAAYA,EACZM,kBAAmB76B,KAAKpB,MAAMi8B,kBAC9BD,kBAAmB56B,KAAKpB,MAAMg8B,kBAC9BhkC,UAAWoJ,KAAKpB,MAAMhI,YAExB,IAEbqI,GAAA,uBAEiBtC,IACA,IAAVA,EACAqD,KAAKpB,MAAMwK,QAAQi8B,2BAA2B,GAE9CrlC,KAAKpB,MAAMwK,QAAQi8B,2BAA2BrlC,KAAKpB,MAAM2hC,aAC7D,IACHthC,GAAA,iBAEUyzB,IAYL,IAZM,gBACR4S,EAAe,aACfC,EAAY,yBACZC,EAAwB,aACxBC,EAAY,aACZC,GAOHhT,EACG,GAAIgT,GAAgB,EAChB,OAGJ,MAAMC,EAA6C,aAApBL,IAAmCE,EAC5DI,EAA4C,YAApBN,IAAkCE,EAC1DK,EAAsBN,EA3XE,IA4XxBO,EAAmB9lC,KAAK+lC,oBAAoBR,EAAcG,EAAcD,GACxEO,EAAqBF,EA7XG,IAmZ9B,GApBIH,GAA0BE,IAAwB7lC,KAAKpB,MAAMqnC,aAC7DjmC,KAAKpB,MAAMwK,QAAQuyB,iBACZiK,GAAyBI,IAAuBhmC,KAAKpB,MAAMwgC,cAClEp/B,KAAKpB,MAAMwK,QAAQwyB,iBAGnB57B,KAAKpB,MAAMg2B,eACN50B,KAAKhJ,MAAMkmC,aACZl9B,KAAKC,SAAS,CACVi9B,aAAa,IAIjBl9B,KAAKkmC,kBACLlmC,KAAKkmC,iBAAiBC,UAAU7mC,EAAAA,GAAU8mC,eAIlDpmC,KAAKqmC,YAAYd,EAAcG,EAAcD,GAEzCD,EAA0B,KAAAc,EAE1B,MAAMC,EAAyC,QAAvBD,EAAGtmC,KAAKwmC,QAAQ1iC,eAAO,IAAAwiC,OAAA,EAApBA,EAAsBG,oBAG7CF,GAAsBA,EAAmB,IAAM,IAAMvmC,KAAKpB,MAAMwgC,cAChEp/B,KAAKpB,MAAMwK,QAAQs9B,iBAAiBC,EAAAA,GAAiBC,WAGpD5mC,KAAKhJ,MAAMmmC,UAAYuI,GACxB1lC,KAAKC,SAAS,CACVqgC,2BAA4BwF,GAGxC,CAEI9lC,KAAKpB,MAAMg2B,cAAgB50B,KAAKhJ,MAAM6vC,gBACtC7mC,KAAKC,SAAS,CACV4mC,gBAAgB,IAInB7mC,KAAKpB,MAAMg2B,cAAiB50B,KAAKhJ,MAAM8vC,uBACxC9mC,KAAKC,SAAS,CACV4mC,eAAgBf,EAAmB9lC,KAAKqkC,0BAIhDrkC,KAAK+mC,oCAAoCxB,EAAcG,EAAcD,EAAa,IACrFxmC,GAAA,mCAE4B,IACK,EAAvBkM,OAAO67B,OAAOrjB,SACxB1kB,GAAA,oBAEa,CAACsmC,EAAsBG,EAAsBD,KACvDzlC,KAAKinC,eAAejnC,KAAKknC,WAAW3B,EAAcG,EAAcD,GAAc,IAGlFxmC,GAAA,4BACsB,CAACsmC,EAAsBG,EAAsBD,IAAyBC,EAAeD,EAAeF,IAAYtmC,GAAA,mBAEzH,CAACsmC,EAAsBG,EAAsBD,IAC7BzlC,KAAK+lC,oBAAoBR,EAAcG,EAAcD,IA7b/C,IA+b8BC,EAAe,IAC/EzmC,GAAA,uBAEiBk+B,IACd,GAAIA,IAAan9B,KAAKhJ,MAAMmmC,SAAU,CAElC,IAAIsD,EAAmB3B,KAAKqI,MACxBnnC,KAAKpB,MAAM4hC,qBAAuBxgC,KAAKpB,MAAM4hC,oBAAsBC,IACnEA,EAAmBzgC,KAAKpB,MAAM4hC,qBAIlCxgC,KAAKC,SAAS,CACVk9B,WACAsD,oBAER,KACHxhC,GAAA,iCAE0B,WAAmC,IAAlCwhC,EAAgB9lC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAGmkC,KAAKqI,MAChDnJ,EAAK/9B,SAAS,CACVwgC,oBAER,IAACxhC,GAAA,yBAEkB,KACXe,KAAK4gC,SACL5gC,KAAKC,SAAS,CACVi9B,aAAa,GAErB,IACHj+B,GAAA,gCAEyB,KACtBe,KAAKC,SAAS,CACV4mC,gBAAgB,EAChBC,uBAAuB,GACzB,IACL7nC,GAAA,yCAEkC,KAC/Be,KAAKC,SAAS,CACVohC,yBAAyB,EACzB+F,2BAA2B,GAC7B,IACLnoC,GAAA,gCAEyB,KACtBe,KAAKC,SAAS,CACVohC,yBAAyB,GAC3B,IAGNpiC,GAAA,4CAKsC,CAACsmC,EAAsBG,EAAsBD,KAC/E,GAAIzlC,KAAKhJ,MAAMqqC,yBAA2BrhC,KAAKhJ,MAAMmmC,SACjDn9B,KAAKC,SAAS,CACVohC,yBAAyB,SAKjC,IAAKrhC,KAAKhJ,MAAMowC,0BAA2B,CACvC,MAAMtB,EAAmB9lC,KAAK+lC,oBAAoBR,EAAcG,EAAcD,GAC9EzlC,KAAKC,SAAS,CACVohC,wBAAyByE,EAAmB9lC,KAAKqkC,yBAEzD,KACHplC,GAAA,gCAE0BooC,IAClBrnC,KAAKpB,MAAMg2B,cAIX50B,KAAKpB,MAAMwhC,aAIhBpgC,KAAKC,SAAS,CACVqnC,WAAW1D,EAAAA,GAAAA,IAAgB5jC,KAAKpB,MAAMwhC,YAAY7hC,MAAM8oC,KAC1D,IACLpoC,GAAA,wBAEiB8zB,IAAgH,IAA/G,kBAACwU,EAAiB,iBAAEC,GAAsFzU,EACzH/yB,KAAKynC,wBAAwBF,GAGzBvnC,KAAK0nC,oBAAsB,IACzB1nC,KAAKhJ,MAAM0pC,yBACZ1gC,KAAK0nC,qBAAuBH,GAC5BvnC,KAAK0nC,qBAAuBF,GAE7BxnC,KAAK2nC,yBACT,IACH1oC,GAAA,0BAEmB,KAChB,GAAIe,KAAKpB,MAAMugC,cAIX,MAAO,CACHxiC,MAJUqD,KAAKhJ,MAAMopC,YAAYwH,WAChCz/B,GAASA,IAASnI,KAAKpB,MAAMugC,gBAI9BpmB,SAAU,UAIlB,GAAI/Y,KAAKpB,MAAM+hC,gCACX,MAAO,CACHhkC,MAAO,EACPoc,SAAU,OAIlB,MAAM8uB,GAA4BvF,EAAAA,GAAAA,GAAoBtiC,KAAKhJ,MAAMopC,aAEjE,OAAIyH,EAA4B,GAExB7C,EAAAA,GAAAA,IAAWhlC,KAAKhJ,MAAMopC,YAAYyH,EAA4B,IACvD,CACHlrC,MAAOkrC,EAA4B,EACnC9uB,SAAU,QACV+uB,QA7iBS,IAgjBV,CACHnrC,MAAOkrC,EACP9uB,SAAU,QACV+uB,QAnjBa,IAujBd,CACHnrC,MAAO,EACPoc,SAAU,MACb,IACJ9Z,GAAA,+BAEwB,KACjBe,KAAKpB,MAAMwgC,aACXp/B,KAAK+nC,kBAEL/nC,KAAKghC,+BACLhhC,KAAKpB,MAAMwK,QAAQi8B,2BAA2B,GAClD,IACHpmC,GAAA,+BAEwB,KACrBe,KAAKpB,MAAMwK,QAAQ4+B,uCAAuC,IAC7D/oC,GAAA,uBAEgB,KAAM,IAAAgpC,EACC,QAApBA,EAAAjoC,KAAKwmC,QAAQ1iC,eAAO,IAAAmkC,GAApBA,EAAsBC,aAAa,EAAG,MAAM,IAC/CjpC,GAAA,2BAEoB,KAAM,IAAAkpC,EACH,QAApBA,EAAAnoC,KAAKwmC,QAAQ1iC,eAAO,IAAAqkC,GAApBA,EAAsBD,cAAa5F,EAAAA,GAAAA,GAAoBtiC,KAAKhJ,MAAMopC,aAAc,SA/kB3D,GA+kByF,IACjHnhC,GAAA,qCAE8B,WAA+B,IAA9BshC,EAAY5lC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAGmkC,KAAKqI,MAChDnJ,EAAKp/B,MAAMwK,QAAQ43B,6BAA6BhD,EAAKp/B,MAAMhI,UAAW2pC,EAC1E,IAACthC,GAAA,qBAEe0xB,GAERjyB,IAAAA,cAAC+kC,GAAY,CACTrE,aAAcp/B,KAAKpB,MAAMwgC,aACzBgB,YAAapgC,KAAKhJ,MAAMopC,YACxBjD,SAAUn9B,KAAKhJ,MAAMmmC,SACrBxM,MAAOA,EACP8P,iBAAkBzgC,KAAKhJ,MAAMypC,iBAC7BD,oBAAqBxgC,KAAKpB,MAAM4hC,oBAChCb,uBAAwB3/B,KAAK2/B,uBAC7BN,mBAAoBr/B,KAAKq/B,mBACzBI,uBAAwBz/B,KAAKy/B,uBAC7BuB,6BAA8BhhC,KAAKghC,6BACnCtC,yBAA0B1+B,KAAK0+B,yBAC/BiC,gCAAiC3gC,KAAKpB,MAAM+hC,gCAC5CD,wBAAyB1gC,KAAKhJ,MAAM0pC,wBACpC9pC,UAAWoJ,KAAKpB,MAAMhI,UACtBuoC,cAAen/B,KAAKpB,MAAMugC,cAC1BmB,2BAA4BtgC,KAAKhJ,MAAMspC,2BACvC3B,oBAAqB3+B,KAAKooC,wBAC1BhH,oBAAqBphC,KAAKhJ,MAAM6vC,eAChCxF,wBAAyBrhC,KAAKhJ,MAAMqqC,wBACpCa,6BAA8BliC,KAAKqoC,iCACnC3I,wBAAyB1/B,KAAK0/B,4BA/ftC,MAAM4I,EAAsBnN,EAAAA,GAAmBH,sBAC/Ch7B,KAAK4gC,SAAU,EAEf5gC,KAAKhJ,MAAQ,CACTkmC,aAAa,EAGbC,SAAU,KACVsD,iBAAkB3B,KAAKqI,MACvB/G,YAAa,CAACkI,GACdhB,UAAW,GACX5C,gBAAgB,EAChBF,iBAAkB,CACdC,WAAY,aAEhB8D,qBAAqB,EACrBjI,2BAA4B,EAC5BuG,gBAAgB,EAChBC,uBAAuB,EACvBpG,yBAAyB,EACzBW,yBAAyB,EACzB+F,2BAA2B,GAG/BpnC,KAAKwmC,QAAU9nC,IAAAA,YACfsB,KAAKwoC,YAAc9pC,IAAAA,YACfsB,KAAKpB,MAAMg2B,eACX50B,KAAKkmC,iBAAmB,IAAIuC,GAAAA,EAAczoC,KAAK0oC,mBAGnD1oC,KAAK2oC,kBAAoB3oC,KAAKpB,MAAMugC,cAAgB,CAAC,EAzJ9C,KAyJwF,CAAC,EA1J3F,IA4JL,IAAIyJ,EAAY,EAEZA,EADAhqC,EAAMugC,eACOn/B,KAAKpB,MAAMwhC,aAAe,IAAIwH,WAAWiB,GAAWA,IAAW7oC,KAAKpB,MAAMugC,iBAE3EmD,EAAAA,GAAAA,GAAoB1jC,EAAMwhC,aAAe,IAEzDpgC,KAAK0nC,qBAAsBpF,EAAAA,GAAAA,GAAoB1jC,EAAMwhC,aAAe,IAEpE,MAAM0I,EAAqBlqC,EAAMugC,cAnK1B,IADF,GAqKLn/B,KAAK2oC,kBAAoB,CACrBzrC,KAAKC,IAAIyrC,EAAY,GAAI,GACzB1rC,KAAKC,IAAIyrC,EAAY,GAAI1rC,KAAKkB,KAAKQ,EAAMwhC,aAAe,IAAIxlC,OAAS,EAAGkuC,KAE5E9oC,KAAKqkC,wBAA0BrkC,KAAKskC,4BACxC,CAEAt/B,iBAAAA,GACIhF,KAAK4gC,SAAU,EAEfz1B,OAAO/F,iBAAiB,SAAUpF,KAAK+oC,oBACvCC,GAAAA,EAAaC,YAAYC,EAAAA,GAAWC,2BAA4BnpC,KAAKy/B,uBACzE,CAEA2J,uBAAAA,CAAwB5mB,GACpB,GAAIxiB,KAAKwoC,aAAexoC,KAAKwoC,YAAY1kC,QAAS,CAC9C,MAAMulC,EAAkBrpC,KAAKpB,MAAMwhC,aAAepgC,KAAKpB,MAAMwhC,YAAYxlC,UAAY4nB,EAAU4d,aAAe,IAAIxlC,QAAUoF,KAAKpB,MAAMwhC,YAAY,MAAQ5d,EAAU4d,aAAe,IAAI,GAClLkJ,EAAqBtpC,KAAKpB,MAAMqnC,eAAiBzjB,EAAUyjB,aACjE,IAAKoD,GAAmBC,KAA+C,IAAxBtpC,KAAKhJ,MAAMmmC,SAAoB,KAAAoM,EAC1E,MAAMC,EAAexpC,KAAKwoC,YAAY1kC,QAItC,MAAO,CACH2lC,kBAJgD,QAA7BF,EAAGC,EAAaE,qBAAa,IAAAH,OAAA,EAA1BA,EAA4BI,UAKlDC,qBAJyBJ,EAAa9D,aAM9C,CACJ,CACA,OAAO,IACX,CAEAnjB,kBAAAA,CAAmBC,EAAkBqnB,EAAmBzf,GAKpD,GAJIpqB,KAAKpB,MAAMg2B,eAAiBpS,EAAUoS,eACtC50B,KAAKkmC,iBAAmB,IAAIuC,GAAAA,EAAczoC,KAAK0oC,oBAG9C1oC,KAAKwoC,YAAY1kC,QAClB,OAEJ,MAAMm9B,GAAkBze,EAAU4d,aAAe,IAAIxlC,OAC/CsmC,GAAqBlhC,KAAKpB,MAAMwhC,aAAe,IAAIxlC,OAIzD,GAFAoF,KAAK0nC,qBAAsBpF,EAAAA,GAAAA,GAAoBtiC,KAAKpB,MAAMwhC,aAAe,IAErEhW,EAAU,CACV,MAAM0f,EAAuB9pC,KAAKwoC,YAAY1kC,QAAQ4hC,aAChD2D,EAAkBnI,IAAsBD,IAAmBjhC,KAAKpB,MAAMwhC,aAAe,IAAI,MAAQ5d,EAAU4d,aAAe,IAAI,GAC9HkJ,EAAqBtpC,KAAKpB,MAAMqnC,eAAiBzjB,EAAUyjB,aACjE,IAAKoD,GAAmBC,KAAwBtpC,KAAKhJ,MAAMmmC,UAAY/S,EAAU,CAC7E,MAAM2f,EAAc3f,EAASqf,mBAAqBK,EAAuB1f,EAASwf,sBACP,IAAAI,EAAvD,IAAhBD,GAAsBA,EAAc3f,EAASqf,mBAAuB,IAEhD,QAApBO,EAAAhqC,KAAKwmC,QAAQ1iC,eAAO,IAAAkmC,GAApBA,EAAsBjmC,SAASgmC,EAAaA,EAAc3f,EAASqf,mBAAmB,GAE9F,CACJ,CACJ,CAEAnkC,oBAAAA,GACItF,KAAK4gC,SAAU,EACfz1B,OAAO5F,oBAAoB,SAAUvF,KAAK+oC,oBAC1CC,GAAAA,EAAaiB,eAAef,EAAAA,GAAWC,2BAA4BnpC,KAAKy/B,uBAC5E,CAEA,+BAAO9gC,CAAyBC,EAAc5H,GAC1C,MAAMopC,EAAcxhC,EAAMwhC,aAAe,GACzC,IAAI8J,EAGAA,EADAtrC,EAAMqnC,aACW,IAAI7F,EAAajF,EAAAA,GAAmBH,uBAC9Cp8B,EAAMurC,gBACI,IAAI/J,EAAajF,EAAAA,GAAmBL,uBAEpC,IAAIsF,EAAajF,EAAAA,GAAmBF,6BAGpDr8B,EAAMwgC,eAEH8K,EADAtrC,EAAMurC,gBACW,CAAChP,EAAAA,GAAmBJ,yBAA0BmP,GAE9C,CAAC/O,EAAAA,GAAmBD,+BAAgCgP,IAI7E,MAAME,EAA4B,CAC9BhK,YAAa8J,GAGjB,GAAItrC,EAAMg2B,eAAiB59B,EAAM49B,aAAc,CAC3CwV,EAAUxV,aAAeh2B,EAAMg2B,aAE/B,MAAM4P,EAAmBxtC,EAAMwtC,iBAC3BxtC,EAAM0tC,iBACD9lC,EAAMg2B,cAAgD,UAAhC4P,EAAiBC,WAKjC7lC,EAAMg2B,cAAgD,cAAhC4P,EAAiBC,aAC9C2F,EAAU5F,iBAAgBrY,GAAAA,GAAA,GACnBqY,GAAgB,IACnBC,WAAY,WAPhB2F,EAAU5F,iBAAgBrY,GAAAA,GAAA,GACnBqY,GAAgB,IACnBC,WAAY,cAS5B,CAEA,OAAO2F,CACX,CA8WA3kC,MAAAA,GACI,MAAM,iBAAC++B,GAAoBxkC,KAAKhJ,MAEhC,OACI0H,IAAAA,cAAA,OACIuD,UAAU,eACV,uBAAqB,IACrB,yBAAuB,EACvB,4BAA0B,EAC1B,6BAA2B,EAC3B,aAAYktB,EAAAA,GAAsB,CAACt4B,GAAI,uCAAwC6K,eAAgB,8BAE9F1B,KAAKpB,MAAMg2B,cACRl2B,IAAAA,cAAAA,IAAAA,SAAA,KACIA,IAAAA,cAAC2rC,GAAAA,EAAiB,CACdnN,YAAal9B,KAAKhJ,MAAMkmC,YACxB2L,OAAQ7oC,KAAKhJ,MAAMswC,YAEvB5oC,IAAAA,cAACu+B,GAAoB,CACjBC,YAAal9B,KAAKhJ,MAAMkmC,YACxBC,SAAU16B,QAAQzC,KAAKhJ,MAAMmmC,UAC7B56B,QAASvC,KAAK+nC,kBAI1BrpC,IAAAA,cAAA,OAAKuD,UAAU,4BACXvD,IAAAA,cAAA,OACIuD,UAAU,oBAEVvD,IAAAA,cAAA,OACI7H,GAAG,kBACHoL,UAAU,sBAEVvD,IAAAA,cAACglC,GAAgB,CAACf,QAAS3iC,KAAKpB,MAAMwhC,cACtC1hC,IAAAA,cAAC4rC,GAAAA,GAAS,MACLC,IAAA,IAAC,OAAC5mB,EAAM,MAAEgN,GAAM4Z,EAAA,OACb7rC,IAAAA,cAAAA,IAAAA,SAAA,KACIA,IAAAA,cAAA,WACIA,IAAAA,cAACulB,GAAAA,QAAS,CAACC,cAAc,iBAExBlkB,KAAKwqC,aAAa7Z,IAGvBjyB,IAAAA,cAAC+rC,GAAAA,EAAsB,CACnB9jC,IAAK3G,KAAKwmC,QACV3vC,GAAG,0BACHoL,UAAU,qBACV0hB,OAAQA,EACRgN,MAAOA,EACP+Z,SAAU1qC,KAAKhJ,MAAMopC,YACrBuK,qBAvrBb,GAwrBaC,sBAzrBZ,GA0rBYC,SAAU7qC,KAAK6qC,SACfC,kBAAmB9qC,KAAK8qC,kBACxBpE,iBAAkB1mC,KAAKpB,MAAMwK,QAAQs9B,iBACrCpc,SAAUtqB,KAAKwoC,YACf5D,MAAKzY,GAAAA,GAAA,GAAM8X,IAAmBO,GAC9BuG,eAAgBhH,GAChB4E,kBAAmB3oC,KAAK2oC,kBACxBqC,SAAU7P,EAAAA,GAAmBL,sBAC7BmQ,sBAAuBjrC,KAAKpB,MAAMwgC,aAClC8L,gBAAiBlrC,KAAKkrC,gBACtBC,eAAgBnrC,KAAKmrC,gBAEpBnrC,KAAKgZ,WAEX,OAQnC,EACH/Z,GA3lBoBmlC,GAAQ,aA1FzBhE,YAAWv3B,IAAAA,QAAAA,IAAAA,QAKXjS,UAASiS,IAAAA,OAAAC,WAKTqhC,gBAAethC,IAAAA,KAAAC,WAKf+xB,kBAAiBhyB,IAAAA,KAAAC,WACjB8xB,kBAAiB/xB,IAAAA,KAAAC,WAEjB8rB,aAAY/rB,IAAAA,KAAAC,WAKZm9B,aAAYp9B,IAAAA,KAKZu2B,aAAYv2B,IAAAA,KAEZ23B,oBAAmB33B,IAAAA,OACnB03B,aAAY13B,IAAAA,OAAAC,WAKZq2B,cAAat2B,IAAAA,OAEb83B,gCAA+B93B,IAAAA,KAAAC,WAE/BM,QAAOP,IAAAA,MAAA,CAKH8yB,eAAc9yB,IAAAA,KAAAC,WAKd8yB,eAAc/yB,IAAAA,KAAAC,WAKd49B,iBAAgB79B,IAAAA,KAAAC,WAKhBu8B,2BAA0Bx8B,IAAAA,KAAAC,WAE1Bk4B,6BAA4Bn4B,IAAAA,IAAAC,WAE5Bk/B,sCAAqCn/B,IAAAA,KAAAC,aAAAA,a,yaCrG7C,MAIMsiC,GAA6B9rC,EAAAA,GAAU+rC,gBAAkB,EAK/D,SAASC,KAA8C,IAAfC,EAAK5wC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,IACzCgnB,EAAAA,GAAAA,IAAKC,GAAAA,GAAK4pB,iBAGVC,EAAAA,GAAAA,IAAiB,CACbtpC,KAAMupC,GAAAA,GAAQC,cACdC,UAAWhqB,GAAAA,GAAKC,mBAChBgqB,QAASjqB,GAAAA,GAAK4pB,eACd9jC,OAAQ,CACJ6jC,MAAOA,EAAMl/B,YAEjBy/B,SAAS,KAEbL,EAAAA,GAAAA,IAAiB,CACbtpC,KAAMupC,GAAAA,GAAQK,WACdH,UAAWhqB,GAAAA,GAAKoqB,gBAChBH,QAASjqB,GAAAA,GAAK4pB,eACd9jC,OAAQ,CACJ6jC,MAAOA,EAAMl/B,YAEjBy/B,SAAS,KAIbG,EAAAA,GAAAA,IAAW,CACPrqB,GAAAA,GAAKC,mBACLD,GAAAA,GAAKoqB,gBACLpqB,GAAAA,GAAK4pB,gBAEb,CAuGe,MAAMpH,WAAiB1lC,IAAAA,cAelCK,WAAAA,CAAYH,GAAc,IAAAo/B,EACtBh/B,MAAMJ,GAAMo/B,EAAAh+B,KAAAf,GAAA,oBA2CF9H,UACV,MAAM,cAACgoC,EAAa,YAAE+M,EAAW,oBAAE1L,EAAmB,uBAAE2L,EAAsB,QAAE/iC,GAAWpJ,KAAKpB,MAC5FugC,QACM/1B,EAAQgjC,gBAAgBx1C,EAAWuoC,GAClC+M,EACFC,SACK/iC,EAAQijC,YAAYz1C,GAEvB4pC,QACDp3B,EAAQkjC,mBAAmB11C,EAAW4pC,GAAqB,SAE3Dp3B,EAAQmjC,gBAAgB31C,GAG7BuoC,GAGDn/B,KAAKpB,MAAMwK,QAAQojC,kBAAkB51C,GAGrCoJ,KAAK4gC,SACL5gC,KAAKC,SAAS,CACV26B,mBAAmB,EACnBC,mBAAmB,GAE3B,IACH57B,GAAA,sBAEe9H,MAAOP,EAAmBiyC,EAAgBrxC,EAAwBi1C,KAC9E,MAAM,MAAC70C,SAAeoI,KAAKpB,MAAMwK,QAAQsjC,UAAU,CAC/C91C,YACAiyC,SACArxC,OACAi1C,YA0BJ,OAvBIj1C,IAASmvC,EAAAA,GAAiBgG,UAC1B3sC,KAAKC,SAAS,CAAC26B,mBAAmB,IAElC56B,KAAKC,SAAS,CAAC46B,mBAAmB,IAGlCjjC,EACIoI,KAAK4sC,iBAnPc,GAoPnB5sC,KAAK4sC,yBACC5sC,KAAK6sC,cAAcj2C,EAAWiyC,EAAQrxC,EAAMi1C,IAC3CzsC,KAAK4gC,SACZ5gC,KAAKC,SAAS,CAACkqC,iBAAiB,KAGhCnqC,KAAK4gC,SACL5gC,KAAKC,SAAS,CAACkqC,iBAAiB,IAG/BnqC,KAAKhJ,MAAMmzC,kBACZnqC,KAAK4sC,iBAAmB,IAIzB,CAACh1C,QAAM,IACjBqH,GAAA,+BAEwB,KACd6tC,EAAAA,GAAAA,IAAgB9sC,KAAKpB,MAAMwhC,aAAe,MACpDnhC,GAAA,+BAEwB,KACd2kC,EAAAA,GAAAA,IAAgB5jC,KAAKpB,MAAMwhC,aAAe,MACpDnhC,GAAA,yBAEkB9H,iBAA+D,IAAxDK,EAAsBmD,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAGgsC,EAAAA,GAAiBgG,UAC5D3O,EAAKp/B,MAAMmuC,sBAIV/O,EAAKp/B,MAAMwhC,cAIZpC,EAAKhnC,MAAM4jC,mBAAqBoD,EAAKhnC,MAAM6jC,oBAI3CmD,EAAKgP,iBA1RqB,GA6RtBhP,EAAKhnC,MAAMmzC,iBACXnM,EAAK/9B,SAAS,CAACkqC,iBAAiB,KAKnCnM,EAAKp/B,MAAMqnC,cAAgBzuC,IAASmvC,EAAAA,GAAiBgG,UAE9C3O,EAAKp/B,MAAMwgC,oBAEbpB,EAAKiP,sBAHLjP,EAAKkP,yBAMflP,EAAKgP,kBAAoB,IAC7B,IAAC/tC,GAAA,uBAEgB9H,UACb,GAAI6I,KAAKhJ,MAAM4jC,kBACX,OAIC56B,KAAKhJ,MAAMmzC,kBACZnqC,KAAKgtC,iBAAmB,GAG5B,MAAMG,EAAentC,KAAKotC,yBAC1BptC,KAAKC,SAAS,CAAC26B,mBAAmB,UAC5B56B,KAAK6sC,cAAc7sC,KAAKpB,MAAMhI,UAAWu2C,EAAcxG,EAAAA,GAAiBgG,UAAWvB,GAA2B,IACvHnsC,GAAA,sBAEe9H,UACZ,GAAI6I,KAAKhJ,MAAM6jC,kBACX,OAIC76B,KAAKhJ,MAAMmzC,kBACZnqC,KAAKgtC,iBAAmB,GAG5B,MAAMrJ,EAAe3jC,KAAKqtC,yBAC1BrtC,KAAKC,SAAS,CAAC46B,mBAAmB,UAC5B76B,KAAK6sC,cAAc7sC,KAAKpB,MAAMhI,UAAW+sC,EAAcgD,EAAAA,GAAiBC,SAAUwE,GAA2B,IACtHnsC,GAAA,+BAEwB9H,UACrB,GAAI6I,KAAKhJ,MAAM4jC,kBACX,OAGJ,MAAMuS,EAAentC,KAAKotC,yBAC1BptC,KAAKC,SAAS,CAAC26B,mBAAmB,UAC5B56B,KAAK6sC,cAAc7sC,KAAKpB,MAAMhI,UAAWu2C,EAAcxG,EAAAA,GAAiBgG,UA9UrD,IA8UyF,IArLlH3sC,KAAKhJ,MAAQ,CACT6jC,mBAAmB,EACnBD,mBAAmB,EACnBuP,iBAAiB,GAGrBnqC,KAAKgtC,iBAAmB,EAExBhtC,KAAK4sC,iBAAmB,EACxB5sC,KAAKstC,mBAAqB,CACtB3R,eAAgB37B,KAAKutC,eACrB3R,eAAgB57B,KAAKitC,cACrBvG,iBAAkB1mC,KAAK0mC,iBACvBrB,2BAA4BzmC,EAAMymC,2BAClC2C,sCAAuCppC,EAAMopC,sCAC7ChH,6BAA8BhhC,KAAKpB,MAAMwK,QAAQ43B,6BAEzD,CAEAh8B,iBAAAA,GACIhF,KAAK4gC,SAAU,EACX5gC,KAAKpB,MAAMhI,YACXoJ,KAAKwtC,YAAYxtC,KAAKpB,MAAMhI,WACxBoJ,KAAKpB,MAAMwhC,aACXkL,KAGZ,CAEA/oB,kBAAAA,CAAmBC,GACXxiB,KAAKpB,MAAMhI,YAAc4rB,EAAU5rB,WACnCoJ,KAAKwtC,YAAYxtC,KAAKpB,MAAMhI,WAEF,MAA1BoJ,KAAKpB,MAAMwhC,aAAgD,MAAzB5d,EAAU4d,aAC5CkL,IAA+B,EAEvC,CAEAhmC,oBAAAA,GACItF,KAAK4gC,SAAU,CACnB,CAgJAn7B,MAAAA,GACI,OAAKzF,KAAKpB,MAAMwhC,YAOZ1hC,IAAAA,cAAA,OAAKuD,UAAU,4BACXvD,IAAAA,cAAA,OAAKuD,UAAU,oBACXvD,IAAAA,cAAA,OACI7H,GAAG,6BACHoL,UAAU,sBAEVvD,IAAAA,cAAC+uC,GAAY,CACT5S,kBAAmB76B,KAAKhJ,MAAM6jC,kBAC9BD,kBAAmB56B,KAAKhJ,MAAM4jC,kBAC9BqL,aAAcjmC,KAAKpB,MAAMqnC,aACzB7G,aAAcp/B,KAAKpB,MAAMwgC,aACzBD,cAAen/B,KAAKpB,MAAMugC,cAC1BvoC,UAAWoJ,KAAKpB,MAAMhI,UACtBuzC,gBAAiBnqC,KAAKhJ,MAAMmzC,gBAC5BxJ,gCAAiC3gC,KAAKpB,MAAM+hC,gCAC5Cv3B,QAASpJ,KAAKstC,mBACdlN,YAAapgC,KAAKpB,MAAM8uC,iBACxBlN,oBAAqBxgC,KAAKpB,MAAM4hC,oBAChC5L,aAAc50B,KAAKpB,MAAMg2B,aACzB2L,aAAcvgC,KAAKpB,MAAM2hC,kBAxBrC7hC,IAAAA,cAACoH,GAAAA,EAAa,CAAC6nC,UAAU,GA8BrC,EACH1uC,GA3OoBmlC,GAAQ,aA9FzBsJ,iBAAgB7kC,IAAAA,QAAAA,IAAAA,QAKhBu3B,YAAWv3B,IAAAA,QAAAA,IAAAA,QAKXjS,UAASiS,IAAAA,OAAAC,WAKTq2B,cAAat2B,IAAAA,OAKbu2B,aAAYv2B,IAAAA,KAAAC,WAKZm9B,aAAYp9B,IAAAA,KAKZqjC,YAAWrjC,IAAAA,KAAAC,WAKX03B,oBAAmB33B,IAAAA,OAKnBw8B,2BAA0Bx8B,IAAAA,KAAAC,WAK1BqjC,uBAAsBtjC,IAAAA,KAAAC,WAEtB8rB,aAAY/rB,IAAAA,KAAAC,WAEZy3B,aAAY13B,IAAAA,OAAAC,WAEZk/B,sCAAqCn/B,IAAAA,KAAAC,WACrC63B,gCAA+B93B,IAAAA,KAAAC,WAC/BikC,qBAAoBlkC,IAAAA,KAAAC,WAEpBM,QAAOP,IAAAA,MAAA,CAKHujC,gBAAevjC,IAAAA,KAAAC,WAKfujC,YAAWxjC,IAAAA,KAAAC,WAKX4jC,UAAS7jC,IAAAA,KAAAC,WAKTwjC,mBAAkBzjC,IAAAA,KAAAC,WAMlByjC,gBAAe1jC,IAAAA,KAAAC,WAEf0jC,kBAAiB3jC,IAAAA,KAAAC,WACjBk4B,6BAA4Bn4B,IAAAA,IAAAC,aAAAA,aCxHpC,MAAMojC,GAAcA,CAACl1C,EAAoBJ,KAAuBI,EAAMi3B,SAAS2f,MAAMC,eAAej3C,GAC9Fk3C,IAA0BC,EAAAA,GAAAA,KAAepL,IAAsBiB,EAAAA,GAAAA,IAAgBjB,KA2FrF,IAAetzB,EAAAA,EAAAA,UA9Ef,WACI,MAAM2+B,GAA0BC,EAAAA,GAAAA,MAC1B/K,GAA4BC,EAAAA,GAAAA,MAElC,OAAO,SAAyBnsC,EAAoBymB,GAChD,IACIklB,EACAuL,EAGAR,EALAlN,EAAsB,EAGtBpB,GAAe,EACf6G,GAAe,EAEnB,MAAM,cAAC9G,EAAa,qBAAEgP,EAAoB,UAAEv3C,EAAS,gCAAE+pC,GAAmCljB,EACpF2wB,EAAmBp3C,EAAM6C,MAAM2B,QAC/B+kC,EAAe6N,EAAiB/K,oBAAoBzsC,GACpDu1C,EAAyBiC,EAAiBC,sBAAsBz3C,KAAekZ,GAAAA,GAAcC,QAC7Fu+B,GAAexR,EAAAA,GAAAA,IAAgB9lC,GAC/B+1C,EAAuBtqC,QAAQ6rC,EAAa5oC,SAAS9O,KAAoD,IAArC03C,EAAa5oC,SAAS9O,GAE1F23C,GAAc7R,EAAAA,GAAAA,IAAQ1lC,EAAOmoC,GAAiB,IAGhD+O,EADA/O,QAAiCtkC,IAAhB0zC,EACTP,EAAwBh3C,EAAOmoC,EAAevoC,GAC/Cu3C,IAAyBxN,GACxB6N,EAAAA,GAAAA,IAAoBx3C,EAAOJ,EAAWu3C,IAEtCM,EAAAA,GAAAA,IAA6Bz3C,EAAOJ,GAG5Cs3C,IACAvL,EAAUuL,EAAM77B,MAChB+sB,EAAe38B,QAAQyrC,EAAMQ,QAC7BzI,EAAexjC,QAAQyrC,EAAMS,SAGjC,IAAIC,GAAgC,EAKpC,GAJ4B,MAAxBT,IACAS,EAAgCjO,KAAoCkO,EAAAA,GAAAA,IAAkC73C,EAAOk3C,EAAQC,IAGrHxL,IACA+K,EAAmBxK,EAA0BlsC,EAAO,CAAC2rC,UAASpC,eAAcuO,qBAAsBF,IAC9FjM,EAAQ/nC,QAAQ,CAChB,MAAM+oC,EAAemK,GAAwBnL,GAE7CnC,GADmB9D,EAAAA,GAAAA,IAAQ1lC,EAAO2sC,GACD3M,SACrC,CAGJ,MAAO,CACHuJ,eACA2L,YAAaA,GAAYl1C,EAAOJ,GAChC82C,mBACAtO,eACA6G,eACAzF,sBACAJ,YAAauC,EACbwJ,yBACAxL,kCACA/L,cAAcmF,EAAAA,EAAAA,IAAgB/iC,GAC9B+1C,uBAER,CACJ,IAEA,SAA4Bj2C,GACxB,MAAO,CACHsS,SAASgH,EAAAA,EAAAA,IAAmB,CACxBi8B,YAAW,KACXK,UAAS,IACTH,gBAAe,KACfH,gBAAe,KACfE,mBAAkB,KAClBE,kBAAiB,KACjBxL,6BAA4BA,EAAAA,IAC7BlqC,GAEX,GAEA,CAAgEstC,I,0ZC/FjD,MAAM2K,WAAiBrwC,IAAAA,cAClCK,WAAAA,CAAYH,GACRI,MAAMJ,GAAOK,GAAA,mCA0BakvC,IAC1BnuC,KAAKC,SAAS,CACVkuC,uBACAa,6BAA6B,IAC9B,KACC7jC,OAAO8jC,uBAAsB,KACzBjvC,KAAKC,SAAS,CACV+uC,6BAA6B,GAC/B,GACJ,GACJ,IACL/vC,GAAA,8CAEuC,KACpCe,KAAKC,UAAUjJ,IAAK,CAChBg4C,6BAA6B,EAC7BrO,iCAAkC3pC,EAAM2pC,oCACxC,KACAx1B,OAAO8jC,uBAAsB,KACzBjvC,KAAKC,SAAS,CACV+uC,6BAA6B,GAC/B,GACJ,GACJ,IAhDF,MAAMrO,EAAkC3gC,KAAKpB,MAAMkhC,uBAAyB7Y,EAAAA,GAAY8Y,yCACxF//B,KAAKhJ,MAAQ,CACTm3C,qBAAsBvvC,EAAM2hC,aAC5BI,kCACAqO,6BAA6B,EAC7BE,eAAgBtwC,EAAMswC,eAE9B,CAEA,+BAAOvwC,CAAyBC,EAAc5H,GAC1C,OAAmC,OAA/BA,EAAMm3C,sBAAiCvvC,EAAM2hC,aACtC,CACH4N,qBAAsBvvC,EAAM2hC,cAGhC3hC,EAAMswC,iBAAmBl4C,EAAMk4C,eACxB,CACHf,qBAAsBvvC,EAAM2hC,aAC5B2O,eAAgBtwC,EAAMswC,gBAIvB,IACX,CA4BAzpC,MAAAA,GACI,OAAIzF,KAAKpB,MAAMswC,gBAAkBlvC,KAAKhJ,MAAMg4C,4BAEpCtwC,IAAAA,cAAA,OAAK7H,GAAG,aACJ6H,IAAAA,cAACoH,GAAAA,EAAa,CAAC6nC,UAAU,KAMjCjvC,IAAAA,cAAA,OACI7H,GAAG,YACHuM,KAAK,QAEL1E,IAAAA,cAAC0lC,GAAQ,CACL+J,qBAAsBnuC,KAAKhJ,MAAMm3C,qBACjCv3C,UAAWoJ,KAAKpB,MAAMhI,UACtByuC,2BAA4BrlC,KAAKqlC,2BACjC1E,gCAAiC3gC,KAAKhJ,MAAM2pC,gCAC5CqH,sCAAuChoC,KAAKgoC,sCAC5C7I,cAAen/B,KAAKpB,MAAMugC,gBAI1C,EACHlgC,GA/EoB8vC,GAAQ,aAdzBxO,aAAY13B,IAAAA,OACZqmC,eAAcrmC,IAAAA,KAAAC,WACdlS,UAASiS,IAAAA,OAAAC,WACTq2B,cAAat2B,IAAAA,OACbi3B,qBAAoBj3B,IAAAA,OAAAC,aCiExB,UAAe05B,EAAAA,EAAAA,aAAWnzB,EAAAA,EAAAA,UA1B1B,WACI,OAAO,SAAyBrY,EAAoBymB,GAAiB,IAAA0xB,EACjE,MAAMliB,EAAuB,QAAjBkiB,EAAG1xB,EAASoP,aAAK,IAAAsiB,OAAA,EAAdA,EAAgBliB,OACzB3d,GAAO6d,EAAAA,EAAAA,IAAcn2B,GAAOi2B,aAAM,EAANA,EAAQ3d,OAAQ,IAClD,IAAIkY,EAEJ,MAAMhsB,GAAU2V,EAAAA,EAAAA,GAAWna,EAAOymB,EAAS7mB,WAC3C,IAAI2pC,EAAevpC,EAAM6C,MAAM2B,QAAQ6nC,oBAAoB5lB,EAAS7mB,WAChE4E,IACIA,EAAQhE,OAAS8H,EAAAA,GAAU3D,YAAcH,EAAQwrB,cACjDQ,GAAWa,EAAAA,EAAAA,IAAQrxB,EAAOwE,EAAQwrB,cAEtCuZ,EAAe/kC,EAAQ4zC,aAAe7O,EAAe/kC,EAAQ4zC,cAGjE,MACMF,EAjDkBG,EAACpiB,EAAyBzxB,EAAmB8T,EAAakY,EAAwB8nB,KAAqD,IAAAC,EACnK,GAAItiB,EAAOuiB,OACP,OAAO,EAGX,MAAMxiB,EAA8B,QAApBuiB,EAAGtiB,EAAOD,kBAAU,IAAAuiB,OAAA,EAAjBA,EAAmB1uC,cAEtC,GAAIrF,GAAW8T,EAAM,CACjB,GAAI9T,EAAQhE,OAAS8H,EAAAA,GAAU3D,YAAcH,EAAQ2G,OAAS6qB,EAC1D,OAAO,EACJ,GAAIxxB,EAAQhE,OAAS8H,EAAAA,GAAU3D,YAAc6rB,GAAYwF,IAAe,IAALtsB,OAAS8mB,EAASU,UACxF,OAAO,EAGX,MAAMzuB,EAAS6V,EAAKzY,GACpB,SAAK2E,EAAQkQ,SAAWlQ,EAAQkQ,UAAYjS,GAAY61C,IAAoBA,EAAgB71C,GAKhG,CAEA,OAAO,CAAI,EA2BgB41C,CAAiBpiB,EAASzxB,EAAS8T,EAAMkY,GADxCioB,EAAAA,EAAAA,IAAmBz4C,IAG3C,MAAO,CACH8oC,sBAFyBwD,EAAAA,EAAAA,IAAkCtsC,GAG3DupC,eACA2O,iBAER,CACJ,GAE0B7/B,CAA6B0/B,K,eC3EvD,MAAMW,GAAiBA,KACnBtT,SAASuT,QAAQ,EAUfC,GAAe58B,IAER,IAFS,oBAClB68B,GACI78B,EACJ,MAAO88B,EAAaC,IAAkBn9B,EAAAA,EAAAA,WAAS,GAiB/C,OAfAC,EAAAA,EAAAA,YAAU,KACN,IAAIm9B,EAAUrsC,YAAW,KACrBosC,GAAe,GACfF,GAAoB,GACpBG,EAAUrsC,YAAW,KACjBksC,GAAoB,EAAM,GAhBlB,IAiBO,GAlBV,KAqBb,MAAO,KACH/kC,aAAaklC,GACbH,GAAoB,EAAM,CAC7B,GACF,IAGCnxC,IAAAA,cAAA,OACIuD,UAAU,gCAET6tC,GACGpxC,IAAAA,cAAAA,IAAAA,SAAA,KACIA,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,2CACH6K,eAAe,sGAEnBhD,IAAAA,cAAA,UACIuD,UAAU,+CACVM,QAASmtC,IAEThxC,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,0BACH6K,eAAe,aAK7B,EAEZkuC,GAAAr1B,UAAA,CA9CEs1B,oBAAmBhnC,IAAAA,KAAAC,YAgDvB,Y,89BC5CA,MAAMmnC,IAAgBC,EAAAA,EAAAA,GAAmB,iBAAiBC,EAAAA,EAAAA,OAAK,IAAM,8GAC/DC,IAAoBF,EAAAA,EAAAA,GAAmB,qBAAqBC,EAAAA,EAAAA,OAAK,IAAM,2CACvEE,IAAmBH,EAAAA,EAAAA,GAAmB,oBAAoBC,EAAAA,EAAAA,OAAK,IAAM,4DACrEG,IAAqBJ,EAAAA,EAAAA,GAAmB,sBAAsBC,EAAAA,EAAAA,OAAK,IAAM,mCACzEI,IAAgBL,EAAAA,EAAAA,GAAmB,iBAAiBC,EAAAA,EAAAA,OAAK,IAAM,mCActD,MAAMK,WAAoB9xC,IAAAA,cAcrC,+BAAOC,CAAyBC,EAAc5H,GAC1C,IAAIy5C,EAAe,CAAC,EACpB,MAAMtR,EAAgBvgC,EAAMiuB,MAAMI,OAAOuiB,OAczC,OAZI5wC,EAAMiuB,MAAMyC,MAAQt4B,EAAMs4B,KAAO1wB,EAAMhI,YAAcI,EAAMJ,YAC3D65C,EAAe,CAACC,iBAAkBF,GAAYG,yBAA0BrhB,IAAK1wB,EAAMiuB,MAAMyC,IAAK6P,kBAG9FvgC,EAAMhI,YAAcI,EAAMJ,YAC1B65C,EAAYtkB,GAAAA,GAAA,GAAOskB,GAAY,IAAE75C,UAAWgI,EAAMhI,UAAWuoC,mBAG7DA,GAAiBA,IAAkBnoC,EAAMmoC,gBACzCsR,EAAYtkB,GAAAA,GAAA,GAAOskB,GAAY,IAAEtR,mBAGjC5sB,OAAOC,KAAKi+B,GAAc71C,OACnB61C,EAGJ,IACX,CAIA1xC,WAAAA,CAAYH,GACRI,MAAMJ,GAAOK,GAAA,4BAaK,KAClBe,KAAKpB,MAAMgyC,uBAAuB,IACrC3xC,GAAA,gCAE0By2B,IACvB11B,KAAKC,SAAS,CAAC4wC,cAAenb,GAAG,IAhBjC11B,KAAKhJ,MAAQ,CACTs4B,IAAK1wB,EAAMiuB,MAAMyC,IACjB14B,UAAWgI,EAAMhI,UACjBuoC,cAAevgC,EAAMiuB,MAAMI,OAAOuiB,OAClCkB,iBAAkBF,GAAYG,yBAC9BE,eAAe,GAGnB7wC,KAAK8wC,eAAiBpyC,IAAAA,WAC1B,CAUA6jB,kBAAAA,CAAmBC,GAEXA,EAAU5rB,YAAcoJ,KAAKpB,MAAMhI,WAAaoJ,KAAKpB,MAAMmyC,2BAC3DC,GAAAA,EAAgBC,oBAAoBjxC,KAAKpB,MAAMhI,WAI/CoJ,KAAKpB,MAAMsyC,+BAAiEr2C,IAArCmF,KAAKpB,MAAMuyC,uBAClDnxC,KAAKpB,MAAMwyC,oBAAoBpxC,KAAKpB,MAAMhI,UAElD,CAEA6O,MAAAA,GACI,IAAI4rC,EAEAA,EADArxC,KAAKpB,MAAM0yC,mBAEP5yC,IAAAA,cAAA,OACIuD,UAAU,iDACVpL,GAAG,eAEH6H,IAAAA,cAAA,OACIuD,UAAU,6BAEVvD,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,iDACH6K,eAAe,qGACf2B,OAAQ,CACJhH,EAAIkb,GAAW7Y,IAAAA,cAAA,SAAI6Y,MAG3B7Y,IAAAA,cAAA,UACIuD,UAAU,8CACVM,QAASvC,KAAKuxC,qBAEd7yC,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,qCACH6K,eAAe,qBAM5B1B,KAAKpB,MAAM20B,kBAEd70B,IAAAA,cAAA,OACIuD,UAAU,yBACVpL,GAAG,eAEH6H,IAAAA,cAAA,OACI7H,GAAG,yBACHoL,UAAU,6BAEVvD,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,8BACH6K,eAAe,6EACf2B,OAAQ,CACJhH,EAAIkb,GAAW7Y,IAAAA,cAAA,SAAI6Y,MAG3B7Y,IAAAA,cAAA,UACIuD,UAAU,8CACVM,QAASvC,KAAKuxC,qBAEd7yC,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,qCACH6K,eAAe,qBAM5B1B,KAAKpB,MAAMuyC,sBAEdzyC,IAAAA,cAAA,OACIuD,UAAU,yBACVpL,GAAG,eAEH6H,IAAAA,cAAA,OACI7H,GAAG,sBACHoL,UAAU,6BAEVvD,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,2BACH6K,eAAe,wFACf2B,OAAQ,CACJhH,EAAIkb,GAAW7Y,IAAAA,cAAA,SAAI6Y,MAG3B7Y,IAAAA,cAAA,UACIuD,UAAU,8CACVM,QAASvC,KAAKuxC,qBAEd7yC,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,yCACH6K,eAAe,qBAM5B1B,KAAKpB,MAAM4yC,oBAAsBxxC,KAAKhJ,MAAM65C,cACtCnyC,IAAAA,cAACkxC,GAAY,CAACC,oBAAqB7vC,KAAKyxC,0BAGjD/yC,IAAAA,cAAA,OACI7H,GAAG,cACH,cAAY,cACZoL,UAAU,kDAEVvD,IAAAA,cAAC4xC,GAAkB,OAK/B,MAAMoB,EAAmB1xC,KAAKhJ,MAAM05C,iBAEpC,OACIhyC,IAAAA,cAAA,OACIiI,IAAK3G,KAAK8wC,eACVj6C,GAAG,cACHoL,UAAU,gBAEVvD,IAAAA,cAAC0xC,GAAiB,CACduB,YAAY,SACZ96C,GAAI+6C,GAAAA,KAERlzC,IAAAA,cAACuxC,GAAa,MACbjwC,KAAKpB,MAAMizC,2BAA6BnzC,IAAAA,cAAC2xC,GAAgB,CAACz5C,UAAWoJ,KAAKpB,MAAMhI,YACjF8H,IAAAA,cAAC6xC,GAAa,CAAC35C,UAAWoJ,KAAKpB,MAAMhI,YACrC8H,IAAAA,cAACgzC,EAAgB,CACb96C,UAAWoJ,KAAKpB,MAAMhI,UACtBuoC,cAAen/B,KAAKhJ,MAAMmoC,gBAE7BkS,EAGb,EACHpyC,GAtMoBuxC,GAAW,0BACW,KAC5BsB,EAAAA,GAAAA,GACH/C,GACArwC,IAAAA,cAAA,OACI7H,GAAG,YACHoL,UAAU,eACV,uBAAqB,IACrB,yBAAuB,EACvB,4BAA0B,OCc1C,MAAM2e,GAAsB,CACxBgwB,sBAAqB,KACrBQ,oBAAmBA,EAAAA,IAGjBxoB,IAAYvZ,EAAAA,EAAAA,UA/BlB,SAAyBrY,GACrB,MAAMwE,GAAUy9B,EAAAA,EAAAA,IAAkBjiC,GAE5B8tB,GAASnT,EAAAA,EAAAA,IAAU3a,GAEnB+6C,EAAuD,SAAhCjtB,EAAOc,qBAC9BmrB,EAAsE,SAA1CjsB,EAAOktB,+BAEnCR,EAbV,SAA+Bx6C,EAAoBwE,GAAmB,IAAAy2C,EAElE,QADqBz2C,IAAmD,QAAzCy2C,GAAApe,EAAAA,EAAAA,IAAuB78B,EAAOwE,EAAQ3E,WAAG,IAAAo7C,OAAA,EAAzCA,EAA2C96B,QAAc,IACnE+6B,MAAM,KAAKC,MAAMzc,GAAMjzB,SAAQ2vC,EAAAA,GAAAA,IAASp7C,GAAO0+B,KACxE,CAU+B2c,CAAsBr7C,EAAOwE,GAExD,MAAO,CACH5E,UAAW4E,EAAUA,EAAQ3E,GAAK,GAClCy6C,qBAAoB91C,IAAU82C,EAAAA,EAAAA,IAA2Bt7C,EAAOwE,EAAQ3E,IACxEk7C,uBACAxe,oBAAmB/3B,GAAgC,IAAtBA,EAAQuQ,UACrCwmC,QAAqC,UAA5BtgC,EAAAA,EAAAA,IAAWjb,GAAOw7C,MAC3BC,SAASC,EAAAA,EAAAA,IAA0B17C,GACnC27C,cAAcA,EAAAA,EAAAA,IAAa37C,GAC3B+5C,4BACAG,yBAA2D,SAAjCpsB,EAAO8tB,wBAAuD,OAAlBp3C,aAAO,EAAPA,EAAShE,OAAkC,OAAlBgE,aAAO,EAAPA,EAAShE,OACxG25C,wBAAuB31C,GAAUxE,EAAMi3B,SAASvoB,SAASmtC,cAAcr3C,EAAQ3E,IAC/Eg7C,2BAA2B//B,EAAAA,GAAAA,IAA6B9a,GACxDw6C,qBAER,GAO2C5wB,IAI3C,IAAe4hB,EAAAA,EAAAA,YAAW5Z,GAAU4nB,KCnEpC,SAAAvxC,GAAAC,EAAAqyB,EAAAuhB,GAAA,OAAAvhB,EAAA,SAAAuhB,GAAA,IAAAC,EAAA,SAAAD,GAAA,oBAAAA,IAAAA,EAAA,OAAAA,EAAA,IAAA5zC,EAAA4zC,EAAAE,OAAAC,aAAA,YAAA/zC,EAAA,KAAA6zC,EAAA7zC,EAAA00B,KAAAkf,EAAAvhB,UAAA,oBAAAwhB,EAAA,OAAAA,EAAA,UAAAG,UAAA,uDAAAC,OAAAL,EAAA,CAAAM,CAAAN,GAAA,uBAAAC,EAAAA,EAAAA,EAAA,GAAAM,CAAA9hB,MAAAryB,EAAAqT,OAAA+gC,eAAAp0C,EAAAqyB,EAAA,CAAAhtB,MAAAuuC,EAAAS,YAAA,EAAAC,cAAA,EAAAC,UAAA,IAAAv0C,EAAAqyB,GAAAuhB,EAAA5zC,CAAA,CA4Be,MAAMw0C,WAAgCh1C,IAAAA,cACjDK,WAAAA,CAAYH,GACRI,MAAMJ,GAAOK,GAAA,8BA0BO,KAChBe,KAAKpB,MAAMiuB,MAAMI,OAAOuiB,SACxBxvC,KAAK2zC,kBAAoBhwC,YAAW,KAChC,MAAMiwC,EAAa5zC,KAAKpB,MAAMiuB,MAAMyC,IAAI4iB,MAAM,KAAK3zC,MAAM,GAAI,GAAGkwB,KAAK,MACrE9jB,EAAAA,GAAAA,KAAamkB,QAAQ8kB,EAAW,GACjCt0C,EAAAA,GAAUu0C,mBACjB,IA9BA7zC,KAAKhJ,MAAQ,CACTwrB,UAAW5jB,EAEnB,CAIA2jB,kBAAAA,CAAmBC,GACXxiB,KAAKpB,MAAMiuB,MAAMI,OAAO3d,OAASkT,EAAUqK,MAAMI,OAAO3d,MACxDtP,KAAKpB,MAAMiuB,MAAMI,OAAOD,aAAexK,EAAUqK,MAAMI,OAAOD,aAC9DliB,aAAa9K,KAAK2zC,mBAClB3zC,KAAKpB,MAAMwK,QAAQwjB,2BAA2B5sB,KAAKpB,OACnDoB,KAAK8zC,wBAEb,CACA9uC,iBAAAA,GACIhF,KAAKpB,MAAMwK,QAAQwjB,2BAA2B5sB,KAAKpB,OACnDoB,KAAK8zC,uBACT,CAEAxuC,oBAAAA,GACIwF,aAAa9K,KAAK2zC,kBACtB,CAWAluC,MAAAA,GACI,OAAO/G,IAAAA,cAAC8xC,GAAW,KACvB,EACHvxC,GAxCoBy0C,GAAuB,aANxCtqC,QAAOP,IAAAA,MAAA,CACH+jB,2BAA0B/jB,IAAAA,KAAAC,aAAAA,aCLlC,UAAe05B,EAAAA,EAAAA,aAAWnzB,EAAAA,EAAAA,SAAQ,MARlC,SAA4BvY,GACxB,MAAO,CACHsS,SAASgH,EAAAA,EAAAA,IAAmB,CACxBwc,2BAA0BA,IAC3B91B,GAEX,GAE0BuY,CAAkCqkC,K,gBCH5D,MAAMK,IAAsB7D,EAAAA,EAAAA,GAAmB,uBAAuBC,EAAAA,EAAAA,OAAK,IAAM,0FAC3E6D,IAAgB9D,EAAAA,EAAAA,GAAmB,iBAAiBC,EAAAA,EAAAA,OAAK,IAAM,kCAE7DzxC,IAAAA,cAAA,OAAKuD,UAAU,gBACXvD,IAAAA,cAACoH,GAAAA,EAAa,QAIpBmuC,IAAS/D,EAAAA,EAAAA,GAAmB,UAAUC,EAAAA,EAAAA,OAAK,IAAM,kCAE/CzxC,IAAAA,cAAA,OAAKuD,UAAU,gBACXvD,IAAAA,cAACoH,GAAAA,EAAa,QAIpBouC,IAAgBhE,EAAAA,EAAAA,GAAmB,iBAAiBC,EAAAA,EAAAA,OAAK,IAAM,mCAC/DgE,IAAiBjE,EAAAA,EAAAA,GAAmB,kBAAkBC,EAAAA,EAAAA,OAAK,IAAM,mCASxD,MAAMiE,WAAsB11C,IAAAA,cACvCK,WAAAA,CAAYH,GACRI,MAAMJ,GACNoB,KAAKhJ,MAAQ,CACTq9C,SAAU,GACVC,aAAc,GAEtB,CAEA,+BAAO31C,CAAyB41C,EAAkB1U,GAC9C,OAAIA,EAAUyU,eAAiBC,EAAUnY,SAASoY,UAAYD,EAAUnY,SAASoY,SAASv/B,SAAS,QACxF,CACHq/B,aAAcC,EAAUnY,SAASoY,SACjCH,SAAUxU,EAAUyU,cAGrB,CAACA,aAAcC,EAAUnY,SAASoY,SAC7C,CAEA,uBAAMxvC,GACF,MAAM,QAACoE,GAAWpJ,KAAKpB,YACjBwK,EAAQqrC,aAClB,CAEAhvC,MAAAA,GACI,MAAM,gBAACivC,EAAe,0BAAEvU,EAAyB,aAAEvL,GAAgB50B,KAAKpB,MAClE0wB,EAAMtvB,KAAKpB,MAAMiuB,MAAMyC,IAE7B,OACI5wB,IAAAA,cAAA,OACIyE,IAAI,aACJlB,UAAWI,IAAW,aAAc,gBAAiB,CACjD,cAAerC,KAAKpB,MAAM+1C,QAC1B,aAAc30C,KAAKpB,MAAM8K,QACzB,mBAAoB1J,KAAKpB,MAAMg2C,eAGlChgB,GAAgBl2B,IAAAA,cAACq1C,GAAmB,MACrCr1C,IAAAA,cAAA,OAAKuD,UAAU,YACXvD,IAAAA,cAACm2C,EAAAA,OAAM,KACHn2C,IAAAA,cAACo2C,EAAAA,MAAK,CACF/nB,KAAI,GAAArsB,OAAK4uB,EAAG,gBAAA5uB,OAAeq0C,GAAAA,GAAe,KAC1CtvC,OAAS7G,GACLF,IAAAA,cAACw1C,GAAa3hC,OAAAuI,OAAA,GACNlc,EAAK,CACTy1C,SAAUr0C,KAAKhJ,MAAMq9C,cAIjC31C,IAAAA,cAACo2C,EAAAA,MAAK,CACF/nB,KAAI,UAAArsB,OAAYs0C,GAAAA,GAAsB,2CAAAt0C,OAA0Cu0C,GAAAA,EAAuB,cAAAv0C,OAAaq0C,GAAAA,GAAe,MACnIhrB,UAAW2pB,KAEfh1C,IAAAA,cAACo2C,EAAAA,MAAK,CACF/nB,KAAI,UAAArsB,OAAYs0C,GAAAA,GAAsB,6BAAAt0C,OAA4Bq0C,GAAAA,GAAe,UAEjFr2C,IAAAA,cAACy1C,GAAc,OAElBhU,EACGzhC,IAAAA,cAACo2C,EAAAA,MAAK,CACF/nB,KAAI,UAAArsB,OAAYs0C,GAAAA,GAAsB,gCAAAt0C,OAA+Bq0C,GAAAA,GAAe,MACpFhrB,UAAWiqB,KAEf,KACJt1C,IAAAA,cAACo2C,EAAAA,MAAK,CACF/nB,KAAI,UAAArsB,OAAYs0C,GAAAA,GAAsB,YACtCjrB,UAAWkqB,KAEfv1C,IAAAA,cAACo2C,EAAAA,MAAK,CACF/nB,KAAI,UAAArsB,OAAYs0C,GAAAA,GAAsB,MAAAt0C,OAAKw0C,EAAAA,IAC3CnrB,UAAWkqB,KAGfv1C,IAAAA,cAACy2C,EAAAA,SAAQ,CAAC5wB,GAAImwB,MAKlC,EC3CJ,MAAM9rB,IAAYvZ,EAAAA,EAAAA,UA3CM+lC,CAACp+C,EAAoBymB,KACzC,MAAM43B,GAAiBC,EAAAA,EAAAA,IAA4Bt+C,EAAOymB,EAASoP,MAAMI,OAAO3d,MAChF,IAAIhM,GAAciyC,EAAAA,EAAAA,IAAmCv+C,EAAOymB,EAASoP,MAAMI,OAAO3d,MAElF,MAAMkmC,GAAiBC,EAAAA,EAAAA,IAAkBz+C,GACnCsY,GAAO6d,EAAAA,EAAAA,IAAcn2B,EAAOymB,EAASoP,MAAMI,OAAO3d,MAExD,IAAIomC,EAUAhB,EAOJ,OAfIc,KAAmBlmC,aAAI,EAAJA,EAAMzY,MACzB6+C,GAA6BC,EAAAA,EAAAA,IAA8B3+C,IAG1DsM,IACDA,GAAcglB,EAAAA,EAAAA,IAA8BtxB,EAAOsY,EAAMzY,KAOzD69C,IAHAvU,EAAAA,EAAAA,IAA0BnpC,IAAW0+C,IAA+BE,EAAAA,GAAoBC,SAAWR,IAAmBO,EAAAA,GAAoBC,QAGxH,GAAHn1C,OAAM+c,EAASoP,MAAMyC,IAAG,cAAA5uB,OAAa4C,GAFlC,GAAH5C,OAAM+c,EAASoP,MAAMyC,IAAG,YAKpC,CACHolB,kBACAC,SAASmB,EAAAA,EAAAA,IAAa9+C,GACtB0S,SAASwG,EAAAA,EAAAA,GAAalZ,GACtB49C,aAAamB,EAAAA,EAAAA,IAAiB/+C,GAC9BmpC,2BAA2BA,EAAAA,EAAAA,IAA0BnpC,GACrDuT,eAAemF,EAAAA,EAAAA,IAAiB1Y,GAChC49B,cAAcmF,EAAAA,EAAAA,IAAgB/iC,GACjC,IAGL,SAA4BF,GACxB,MAAO,CACHsS,SAASgH,EAAAA,EAAAA,IAAmB,CACxBqkC,YAAWA,EAAAA,IACZ39C,GAEX,IAMA,IAAe0rC,EAAAA,EAAAA,YAAW5Z,GAAUwrB,K,kCC/BpC,SA9BA,WACI,MAAMhY,GAAW4Z,EAAAA,EAAAA,eACXl/C,GAAWsb,EAAAA,EAAAA,eACX0a,GAAUmpB,EAAAA,EAAAA,cAEVC,EAAuB,CACzBC,sBAAuB,CACnB7sC,QAAShJ,EAAAA,GAAiBsyB,WAC1BppB,WAAYqpB,GAAAA,UAmBpB,OAfAhgB,EAAAA,EAAAA,YAAU,KACN,MAAMujC,EAAe,IAAIC,gBAAgBja,EAASl4B,QAC5C8M,EAASolC,EAAa9c,IAAI,UAE5BtoB,GAAUklC,EAAUllC,KACpBla,GAASuS,EAAAA,GAAAA,GAAU6sC,EAAUllC,KAG7BolC,EAAaE,OAAO,UACpBxpB,EAAQgC,QAAQ,CACZ5qB,OAAQkyC,EAAa/pC,aAE7B,GACD,CAAC+vB,EAAU8Z,IAEP,IACX,E,mjCCxC6D,IAExDK,GAAQ,SAARA,GAAQ,OAARA,EAAAA,EAAQ,eAARA,EAAAA,EAAQ,mBAARA,EAAAA,EAAQ,aAARA,CAAQ,EAARA,IAAQ,IAMRC,GAAc,SAAdA,GAAc,OAAdA,EAAAA,EAAc,4BAAdA,EAAAA,EAAc,0BAAdA,CAAc,EAAdA,IAAc,IAWZ,MAAMC,IAAgB1I,EAAAA,GAAAA,KAAc,CACvC2I,EACAC,EACAC,KAEA,MAAMC,EAAsBH,EAAe97C,OAC3C,IAAIV,EAIA,CACA,CAACq8C,GAASO,MAAO,GACjB,CAACP,GAASQ,QAAS,GACnB,CAACR,GAASS,KAAM,IAEpB,IAAKH,GAAuBA,EAAsBL,GAAeS,UAC7D,OAAO/8C,EAEX,IAAK,MAAMsB,KAAWk7C,EAAgB,CAClC,MAAM9/C,EAAY4E,EAAQ3E,GACpBs3B,EAAawoB,EAAY//C,GAE/B,GAAIigD,GAAuBL,GAAeU,YAAch9C,EAAOq8C,GAASO,MAAMl8C,QAAU47C,GAAeU,WACnG,MAKA/oB,KAAelN,EAAAA,GAAAA,IAAekN,MAC1ByoB,EAAmBzoB,EAAWgpB,mBAAqBhpB,EAAWipB,eAC9Dl9C,EAAMiyB,GAAAA,GAAA,GACCjyB,GAAM,IACT,CAACq8C,GAASO,MAAO,IAAI58C,EAAOq8C,GAASO,MAAOlgD,KAGhDu3B,EAAWiK,cAC6B,YAAxCjK,EAAWiK,aAAaif,aACxBR,EAAsBL,GAAeU,aAErCh9C,EAAMiyB,GAAAA,GAAA,GACCjyB,GAAM,IACT,CAACq8C,GAASQ,QAAS,IAAI78C,EAAOq8C,GAASQ,QAASngD,MAIhE,CACA,OAAOsD,CAAM,I,sbC1DjB,MAAMo9C,GAAQ,IAAIC,GAAAA,EAAO,CAACC,YAAa,IAsCxB,MAAMC,WAAqB/4C,IAAAA,cAA2BK,WAAAA,GAAA,SAAApE,WAAAsE,GAAA,sBAmBzCrI,IACpB,IAAI8gD,EACJ,MAAMl8C,EAAUwE,KAAKpB,MAAM83C,eAAet7C,MAAMu8C,GAAkB/gD,IAAc+gD,EAAc9gD,KAO9F,OANI2E,GAAYA,EAAQhE,OAAS8H,EAAAA,GAAUuM,iBAAmBrQ,EAAQhE,OAAS8H,EAAAA,GAAUwM,cACtDgzB,KAAKqI,MAAQ3rC,EAAQ4zC,cAAiB,MAEjEsI,EAAwB,IAAhBx6C,KAAK06C,UAGd53C,KAAKpB,MAAMwK,QAAQyuC,qBAAqBjhD,EAAW8gD,EAAM,IACnEz4C,GAAA,qBAEsB,KACnB,MAAM,sBAAC64C,EAAqB,iBAAEC,GAAoB/3C,KAAKpB,MACvD,IAAK,MAAMo5C,KAAYD,EAAkB,CACrC,IAAKxlC,OAAO0lC,OAAOF,EAAkBC,GACjC,SAGJ,MAAME,EAAgBH,EAAiBC,GACvC,IAAK,MAAMphD,KAAashD,EACf3lC,OAAO0lC,OAAOH,EAAuBlhD,IACtC0gD,GAAMa,KAAIhhD,SAAY6I,KAAKo4C,cAAcxhD,IAGrD,IACH,CA1CD,wBAAM2rB,CAAmBC,GACrB,MAAM,iBAACnF,EAAgB,iBAAE06B,EAAgB,cAAEM,GAAiBr4C,KAAKpB,MAC7Dy5C,IAAkB71B,EAAU61B,gBAC5BC,EAAAA,GAAAA,OAGAj7B,IAAoBg7B,GAAmB71B,EAAUnF,kBAAqBmF,EAAU61B,cAGzE71B,EAAUu1B,mBAAqBA,IACtCjtC,aAAa9K,KAAKu4C,uBACZjB,GAAMkB,QACZx4C,KAAKy4C,iBALLnB,GAAMa,KAAIhhD,SAAY6I,KAAKo4C,cAAc/6B,KACzCrd,KAAKy4C,eAMb,CA8BAhzC,MAAAA,GACI,OAAO,IACX,EClFJ,SAASizC,GAAgB1hD,GACrB,OAAO+D,EAAAA,GAAAA,IAA4B/D,GAAO4D,OAAS,CACvD,CDiFCqE,GAlDoBw4C,GAAY,aAnC7Bp6B,iBAAgBxU,IAAAA,OAAAC,WAChBivC,iBAAgBlvC,IAAAA,SAAAA,IAAAA,QAAAA,IAAAA,SAAAC,WAChBgvC,sBAAqBjvC,IAAAA,SAAAA,IAAAA,QAAAC,WAGrBuvC,cAAaxvC,IAAAA,KAAAC,WAEb4tC,eAAc7tC,IAAAA,MAAAC,WAEdM,QAAOP,IAAAA,MAAA,CACHgvC,qBAAoBhvC,IAAAA,KAAAC,aAAAA,aCoB5B,UAAeuG,EAAAA,EAAAA,UAxBf,SAAyBrY,GACrB,MAAM2hD,EAAoB3hD,EAAM6C,MAAM2B,QAAQm9C,kBACxChC,GAAc3mC,EAAAA,EAAAA,IAAwBhZ,GACtC0/C,GAAiBkC,EAAAA,EAAAA,IAAkB5hD,EAAO2hD,GAC1CZ,EAAmBtB,GAAcC,EAAgBC,GAAaxW,EAAAA,EAAAA,IAA0BnpC,IACxF8gD,EAAwB9gD,EAAM6C,MAAM2B,QAAQ6yC,sBAElD,MAAO,CACHhxB,kBAAkB5f,EAAAA,EAAAA,IAAoBzG,GACtC+gD,mBACAD,wBACAO,cAAeK,GAAgB1hD,GAC/B0/C,iBAER,IAEA,SAA4B5/C,GACxB,MAAO,CACHsS,SAASgH,EAAAA,EAAAA,IAAmB,CACxBynC,qBAAoBA,EAAAA,IACrB/gD,GAEX,GAEA,CAA4D2gD,I,2BClC5D,SAASoB,GAAY7lC,GAIX,IAJY,SAClB/K,EAAQ,GACRpR,EAAE,UACFoL,GACI+Q,EACJ,MAAM8lC,GAAeh6B,EAAAA,EAAAA,QAAuB,MAE5C,OACIpgB,IAAAA,cAAA,OACI7H,GAAIA,EACJoL,UAAWA,EACX0E,IAAKmyC,GAEJ7wC,EACDvJ,IAAAA,cAACq6C,GAAAA,EAAgB,CACb52C,KAAM,kBACN62C,aAAcC,GAAAA,GAAsBC,IACpCC,aAAcC,GAAAA,GACdC,IAAKC,GAAAA,GAAgBC,KACrBT,aAAcA,IAI9B,CAACD,GAAAt+B,UAAA,CA1BGtS,SAAQY,IAAAA,KAAAC,YA4BZ,Y,qICae,SAAS0wC,GAAgB56C,GAAc,IAAA66C,EAClD,MAAMznC,GAAUf,EAAAA,EAAAA,aAAYgB,EAAAA,IACtB6S,GAAS7T,EAAAA,EAAAA,aAAYU,EAAAA,IAErB+nC,GAA6BzoC,EAAAA,EAAAA,cAAaja,IAAuB2iD,EAAAA,GAAAA,IAAsB3iD,EAAO,CAACua,WAAYtD,GAAAA,GAAY2rC,gBACvHC,GAA6B5oC,EAAAA,EAAAA,cAAaja,IAAuB8iD,EAAAA,GAAAA,IAA2B9iD,EAAOiX,GAAAA,GAAY8rC,eAC/GC,GAAgC/oC,EAAAA,EAAAA,cAAaja,IAAuB8iD,EAAAA,GAAAA,IAA2B9iD,EAAOiX,GAAAA,GAAYqkB,oBAClH2nB,GAA8BhpC,EAAAA,EAAAA,cAAaja,IAAuB8iD,EAAAA,GAAAA,IAA2B9iD,EAAOiX,GAAAA,GAAYskB,gBAChHggB,GAAU2H,EAAAA,GAAAA,IAAeloC,GACzBmoC,EAAuD,UAAhCr1B,aAAM,EAANA,EAAQs1B,qBAC/BC,EAAyB53C,QAAyB,QAAlBg3C,EAAC76C,EAAM+U,mBAAW,IAAA8lC,OAAA,EAAjBA,EAAmBltB,mBACpD+tB,EAAkD,UAAxBtoC,aAAO,EAAPA,EAAS2Z,YACnC4uB,EAA0Bz1B,EAAO01B,wBACjCC,GAAgBxpC,EAAAA,EAAAA,aAAYypC,EAAAA,IAC5BC,GAAwBF,aAAa,EAAbA,EAAe7/C,QAAS,EAChDggD,GAAsBL,GAA2BI,EAEjDE,EAAcj8C,EAAM+U,YAAYmnC,YAAcl8C,EAAM+U,YAAYmnC,YAAcl8C,EAAM+U,YAAYhT,aAEtG,OACIjC,IAAAA,cAAC2I,GAAAA,GAAc,CACXQ,WAAY,CACRhR,GAAI,wBACJ+kB,MAAO,yCACP3T,SACIvJ,IAAAA,cAAAA,IAAAA,SAAA,KACIA,IAAAA,cAAA,YAAOE,EAAM+U,YAAYhT,cACzBjC,IAAAA,cAAA,KAAGuD,UAAU,6BAIzB6Z,kBAAmB,CACfjZ,KAAMg4C,GAEV3yC,KAAM,CACFrR,GAAI,qBAGLsjD,GAAwBF,GAAgCD,IACvDt7C,IAAAA,cAACq8C,GAAoB,MAExBV,GAA0BC,GAA2BT,GAClDn7C,IAAAA,cAACs8C,GAAuB,MAE3BnB,GACGn7C,IAAAA,cAACu8C,GAAoB,MAEzBv8C,IAAAA,cAACw8C,GAAyB,MACxBb,GAA0BC,GAA2BT,GACnDn7C,IAAAA,cAACy8C,GAAoB,CACjBC,OAAQx8C,EAAM+U,YAAY9c,MAG/BwjD,GAA0BE,IAA4B37C,EAAM+U,YAAYxR,MACvEzD,IAAAA,cAAC28C,GAAiB,OAEpBT,GAAsBlB,IAA+Bh7C,IAAAA,cAAC2I,GAAAA,GAAc,MACrEuzC,GACGl8C,IAAAA,cAAC48C,GAAuB,MAE3B5B,GACGh7C,IAAAA,cAAC68C,GAAkB,CACfhJ,QAASA,IAGjB7zC,IAAAA,cAAC2I,GAAAA,GAAc,MACf3I,IAAAA,cAAC88C,GAAuB,MACxB98C,IAAAA,cAAC+8C,GAAe,MAG5B,CAEA,SAASV,GAAqBn8C,GAC1B,MAAM9H,GAAWsb,EAAAA,EAAAA,eAEXspC,GAAc7gC,EAAAA,EAAAA,cAAY,KAC5B/jB,GAASuS,EAAAA,GAAAA,GAAU,CACfC,QAAShJ,EAAAA,GAAiBsyB,WAC1BppB,WAAYqpB,GAAAA,QACZ1e,YAAa,CACT2e,mBAAoB,2BAEzB,GACJ,CAACh8B,IAEJ,OACI4H,IAAAA,cAAC2I,GAAAA,GAASkL,OAAAuI,OAAA,CACNvY,QAASm5C,EACTl0C,eACI9I,IAAAA,cAACi9C,GAAAA,+BAA8B,CAC3B16C,KAAM,GACN,cAAY,SAGpByG,OACIhJ,IAAAA,cAAAA,IAAAA,SAAA,KACIA,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,yDACH6K,eAAe,kBAEnBhD,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,2DACH6K,eAAe,sCAI3B,gBAAc,UACV9C,GAGhB,CAEA,SAASo8C,GAAwBp8C,GAC7B,MAAM9H,GAAWsb,EAAAA,EAAAA,eAEXspC,GAAc7gC,EAAAA,EAAAA,cAAY,KAC5B/jB,GAASuS,EAAAA,GAAAA,GAAU,CACfC,QAAShJ,EAAAA,GAAiB81B,mBAC1B5sB,WAAY6sB,GAAAA,EACZliB,YAAa,CACT2e,mBAAoB,2BAEzB,GACJ,CAACh8B,IAEJ,OACI4H,IAAAA,cAAC2I,GAAAA,GAASkL,OAAAuI,OAAA,CACNvY,QAASm5C,EACTl0C,eACI9I,IAAAA,cAAC0hB,GAAAA,uBAAsB,CACnBnf,KAAM,GACN,cAAY,SAGpByG,OACIhJ,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,4DACH6K,eAAe,eAGvB,gBAAc,UACV9C,GAGhB,CAEA,SAASq8C,GAAqBr8C,GAC1B,MAAM9H,GAAWsb,EAAAA,EAAAA,eAEXspC,GAAc7gC,EAAAA,EAAAA,cAAY,KAC5B/jB,GAASuS,EAAAA,GAAAA,GAAU,CACfC,QAAShJ,EAAAA,GAAiBs7C,cAC1BpyC,WAAYqyC,GAAAA,EACZ1nC,YAAa,CACT2e,mBAAoB,2BAEzB,GACJ,CAACh8B,IAEJ,OACI4H,IAAAA,cAAC2I,GAAAA,GAASkL,OAAAuI,OAAA,CACNtT,eACI9I,IAAAA,cAACo9C,GAAAA,oBAAmB,CAChB76C,KAAM,GACN,cAAY,SAGpBsB,QAASm5C,EACTh0C,OACIhJ,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,yDACH6K,eAAe,kBAGvB,gBAAc,UACV9C,GAGhB,CAEA,SAASs8C,GAA0Bt8C,GAC/B,MAAM9H,GAAWsb,EAAAA,EAAAA,eAEX2pC,GAAqC9qC,EAAAA,EAAAA,cAAaja,IAAuB8iD,EAAAA,GAAAA,IAA2B9iD,EAAOiX,GAAAA,GAAY+tC,yBACvHC,GAAkChrC,EAAAA,EAAAA,cAAaja,IAAuB8iD,EAAAA,GAAAA,IAA2B9iD,EAAOiX,GAAAA,GAAYiuC,qBAEpHR,GAAc7gC,EAAAA,EAAAA,cAAY,KAC5B/jB,GAASuS,EAAAA,GAAAA,GAAU,CACfC,QAAShJ,EAAAA,GAAiB67C,aAC1B3yC,WAAY4yC,GAAAA,EACZjoC,YAAa,CACT2e,mBAAoB,2BAEzB,GACJ,CAACh8B,IAEJ,IAAI2qB,EACA/iB,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,wDACH6K,eAAe,iBAYvB,OATIq6C,GAAsCE,IACtCx6B,EACI/iB,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,0DACH6K,eAAe,oBAMvBhD,IAAAA,cAAC2I,GAAAA,GAASkL,OAAAuI,OAAA,CACNtT,eACI9I,IAAAA,cAAC29C,GAAAA,2BAA0B,CACvBp7C,KAAM,GACN,cAAY,SAGpBsB,QAASm5C,EACTh0C,OAAQ+Z,EACR,gBAAc,UACV7iB,GAGhB,CAMA,SAASu8C,GAAoBnoC,GAAsC,IAArC,OAACooC,GAAkCpoC,EAC7D,MAAMlc,GAAWsb,EAAAA,EAAAA,eAEXspC,GAAc7gC,EAAAA,EAAAA,cAAY,KAC5B/jB,GAASuS,EAAAA,GAAAA,GAAU,CACfC,QAAShJ,EAAAA,GAAiBg8C,mBAC1B9yC,WAAY+yC,GAAAA,EACZpoC,YAAa,CACTinC,YAEL,GACJ,CAACtkD,EAAUskD,IAEd,OACI18C,IAAAA,cAAC2I,GAAAA,GAAS,CACNG,eACI9I,IAAAA,cAAC89C,GAAAA,mBAAkB,CACfv7C,KAAM,GACN,cAAY,SAGpBsB,QAASm5C,EACTh0C,OACIhJ,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,yDACH6K,eAAe,kBAGvB,gBAAc,UAG1B,CAEA,SAAS25C,KACL,MAAMvkD,GAAWsb,EAAAA,EAAAA,eAEXspC,GAAc7gC,EAAAA,EAAAA,cAAY,KAC5B/jB,GAASuS,EAAAA,GAAAA,GAAU,CACfC,QAAShJ,EAAAA,GAAiBm8C,WAC1BjzC,WAAY+M,GAAAA,IACb,GACJ,CAACzf,IAEJ,OACI4H,IAAAA,cAAC2I,GAAAA,GAAS,CACNG,eACI9I,IAAAA,cAAC+hB,GAAAA,cAAa,CACVxf,KAAM,GACN,cAAY,SAGpBsB,QAASm5C,EACTh7B,eAAe,EACfhZ,OACIhJ,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,sDACH6K,eAAe,eAGvB,gBAAc,UAG1B,CAEA,SAAS45C,KACL,MAAMxuB,GAAUmpB,EAAAA,EAAAA,cAEVyF,GAAc7gC,EAAAA,EAAAA,cAAY,KAC5BiS,EAAQllB,KAAK,eAAe,GAC7B,CAACklB,IAEJ,OACIpuB,IAAAA,cAAC2I,GAAAA,GAAS,CACNG,eACI9I,IAAAA,cAACg+C,GAAAA,uBAAsB,CACnBz7C,KAAM,GACN,cAAY,SAGpBsB,QAASm5C,EACTh0C,OACIhJ,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,4DACH6K,eAAe,uBAKnC,CAMA,SAAS65C,GAAkB7oB,GAAqC,IAApC,QAAC6f,GAAiC7f,EAC1D,MAAM5F,GAAUmpB,EAAAA,EAAAA,cAEV0G,GAAoB1rC,EAAAA,EAAAA,aAAY2rC,GAAAA,IAChCC,GAAsB5rC,EAAAA,EAAAA,aAAY6rC,GAAAA,IAClCC,EAAcxK,GAAgD,UAArCoK,aAAiB,EAAjBA,EAAmBK,eAC5CC,EAAgB1K,IAAWsK,aAAmB,EAAnBA,EAAqBK,OAAQC,EAAAA,GAAcC,QACtEC,GAAcC,EAAAA,GAAAA,KACdC,EAAsBN,IAAkBF,GAAeM,EAAYG,MAAMl2B,QAAU,EACnFm2B,EAAyBlL,IAAYwK,GAAeQ,GAEpD7B,GAAc7gC,EAAAA,EAAAA,cAAY,KACxB0iC,GAAuBE,GAI3B3wB,EAAQllB,KAAK,eAAe,GAC7B,CAACklB,EAASywB,IAEb,OACI7+C,IAAAA,cAAC2I,GAAAA,GAAS,CACNG,eACI9I,IAAAA,cAACg/C,GAAAA,SAAQ,CACLz8C,KAAM,GACN,cAAY,SAGpBsB,QAASm5C,EACTh0C,OACIhJ,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,uDACH6K,eAAe,kBAGvBiG,iBAAkB81C,GAA0B/+C,IAAAA,cAACi/C,GAAgC,CAACZ,YAAaA,KAGvG,CAEA,SAASY,GAAgC5qB,GAAwC,IAAvC,YAACgqB,GAAoChqB,EAC3E,MAAM,cAACtxB,IAAiBgS,EAAAA,GAAAA,WAExB,OACI/U,IAAAA,cAACk/C,GAAAA,EAAmB,CAChBC,QAASC,EAAAA,GAAmBC,sBAC5BC,8BAA+BC,EAAAA,GAAYC,aAC3CC,SAAUpB,EACVqB,eAAgB38C,EAAc,CAC1B5K,GAAI,gDACJ6K,eAAgB,4GAEpB28C,mBAAoB58C,EAAc,CAC9B5K,GAAI,kDACJ6K,eAAgB,0CAEpB48C,qBAAsB78C,EAAc,CAChC5K,GAAI,oDACJ6K,eAAgB,4IAEpB,CACI68C,YAAaC,GAAAA,KAGjBC,oBAAqBh9C,EAAc,CAC/B5K,GAAI,mDACJ6K,eAAgB,sCAEpBg9C,sBAAuBj9C,EAAc,CACjC5K,GAAI,qDACJ6K,eAAgB,sKAEpBi9C,aAAcl9C,EAAc,CACxB5K,GAAI,4CACJ6K,eAAgB,2CAEpBk9C,eAAgBn9C,EAAc,CAC1B5K,GAAI,8CACJ6K,eAAgB,kGAIhC,CA5CC65C,GAAAhhC,UAAA,CAxCGg4B,QAAO1pC,IAAAA,KAAAC,YAsFX,MAAM+1C,GAAwC,6DAE9C,SAASrD,KACL,MAAME,GAAc7gC,EAAAA,EAAAA,cAAY,KAC5B1P,OAAO2zC,KAAKD,GAAuC,SAAU,sBAAsB,GACpF,IAEH,OACIngD,IAAAA,cAAC2I,GAAAA,GAAS,CACNpF,UAAU,0BACVM,QAASm5C,EACTl0C,eACI9I,IAAAA,cAACqgD,GAAAA,qBAAoB,CACjB99C,KAAM,GACN,cAAY,SAGpByG,OACIhJ,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,4DACH6K,eAAe,uBAKnC,CAEA,SAAS+5C,KACL,MAAMuD,GAAmB/tC,EAAAA,EAAAA,aAAYguC,GAAAA,IAErC,GAAID,EAAiBpkD,OAAS,EAAG,CAC7B,MAAMskD,EAAkBF,EAAiB9iD,KAAKijD,GAQtCzgD,IAAAA,cAAC2I,GAAAA,GAAS,CACNxQ,GAAE,GAAA6J,OAAKy+C,EAAOtoD,GAAE,mBAChBsM,IAAKg8C,EAAOtoD,GACZ0L,QAVR,WACQ48C,EAAOnuC,QACPmuC,EAAOnuC,QAEf,EAOQtJ,OAAQhJ,IAAAA,cAAA,YAAOygD,EAAOt8C,UAKlC,OACInE,IAAAA,cAAAA,IAAAA,SAAA,KACIA,IAAAA,cAAC2I,GAAAA,GAAc,MACd63C,EAGb,CAEA,OAAO,IACX,CC1eA,MAAME,GAAiBxgD,IACnB,MAAM+U,GAAc1C,EAAAA,EAAAA,aAAY1B,EAAAA,IAEhC,OAAKoE,EAKDjV,IAAAA,cAAA,OAAKuD,UAAU,0BACXvD,IAAAA,cAAC86C,GAAe,CAAC7lC,YAAaA,KAC5B/U,EAAMygD,kBAAoBzgD,EAAM0gD,uBAC9B5gD,IAAAA,cAAC6gD,GAAAA,GAA6B,CAC1BF,iBAAkBzgD,EAAMygD,iBACxBG,wBAAyB5gD,EAAM6gD,oBAC/BH,qBAAsB1gD,EAAM0gD,qBAC5BI,qBAAsB9gD,EAAM+gD,sBAC5BC,yBAA0BhhD,EAAMihD,8BAChCC,sBAAuBlhD,EAAMkhD,sBAC7BC,0BAA2BnhD,EAAMohD,yBACjCC,oBAAqBrhD,EAAMqhD,oBAC3BC,yBAA0BthD,EAAMuhD,wBAChCC,oBAAqBxhD,EAAMyhD,qBAjBhC,IAoBD,EAEZjB,GAAA7kC,UAAA,CAtCEklC,oBAAmB52C,IAAAA,KAAAC,WACnB62C,sBAAqB92C,IAAAA,KAAAC,WACrBk3C,yBAAwBn3C,IAAAA,KAAAC,WACxBu3C,kBAAiBx3C,IAAAA,KAAAC,WACjBq3C,wBAAuBt3C,IAAAA,KAAAC,WACvBu2C,iBAAgBx2C,IAAAA,KAAAC,WAChBw2C,qBAAoBz2C,IAAAA,KAAAC,WACpB+2C,8BAA6Bh3C,IAAAA,KAAAC,WAC7Bm3C,oBAAmBp3C,IAAAA,KAAAC,WACnBg3C,sBAAqBj3C,IAAAA,KAAAC,YA+BzB,MCjDA,GDiDA,G,wgBE1BA,MAAMw3C,GAAe,UAyBd,MAAMC,WAAyB7hD,IAAAA,cAIlCK,WAAAA,CAAYH,GACRI,MAAMJ,GAAOK,GAAA,qBAcM,KACnB,GAAuB,OAAnBe,KAAKwgD,UACL,OAEJ,MAAMC,EAAUzgD,KAAKwgD,UAAUE,aAC3Bv7C,SAASw7C,gBAAkBF,IAC3BA,EAAQv7C,QACRiqB,EAAAA,GAAsBsxB,GAC1B,IACHxhD,GAAA,wBAE0BwH,IACvBzG,KAAKwgD,UAAY/5C,EACjBzG,KAAK4gD,cAAc,IACtB3hD,GAAA,qBAEsB,KACnBe,KAAK6gD,mBACL7gD,KAAKC,SAAS,CACV4C,KAAM,KAEV7C,KAAKpB,MAAM6P,UAAU,IACxBxP,GAAA,yBAE0B,KAClBgG,GAAAA,MACDtB,YAAW,KACP,MAAM88C,EAAUt7C,SAAS27C,cAAc,iBACnCL,GACAA,EAAQv7C,OACZ,GAER,IACHjG,GAAA,qBAEsB,KAAM,IAAA8hD,EAAAvhB,EACN,QAAnBuhB,GAAAvhB,EAAAx/B,KAAKpB,OAAM6P,gBAAQ,IAAAsyC,GAAnBA,EAAAntB,KAAA4L,IACAwhB,EAAAA,GAAAA,GAAahhD,KAAKpB,MAAMk0B,oBAAoB,EAAK,IACpD7zB,GAAA,iBAEmBC,IAChBc,KAAKC,SAAS,CAAC4C,KAAM3D,EAAEC,OAAOoF,MAAO08C,0BAA0B,GAAM,IACxEhiD,GAAA,qBAEqB9H,UAClB,GAAKitB,EAQL,GAJIpkB,KAAKpB,MAAM8K,SAAW1J,KAAKpB,MAAM+K,WAAaC,EAAAA,GAAUC,cACxD7J,KAAKpB,MAAMwK,QAAQU,qBAGnB9J,KAAKhJ,MAAMkqD,OAASZ,GAAc,CAClC,MAAM,gBAACa,EAAe,gBAAEC,GAAmBphD,KAAKpB,MAAMwK,QAChD7N,EAAkB6oB,EAAS5oB,QAE7B4oB,EAAS5sB,OAAS8H,EAAAA,GAAU+hD,uBAAyB9lD,EAAgB/D,OAAS8H,EAAAA,GAAUwM,oBAClFq1C,EAAgB5lD,EAAgB1E,IAE1CuqD,EAAgB7lD,GAAiB4O,MAAMjQ,IAC/B,SAAUA,GACV8F,KAAKshD,cACT,GAER,MACI32C,EAAAA,GAAAA,KAAa/C,KAAK,IAAMwc,EAASjiB,MACjCnC,KAAKshD,cACT,IACHriD,GAAA,kCAEoCsiD,IACjC,MAAMC,GAAkBC,EAAAA,GAAAA,IAAaF,GAC/BG,EAAqBF,EAAgBrP,MAAMhqC,KAAUw5C,EAAAA,GAAAA,IAAax5C,KACxEnI,KAAKC,SAAS,CACVghD,yBAA0BS,EAC1BE,QAASL,EAAYM,eACrBC,eAAgBN,EAAgB5mD,OAAS,GAC3C,IACLqE,GAAA,eAEe,KACZ,MAAM8iD,EAAqC/hD,KAAKgiD,iBAE1C9mC,EACFxc,IAAAA,cAAA,MAAI7H,GAAG,qBACH6H,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,oCACH6K,eAAe,mBAK3B,IAAIugD,EAEAA,EADAjiD,KAAKpB,MAAMg2B,aAEPl2B,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,iCACH6K,eAAe,4BAKnBhD,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,gCACH6K,eAAe,uGACf2B,OAAQ,CACJhH,EAAIkb,GAAW7Y,IAAAA,cAAA,SAAI6Y,MAMnC,MAAM5I,EACFjQ,IAAAA,cAAA,OAAKuD,UAAU,4BACViZ,GAIHgnC,EACFxjD,IAAAA,cAAA,OACIuD,UAAU,yBACVpL,GAAG,mBAEForD,GAIT,OACIvjD,IAAAA,cAAC8P,GAAAA,GAAY,CACTvM,UAAU,+BACVpL,GAAG,mBACH2f,MAAM,EACNzH,aAAa,EACbD,cAAc,EACdL,SAAUzO,KAAKmiD,aACfzqC,OAAQ1X,KAAKmiD,aACb1hD,UAAWT,KAAKpB,MAAM4C,KAAKC,cAAc,CAAC5K,GAAI,oCAAqC6K,eAAgB,kBACnGiN,gBAAiBA,EACjBuzC,mBAAoBA,EACpBxzC,eAAe,GAEfhQ,IAAAA,cAAA,OAAKuD,UAAU,oCACXvD,IAAAA,cAAA,KAAGuD,UAAU,8BACbvD,IAAAA,cAAC0jD,GAAAA,EAEG,CACAz7C,IAAK3G,KAAKqiD,gBACVxrD,GAAG,mBACH,aAAYmJ,KAAKpB,MAAM4C,KAAKC,cAAc,CAAC5K,GAAI,2BAA4B6K,eAAgB,uBAC3FO,UAAU,uBACV+I,SAAUhL,KAAKgL,SACfzG,MAAOvE,KAAKhJ,MAAM6L,KAClBy/C,eAAgBtiD,KAAKyW,aACrB8rC,cAAeC,GAAAA,EACfC,aAAa,SACbnsC,UAAU,KACVyrC,UAAWA,EACXW,eAAe,EACfC,WAAW,QACXC,kBAAkB,EAClBC,eAAe,EACfC,sBAAuB9iD,KAAK+iD,0BAC5BC,0BAA0B,EAC1BC,0BAA0B,KAGzBjjD,KAAKhJ,MAAMiqD,2BACXjhD,KAAKhJ,MAAM8qD,gBACZ9hD,KAAKhJ,MAAM6L,MAEPnE,IAAAA,cAACwkD,GAAAA,EAAkB,CACfnpC,QAASopC,GAAAA,EAAiBC,OAC1BC,YAAa,CAAC//C,YAAa,GAAF5C,OAAKV,KAAKhJ,MAAM4qD,aAK9C,IA9LnB5hD,KAAKgiD,iBAAmB,CAAC,IAAIsB,GAAAA,IAC7BtjD,KAAKwgD,UAAY,KAEjBxgD,KAAKhJ,MAAQ,CACT6L,KAAM,GACNq+C,KAAMZ,GACNwB,gBAAgB,EAChBb,0BAA0B,EAC1BW,QAAS,GAEjB,EAuLH3iD,GAxMYshD,GAAgB,aAtBzB9xC,SAAQ5F,IAAAA,KAAAC,WAER8rB,aAAY/rB,IAAAA,KAAAC,WAEZY,QAAOb,IAAAA,KAEPO,QAAOP,IAAAA,MAAA,CACHs4C,gBAAet4C,IAAAA,KAAAC,WACfs4C,gBAAev4C,IAAAA,KAAAC,WACfgB,mBAAkBjB,IAAAA,KAAAC,aAAAA,WAEtBgqB,mBAAkBjqB,IAAAA,OAAAC,aAqNtB,UAAeE,EAAAA,GAAAA,YAAWu3C,IC7N1B,IAAelxC,EAAAA,EAAAA,UAlBf,SAAyBrY,GACrB,MAAO,CACH49B,cAAcmF,EAAAA,EAAAA,IAAgB/iC,GAC9B2S,UAAUsG,EAAAA,EAAAA,IAAYjZ,GACtB0S,SAASwG,EAAAA,EAAAA,GAAalZ,GAE9B,IAEA,SAA4BF,GACxB,MAAO,CACHsS,SAASgH,EAAAA,EAAAA,IAAmB,CACxB+wC,gBAAe,KACfC,gBAAe,KACft3C,mBAAkBA,GAAAA,IACnBhT,GAEX,GAEA,CAA4DypD,I,sbCpB5D,MAAMz+C,IAAWiH,EAAAA,GAAAA,gBAAe,CAC5Bw6C,eAAgB,CACZ1sD,GAAI,8CACJ6K,eAAgB,qBAEpB8hD,cAAe,CACX3sD,GAAI,6CACJ6K,eAAgB,sBAIlB+hD,GAAW,CACbC,QAAS,CAACC,GAAAA,EAAaC,KAAMD,GAAAA,EAAaE,MAAO,KACjDC,IAAK,CAACH,GAAAA,EAAaI,IAAKJ,GAAAA,EAAaE,MAAO,MAWzC,MAAMG,WAAsBtlD,IAAAA,cAA2BK,WAAAA,GAAA,SAAApE,WAAAsE,GAAA,gCAS/BC,IACvBA,SAAAA,EAAGsE,iBACHtE,SAAAA,EAAGa,kBACHC,KAAKikD,oBAAoB,IAC5BhlD,GAAA,mCAE6BC,IACtBglD,GAAAA,EAA0BhlD,IAAMA,EAAEO,UAAYykD,GAAAA,EAAsBhlD,EAAGI,EAAAA,GAAUC,SAAS4kD,KAC1FjlD,EAAEsE,iBACFtE,EAAEa,kBACFC,KAAKikD,qBACT,IACHhlD,GAAA,2BAEoB,KACjB,MAAM,oBAACghD,GAAuBjgD,KAAKpB,MAEnCoB,KAAKpB,MAAMwK,QAAQpQ,wBAAwBinD,EAAoB,GAClE,CA1BDj7C,iBAAAA,GACIG,SAASC,iBAAiB,UAAWpF,KAAKokD,2BAC9C,CAEA9+C,oBAAAA,GACIH,SAASI,oBAAoB,UAAWvF,KAAKokD,2BACjD,CAsBA3+C,MAAAA,GACI,MAAM,KAACjE,EAAI,oBAAEy+C,GAAuBjgD,KAAKpB,MAEnCylD,EAAmB7iD,EAAKC,cAAc,CAAC5K,GAAI,+CAAgD6K,eAAgB,mBAEjH,OACIhD,IAAAA,cAAA,OAAKuD,UAAU,kBACXvD,IAAAA,cAAC2kB,GAAAA,EAAW,CACR9U,MAAO0xC,EAAsBn+C,GAASyhD,eAAiBzhD,GAAS0hD,cAChEC,SAAUA,IAEV/kD,IAAAA,cAAA,KACI6a,KAAK,IACLtX,UAAWI,IAAW,8BAA+B,CACjDilB,OAAQ24B,IAEZ19C,QAASvC,KAAKikD,mBACd,aAAYI,GAEZ3lD,IAAAA,cAAA,KAAGuD,UAAU,+BAKjC,EACHhD,GAtDY+kD,GAAa,aANtB/D,oBAAmBp3C,IAAAA,KAAAC,WACnBM,QAAOP,IAAAA,MAAA,CACH7P,uBAAsB6P,IAAAA,KAAAC,aAAAA,aA4D9B,UAAeE,EAAAA,GAAAA,YAAWg7C,IC7D1B,IAAe30C,EAAAA,EAAAA,UAjBf,SAAyBrY,GACrB,MAAMwmD,GAAQ8G,EAAAA,EAAAA,IAAWttD,GAEzB,MAAO,CACHutD,iBAAkB/G,GAASA,EAAM5iD,OAAS,EAC1CqlD,qBAAqBuE,EAAAA,GAAAA,IAAsBxtD,GAEnD,IAEA,SAA4BF,GACxB,MAAO,CACHsS,SAASgH,EAAAA,EAAAA,IAAmB,CACxBpX,uBAAsBA,GAAAA,IACvBlC,GAEX,GAEA,CAA4DktD,I,0ZCN5D,MAAMS,WAAyB/lD,IAAAA,cAA2BK,WAAAA,GAAA,SAAApE,WAAAsE,GAAA,0BAWjCC,IACjBA,EAAEsE,iBAEFxD,KAAKpB,MAAMwK,QAAQC,UAAU,CACzBC,QAAShJ,EAAAA,GAAiBokD,aAC1Bl7C,WAAY+2C,GACZpsC,YAAa,CAAC2e,mBAAoB,kCACpC,IACL7zB,GAAA,uBAEiBC,IACd,MAAOkK,SAAS,WAAC/I,IAAeL,KAAKpB,MAEjCslD,GAAAA,EAA0BhlD,IAAMA,EAAEO,WAC9BykD,GAAAA,EAAsBhlD,EAAGI,EAAAA,GAAUC,SAASolD,KAC5CzlD,EAAEsE,iBACFnD,EAAWC,EAAAA,GAAiBokD,eAE5BR,GAAAA,EAAsBhlD,EAAGI,EAAAA,GAAUC,SAASqlD,IAE5CvkD,EAAWC,EAAAA,GAAiBokD,cAEpC,IACHzlD,GAAA,kCAE4BC,IACrBglD,GAAAA,EAA0BhlD,KAAOA,EAAEO,UAAYykD,GAAAA,EAAsBhlD,EAAGI,EAAAA,GAAUC,SAASslD,KACtF3lD,EAAES,QAAWwvB,EAAAA,GAAkCjwB,KAChDA,EAAEsE,iBACFxD,KAAK8kD,0BAEb,IACH7lD,GAAA,+BAEwB,KACrB,MAAM,oBAAC8lD,EAAqB37C,SAAS,UAACC,EAAS,WAAEhJ,IAAeL,KAAKpB,MAEjEmmD,EACA1kD,EAAWC,EAAAA,GAAiBokD,cAE5Br7C,EAAU,CACNC,QAAShJ,EAAAA,GAAiBokD,aAC1Bl7C,WAAY+2C,GACZpsC,YAAa,CAAC2e,mBAAoB,kCAE1C,GACH,CAxDD9tB,iBAAAA,GACIG,SAASC,iBAAiB,UAAWpF,KAAK8gC,gBAC1C37B,SAASC,iBAAiB,UAAWpF,KAAKglD,0BAC9C,CAEA1/C,oBAAAA,GACIH,SAASI,oBAAoB,UAAWvF,KAAK8gC,gBAC7C37B,SAASI,oBAAoB,UAAWvF,KAAKglD,0BACjD,CAkDAv/C,MAAAA,GACI,OACI/G,IAAAA,cAAA,OAAKuD,UAAW,mCACVjC,KAAKpB,MAAMqmD,qBAAuBvmD,IAAAA,cAACslD,GAAa,MAClDtlD,IAAAA,cAAA,UACIuD,UAAW,uCACXM,QAASvC,KAAKklD,kBACd,aAAYllD,KAAKpB,MAAM4C,KAAKC,cAAc,CAAC5K,GAAI,sDAAuD6K,eAAgB,qBACtH,gBAAc,SACd,cAAY,gCACZ7K,GAAG,iCAEH6H,IAAAA,cAAA,KAAGuD,UAAU,sBACbvD,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,wCACH6K,eAAe,iBAEnBhD,IAAAA,cAAA,OAAKuD,UAAW,wCAAuC,GAAAvB,OAC/CuE,GAAAA,KAAoB,IAAM,QAAO,OAKzD,EACHhG,GAnFKwlD,GAAgB,aARlBQ,oBAAmBp8C,IAAAA,KAAAC,WACnBi8C,oBAAmBl8C,IAAAA,KAAAC,WACnBM,QAAOP,IAAAA,MAAA,CACHQ,UAASR,IAAAA,KAAAC,WACTzI,WAAUwI,IAAAA,KAAAC,aAAAA,aAyFlB,UAAeE,EAAAA,GAAAA,YAAWy7C,IC9E1B,IAAep1C,EAAAA,EAAAA,UAhBf,SAAyBrY,GACrB,MAAO,CACHiuD,qBAAqBE,EAAAA,EAAAA,IAA0BnuD,GAC/C+tD,qBAAqBK,EAAAA,GAAAA,GAAYpuD,EAAOsJ,EAAAA,GAAiBokD,cAEjE,IAEA,SAA4B5tD,GACxB,MAAO,CACHsS,SAASgH,EAAAA,EAAAA,IAAmB,CACxB/G,UAAS,KACThJ,WAAUA,GAAAA,GACXvJ,GAEX,GAEA,CAA4D2tD,I,wKCf7C,SAASY,GAAoBzmD,GACxC,MAAM4C,GAAOiS,EAAAA,GAAAA,WAEPuC,GAAgB6E,EAAAA,EAAAA,cAAY,KAC9Bjc,EAAMwK,QAAQk8C,eAAe1mD,EAAMvD,SAASxE,GAAG,GAChD,CAAC+H,EAAMwK,QAAQk8C,eAAgB1mD,EAAMvD,WAExC,OACIqD,IAAAA,cAAC8P,GAAAA,GAAY,CACTE,eAAe,EACfjO,UAAWe,EAAKC,cAAc,CAAC5K,GAAI,uCAAwC6K,eAAgB,0BAC3F+M,SAAU7P,EAAM6P,SAChBE,gBACIjQ,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,uCACH6K,eAAe,0BAGvBuU,aAAcrX,EAAM6P,SACpBuH,cAAeA,EACfF,kBACIpX,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,+BACH6K,eAAe,WAGvB6jD,uBAAwB,UAExB7mD,IAAAA,cAAA,QAAMuD,UAAU,6BACZvD,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,iCACH6K,eAAe,0IACf2B,OAAQ,CACJmiD,cAAe5mD,EAAMvD,SAASsF,aAC9BtE,EAAIkb,GAAW7Y,IAAAA,cAAA,SAAI6Y,OAM3C,CAGA8tC,GAAA9qC,UAAA,CAjDI9L,SAAQ5F,IAAAA,KAAAC,WACRM,QAAOP,IAAAA,MAAA,CACHy8C,eAAcz8C,IAAAA,KAAAC,aAAAA,aAgDtBC,EAAAA,GAAAA,gBAAe,CACX08C,OAAQ,CACJ5uD,GAAI,uBACJ6K,eAAgB,UAEpByZ,QAAS,CACLtkB,GAAI,wBACJ6K,eAAgB,WAEpBgkD,gBAAiB,CACb7uD,GAAI,0BACJ6K,eAAgB,sEAEpBikD,eAAgB,CACZ9uD,GAAI,yBACJ6K,eAAgB,QAEpBkkD,eAAgB,CACZ/uD,GAAI,yBACJ6K,eAAgB,cC/DxB,UAAe2N,EAAAA,EAAAA,SAAQ,MARvB,SAA4BvY,GACxB,MAAO,CACHsS,SAASgH,EAAAA,EAAAA,IAAmB,CACxBk1C,eAAcA,GAAAA,IACfxuD,GAEX,GAEA,CAAiDuuD,I,oDCyBjD,MAAMQ,GAAsB7yC,IAEf,IAFgB,SACzB3X,GACI2X,EACJ,MAAMlc,GAAWsb,EAAAA,EAAAA,eACX6yC,GAAsBh0C,EAAAA,EAAAA,aAAYk0C,EAAAA,IAClCW,GAA2BxzC,EAAAA,EAAAA,SAAQyzC,GAAAA,GAA6B,CAAC1qD,IACjE2qD,GAAa/0C,EAAAA,EAAAA,cAAaja,GAAuB8uD,EAAyB9uD,EAAOqE,MACjF,cAACoG,IAAiBgS,EAAAA,GAAAA,WAExB,IAAIwyC,EAAiD,KACrD,GAAI5qD,EAAS7D,OAASqE,GAAAA,EAAcG,gBAAiB,CACjD,SAASkqD,IACLpvD,GAASqvD,EAAAA,GAAAA,IAAiB9qD,EAASxE,IAAKwE,EAASmhB,OACrD,CAEAypC,EACIvnD,IAAAA,cAAC2I,GAAAA,GAAS,CACNxQ,GAAE,QAAA6J,OAAUrF,EAASxE,IACrB0L,QAAS2jD,EACT1+C,eAAgB9I,IAAAA,cAACihB,GAAAA,gBAAe,CAAC1e,KAAM,KACvCyG,OACIrM,EAASmhB,MACL9d,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,oDACH6K,eAAe,oBAGnBhD,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,kDACH6K,eAAe,mBAMvC,CAEA,IAAI0kD,EAA6C,KAC7CC,EAA6C,KACjD,GAAIhrD,EAAS7D,OAASqE,GAAAA,EAAcC,OAAQ,CACxC,SAASwqD,IACLxvD,GAASuS,EAAAA,GAAAA,GAAU,CACfC,QAAShJ,EAAAA,GAAiBgb,gBAC1B9R,WAAY67C,GACZlxC,YAAa,CACT9Y,cAGZ,CAkBA,SAASkrD,IACLzvD,GAASuS,EAAAA,GAAAA,GAAU,CACfC,QAAShJ,EAAAA,GAAiB2T,cAC1BzK,WAAY0K,GAAAA,QACZC,YAAa,CACT7Z,WAAYe,EAASxE,GACrB6e,oBAAqBra,EAASsF,gBAG1C,CAzBAylD,EACI1nD,IAAAA,cAAC2I,GAAAA,GAAS,CACNxQ,GAAE,UAAA6J,OAAYrF,EAASxE,IACvB6pB,eAAe,EACf,iBAAe,EACfne,QAAS+jD,EACT9+C,eAAgB9I,IAAAA,cAAC8nD,GAAAA,oBAAmB,CAACvlD,KAAM,KAC3CyG,OACIhJ,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,oDACH6K,eAAe,sBAiB/B2kD,EACI3nD,IAAAA,cAAC2I,GAAAA,GAAS,CACNxQ,GAAE,UAAA6J,OAAYrF,EAASxE,IACvB0L,QAASgkD,EACT,iBAAe,EACf/+C,eAAgB9I,IAAAA,cAACg6B,GAAAA,kBAAiB,CAACz3B,KAAM,KACzCyG,OACIhJ,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,oDACH6K,eAAe,qBAKnC,CAEA,SAAS+kD,EAAmBC,GACxB5vD,GAAS6vD,EAAAA,GAAAA,IAAmBtrD,EAASxE,GAAI6vD,GAC7C,CAEA,IAAIE,EACAloD,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,yBACH6K,eAAe,aAGnBmlD,EAAmBnoD,IAAAA,cAACooD,GAAAA,uBAAsB,CAAC7lD,KAAM,KACjD5F,EAASqrD,UAAYK,GAAAA,EAAgBC,cACrCJ,EACIloD,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,kCACH6K,eAAe,mBAGvBmlD,EAAmBnoD,IAAAA,cAACuoD,GAAAA,8BAA6B,CAAChmD,KAAM,MACjD5F,EAASqrD,UAAYK,GAAAA,EAAgBG,UAC5CN,EACIloD,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,+BACH6K,eAAe,oBAGvBmlD,EAAmBnoD,IAAAA,cAACyoD,GAAAA,iBAAgB,CAAClmD,KAAM,MAG/C,MAAMmmD,EACF1oD,IAAAA,cAAC2I,GAAAA,GAAY,CACTxQ,GAAE,gBAAA6J,OAAkBrF,EAASxE,IAC7B2Q,eAAgBq/C,EAChBn/C,OACIhJ,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,eACH6K,eAAe,SAGvBiG,iBACIjJ,IAAAA,cAAAA,IAAAA,SAAA,KACKkoD,EACDloD,IAAAA,cAACmW,GAAAA,iBAAgB,CAAC5T,KAAM,MAGhC6T,OAAM,gBAAApU,OAAkBrF,EAASxE,GAAE,SACnCke,cAAetT,EAAc,CAAC5K,GAAI,4DAA6D6K,eAAgB,kBAE/GhD,IAAAA,cAAC2I,GAAAA,GAAS,CACNxQ,GAAE,oBAAA6J,OAAsBrF,EAASxE,IACjC6Q,OACIhJ,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,kCACH6K,eAAe,mBAGvBa,QAASA,IAAMkkD,EAAmBM,GAAAA,EAAgBC,cAClDr/C,iBAAkBtM,EAASqrD,UAAYK,GAAAA,EAAgBC,aAAetoD,IAAAA,cAACiD,GAAAA,UAAS,CAACV,KAAM,KAAQ,OAEnGvC,IAAAA,cAAC2I,GAAAA,GAAS,CACNxQ,GAAE,oBAAA6J,OAAsBrF,EAASxE,IACjC6Q,OACIhJ,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,+BACH6K,eAAe,oBAGvBa,QAASA,IAAMkkD,EAAmBM,GAAAA,EAAgBG,SAClDv/C,iBAAkBtM,EAASqrD,UAAYK,GAAAA,EAAgBG,QAAUxoD,IAAAA,cAACiD,GAAAA,UAAS,CAACV,KAAM,KAAQ,OAE9FvC,IAAAA,cAAC2I,GAAAA,GAAS,CACNxQ,GAAE,cAAA6J,OAAgBrF,EAASxE,IAC3B6Q,OACIhJ,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,yBACH6K,eAAe,aAGvBa,QAASA,IAAMkkD,EAAmBM,GAAAA,EAAgBM,QAClD1/C,iBAAkBtM,EAASqrD,UAAYK,GAAAA,EAAgBM,OAAS3oD,IAAAA,cAACiD,GAAAA,UAAS,CAACV,KAAM,KAAQ,QAK/Foa,GAAqBR,EAAAA,EAAAA,cAAY,KACnC/jB,GAASwnB,EAAAA,EAAAA,IAAqB0nC,GAAY,GAC3C,CAAClvD,EAAUkvD,IAERsB,GAA6C,IAAxBrC,EACvBvmD,IAAAA,cAAC6oD,GAAAA,EAAkB,CACf1wD,GAAIwE,EAASxE,GACbwkB,mBAAoBA,EACpBJ,YAAa+qC,EAAWprD,SAE5B,KAEJ,OACI8D,IAAAA,cAAC8c,GAAAA,EAA0B,CACvB3kB,GAAIwE,EAASxE,GACbsL,KAAM9G,EAASsF,cAEd2mD,EACAA,GAAsB5oD,IAAAA,cAAC2I,GAAAA,GAAc,MACrC4+C,EACAI,EACAD,EACD1nD,IAAAA,cAAC2I,GAAAA,GAAc,MACd+/C,EACD1oD,IAAAA,cAAC2I,GAAAA,GAAc,MACf3I,IAAAA,cAAC8b,GAAAA,EAAyB,CAAC3jB,GAAIwE,EAASxE,KACf,EAIrC,IAAeue,EAAAA,EAAAA,MAAKywC,ICvNd2B,GAA6Bx0C,IAGtB,IAHuB,SAChC3X,EAAQ,8BACRwkD,GACI7sC,EACJ,MAAOyI,EAAYC,IAAiB9I,EAAAA,EAAAA,WAAS,IACvC,cAACnR,IAAiBgS,EAAAA,GAAAA,WAElB3c,GAAWsb,EAAAA,EAAAA,eACXq1C,GAAmBx2C,EAAAA,EAAAA,aAAYy2C,EAAAA,IAC/Bn9C,GAAgB0G,EAAAA,EAAAA,aAAYvB,EAAAA,IAElC,SAASi4C,EAAyBjB,GAC9B5vD,GAAS6vD,EAAAA,GAAAA,IAAmBtrD,EAASxE,GAAI6vD,GAC7C,CAEA,IAAIkB,EAAyBlpD,IAAAA,cAACyoD,GAAAA,iBAAgB,CAAClmD,KAAM,KACjD4mD,EACAnpD,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,+BACH6K,eAAe,oBAGnBrG,EAASqrD,UAAYK,GAAAA,EAAgBC,eACrCa,EACInpD,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,kCACH6K,eAAe,mBAGvBkmD,EAAyBlpD,IAAAA,cAACuoD,GAAAA,8BAA6B,CAAChmD,KAAM,MAGlE,MAAM6mD,EACFppD,IAAAA,cAAC2I,GAAAA,GAAY,CACTxQ,GAAE,sBAAA6J,OAAwBrF,EAASxE,IACnC2Q,eAAgBogD,EAChBlgD,OACIhJ,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,eACH6K,eAAe,SAGvBiG,iBACIjJ,IAAAA,cAAAA,IAAAA,SAAA,KACKmpD,EACDnpD,IAAAA,cAACmW,GAAAA,iBAAgB,CAAC5T,KAAM,MAGhC6T,OAAM,sBAAApU,OAAwBrF,EAASxE,GAAE,UAEzC6H,IAAAA,cAAC2I,GAAAA,GAAS,CACNxQ,GAAE,oBAAA6J,OAAsBrF,EAASxE,IACjC6Q,OACIhJ,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,kCACH6K,eAAe,mBAGvBa,QAASA,IAAMolD,EAAyBZ,GAAAA,EAAgBC,cACxDr/C,iBAAkBtM,EAASqrD,UAAYK,GAAAA,EAAgBC,aAAetoD,IAAAA,cAACiD,GAAAA,UAAS,CAACV,KAAM,KAAQ,OAEnGvC,IAAAA,cAAC2I,GAAAA,GAAS,CACNxQ,GAAE,oBAAA6J,OAAsBrF,EAASxE,IACjC6Q,OACIhJ,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,+BACH6K,eAAe,oBAGvBa,QAASA,IAAMolD,EAAyBZ,GAAAA,EAAgBG,SACxDv/C,iBAAkBtM,EAASqrD,UAAYK,GAAAA,EAAgBG,QAAUxoD,IAAAA,cAACiD,GAAAA,UAAS,CAACV,KAAM,KAAQ,QAetG,IAAI8mD,EAAiCrpD,IAAAA,cAAA,YAAO+oD,GACnB,MAArBA,IACAM,EACIrpD,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,mCACH6K,eAAe,SAK3B,MAAMsmD,EACFtpD,IAAAA,cAAC2I,GAAAA,GAAY,CACTxQ,GAAE,qBAAA6J,OAAuBrF,EAASxE,IAClC2Q,eAAgB9I,IAAAA,cAAC29C,GAAAA,2BAA0B,CAACp7C,KAAM,KAClDyG,OACIhJ,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,eACH6K,eAAe,SAGvBiG,iBACIjJ,IAAAA,cAAAA,IAAAA,SAAA,KACKqpD,EACDrpD,IAAAA,cAACmW,GAAAA,iBAAgB,CAAC5T,KAAM,MAGhC6T,OAAM,qBAAApU,OAAuBrF,EAASxE,GAAE,UAEvCyI,EAAAA,GAAU2oD,sBAAsB/rD,KAAKgsD,GAClCxpD,IAAAA,cAAC2I,GAAAA,GAAS,CACNxQ,GAAE,eAAA6J,OAAiBrF,EAASxE,GAAE,KAAA6J,OAAIwnD,GAClC/kD,IAAG,eAAAzC,OAAiBrF,EAASxE,GAAE,KAAA6J,OAAIwnD,GACnCxgD,OAAQhJ,IAAAA,cAAA,YAAOwpD,GACf3lD,QAASA,KAAM4lD,OA1CGC,EA0CsBF,OAzCpDpxD,GAASqwB,EAAAA,GAAAA,IAAgB5c,EAAe,CAAC,CACrC6c,QAAS7c,EACTlP,SAAUiE,EAAAA,GAAAA,YAAsB+oD,0BAChClmD,KAAM8kB,GAAAA,GAAYqhC,sBAClB/jD,MAAO6jD,EAAO/7C,eALtB,IAAkC+7C,CA0CqC,EACvDzgD,iBAAkB8/C,IAAqBS,EAAgBxpD,IAAAA,cAACiD,GAAAA,UAAS,CAACV,KAAM,KAAQ,UAO1FsnD,EACF7pD,IAAAA,cAAC2I,GAAAA,GAAS,CACNxQ,GAAE,qBAAA6J,OAAuBrF,EAASxE,IAClC0L,QAASs9C,EACTr4C,eAAgB9I,IAAAA,cAAC0hB,GAAAA,uBAAsB,CAACnf,KAAM,KAC9CyG,OACIhJ,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,4BACH6K,eAAe,4BAU/B,OACIhD,IAAAA,cAAA,OACIuD,UAAWI,IACP,cACA,cACA,CAACsZ,SAAUF,GACX,CAAC,oBAAqBA,KAG1B/c,IAAAA,cAAC2I,GAAAA,GAAc,CACXQ,WAAY,CACRhR,GAAI,qCAAF6J,OAAuCrF,EAASxE,IAClD,aAAc4K,EAAc,CAAC5K,GAAI,kDAAmD6K,eAAgB,oBAAqB,CAACS,KAAM9G,EAASsF,eACzIib,MAAO,qCACP3T,SAAUvJ,IAAAA,cAACmd,GAAAA,iBAAgB,CAAC5a,KAAM,MAEtC6a,kBAAmB,CACfjZ,KAAMpB,EAAc,CAAC5K,GAAI,kDAAmD6K,eAAgB,oBAAqB,CAACS,KAAM9G,EAASsF,eACjIib,MAAO,aAEX1T,KAAM,CACFrR,GAAI,uCAAF6J,OAAyCrF,EAASxE,IACpD,aAAc4K,EAAc,CAAC5K,GAAI,uDAAwD6K,eAAgB,uBACzGqa,SA3BhB,SAA0BC,GACtBN,EAAcM,EAClB,IA4Ba8rC,EACAE,EACDtpD,IAAAA,cAAC2I,GAAAA,GAAc,MACdkhD,GAEH,EAId,IAAenzC,EAAAA,EAAAA,MAAKoyC,IClNb,SAASgB,GAA4BxxD,GACxC,OAAOA,EAAM6C,MAAM4uD,sBAAsBzsC,MAC7C,C,oDCoBA,MA4IA,GA5I6B0sC,KACzB,MAAM5xD,GAAWsb,EAAAA,EAAAA,eACXqD,GAAgBxE,EAAAA,EAAAA,aAAYtB,EAAAA,IAC5BnO,GAAOiS,EAAAA,GAAAA,WACPk1C,GAA8B13C,EAAAA,EAAAA,cAAaja,IAAuB4xD,EAAAA,EAAAA,IAAQ5xD,EAAOiwB,EAAAA,GAAY4hC,QAASC,EAAAA,GAAQC,oBAE9GC,GAAyB/3C,EAAAA,EAAAA,cAAaja,IAAuBiyD,EAAAA,GAAAA,IAA8BjyD,EAAOiX,GAAAA,EAAYC,yBAE9GmxC,GAD0BpuC,EAAAA,EAAAA,cAAaja,IAAuBiyD,EAAAA,GAAAA,IAA8BjyD,EAAOiX,GAAAA,EAAYi7C,2BACjEF,EAC9C1J,GAAuBruC,EAAAA,EAAAA,cAAaja,IAAuBiyD,EAAAA,GAAAA,IAA8BjyD,EAAOiX,GAAAA,EAAYk7C,wBAC5GC,GAAsBn4C,EAAAA,EAAAA,aAAYu3C,IAClCj+C,GAAgB0G,EAAAA,EAAAA,aAAYvB,EAAAA,IAC5B25C,GAAyBxuC,EAAAA,EAAAA,cAAaikC,IACxChoD,ECnCD,SAAkCgoD,GACrC,MAAO,CACHtnD,KAAM0B,EAAAA,GAAYowD,gCAClBxK,OAER,CD8BiByK,CAAyBzK,GAAM,GACzC,IAEH,IAAI0K,EAAc,mDAMlB,GAJKb,IACDa,GAAe,iEAGbnK,IAAqBC,IAA0B7pC,EACjD,OAAO,KAGX,MAAMkqC,EAAwBA,KAC1B7oD,GAASuS,EAAAA,GAAAA,GAAU,CACfC,QAAShJ,EAAAA,GAAiBC,cAC1BiJ,WAAYP,GAAAA,UACb,EAGDw2C,EAAsBA,KACxB3oD,GAASuS,EAAAA,GAAAA,GAAU,CACfC,QAAShJ,EAAAA,GAAiBiJ,kBAC1BC,WAAYC,GAAAA,UACb,EAsCDggD,EAAqBC,GAGnBhrD,IAAAA,cAAA,UACIuD,UAAWunD,EACX3yD,GAAI,iBACJ,aAAY2K,EAAKC,cAAc,CAAC5K,GAAI,sDAAuD6K,eAAgB,yBAC3Ga,QANYm5C,IAAMgO,aAAW,EAAXA,KAQlBhrD,IAAAA,cAAA,OACI,aAAY8C,EAAKC,cAAc,CAAC5K,GAAI,wDAAyD6K,eAAgB,kBAE7GhD,IAAAA,cAAA,KAAGuD,UAAU,kBACbvD,IAAAA,cAAA,YACK8C,EAAKC,cAAc,CAAC5K,GAAI,8BAA+B6K,eAAgB,oBAOtFioD,EAAgCA,KAC7BhB,GACD7xD,GAASqwB,EAAAA,GAAAA,IACL5c,EACA,CAAC,CACGlP,SAAU4rB,EAAAA,GAAY4hC,QACtBzhC,QAAS7c,EACTpI,KAAM2mD,EAAAA,GAAQC,iBACdxkD,MAAO,UAGnB,EAQJ,OAAK86C,EASD3gD,IAAAA,cAACkrD,GAAAA,EAAW,CACR3nD,UAAU,yBACV8Z,SAhBWwoB,IACf8kB,EAAuB9kB,GACvBolB,GAA+B,EAe3B7K,KAAMsK,GAELK,IACD/qD,IAAAA,cAAC2I,GAAAA,EAAI,CACDxQ,GAAG,wBACH4J,UAAWe,EAAKC,cAAc,CAAC5K,GAAI,0DAA2D6K,eAAgB,2BA5F9FmoD,MACxB,IAAIC,EAYAC,EAYJ,OAvBIzK,IACAwK,EACIprD,IAAAA,cAAC2I,GAAAA,EAAK2iD,WAAU,CACZnzD,GAAG,mBACH0L,QAASo9C,EACT9xC,KAAMnP,IAAAA,cAAA,KAAGuD,UAAU,eACnBY,KAAMrB,EAAKC,cAAc,CAAC5K,GAAI,mDAAoD6K,eAAgB,uBAM1G29C,IACA0K,EACIrrD,IAAAA,cAAC2I,GAAAA,EAAK2iD,WAAU,CACZnzD,GAAG,iBACH0L,QAASk9C,EACT5xC,KAAMnP,IAAAA,cAAA,KAAGuD,UAAU,cACnBY,KAAMrB,EAAKC,cAAc,CAAC5K,GAAI,qDAAsD6K,eAAgB,0BAM5GhD,IAAAA,cAAAA,IAAAA,SAAA,KACIA,IAAAA,cAAC2I,GAAAA,EAAK4iD,MAAK,KACNF,EACAD,GAEN,EA+DED,KAdFJ,GAJsBS,KACzBvK,IACAgK,GAA+B,GAkBrB,EE/IhBQ,GAAuBvrD,IACzB,MAAM4C,GAAOiS,EAAAA,GAAAA,WACPgC,GAAgBxE,EAAAA,EAAAA,aAAYtB,EAAAA,IAElC,OAAK8F,EAKD/W,IAAAA,cAACqP,GAAAA,EAAkB,CACftU,OAAQgc,EACRzH,YAAa,CAACC,GAAAA,GAAYqkB,iBAAkBrkB,GAAAA,GAAYskB,eAExD7zB,IAAAA,cAACi0B,GAAAA,EAAiB,CACdlyB,UAAWe,EAAKC,cAAc,CAAC5K,GAAI,6BAA8B6K,eAAgB,mBACjF7K,GAAG,sBACHoL,UAAS,0CAAAvB,OAA4C9B,EAAMqD,UAAY,IAAHvB,OAAO9B,EAAMqD,WAAc,IAC/FqH,QAAShJ,EAAAA,GAAiBsyB,WAC1BppB,WAAYqpB,GAAAA,QACZ1e,YAAa,CAAC2e,mBAAoB,wBAElCp0B,IAAAA,cAAA,OACIuD,UAAU,kDACV,aAAYT,EAAKC,cAAc,CAAC5K,GAAI,qDAAsD6K,eAAgB,oBAE1GhD,IAAAA,cAAA,KACIuD,UAAU,gBACV,cAAY,SAEhBvD,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAI,6BACJ6K,eAAe,sBA1BxB,IA8Bc,EAE3ByoD,GAAA5vC,UAAA,CAxCEtY,UAAS4G,IAAAA,QA0Cb,Y,sbCJe,MAAMuhD,WAAwB1rD,IAAAA,cAMzCK,WAAAA,CAAYH,GACRI,MAAMJ,GAAOK,GAAA,gCAgCS,KAAM,IAAAorD,EACC,QAA7BA,EAAArqD,KAAKsqD,iBAAiBxmD,eAAO,IAAAumD,GAA7BA,EAA+BjlD,iBAAiB,UAAWpF,KAAKuqD,mBAEhEvqD,KAAKwqD,uBAAwB,CAAI,IACpCvrD,GAAA,kCAE2B,KAAM,IAAAwrD,EACD,QAA7BA,EAAAzqD,KAAKsqD,iBAAiBxmD,eAAO,IAAA2mD,GAA7BA,EAA+BllD,oBAAoB,UAAWvF,KAAKuqD,mBAEnEvqD,KAAKwqD,uBAAwB,CAAK,IACrCvrD,GAAA,0BAEoBC,KACbG,EAAAA,GAAAA,GAAaH,EAAGI,EAAAA,GAAUC,SAASC,SACnCN,EAAEsE,iBACFxD,KAAK0qD,iBACT,IACHzrD,GAAA,sBAEe,CAACrI,EAAmB+F,KAChC,MAAM,cAAC0sB,EAAa,SAAEhuB,EAAQ,cAAE0tB,GAAiB/oB,KAAKpB,MACtD,OACIF,IAAAA,cAACisD,GAAAA,EAAc,CACXxnD,IAAKvM,EACL2yB,aAAc5sB,EACd/F,UAAWA,EACX0yB,aAAa,EACbD,cAAeA,EACfF,oBAAqB9tB,EAASkvB,UAC9BnB,kBAAmBL,EAAcvxB,OAASozD,EAAAA,GAAmBC,UAAY9hC,EAAclyB,KAAOwE,EAASxE,GACvG2yB,qBAAsBnuB,EAASqrD,UAAYK,GAAAA,EAAgBC,cAAgB3rD,EAASqrD,UAAYK,GAAAA,EAAgBG,SAClH,IAETjoD,GAAA,uBAEgB,KACb,MAAM,SAAC5D,GAAY2E,KAAKpB,MAExBoB,KAAKpB,MAAMwK,QAAQ0hD,qBAAqBzvD,EAASxE,IAAKwE,EAASkvB,UAAU,IAC5EtrB,GAAA,wBAEiB,KACVe,KAAK+qD,cAAcjnD,SACnB9D,KAAK+qD,cAAcjnD,QAAQlE,UAAUorD,OAAO,YAChD,IACH/rD,GAAA,sCAEgC8U,IAC7BA,EAAMvQ,iBAENxD,KAAKpB,MAAMqsD,kCAAkCl3C,EAAMm3C,YAAY,IAClEjsD,GAAA,uBAEgB,KACb,MAAM,cAAC8pB,EAAa,SAAE1tB,GAAY2E,KAAKpB,MAEvC,OAAIvD,EAAS7D,OAASqE,GAAAA,EAAcG,gBACzB+sB,EAAcvxB,OAASozD,EAAAA,GAAmBO,QAC1C9vD,EAAS7D,OAASqE,GAAAA,EAAcyY,UAChCyU,EAAcvxB,OAASozD,EAAAA,GAAmBQ,EAGzC,IACfnsD,GAAA,yBAEmB2d,IAChB,MAAM,cAACmM,EAAa,SAAE1tB,EAAQ,cAAEgwD,EAAa,WAAE1xD,GAAcqG,KAAKpB,MAElE,OAAKysD,GAAiB1xD,SAAAA,EAAYiB,OACvB,KAIP8D,IAAAA,cAAAA,IAAAA,SAAA,KACIA,IAAAA,cAACurB,GAAAA,UAAS,CACNC,YAAW,uBAAAxpB,OAAyBrF,EAASxE,IAC7Cy0D,gBAAgB,EAChB3uD,MAAO,IAELwtB,GAIMzrB,IAAAA,cAAA,KAAA6T,OAAAuI,OAAA,CACInU,IAAKwjB,EAASG,SACdD,UAAU,QACVpoB,UAAW,2CACPkoB,EAASa,eAAc,CAC3BtoB,UAAW,OAK3BhE,IAAAA,cAAA,OAAKuD,UAAU,8BACXvD,IAAAA,cAAA,OACIiI,IAAK3G,KAAK+qD,cACV9oD,UAAWI,IAAW,qCAAsC,CACxDkoB,UAAWlvB,EAASkvB,WAAcxB,EAAcvxB,OAASozD,EAAAA,GAAmBC,UAAY9hC,EAAclyB,KAAOwE,EAASxE,GACtH+lB,mBAEJ2uC,gBAAiBvrD,KAAKwrD,iBAEtB9sD,IAAAA,cAAA,KAAGuD,UAAU,oBACbvD,IAAAA,cAAA,QAAMuD,UAAU,oCACZvD,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,gDACH6K,eAAe,6BAKhC,IAEVzC,GAAA,wBAEiB,KACd,MAAM,WAACtF,EAAU,cAAEovB,EAAa,SAAE1tB,EAAQ,cAAEgwD,GAAiBrrD,KAAKpB,MAElE,OAAIvD,EAASqrD,UAAYK,GAAAA,EAAgBC,cACrC3rD,EAASqrD,UAAYK,GAAAA,EAAgBG,UACrCmE,KAEI1xD,EAAWyB,MAAMvE,GAAOA,IAAOkyB,EAAclyB,IAO1C,IA/JXmJ,KAAKsqD,iBAAmB5rD,IAAAA,YACxBsB,KAAK+qD,cAAgBrsD,IAAAA,YAErBsB,KAAKhJ,MAAQ,CACTykB,YAAY,GAGhBzb,KAAKwqD,uBAAwB,CACjC,CAEAjoC,kBAAAA,CAAmBC,GACXxiB,KAAKpB,MAAMvD,SAASkvB,YAAc/H,EAAUnnB,SAASkvB,WAAavqB,KAAK+qD,cAAcjnD,SACrF9D,KAAK+qD,cAAcjnD,QAAQlE,UAAUu4C,IAAI,YAEjD,CAEAnzC,iBAAAA,GAAoB,IAAAymD,EAAAC,EACa,QAA7BD,EAAAzrD,KAAKsqD,iBAAiBxmD,eAAO,IAAA2nD,GAA7BA,EAA+BrmD,iBAAiBumD,EAAAA,GAAqBC,SAAU5rD,KAAK6rD,yBACvD,QAA7BH,EAAA1rD,KAAKsqD,iBAAiBxmD,eAAO,IAAA4nD,GAA7BA,EAA+BtmD,iBAAiBumD,EAAAA,GAAqBG,WAAY9rD,KAAK+rD,0BAC1F,CAEAzmD,oBAAAA,GAAuB,IAAA0mD,EAAAC,EACU,QAA7BD,EAAAhsD,KAAKsqD,iBAAiBxmD,eAAO,IAAAkoD,GAA7BA,EAA+BzmD,oBAAoBomD,EAAAA,GAAqBC,SAAU5rD,KAAK6rD,yBAC1D,QAA7BI,EAAAjsD,KAAKsqD,iBAAiBxmD,eAAO,IAAAmoD,GAA7BA,EAA+B1mD,oBAAoBomD,EAAAA,GAAqBG,WAAY9rD,KAAK+rD,2BAErF/rD,KAAKwqD,uBACLxqD,KAAK+rD,2BAEb,CAsIAtmD,MAAAA,GACI,MAAM,SACFpK,EAAQ,cACR6wD,EAAa,WACbvyD,EAAU,cACV0xD,GACArrD,KAAKpB,MAET,IAAKvD,EACD,OAAO,KAGX,GAAIA,EAAS7D,OAASqE,GAAAA,EAAcE,YAAcpC,UAAAA,EAAYiB,QAC1D,OAAO,KAGX,MAAMuxD,EAAmBxyD,EAAWuC,IAAI8D,KAAKosD,eAE7C,IAAIC,EACAC,EAEAhwC,GAAgB,EACpB,GAAI+uC,EACAiB,EACI5tD,IAAAA,cAAA,OAAKuD,UAAU,4BACXvD,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,yCACH6K,eAAe,SAK3B2qD,EAAe3tD,IAAAA,cAACmnD,GAAmB,CAACxqD,SAAUA,SAC3C,GAAIA,EAAS7D,OAASqE,GAAAA,EAAcG,gBAAiB,CACxD,MAAMuwD,GAAen+C,EAAAA,GAAAA,GAAgB,CAACvX,GAAI,8BAA+B6K,eAAgB,8BAEzF2qD,EACI3tD,IAAAA,cAAAA,IAAAA,SAAA,KACIA,IAAAA,cAAC8oD,GAA0B,CACvBnsD,SAAUA,EACVwkD,8BAA+B7/C,KAAK6/C,gCAExCnhD,IAAAA,cAAC2kB,GAAAA,EAAW,CACR9U,MACI7P,IAAAA,cAAAA,IAAAA,SAAA,KACK6tD,EACD7tD,IAAAA,cAAC8tD,GAAAA,EAAwB,CACrB/I,SAAUgJ,GAAAA,EAAmBC,UAC7BC,iBAAiB,EACjBC,iBAAiB,MAK7BluD,IAAAA,cAAA,UACI7H,GAAG,yBACHoL,UAAU,sCACVM,QAASvC,KAAK6/C,8BACd,aAAY0M,GAEZ7tD,IAAAA,cAAA,KAAGuD,UAAU,iBAMxBtI,GAAeA,EAAWiB,SAC3B0hB,GAAgB,EAExB,MACI+vC,EAAe3tD,IAAAA,cAACmnD,GAAmB,CAACxqD,SAAUA,IAGlD,IAAI3B,EAAc2B,EAASsF,aAC3B,GAAItF,EAAS7D,OAASqE,GAAAA,EAAcC,OAAQ,CACxC,MAAM4O,EAAUmiD,GAAcxxD,EAAS7D,MACvCkC,GAAc0U,EAAAA,GAAAA,GAAgB,CAACvX,GAAI6T,EAAQ7T,GAAI6K,eAAgBgJ,EAAQhJ,gBAC3E,CAEA,OACIhD,IAAAA,cAACurB,GAAAA,UAAS,CACNC,YAAa7uB,EAASxE,GACtB8F,MAAOuvD,EACPY,mCAAmC,IAElC,CAAC3iC,EAAUC,KACR,IAAI2iC,EAAsB,KACJ,oBAAlB1xD,EAAS7D,MAA+B6D,EAASkvB,YACjDwiC,EACIruD,IAAAA,cAACyrD,GAAmB,CAChBloD,UAAU,sBAKtB,IAAI+qD,EAAuB,KAO3B,MANsB,aAAlB3xD,EAAS7D,MAAwB6D,EAASkvB,YAC1CyiC,EACItuD,IAAAA,cAACgqD,GAAoB,OAKzBhqD,IAAAA,cAAA,MAAA6T,OAAAuI,OAAA,CACI7Y,UAAWI,IAAW,oCAAqC,CACvD4qD,aAAcjtD,KAAKktD,iBACnBC,WAAYntD,KAAKhJ,MAAMykB,WACvB2xC,QAASptD,KAAKpB,MAAMmqB,cAAc/xB,QAAUq2D,EAAAA,GAAeC,QAC3DjxC,YAAahhB,EAASkvB,YAE1B5jB,IAAKwjB,EAASG,UACVH,EAASa,gBAEbtsB,IAAAA,cAAC6uD,GAAAA,UAAS,CACNC,YAAanyD,EAASxE,GACtBW,KAAK,kBACL01D,eAAgBltD,KAAKktD,mBAEpB,CAACO,EAAmBC,IAEbhvD,IAAAA,cAAA,MAAA6T,OAAAuI,OAAA,GACQ2yC,EAAkBE,eAAc,CACpChnD,IAAK8mD,EAAkBnjC,SACvBroB,UAAWI,IAAW,CAClBwoB,aAAc6iC,EAAkB9wC,mBAGpCle,IAAAA,cAACyd,GAAAA,EAAqB,CAClBxV,IAAK3G,KAAKsqD,iBACV5wD,YAAaA,EACb0iB,gBAAiB+N,EAAS/N,gBAC1BC,YAAahhB,EAASkvB,UACtBjO,cAAeA,EACfC,WAAY6N,EAAS7N,WACrBK,eAAgB8wC,EAAkB9wC,eAClCJ,MAAOnhB,EAASmhB,MAChBja,QAASvC,KAAK0qD,gBAEb4B,EAtHa,KAwHbD,GAEL3tD,IAAAA,cAAA,OACIuD,UAAWI,IAAW,gCAEtB3D,IAAAA,cAAA,MACIuD,UAAU,mBAETjC,KAAK4tD,iBAAiBF,EAAkB9wC,gBACxCuvC,EACAnsD,KAAK6tD,kBAAoBJ,EAAkB7mD,YAAc,UAOjFmmD,EACAC,EACC,GAK1B,EAGJ,MAAMH,IAAgB9jD,EAAAA,GAAAA,gBAAe,CACjCrD,SAAU,CACN7O,GAAI,yBACJ6K,eAAgB,YAEpBosD,gBAAiB,CACbj3D,GAAI,gCACJ6K,eAAgB,mBAEpBqsD,UAAW,CACPl3D,GAAI,0BACJ6K,eAAgB,eCrWxB,IAAe2N,EAAAA,EAAAA,UAvBf,WACI,MAAM2+C,GAA2BC,EAAAA,GAAAA,KAEjC,MAAO,CAACj3D,EAAoBymB,KACjB,CACH9jB,WAAYq0D,EAAyBh3D,EAAOymB,EAASpiB,UACrD0tB,eAAeC,EAAAA,GAAAA,IAAiBhyB,GAChCuT,eAAemF,EAAAA,EAAAA,IAAiB1Y,GAChCk3D,SAASA,EAAAA,GAAAA,KAAQ91C,EAAAA,EAAAA,IAAephB,GAAOmgB,QAGnD,IAEA,SAA4BrgB,GACxB,MAAO,CACHsS,SAASgH,EAAAA,EAAAA,IAAmB,CACxB06C,qBAAoB,MACpBnE,mBAAkB,MAClBx/B,gBAAeA,GAAAA,IAChBrwB,GAEX,GAEA,CAAgEszD,I,0ZCjBhE,MAAM+D,IAAaje,EAAAA,EAAAA,GAAmB,cAAcC,EAAAA,EAAAA,OAAK,IAAM,mCACzDie,IAAoBle,EAAAA,EAAAA,GAAmB,qBAAqBC,EAAAA,EAAAA,OAAK,IAAM,mCACvEke,IAAyBne,EAAAA,EAAAA,GAAmB,0BAA0BC,EAAAA,EAAAA,OAAK,IAAM,kCACjFme,IAAiBpe,EAAAA,EAAAA,GAAmB,kBAAkBC,EAAAA,EAAAA,OAAK,IAAM,mCAiDhE,MAAMoe,WAAoB7vD,IAAAA,cAM7BK,WAAAA,CAAYH,GAAc,IAAAo/B,EACtBh/B,MAAMJ,GAAMo/B,EAAAh+B,KAAAf,GAAA,+BAkDS,IACde,KAAKpB,MAAM5D,kBAAkBkB,KAAKV,GAAYA,EAAQ3E,OAChEoI,GAAA,kCAE2B,IACjBe,KAAKpB,MAAM4vD,YAAYtyD,KAAKiM,GAASA,EAAKtR,OACpDoI,GAAA,sBAEe,CAACrI,EAAmB+P,KAC5BA,EACA3G,KAAKyuD,YAAYC,IAAI93D,EAAW+P,GAEhC3G,KAAKyuD,YAAYnY,OAAO1/C,EAC5B,IACHqI,GAAA,gDAE0CtF,GAChCA,EAAWyB,MAAMxE,GACbA,IAAcoJ,KAAKpB,MAAMye,kBAAoBrd,KAAKpB,MAAM+vD,iBAAiB15C,SAASre,OAEhGqI,GAAA,oCAE8B2vD,IAAmB,IAAAC,EAAA77C,EAC9C,MAAM87C,EAAMF,EAAOG,kBACa,QAAhCF,GAAA77C,EAAAhT,KAAKgvD,UAAUlrD,SAASC,gBAAQ,IAAA8qD,GAAhCA,EAAAj7B,KAAA5gB,EAAmC,CAAChP,IAAK8qD,GAAK,IACjD7vD,GAAA,mCAE4B,KACzBe,KAAKivD,gBAAgBjvD,KAAKkvD,yBAAyB,EAAK,IAC3DjwD,GAAA,kCAE2B,KACxBe,KAAKivD,gBAAgBjvD,KAAKmvD,wBAAwB,EAAK,IAC1DlwD,GAAA,wBAEiB,SAACrI,GAAoE,IAA9Bw4D,EAAiBz0D,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,GACtE,IAAK/D,EACD,OAGJ,MAAMwqB,EAAU4c,EAAKywB,YAAYn1B,IAAI1iC,GACrC,IAAKwqB,EACD,OAGJ,MAAMpd,EAAMod,EAAQiuC,UACdnrB,EAASlgC,EAAMod,EAAQkuC,aAEvB3lB,EAAY3L,EAAKgxB,UAAUlrD,QAAS6lC,UACpClE,EAAezH,EAAKgxB,UAAUlrD,QAAS2hC,aAE7C,GAAIzhC,EAAO2lC,EAlHU,GAkHyB,CAE1C,MAAM4lB,EAAUH,IAAsBpxB,EAAKhnC,MAAMw4D,cAvHxC,GAOU,GAkHnB,IAAIC,EACJ,MAAMz0D,EAAoBgjC,EAAK0xB,yBAG3BD,EAFAz0D,EAAkBJ,OAAS,GAAKI,EAAkB,KAAOpE,EAE7C,EAEAoN,EAAMurD,EA5HL,GA+HjBvxB,EAAK2xB,iBAAiBF,EAC1B,MAAO,GAAIvrB,EAASyF,EAAYlE,EAAc,CAE1C,MACMgqB,EAAavrB,EAASuB,GADZ2pB,IAAsBpxB,EAAKhnC,MAAM44D,iBArIxC,GAOU,IAiInB5xB,EAAK2xB,iBAAiBF,EAC1B,CACJ,IAACxwD,GAAA,yBAEmBwwD,IAEhBzvD,KAAK6vD,gBAAgBC,gBAAgB9vD,KAAKgvD,UAAUlrD,QAAS6lC,WAAWomB,YAExE/vD,KAAK6vD,gBAAgBG,YAAYP,EAAU,IAC9CxwD,GAAA,+BAEwB,KACrB,GAAIe,KAAKpB,MAAMmqB,cAAc/xB,MAKzB,YAJAgJ,KAAKC,SAAS,CACVuvD,eAAe,EACfI,kBAAkB,IAK1B,IAAIJ,GAAgB,EAChBI,GAAmB,EAGvB,MAAMK,EAAqBjwD,KAAKkvD,wBAC1BvW,EAAoB34C,KAAKmvD,uBAE/B,GAAIc,EAAoB,CACpB,MAAMC,EAAqBlwD,KAAKyuD,YAAYn1B,IAAI22B,GAE5CC,GAAwBA,EAAmBb,UAAYa,EAAmBZ,aAtKrE,GAGQ,GAmKoHtvD,KAAKgvD,UAAUlrD,QAAS6lC,YACzJ6lB,GAAgB,EAExB,CAEA,GAAI7W,EAAmB,CACnB,MAAMwX,EAAoBnwD,KAAKyuD,YAAYn1B,IAAIqf,GAE3CwX,GAAsBA,EAAkBd,UA9KnC,GA8KgErvD,KAAKgvD,UAAUlrD,QAAS6lC,UAAY3pC,KAAKgvD,UAAUlrD,QAAS2hC,eACjImqB,GAAmB,EAE3B,CAEIJ,IAAkBxvD,KAAKhJ,MAAMw4D,eAAiBI,IAAqB5vD,KAAKhJ,MAAM44D,kBAC9E5vD,KAAKC,SAAS,CACVuvD,gBACAI,oBAER,IACH3wD,GAAA,8BAEuB,IACbe,KAAKowD,wCAAwCpwD,KAAK0vD,4BAC5DzwD,GAAA,6BAEsB,IACZe,KAAKowD,wCAAwCpwD,KAAK0vD,yBAAyBW,aACrFpxD,GAAA,qBAEepI,KACkD,IAA1DmJ,KAAKpB,MAAM4vD,YAAY5mB,WAAWmL,GAAMA,EAAEl8C,KAAOA,IACjDmJ,KAAKpB,MAAMwK,QAAQknD,oBAAoBz5D,GAEvCmJ,KAAKpB,MAAMwK,QAAQmnD,sBAAsB15D,EAC7C,IACHoI,GAAA,gCAE0BC,IACvB,IAAIA,EAAES,QAAWT,EAAEO,UAAaP,EAAEQ,SAAYR,EAAEsxD,WAAYnxD,EAAAA,GAAAA,GAAaH,EAAGI,EAAAA,GAAUC,SAASkxD,OAAOpxD,EAAAA,GAAAA,GAAaH,EAAGI,EAAAA,GAAUC,SAASmxD,OAqB9HzuC,EAAAA,GAAAA,GAAiB/iB,IAAMA,EAAEO,WAAYJ,EAAAA,GAAAA,GAAaH,EAAGI,EAAAA,GAAUC,SAASslD,IAC/E7kD,KAAKpB,MAAMqsD,kCAAkC/rD,OAtBgG,CAC7IA,EAAEsE,iBAEF,MAAMmtD,EAAgB3wD,KAAK4wD,4BACrBC,EAAS,IAAIF,KAAkB3wD,KAAK0vD,0BAEpCoB,EAAgB9wD,KAAKpB,MAAMye,kBAAoBrd,KAAKpB,MAAMmyD,oBAC1DC,EAAWH,EAAO72D,QAAQ82D,GAEhC,IAAIG,EAEAA,GADA5xD,EAAAA,GAAAA,GAAaH,EAAGI,EAAAA,GAAUC,SAASmxD,MACvBM,EAAW,EAEXA,EAAW,EAG3B,MAAME,EAASL,GAAOM,EAAAA,EAAAA,IAAIF,EAAWJ,EAAOj2D,SAC5CoF,KAAKoxD,aAAaF,GACdD,GAAaN,EAAc/1D,QAC3BoF,KAAKivD,gBAAgBiC,EAE7B,CAEA,IACHjyD,GAAA,sCAEgCC,IAC7B,GAAIA,EAAES,QAAUT,EAAEO,WAAaP,EAAEQ,UAAYR,EAAEsxD,WAAYnxD,EAAAA,GAAAA,GAAaH,EAAGI,EAAAA,GAAUC,SAASkxD,MAAOpxD,EAAAA,GAAAA,GAAaH,EAAGI,EAAAA,GAAUC,SAASmxD,OAAQ,CAC5IxxD,EAAEsE,iBAEF,MAAM6tD,EAAgBrxD,KAAK0vD,yBACrBf,EAAmB,IAAI3uD,KAAKpB,MAAM+vD,kBAEpC3uD,KAAKpB,MAAMg4C,mBACXya,EAAcC,QAAQ,IAElBtxD,KAAKpB,MAAM2yD,kBACX5C,EAAiB2C,QAAQ,KAIjC,IAAIE,EAAY,EAEZA,GADAnyD,EAAAA,GAAAA,GAAaH,EAAGI,EAAAA,GAAUC,SAASkxD,KACtB,EAED,EAGhB,MAAMQ,GAAYQ,EAAAA,EAAAA,IACdzxD,KAAKpB,MAAMye,iBACXg0C,EACA1C,EACA6C,GAGJ,IAAmB,IAAfP,EAAkB,CAClB,MAAMS,EAAgBL,EAAcJ,GACpCjxD,KAAKoxD,aAAaM,GAClB1xD,KAAKivD,gBAAgByC,EACzB,CACJ,KACHzyD,GAAA,uBAEgB,CAAC5D,EAA2BsB,IAErC+B,IAAAA,cAAC0rD,GAAe,CACZjnD,IAAK9H,EAASxE,GACdwE,SAAUA,EACV6wD,cAAevvD,EACf0sB,cAAerpB,KAAKqpB,cACpB4hC,kCAAmCjrD,KAAKpB,MAAMqsD,kCAC9CI,cAAerrD,KAAKpB,MAAM+yD,eAAe18C,SAAS5Z,EAASxE,QAGtEoI,GAAA,gBAEU2yD,MAAS,KAChB5xD,KAAK6xD,wBAAwB,GAC9B,MAAI5yD,GAAA,uBAEW2yD,MAAS,KACvB5xD,KAAK6xD,wBAAwB,GAC9B,MAAI5yD,GAAA,wBAEY6yD,IAEf9xD,KAAKyuD,YAAY10D,SAAS4M,GAAQA,EAAI/G,UAAUorD,OAAO,eAGvD,MAAM+G,EAAY,IAAI5sD,SAAS6sD,iBAAiC,oDAChED,EAAU,GAAGntB,MAAMjhB,OAAS,GAAHjjB,OAAMqxD,EAAU,GAAGrsB,aAAY,MAEnD1lC,KAAKpB,MAAMhF,wBAAwBwB,MAAMvE,GAAOi7D,EAAO5nC,cAAgBrzB,KACxEmJ,KAAKpB,MAAMwK,QAAQ9L,wBAGvB,MAAMyrB,EAA+B,CACjC/xB,MAAOq2D,EAAAA,GAAeC,QACtBz2D,GAAIi7D,EAAO5nC,aAGf,GAAIlqB,KAAKpB,MAAM9D,WAAWq3C,MAAM92C,GAAaA,EAASxE,KAAOi7D,EAAO5nC,cAChEnB,EAAcvxB,KAAOozD,EAAAA,GAAmBC,aACrC,CACH,MAAMoH,EAAmBjyD,KAAKpB,MAAM5D,kBAAkBM,QAAQE,IAAwE,IAA5DwE,KAAKpB,MAAMhF,wBAAwBI,QAAQwB,EAAQ3E,KAAc2E,EAAQ3E,KAAOi7D,EAAO5nC,cAC7J+nC,EAAiB/8C,OAAO1Z,GAAYA,EAAQhE,OAASkE,GAAAA,GAAQC,YAAcH,EAAQhE,OAASkE,GAAAA,GAAQE,aACpGmtB,EAAcvxB,KAAOozD,EAAAA,GAAmBQ,GACjC6G,EAAiB/8C,OAAO1Z,GAAYA,EAAQhE,OAASkE,GAAAA,GAAQC,YAAcH,EAAQhE,OAASkE,GAAAA,GAAQE,aAC3GmtB,EAAcvxB,KAAOozD,EAAAA,GAAmBO,QAExCpiC,EAAcvxB,KAAOozD,EAAAA,GAAmBsH,cAEhD,CAEAlyD,KAAKpB,MAAMwK,QAAQhQ,iBAAiB2vB,EAAc,IACrD9pB,GAAA,0BAEmB,KAChBe,KAAKpB,MAAMwK,QAAQhQ,iBAAiB,CAACpC,MAAOq2D,EAAAA,GAAe8E,QAAQ,IACtElzD,GAAA,oBAEcmzD,IACXpyD,KAAKpB,MAAMyzD,YAAYD,GAEvBpyD,KAAKpB,MAAMwK,QAAQhQ,iBAAiB,CAACpC,MAAOq2D,EAAAA,GAAeiF,SAGzC,IAAIntD,SAAS6sD,iBAAiC,oDACtD,GAAGptB,MAAMjhB,OAAS,EAAE,IACjC1kB,GAAA,kBAEY/E,IACT8F,KAAKpB,MAAM2zD,UAAUr4D,GAEC,SAAlBA,EAAOs4D,QAAqBt4D,EAAOu4D,cACf,oBAAhBv4D,EAAO1C,KACPwI,KAAKpB,MAAMwK,QAAQ7O,sBAAsBL,EAAOu4D,YAAYjF,YAAatzD,EAAOu4D,YAAY91D,MAAOzC,EAAOgwB,aACnF,qBAAhBhwB,EAAO1C,MACdwI,KAAKpB,MAAMwK,QAAQspD,aAAa1yD,KAAKpB,MAAM+U,YAAa9c,GAAIqD,EAAOgwB,YAAahwB,EAAOu4D,YAAY91D,QAI3GqD,KAAKpB,MAAMwK,QAAQ9P,cAAc,IAxUjC0G,KAAKyuD,YAAc,IAAIkE,IACvB3yD,KAAKhJ,MAAQ,CACTw4D,eAAe,EACfI,kBAAkB,GAEtB5vD,KAAKgvD,UAAYtwD,IAAAA,YAEjBsB,KAAK4yD,QAAU,IAAIC,GAAAA,aACnB7yD,KAAK6vD,gBAAkB7vD,KAAK4yD,QAAQE,eACpC9yD,KAAK6vD,gBAAgBkD,6BAA4B,GACjD/yD,KAAK6vD,gBAAgB5mB,YAAY,CAAC+pB,eAAgBhzD,KAAKizD,6BAC3D,CAEAjuD,iBAAAA,GACIG,SAASC,iBAAiB,UAAWpF,KAAKkzD,yBAC1C/tD,SAASC,iBAAiB,UAAWpF,KAAKmzD,8BAC9C,CAEA7tD,oBAAAA,GACIH,SAASI,oBAAoB,UAAWvF,KAAKkzD,yBAC7C/tD,SAASI,oBAAoB,UAAWvF,KAAKmzD,8BACjD,CAEA5wC,kBAAAA,CAAmBC,GACVxiB,KAAKpB,MAAMye,kBAAqBmF,EAAUnF,mBAK3Crd,KAAKpB,MAAM+U,cAAgB6O,EAAU7O,aACrC3T,KAAKgvD,UAAUlrD,QAASC,SAAS,CAACC,IAAK,IAIvChE,KAAKpB,MAAMye,iBAAqBmF,EAAUnF,iBAO1Crd,KAAKpB,MAAMye,mBAAqBmF,EAAUnF,kBAC1Crd,KAAKpB,MAAMwK,QAAQgqD,QAGvBpzD,KAAK6xD,yBACT,CA6RApsD,MAAAA,GACI,MAAM,WAAC3K,GAAckF,KAAKpB,MAE1B,IAAI0N,EACJ,GAAItM,KAAKpB,MAAM4lD,sBACXl4C,EACI5N,IAAAA,cAAC4vD,GAAc,CACXjlC,cAAerpB,KAAKqpB,oBAGzB,CACH,IAAIgqC,EACArzD,KAAKpB,MAAMqmD,sBACXoO,EACI30D,IAAAA,cAAC4vD,GAAc,CACXjlC,cAAerpB,KAAKqpB,iBAKhC,MAAMiqC,EAAqBx4D,EAAWoB,IAAI8D,KAAKuzD,gBAE/CjnD,EACI5N,IAAAA,cAAAA,IAAAA,SAAA,KACK20D,EACD30D,IAAAA,cAAC80D,GAAAA,gBAAe,CACZjB,UAAWvyD,KAAKuyD,UAChBkB,kBAAmBzzD,KAAKyzD,kBACxBC,gBAAiB1zD,KAAK0zD,gBACtBrB,YAAaryD,KAAKqyD,aAElB3zD,IAAAA,cAAC6uD,GAAAA,UAAS,CACNC,YAAY,uBACZh2D,KAAK,qBAEH2yB,GAEMzrB,IAAAA,cAAA,MAAA6T,OAAAuI,OAAA,CACIjkB,GAAI,+BACJ8P,IAAKwjB,EAASG,UACVH,EAASwjC,gBAEZ2F,EACAnpC,EAASvjB,gBAQ1C,CAEA,MAAM+sD,EACFj1D,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,kBACH6K,eAAe,iBAIjBkyD,EACFl1D,IAAAA,cAACkD,GAAAA,iBAAgB,CACb/K,GAAG,kBACH6K,eAAe,iBAIjBjB,EAAYT,KAAKpB,MAAM4C,KAAKC,cAAc,CAAC5K,GAAI,iCAAkC6K,eAAgB,2BAEvG,OAGIhD,IAAAA,cAAAA,IAAAA,SAAA,KACIA,IAAAA,cAAC0vD,GAAiB,MAClB1vD,IAAAA,cAACyvD,GAAU,MACXzvD,IAAAA,cAAA,OACI7H,GAAG,eACHuM,KAAK,cACL,aAAY3C,EACZwB,UAAWI,IAAW,mCAAoC,CACtDG,SAAUxC,KAAKpB,MAAM4lD,wBAEzB,wBAAuB/hD,QAAQzC,KAAKpB,MAAMmqB,cAAcvxB,MACxD,uBAAqB,IACrB+zD,gBAAiBvrD,KAAKurD,iBAEtB7sD,IAAAA,cAAC2vD,GAAsB,CACnBlsD,KAAK,MACLqU,KAAMxW,KAAKhJ,MAAMw4D,cACjBjtD,QAASvC,KAAK6zD,2BACdC,WAAW,kCACX9vC,QAAS2vC,IAEbj1D,IAAAA,cAAC2vD,GAAsB,CACnBlsD,KAAK,SACLqU,KAAMxW,KAAKhJ,MAAM44D,iBACjBrtD,QAASvC,KAAK+zD,0BACdD,WAAW,qCACX9vC,QAAS4vC,IAEbl1D,IAAAA,cAACs1D,GAAAA,EAAU,CACPrtD,IAAK3G,KAAKgvD,UACVnkB,SAAU7qC,KAAK6qC,UAEdv+B,IAKrB,EACHrN,GAlcYsvD,GAAW,aA7CpBlxC,iBAAgBxU,IAAAA,OAAAC,WAChBhO,WAAU+N,IAAAA,MAAAC,WACV6lD,iBAAgB9lD,IAAAA,QAAAA,IAAAA,QAAAC,WAChB07C,sBAAqB37C,IAAAA,KAAAC,WACrB9N,kBAAiB6N,IAAAA,MAAAC,WACjB6oD,eAAc9oD,IAAAA,QAAAA,IAAAA,QAAAC,WAEdlP,wBAAuBiP,IAAAA,QAAAA,IAAAA,QAAAC,WACvBm8C,oBAAmBp8C,IAAAA,KAAAC,WACnB8tC,iBAAgB/tC,IAAAA,KAAAC,WAChByoD,iBAAgB1oD,IAAAA,KAAAC,WAChBioD,oBAAmBloD,IAAAA,OAAAC,WACnB0lD,YAAW3lD,IAAAA,MAAAC,WAEXmiD,kCAAiCpiD,IAAAA,KAAAC,WACjCupD,YAAWxpD,IAAAA,KAAAC,WACXypD,UAAS1pD,IAAAA,KAAAC,WAETM,QAAOP,IAAAA,MAAA,CACHtO,sBAAqBsO,IAAAA,KAAAC,WACrB4pD,aAAY7pD,IAAAA,KAAAC,WACZwnD,oBAAmBznD,IAAAA,KAAAC,WACnBynD,sBAAqB1nD,IAAAA,KAAAC,WACrBsqD,MAAKvqD,IAAAA,KAAAC,WACL1P,iBAAgByP,IAAAA,KAAAC,WAChBxP,aAAYuP,IAAAA,KAAAC,WACZxL,sBAAqBuL,IAAAA,KAAAC,aAAAA,aAud7B,UAAeE,EAAAA,GAAAA,YAAWulD,IC3c1B,IAAel/C,EAAAA,EAAAA,UA1Cf,SAAyBrY,GACrB,MAAM2c,GAAcpE,EAAAA,EAAAA,IAAevY,GAC7B4/C,GAAmBzW,EAAAA,EAAAA,IAA0BnpC,GAEnD,IAAIu6D,GAAmB,EACD,IAAA0C,EAItB,OAJIrd,IACA2a,EAAmB9uD,QAA2C,QAApCwxD,GAACC,EAAAA,GAAAA,IAA6Bl9D,UAAM,IAAAi9D,OAAA,EAAnCA,EAAqCE,uBAG7D,CACHxgD,cACA0J,kBAAkB5f,EAAAA,EAAAA,IAAoBzG,GACtC8D,YAAYC,EAAAA,GAAAA,IAA4B/D,GACxCwtD,uBAAuBA,EAAAA,GAAAA,IAAsBxtD,GAC7C23D,kBAAkByF,EAAAA,EAAAA,IAAoBp9D,GACtCgE,mBAAmBC,EAAAA,GAAAA,IAAqBjE,GACxC+xB,eAAeC,EAAAA,GAAAA,IAAiBhyB,GAChC26D,eAAgB36D,EAAM6C,MAAMC,eAAe63D,eAC3C/3D,wBAAyB5C,EAAM6C,MAAMC,eAAeF,wBACpDqrD,qBAAqBE,EAAAA,EAAAA,IAA0BnuD,GAC/C4/C,mBACA2a,mBACAR,qBAAqBsD,EAAAA,EAAAA,IAAuBr9D,GAC5Cw3D,aAAa8F,EAAAA,EAAAA,IAAsBt9D,GAE3C,IAEA,SAA4BF,GACxB,MAAO,CACHsS,SAASgH,EAAAA,EAAAA,IAAmB,CACxBgjD,MAAK,MACL9C,oBAAmB,KACnB/1D,sBAAqB,MACrBm4D,aAAY,MACZt5D,iBAAgB,MAChBE,aAAY,MACZgE,sBAAqB,MACrBizD,sBAAqBA,GAAAA,IACtBz5D,GAEX,GAEA,CAA4Dy3D,I,0ZCrD5D,MAAMgG,IAAsBrkB,EAAAA,EAAAA,GAAmB,uBAAuBC,EAAAA,EAAAA,OAAK,IAAM,mCAC3EqkB,IAAqBtkB,EAAAA,EAAAA,GAAmB,sBAAsBC,EAAAA,EAAAA,OAAK,IAAM,mCACzElnC,IAAiBinC,EAAAA,EAAAA,GAAmB,kBAAkBC,EAAAA,EAAAA,OAAK,IAAM,2CACjEj8B,IAAoBg8B,EAAAA,EAAAA,GAAmB,qBAAqBC,EAAAA,EAAAA,OAAK,IAAM,2CACvEskB,IAAwBvkB,EAAAA,EAAAA,GAAmB,yBAAyBC,EAAAA,EAAAA,OAAK,IAAM,2CAC/Etd,IAAkBqd,EAAAA,EAAAA,GAAmB,mBAAmBC,EAAAA,EAAAA,OAAK,IAAM,2CACnEukB,IAAyBxkB,EAAAA,EAAAA,GAAmB,0BAA0BC,EAAAA,EAAAA,OAAK,IAAM,2CACjF1mC,IAAkBymC,EAAAA,EAAAA,GAAmB,mBAAmBC,EAAAA,EAAAA,OAAK,IAAM,2CACnEwkB,IAAoBzkB,EAAAA,EAAAA,GAAmB,qBAAqBC,EAAAA,EAAAA,OAAK,IAAM,2CA4B9D,MAAMykB,WAAgBl2D,IAAAA,cACjCK,WAAAA,CAAYH,GACRI,MAAMJ,GAAOK,GAAA,yCA2BmB8U,IAC5BA,EAAMgO,kBAIV/hB,KAAKpB,MAAMwK,QAAQ9L,uBAAuB,IAC7C2B,GAAA,2BAEqB8U,KACd1U,EAAAA,GAAAA,GAAa0U,EAAOzU,EAAAA,GAAUC,SAAS0+B,QACvCj+B,KAAKpB,MAAMwK,QAAQ9L,yBAIM2kB,EAAAA,GAAAA,GAAiBlO,GAAO,MAG7C1U,EAAAA,GAAAA,GAAa0U,EAAOzU,EAAAA,GAAUC,SAASs1D,gBACvC9gD,EAAMvQ,iBACFxD,KAAKpB,MAAMk2D,4BACX90D,KAAKpB,MAAMwK,QAAQ/I,WAAWC,EAAAA,GAAiBy0D,0BAE/C/0D,KAAKpB,MAAMwK,QAAQC,UAAU,CACzBC,QAAShJ,EAAAA,GAAiBy0D,yBAC1BvrD,WAAYkrD,OAGbr1D,EAAAA,GAAAA,GAAa0U,EAAOzU,EAAAA,GAAUC,SAASy1D,IAAMjhD,EAAMtU,WAC1DsU,EAAMvQ,iBAENxD,KAAKpB,MAAMwK,QAAQC,UAAU,CACzBC,QAAShJ,EAAAA,GAAiB20D,cAC1BzrD,WAAYmrD,GACZxgD,YAAa,CACT+gD,0BAA0B,EAC1BpiC,mBAAoB,kBAIpC,IACH7zB,GAAA,oCAE6B,KAC1Be,KAAKC,SAAS,CAACk1D,yBAAyB,GAAM,IACjDl2D,GAAA,oCAE6B,KAC1Be,KAAKC,SAAS,CAACk1D,yBAAyB,GAAO,IAClDl2D,GAAA,gCAEyB,KACtBe,KAAKpB,MAAMwK,QAAQC,UAAU,CACzBC,QAAShJ,EAAAA,GAAiB2T,cAC1BzK,WAAY0K,GACZC,YAAa,CAAC,GAChB,IACLlV,GAAA,8BAEuB,KACpBe,KAAKpB,MAAMwK,QAAQC,UAAU,CACzBC,QAAShJ,EAAAA,GAAiBC,cAC1BiJ,WAAYP,IACd,IACLhK,GAAA,0BAEmB,KAChBe,KAAKpB,MAAMwK,QAAQC,UAAU,CACzBC,QAAShJ,EAAAA,GAAiBsyB,WAC1BppB,WAAYqpB,GACZ1e,YAAa,CAAC2e,mBAAoB,iCACpC,IACL7zB,GAAA,4BAEqB,KAClBe,KAAKpB,MAAMwK,QAAQC,UAAU,CACzBC,QAAShJ,EAAAA,GAAiBiJ,kBAC1BC,WAAYC,KAEhBzJ,KAAKmJ,cAAc,IACtBlK,GAAA,iCAE0B,KACvBe,KAAKpB,MAAMwK,QAAQC,UAAU,CACzBC,QAAShJ,EAAAA,GAAiB80D,mBAC1B5rD,WAAYirD,IACd,IACLx1D,GAAA,0CAEoCC,IACjCA,SAAAA,EAAGsE,iBACCxD,KAAKhJ,MAAMm+D,wBACXn1D,KAAKq1D,+BAELr1D,KAAKs1D,8BACLt1D,KAAKmJ,eACT,IACHlK,GAAA,oBAEa,KACVe,KAAKC,SAAS,CAACsc,YAAY,GAAM,IACpCtd,GAAA,kBAEW,KACRe,KAAKC,SAAS,CAACsc,YAAY,GAAO,IACrCtd,GAAA,qBAEc,KACX,IAAIs2D,EAWJ,OAVIv1D,KAAKhJ,MAAMm+D,0BACXI,EACI72D,IAAAA,cAAC81D,GAAkB,CACfgB,iBAAkBx1D,KAAKq1D,4BACvBI,mBAAmB,EACnB3iC,mBAAmB,4BAM3Bp0B,IAAAA,cAAAA,IAAAA,SAAA,KACK62D,EACF,IAEVt2D,GAAA,qBAEc,KACPe,KAAKpB,MAAM8K,SAAW1J,KAAKpB,MAAM+K,WAAaC,EAAAA,GAAUC,cACxD7J,KAAKpB,MAAMwK,QAAQU,oBACvB,IA1JA9J,KAAKhJ,MAAQ,CACTm+D,yBAAyB,EACzB54C,YAAY,EAEpB,CAEAvX,iBAAAA,GACQhF,KAAKpB,MAAMnF,QACXuG,KAAKpB,MAAMwK,QAAQssD,kBAAkB11D,KAAKpB,MAAMnF,QAGpD0R,OAAO/F,iBAAiB,QAASpF,KAAK21D,kCACtCxqD,OAAO/F,iBAAiB,UAAWpF,KAAK41D,mBAC5C,CAEArzC,kBAAAA,CAAmBC,GACXxiB,KAAKpB,MAAMnF,QAAU+oB,EAAU/oB,SAAWuG,KAAKpB,MAAMnF,QACrDuG,KAAKpB,MAAMwK,QAAQssD,kBAAkB11D,KAAKpB,MAAMnF,OAExD,CAEA6L,oBAAAA,GACI6F,OAAO5F,oBAAoB,QAASvF,KAAK21D,kCACzCxqD,OAAO5F,oBAAoB,UAAWvF,KAAK41D,mBAC/C,CAqIAnwD,MAAAA,GACI,IAAKzF,KAAKpB,MAAMnF,OACZ,OAAQiF,IAAAA,cAAA,YAGZ,MAAM+B,GAAY2N,EAAAA,EAAAA,IAAgB,CAACvX,GAAI,sCAAuC6K,eAAgB,6BAE9F,OACIhD,IAAAA,cAACm6C,GAAY,CACThiD,GAAG,mBACHoL,UAAWI,IAAW,CAClB,cAAerC,KAAKpB,MAAMod,QAAUhc,KAAKpB,MAAMg2B,aAC/CjY,SAAU3c,KAAKhJ,MAAMulB,cAGxBvc,KAAKpB,MAAMg2B,aAAel2B,IAAAA,cAAC61D,GAAmB,MAC3C71D,IAAAA,cAAC0gD,GAAa,CACVK,oBAAqBz/C,KAAKy/C,oBAC1BE,sBAAuB3/C,KAAK2/C,sBAC5BK,yBAA0BhgD,KAAKggD,yBAC/BK,kBAAmBrgD,KAAKqgD,kBACxBF,wBAAyBngD,KAAKmgD,wBAC9Bd,iBAAkBr/C,KAAKpB,MAAMi3D,yBAA2B71D,KAAKpB,MAAMoqD,uBACnE1J,qBAAsBt/C,KAAKpB,MAAM0gD,qBACjCO,8BAA+B7/C,KAAKirD,kCACpChL,oBAAqBjgD,KAAKpB,MAAMqhD,oBAChCH,sBAAuB9/C,KAAKpB,MAAMkhD,wBAG1CphD,IAAAA,cAAA,OACI7H,GAAG,eACHuM,KAAK,cACL,aAAY3C,EACZwB,UAAU,eACV,uBAAqB,KAErBvD,IAAAA,cAAC+lD,GAAgB,OAErB/lD,IAAAA,cAAA,OAAKuD,UAAU,wBACXvD,IAAAA,cAACulB,GAAAA,QAAS,CAACC,cAAc,uBAE7BxlB,IAAAA,cAAC6vD,GAAW,CACRtD,kCAAmCjrD,KAAKirD,kCACxCoH,YAAaryD,KAAKqyD,YAClBE,UAAWvyD,KAAKuyD,YAEpB7zD,IAAAA,cAAC+4C,GAAY,MACZz3C,KAAK81D,eAGlB,EACH72D,GAnNoB21D,GAAO,aAzBxBn7D,OAAMoP,IAAAA,OAAAC,WACNkgD,uBAAsBngD,IAAAA,KAAAC,WACtB+sD,wBAAuBhtD,IAAAA,KAAAC,WACvBw2C,qBAAoBz2C,IAAAA,KAAAC,WACpBkT,OAAMnT,IAAAA,KAAAC,WACNM,QAAOP,IAAAA,MAAA,CACH6sD,kBAAiB7sD,IAAAA,KAAAC,WACjBO,UAASR,IAAAA,KAAAC,WACTzI,WAAUwI,IAAAA,KAAAC,WACVxL,sBAAqBuL,IAAAA,KAAAC,WACrBgB,mBAAkBjB,IAAAA,KAAAC,aAAAA,WAEtBm3C,oBAAmBp3C,IAAAA,KAAAC,WACnB8rB,aAAY/rB,IAAAA,KAAAC,WACZgsD,4BAA2BjsD,IAAAA,KAAAC,WAC3Bg3C,sBAAqBj3C,IAAAA,KAAAC,WAErBY,QAAOb,IAAAA,OCqBX,UAAewG,EAAAA,EAAAA,UA3Cf,SAAyBrY,GACrB,MAAM2c,GAAcpE,EAAAA,EAAAA,IAAevY,GAC7BipD,GAAsBuE,EAAAA,GAAAA,IAAsBxtD,GAElD,IAAIgyD,GAAyB,EACzB6M,GAA0B,EAC1BvW,GAAuB,EAEvB3rC,IACAq1C,GAAyBC,EAAAA,GAAAA,IAA8BjyD,EAAOiX,GAAAA,EAAYC,uBAC1E2nD,GAA0B5M,EAAAA,GAAAA,IAA8BjyD,EAAOiX,GAAAA,EAAYi7C,wBAC3E5J,GAAuB2J,EAAAA,GAAAA,IAA8BjyD,EAAOiX,GAAAA,EAAYk7C,uBAG5E,MAAMrJ,GAAwBp0B,EAAAA,EAAAA,IAAsB10B,KAAU2iD,EAAAA,GAAAA,IAAsB3iD,EAAO,CAACua,WAAYtD,GAAAA,EAAY8nD,sBAEpH,MAAO,CACHt8D,OAAQka,EAAcA,EAAY9c,GAAK,GACvCg/D,0BACA7M,yBACA1J,uBACAtjC,QAAQ85B,EAAAA,EAAAA,IAAa9+C,GACrBipD,sBACArrB,cAAcmF,EAAAA,EAAAA,IAAgB/iC,GAC9B89D,6BAA6B1P,EAAAA,GAAAA,GAAYpuD,EAAOsJ,EAAAA,GAAiBy0D,0BACjEjV,wBACAn2C,UAAUsG,EAAAA,EAAAA,IAAYjZ,GACtB0S,SAASwG,EAAAA,EAAAA,GAAalZ,GAE9B,IAEA,SAA4BF,GACxB,MAAO,CACHsS,SAASgH,EAAAA,EAAAA,IAAmB,CACxB9S,sBAAqB,MACrBo4D,kBAAiB,MACjBrsD,UAAS,KACThJ,WAAU,KACVyJ,mBAAkBA,GAAAA,IACnBhT,GAEX,GAEA,CAA4D89D,I,gBC9D5D,MAcA,GAdiCoB,KAC7B,MAAMl/D,GAAWsb,EAAAA,EAAAA,eACX6jD,GAAehlD,EAAAA,EAAAA,aAAYkvB,EAAAA,IAC3B+1B,GAASp3C,EAAAA,EAAAA,SAAO,GAQtB,OAPAjM,EAAAA,EAAAA,YAAU,KACFqjD,EAAOpyD,QACPhN,GAASq/D,EAAAA,GAAAA,OAETD,EAAOpyD,SAAU,CACrB,GACD,CAACmyD,IACG,IAAI,E,gBCKf,MAAMG,IAAsBlmB,EAAAA,EAAAA,GAAmB,uBAAuBC,EAAAA,EAAAA,OAAK,IAAM,kCAC3EkmB,IAAmBnmB,EAAAA,EAAAA,GAAmB,oBAAoBC,EAAAA,EAAAA,OAAK,IAAM,2CACrEmmB,IAAqBpmB,EAAAA,EAAAA,GAAmB,sBAAsBC,EAAAA,EAAAA,OAAK,IAAM,kCAEzEomB,GAAyB,CAAC,YAAa,gBAM9B,SAASC,GAAkB53D,GACtC,MAAMg2B,GAAe3jB,EAAAA,EAAAA,aAAY8oB,EAAAA,IAC3B08B,GAAsBxlD,EAAAA,EAAAA,aAAYsa,EAAAA,IAClCz0B,GAAWsb,EAAAA,EAAAA,eAkCjB,OAhCAS,EAAAA,EAAAA,YAAU,KAAM,IAAA6jD,EACZ,MAAMC,GAAcC,EAAAA,GAAAA,QAAwBC,EAAAA,GAAAA,OACtC,UAACC,GAAa3rD,OAGd4rD,GAAWD,SAAwB,QAAfJ,EAATI,EAAWE,qBAAa,IAAAN,OAAf,EAATA,EAA0BK,YAAYD,aAAS,EAATA,EAAWC,WAAY,UAG9E,OAFA5xD,SAASkJ,KAAKzO,UAAUu4C,OAiDzB,SAA8B4e,GAAgE,IAArBJ,EAAWh8D,UAAAC,OAAA,QAAAC,IAAAF,UAAA,IAAAA,UAAA,GACvF,MAAMs8D,EAAY,IAAIV,IActB,MAXiB,UAAbQ,GAAqC,UAAbA,EACxBE,EAAUrvD,KAAK,eACK,aAAbmvD,GAAwC,WAAbA,GAClCE,EAAUrvD,KAAK,WAIf+uD,GACAM,EAAUrvD,KAAK,eAGZqvD,CACX,CAjEuCC,CAAqBH,EAAUJ,IAEvD,KACHxxD,SAASkJ,KAAKzO,UAAUorD,UAAUuL,IAIlCz/D,GAASqgE,EAAAA,EAAAA,MAAsC,CAClD,GACF,KAIHtkD,EAAAA,EAAAA,YAAU,KACN,IAAIukD,EAOJ,OANIX,IACAW,EAAyBC,aAAY,KACjCvgE,GAAS00B,EAAAA,EAAAA,MAAqD,GAC/DlsB,EAAAA,GAAUg4D,kBAGV,KACHC,cAAcH,EAAuB,CACxC,GACF,CAACX,IAGA/3D,IAAAA,cAAAA,IAAAA,SAAA,KACIA,IAAAA,cAAC84D,GAA2B,MAC5B94D,IAAAA,cAAC+4D,GAA0B,MAC3B/4D,IAAAA,cAACk2D,GAAO,MACRl2D,IAAAA,cAAA,OACI7H,GAAG,eACHoL,UAAU,eACV,cAAY,gBAEZvD,IAAAA,cAACg5D,GAAAA,EAAoB,MACrBh5D,IAAAA,cAAC03D,GAAmB,MACpB13D,IAAAA,cAAA,OAAKuD,UAAWI,IAAW,uCACtBzD,EAAM+4D,0BAA4Bj5D,IAAAA,cAAC01C,GAAa,MAAK11C,IAAAA,cAACoH,GAAAA,EAAa,CAAC6nC,UAAU,IAC/EjvC,IAAAA,cAACulB,GAAAA,QAAS,CAACC,cAAc,SACzBxlB,IAAAA,cAAC23D,GAAgB,QAGxBzhC,GAAgBl2B,IAAAA,cAAC43D,GAAkB,MAGhD,CAACE,GAAAj8C,UAAA,CA7DGo9C,0BAAyB9uD,IAAAA,KAAAC,Y,0BCC7B,MAAM8uD,IAAsB1nB,EAAAA,EAAAA,GAAmB,uBAAuBC,EAAAA,EAAAA,OAAK,IAAM,mCAC3ElsB,IAAY4zC,EAAAA,EAAAA,KAA8B,IAAAC,GAAAC,IAAA9zC,IAAA+zC,WAAA,CAAAt+D,YAAA,oBAAAq+D,CAqNf,CAACE,SAAU,WAvM5C,SAASC,GAAet5D,GAAc,IAAAu5D,EAClC,MAAMrhE,GAAWsb,EAAAA,EAAAA,eACX0a,GAAUmpB,EAAAA,EAAAA,eACT3mC,KAAM8oD,IAAiBC,EAAAA,EAAAA,cAEvBC,EAAuBC,IAA4B3lD,EAAAA,EAAAA,WAAS,IAE5DtD,EAAMkpD,IAAW5lD,EAAAA,EAAAA,UAAsB6lD,GAAoB75D,EAAM85D,UAAWN,IAE7EO,GAAyB1nD,EAAAA,EAAAA,aAAY2nD,EAAAA,IAErCC,GAAW/5C,EAAAA,EAAAA,QAAOggB,KAAKqI,OACvB2xB,GAAWh6C,EAAAA,EAAAA,QAAOggB,KAAKqI,OAyH7BhwC,eAAe4hE,EAAmBX,EAAuBY,GACrDR,EAAQ,MAER,MAAO7gE,KAAMshE,EAAU,MAAErhE,SAAegH,EAAMs6D,SAASd,EAAeY,GAClEphE,EACAk1B,EAAQllB,KAAK,8BAGbqxD,GACAT,EAAQS,EAEhB,ECnLJ,WAAoC,IAAAE,EAAAC,EAChC,MAAM1pC,GAAOze,EAAAA,EAAAA,aAAYmH,EAAAA,IACnBgY,EAAiB,QAAX+oC,EAAGzpC,aAAI,EAAJA,EAAM74B,UAAE,IAAAsiE,EAAAA,EAAI,GACrBE,EAAuB,QAAdD,EAAG1pC,aAAI,EAAJA,EAAMvY,aAAK,IAAAiiD,EAAAA,EAAI,IAEjCvmD,EAAAA,EAAAA,YAAU,KACFud,GACA94B,EAAAA,GAAQgiE,UAAUlpC,GAElBipC,GACA/hE,EAAAA,GAAQiiE,aAAaF,EACzB,GACD,CAACjpC,EAAQipC,GAChB,EDoCIG,IAEA3mD,EAAAA,EAAAA,YAAU,KACN4mD,GAAAA,EAAqBC,KAAK,mBAC1BC,GAAAA,EAAWC,sBAMXh7D,EAAMi7D,2BALN1iE,uBACUyH,EAAMk7D,0BACZvB,GAAyB,EAC7B,CAGAwB,EAAkB,GACnB,KAEHlnD,EAAAA,EAAAA,YAAU,KACN,GAAIjU,EAAMo7D,8BACN,MAAO,OAGX,MAAMC,EAAmB5C,aAAY,KACjC,MAAM6C,EAAcp7B,KAAKqI,MACpB+yB,EAAcpB,EAASh1D,QA9Cf,MA+CTq2D,QAAQC,IAAI,oCACZC,EAAAA,EAAAA,OAEJvB,EAASh1D,QAAUo2D,CAAW,GAnDZ,KAsDtB,MAAO,KACH3C,cAAc0C,EAAiB,CAClC,GACF,CAACr7D,EAAMo7D,iCAGVnnD,EAAAA,EAAAA,YAAU,KACN,SAASynD,IACLnvD,OAAOovD,UAAW,EAClB37D,EAAM47D,oBAGD57D,EAAM67D,iCACa37B,KAAKqI,MACN0xB,EAAS/0D,QAlEL,MAkEkDlF,EAAM6W,eAC3E7W,EAAM+vB,wBAAwB/vB,EAAM6W,cAGhD,CAEA,SAASilD,IACLvvD,OAAOovD,UAAW,EAClB1B,EAAS/0D,QAAUg7B,KAAKqI,MACxBvoC,EAAM+7D,4BACV,CAEA,SAASC,EAAc7mD,GACnB,GAAIA,EAAMtU,WAAYwiB,EAAAA,GAAAA,GAAiBlO,KAAU1U,EAAAA,GAAAA,GAAa0U,EAAOzU,EAAAA,GAAUC,SAASqlD,GAAI,CACxF,MAAMiW,EAAe11D,SAAS27C,cAA2B,kDACzD,GAAI+Z,EACAA,EAAa31D,YACV,CACH,MAAM41D,EAAc31D,SAAS41D,eAAe,gBACxCD,GACAA,EAAY51D,OAEpB,CACJ,CACJ,CAMA,OAJAiG,OAAO/F,iBAAiB,QAASk1D,GACjCnvD,OAAO/F,iBAAiB,OAAQs1D,GAChCvvD,OAAO/F,iBAAiB,UAAWw1D,GAE5B,KACHzvD,OAAO5F,oBAAoB,QAAS+0D,GACpCnvD,OAAO5F,oBAAoB,OAAQm1D,GACnCvvD,OAAO5F,oBAAoB,UAAWq1D,EAAc,CACvD,GACF,CAACh8D,EAAM6W,iBAGV5C,EAAAA,EAAAA,YAAU,KACF8lD,GAA0B/5D,EAAM6W,eAChC3e,GAASkkE,EAAAA,EAAAA,IAA6Bp8D,EAAM6W,eAChD,GACD,CAACkjD,EAAwB7hE,EAAU8H,EAAM6W,iBAG5C5C,EAAAA,EAAAA,YAAU,KACN,MAAMooD,GAAqBC,EAAAA,GAAAA,MAW3B,OAVID,GAEAE,IAAAA,SAIJhwD,OAAOovD,UAAW,EAElBlvC,EAAAA,EAAkB+vC,sBAAsB,MAEjC,KACHjwD,OAAOovD,UAAW,EAEdU,GACAE,IAAAA,SACJ,CACH,GACF,IA0BH,MAAME,EAAsBz8D,EAAM85D,UAAUx8D,KAAKoT,GAASA,EAAKzY,KAAIsF,OAAOsyB,KAAK,KAwB/E,IArBA5b,EAAAA,EAAAA,YAAU,KACN,GAAIulD,EAAe,CAEf,GAAI94D,EAAAA,GAAUg8D,oBAAoBrmD,SAASmjD,GACvC,OAGJ,MAAMmD,EAAwB9C,GAAoB75D,EAAM85D,UAAWN,GAC/DmD,EAnCZpkE,eAAkCmY,GAC9B,MAAO3X,KAAMshE,EAAU,MAAErhE,SAAegH,EAAMusB,eAAe7b,GACzD1X,EACAk1B,EAAQllB,KAAK,8BAGbqxD,GACAT,EAAQS,EAEhB,CA4BYuC,CAAmBD,GACZjsD,GAAQA,EAAKnN,OAASi2D,EAE7BW,EAAmBX,GAAe,GAC1B9oD,GAERypD,EAAmBX,GAAe,EAE1C,IACD,CAACA,EAAeiD,IAEfz8D,EAAM68D,YAEN,OADA3uC,EAAQllB,KAAK,cACN,KAGX,GAAa,OAAT0H,EACA,OAAO,KAGX,MAAMosD,GAAapsD,aAAI,EAAJA,EAAMnN,KAAKtB,kBAAkBu3D,aAAa,EAAbA,EAAev3D,eAE/D,OACInC,IAAAA,cAACm2C,EAAAA,OAAM,KACHn2C,IAAAA,cAACo2C,EAAAA,MAAK,CACF/nB,KAAI,UAAArsB,OAAYs0C,GAAAA,GAAsB,kBACtCjrB,UAAW6tC,KAEfl5D,IAAAA,cAACo2C,EAAAA,MAAK,CACF/nB,KAAI,UAAArsB,OAAYs0C,GAAAA,GAAsB,WACtCjrB,UAAW6tC,KAED,QADZO,EACDv5D,EAAM+9B,eAAO,IAAAw7B,OAAA,EAAbA,EAAej8D,KAAKijD,GACjBzgD,IAAAA,cAACo2C,EAAAA,MAAK,CACF3xC,IAAKg8C,EAAOtoD,GACZk2B,KAAM,UAAArsB,OAAUs0C,GAAAA,GAAsB,MAAQmK,EAAewc,MAC7Dl2D,OAAQA,IACJ/G,IAAAA,cAAAo5D,GAAA,CACI5zC,cAAe,qBACf03C,YAAazc,EAAOtoD,SAMpC6H,IAAAA,cAAC83D,GAAiB,CAACmB,0BAA2BW,GAAyBoD,IAGnF,CAEA,SAASjD,GAAoBC,EAA+BluD,GAAmB,IAAAqxD,EAC3E,IAAKrxD,EACD,OAAO,KAIX,OADyE,QAA/DqxD,EAAGnD,EAAUt9D,MAAM0gE,GAAeA,EAAW35D,OAASqI,WAAS,IAAAqxD,EAAAA,EAAI,OAElE,IAIf,CAEA,UAAezmD,EAAAA,EAAAA,MAAK8iD,IEzNdt3C,GAAqB,CACvB+N,wBAAuB,KACvBmrC,wBAAuB,KACvBD,yBAAwB,KACxBW,kBAAiB,KACjBrvC,eAAc,EACd+tC,ShEeG,SAAkB6C,EAAkB/C,GACvC,OAAO7hE,MAAOL,EAAUC,KACpB,MAAMC,EAAQD,IACR+f,GAAcsB,EAAAA,EAAAA,IAAephB,GAEnC,IACI,MAAMglE,QAAyBllE,GAASq2B,EAAAA,EAAAA,IAAc4uC,IACtD,IAAIE,EAAAA,EAAAA,GAAUD,GAAmB,CAC7B,MAAM1sD,EAAO0sD,EAAiBrkE,KAE9B,GAAImf,GAAexH,GAA2B,IAAnBA,EAAKvD,UAAiB,CAC7C,MAAMmwD,QAA4BplE,GAASqlE,EAAAA,EAAAA,IAAc7sD,EAAKzY,GAAIigB,EAAYjgB,KAC9E,IAAIolE,EAAAA,EAAAA,GAAUC,GAAsB,CAC5BlD,GACA3tC,EAAAA,EAAkB+vC,sBAAsB9rD,EAAKzY,UAG3CC,EAASq0B,EAAe7b,IAE9B,UACUxY,GAAS63B,EAAAA,EAAAA,IAAwBrf,EAAKzY,IAChD,CAAE,MAAOe,GAGL,OAFAkB,EAAAA,EAAAA,IAAuBlB,EAAsBd,EAAUC,GACvDD,GAASiC,EAAAA,EAAAA,IAASnB,IACX,CAACA,MAAOA,EACnB,CAEA,MAAO,CAACD,KAAM2X,EAClB,CACA,MAAM4sD,EAAoBtkE,KAC9B,CACA,MAAM,IAAIwkE,MAAM,4BACpB,CACI,MAAMJ,EAAiBpkE,KAE/B,CAAE,MAAOA,GAGL,OAFAkB,EAAAA,EAAAA,IAAuBlB,EAAsBd,EAAUC,GACvDD,GAASiC,EAAAA,EAAAA,IAASnB,IACX,CAACA,MAAOA,EACnB,EAER,EgEvDI+iE,2BAA0BA,EAAAA,IAGxB/xC,IAAYvZ,EAAAA,EAAAA,UA/BlB,SAAyBrY,EAAoBymB,GACzC,MAAMzL,GAAUC,EAAAA,EAAAA,IAAWjb,GACrB8tB,GAASnT,EAAAA,EAAAA,IAAU3a,GACnB8f,GAAcsB,EAAAA,EAAAA,IAAephB,GAC7B2lC,EAAU3lC,EAAM2lC,QAAQC,WAAWy/B,mBACnC5B,EAA6E,SAA3C31C,EAAOw3C,gCACzCtC,EAAyE,SAAzCl1C,EAAOy3C,8BAE7C,MAAO,CACH9mD,eAAe9F,EAAAA,EAAAA,IAAiB3Y,GAChCqmB,kBAAkB5f,EAAAA,EAAAA,IAAoBzG,GACtC0hE,WAAWpU,EAAAA,EAAAA,IAAWttD,GACtB2lC,UACA6/B,kBAAkBC,EAAAA,EAAAA,IAAiCzlE,GACnD0lE,gBAAgBC,EAAAA,EAAAA,IAAkB3lE,GAClCykE,aAAamB,EAAAA,EAAAA,GAAmB9lD,EAAa9E,EAAS8S,EAAQrH,EAASoP,MAAMyC,KAC7EmrC,kCACAT,gCAER,GAY2Cp5C,IAI3C,GAAegI,GAAUsvC,G,6rBCrBzB,MAAM3b,UAA8B79C,IAAAA,cAAkCK,WAAAA,GAAA,SAAApE,WAAAsE,EAAA,aAC1D,CACJ49D,kBAAkB,EAClB10D,KAAM,CACF20D,aAAc,KAErB79D,EAAA,kBAEW9H,MAAO4lE,EAAoB7xD,KACnC,MAAM,KAACvT,SAAcqI,KAAKpB,MAAMwK,QAAQ4zD,0BAA0Bh9D,KAAKpB,MAAM0Q,KAAKzY,GAAIqU,EAAY6xD,EAAYzkD,EAAAA,GAAsB,GAEpI,MAAO,CACHK,MAAOhhB,EAAMslE,OACbrkD,WAAYjhB,EAAMulE,gBACrB,IACJj+D,EAAA,6BAEsB,KACnBe,KAAKC,SAAS,CAAC48D,kBAAkB,GAAO,IAC3C59D,EAAA,8BAEuB,KACpBe,KAAKC,SAAS,CAAC48D,kBAAkB,IACjC,MAAM,KAAC10D,EAAI,UAAEg1D,GAAan9D,KAAKhJ,MAC/BgJ,KAAKpB,MAAMwK,QAAQg0D,oBAAoBj1D,EAAKtR,GAAImJ,KAAKpB,MAAM0Q,KAAKzY,GAAIwmE,EAAAA,GAAaC,MAAMnzD,MAAKhT,UACxF,GAAIgmE,EAAW,CACXA,EAAUl9D,SAAS,CAAC2C,SAAS,IAC7B,MAAM,MAAC+V,EAAK,WAAEC,SAAoBukD,EAAUv+D,MAAM8Z,UAAUykD,EAAUnmE,MAAM8H,KAAMq+D,EAAUnmE,MAAMkU,YAElGiyD,EAAUl9D,SAAS,CAAC2C,SAAS,EAAO+V,QAAOC,cAC/C,IACF,IACL3Z,EAAA,2BAEoB,CAACkJ,EAAag1D,KAC/Bn9D,KAAKC,SAAS,CAAC48D,kBAAkB,EAAM10D,OAAMg1D,aAAW,IAC3Dl+D,EAAA,kCAE2B,CAACkJ,EAAag1D,IAAyBn9D,KAAKpB,MAAMwK,QAAQg0D,oBAAoBj1D,EAAKtR,GAAImJ,KAAKpB,MAAM0Q,KAAKzY,GAAIwmE,EAAAA,GAAaC,MAAMnzD,MAAKhT,UAC3JgmE,EAAUl9D,SAAS,CAAC2C,SAAS,IAC7B,MAAM,MAAC+V,EAAK,WAAEC,SAAoBukD,EAAUv+D,MAAM8Z,UAAUykD,EAAUnmE,MAAM8H,KAAMq+D,EAAUnmE,MAAMkU,YAClGiyD,EAAUl9D,SAAS,CAAC2C,SAAS,EAAO+V,QAAOC,cAAY,MACzD3Z,EAAA,eAEO,KACLe,KAAKpB,MAAMwK,QAAQ/I,WAAWC,EAAAA,GAAiBg8C,mBAAmB,IACrEr9C,EAAA,2BAEoB,KACjBe,KAAK0X,SACL1X,KAAKpB,MAAMwK,QAAQC,UAAU,CAACC,QAAShJ,EAAAA,GAAiB81B,mBAAoB5sB,WAAY6sB,EAAAA,GAAsB,IACjHp3B,EAAA,4BAEqB9H,MAAOgR,EAAag1D,EAAsBI,KAC5Dv9D,KAAKpB,MAAMwK,QAAQo0D,mBAAmBr1D,EAAKtR,GAAImJ,KAAKpB,MAAM0Q,KAAKzY,GAAIwmE,EAAAA,GAAaC,KAAM,CAACG,aAAcF,IAAcpzD,MAAKhT,UACpHgmE,EAAUl9D,SAAS,CAAC2C,SAAS,IAC7B,MAAM,MAAC+V,EAAK,WAAEC,SAAoBukD,EAAUv+D,MAAM8Z,UAAUykD,EAAUnmE,MAAM8H,KAAMq+D,EAAUnmE,MAAMkU,YAElGlL,KAAKpB,MAAMwK,QAAQs0D,mBAEnBP,EAAUl9D,SAAS,CAAC2C,SAAS,EAAO+V,QAAOC,cAAY,GACzD,IACL3Z,EAAA,kBAEW,CAACkJ,EAAag1D,KACtB,IAAI5uD,EAiBJ,OAfIA,EADApG,EAAKs1D,aAED/+D,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,mCACH6K,eAAe,gBAKnBhD,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,oCACH6K,eAAe,iBAMvBhD,IAAAA,cAAA,OACIyE,IAAKgF,EAAKtR,GACVoL,UAAU,mBAEVvD,IAAAA,cAAA,OACIuD,UAAU,oBACVylB,IAAKi2C,EACLC,IAAI,gBACJjtC,MAAM,KACNhN,OAAO,OAEXjlB,IAAAA,cAAA,OAAKuD,UAAU,uBACXvD,IAAAA,cAAA,OACIuD,UAAU,mBACV,cAAY,cACdkG,EAAKxH,aAAa,IAACjC,IAAAA,cAACm/D,EAAAA,EAAI,MAAE,IAAE,IAAI,IAACn/D,IAAAA,cAACm/D,EAAAA,EAAI,MACpCn/D,IAAAA,cAAA,QAAMuD,UAAU,0BACZvD,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,aACH6K,eAAe,4DACf2B,OAAQ,CACJy6D,IAAK31D,EAAK20D,mBAM9Bp+D,IAAAA,cAAA,OAAKuD,UAAU,uBACXvD,IAAAA,cAACkrD,EAAAA,EAAW,KACRlrD,IAAAA,cAAA,UACI7H,GAAE,sBAAA6J,OAAwByH,EAAKxH,cAC/BsB,UAAU,gDACVzK,KAAK,SACL,gBAAc,OACd,cAAY,eAEZkH,IAAAA,cAAA,YAAO6P,EAAM,KACb7P,IAAAA,cAACq/D,EAAAA,EAAY,OAEjBr/D,IAAAA,cAAC2I,EAAAA,EAAI,CACD22D,UAAU,EACVv9D,UAAW0uB,EAAAA,GAAsB,CAACt4B,GAAI,sCAAuC6K,eAAgB,sCAE7FhD,IAAAA,cAAC2I,EAAAA,EAAK2iD,WAAU,CACZxzC,MAAOrO,EAAKs1D,aACZl7D,QAASA,IAAMvC,KAAKi+D,oBAAoB91D,EAAMg1D,GAAW,GACzDt6D,KAAMssB,EAAAA,GAAsB,CAACt4B,GAAI,uCAAwC6K,eAAgB,uBAE7FhD,IAAAA,cAAC2I,EAAAA,EAAK2iD,WAAU,CACZxzC,KAAM/T,QAAQ0F,EAAKs1D,cACnBl7D,QAASA,IAAMvC,KAAKi+D,oBAAoB91D,EAAMg1D,GAAW,GACzDt6D,KAAMssB,EAAAA,GAAsB,CAACt4B,GAAI,wCAAyC6K,eAAgB,wBAE9FhD,IAAAA,cAAC2I,EAAAA,EAAK2iD,WAAU,CACZnzD,GAAG,eACH0L,QAASA,IAAMvC,KAAKk+D,mBAAmB/1D,EAAMg1D,GAC7Ct6D,KAAMssB,EAAAA,GAAsB,CAACt4B,GAAI,qCAAsC6K,eAAgB,sBAKrG,GAEb,CAED+D,MAAAA,GACI,MAAM,cAAChE,GAAiBzB,KAAKpB,MAAM4C,KAC7BH,EAAcrB,KAAKhJ,MAAMmR,KAAK20D,aACpC,OACIp+D,IAAAA,cAAAA,IAAAA,SAAA,KACIA,IAAAA,cAAC6Z,EAAAA,EAAS,CACN/B,MAAOxW,KAAKhJ,MAAM6lE,iBAClBzjD,UAAW3X,EAAc,CAAC5K,GAAI,cAAe6K,eAAgB,iBAAkB,CAAC4N,KAAMtP,KAAKpB,MAAM0Q,KAAK3O,eACtG8Y,sBAAuBhY,EAAc,CAAC5K,GAAI,8CAA+C6K,eAAgB,kBACzGsX,UAAWhZ,KAAKgZ,UAChBN,UAAW1Y,KAAK0Y,UAChBhB,OAAQ1X,KAAK0X,OACb2B,mBAAoB5X,EAAc,CAAC5K,GAAI,kCAAmC6K,eAAgB,eAC1F4X,sBAAuBtZ,KAAKm+D,mBAC5B,cAAY,eAEhBz/D,IAAAA,cAAC0/D,EAAAA,EAAY,CACT5nD,KAAMxW,KAAKhJ,MAAM6lE,iBACjBtuD,MAAO9M,EAAc,CAAC5K,GAAI,6BAA8B6K,eAAgB,8FAA+F,CAACL,gBACxKqJ,QAASjJ,EAAc,CAAC5K,GAAI,+BAAgC6K,eAAgB,uPAAwP,CAACL,gBACrUyU,kBAAmBrU,EAAc,CAAC5K,GAAI,8BAA+B6K,eAAgB,6EAA8E,CAACL,gBACpKg9D,UAAWr+D,KAAKs+D,sBAChBC,SAAUv+D,KAAKw+D,qBACf3nE,GAAG,kBAInB,EACHoI,EAhLKs9C,EAAqB,aAhBvBnzC,QAAOP,IAAAA,MAAA,CACHm0D,0BAAyBn0D,IAAAA,KAAAC,WACzBzI,WAAUwI,IAAAA,KAAAC,WACVO,UAASR,IAAAA,KAAAC,WACTs0D,oBAAmBv0D,IAAAA,KAAAC,WACnB00D,mBAAkB30D,IAAAA,KAAAC,WAClB40D,iBAAgB70D,IAAAA,KAAAC,aAAAA,aA4LxB,SAAeE,EAAAA,EAAAA,YAAWuzC,GC3L1B,GAAeltC,EAAAA,EAAAA,UAjBS+lC,CAACp+C,EAAoBymB,KAClC,CACHnO,KAAMtY,EAAMi3B,SAASuvB,MAAMA,MAAM//B,EAAS29B,YAItBtkD,IAAkB,CAC1CsS,SAASgH,EAAAA,EAAAA,IAAmB,CACxB4sD,0BAAyB,KACzB38D,WAAU,IACVgJ,UAAS,IACT+zD,oBAAmB,KACnBI,mBAAkB,KAClBE,iBAAgBA,EAAAA,IACjB5mE,MAGP,CAA4DylD,E,q1BCc5D,MAAMkiB,UAA4B//D,IAAAA,cAC9BK,WAAAA,CAAYH,GACRI,MAAMJ,GAAOK,EAAA,yBAUU9H,UACvB,MAAMunE,EAAK1+D,KAAKpB,MAAMkY,YACtB,GAAI9W,KAAKpB,MAAM8wB,KAAK74B,KAAO6nE,EAAG7nE,IAAM6nE,EAAGvnD,MAAMlC,SAAS,gBAClDjV,KAAK2+D,aAAa3+D,KAAKpB,MAAM8wB,KAAM,iBAChC,CACH,MAAM,MAAC93B,SAAeoI,KAAKpB,MAAMwK,QAAQw1D,4BAA4B5+D,KAAKpB,MAAMigE,WAAWnzD,QAAS1L,KAAKpB,MAAM8wB,KAAK74B,IAAI,GAAM,GAC1He,EACAoI,KAAKC,SAAS,CAACgK,YAAarS,EAAM8S,WAElC1K,KAAKpB,MAAMwK,QAAQif,QAAQroB,KAAKpB,MAAM8wB,KAAK74B,IAC3CmJ,KAAKpB,MAAMwK,QAAQ01D,cAAc9+D,KAAKpB,MAAMigE,WAAWnzD,QAAS1L,KAAKpB,MAAM8wB,KAAK74B,IAC5EmJ,KAAKpB,MAAM8wB,KAAK74B,KAAO6nE,EAAG7nE,WACpBmJ,KAAKpB,MAAMwK,QAAQs0D,mBACzB19D,KAAKpB,MAAMwK,QAAQ21D,iBAAiB/+D,KAAKpB,MAAMg4C,mBAG3D,KACH33C,EAAA,6BAE8B9H,UAC3B,MAAM,MAACS,SAAeoI,KAAKpB,MAAMwK,QAAQ41D,8BAA8Bh/D,KAAKpB,MAAMigE,WAAWnzD,QAAS1L,KAAKpB,MAAM8wB,KAAK74B,IAClHe,GACAoI,KAAKC,SAAS,CAACgK,YAAarS,EAAM8S,SACtC,IACHzL,EAAA,wBAEyB9H,UACtB,MAAMunE,EAAK1+D,KAAKpB,MAAMkY,YACtB,GAAI9W,KAAKpB,MAAM8wB,KAAK74B,KAAO6nE,EAAG7nE,IAAM6nE,EAAGvnD,MAAMlC,SAAS,gBAClDjV,KAAK2+D,aAAa3+D,KAAKpB,MAAM8wB,KAAM,4BAChC,CACH,MAAM,MAAC93B,SAAeoI,KAAKpB,MAAMwK,QAAQw1D,4BAA4B5+D,KAAKpB,MAAMigE,WAAWnzD,QAAS1L,KAAKpB,MAAM8wB,KAAK74B,IAAI,GAAM,GAC1He,EACAoI,KAAKC,SAAS,CAACgK,YAAarS,EAAM8S,WAElC1K,KAAKpB,MAAMwK,QAAQif,QAAQroB,KAAKpB,MAAM8wB,KAAK74B,IAC3CmJ,KAAKpB,MAAMwK,QAAQ01D,cAAc9+D,KAAKpB,MAAMigE,WAAWnzD,QAAS1L,KAAKpB,MAAM8wB,KAAK74B,IAExF,KACHoI,EAAA,qBAEsB,CAACywB,EAAmBtsB,KACvCpD,KAAKC,SAAS,CACVgK,YAAajK,KAAKhJ,MAAMiT,YACxBg1D,iBAAiB,EACjBvvC,OACAtsB,QACF,IACLnE,EAAA,2BAE4B,KACzBe,KAAKC,SAAS,CACVgK,YAAa,KACbg1D,iBAAiB,EACjBvvC,KAAM,KACNtsB,KAAM,MACR,IACLnE,EAAA,2BAE4B9H,UACzB,MAAM,MAACS,SAAeoI,KAAKpB,MAAMwK,QAAQw1D,4BAA4B5+D,KAAKpB,MAAMigE,WAAWnzD,QAAS1L,KAAKpB,MAAM8wB,KAAK74B,IAAI,GAAM,GAC1He,EACAoI,KAAKC,SAAS,CAACgK,YAAarS,EAAM8S,WAElC1K,KAAKpB,MAAMwK,QAAQif,QAAQroB,KAAKpB,MAAM8wB,KAAK74B,KAC3C8T,EAAAA,EAAAA,KAAa/C,KAAK5H,KAAKpB,MAAM6zC,SACjC,IA1EAzyC,KAAKhJ,MAAQ,CACTiT,YAAa,KACbg1D,iBAAiB,EACjBvvC,KAAM,KACNtsB,KAAM,KAEd,CAuEAqC,MAAAA,GACI,IAAIwE,EAAc,KACdjK,KAAKhJ,MAAMiT,cACXA,EACIvL,IAAAA,cAAA,OAAKuD,UAAU,aACXvD,IAAAA,cAAA,SAAOuD,UAAU,2BAA2BjC,KAAKhJ,MAAMiT,eAKnE,MAAM,YAAC0J,EAAW,WAAEkrD,EAAU,KAAEnvC,EAAI,KAAEluB,GAAQxB,KAAKpB,MAEnD,IAAIsgE,EAAe,KAGfA,GADAC,EAAAA,EAAAA,GAAQzvC,EAAKvY,OAETzY,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,8BACH6K,eAAe,UAGhBguB,EAAKvY,MAAMvc,OAAS,IAAKwkE,EAAAA,EAAAA,IAAc1vC,EAAKvY,OAE/CzY,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,oCACH6K,eAAe,iBAGfm9D,EAAW1nD,MAAMvc,OAAS,IAAKszD,EAAAA,EAAAA,IAAQ2Q,EAAW1nD,QAAW0nD,EAAWpB,aAE5E/+D,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,kCACH6K,eAAe,eAKnBhD,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,+BACH6K,eAAe,WAK3B,MAAMg9D,EAAK1+D,KAAKpB,MAAMkY,YACtB,IAAIuoD,IAAkBF,EAAAA,EAAAA,GAAQzvC,EAAKvY,UAAW+2C,EAAAA,EAAAA,IAAQ2Q,EAAW1nD,QAAU0nD,EAAWpB,iBAAkB2B,EAAAA,EAAAA,IAAc1vC,EAAKvY,OACvHmoD,KAAiBH,EAAAA,EAAAA,GAAQzvC,EAAKvY,SAAW+2C,EAAAA,EAAAA,IAAQ2Q,EAAW1nD,SAAWioD,EAAAA,EAAAA,IAAc1vC,EAAKvY,QAAW0nD,EAAWpB,cAEhH/tC,EAAK3jB,UAAY,IACjBmzD,EACIxgE,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,iCACH6K,eAAe,aAGvB29D,GAAiB,EACjBC,GAAgB,GAGpB,MAAMC,EAAoB7vC,EAAK74B,KAAO6nE,EAAG7nE,OAAQ8c,SAAAA,EAAa4Y,oBAAqBmD,EAAK7H,QAExF,IAAI23C,EAAkB,KACtB,GAAI9vC,EAAK74B,KAAO6nE,EAAG7nE,GAAI,CACnB,MAAM0X,EACF7P,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,+CACH6K,eAAe,4CAIjBgJ,EACFhM,IAAAA,cAAA,WACIA,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,iDACH6K,eAAe,mPAEnBhD,IAAAA,cAAA,WACAA,IAAAA,cAAA,WACAA,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,2CACH6K,eAAe,yCACf2B,OAAQ,CACJ6kB,SAAUw2C,EAAGx2C,YAGpBje,GAIHw1D,EACF/gE,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,wCACH6K,eAAe,qBAIvB89D,EACI9gE,IAAAA,cAAC0/D,EAAAA,EAAY,CACT5nD,KAAMxW,KAAKhJ,MAAMioE,gBACjB1wD,MAAOA,EACP7D,QAASA,EACToL,kBAAmB2pD,EACnBpB,UAAWr+D,KAAK0/D,mBAChBnB,SAAUv+D,KAAK2/D,oBAG3B,CAEA,IAAKJ,IAAsBD,IAAkBD,EACzC,OAAO3gE,IAAAA,cAAA,WAAMwgE,GAGjB,MAAM,MAACviE,EAAK,WAAEs1B,GAAcjyB,KAAKpB,MACjC,IAAIghE,GAAS,EACT3tC,EAlOwB,GAkOoBA,EAAat1B,GAlOjC,IAmOxBijE,GAAS,GAGb,MAAMC,EACFnhE,IAAAA,cAAC2I,EAAAA,GAAS,CACNxQ,GAAG,iBACH0L,QAASvC,KAAK8/D,qBACdp4D,OACIhJ,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,mCACH6K,eAAe,uBAKzBq+D,EACFrhE,IAAAA,cAAC2I,EAAAA,GAAS,CACN9E,QAASvC,KAAKggE,gBACdt4D,OACIhJ,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,kCACH6K,eAAe,sBAKzBu+D,EACFvhE,IAAAA,cAAC2I,EAAAA,GAAS,CACN9E,QAASvC,KAAKkgE,iBACdx4D,OACIhJ,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,mCACH6K,eAAe,uBAK/B,OACIhD,IAAAA,cAAAA,IAAAA,SAAA,KACIA,IAAAA,cAAC2I,EAAAA,GAAc,CACXQ,WAAY,CACRhR,GAAI,uBAAF6J,OAAyBgvB,EAAKxH,UAChCtM,MAAO,gDACP3T,SACIvJ,IAAAA,cAAAA,IAAAA,SAAA,KACIA,IAAAA,cAAA,YAAOwgE,EAAa,KACpBxgE,IAAAA,cAACq/D,EAAAA,EAAY,QAIzB71D,KAAM,CACFrR,GAAI,uBAAF6J,OAAyBgvB,EAAKxH,SAAQ,SACxC,aAAc1mB,EAAKC,cAAc,CAAC5K,GAAI,sCAAuC6K,eAAgB,sCAEjGy+D,aAAc,CACVC,SAAUR,EAAS,MAAQ,SAC3BS,WAAY,SAEhBC,gBAAiB,CACbF,SAAUR,EAAS,SAAW,MAC9BS,WAAY,UAGfd,EAAoBM,EAAa,KACjCP,EAAgBS,EAAgB,KAChCV,EAAiBY,EAAiB,MAEtCT,EACAv1D,EAGb,EACHhL,EA5QKw/D,EAAmB,aAzBrBhsB,QAAO5pC,IAAAA,OAAAC,WAEPnM,MAAKkM,IAAAA,OAAAC,WACLmpB,WAAUppB,IAAAA,OAAAC,WAEVM,QAAOP,IAAAA,MAAA,CACH60D,iBAAgB70D,IAAAA,KAAAC,WAChBi2D,iBAAgBl2D,IAAAA,KAAAC,WAChBuf,QAAOxf,IAAAA,KAAAC,WACPg2D,cAAaj2D,IAAAA,KAAAC,WACby3D,aAAY13D,IAAAA,KAAAC,WACZ03D,gBAAe33D,IAAAA,KAAAC,WACf81D,4BAA2B/1D,IAAAA,KAAAC,WAC3B23D,iBAAgB53D,IAAAA,KAAAC,WAChBk2D,8BAA6Bn2D,IAAAA,KAAAC,aAAAA,aAyRrC,SAAeE,EAAAA,EAAAA,YAAWy1D,GC9Q1B,GAAepvD,EAAAA,EAAAA,UAzBf,SAAyBrY,GACrB,MAAO,CACH8f,aAAasB,EAAAA,EAAAA,IAAephB,GAC5By7C,SAASC,EAAAA,EAAAA,IAA0B17C,GACnC2c,aAAapE,EAAAA,EAAAA,IAAevY,GAC5B4/C,kBAAkBzW,EAAAA,EAAAA,IAA0BnpC,GAEpD,IAEA,SAA4BF,GACxB,MAAO,CACHsS,SAASgH,EAAAA,EAAAA,IAAmB,CACxBstD,iBAAgB,KAChBqB,iBAAgB,KAChB12C,QAAO,KACPy2C,cAAa,KACbyB,aAAY,KACZC,gBAAe,KACfC,iBAAgB,KAChB7B,4BAA2B,KAC3BI,8BAA6BA,EAAAA,IAC9BloE,GAEX,GAEA,CAA4D2nE,G,uaCR7C,MAAMiC,UAAuBhiE,IAAAA,cAGxCK,WAAAA,CAAYH,GACRI,MAAMJ,GAAOK,EAAA,qBAmEF,KACXe,KAAKC,SAAS,CAAC2C,SAAS,GAAO,IAClC3D,EAAA,iBAEU9H,UACP6I,KAAKC,SAAS,CAAC2C,SAAS,UAClBwK,QAAQC,IAAI,CACdrN,KAAKpB,MAAMwK,QAAQu3D,2BAA2B7hE,EAxGnC,GAwGyDkB,KAAKpB,MAAM6W,cAAe,CAAC6R,QAAQ,IACvGtnB,KAAKpB,MAAMwK,QAAQw3D,eAAe5gE,KAAKpB,MAAM6W,cAAe3W,EAAMQ,EAAAA,GAAUuhE,2BACxE,CACI1kE,KAAM2kE,EAAAA,GAAMC,qBACZC,uBAAuB,MAInChhE,KAAKgN,cAAc,IACtB/N,EAAA,eAES4L,IACN7K,KAAKpB,MAAMwK,QAAQ63D,mBAAmBp2D,EAAK,IApF3C7K,KAAK+K,gBAAkB,EAEvB/K,KAAKhJ,MAAQ,CACT4L,SAAS,EAEjB,CAEA,uBAAMoC,SACIoI,QAAQC,IAAI,CACdrN,KAAKpB,MAAMwK,QAAQu3D,2BAA2B,EAAGrhE,EAAAA,GAAU4hE,mBAAoBlhE,KAAKpB,MAAM6W,cAAe,CAAC6R,QAAQ,IAClHtnB,KAAKpB,MAAMwK,QAAQw3D,eAAe5gE,KAAKpB,MAAM6W,cAAe,EAAGnW,EAAAA,GAAUuhE,2BACrE,CACI1kE,KAAM2kE,EAAAA,GAAMC,qBACZC,uBAAuB,IAG/BhhE,KAAKpB,MAAMwK,QAAQm3D,aAAavgE,KAAKpB,MAAM6W,iBAE/CzV,KAAKgN,cACT,CAEA1H,oBAAAA,GACItF,KAAKpB,MAAMwK,QAAQ63D,mBAAmB,GAC1C,CAEA1+C,kBAAAA,CAAmBC,GACf,GAAIA,EAAUtX,aAAelL,KAAKpB,MAAMsM,WAAY,CAChDJ,aAAa9K,KAAK+K,iBAElB,MAAMG,EAAalL,KAAKpB,MAAMsM,WAC9B,GAAmB,KAAfA,EAGA,OAFAlL,KAAKgN,oBACLhN,KAAK+K,gBAAkB,GAI3B,MAAMA,EAAkBI,OAAOxH,YAC3BxM,UACI,MAAM,4BACFgqE,EAA2B,+BAC3BC,EAA8B,eAC9BC,GACArhE,KAAKpB,MAAMwK,SACT,KAACzR,SAAc0pE,EAAen2D,EAAY,CAACQ,QAAS1L,KAAKpB,MAAM6W,gBAEjE1K,IAAoB/K,KAAK+K,kBAI7B/K,KAAKC,SAAS,CAAC2C,SAAS,IAExBu+D,EAA4BxpE,GAC5BypE,EAA+BzpE,EAAMqI,KAAKpB,MAAM6W,eAAe,GAAMtL,MAAK6I,IAA2B,IAAzBrb,KAAM2pE,GAActuD,EACxFsuD,GACAthE,KAAKgN,cACT,IACF,GAEN1N,EAAAA,GAAUiiE,6BAGdvhE,KAAK+K,gBAAkBA,CAC3B,CACJ,CAwBAtF,MAAAA,GACI,IAAI+7D,EACAxhE,KAAKpB,MAAM6iE,uBACXD,EAAsB,CAAC/C,IAG3B,MAAMiD,EAAc1hE,KAAKpB,MAAM8iE,YACzBC,EAAQ3hE,KAAKpB,MAAM+iE,MACnBC,EAIF,CAAC,EAEL,IAAIC,EACJ,GAAI7hE,KAAKhJ,MAAM4L,QACXi/D,EAAiB,SACd,CACHA,EAAiB,GAEjB,IAAK,IAAI9uB,EAAI,EAAGA,EAAI4uB,EAAM/mE,OAAQm4C,IAAK,CACnC,MAAMrjB,EAAOiyC,EAAM5uB,GAEf2uB,EAAYhyC,EAAK74B,KAA0B,IAAnB64B,EAAK3jB,YAC7B81D,EAAej6D,KAAK8nB,GACpBkyC,EAAgBlyC,EAAK74B,IAAM,CACvBgoE,WAAY6C,EAAYhyC,EAAK74B,KAGzC,CACJ,CAEA,OACI6H,IAAAA,cAACojE,EAAAA,EAAkB,CACfH,MAAOE,EACPE,aA1JO,GA2JPpoD,MAAO3Z,KAAKpB,MAAMojE,iBAClBp+D,SAAU5D,KAAK4D,SACfM,OAAQlE,KAAKkE,OACbkF,QAASo4D,EACTI,gBAAiBA,EACjBK,cAAeh9D,EAAAA,MAG3B,EACHhG,EA1IoByhE,EAAc,aAvB/Bx1D,WAAUrC,IAAAA,OAAAC,WACV64D,MAAK94D,IAAAA,MAAAC,WAIL2M,cAAa5M,IAAAA,OAAAC,WACbk5D,iBAAgBn5D,IAAAA,OAAAC,WAChB24D,qBAAoB54D,IAAAA,KACpBO,QAAOP,IAAAA,MAAA,CACH+3D,eAAc/3D,IAAAA,KAAAC,WACdu4D,eAAcx4D,IAAAA,KAAAC,WACdy3D,aAAY13D,IAAAA,KAAAC,WACZ63D,2BAA0B93D,IAAAA,KAAAC,WAC1Bq4D,4BAA2Bt4D,IAAAA,KAAAC,WAC3Bs4D,+BAA8Bv4D,IAAAA,KAAAC,WAC9Bm4D,mBAAkBp4D,IAAAA,KAAAC,aAAAA,aC6B1B,SAAeuG,EAAAA,EAAAA,UAtCf,SAAyBrY,EAAoBymB,GACzC,MAAMgkD,GAAuBS,EAAAA,EAAAA,IAAoBlrE,EAAOymB,EAAShkB,OAAQwU,EAAAA,GAAYiuC,mBAE/EhxC,EAAalU,EAAM6C,MAAMqK,OAAOi+D,YAEtC,IAAIR,EAEAA,EADAz2D,GACQk3D,EAAAA,EAAAA,IAA4BprE,EAAOkU,IAEnCm3D,EAAAA,EAAAA,IAAyBrrE,GAGrC,MAAMi9B,GAAQquC,EAAAA,EAAAA,IAAoBtrE,IAAU,CAACurE,oBAAqB,GAElE,MAAO,CACHr3D,aACAy2D,QACAD,aAAac,EAAAA,EAAAA,IAAwBxrE,IAAU,CAAC,EAChDye,cAAeze,EAAMi3B,SAASuvB,MAAM/nC,cACpCusD,iBAAkB/tC,EAAMsuC,oBACxBd,uBAER,IAEA,SAA4B3qE,GACxB,MAAO,CACHsS,SAASgH,EAAAA,EAAAA,IAAmB,CACxBixD,eAAc,IACdd,aAAY,KACZK,eAAc,KACdD,2BAA0B,KAC1BQ,4BAA2B,KAC3BC,+BAA8B,KAC9BH,mBAAkBA,EAAAA,IACnBnqE,GAEX,GAEA,CAA4D4pE,G,mbC5B7C,MAAMtkB,UAAyB19C,IAAAA,cAC1CK,WAAAA,CAAYH,GACRI,MAAMJ,GAAOK,EAAA,mBAaJ,KACTe,KAAKC,SAAS,CAACuW,MAAM,GAAO,IAC/BvX,EAAA,2BAEoB,KACjB,MAAM,QAACmK,GAAWpJ,KAAKpB,MAEvBwK,EAAQC,UAAU,CACdC,QAAShJ,EAAAA,GAAiBsyB,WAC1BppB,WAAYqpB,EAAAA,UAGhB7yB,KAAK0W,YAAY,IACpBzX,EAAA,mBAEY,KACLe,KAAKpB,MAAMk0B,qBACXkuB,EAAAA,EAAAA,GAAahhD,KAAKpB,MAAMk0B,oBAAoB,GAEhD9yB,KAAKpB,MAAM6P,UAAU,IA9BrBzO,KAAKhJ,MAAQ,CACTwf,MAAM,EAEd,CAEAxR,iBAAAA,GACQhF,KAAKpB,MAAM6jE,QACXziE,KAAKpB,MAAM6jE,QAEnB,CAwBAh9D,MAAAA,GAAS,IAAAi9D,EAAAC,EACL,IAAIC,EAAkB,GAKtB,OAJI5iE,KAAKpB,MAAM+U,cACXivD,EAAkB5iE,KAAKpB,MAAM+U,YAAYhT,cAIzCjC,IAAAA,cAAC8P,EAAAA,GAAY,CACT3X,GAAG,mBACHoL,UAAU,aACVyM,eAAe,EACf8H,KAAMxW,KAAKhJ,MAAMwf,KACjBkB,OAAQ1X,KAAK0W,WACbjI,SAAUzO,KAAKkJ,WACf25D,kBAAkB,uBAClBl0D,gBACIjQ,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,4BACH6K,eAAe,iBACf2B,OAAQ,CACJiM,KAAMszD,KAIlBE,eAAe,uBACfl0D,aACIlQ,IAAAA,cAACqP,EAAAA,EAAkB,CACftU,OAA8B,QAAxBipE,EAAE1iE,KAAKpB,MAAM+U,mBAAW,IAAA+uD,OAAA,EAAtBA,EAAwB7rE,GAChCmX,YAAa,CAACC,EAAAA,EAAYqkB,iBAAkBrkB,EAAAA,EAAYskB,eAExD7zB,IAAAA,cAAA,UACI7H,GAAG,eACHW,KAAK,SACLyK,UAAU,2CACVM,QAASvC,KAAK+iE,oBAEdrkE,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,iCACH6K,eAAe,oBAK/BoN,cAAc,EACdk0D,cAAc,MACdj0D,aAAa,GAEbrQ,IAAAA,cAACgiE,EAAc,CACXjnE,OAA8B,QAAxBkpE,EAAE3iE,KAAKpB,MAAM+U,mBAAW,IAAAgvD,OAAA,EAAtBA,EAAwB9rE,KAIhD,EACHoI,EA1FoBm9C,EAAgB,aAZjC3tC,SAAQ5F,IAAAA,KAAAC,WACR25D,OAAM55D,IAAAA,KACNiqB,mBAAkBjqB,IAAAA,OAClBO,QAAOP,IAAAA,MAAA,CACHQ,UAASR,IAAAA,KAAAC,aAAAA,aCMjB,SAAeuG,EAAAA,EAAAA,UAhBf,SAAyBrY,GACrB,MAAMsS,EAAUhJ,EAAAA,GAAiB67C,aACjC,MAAO,CACHxoC,aAAapE,EAAAA,EAAAA,IAAevY,GAC5Bwf,MAAM4uC,EAAAA,EAAAA,GAAYpuD,EAAOsS,GAEjC,IAEA,SAA4BxS,GACxB,MAAO,CACHsS,SAASgH,EAAAA,EAAAA,IAAmB,CACxB/G,UAASA,EAAAA,GACVvS,GAEX,GAEA,CAA4DslD,E,qwCCxB5D,MAAMxf,EAAa,CACfqmC,kBAAmB,MAkBjBC,EAAS,CACXC,QAAUC,GAAUj3C,EAAAA,EAAA,GACbi3C,GAAU,IACbC,WAAY,oCAEhB58D,MAAQ28D,GAAUj3C,EAAAA,EAAA,GACXi3C,GAAU,IACbj8D,MAAO,gDAEXm8D,WAAaF,GAAUj3C,EAAAA,EAAA,GAChBi3C,GAAU,IACbG,aAAc,OACdF,WAAY,8CACZl+B,QAAS,OACTq+B,WAAY,WAEhBC,gBAAkBL,GAAUj3C,EAAAA,EAAA,GACrBi3C,GAAU,IACbp/B,QAAS,mBACT78B,MAAO,8BACPu8D,WAAY,YACZC,SAAU,OACVC,WAAY,IACZC,WAAY,OACZC,cAAe,UAEnBC,iBAAmBX,GAAUj3C,EAAAA,EAAA,GACtBi3C,GAAU,IACbG,aAAc,MACdF,WAAY,8CACZK,WAAY,gBACZC,SAAU,OACVC,WAAY,IACZz8D,MAAO,QACPwpB,MAAO,OACPhN,OAAQ,OACRqgB,QAAS,EACTggC,YAAa,MACb,SAAU,CACNX,WAAY,8CACZl8D,MAAO,YAyDnB,EApDwB6L,IAA6F,IAA5F,YAACpM,EAAW,MAAErC,EAAK,mBAAE0/D,EAAkB,SAAEj5D,EAAQ,GAAEnU,EAAE,YAAEqtE,EAAW,YAAEppB,GAAmB9nC,EAC5G,MAAOmxD,EAAYC,GAAiB1lE,IAAAA,SAAe,IAE7C2lE,GAAkBxpD,EAAAA,EAAAA,cAAY,KAE5BtW,SAAAA,EAAO0Q,SAASkvD,EAAW7mD,SAAiC,IAAtB6mD,EAAWvpE,SAGrDqpE,EAAmBE,GACnBC,EAAc,IAAG,GAClB,CAACH,EAAoBE,EAAY5/D,IAE9B+/D,GAAsCzpD,EAAAA,EAAAA,cAAa9G,IACrD,GAAKowD,EAGL,OAAQpwD,EAAM5Q,KACd,IAAK,IACL,IAAK,IACL,IAAK,QACDkhE,IACAtwD,EAAMvQ,iBACV,GACD,CAAC2gE,EAAYE,IAEVE,GAAejyD,EAAAA,EAAAA,UAAQ,IAClB/N,EAAMrI,KAAKsoE,IAAW,CAAO/iD,MAAO+iD,EAAajgE,MAAOigE,OAChE,CAACjgE,IAEJ,OACI7F,IAAAA,cAAAA,IAAAA,SAAA,KACIA,IAAAA,cAAC+lE,EAAAA,EAAe,CACZ5tE,GAAIA,EACJoL,UAAU,oBACVihE,OAAQA,EACRtmC,WAAYA,EACZsnC,YAAaA,EACbl5D,UAAU6P,EAAAA,EAAAA,cAAatW,GAA4CyG,EAASzG,IAAQ,CAACyG,IACrFm5D,WAAYA,EACZO,SAAS,EACTvX,YAAY,EACZwX,cAAeP,EACf/+D,UAAWi/D,EACX19D,YAAaA,EACbrC,MAAOggE,EACPK,OAAQP,IAEXvpB,EAAcp8C,IAAAA,cAAA,KAAGuD,UAAU,2BAA2B64C,QAAmBjgD,EAC3E,E,eCzGX,MAAMgqE,EAAuB7xD,IAAyF,IAAxF,eAAC8xD,EAAc,kBAAEC,EAAiB,cAAEC,EAAa,yBAAEC,GAAgCjyD,EAC7G,MAAOkyD,EAAoBC,IAAyBvyD,EAAAA,EAAAA,UAAkBkyD,EAAelqE,OAAS,IACxF,cAAC6G,IAAiBgS,EAAAA,EAAAA,WAElB2xD,GAA6BvqD,EAAAA,EAAAA,cAAa5hB,IAC5CksE,EAAsBlsE,GACjBA,GACD8rE,EAAkB,GACtB,GACD,CAACA,IAEEM,GAAuBxqD,EAAAA,EAAAA,cAAayqD,IACtCN,GAAc,GACdC,EAAyB,WACzBF,EAAkB,IAAID,EAAgBQ,GAAQ,GAC/C,CAACR,EAAgBC,EAAmBC,EAAeC,IAEhDM,GAAwB1qD,EAAAA,EAAAA,cAAa2qD,IACvCR,GAAc,GACdC,EAAyB,WACzBF,GAAkBS,aAAqB,EAArBA,EAAuBtpE,KAAKopE,GAAWA,EAAO/gE,UAAU,GAAG,GAC9E,CAACwgE,EAAmBC,EAAeC,IAEtC,OACIvmE,IAAAA,cAAAA,IAAAA,SAAA,KACIA,IAAAA,cAAC+mE,EAAAA,EAAmB,CAChBC,gBACIhnE,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,6BACH6K,eAAe,oEAGvB,cAAY,yBACZO,UAAU,iCACVsM,MAAO9M,EAAc,CACjB5K,GAAI,kCACJ6K,eAAgB,uCAEpBo5C,YAAar5C,EAAc,CACvB5K,GAAI,iCACJ6K,eAAgB,gHAEpBikE,yBAAyB,EACzBC,eAAgB,CAACzjE,KAAM,sBACvB0jE,gBAAiBX,EACjBp+D,aAAcs+D,IAEjBF,GACDxmE,IAAAA,cAAConE,EAAe,CACZjvE,GAAG,iBACH+P,YAAanF,EAAc,CAAC5K,GAAI,oCAAqC6K,eAAgB,wCACrF,aAAYD,EAAc,CAAC5K,GAAI,uCAAwC6K,eAAgB,oBACvF6C,MAAOugE,EACP95D,SAAUu6D,EACVtB,mBAAoBoB,EACpBnB,aAAa,EACbppB,YAAar5C,EAAc,CAAC5K,GAAI,gCAAiC6K,eAAgB,mEAGtF,EAETmjE,EAAAtqD,UAAA,CAnEEuqD,eAAcj8D,IAAAA,QAAAA,IAAAA,QAAAC,WACdi8D,kBAAiBl8D,IAAAA,KAAAC,WACjBk8D,cAAan8D,IAAAA,KAAAC,WACbm8D,yBAAwBp8D,IAAAA,KAAAC,YAkE5B,U,oCC3DA,MAAMi9D,GAAeh9D,EAAAA,EAAAA,gBAAe,CAChCi9D,2BAA4B,CACxBnvE,GAAI,4CACJ6K,eAAgB,qEAQlBukE,EAAqBjzD,IAAqC,IAAAkzD,EAAA,IAApC,uBAACC,GAA8BnzD,EACvD,MAAM1D,GAAO2B,EAAAA,EAAAA,cAAaja,IAAuBuY,EAAAA,EAAAA,IAAevY,KAC1DovE,GAAuBn1D,EAAAA,EAAAA,cAAaja,IAAuBkrE,EAAAA,EAAAA,IAAoBlrE,GAAOsY,aAAI,EAAJA,EAAMzY,KAAM,GAAIoX,EAAAA,GAAYkoB,gBACjHkwC,EAAUC,IAAe1zD,EAAAA,EAAAA,UAA2C,QAAnCszD,EAAoB52D,aAAI,EAAJA,EAAMi3D,iBAAS,IAAAL,EAAAA,EAAI,KACxEM,EAAeC,IAAoB7zD,EAAAA,EAAAA,aACpC,cAACnR,IAAiBgS,EAAAA,EAAAA,YAExBZ,EAAAA,EAAAA,YAAU,KACNyzD,GAAYh3D,aAAI,EAAJA,EAAMi3D,YAAa,GAAG,GACnC,CAACj3D,aAAI,EAAJA,EAAMi3D,YAEV,MAAMG,GAA2B7rD,EAAAA,EAAAA,cAAY1jB,UACzC,MAAM,KAACQ,EAAI,MAAEC,SAAeuuE,GAAuB72D,aAAI,EAAJA,EAAMzY,KAAM,IAE3Dc,SAAAA,EAAM4uE,UACND,EAAY3uE,EAAK4uE,WAIjB3uE,GACA6uE,EAAiBV,EAAaC,2BAClC,GACD,CAACG,EAAwB72D,aAAI,EAAJA,EAAMzY,KAElC,IAAKuvE,EACD,OAAO,KAEX,MAAMO,EACFjoE,IAAAA,cAAA,OACI,cAAY,sBACZ7H,GAAG,uBAEH6H,IAAAA,cAACkoE,EAAAA,EAAK,CACF/vE,GAAG,eACHW,KAAK,OACL+M,MAAO8hE,EACP/vD,UAAW,KAEf5X,IAAAA,cAAA,UACI,cAAY,mBACZ7H,GAAG,mBACHoL,UAAU,mBACVM,QAASmkE,GAEThoE,IAAAA,cAACmoE,EAAAA,YAAW,MACXplE,EAAc,CAAC5K,GAAI,yBAA0B6K,eAAgB,iBAK1E,OACIhD,IAAAA,cAACooE,EAAAA,EAAe,CACZ7kE,UAAU,wBACVsM,MAAO9M,EAAc,CACjB5K,GAAI,wBACJ6K,eAAgB,gBAEpBo5C,YAAar5C,EAAc,CACvB5K,GAAI,2BACJ6K,eAAgB,6MAGpBsiB,QAAS2iD,EACT/uE,MAAO4uE,EACPb,yBAAyB,GAC3B,EAERM,EAAA1rD,UAAA,CAtEE4rD,uBAAsBt9D,IAAAA,KAAAC,YAwE1B,U,eCrFA,MAAMi+D,EAAa/zD,IAAsE,IAArE,mBAACg0D,EAAkB,gBAAEC,EAAe,mBAAEC,GAA0Bl0D,EAChF,MAAM,cAACvR,IAAiBgS,EAAAA,EAAAA,WACxB,GAAIuzD,EAAoB,CACpB,MAAMG,EACFzoE,IAAAA,cAAA,KAAG7H,GAAG,2BACF4K,EAAc,CACV5K,GAAI,uDACJ6K,eAAgB,wFACjB,CACCqhB,KAAOqkD,GACH1oE,IAAAA,cAAC2oE,EAAAA,EAAY,CACT9tD,KAAK,6EACL6iB,SAAS,eAERgrC,MAMrB,OACI1oE,IAAAA,cAACooE,EAAAA,EAAe,CACZ7kE,UAAU,gCACVsM,MAAO9M,EAAc,CACjB5K,GAAI,6BACJ6K,eAAgB,yBAEpBo5C,YAAar5C,EAAc,CACvB5K,GAAI,6BACJ6K,eAAgB,wNAEpBikE,yBAAyB,EACzB3hD,QAASmjD,GAGrB,CAEA,OACIzoE,IAAAA,cAAC+mE,EAAAA,EAAmB,CAChBxjE,UAAU,gCACVyjE,gBACIhnE,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,8BACH6K,eAAe,oEAGvBkkE,eAAgB,CAACzjE,KAAM,mBACvB0jE,gBAAiBoB,EACjBngE,aAAcogE,EACd34D,MAAO9M,EAAc,CACjB5K,GAAI,6BACJ6K,eAAgB,yBAEpBo5C,YAAar5C,EAAc,CACvB5K,GAAI,6BACJ6K,eAAgB,wNAEpBikE,yBAAyB,GAC3B,EAERoB,EAAAxsD,UAAA,CAjEE0sD,gBAAep+D,IAAAA,KAAAC,WACfk+D,mBAAkBn+D,IAAAA,KAClBq+D,mBAAkBr+D,IAAAA,KAAAC,YAiEtB,UC7DMw+D,EAAgCxC,GAC7BA,GAA4C,IAA1BA,EAAelqE,QAGnBkqE,EAAe7vD,SAAS,KAAO6vD,EAAe5yB,MAAM,KAAO,CAAC4yB,IAC7D5oE,KAAKopE,GAAWA,EAAOhoD,SAH9B,GCmBf,GAJkBjO,EAAAA,EAAAA,SAAQ,MAT1B,SAA4BvY,GACxB,MAAO,CACHsS,SAASgH,EAAAA,EAAAA,IAAmB,CACxBm3D,UAAS,KACTpB,uBAAsBA,EAAAA,IACvBrvE,GAEX,GAMA,EDXkBkc,IAAyI,IAAAw0D,EAAA,IAAxI,WAACnnE,EAAU,cAAEonE,EAAa,kBAAEC,EAAiB,WAAEC,EAAU,qBAAEC,EAAoB,cAAE5C,EAAa,aAAE6C,EAAY,KAAEv4D,EAAI,QAAElG,GAAe4J,EAClJ,MAAO8xD,EAAgBC,IAAqBnyD,EAAAA,EAAAA,WAAmB,IAAM00D,EAA6Bh4D,EAAKw4D,oBAChGb,EAAiBC,IAAsBt0D,EAAAA,EAAAA,UAAwC,QAAhC40D,EAAUl4D,EAAKy4D,yBAAiB,IAAAP,GAAAA,IAC/EQ,EAAuB/C,IAA4BryD,EAAAA,EAAAA,aACpD,cAACnR,IAAiBgS,EAAAA,EAAAA,WAElBw0D,GAA6BptD,EAAAA,EAAAA,cAAY1jB,UAC3C,MAAM,MAACS,SAAewR,EAAQm+D,UAAU,CACpC1wE,GAAIyY,EAAKzY,GACTixE,gBAA2C,IAA1BhD,EAAelqE,OAAekqE,EAAe,GAAKA,EAAer2C,KAAK,QAE3F,OAAI72B,CAGO,GACZ,CAACwR,EAAS07D,EAAgBx1D,IAEvB44D,GAAyBrtD,EAAAA,EAAAA,cAAY1jB,UACvC,GAAI8vE,IAAoB33D,EAAKy4D,kBACzB,OAAO,EAEX,MAAMpwE,EAAO,CACTd,GAAIyY,EAAKzY,GACTkxE,kBAAmBd,IAGjB,MAACrvE,SAAewR,EAAQm+D,UAAU5vE,GACxC,OAAIC,CAGO,GACZ,CAACwR,EAAS69D,EAAiB33D,IAExB64D,GAAmBttD,EAAAA,EAAAA,cAAatW,IAClCygE,GAAc,GACdC,EAAyB,WACzBiC,EAAmB3iE,EAAM,GAC1B,CAACygE,IAEEoD,GAAcvtD,EAAAA,EAAAA,cAAY,KAC5BoqD,EAAyB,WACzBD,GAAc,GACd4C,GAAqB,GACrBC,GAAa,EAAM,GACpB,CAACD,EAAsB5C,EAAe6C,IAEnC5xD,GAAe4E,EAAAA,EAAAA,cAAY,KAAM,IAAAwtD,EACnCtD,EAAkBuC,EAA6Bh4D,EAAKw4D,kBACpDZ,EAAyC,QAAvBmB,EAAC/4D,EAAKy4D,yBAAiB,IAAAM,GAAAA,GACzCD,GAAa,GACd,CAACA,EAAa94D,EAAKy4D,kBAAmBz4D,EAAKw4D,kBAExCQ,GAAuBztD,EAAAA,EAAAA,cAAY,KACjC8sD,EACAC,GAAqB,GAGzBH,GAAe,GAChB,CAACA,EAAeE,EAAYC,IAEzBW,GAAoB1tD,EAAAA,EAAAA,cAAY1jB,UAClC,MAAMqxE,QAA6BP,IAC7BQ,QAA0BP,IAC3BM,GAAyBC,GAI9BxD,EAAyB,SACzB2C,GAAqB,GACrBC,GAAa,IALT5C,EAAyB,QAKX,GACnB,CAACgD,EAA4BC,EAAwBN,EAAsBC,IAE9E,OACInpE,IAAAA,cAACgqE,EAAAA,EAAY,CACT1kD,QACItlB,IAAAA,cAAAA,IAAAA,SAAA,KACIA,IAAAA,cAAA,OAAKuD,UAAU,gBACXvD,IAAAA,cAAA,UACI7H,GAAG,cACHW,KAAK,SACLyK,UAAU,QACV,eAAa,QACbM,QAASlC,GAET3B,IAAAA,cAAA,QAAM,cAAY,QAAQ,MAE9BA,IAAAA,cAAA,MAAIuD,UAAU,eACVvD,IAAAA,cAAA,OAAKuD,UAAU,cACXvD,IAAAA,cAAA,KACIuD,UAAU,mBACV,aAAYR,EAAc,CACtB5K,GAAI,yBACJ6K,eAAgB,kBAEpBa,QAAS+lE,KAGjB5pE,IAAAA,cAAA,YAAO+C,EAAc,CAAC5K,GAAI,4BAA6B6K,eAAgB,qBAG/EhD,IAAAA,cAAA,OACIuD,UAAU,yCACVpL,GAAG,iBACH,kBAAgB,eAChBuM,KAAK,YAEJkM,EAAKid,uBACF1xB,EACA6D,IAAAA,cAACmmE,EAAoB,CACjBC,eAAgBA,EAChBC,kBAAmBA,EACnBC,cAAeA,EACfC,yBAA0BA,IAGlCvmE,IAAAA,cAAA,OAAKuD,UAAU,kBACfvD,IAAAA,cAACqoE,EAAU,CACPC,mBAAoB13D,EAAKid,kBACzB06C,gBAAiBA,EACjBC,mBAAoBiB,IAExBzpE,IAAAA,cAAA,OAAKuD,UAAU,kBACdqN,EAAKid,uBACF1xB,EACA6D,IAAAA,cAACunE,EAAkB,CAACE,uBAAwB/8D,EAAQ+8D,yBAEvDwB,EACGjpE,IAAAA,cAACiqE,EAAAA,EAAgB,CACb1yD,aAAcA,EACdQ,aAAc8xD,EACdH,YAAaA,EACbQ,eAAgBlB,EAChB1wE,MAAOgxE,SACNntE,KAIvB,I,wBEhJV,MAiCA,EAjC+BmY,IAAiE,IAAhE,yBAAC61D,EAAwB,YAAEC,EAAW,YAAEhuB,GAAmB9nC,EACvF,MAAM,cAACvR,IAAiBgS,EAAAA,EAAAA,WAElBs1D,GAAoBluD,EAAAA,EAAAA,cAAa3b,IACnC2pE,EAAyB3pE,EAAEC,OAAOoF,MAAM,GACzC,CAACskE,IAEEG,EACFtqE,IAAAA,cAACkoE,EAAAA,EAAK,CACF/vE,GAAG,kBACH,cAAY,uBACZoyE,mBAAmB,4BACnBzxE,KAAK,WACL8e,UAAWhX,EAAAA,GAAU4pE,2BACrBl+D,SAAU+9D,EACVxkE,MAAOu2C,EACPr5B,MAAOhgB,EAAc,CAAC5K,GAAI,8BAA+B6K,eAAgB,kBAIjF,OACIhD,IAAAA,cAACooE,EAAAA,EAAe,CACZhsB,YAAar5C,EAAc,CACvB5K,GAAI,kCACJ6K,eAAgB,oHAEpBsiB,QAASglD,EACT/mE,UAAU,2BACVrK,MAAOkxE,GACT,ECIV,EAjCwB91D,IAAmD,IAAlD,YAAC81D,EAAW,kBAAEK,EAAiB,KAAEhnE,GAAY6Q,EAClE,MAAM,cAACvR,IAAiBgS,EAAAA,EAAAA,WAElB21D,GAAavuD,EAAAA,EAAAA,cAAa3b,GAAqCiqE,EAAkBjqE,EAAEC,OAAOoF,QAAQ,CAAC4kE,IAEnGE,EACF3qE,IAAAA,cAACkoE,EAAAA,EAAK,CACF/vE,GAAG,WACH,cAAY,gBACZW,KAAK,OACL8e,UAAWhX,EAAAA,GAAUgqE,oBACrBt+D,SAAUo+D,EACV7kE,MAAOpC,EACPsf,MAAOhgB,EAAc,CAAC5K,GAAI,uBAAwB6K,eAAgB,gBAI1E,OACIhD,IAAAA,cAACooE,EAAAA,EAAe,CACZv4D,MAAO9M,EAAc,CACjB5K,GAAI,uBACJ6K,eAAgB,cAEpBo5C,YAAar5C,EAAc,CACvB5K,GAAI,2BACJ6K,eAAgB,qFAEpBsiB,QAASqlD,EACTzxE,MAAOkxE,GACT,E,8qBCpBV,MAAMS,EAAqBv2D,IAAkF,IAAjF,KAAC1D,EAAI,KAAEk6D,EAAI,SAAEh/D,EAAQ,SAAEhI,EAAQ,aAAEinE,EAAY,SAAEC,EAAQ,YAAEZ,GAAmB91D,EACpG,MAAM22D,GAAc7qD,EAAAA,EAAAA,QAAyB,OACtC8qD,EAAOC,IAAYj3D,EAAAA,EAAAA,UAAiB,KACpCk3D,EAAmBC,IAAwBn3D,EAAAA,EAAAA,aAC5C,cAACnR,IAAiBgS,EAAAA,EAAAA,WAElBu2D,GAAkBC,EAAAA,EAAAA,IAAgB36D,GAElC46D,GAAkBrvD,EAAAA,EAAAA,cAAY,KAC5B8uD,EAAY7lE,UACZ6lE,EAAY7lE,QAAQS,MAAQ,GAC5BolE,EAAY7lE,QAAQhE,QACxB,GACD,KAiFH+S,EAAAA,EAAAA,YAAU,KACF22D,GAjBYA,KAChB,GAAIA,EAAM,CACN,MAAMW,EAAcC,IAAIC,gBAAgBb,GAElCc,EAAS,IAAIC,WACnBD,EAAOE,OAAUtrE,IACb,MAAMurE,EAAcC,EAAAA,GAA6BxrE,EAAEC,OAAQjF,QACrD4vE,EAAoBY,EAAAA,GAA+BD,GAEzDZ,EAASM,GACTJ,EAAqBD,EAAkB,EAE3CQ,EAAOK,kBAAkBnB,EAC7B,GAKIoB,CAAWpB,EACf,GACD,CAACA,IAEJ,MAiBMqB,EACFnsE,IAAAA,cAAAA,IAAAA,SAAA,KACIA,IAAAA,cAAA,OAAKuD,UAAU,wBAhFL6oE,MACd,GAAItB,EAAM,CACN,MAAMuB,E,+VAAW5+C,CAAA,CACb6+C,gBAAiB,OAASpB,EAAQ,IAClCqB,eAAgB,QAChBC,iBAAkB,SACfpB,GAGP,OACIprE,IAAAA,cAAA,OACI7H,GAAG,gBACH+tC,MAAOmmC,EACP9oE,UAAU,mBACVM,QAAS2nE,GAGrB,CACA,OAAIF,EAEItrE,IAAAA,cAAA,OACI7H,GAAG,gBACHoL,UAAU,mBACVylB,IAAKsiD,EACLznE,QAAS2nE,IAKjBxrE,IAAAA,cAAA,OAAKuD,UAAU,mCACXvD,IAAAA,cAAA,QACI7H,GAAG,kBACH0L,QAAS2nE,EACTjoE,UAAU,mCACZuI,EAAS2gE,OAAO,GAAGC,cAAgB5gE,EAAS2gE,OAAO,IACnD,EA8CDL,GAvGLpsE,IAAAA,cAAAA,IAAAA,SAAA,KACIA,IAAAA,cAAA,SACI,cAAY,gBACZiI,IAAKgjE,EACL1nE,UAAU,SACVopE,OAAQ/rE,EAAAA,GAAUgsE,oBAClB9oE,SAAUA,EACVhL,KAAK,OACLwT,SAAUy+D,EACV,eAAa,EACb/mE,UAAW,IAEfhE,IAAAA,cAAA,QACI8D,SAAUA,EACVD,QAAS2nE,GAETxrE,IAAAA,cAAC6sE,EAAAA,EAAQ,SAoEjB/B,GAAQQ,EAEJtrE,IAAAA,cAAA,UACI6D,QAASmnE,EACT,cAAY,oBACZznE,UAAU,mDAEVvD,IAAAA,cAAC8nD,EAAAA,oBAAmB,MACnB/kD,EAAc,CAAC5K,GAAI,+BAAgC6K,eAAgB,kBAKzE,MAaX,OACIhD,IAAAA,cAACooE,EAAAA,EAAe,CACZv4D,MAAO9M,EAAc,CACjB5K,GAAI,wBACJ6K,eAAgB,cAEpBo5C,YAAakvB,OAAkBnvE,EAAY4G,EACvC,CACI5K,GAAI,+BACJ6K,eAAgB,+EAEpB,CACIvE,IAAK,SAGb6mB,QAAS6mD,EACT5oE,UAAU,uBACVrK,MAAOkxE,GACT,EAERS,EAAAhvD,UAAA,CA1JE/P,SAAQ3B,IAAAA,OAAAC,WACRtG,SAAQqG,IAAAA,KAAAC,WACR2gE,aAAY5gE,IAAAA,KAAAC,WACZ4gE,SAAQ7gE,IAAAA,KAAAC,YAyJZ,UC3JM0iE,EAA4B,CAAC,aAAc,YAAa,aACxDzF,GAAeh9D,EAAAA,EAAAA,gBAAe,CAChC0iE,SAAU,CACN50E,GAAI,uBACJ6K,eAAgB,0BAEpBgqE,qBAAsB,CAClB70E,GAAI,mCACJ6K,eAAgB,8GAChB2B,OAAQ,CAACjF,IAAKkB,EAAAA,GAAUqsE,oBAAqBxuE,IAAKmC,EAAAA,GAAUgqE,sBAEhEsC,wBAAyB,CACrB/0E,GAAI,sCACJ6K,eAAgB,0DAEpBmqE,iBAAkB,CACdh1E,GAAI,+BACJ6K,eAAgB,kDAEpBoqE,cAAe,CACXj1E,GAAI,4BACJ6K,eAAgB,kDCQxB,IAJkB2N,EAAAA,EAAAA,UApBlB,SAAyBrY,GAAoB,IAAA+0E,EACzC,MAAMjnD,GAASnT,EAAAA,EAAAA,IAAU3a,GAGzB,MAAO,CACHg1E,YAHgBC,SAA2B,QAAnBF,EAACjnD,EAAOonD,mBAAW,IAAAH,EAAAA,EAAI,GAAI,IAK3D,IAEA,SAA4Bj1E,GACxB,MAAO,CACHsS,SAASgH,EAAAA,EAAAA,IAAmB,CACxB+7D,QAAO,KACP5E,UAAS,KACT6E,eAAc,KACdC,YAAWA,EAAAA,IACZv1E,GAEX,GAMA,EDHgBkc,IAAsJ,IAAAs5D,EAAA,IAArJ,KAACh9D,EAAI,WAAEq4D,EAAU,YAAEqE,EAAW,WAAE3rE,EAAU,cAAEonE,EAAa,kBAAEC,EAAiB,qBAAEE,EAAoB,cAAE5C,EAAa,aAAE6C,EAAY,QAAEz+D,GAAe4J,EAC7J,MAAO7Q,EAAMoqE,IAAW35D,EAAAA,EAAAA,UAA+BtD,EAAK3O,eACrDm6C,EAAa0xB,IAAkB55D,EAAAA,EAAAA,UAA8BtD,EAAKwrC,cAClE2xB,EAAcC,IAAmB95D,EAAAA,EAAAA,aACjChQ,EAAS+pE,IAAc/5D,EAAAA,EAAAA,WAAkB,IACzCg6D,EAAkBC,IAAuBj6D,EAAAA,EAAAA,aACzCk6D,EAAiBC,IAAsBn6D,EAAAA,EAAAA,aACvCo1D,EAAuB/C,IAA4BryD,EAAAA,EAAAA,aACpD,cAACnR,IAAiBgS,EAAAA,EAAAA,WAElBu5D,GAA8BnyD,EAAAA,EAAAA,cAAY1jB,UAC5C,GAAIgL,EAAKmb,SAAWhO,EAAK3O,cAAgBm6C,IAAgBxrC,EAAKwrC,YAC1D,OAAO,EAGX,IAAK34C,EAED,OADA4qE,EAAmBhH,EAAa0F,WACzB,EACJ,GAAItpE,EAAKvH,OAAS0E,EAAAA,GAAUqsE,oBAE/B,OADAoB,EAAmBhH,EAAa2F,uBACzB,EAEXqB,OAAmBlyE,GACnB,MAAM,MAACjD,SAAewR,EAAQm+D,UAAU,CAAC1wE,GAAIyY,EAAKzY,GAAI8J,aAAcwB,EAAM24C,gBAC1E,OAAIljD,CAGO,GACZ,CAACwR,EAAS0xC,EAAa34C,EAAMmN,EAAKwrC,YAAaxrC,EAAK3O,aAAc2O,EAAKzY,KAEpEo2E,GAAuBpyD,EAAAA,EAAAA,cAAY1jB,UACrC,IAAKs1E,EACD,OAAO,EAEXE,GAAW,GACXE,OAAoBhyE,GACpB,MAAM,MAACjD,SAAewR,EAAQijE,YAAY/8D,EAAKzY,GAAI41E,GAEnD,OADAE,GAAW,IACP/0E,CAGO,GACZ,CAACwR,EAASkG,EAAMm9D,IAEblE,GAAoB1tD,EAAAA,EAAAA,cAAY1jB,UAClC,MAAM+1E,QAA+BF,UACPC,KACLC,GAIzBjI,EAAyB,SACzB2C,GAAqB,GACrBC,GAAa,IALT5C,EAAyB,QAKX,GACnB,CAAC+H,EAA6BC,EAAsBrF,EAAsBC,IAEvEO,GAAcvtD,EAAAA,EAAAA,cAAY,KAC5BoqD,EAAyB,WACzBD,GAAc,GACd4C,GAAqB,GACrBC,GAAa,EAAM,GACpB,CAACD,EAAsB5C,EAAe6C,IAEnC5xD,GAAe4E,EAAAA,EAAAA,cAAY,KAAM,IAAAsyD,EACnCZ,EAAyB,QAAlBY,EAAC79D,EAAK3O,oBAAY,IAAAwsE,EAAAA,EAAI79D,EAAKnN,MAClCqqE,EAAel9D,EAAKwrC,aACpB4xB,OAAgB7xE,GAChBgyE,OAAoBhyE,GACpBkyE,OAAmBlyE,GACnButE,GAAa,GACd,CAACA,EAAa94D,EAAKwrC,YAAaxrC,EAAK3O,aAAc2O,EAAKnN,OAErDirE,GAAuBvyD,EAAAA,EAAAA,cAAY1jB,UACrCw1E,GAAW,GACXE,OAAoBhyE,GACpB6xE,OAAgB7xE,GAChButE,IAEA,MAAM,MAACxwE,SAAewR,EAAQgjE,eAAe98D,EAAKzY,IAClD81E,GAAW,GACP/0E,IACAqtE,EAAyB,SACzBD,GAAc,GACd4C,GAAqB,GACzB,GACD,CAACx+D,EAASg/D,EAAaR,EAAsB5C,EAAe11D,EAAKzY,KAE9Dw2E,GAAiBxyD,EAAAA,EAAAA,cAAa3b,IAChC,GAAIA,GAAKA,EAAEC,QAAUD,EAAEC,OAAOmuE,OAASpuE,EAAEC,OAAOmuE,MAAM,GAAI,CACtD,MAAM9D,EAAOtqE,EAAEC,OAAOmuE,MAAM,GAEvB9B,EAA0Bv2D,SAASu0D,EAAKhyE,MAElCgyE,EAAKvoE,KAAO+qE,EACnBa,EAAoB9G,EAAa8F,mBAEjCa,EAAgBlD,GAChBqD,OAAoBhyE,GACpBoqE,EAAyB,WACzBD,GAAc,IAPd6H,EAAoB9G,EAAa6F,wBASzC,MACIc,OAAgB7xE,GAChBgyE,EAAoB9G,EAAa+F,cACrC,GACD,CAACE,EAAahH,IAEXmE,GAAoBtuD,EAAAA,EAAAA,cAAa1Y,IACnC6iE,GAAc,GACdC,EAAyB,WACzBsH,EAAQpqE,EAAK,GACd,CAAC6iE,IAEE6D,GAA2BhuD,EAAAA,EAAAA,cAAaigC,IAC1CkqB,GAAc,GACdC,EAAyB,WACzBuH,EAAe1xB,EAAY,GAC5B,CAACkqB,IAEEuI,GAAsB1yD,EAAAA,EAAAA,cAAY,KAChC8sD,EACAC,GAAqB,GAGzBH,GAAe,GAChB,CAACA,EAAeE,EAAYC,IAEzB4F,EACF9uE,IAAAA,cAAAA,IAAAA,SAAA,KACIA,IAAAA,cAAA,OAAKuD,UAAU,gBACXvD,IAAAA,cAAA,UACI7H,GAAG,cACHW,KAAK,SACLyK,UAAU,QACV,eAAa,QACbM,QAASlC,GAET3B,IAAAA,cAAA,QAAM,cAAY,QAAQ,MAE9BA,IAAAA,cAAA,MAAIuD,UAAU,eACVvD,IAAAA,cAAA,OAAKuD,UAAU,cACXvD,IAAAA,cAAA,KACIuD,UAAU,mBACV,aAAYR,EAAc,CACtB5K,GAAI,yBACJ6K,eAAgB,kBAEpBa,QAASgrE,KAGjB7uE,IAAAA,cAAA,YAAO+C,EAAc,CAAC5K,GAAI,4BAA6B6K,eAAgB,qBAG/EhD,IAAAA,cAAA,OACIuD,UAAU,uCACVpL,GAAG,eACH,kBAAgB,aAChBuM,KAAK,YAEL1E,IAAAA,cAAA,OAAKuD,UAAU,8BACXvD,IAAAA,cAAC+uE,EAAe,CACZtrE,KAAMA,EACN2mE,YAAagE,EACb3D,kBAAmBA,IAEvBzqE,IAAAA,cAACgvE,EAAsB,CACnB5yB,YAAaA,EACb+tB,yBAA0BA,KAGlCnqE,IAAAA,cAAC6qE,EAAkB,CACfj6D,KAAMA,EACNk6D,KAAMiD,EACNjqE,SAAUI,EACV6mE,aAAc4D,EACd3D,SAAU0D,EACV5iE,SAA2B,QAAnB8hE,EAAEh9D,EAAK3O,oBAAY,IAAA2rE,EAAAA,EAAIh9D,EAAKnN,KACpC2mE,YAAa8D,IAEhBjF,EACGjpE,IAAAA,cAACiqE,EAAAA,EAAgB,CACb1yD,aAAcA,EACdQ,aAAc8xD,EACdH,YAAaA,EACbQ,eAAgBlB,EAChB1wE,MAAOgxE,SACNntE,IAKrB,OAAO6D,IAAAA,cAACgqE,EAAAA,EAAY,CAAC1kD,QAASwpD,GAAsB,IE1NlDG,GAAe36D,IAUR,IAKL9Y,GAfc,UAClB0zE,EAAY,GAAE,WACdvtE,EAAU,cACVonE,EAAa,KACbn4D,EAAI,WACJq4D,EAAU,kBACVD,EAAiB,cACjB1C,EAAa,qBACb4C,EAAoB,aACpBC,GACI70D,EACJ,IAAK1D,EACD,OAAO,KAIX,OAAQs+D,GACR,IAAK,OACD1zE,EACIwE,IAAAA,cAACmvE,GAAO,CACJv+D,KAAMA,EACNq4D,WAAYA,EACZ3C,cAAeA,EACf0C,kBAAmBA,EACnBE,qBAAsBA,EACtBC,aAAcA,EACdxnE,WAAYA,EACZonE,cAAeA,IAGvB,MACJ,IAAK,SACDvtE,EACIwE,IAAAA,cAACovE,EAAS,CACNx+D,KAAMA,EACNq4D,WAAYA,EACZ3C,cAAeA,EACf0C,kBAAmBA,EACnBE,qBAAsBA,EACtBC,aAAcA,EACdxnE,WAAYA,EACZonE,cAAeA,IAGvB,MACJ,QACIvtE,EACIwE,IAAAA,cAAA,YAKR,OAAOxE,CAAM,EACfyzE,GAAApzD,UAAA,CAhEEqzD,UAAS/kE,IAAAA,OAAAC,WACT6+D,WAAU9+D,IAAAA,KAAAC,WACV4+D,kBAAiB7+D,IAAAA,KAAAC,WACjBk8D,cAAan8D,IAAAA,KAAAC,WACb8+D,qBAAoB/+D,IAAAA,KAAAC,WACpB++D,aAAYh/D,IAAAA,KAAAC,WACZzI,WAAUwI,IAAAA,KAAAC,WACV2+D,cAAa5+D,IAAAA,KAAAC,YA2DjB,YC5DA,IAAeuG,EAAAA,EAAAA,UANf,SAAyBrY,GACrB,MAAO,CACHsY,MAAMC,EAAAA,EAAAA,IAAevY,GAE7B,GAEA,CAAwC22E,I,gBCLxC,MAAMI,GAAkBrvE,IAAAA,MAAW,IAAM,kCAUnCm9C,GAAoB7oC,IAA2D,IAA1D,SAACvE,EAAQ,eAAEu/D,EAAc,mBAAEl7C,GAA0B9f,EAC5E,MAAO46D,EAAWK,IAAgBr7D,EAAAA,EAAAA,UAAS,SACpC4D,EAAMiT,IAAW7W,EAAAA,EAAAA,WAAkB,IACnC+0D,EAAY3C,IAAiBpyD,EAAAA,EAAAA,WAAkB,IAC/C80D,EAAmBE,IAAwBh1D,EAAAA,EAAAA,WAAkB,IAC7Ds7D,EAAeC,IAAoBv7D,EAAAA,EAAAA,WAAkB,IACrDw7D,EAAWvG,IAAgBj1D,EAAAA,EAAAA,WAAkB,GAC9Cy7D,GAAevvD,EAAAA,EAAAA,QAAkB,OACjC,cAACrd,IAAiBgS,EAAAA,EAAAA,WAElB66D,GAAYzzD,EAAAA,EAAAA,cAAa0zD,IACvB5G,EACAC,GAAqB,IAGzBqG,EAAaM,GACbvJ,GAAc,GACd4C,GAAqB,GACrBuG,GAAiB,GAAM,GACxB,CAACxG,IAEEjxD,GAAamE,EAAAA,EAAAA,cAAY,MAGvB8sD,GAAeuG,GAAkBE,EAOjC3kD,GAAQ,IANR0kD,GAAiB,GACjBvG,GAAqB,GACrBjkE,YAAW,KACPikE,GAAqB,EAAM,GApCO,KAwC1C,GACD,CAACD,EAAYuG,EAAeE,IAEzBhG,GAAcvtD,EAAAA,EAAAA,cAAY,KACxBiY,IACAkuB,EAAAA,GAAAA,GAAaluB,GAAoB,GAErCm7C,EAAa,QACbjJ,GAAc,GACd4C,GAAqB,GACrBuG,GAAiB,GACjBtG,GAAa,GACbp5D,GAAU,GACX,CAACA,EAAUqkB,IAER43B,GAAiB7vC,EAAAA,EAAAA,cAAY,KAC/B,MAAM2zD,EAAKC,IAAAA,YAAqBJ,EAAavqE,SAC7C0qE,SAAAA,EAAIE,QAAQ,iBAAkB9uE,UAAUorD,OAAO,oBAC/CijB,EAAa,GAAG,GACjB,IAEGU,EAAO,CACT,CAACxsE,KAAM,OAAQy0B,OAAQn1B,EAAc,CAAC5K,GAAI,8BAA+B6K,eAAgB,SAAUmM,KAAM,gCAAiC+gE,UAAWntE,EAAc,CAAC5K,GAAI,qBAAsB6K,eAAgB,gBAMlN,OAJIssE,GACAW,EAAK/mE,KAAK,CAACzF,KAAM,SAAUy0B,OAAQn1B,EAAc,CAAC5K,GAAI,gCAAiC6K,eAAgB,WAAYmM,KAAM,qCAAsC+gE,UAAWntE,EAAc,CAAC5K,GAAI,uBAAwB6K,eAAgB,kBAIrOhD,IAAAA,cAAC8Y,EAAAA,MAAK,CACFC,gBAAgB,6BAChBjB,KAAMA,EACNkB,OAAQhB,EACRjI,SAAU25D,EACVhlE,KAAK,OACL,kBAAgB,yBAChBvM,GAAG,qBAEH6H,IAAAA,cAAC8Y,EAAAA,MAAMG,OAAM,CACT9gB,GAAG,yBACH+gB,aAAa,GAEblZ,IAAAA,cAAC8Y,EAAAA,MAAMK,MAAK,CACRC,eAAe,KACf7V,UAAU,uBAETR,EAAc,CAAC5K,GAAI,4BAA6B6K,eAAgB,oBAGzEhD,IAAAA,cAAC8Y,EAAAA,MAAMO,KAAI,CAACpR,IAAK0nE,GACb3vE,IAAAA,cAAA,OAAKuD,UAAU,kBACXvD,IAAAA,cAAA,OAAKuD,UAAU,kBACXvD,IAAAA,cAACA,IAAAA,SAAc,CAACmwE,SAAU,MACtBnwE,IAAAA,cAACqvE,GAAe,CACZY,KAAMA,EACNf,UAAWA,EACXU,UAAWA,MAIvB5vE,IAAAA,cAAA,OAAKuD,UAAU,sCACXvD,IAAAA,cAACivE,GAAY,CACTC,UAAWA,EACXjG,WAAYA,EACZ3C,cAAeA,EACf0C,kBAAmBA,EACnBE,qBAAsBA,EACtBC,aAAcA,EACdxnE,WAAYqW,EACZ+wD,cAAe/c,OAK3B,EAEd7O,GAAAthC,UAAA,CAjHE9L,SAAQ5F,IAAAA,KAAAC,WACRklE,eAAcnlE,IAAAA,KAAAC,WACdgqB,mBAAkBjqB,IAAAA,QAiHtB,YCzGA,IAAewG,EAAAA,EAAAA,UAVf,SAAyBrY,GACrB,MAAMyC,GAASkW,EAAAA,EAAAA,IAAiB3Y,GAC1Bg3E,GAAiB9L,EAAAA,EAAAA,IAAoBlrE,EAAOyC,EAAQwU,EAAAA,GAAYkoB,aAChE7sB,EAAUhJ,EAAAA,GAAiBs7C,cACjC,MAAO,CACHplC,MAAM4uC,EAAAA,EAAAA,GAAYpuD,EAAOsS,GACzB0kE,iBAER,GAEA,CAAwCnyB,G,2rCCIM,IAEzCizB,EAAW,SAAXA,GAAW,OAAXA,EAAW,kBAAXA,EAAW,gBAAXA,EAAW,YAAXA,CAAW,EAAXA,GAAW,IAkBT,MAAMC,UAAkCrwE,IAAAA,cAA2BK,WAAAA,GAAA,SAAApE,WAAAsE,EAAA,yBA0BnD,KACf,MAAM,aAAC+vE,GAAgBhvE,KAAKpB,OACtB,SAACuf,EAAQ,mBAAE8wD,IAAsBC,EAAAA,EAAAA,IAAgBF,GAEvDrV,EAAAA,EAAWwV,yBAAyBhxD,EAAU8wD,EAAmB,IACpEhwE,EAAA,oBAEa,KACV,MAAM,SACFmwE,EAAQ,eACR5xE,EAAc,YACdmW,EAAW,gBACX07D,EAAe,aACfL,EAAY,gBACZM,EAAe,SACfC,EAAQ,iBACRC,GACAxvE,KAAKpB,OACH,cAAC6C,GAAiBzB,KAAKpB,MAAM4C,KAE7BiuE,EAAkBL,GAAY,IAE9B,SAACjxD,EAAQ,mBAAE8wD,IAAsBC,EAAAA,EAAAA,IAAgBF,GAEjDU,EAAeT,EAAqB,EAAI,IAAHvuE,OAAOuuE,EAAkB,MAAO,GACrEU,GAAe3vE,KAAK4vE,2BAA6BzxD,EAAW,KAAO,GAEzE,GAAI3gB,GAAkBmW,GAAenW,EAAe3G,GAAI,CACpD,IAAIg5E,EAAqBryE,EAAemD,aACpCnD,EAAehG,OAAS8H,EAAAA,GAAU3D,YACX,MAAnB0zE,IACAQ,EAAqBR,EAAgB1uE,cAG7CwE,SAASoJ,MAAQ,GAAH7N,OAAMgvE,GAAYhvE,OAAGivE,GAAWjvE,OAAGmvE,EAAkB,OAAAnvE,OAAMiT,EAAYhT,aAAY,KAAAD,OAAI+uE,EACzG,MACItqE,SAASoJ,MADFoF,GAAe27D,EACL7tE,EAAc,CAC3B5K,GAAI,sBACJ6K,eAAgB,8CACjB,CACCouE,OAAQ,GAAFpvE,OAAKgvE,GAAYhvE,OAAGivE,GAC1Bj2E,YAAaia,EAAYhT,aACzByuE,SAAUK,IAEP97D,GAAe47D,EACL9tE,EAAc,CAC3B5K,GAAI,eACJ6K,eAAgB,6CACjB,CACCouE,OAAQ,GAAFpvE,OAAKgvE,GAAYhvE,OAAGivE,GAC1Bj2E,YAAaia,EAAYhT,aACzByuE,SAAUK,IAEP97D,GAAe67D,EACL/tE,EAAc,CAC3B5K,GAAI,uBACJ6K,eAAgB,gDACjB,CACCouE,OAAQ,GAAFpvE,OAAKgvE,GAAYhvE,OAAGivE,GAC1Bj2E,YAAaia,EAAYhT,aACzByuE,SAAUK,IAGGhuE,EAAc,CAAC5K,GAAI,sBAAuB6K,eAAgB,4BAA6B,CAAC0tE,SAAUK,GAAmB,cAC1I,IACHxwE,EAAA,sBAEgB8wE,IACb,IAAM9qE,EAAAA,OAAyBA,EAAAA,KAC3B,OAKJ,IAFaE,SAAS27C,cAAc,oBAGhC,OAEJ,MAAMkvB,EAAY7qE,SAAS27C,cAA+B,mCACpDmvB,EAAY9qE,SAAS27C,cAA+B,mCACpDovB,EAAY/qE,SAAS27C,cAA+B,mCACpDqvB,EAAYhrE,SAAS27C,cAA+B,mCACpDsvB,EAAYjrE,SAAS27C,cAA+B,mCAEpDuvB,EAAc/gD,IAAwBghD,EAAAA,EAAAA,IAAahhD,GAEzD,OAAQygD,GACR,KAAKjB,EAAYyB,QACbP,EAAWz2D,KAAO82D,EAAWG,GAC7BP,EAAW12D,KAAO82D,EAAWI,GAC7BP,EAAW32D,KAAO82D,EAAWK,GAC7BP,EAAW52D,KAAO82D,EAAWM,GAC7BP,EAAW72D,KAAO82D,EAAWO,GAC7B,MAEJ,KAAK9B,EAAY+B,OACbb,EAAWz2D,KAAO82D,EAAWS,GAC7Bb,EAAW12D,KAAO82D,EAAWU,GAC7Bb,EAAW32D,KAAO82D,EAAWW,GAC7Bb,EAAW52D,KAAO82D,EAAWY,GAC7Bb,EAAW72D,KAAO82D,EAAWa,GAC7B,MAEJ,QACIlB,EAAWz2D,KAAO82D,EAAWc,GAC7BlB,EAAW12D,KAAO82D,EAAWe,GAC7BlB,EAAW32D,KAAO82D,EAAWgB,GAC7BlB,EAAW52D,KAAO82D,EAAWiB,GAC7BlB,EAAW72D,KAAO82D,EAAWkB,GAEjC,GACH,CAvIDhvD,kBAAAA,CAAmBC,GACfxiB,KAAKwxE,cACL,MAAMC,EAAiBzxE,KAAK0xE,eAAelvD,EAAUwsD,cAC/C2C,EAAiB3xE,KAAK0xE,eAAe1xE,KAAKpB,MAAMowE,cAElDyC,IAAmBE,GACnB3xE,KAAK4xE,cAAcD,GAGvB3xE,KAAK6xE,kBACT,CAEA,6BAAIjC,GACA,OAAO3qE,EAAAA,MAAwBA,EAAAA,IACnC,CAEAysE,cAAAA,CAAe1C,GACX,MAA4B,iBAAjBA,EACAF,EAAYyB,QACZvB,EACAF,EAAY+B,OAEhB/B,EAAYgD,IACvB,CAkHArsE,MAAAA,GACI,OAAO,IACX,EACHxG,EA7IY8vE,EAAyB,aATlCK,SAAQvmE,IAAAA,OAIRymE,gBAAezmE,IAAAA,KAAAC,WACfymE,SAAQ1mE,IAAAA,KAAAC,WACR0mE,iBAAgB3mE,IAAAA,KAAAC,aAkJpB,SAAeE,EAAAA,EAAAA,YAAW+lE,GC/J1B,GAAevsC,EAAAA,EAAAA,aAAWnzB,EAAAA,EAAAA,UAlB1B,SAAyBrY,EAAkBgc,GAAiC,IAA9BopB,UAAU,SAACoY,IAAiBxhC,EACtE,MAAM8R,GAASnT,EAAAA,EAAAA,IAAU3a,GACnBwG,GAAiBy7B,EAAAA,EAAAA,IAAkBjiC,GACnCq4E,EAAmB7xE,GAAkBA,EAAewpB,YAAexpB,EAAiB,KAG1F,MAAO,CACHA,iBACAmW,aAJgBpE,EAAAA,EAAAA,IAAevY,GAK/Bq4E,kBACAD,SAAUtqD,EAAOitD,SACjB/C,cAAcgD,EAAAA,EAAAA,IAAgBh7E,GAC9Bs4E,gBAAqF,OAApE2C,EAAAA,EAAAA,WAAUz9B,EAAU,CAACznB,KAAM,sCAC5CwiD,SAA0D,OAAhD0C,EAAAA,EAAAA,WAAUz9B,EAAU,CAACznB,KAAM,kBACrCyiD,iBAA2E,OAAzDyC,EAAAA,EAAAA,WAAUz9B,EAAU,CAACznB,KAAM,2BAErD,GAE0B1d,CAAyBqoD,G,sEC7BpC,SAAS6T,IACpB,MAAM,cAAC9pE,IAAiBgS,EAAAA,EAAAA,WACxB,OACI/U,IAAAA,cAAA,KACIuD,UAAU,sBACV,cAAY,OACZsM,MAAO9M,EAAc,CAAC5K,GAAI,qBAAsB6K,eAAgB,eAG5E,C,yHCUA,SAASinE,EAAgB31D,GASf,IATgB,aACtByD,EAAY,aACZR,EAAY,YACZmyD,EAAW,eACXQ,GAAiB,EAAK,MACtB5xE,EAAQ,UAAS,mBACjBk7E,EAAkB,eAClBC,EAAc,iBACdC,GACIp/D,EACJ,MAAMq/D,EAAiBhwE,IAAW,mBAAoB,CAACzK,MAAOgxE,GAA4B,UAAV5xE,GAAoB,CAACs7E,MAAiB,UAAVt7E,IACtGu7E,EAAmBlwE,IAAW,4BAA6B,CAACzK,MAAOgxE,GAA4B,UAAV5xE,GAAoB,CAACs7E,MAAiB,UAAVt7E,IACjHw7E,EAAwBnwE,IAAW,uDAAwD,CAACzK,MAAOgxE,GAA4B,UAAV5xE,GAAoB,CAACs7E,MAAiB,UAAVt7E,IACjJy7E,EAAsBpwE,IAAW,oDAAqD,CAACzK,MAAOgxE,GAA4B,UAAV5xE,GAAoB,CAACs7E,MAAiB,UAAVt7E,IA+FlJ,OA7FA6b,EAAAA,EAAAA,YAAU,KACN,IAAI0C,EAOJ,MANc,UAAVve,IACAue,EAAY5R,YAAW,KACnBykE,GAAa,GA/BP,OAmCP,IAAMt9D,aAAayK,EAAU,GACrC,CAAC6yD,EAAapxE,IAqFb0H,IAAAA,cAAA,OAAKuD,UAAWowE,GACZ3zE,IAAAA,cAAA,KAAGuD,UAAWswE,GACV7zE,IAAAA,cAACg0E,EAAAA,uBAAsB,CACnBzxE,KAAM,GACNkG,MAAO,iBAtFf+qE,IAAuBtJ,GAA4B,UAAV5xE,GAClCk7E,EAGPtJ,GAA4B,YAAV5xE,EAEd0H,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,2BACH6K,eAAe,6BAKb,UAAV1K,EAEI0H,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,yBACH6K,eAAe,4CAMvBhD,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,yBACH6K,eAAe,oBAKIixE,MAC3B,GAAc,UAAV37E,EACA,OACI0H,IAAAA,cAAA,OAAKuD,UAAU,6BACXvD,IAAAA,cAAA,UACI7H,GAAG,mBACHW,KAAK,SACLyK,UAAU,sBACVM,QAAS6lE,GAET1pE,IAAAA,cAAA,KACIuD,UAAU,sBAO9B,MAAM2wE,EAAqBhK,GAA4B,UAAV5xE,EAE7C,OACI0H,IAAAA,cAAA,OAAKuD,UAAU,6BACXvD,IAAAA,cAAA,UACI,cAAY,+BACZuD,UAAWuwE,EACXjwE,QAAS0T,GAERm8D,GACG1zE,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,0BACH6K,eAAe,UAI3BhD,IAAAA,cAAA,UACI,cAAY,6BACZuD,UAAWwwE,EACXlwE,QAASkU,EACTjU,SAAUowE,GAETT,GACGzzE,IAAAA,cAACkD,EAAAA,iBAAgB,CACb/K,GAAG,wBACH6K,eAAe,UAIzB,EAaLixE,GAGb,CAAChK,EAAApuD,UAAA,CAjIG9D,aAAY5N,IAAAA,KAAAC,WACZmN,aAAYpN,IAAAA,KAAAC,WACZs/D,YAAWv/D,IAAAA,KAAAC,WACX8/D,eAAc//D,IAAAA,KAEdqpE,mBAAkBrpE,IAAAA,OAClBspE,eAActpE,IAAAA,KACdupE,iBAAgBvpE,IAAAA,MA2HpB,S,2CC5IA,MAAMgqE,EAAkB,CAAC,EAEZh6E,EAAsBA,CAAC7B,EAAoBJ,IAClCI,EAAMi3B,SAAS6kD,iBAAiBC,YAAYn8E,IAGnDi8E,EAMFx7E,EAAqBA,CAACL,EAAoBJ,EAAmBo8E,IAC/Dn6E,EAAoB7B,EAAOJ,GAAWo8E,E,+ECJ1C,SAASl9B,EAAa9+C,GACzB,OAAOA,EAAM6C,MAAMo5E,IAAIj3D,MAC3B,CAMO,SAASq4C,EAAuBr9D,GACnC,OAAOA,EAAM6C,MAAMo5E,IAAIliB,mBAC3B,CAEO,MAAMmiB,GAAiBC,E,SAAAA,MAEjB7e,GAAwBrlD,EAAAA,EAAAA,IACjC,+BACAkxB,EAAAA,GACA+yC,GACA,CAACE,EAAyBC,KACtB,MAAM7kB,EAA4B,GAclC,OAZI4kB,GACA5kB,EAAY5mD,KAAK,CACb/Q,GAAI,UACJy8E,WAAW,IAInB9kB,EAAY5mD,KAAK,CACb/Q,GAAI,SACJy8E,UAAWD,EAAc,IAGtB7kB,EAAYlzD,QAAQ6M,GAASA,EAAKmrE,WAAU,G","sources":["webpack://mattermost-webapp/./src/actions/channel_bookmarks.ts","webpack://mattermost-webapp/./src/packages/mattermost-redux/src/actions/channel_bookmarks.ts","webpack://mattermost-webapp/./src/actions/views/channel_sidebar.ts","webpack://mattermost-webapp/./src/components/searchable_channel_list.tsx","webpack://mattermost-webapp/./src/components/browse_channels/browse_channels.tsx","webpack://mattermost-webapp/./src/components/browse_channels/index.ts","webpack://mattermost-webapp/./src/components/channel_bookmarks/utils.ts","webpack://mattermost-webapp/./src/components/channel_move_to_sub_menu/index.tsx","webpack://mattermost-webapp/./src/components/edit_category_modal/edit_category_modal.tsx","webpack://mattermost-webapp/./src/components/edit_category_modal/index.ts","webpack://mattermost-webapp/./src/components/leave_team_modal/leave_team_modal.tsx","webpack://mattermost-webapp/./src/components/leave_team_modal/index.ts","webpack://mattermost-webapp/./src/components/list_modal.tsx","webpack://mattermost-webapp/./src/components/search_shortcut/search_shortcut.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_category/sidebar_category_menu/create_new_category_menu_item.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_category/sidebar_category_menu/mark_as_read_confirm_modal.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_category/sidebar_category_menu/mark_as_read_menu_item.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_category/sidebar_category_menu/sidebar_category_generic_menu.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_category_header.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_channel/channel_mention_badge.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_channel/channel_pencil_icon/channel_pencil_icon.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_channel/channel_pencil_icon/index.ts","webpack://mattermost-webapp/./src/components/sidebar/sidebar_channel/sidebar_channel_icon/sidebar_channel_icon.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_channel/sidebar_channel_menu/sidebar_channel_menu.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_channel/sidebar_channel_menu/index.ts","webpack://mattermost-webapp/./src/components/sidebar/sidebar_channel/sidebar_channel_link/sidebar_channel_link.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_channel/sidebar_channel_link/index.ts","webpack://mattermost-webapp/./src/components/sidebar/sidebar_channel/sidebar_base_channel/sidebar_base_channel.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_channel/sidebar_base_channel/index.ts","webpack://mattermost-webapp/./src/components/sidebar/sidebar_channel/sidebar_direct_channel/sidebar_direct_channel.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_channel/sidebar_direct_channel/index.ts","webpack://mattermost-webapp/./src/components/sidebar/sidebar_channel/sidebar_group_channel/sidebar_group_channel.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_channel/sidebar_group_channel/index.ts","webpack://mattermost-webapp/./src/components/sidebar/sidebar_channel/index.ts","webpack://mattermost-webapp/./src/components/sidebar/sidebar_channel/sidebar_channel.tsx","webpack://mattermost-webapp/./src/components/team_controller/actions/index.ts","webpack://mattermost-webapp/./src/components/channel_layout/channel_identifier_router/actions.ts","webpack://mattermost-webapp/./src/components/common/svg_images_components/channel_intro_private_svg.tsx","webpack://mattermost-webapp/./src/components/common/svg_images_components/channel_intro_public_svg.tsx","webpack://mattermost-webapp/./src/components/common/svg_images_components/channel_intro_town_square_svg.tsx","webpack://mattermost-webapp/./src/components/post_view/channel_intro_message/add_members_button.tsx","webpack://mattermost-webapp/./src/components/post_view/channel_intro_message/pluggable_intro_buttons/pluggable_intro_buttons.tsx","webpack://mattermost-webapp/./src/components/post_view/channel_intro_message/pluggable_intro_buttons/index.ts","webpack://mattermost-webapp/./src/components/post_view/channel_intro_message/channel_intro_message.tsx","webpack://mattermost-webapp/./src/components/post_view/channel_intro_message/index.ts","webpack://mattermost-webapp/./src/components/post_view/post_list_row/post_list_row.tsx","webpack://mattermost-webapp/./src/components/post_view/post_list_row/index.ts","webpack://mattermost-webapp/./src/components/widgets/icons/scroll_to_bottom_icon.tsx","webpack://mattermost-webapp/./src/components/post_view/scroll_to_bottom_arrows.tsx","webpack://mattermost-webapp/./src/components/hint-toast/hint_toast.tsx","webpack://mattermost-webapp/./src/components/scroll_to_bottom_toast/scroll_to_bottom_toast.tsx","webpack://mattermost-webapp/./src/components/scroll_to_bottom_toast/index.tsx","webpack://mattermost-webapp/./src/components/toast_wrapper/toast_wrapper.tsx","webpack://mattermost-webapp/./src/components/toast_wrapper/index.ts","webpack://mattermost-webapp/./src/components/post_view/post_list_virtualized/latest_post_reader.tsx","webpack://mattermost-webapp/./src/components/post_view/post_list_virtualized/post_list_virtualized.tsx","webpack://mattermost-webapp/./src/components/post_view/post_list/post_list.tsx","webpack://mattermost-webapp/./src/components/post_view/post_list/index.tsx","webpack://mattermost-webapp/./src/components/post_view/post_view.tsx","webpack://mattermost-webapp/./src/components/post_view/index.ts","webpack://mattermost-webapp/./src/components/channel_view/input_loading.tsx","webpack://mattermost-webapp/./src/components/channel_view/channel_view.tsx","webpack://mattermost-webapp/./src/components/channel_view/index.ts","webpack://mattermost-webapp/./src/components/channel_layout/channel_identifier_router/channel_identifier_router.tsx","webpack://mattermost-webapp/./src/components/channel_layout/channel_identifier_router/index.ts","webpack://mattermost-webapp/./src/components/channel_layout/center_channel/center_channel.tsx","webpack://mattermost-webapp/./src/components/channel_layout/center_channel/index.ts","webpack://mattermost-webapp/./src/components/query_param_actions/query_param_action_controller.tsx","webpack://mattermost-webapp/./src/components/data_prefetch/actions.ts","webpack://mattermost-webapp/./src/components/data_prefetch/data_prefetch.tsx","webpack://mattermost-webapp/./src/components/data_prefetch/index.ts","webpack://mattermost-webapp/./src/components/resizable_sidebar/resizable_lhs/index.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_header/sidebar_team_menu.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_header/sidebar_header.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_header/index.ts","webpack://mattermost-webapp/./src/components/quick_switch_modal/quick_switch_modal.tsx","webpack://mattermost-webapp/./src/components/quick_switch_modal/index.tsx","webpack://mattermost-webapp/./src/components/sidebar/channel_filter/channel_filter.tsx","webpack://mattermost-webapp/./src/components/sidebar/channel_filter/index.ts","webpack://mattermost-webapp/./src/components/sidebar/channel_navigator/channel_navigator.tsx","webpack://mattermost-webapp/./src/components/sidebar/channel_navigator/index.ts","webpack://mattermost-webapp/./src/components/delete_category_modal/delete_category_modal.tsx","webpack://mattermost-webapp/./src/components/delete_category_modal/index.ts","webpack://mattermost-webapp/./src/components/sidebar/sidebar_category/sidebar_category_menu/index.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_category/sidebar_category_sorting_menu.tsx","webpack://mattermost-webapp/./src/selectors/views/add_channel_dropdown.ts","webpack://mattermost-webapp/./src/components/sidebar/add_channels_cta_button.tsx","webpack://mattermost-webapp/./src/actions/views/add_channel_dropdown.ts","webpack://mattermost-webapp/./src/components/sidebar/invite_members_button.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_category/sidebar_category.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_category/index.ts","webpack://mattermost-webapp/./src/components/sidebar/sidebar_list/sidebar_list.tsx","webpack://mattermost-webapp/./src/components/sidebar/sidebar_list/index.ts","webpack://mattermost-webapp/./src/components/sidebar/sidebar.tsx","webpack://mattermost-webapp/./src/components/sidebar/index.ts","webpack://mattermost-webapp/./src/components/threading/channel_threads/posts_channel_reset_watcher/posts_channel_reset_watcher.tsx","webpack://mattermost-webapp/./src/components/channel_layout/channel_controller.tsx","webpack://mattermost-webapp/./src/components/team_controller/team_controller.tsx","webpack://mattermost-webapp/./src/components/common/hooks/useTelemetryIdentifySync.tsx","webpack://mattermost-webapp/./src/components/team_controller/index.ts","webpack://mattermost-webapp/./src/components/team_groups_manage_modal/team_groups_manage_modal.tsx","webpack://mattermost-webapp/./src/components/team_groups_manage_modal/index.ts","webpack://mattermost-webapp/./src/components/team_members_dropdown/team_members_dropdown.tsx","webpack://mattermost-webapp/./src/components/team_members_dropdown/index.ts","webpack://mattermost-webapp/./src/components/member_list_team/member_list_team.tsx","webpack://mattermost-webapp/./src/components/member_list_team/index.ts","webpack://mattermost-webapp/./src/components/team_members_modal/team_members_modal.tsx","webpack://mattermost-webapp/./src/components/team_members_modal/index.ts","webpack://mattermost-webapp/./src/components/common/select_text_input/select_text_input.tsx","webpack://mattermost-webapp/./src/components/team_settings/team_access_tab/allowed_domains_select.tsx","webpack://mattermost-webapp/./src/components/team_settings/team_access_tab/invite_section_input.tsx","webpack://mattermost-webapp/./src/components/team_settings/team_access_tab/open_invite.tsx","webpack://mattermost-webapp/./src/components/team_settings/team_access_tab/team_access_tab.tsx","webpack://mattermost-webapp/./src/components/team_settings/team_access_tab/index.ts","webpack://mattermost-webapp/./src/components/team_settings/team_info_tab/team_description_section.tsx","webpack://mattermost-webapp/./src/components/team_settings/team_info_tab/team_name_section.tsx","webpack://mattermost-webapp/./src/components/team_settings/team_info_tab/team_picture_section.tsx","webpack://mattermost-webapp/./src/components/team_settings/team_info_tab/team_info_tab.tsx","webpack://mattermost-webapp/./src/components/team_settings/team_info_tab/index.ts","webpack://mattermost-webapp/./src/components/team_settings/team_settings.tsx","webpack://mattermost-webapp/./src/components/team_settings/index.ts","webpack://mattermost-webapp/./src/components/team_settings_modal/team_settings_modal.tsx","webpack://mattermost-webapp/./src/components/team_settings_modal/index.ts","webpack://mattermost-webapp/./src/components/unreads_status_handler/unreads_status_handler.tsx","webpack://mattermost-webapp/./src/components/unreads_status_handler/index.ts","webpack://mattermost-webapp/./src/components/widgets/icons/fa_edit_icon.tsx","webpack://mattermost-webapp/./src/components/widgets/modals/components/save_changes_panel.tsx","webpack://mattermost-webapp/./src/packages/mattermost-redux/src/selectors/entities/channel_bookmarks.ts","webpack://mattermost-webapp/./src/selectors/lhs.ts"],"sourcesContent":["// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {ChannelBookmark, ChannelBookmarkCreate, ChannelBookmarkPatch} from '@mattermost/types/channel_bookmarks';\r\n\r\nimport * as Actions from 'mattermost-redux/actions/channel_bookmarks';\r\n\r\nimport {getConnectionId} from 'selectors/general';\r\n\r\nimport type {ActionFuncAsync} from 'types/store';\r\n\r\nexport function deleteBookmark(channelId: string, id: string): ActionFuncAsync<boolean> {\r\n    return (dispatch, getState) => {\r\n        const state = getState();\r\n        const connectionId = getConnectionId(state);\r\n        return dispatch(Actions.deleteBookmark(channelId, id, connectionId));\r\n    };\r\n}\r\n\r\nexport function createBookmark(channelId: string, bookmark: ChannelBookmarkCreate): ActionFuncAsync<boolean> {\r\n    return (dispatch, getState) => {\r\n        const state = getState();\r\n        const connectionId = getConnectionId(state);\r\n        return dispatch(Actions.createBookmark(channelId, bookmark, connectionId));\r\n    };\r\n}\r\n\r\nexport function editBookmark(channelId: string, id: string, patch: ChannelBookmarkPatch): ActionFuncAsync<boolean> {\r\n    return async (dispatch, getState) => {\r\n        const state = getState();\r\n        const connectionId = getConnectionId(state);\r\n        return dispatch(Actions.editBookmark(channelId, id, patch, connectionId));\r\n    };\r\n}\r\n\r\nexport function reorderBookmark(channelId: string, id: string, newOrder: number): ActionFuncAsync<boolean> {\r\n    return (dispatch, getState) => {\r\n        const state = getState();\r\n        const connectionId = getConnectionId(state);\r\n        return dispatch(Actions.reorderBookmark(channelId, id, newOrder, connectionId));\r\n    };\r\n}\r\n\r\nexport function fetchChannelBookmarks(channelId: string): ActionFuncAsync<ChannelBookmark[]> {\r\n    return Actions.fetchChannelBookmarks(channelId);\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {ChannelBookmark, ChannelBookmarkCreate, ChannelBookmarkPatch} from '@mattermost/types/channel_bookmarks';\r\n\r\nimport {ChannelBookmarkTypes} from 'mattermost-redux/action_types';\r\nimport {Client4} from 'mattermost-redux/client';\r\nimport {getChannelBookmark} from 'mattermost-redux/selectors/entities/channel_bookmarks';\r\nimport type {ActionFuncAsync, DispatchFunc} from 'mattermost-redux/types/actions';\r\n\r\nimport {logError} from './errors';\r\nimport {forceLogoutIfNecessary} from './helpers';\r\n\r\nexport function deleteBookmark(channelId: string, id: string, connectionId: string): ActionFuncAsync<boolean> {\r\n    return async (dispatch, getState) => {\r\n        const state = getState();\r\n        const bookmark = getChannelBookmark(state, channelId, id);\r\n\r\n        try {\r\n            await Client4.deleteChannelBookmark(channelId, id, connectionId);\r\n\r\n            dispatch({\r\n                type: ChannelBookmarkTypes.BOOKMARK_DELETED,\r\n                data: bookmark,\r\n            });\r\n        } catch (error) {\r\n            return {\r\n                data: false,\r\n                error,\r\n            };\r\n        }\r\n\r\n        return {data: true};\r\n    };\r\n}\r\n\r\nexport function createBookmark(channelId: string, bookmark: ChannelBookmarkCreate, connectionId: string): ActionFuncAsync<boolean> {\r\n    return async (dispatch: DispatchFunc) => {\r\n        try {\r\n            const createdBookmark = await Client4.createChannelBookmark(channelId, bookmark, connectionId);\r\n\r\n            dispatch({\r\n                type: ChannelBookmarkTypes.RECEIVED_BOOKMARK,\r\n                data: createdBookmark,\r\n            });\r\n        } catch (error) {\r\n            return {\r\n                data: false,\r\n                error,\r\n            };\r\n        }\r\n\r\n        return {data: true};\r\n    };\r\n}\r\n\r\nexport function editBookmark(channelId: string, id: string, patch: ChannelBookmarkPatch, connectionId: string): ActionFuncAsync<boolean> {\r\n    return async (dispatch: DispatchFunc) => {\r\n        try {\r\n            const {updated, deleted} = await Client4.updateChannelBookmark(channelId, id, patch, connectionId);\r\n\r\n            if (updated) {\r\n                dispatch({\r\n                    type: ChannelBookmarkTypes.RECEIVED_BOOKMARK,\r\n                    data: updated,\r\n                });\r\n            }\r\n\r\n            if (deleted) {\r\n                dispatch({\r\n                    type: ChannelBookmarkTypes.BOOKMARK_DELETED,\r\n                    data: deleted,\r\n                });\r\n            }\r\n        } catch (error) {\r\n            return {\r\n                data: false,\r\n                error,\r\n            };\r\n        }\r\n\r\n        return {data: true};\r\n    };\r\n}\r\n\r\nexport function reorderBookmark(channelId: string, id: string, newOrder: number, connectionId: string): ActionFuncAsync<boolean> {\r\n    return async (dispatch: DispatchFunc) => {\r\n        try {\r\n            const bookmarks = await Client4.updateChannelBookmarkSortOrder(channelId, id, newOrder, connectionId);\r\n\r\n            dispatch({\r\n                type: ChannelBookmarkTypes.RECEIVED_BOOKMARKS,\r\n                data: {channelId, bookmarks},\r\n            });\r\n        } catch (error) {\r\n            return {\r\n                data: false,\r\n                error,\r\n            };\r\n        }\r\n\r\n        return {data: true};\r\n    };\r\n}\r\n\r\nexport function fetchChannelBookmarks(channelId: string): ActionFuncAsync<ChannelBookmark[]> {\r\n    return async (dispatch, getState) => {\r\n        let bookmarks;\r\n        try {\r\n            bookmarks = await Client4.getChannelBookmarks(channelId);\r\n\r\n            dispatch({\r\n                type: ChannelBookmarkTypes.RECEIVED_BOOKMARKS,\r\n                data: {channelId, bookmarks},\r\n            });\r\n        } catch (error) {\r\n            forceLogoutIfNecessary(error, dispatch, getState);\r\n            dispatch(logError(error));\r\n            return {error};\r\n        }\r\n\r\n        return {data: bookmarks};\r\n    };\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {createCategory as createCategoryRedux, moveChannelsToCategory} from 'mattermost-redux/actions/channel_categories';\r\nimport {General} from 'mattermost-redux/constants';\r\nimport {CategoryTypes} from 'mattermost-redux/constants/channel_categories';\r\nimport {getCategory, makeGetChannelIdsForCategory} from 'mattermost-redux/selectors/entities/channel_categories';\r\nimport {getCurrentChannelId} from 'mattermost-redux/selectors/entities/channels';\r\nimport {insertMultipleWithoutDuplicates} from 'mattermost-redux/utils/array_utils';\r\n\r\nimport {getCategoriesForCurrentTeam, getChannelsInCategoryOrder, getDisplayedChannels} from 'selectors/views/channel_sidebar';\r\n\r\nimport {ActionTypes} from 'utils/constants';\r\n\r\nimport type {ActionFunc, ActionFuncAsync, DraggingState, GlobalState} from 'types/store';\r\n\r\nexport function setUnreadFilterEnabled(enabled: boolean) {\r\n    return {\r\n        type: ActionTypes.SET_UNREAD_FILTER_ENABLED,\r\n        enabled,\r\n    };\r\n}\r\n\r\nexport function setDraggingState(data: DraggingState) {\r\n    return {\r\n        type: ActionTypes.SIDEBAR_DRAGGING_SET_STATE,\r\n        data,\r\n    };\r\n}\r\n\r\nexport function stopDragging() {\r\n    return {type: ActionTypes.SIDEBAR_DRAGGING_STOP};\r\n}\r\n\r\nexport function createCategory(teamId: string, displayName: string, channelIds?: string[]): ActionFuncAsync<unknown> {\r\n    return async (dispatch, getState) => {\r\n        if (channelIds) {\r\n            const state = getState();\r\n            const multiSelectedChannelIds = state.views.channelSidebar.multiSelectedChannelIds;\r\n            channelIds.forEach((channelId) => {\r\n                if (multiSelectedChannelIds.indexOf(channelId) >= 0) {\r\n                    dispatch(multiSelectChannelAdd(channelId));\r\n                }\r\n            });\r\n        }\r\n\r\n        const result = await dispatch(createCategoryRedux(teamId, displayName, channelIds));\r\n        return dispatch({\r\n            type: ActionTypes.ADD_NEW_CATEGORY_ID,\r\n            data: result.data!.id,\r\n        });\r\n    };\r\n}\r\n\r\n// addChannelsInSidebar moves channels to a given category without specifying the order in the sidebar, so the channels\r\n// will always go to the first position in the category\r\nexport function addChannelsInSidebar(categoryId: string, channelId: string) {\r\n    return moveChannelsInSidebar(categoryId, 0, channelId, false);\r\n}\r\n\r\n// moveChannelsInSidebar moves channels to a given category in the sidebar, but it accounts for when the target index\r\n// may have changed due to archived channels not being shown in the sidebar.\r\nexport function moveChannelsInSidebar(categoryId: string, targetIndex: number, draggableChannelId: string, setManualSorting = true): ActionFuncAsync<unknown> {\r\n    return (dispatch, getState) => {\r\n        const state = getState();\r\n        const multiSelectedChannelIds = state.views.channelSidebar.multiSelectedChannelIds;\r\n        let channelIds = [];\r\n\r\n        // Multi channel case\r\n        if (multiSelectedChannelIds.length && multiSelectedChannelIds.indexOf(draggableChannelId) !== -1) {\r\n            const categories = getCategoriesForCurrentTeam(state);\r\n            const displayedChannels = getDisplayedChannels(state);\r\n\r\n            let channelsToMove = [draggableChannelId];\r\n\r\n            // Filter out channels that can't go in the category specified\r\n            const targetCategory = categories.find((category) => category.id === categoryId);\r\n            channelsToMove = multiSelectedChannelIds.filter((channelId) => {\r\n                const selectedChannel = displayedChannels.find((channel) => channelId === channel.id);\r\n                const isDMGM = selectedChannel?.type === General.DM_CHANNEL || selectedChannel?.type === General.GM_CHANNEL;\r\n                return targetCategory?.type === CategoryTypes.CUSTOM || targetCategory?.type === CategoryTypes.FAVORITES || (isDMGM && targetCategory?.type === CategoryTypes.DIRECT_MESSAGES) || (!isDMGM && targetCategory?.type !== CategoryTypes.DIRECT_MESSAGES);\r\n            });\r\n\r\n            // Reorder such that the channels move in the order that they appear in the sidebar\r\n            const displayedChannelIds = displayedChannels.map((channel) => channel.id);\r\n            channelsToMove.sort((a, b) => displayedChannelIds.indexOf(a) - displayedChannelIds.indexOf(b));\r\n\r\n            // Remove selection from channels that were moved\r\n            channelsToMove.forEach((channelId) => dispatch(multiSelectChannelAdd(channelId)));\r\n            channelIds = channelsToMove;\r\n        } else {\r\n            channelIds = [draggableChannelId];\r\n        }\r\n\r\n        const newIndex = adjustTargetIndexForMove(state, categoryId, channelIds, targetIndex, draggableChannelId);\r\n        return dispatch(moveChannelsToCategory(categoryId, channelIds, newIndex, setManualSorting));\r\n    };\r\n}\r\n\r\nexport function adjustTargetIndexForMove(state: GlobalState, categoryId: string, channelIds: string[], targetIndex: number, draggableChannelId: string) {\r\n    if (targetIndex === 0) {\r\n        // The channel is being placed first, so there's nothing above that could affect the index\r\n        return 0;\r\n    }\r\n\r\n    const category = getCategory(state, categoryId);\r\n    const filteredChannelIds = makeGetChannelIdsForCategory()(state, category);\r\n\r\n    // When dragging multiple channels, we don't actually remove all of them from the list as react-beautiful-dnd doesn't support that\r\n    // Account for channels removed above the insert point, except the one currently being dragged which is already accounted for by react-beautiful-dnd\r\n    const removedChannelsAboveInsert = filteredChannelIds.filter((channel, index) => channel !== draggableChannelId && channelIds.indexOf(channel) !== -1 && index <= targetIndex);\r\n    const shiftedIndex = targetIndex - removedChannelsAboveInsert.length;\r\n\r\n    if (category.channel_ids.length === filteredChannelIds.length) {\r\n        // There are no archived channels in the category, so the shiftedIndex will be correct\r\n        return shiftedIndex;\r\n    }\r\n\r\n    const updatedChannelIds = insertMultipleWithoutDuplicates(filteredChannelIds, channelIds, shiftedIndex);\r\n\r\n    // After \"moving\" the channel in the sidebar, find what channel comes above it\r\n    const previousChannelId = updatedChannelIds[updatedChannelIds.indexOf(channelIds[0]) - 1];\r\n\r\n    // We want the channel to still be below that channel, so place the new index below it\r\n    let newIndex = category.channel_ids.indexOf(previousChannelId) + 1;\r\n\r\n    // If the channel is moving downwards, then the target index will need to be reduced by one to account for\r\n    // the channel being removed. For example, if we're moving channelA from [channelA, channelB, channelC] to\r\n    // [channelB, channelA, channelC], newIndex would currently be 2 (which comes after channelB), but we need\r\n    // it to be 1 (which comes after channelB once channelA is removed).\r\n    const sourceIndex = category.channel_ids.indexOf(channelIds[0]);\r\n    if (sourceIndex !== -1 && sourceIndex < newIndex) {\r\n        newIndex -= 1;\r\n    }\r\n\r\n    return Math.max(newIndex - removedChannelsAboveInsert.length, 0);\r\n}\r\n\r\nexport function clearChannelSelection(): ActionFunc<unknown> {\r\n    return (dispatch, getState) => {\r\n        const state = getState();\r\n\r\n        if (state.views.channelSidebar.multiSelectedChannelIds.length === 0) {\r\n            // No selection to clear\r\n            return {data: false};\r\n        }\r\n\r\n        dispatch({\r\n            type: ActionTypes.MULTISELECT_CHANNEL_CLEAR,\r\n        });\r\n\r\n        return {data: true};\r\n    };\r\n}\r\n\r\nexport function multiSelectChannelAdd(channelId: string): ActionFunc<unknown> {\r\n    return (dispatch, getState) => {\r\n        const state = getState();\r\n        const multiSelectedChannelIds = state.views.channelSidebar.multiSelectedChannelIds;\r\n\r\n        // Nothing already selected, so we include the active channel\r\n        if (!multiSelectedChannelIds.length) {\r\n            const currentChannel = getCurrentChannelId(state);\r\n            dispatch({\r\n                type: ActionTypes.MULTISELECT_CHANNEL,\r\n                data: currentChannel,\r\n            });\r\n        }\r\n\r\n        return dispatch({\r\n            type: ActionTypes.MULTISELECT_CHANNEL_ADD,\r\n            data: channelId,\r\n        });\r\n    };\r\n}\r\n\r\n// Much of this logic was pulled from the react-beautiful-dnd sample multiselect implementation\r\n// Found here: https://github.com/atlassian/react-beautiful-dnd/tree/master/stories/src/multi-drag\r\nexport function multiSelectChannelTo(channelId: string): ActionFunc<unknown> {\r\n    return (dispatch, getState) => {\r\n        const state = getState();\r\n        const multiSelectedChannelIds = state.views.channelSidebar.multiSelectedChannelIds;\r\n        let lastSelected = state.views.channelSidebar.lastSelectedChannel;\r\n\r\n        // Nothing already selected, so start with the active channel\r\n        if (!multiSelectedChannelIds.length) {\r\n            const currentChannel = getCurrentChannelId(state);\r\n            dispatch({\r\n                type: ActionTypes.MULTISELECT_CHANNEL,\r\n                data: currentChannel,\r\n            });\r\n            lastSelected = currentChannel;\r\n        }\r\n\r\n        const allChannelsIdsInOrder = getChannelsInCategoryOrder(state).map((channel) => channel.id);\r\n        const indexOfNew: number = allChannelsIdsInOrder.indexOf(channelId);\r\n        const indexOfLast: number = allChannelsIdsInOrder.indexOf(lastSelected);\r\n\r\n        // multi selecting in the same column\r\n        // need to select everything between the last index and the current index inclusive\r\n\r\n        // nothing to do here\r\n        if (indexOfNew === indexOfLast) {\r\n            return {data: false};\r\n        }\r\n\r\n        const start: number = Math.min(indexOfLast, indexOfNew);\r\n        const end: number = Math.max(indexOfLast, indexOfNew);\r\n\r\n        const inBetween = allChannelsIdsInOrder.slice(start, end + 1);\r\n\r\n        // everything inbetween needs to have it's selection toggled.\r\n        // with the exception of the start and end values which will always be selected\r\n\r\n        return dispatch({\r\n            type: ActionTypes.MULTISELECT_CHANNEL_TO,\r\n            data: inBetween,\r\n        });\r\n    };\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\nimport {FormattedMessage, defineMessages, injectIntl, type WrappedComponentProps} from 'react-intl';\r\n\r\nimport {ArchiveOutlineIcon, CheckIcon, ChevronDownIcon, GlobeIcon, LockOutlineIcon, AccountOutlineIcon, GlobeCheckedIcon} from '@mattermost/compass-icons/components';\r\nimport type {Channel, ChannelMembership} from '@mattermost/types/channels';\r\nimport type {RelationOneToOne} from '@mattermost/types/utilities';\r\n\r\nimport {isPrivateChannel} from 'mattermost-redux/utils/channel_utils';\r\n\r\nimport MagnifyingGlassSVG from 'components/common/svg_images_components/magnifying_glass_svg';\r\nimport LoadingScreen from 'components/loading_screen';\r\nimport * as Menu from 'components/menu';\r\nimport QuickInput from 'components/quick_input';\r\nimport SharedChannelIndicator from 'components/shared_channel_indicator';\r\nimport CheckboxCheckedIcon from 'components/widgets/icons/checkbox_checked_icon';\r\nimport LoadingWrapper from 'components/widgets/loading/loading_wrapper';\r\n\r\nimport {isArchivedChannel} from 'utils/channel_utils';\r\nimport Constants, {ModalIdentifiers} from 'utils/constants';\r\nimport {isKeyPressed} from 'utils/keyboard';\r\nimport * as UserAgent from 'utils/user_agent';\r\n\r\nimport type {FilterType} from './browse_channels/browse_channels';\r\nimport {Filter} from './browse_channels/browse_channels';\r\n\r\nconst NEXT_BUTTON_TIMEOUT_MILLISECONDS = 500;\r\n\r\ninterface Props extends WrappedComponentProps {\r\n    channels: Channel[];\r\n    channelsPerPage: number;\r\n    nextPage: (page: number) => void;\r\n    isSearch: boolean;\r\n    search: (term: string) => void;\r\n    handleJoin: (channel: Channel, done: () => void) => void;\r\n    noResultsText: JSX.Element;\r\n    changeFilter: (filter: FilterType) => void;\r\n    filter: FilterType;\r\n    myChannelMemberships: RelationOneToOne<Channel, ChannelMembership>;\r\n    closeModal: (modalId: string) => void;\r\n    hideJoinedChannelsPreference: (shouldHideJoinedChannels: boolean) => void;\r\n    rememberHideJoinedChannelsChecked: boolean;\r\n    loading?: boolean;\r\n    channelsMemberCount?: Record<string, number>;\r\n}\r\n\r\ntype State = {\r\n    joiningChannel: string;\r\n    page: number;\r\n    nextDisabled: boolean;\r\n    channelSearchValue: string;\r\n    isSearch?: boolean;\r\n}\r\n\r\nexport class SearchableChannelList extends React.PureComponent<Props, State> {\r\n    private nextTimeoutId: number | NodeJS.Timeout;\r\n    private filter: React.RefObject<HTMLInputElement>;\r\n    private channelListScroll: React.RefObject<HTMLDivElement>;\r\n\r\n    static getDerivedStateFromProps(props: Props, state: State) {\r\n        return {isSearch: props.isSearch, page: props.isSearch && !state.isSearch ? 0 : state.page};\r\n    }\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.nextTimeoutId = 0;\r\n\r\n        this.state = {\r\n            joiningChannel: '',\r\n            page: 0,\r\n            nextDisabled: false,\r\n            channelSearchValue: '',\r\n        };\r\n\r\n        this.filter = React.createRef();\r\n        this.channelListScroll = React.createRef();\r\n    }\r\n\r\n    componentDidMount() {\r\n        // only focus the search box on desktop so that we don't cause the keyboard to open on mobile\r\n        if (!UserAgent.isMobile() && this.filter.current) {\r\n            this.filter.current.focus();\r\n        }\r\n        document.addEventListener('keydown', this.onKeyDown);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        document.removeEventListener('keydown', this.onKeyDown);\r\n    }\r\n\r\n    onKeyDown = (e: KeyboardEvent) => {\r\n        const target = e.target as HTMLElement;\r\n        const isEnterKeyPressed = isKeyPressed(e, Constants.KeyCodes.ENTER);\r\n        if (isEnterKeyPressed && (e.shiftKey || e.ctrlKey || e.altKey)) {\r\n            return;\r\n        }\r\n        if (isEnterKeyPressed && target?.classList.contains('more-modal__row')) {\r\n            target.click();\r\n        }\r\n    };\r\n\r\n    handleJoin = (channel: Channel, e: React.MouseEvent) => {\r\n        e.stopPropagation();\r\n        this.setState({joiningChannel: channel.id});\r\n        this.props.handleJoin(\r\n            channel,\r\n            () => {\r\n                this.setState({joiningChannel: ''});\r\n            },\r\n        );\r\n        if (this.isMemberOfChannel(channel.id)) {\r\n            this.props.closeModal(ModalIdentifiers.MORE_CHANNELS);\r\n        }\r\n    };\r\n\r\n    isMemberOfChannel(channelId: string) {\r\n        return this.props.myChannelMemberships[channelId];\r\n    }\r\n\r\n    createChannelRow = (channel: Channel) => {\r\n        const ariaLabel = `${channel.display_name}, ${channel.purpose}`.toLowerCase();\r\n        let channelTypeIcon;\r\n\r\n        if (isArchivedChannel(channel)) {\r\n            channelTypeIcon = <ArchiveOutlineIcon size={18}/>;\r\n        } else if (isPrivateChannel(channel)) {\r\n            channelTypeIcon = <LockOutlineIcon size={18}/>;\r\n        } else {\r\n            channelTypeIcon = <GlobeIcon size={18}/>;\r\n        }\r\n        let memberCount = 0;\r\n        if (this.props.channelsMemberCount?.[channel.id]) {\r\n            memberCount = this.props.channelsMemberCount[channel.id];\r\n        }\r\n\r\n        const membershipIndicator = this.isMemberOfChannel(channel.id) ? (\r\n            <div\r\n                id='membershipIndicatorContainer'\r\n                aria-label={this.props.intl.formatMessage({id: 'more_channels.membership_indicator', defaultMessage: 'Membership Indicator: Joined'})}\r\n            >\r\n                <CheckIcon size={14}/>\r\n                <FormattedMessage\r\n                    id={'more_channels.joined'}\r\n                    defaultMessage={'Joined'}\r\n                />\r\n            </div>\r\n        ) : null;\r\n\r\n        const channelPurposeContainerAriaLabel = this.props.intl.formatMessage(\r\n            messages.channelPurpose,\r\n            {memberCount, channelPurpose: channel.purpose || ''},\r\n        );\r\n\r\n        const channelPurposeContainer = (\r\n            <div\r\n                id='channelPurposeContainer'\r\n                aria-label={channelPurposeContainerAriaLabel}\r\n            >\r\n                {membershipIndicator}\r\n                {membershipIndicator ? <span className='dot'/> : null}\r\n                <AccountOutlineIcon size={14}/>\r\n                <span data-testid={`channelMemberCount-${channel.name}`} >{memberCount}</span>\r\n                {channel.purpose.length > 0 ? <span className='dot'/> : null}\r\n                <span className='more-modal__description'>{channel.purpose}</span>\r\n            </div>\r\n        );\r\n\r\n        const joinViewChannelButtonClass = classNames('btn btn-sm', {\r\n            'btn-secondary outlineButton': this.isMemberOfChannel(channel.id),\r\n            'btn-primary primaryButton': !this.isMemberOfChannel(channel.id),\r\n        });\r\n\r\n        const joinViewChannelButton = (\r\n            <button\r\n                id='joinViewChannelButton'\r\n                onClick={(e) => this.handleJoin(channel, e)}\r\n                className={joinViewChannelButtonClass}\r\n                disabled={Boolean(this.state.joiningChannel)}\r\n                tabIndex={-1}\r\n                aria-label={this.isMemberOfChannel(channel.id) ? this.props.intl.formatMessage({id: 'more_channels.view', defaultMessage: 'View'}) : this.props.intl.formatMessage({id: 'joinChannel.JoinButton', defaultMessage: 'Join'})}\r\n            >\r\n                <LoadingWrapper\r\n                    loading={this.state.joiningChannel === channel.id}\r\n                    text={messages.joiningButton}\r\n                >\r\n                    <FormattedMessage\r\n                        id={this.isMemberOfChannel(channel.id) ? 'more_channels.view' : 'joinChannel.JoinButton'}\r\n                        defaultMessage={this.isMemberOfChannel(channel.id) ? 'View' : 'Join'}\r\n                    />\r\n                </LoadingWrapper>\r\n            </button>\r\n        );\r\n\r\n        const sharedChannelIcon = channel.shared ? (\r\n            <SharedChannelIndicator\r\n                className='shared-channel-icon'\r\n                withTooltip={true}\r\n            />\r\n        ) : null;\r\n\r\n        return (\r\n            <div\r\n                className='more-modal__row'\r\n                key={channel.id}\r\n                id={`ChannelRow-${channel.name}`}\r\n                data-testid={`ChannelRow-${channel.name}`}\r\n                aria-label={ariaLabel}\r\n                onClick={(e) => this.handleJoin(channel, e)}\r\n                tabIndex={0}\r\n            >\r\n                <div className='more-modal__details'>\r\n                    <div className='style--none more-modal__name'>\r\n                        {channelTypeIcon}\r\n                        <span id='channelName'>{channel.display_name}</span>\r\n                        {sharedChannelIcon}\r\n                    </div>\r\n                    {channelPurposeContainer}\r\n                </div>\r\n                <div className='more-modal__actions'>\r\n                    {joinViewChannelButton}\r\n                    {this.state.joiningChannel === channel.id && !this.isMemberOfChannel(channel.id) && (\r\n                        <span\r\n                            className='sr-only'\r\n                            role='alert'\r\n                        >\r\n                            <FormattedMessage\r\n                                id='more_channels.joinedChannel'\r\n                                defaultMessage='Joined channel {channelName}'\r\n                                values={{\r\n                                    channelName: channel.display_name,\r\n                                }}\r\n                            />\r\n                        </span>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        );\r\n    };\r\n\r\n    nextPage = (e: React.MouseEvent) => {\r\n        e.preventDefault();\r\n        this.setState({page: this.state.page + 1, nextDisabled: true});\r\n        this.nextTimeoutId = setTimeout(() => this.setState({nextDisabled: false}), NEXT_BUTTON_TIMEOUT_MILLISECONDS);\r\n        this.props.nextPage(this.state.page + 1);\r\n        this.channelListScroll.current?.scrollTo({top: 0});\r\n    };\r\n\r\n    previousPage = (e: React.MouseEvent) => {\r\n        e.preventDefault();\r\n        this.setState({page: this.state.page - 1});\r\n        this.channelListScroll.current?.scrollTo({top: 0});\r\n    };\r\n\r\n    doSearch = () => {\r\n        this.props.search(this.state.channelSearchValue);\r\n        if (this.state.channelSearchValue === '') {\r\n            this.setState({page: 0});\r\n        }\r\n    };\r\n    filterChange = (filterType: FilterType) => {\r\n        this.props.changeFilter(filterType);\r\n        if (this.props.filter !== filterType) {\r\n            this.setState({page: 0});\r\n        }\r\n    };\r\n    handleChange = (e?: React.FormEvent<HTMLInputElement>) => {\r\n        if (e?.currentTarget) {\r\n            this.setState({channelSearchValue: e?.currentTarget.value}, () => this.doSearch());\r\n        }\r\n    };\r\n    handleClear = () => {\r\n        this.setState({channelSearchValue: ''}, () => this.doSearch());\r\n    };\r\n    handleChecked = () => {\r\n        // If it was checked, and now we're unchecking it, clear the preference\r\n        if (this.props.rememberHideJoinedChannelsChecked) {\r\n            this.props.hideJoinedChannelsPreference(false);\r\n        } else {\r\n            this.props.hideJoinedChannelsPreference(true);\r\n        }\r\n    };\r\n    getEmptyStateMessage = () => {\r\n        if (this.state.channelSearchValue.length > 0) {\r\n            return (\r\n                <FormattedMessage\r\n                    id='more_channels.noMore'\r\n                    tagName='strong'\r\n                    defaultMessage='No results for {text}'\r\n                    values={{text: this.state.channelSearchValue}}\r\n                />\r\n            );\r\n        }\r\n        switch (this.props.filter) {\r\n        case Filter.Archived:\r\n            return (\r\n                <FormattedMessage\r\n                    id={'more_channels.noArchived'}\r\n                    tagName='strong'\r\n                    defaultMessage={'No archived channels'}\r\n                />\r\n            );\r\n        case Filter.Private:\r\n            return (\r\n                <FormattedMessage\r\n                    id={'more_channels.noPrivate'}\r\n                    tagName='strong'\r\n                    defaultMessage={'No private channels'}\r\n                />\r\n            );\r\n        case Filter.Public:\r\n            return (\r\n                <FormattedMessage\r\n                    id={'more_channels.noPublic'}\r\n                    tagName='strong'\r\n                    defaultMessage={'No public channels'}\r\n                />\r\n            );\r\n        default:\r\n            return (\r\n                <FormattedMessage\r\n                    id={'more_channels.noChannels'}\r\n                    tagName='strong'\r\n                    defaultMessage={'No channels'}\r\n                />\r\n            );\r\n        }\r\n    };\r\n    getFilterLabel = () => {\r\n        switch (this.props.filter) {\r\n        case Filter.Archived:\r\n            return (\r\n                <FormattedMessage\r\n                    id='more_channels.show_archived_channels'\r\n                    defaultMessage='Channel Type: Archived'\r\n                />\r\n            );\r\n        case Filter.Public:\r\n            return (\r\n                <FormattedMessage\r\n                    id='more_channels.show_public_channels'\r\n                    defaultMessage='Channel Type: Public'\r\n                />\r\n            );\r\n        case Filter.Private:\r\n            return (\r\n                <FormattedMessage\r\n                    id='more_channels.show_private_channels'\r\n                    defaultMessage='Channel Type: Private'\r\n                />\r\n            );\r\n        default:\r\n            return (\r\n                <FormattedMessage\r\n                    id='more_channels.show_all_channels'\r\n                    defaultMessage='Channel Type: All'\r\n                />\r\n            );\r\n        }\r\n    };\r\n\r\n    render() {\r\n        const channels = this.props.channels;\r\n        let listContent;\r\n        let nextButton;\r\n        let previousButton;\r\n\r\n        if (this.props.loading && channels.length === 0) {\r\n            listContent = <LoadingScreen/>;\r\n        } else if (channels.length === 0) {\r\n            listContent = (\r\n                <div\r\n                    className='no-channel-message'\r\n                    aria-label={this.state.channelSearchValue.length > 0 ? this.props.intl.formatMessage(messages.noMore, {text: this.state.channelSearchValue}) : this.props.intl.formatMessage({id: 'widgets.channels_input.empty', defaultMessage: 'No channels found'})\r\n                    }\r\n                >\r\n                    <MagnifyingGlassSVG/>\r\n                    <h3 className='primary-message'>\r\n                        {this.getEmptyStateMessage()}\r\n                    </h3>\r\n                    {this.props.noResultsText}\r\n                </div>\r\n            );\r\n        } else {\r\n            const pageStart = this.state.page * this.props.channelsPerPage;\r\n            const pageEnd = pageStart + this.props.channelsPerPage;\r\n            const channelsToDisplay = this.props.channels.slice(pageStart, pageEnd);\r\n            listContent = channelsToDisplay.map(this.createChannelRow);\r\n\r\n            if (channelsToDisplay.length >= this.props.channelsPerPage && pageEnd < this.props.channels.length) {\r\n                nextButton = (\r\n                    <button\r\n                        className='btn btn-sm btn-tertiary filter-control filter-control__next'\r\n                        onClick={this.nextPage}\r\n                        disabled={this.state.nextDisabled}\r\n                        aria-label={this.props.intl.formatMessage({id: 'more_channels.next', defaultMessage: 'Next'})}\r\n                    >\r\n                        <FormattedMessage\r\n                            id='more_channels.next'\r\n                            defaultMessage='Next'\r\n                        />\r\n                    </button>\r\n                );\r\n            }\r\n\r\n            if (this.state.page > 0) {\r\n                previousButton = (\r\n                    <button\r\n                        className='btn btn-sm btn-tertiary filter-control filter-control__prev'\r\n                        onClick={this.previousPage}\r\n                        aria-label={this.props.intl.formatMessage({id: 'more_channels.prev', defaultMessage: 'Previous'})}\r\n                    >\r\n                        <FormattedMessage\r\n                            id='more_channels.prev'\r\n                            defaultMessage='Previous'\r\n                        />\r\n                    </button>\r\n                );\r\n            }\r\n        }\r\n\r\n        const input = (\r\n            <div className='filter-row'>\r\n                <span\r\n                    id='searchIcon'\r\n                    aria-hidden='true'\r\n                >\r\n                    <i className='icon icon-magnify'/>\r\n                </span>\r\n                <QuickInput\r\n                    id='searchChannelsTextbox'\r\n                    ref={this.filter}\r\n                    className='form-control filter-textbox'\r\n                    placeholder={this.props.intl.formatMessage({id: 'filtered_channels_list.search', defaultMessage: 'Search channels'})}\r\n                    onInput={this.handleChange}\r\n                    clearable={true}\r\n                    onClear={this.handleClear}\r\n                    value={this.state.channelSearchValue}\r\n                    aria-label={this.props.intl.formatMessage({id: 'filtered_channels_list.search', defaultMessage: 'Search Channels'})}\r\n                />\r\n            </div>\r\n        );\r\n\r\n        const checkIcon = (\r\n            <CheckIcon\r\n                size={18}\r\n                color={'var(--button-bg)'}\r\n            />\r\n        );\r\n        const channelDropdownItems = [\r\n            <Menu.Item\r\n                key='channelsMoreDropdownAll'\r\n                id='channelsMoreDropdownAll'\r\n                onClick={() => this.filterChange(Filter.All)}\r\n                leadingElement={<GlobeCheckedIcon size={16}/>}\r\n                labels={\r\n                    <FormattedMessage\r\n                        id='suggestion.all'\r\n                        defaultMessage='All channel types'\r\n                    />\r\n                }\r\n                trailingElements={this.props.filter === Filter.All ? checkIcon : null}\r\n                aria-label={this.props.intl.formatMessage({id: 'suggestion.all', defaultMessage: 'All channel types'})}\r\n            />,\r\n            <Menu.Item\r\n                key='channelsMoreDropdownPublic'\r\n                id='channelsMoreDropdownPublic'\r\n                onClick={() => this.filterChange(Filter.Public)}\r\n                leadingElement={<GlobeIcon size={16}/>}\r\n                labels={\r\n                    <FormattedMessage\r\n                        id='suggestion.public'\r\n                        defaultMessage='Public channels'\r\n                    />\r\n                }\r\n                trailingElements={this.props.filter === Filter.Public ? checkIcon : null}\r\n                aria-label={this.props.intl.formatMessage({id: 'suggestion.public', defaultMessage: 'Public channels'})}\r\n            />,\r\n            <Menu.Item\r\n                key='channelsMoreDropdownPrivate'\r\n                id='channelsMoreDropdownPrivate'\r\n                onClick={() => this.filterChange(Filter.Private)}\r\n                leadingElement={<LockOutlineIcon size={16}/>}\r\n                labels={\r\n                    <FormattedMessage\r\n                        id='suggestion.private'\r\n                        defaultMessage='Private channels'\r\n                    />\r\n                }\r\n                trailingElements={this.props.filter === Filter.Private ? checkIcon : null}\r\n                aria-label={this.props.intl.formatMessage({id: 'suggestion.private', defaultMessage: 'Private channels'})}\r\n            />,\r\n        ];\r\n\r\n        channelDropdownItems.push(\r\n            <Menu.Separator key='channelsMoreDropdownSeparator'/>,\r\n            <Menu.Item\r\n                key='channelsMoreDropdownArchived'\r\n                id='channelsMoreDropdownArchived'\r\n                onClick={() => this.filterChange(Filter.Archived)}\r\n                leadingElement={<ArchiveOutlineIcon size={16}/>}\r\n                labels={\r\n                    <FormattedMessage\r\n                        id='suggestion.archive'\r\n                        defaultMessage='Archived channels'\r\n                    />\r\n                }\r\n                trailingElements={this.props.filter === Filter.Archived ? checkIcon : null}\r\n                aria-label={this.props.intl.formatMessage({id: 'suggestion.archive', defaultMessage: 'Archived channels'})}\r\n            />,\r\n        );\r\n        const menuButton = (\r\n            <>\r\n                {this.getFilterLabel()}\r\n                <ChevronDownIcon\r\n                    color={'rgba(var(--center-channel-color-rgb), 0.64)'}\r\n                    size={16}\r\n                />\r\n            </>\r\n        );\r\n        const channelDropdown = (\r\n            <>\r\n                <div\r\n                    role='status'\r\n                    aria-atomic='true'\r\n                    className='sr-only'\r\n                >\r\n                    {this.props.intl.formatMessage({\r\n                        id: 'more_channels.channel_type_filter.filter_type_set',\r\n                        defaultMessage: 'Channel type filter set to {filterType}',\r\n                    }, {\r\n                        filterType: this.props.filter,\r\n                    })}\r\n                </div>\r\n                <Menu.Container\r\n                    menuButton={{\r\n                        id: 'menuWrapper',\r\n                        children: menuButton,\r\n                        'aria-label': this.props.intl.formatMessage({id: 'more_channels.channel_type_filter', defaultMessage: 'Channel type filter'}),\r\n                    }}\r\n                    menu={{\r\n                        id: 'browseChannelsDropdown',\r\n                        'aria-label': this.props.intl.formatMessage({id: 'more_channels.channel_type_filter', defaultMessage: 'Channel type filter'}),\r\n                    }}\r\n                >\r\n                    {channelDropdownItems.map((item) => item)}\r\n                </Menu.Container>\r\n            </>\r\n        );\r\n\r\n        const hideJoinedButtonClass = classNames('get-app__checkbox', {checked: this.props.rememberHideJoinedChannelsChecked});\r\n        const hideJoinedPreferenceCheckbox = (\r\n            <div\r\n                id={'hideJoinedPreferenceCheckbox'}\r\n                onClick={this.handleChecked}\r\n                onKeyDown={(e) => {\r\n                    e.stopPropagation();\r\n                    if (e.key === 'Enter' || e.key === ' ') {\r\n                        this.handleChecked();\r\n                    }\r\n                }}\r\n                role='checkbox'\r\n                aria-checked={this.props.rememberHideJoinedChannelsChecked}\r\n                aria-label={this.props.intl.formatMessage({id: 'more_channels.hide_joined_channels', defaultMessage: 'Hide joined channels'})}\r\n                tabIndex={0}\r\n            >\r\n                <div className={hideJoinedButtonClass}>\r\n                    {this.props.rememberHideJoinedChannelsChecked ? <CheckboxCheckedIcon/> : null}\r\n                </div>\r\n                <FormattedMessage\r\n                    id='more_channels.hide_joined'\r\n                    defaultMessage='Hide Joined'\r\n                />\r\n            </div>\r\n        );\r\n\r\n        let channelCountLabel;\r\n        if (channels.length === 0) {\r\n            channelCountLabel = this.props.intl.formatMessage({id: 'more_channels.count_zero', defaultMessage: '0 Results'});\r\n        } else if (channels.length === 1) {\r\n            channelCountLabel = this.props.intl.formatMessage({id: 'more_channels.count_one', defaultMessage: '1 Result'});\r\n        } else if (channels.length > 1) {\r\n            channelCountLabel = this.props.intl.formatMessage(messages.channelCount, {count: channels.length});\r\n        } else {\r\n            channelCountLabel = this.props.intl.formatMessage({id: 'more_channels.count_zero', defaultMessage: '0 Results'});\r\n        }\r\n\r\n        const dropDownContainer = (\r\n            <div className='more-modal__dropdown'>\r\n                <span id='channelCountLabel'>{channelCountLabel}</span>\r\n                <span\r\n                    className='sr-only'\r\n                    role='status'\r\n                    aria-live='polite'\r\n                >\r\n                    {channelCountLabel}\r\n                </span>\r\n                <div id='modalPreferenceContainer'>\r\n                    {channelDropdown}\r\n                    {hideJoinedPreferenceCheckbox}\r\n                </div>\r\n            </div>\r\n        );\r\n\r\n        return (\r\n            <div className='filtered-user-list'>\r\n                {input}\r\n                {dropDownContainer}\r\n                <div\r\n                    role='search'\r\n                    className='more-modal__list'\r\n                    tabIndex={-1}\r\n                >\r\n                    <div\r\n                        id='moreChannelsList'\r\n                        tabIndex={-1}\r\n                        ref={this.channelListScroll}\r\n                    >\r\n                        {listContent}\r\n                    </div>\r\n                </div>\r\n                <div className='filter-controls'>\r\n                    {previousButton}\r\n                    {nextButton}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nconst messages = defineMessages({\r\n    channelCount: {\r\n        id: 'more_channels.count',\r\n        defaultMessage: '{count} Results',\r\n    },\r\n    channelPurpose: {\r\n        id: 'more_channels.channel_purpose',\r\n        defaultMessage: 'Channel Information: Membership Indicator: Joined, Member count {memberCount} , Purpose: {channelPurpose}',\r\n    },\r\n    joiningButton: {\r\n        id: 'joinChannel.joiningButton',\r\n        defaultMessage: 'Joining...',\r\n    },\r\n    noMore: {\r\n        id: 'more_channels.noMore',\r\n        defaultMessage: 'No results for {text}',\r\n    },\r\n});\r\n\r\nexport default injectIntl(SearchableChannelList);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport {GenericModal} from '@mattermost/components';\r\nimport type {Channel, ChannelMembership, ChannelSearchOpts, ChannelsWithTotalCount} from '@mattermost/types/channels';\r\nimport type {RelationOneToOne} from '@mattermost/types/utilities';\r\n\r\nimport Permissions from 'mattermost-redux/constants/permissions';\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport LoadingScreen from 'components/loading_screen';\r\nimport NewChannelModal from 'components/new_channel_modal/new_channel_modal';\r\nimport TeamPermissionGate from 'components/permissions_gates/team_permission_gate';\r\nimport SearchableChannelList from 'components/searchable_channel_list';\r\n\r\nimport {getHistory} from 'utils/browser_history';\r\nimport Constants, {ModalIdentifiers, RHSStates, StoragePrefixes} from 'utils/constants';\r\nimport {getRelativeChannelURL} from 'utils/url';\r\nimport {localizeMessage} from 'utils/utils';\r\n\r\nimport type {ModalData} from 'types/actions';\r\nimport type {RhsState} from 'types/store/rhs';\r\n\r\nimport './browse_channels.scss';\r\n\r\nconst CHANNELS_CHUNK_SIZE = 50;\r\nconst CHANNELS_PER_PAGE = 50;\r\nconst SEARCH_TIMEOUT_MILLISECONDS = 100;\r\nexport enum Filter {\r\n    All = 'All',\r\n    Public = 'Public',\r\n    Private = 'Private',\r\n    Archived = 'Archived',\r\n}\r\n\r\nexport type FilterType = keyof typeof Filter;\r\n\r\ntype Actions = {\r\n    getChannels: (teamId: string, page: number, perPage: number) => Promise<ActionResult<Channel[]>>;\r\n    getArchivedChannels: (teamId: string, page: number, channelsPerPage: number) => Promise<ActionResult<Channel[]>>;\r\n    joinChannel: (currentUserId: string, teamId: string, channelId: string) => Promise<ActionResult>;\r\n    searchAllChannels: (term: string, opts?: ChannelSearchOpts) => Promise<ActionResult<Channel[] | ChannelsWithTotalCount>>;\r\n    openModal: <P>(modalData: ModalData<P>) => void;\r\n    closeModal: (modalId: string) => void;\r\n\r\n    /*\r\n     * Function to set a key-value pair in the local storage\r\n     */\r\n    setGlobalItem: (name: string, value: string) => void;\r\n    closeRightHandSide: () => void;\r\n    getChannelsMemberCount: (channelIds: string[]) => Promise<ActionResult>;\r\n}\r\n\r\nexport type Props = {\r\n    channels: Channel[];\r\n    archivedChannels: Channel[];\r\n    privateChannels: Channel[];\r\n    currentUserId: string;\r\n    teamId: string;\r\n    teamName?: string;\r\n    channelsRequestStarted?: boolean;\r\n    myChannelMemberships: RelationOneToOne<Channel, ChannelMembership>;\r\n    shouldHideJoinedChannels: boolean;\r\n    rhsState?: RhsState;\r\n    rhsOpen?: boolean;\r\n    channelsMemberCount?: Record<string, number>;\r\n    actions: Actions;\r\n}\r\n\r\ntype State = {\r\n    loading: boolean;\r\n    filter: FilterType;\r\n    search: boolean;\r\n    searchedChannels: Channel[];\r\n    serverError: React.ReactNode | string;\r\n    searching: boolean;\r\n    searchTerm: string;\r\n}\r\n\r\nexport default class BrowseChannels extends React.PureComponent<Props, State> {\r\n    public searchTimeoutId: number;\r\n    activeChannels: Channel[] = [];\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.searchTimeoutId = 0;\r\n\r\n        this.state = {\r\n            loading: true,\r\n            filter: Filter.All,\r\n            search: false,\r\n            searchedChannels: [],\r\n            serverError: null,\r\n            searching: false,\r\n            searchTerm: '',\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (!this.props.teamId) {\r\n            this.loadComplete();\r\n            return;\r\n        }\r\n\r\n        const promises = [\r\n            this.props.actions.getChannels(this.props.teamId, 0, CHANNELS_CHUNK_SIZE * 2),\r\n            this.props.actions.getArchivedChannels(this.props.teamId, 0, CHANNELS_CHUNK_SIZE * 2),\r\n        ];\r\n\r\n        Promise.all(promises).then((results) => {\r\n            const channelIDsForMemberCount = results.flatMap((result) => {\r\n                return result.data ? result.data.map((channel) => channel.id) : [];\r\n            },\r\n            );\r\n            this.props.privateChannels.forEach((channel) => channelIDsForMemberCount.push(channel.id));\r\n            if (channelIDsForMemberCount.length > 0) {\r\n                this.props.actions.getChannelsMemberCount(channelIDsForMemberCount);\r\n            }\r\n        });\r\n        this.loadComplete();\r\n    }\r\n\r\n    loadComplete = () => {\r\n        this.setState({loading: false});\r\n    };\r\n\r\n    handleNewChannel = () => {\r\n        this.handleExit();\r\n        this.closeEditRHS();\r\n        this.props.actions.openModal({\r\n            modalId: ModalIdentifiers.NEW_CHANNEL_MODAL,\r\n            dialogType: NewChannelModal,\r\n        });\r\n    };\r\n\r\n    handleExit = () => {\r\n        this.props.actions.closeModal(ModalIdentifiers.MORE_CHANNELS);\r\n    };\r\n\r\n    closeEditRHS = () => {\r\n        if (this.props.rhsOpen && this.props.rhsState === RHSStates.EDIT_HISTORY) {\r\n            this.props.actions.closeRightHandSide();\r\n        }\r\n    };\r\n\r\n    onChange = (force: boolean) => {\r\n        if (this.state.search && !force) {\r\n            return;\r\n        }\r\n\r\n        this.setState({\r\n            searchedChannels: [],\r\n            serverError: null,\r\n        });\r\n    };\r\n\r\n    nextPage = (page: number) => {\r\n        this.props.actions.getChannels(this.props.teamId, page + 1, CHANNELS_PER_PAGE).then((result) => {\r\n            if (result.data && result.data.length > 0) {\r\n                this.props.actions.getChannelsMemberCount(result.data.map((channel) => channel.id));\r\n            }\r\n        });\r\n    };\r\n\r\n    handleJoin = async (channel: Channel, done: () => void) => {\r\n        const {actions, currentUserId, teamId, teamName} = this.props;\r\n        let result;\r\n\r\n        if (!this.isMemberOfChannel(channel.id)) {\r\n            result = await actions.joinChannel(currentUserId, teamId, channel.id);\r\n        }\r\n\r\n        if (result?.error) {\r\n            this.setState({serverError: result.error.message});\r\n        } else {\r\n            this.props.actions.getChannelsMemberCount([channel.id]);\r\n            getHistory().push(getRelativeChannelURL(teamName!, channel.name));\r\n            this.closeEditRHS();\r\n        }\r\n\r\n        if (done) {\r\n            done();\r\n        }\r\n    };\r\n\r\n    search = (term: string) => {\r\n        clearTimeout(this.searchTimeoutId);\r\n\r\n        if (term === '') {\r\n            this.onChange(true);\r\n            this.setState({search: false, searchedChannels: [], searching: false, searchTerm: term});\r\n            this.searchTimeoutId = 0;\r\n            return;\r\n        }\r\n        this.setState({search: true, searching: true, searchTerm: term});\r\n\r\n        const searchTimeoutId = window.setTimeout(\r\n            async () => {\r\n                try {\r\n                    const {data} = await this.props.actions.searchAllChannels(term, {team_ids: [this.props.teamId], nonAdminSearch: true, include_deleted: true}) as ActionResult<Channel[]>;\r\n                    if (searchTimeoutId !== this.searchTimeoutId) {\r\n                        return;\r\n                    }\r\n\r\n                    if (data) {\r\n                        const channelIDsForMemberCount = data.map((channel: Channel) => channel.id);\r\n                        if (channelIDsForMemberCount.length > 0) {\r\n                            this.props.actions.getChannelsMemberCount(channelIDsForMemberCount);\r\n                        }\r\n                        this.setSearchResults(data.filter((channel) => channel.team_id === this.props.teamId));\r\n                    } else {\r\n                        this.setState({searchedChannels: [], searching: false});\r\n                    }\r\n                } catch (ignoredErr) {\r\n                    this.setState({searchedChannels: [], searching: false});\r\n                }\r\n            },\r\n            SEARCH_TIMEOUT_MILLISECONDS,\r\n        );\r\n\r\n        this.searchTimeoutId = searchTimeoutId;\r\n    };\r\n\r\n    setSearchResults = (channels: Channel[]) => {\r\n        // filter out private channels that the user is not a member of\r\n        let searchedChannels = channels.filter((c) => c.type !== Constants.PRIVATE_CHANNEL || this.isMemberOfChannel(c.id));\r\n        if (this.state.filter === Filter.Private) {\r\n            searchedChannels = channels.filter((c) => c.type === Constants.PRIVATE_CHANNEL && this.isMemberOfChannel(c.id));\r\n        }\r\n        if (this.state.filter === Filter.Public) {\r\n            searchedChannels = channels.filter((c) => c.type === Constants.OPEN_CHANNEL && c.delete_at === 0);\r\n        }\r\n        if (this.state.filter === Filter.Archived) {\r\n            searchedChannels = channels.filter((c) => c.delete_at !== 0);\r\n        }\r\n        if (this.props.shouldHideJoinedChannels) {\r\n            searchedChannels = this.getChannelsWithoutJoined(searchedChannels);\r\n        }\r\n        this.setState({searchedChannels, searching: false});\r\n    };\r\n\r\n    changeFilter = (filter: FilterType) => {\r\n        // search again when switching channels to update search results\r\n        this.search(this.state.searchTerm);\r\n        this.setState({filter});\r\n    };\r\n\r\n    isMemberOfChannel(channelId: string) {\r\n        return this.props.myChannelMemberships[channelId];\r\n    }\r\n\r\n    handleShowJoinedChannelsPreference = (shouldHideJoinedChannels: boolean) => {\r\n        // search again when switching channels to update search results\r\n        this.search(this.state.searchTerm);\r\n        this.props.actions.setGlobalItem(StoragePrefixes.HIDE_JOINED_CHANNELS, shouldHideJoinedChannels.toString());\r\n    };\r\n\r\n    getChannelsWithoutJoined = (channelList: Channel[]) => channelList.filter((channel) => !this.isMemberOfChannel(channel.id));\r\n\r\n    getActiveChannels = () => {\r\n        const {channels, archivedChannels, shouldHideJoinedChannels, privateChannels} = this.props;\r\n        const {search, searchedChannels, filter} = this.state;\r\n\r\n        const allChannels = channels.concat(privateChannels).sort((a, b) => a.display_name.localeCompare(b.display_name));\r\n        const allChannelsWithoutJoined = this.getChannelsWithoutJoined(allChannels);\r\n        const publicChannelsWithoutJoined = this.getChannelsWithoutJoined(channels);\r\n        const archivedChannelsWithoutJoined = this.getChannelsWithoutJoined(archivedChannels);\r\n        const privateChannelsWithoutJoined = this.getChannelsWithoutJoined(privateChannels);\r\n\r\n        const filterOptions = {\r\n            [Filter.All]: shouldHideJoinedChannels ? allChannelsWithoutJoined : allChannels,\r\n            [Filter.Archived]: shouldHideJoinedChannels ? archivedChannelsWithoutJoined : archivedChannels,\r\n            [Filter.Private]: shouldHideJoinedChannels ? privateChannelsWithoutJoined : privateChannels,\r\n            [Filter.Public]: shouldHideJoinedChannels ? publicChannelsWithoutJoined : channels,\r\n        };\r\n\r\n        if (search) {\r\n            return searchedChannels;\r\n        }\r\n\r\n        return filterOptions[filter] || filterOptions[Filter.All];\r\n    };\r\n\r\n    render() {\r\n        const {teamId, channelsRequestStarted, shouldHideJoinedChannels} = this.props;\r\n        const {search, serverError: serverErrorState, searching} = this.state;\r\n\r\n        this.activeChannels = this.getActiveChannels();\r\n\r\n        let serverError;\r\n        if (serverErrorState) {\r\n            serverError =\r\n                <div className='form-group has-error'><label className='control-label'>{serverErrorState}</label></div>;\r\n        }\r\n\r\n        const createNewChannelButton = (className: string, icon?: JSX.Element) => {\r\n            const buttonClassName = classNames('btn', className);\r\n            return (\r\n                <TeamPermissionGate\r\n                    teamId={teamId}\r\n                    permissions={[Permissions.CREATE_PUBLIC_CHANNEL]}\r\n                >\r\n                    <button\r\n                        type='button'\r\n                        id='createNewChannelButton'\r\n                        className={buttonClassName}\r\n                        onClick={this.handleNewChannel}\r\n                        aria-label={localizeMessage({id: 'more_channels.create', defaultMessage: 'Create New Channel'})}\r\n                    >\r\n                        {icon}\r\n                        <FormattedMessage\r\n                            id='more_channels.create'\r\n                            defaultMessage='Create New Channel'\r\n                        />\r\n                    </button>\r\n                </TeamPermissionGate>\r\n            );\r\n        };\r\n\r\n        const noResultsText = (\r\n            <>\r\n                <p className='secondary-message'>\r\n                    <FormattedMessage\r\n                        id='more_channels.searchError'\r\n                        defaultMessage='Try searching different keywords, checking for typos or adjusting the filters.'\r\n                    />\r\n                </p>\r\n                {createNewChannelButton('btn-primary', <i className='icon-plus'/>)}\r\n            </>\r\n        );\r\n\r\n        const body = this.state.loading ? <LoadingScreen/> : (\r\n            <>\r\n                <SearchableChannelList\r\n                    channels={this.activeChannels}\r\n                    channelsPerPage={CHANNELS_PER_PAGE}\r\n                    nextPage={this.nextPage}\r\n                    isSearch={search}\r\n                    search={this.search}\r\n                    handleJoin={this.handleJoin}\r\n                    noResultsText={noResultsText}\r\n                    loading={search ? searching : channelsRequestStarted}\r\n                    changeFilter={this.changeFilter}\r\n                    filter={this.state.filter}\r\n                    myChannelMemberships={this.props.myChannelMemberships}\r\n                    closeModal={this.props.actions.closeModal}\r\n                    hideJoinedChannelsPreference={this.handleShowJoinedChannelsPreference}\r\n                    rememberHideJoinedChannelsChecked={shouldHideJoinedChannels}\r\n                    channelsMemberCount={this.props.channelsMemberCount}\r\n                />\r\n                {serverError}\r\n            </>\r\n        );\r\n\r\n        const title = (\r\n            <FormattedMessage\r\n                id='more_channels.title'\r\n                defaultMessage='Browse Channels'\r\n            />\r\n        );\r\n\r\n        return (\r\n            <GenericModal\r\n                id='browseChannelsModal'\r\n                onExited={this.handleExit}\r\n                compassDesign={true}\r\n                modalHeaderText={title}\r\n                headerButton={createNewChannelButton('btn-secondary btn-sm')}\r\n                autoCloseOnConfirmButton={false}\r\n                aria-modal={true}\r\n                enforceFocus={false}\r\n                bodyPadding={false}\r\n            >\r\n                {body}\r\n            </GenericModal>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\n\r\nimport {getChannels, getArchivedChannels, joinChannel, getChannelsMemberCount, searchAllChannels} from 'mattermost-redux/actions/channels';\r\nimport {RequestStatus} from 'mattermost-redux/constants';\r\nimport {createSelector} from 'mattermost-redux/selectors/create_selector';\r\nimport {getChannelsInCurrentTeam, getMyChannelMemberships, getChannelsMemberCount as getChannelsMemberCountSelector} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getCurrentTeam, getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {setGlobalItem} from 'actions/storage';\r\nimport {openModal, closeModal} from 'actions/views/modals';\r\nimport {closeRightHandSide} from 'actions/views/rhs';\r\nimport {getIsRhsOpen, getRhsState} from 'selectors/rhs';\r\nimport {makeGetGlobalItem} from 'selectors/storage';\r\n\r\nimport Constants, {StoragePrefixes} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport BrowseChannels from './browse_channels';\r\n\r\nconst getChannelsWithoutArchived = createSelector(\r\n    'getChannelsWithoutArchived',\r\n    getChannelsInCurrentTeam,\r\n    (channels: Channel[]) => channels && channels.filter((c) => c.delete_at === 0 && c.type !== Constants.PRIVATE_CHANNEL),\r\n);\r\n\r\nconst getArchivedOtherChannels = createSelector(\r\n    'getArchivedOtherChannels',\r\n    getChannelsInCurrentTeam,\r\n    (channels: Channel[]) => channels && channels.filter((c) => c.delete_at !== 0),\r\n);\r\n\r\nconst getPrivateChannelsSelector = createSelector(\r\n    'getPrivateChannelsSelector',\r\n    getChannelsInCurrentTeam,\r\n    (channels: Channel[]) => channels && channels.filter((c) => c.type === Constants.PRIVATE_CHANNEL),\r\n);\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const team = getCurrentTeam(state);\r\n    const getGlobalItem = makeGetGlobalItem(StoragePrefixes.HIDE_JOINED_CHANNELS, 'false');\r\n\r\n    return {\r\n        channels: getChannelsWithoutArchived(state) || [],\r\n        archivedChannels: getArchivedOtherChannels(state) || [],\r\n        privateChannels: getPrivateChannelsSelector(state) || [],\r\n        currentUserId: getCurrentUserId(state),\r\n        teamId: getCurrentTeamId(state),\r\n        teamName: team?.name,\r\n        channelsRequestStarted: state.requests.channels.getChannels.status === RequestStatus.STARTED,\r\n        myChannelMemberships: getMyChannelMemberships(state) || {},\r\n        shouldHideJoinedChannels: getGlobalItem(state) === 'true',\r\n        rhsState: getRhsState(state),\r\n        rhsOpen: getIsRhsOpen(state),\r\n        channelsMemberCount: getChannelsMemberCountSelector(state),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            getChannels,\r\n            getArchivedChannels,\r\n            joinChannel,\r\n            searchAllChannels,\r\n            openModal,\r\n            closeModal,\r\n            setGlobalItem,\r\n            closeRightHandSide,\r\n            getChannelsMemberCount,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(BrowseChannels);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {useEffect, useMemo, useState} from 'react';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {getChannelBookmarks} from 'mattermost-redux/selectors/entities/channel_bookmarks';\r\nimport {getChannel, getMyChannelMember} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getConfig, getFeatureFlagValue, getLicense} from 'mattermost-redux/selectors/entities/general';\r\nimport {haveIChannelPermission} from 'mattermost-redux/selectors/entities/roles';\r\nimport {insertWithoutDuplicates} from 'mattermost-redux/utils/array_utils';\r\n\r\nimport {fetchChannelBookmarks, reorderBookmark} from 'actions/channel_bookmarks';\r\nimport {loadCustomEmojisIfNeeded} from 'actions/emoji_actions';\r\n\r\nimport Constants from 'utils/constants';\r\nimport {trimmedEmojiName} from 'utils/emoji_utils';\r\nimport {canUploadFiles, isPublicLinksEnabled} from 'utils/file_utils';\r\n\r\nexport const MAX_BOOKMARKS_PER_CHANNEL = 50;\r\n\r\nconst {OPEN_CHANNEL, PRIVATE_CHANNEL, GM_CHANNEL, DM_CHANNEL} = Constants as {OPEN_CHANNEL: 'O'; PRIVATE_CHANNEL: 'P'; GM_CHANNEL: 'G'; DM_CHANNEL: 'D'};\r\n\r\ntype TAction = 'add' | 'edit' | 'delete' | 'order';\r\ntype TActionKey = `${TAction}${typeof OPEN_CHANNEL | typeof PRIVATE_CHANNEL}`;\r\n\r\nconst key = (a: TAction, c: typeof OPEN_CHANNEL | typeof PRIVATE_CHANNEL): TActionKey => {\r\n    return `${a}${c}`;\r\n};\r\n\r\nconst BOOKMARK_PERMISSION = {\r\n\r\n    // open channel\r\n    [key('add', OPEN_CHANNEL)]: Permissions.ADD_BOOKMARK_PUBLIC_CHANNEL,\r\n    [key('edit', OPEN_CHANNEL)]: Permissions.EDIT_BOOKMARK_PUBLIC_CHANNEL,\r\n    [key('delete', OPEN_CHANNEL)]: Permissions.DELETE_BOOKMARK_PUBLIC_CHANNEL,\r\n    [key('order', OPEN_CHANNEL)]: Permissions.ORDER_BOOKMARK_PUBLIC_CHANNEL,\r\n\r\n    // private channel\r\n    [key('add', PRIVATE_CHANNEL)]: Permissions.ADD_BOOKMARK_PRIVATE_CHANNEL,\r\n    [key('edit', PRIVATE_CHANNEL)]: Permissions.EDIT_BOOKMARK_PRIVATE_CHANNEL,\r\n    [key('delete', PRIVATE_CHANNEL)]: Permissions.DELETE_BOOKMARK_PRIVATE_CHANNEL,\r\n    [key('order', PRIVATE_CHANNEL)]: Permissions.ORDER_BOOKMARK_PRIVATE_CHANNEL,\r\n} as const;\r\n\r\nexport const useChannelBookmarkPermission = (channelId: string, action: TAction) => {\r\n    return useSelector((state: GlobalState) => getHaveIChannelBookmarkPermission(state, channelId, action));\r\n};\r\n\r\nexport const getHaveIChannelBookmarkPermission = (state: GlobalState, channelId: string, action: TAction) => {\r\n    const channel: Channel | undefined = getChannel(state, channelId);\r\n\r\n    if (!channel) {\r\n        return false;\r\n    }\r\n\r\n    if (channel.delete_at !== 0) {\r\n        return false;\r\n    }\r\n\r\n    const {type} = channel;\r\n\r\n    if (type === 'threads') {\r\n        return false;\r\n    }\r\n\r\n    if (type === GM_CHANNEL || type === DM_CHANNEL) {\r\n        const myMembership = getMyChannelMember(state, channelId);\r\n        return myMembership?.channel_id === channelId;\r\n    }\r\n\r\n    const permission = BOOKMARK_PERMISSION[key(action, type)];\r\n\r\n    return channel && permission && haveIChannelPermission(state, channel.team_id, channelId, permission);\r\n};\r\n\r\nexport const useCanUploadFiles = () => {\r\n    return useSelector((state: GlobalState) => canUploadFiles(getConfig(state)));\r\n};\r\n\r\nexport const useCanGetPublicLink = () => {\r\n    return useSelector((state: GlobalState) => isPublicLinksEnabled(getConfig(state)));\r\n};\r\n\r\nexport const useCanGetLinkPreviews = () => {\r\n    return useSelector((state: GlobalState) => getConfig(state).EnableLinkPreviews === 'true');\r\n};\r\n\r\nexport const getIsChannelBookmarksEnabled = (state: GlobalState) => {\r\n    const isEnabled = getFeatureFlagValue(state, 'ChannelBookmarks') === 'true';\r\n\r\n    if (!isEnabled) {\r\n        return false;\r\n    }\r\n\r\n    const license = getLicense(state);\r\n\r\n    return license?.IsLicensed === 'true';\r\n};\r\n\r\nexport const useChannelBookmarks = (channelId: string) => {\r\n    const dispatch = useDispatch();\r\n    const bookmarks = useSelector((state: GlobalState) => getChannelBookmarks(state, channelId));\r\n\r\n    const order = useMemo(() => {\r\n        return Object.keys(bookmarks).sort((a, b) => bookmarks[a].sort_order - bookmarks[b].sort_order);\r\n    }, [bookmarks]);\r\n    const [tempOrder, setTempOrder] = useState<typeof order>();\r\n\r\n    useEffect(() => {\r\n        if (tempOrder) {\r\n            setTempOrder(undefined);\r\n        }\r\n    }, [order]);\r\n\r\n    useEffect(() => {\r\n        if (channelId) {\r\n            dispatch(fetchChannelBookmarks(channelId));\r\n        }\r\n    }, [channelId]);\r\n\r\n    useEffect(() => {\r\n        const emojis = Object.values(bookmarks).reduce<string[]>((result, {emoji}) => {\r\n            if (emoji) {\r\n                result.push(trimmedEmojiName(emoji));\r\n            }\r\n\r\n            return result;\r\n        }, []);\r\n\r\n        if (emojis.length) {\r\n            dispatch(loadCustomEmojisIfNeeded(emojis));\r\n        }\r\n    }, [bookmarks]);\r\n\r\n    const reorder = async (id: string, prevOrder: number, nextOrder: number) => {\r\n        setTempOrder(insertWithoutDuplicates(order, id, nextOrder));\r\n        const {error} = await dispatch(reorderBookmark(channelId, id, nextOrder));\r\n\r\n        if (error) {\r\n            setTempOrder(undefined);\r\n        }\r\n    };\r\n\r\n    return {\r\n        bookmarks,\r\n        order: tempOrder ?? order,\r\n        reorder,\r\n    } as const;\r\n};\r\n\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {memo} from 'react';\r\nimport type {MouseEvent, KeyboardEvent} from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\n\r\nimport {\r\n    FolderOutlineIcon,\r\n    StarOutlineIcon,\r\n    FolderMoveOutlineIcon,\r\n    ChevronRightIcon,\r\n    CheckIcon,\r\n} from '@mattermost/compass-icons/components';\r\nimport type {ChannelCategory} from '@mattermost/types/channel_categories';\r\nimport type {Channel} from '@mattermost/types/channels';\r\n\r\nimport {CategoryTypes} from 'mattermost-redux/constants/channel_categories';\r\nimport {getCategoryInTeamWithChannel} from 'mattermost-redux/selectors/entities/channel_categories';\r\nimport {getAllChannels} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport {addChannelsInSidebar} from 'actions/views/channel_sidebar';\r\nimport {openModal} from 'actions/views/modals';\r\nimport {getCategoriesForCurrentTeam} from 'selectors/views/channel_sidebar';\r\n\r\nimport EditCategoryModal from 'components/edit_category_modal';\r\nimport * as Menu from 'components/menu';\r\n\r\nimport Constants, {ModalIdentifiers} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\ntype Props = {\r\n    channel: Channel;\r\n    inHeaderDropdown?: boolean;\r\n};\r\n\r\nconst ChannelMoveToSubMenu = (props: Props) => {\r\n    const {formatMessage} = useIntl();\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    const allChannels = useSelector(getAllChannels);\r\n    const multiSelectedChannelIds = useSelector((state: GlobalState) => state.views.channelSidebar.multiSelectedChannelIds);\r\n\r\n    const currentTeam = useSelector(getCurrentTeam);\r\n    const categories = useSelector((state: GlobalState) => {\r\n        return currentTeam ? getCategoriesForCurrentTeam(state) : undefined;\r\n    });\r\n    const currentCategory = useSelector((state: GlobalState) => {\r\n        return currentTeam ? getCategoryInTeamWithChannel(state, currentTeam?.id || '', props.channel.id) : undefined;\r\n    });\r\n\r\n    function handleMoveToCategory(event: MouseEvent<HTMLLIElement> | KeyboardEvent<HTMLLIElement>, categoryId: string) {\r\n        event.preventDefault();\r\n\r\n        if (currentCategory?.id !== categoryId) {\r\n            dispatch(addChannelsInSidebar(categoryId, props.channel.id));\r\n        }\r\n    }\r\n\r\n    function handleMoveToNewCategory() {\r\n        dispatch(openModal({\r\n            modalId: ModalIdentifiers.EDIT_CATEGORY,\r\n            dialogType: EditCategoryModal,\r\n            dialogProps: {\r\n                channelIdsToAdd: multiSelectedChannelIds.indexOf(props.channel.id) === -1 ? [props.channel.id] : multiSelectedChannelIds,\r\n            },\r\n        }));\r\n    }\r\n\r\n    function createSubmenuItemsForCategoryArray(categories: ChannelCategory[], currentCategory?: ChannelCategory) {\r\n        const allCategories = categories.map((category: ChannelCategory) => {\r\n            let text = <span>{category.display_name}</span>;\r\n\r\n            if (category.type === CategoryTypes.FAVORITES) {\r\n                text = (\r\n                    <FormattedMessage\r\n                        id='sidebar_left.sidebar_channel_menu.favorites'\r\n                        defaultMessage='Favorites'\r\n                    />\r\n                );\r\n            }\r\n            if (category.type === CategoryTypes.CHANNELS) {\r\n                text = (\r\n                    <FormattedMessage\r\n                        id='sidebar_left.sidebar_channel_menu.channels'\r\n                        defaultMessage='Channels'\r\n                    />\r\n                );\r\n            }\r\n\r\n            let selectedCategory = null;\r\n            if (currentCategory && currentCategory.display_name === category.display_name) {\r\n                selectedCategory = (\r\n                    <CheckIcon\r\n                        color='var(--button-bg)'\r\n                        size={18}\r\n                    />\r\n                );\r\n            }\r\n\r\n            return (\r\n                <Menu.Item\r\n                    id={`moveToCategory-${props.channel.id}-${category.id}`}\r\n                    key={`moveToCategory-${props.channel.id}-${category.id}`}\r\n                    leadingElement={category.type === CategoryTypes.FAVORITES ? (<StarOutlineIcon size={18}/>) : (<FolderOutlineIcon size={18}/>)}\r\n                    labels={text}\r\n                    trailingElements={selectedCategory}\r\n                    onClick={(event) => handleMoveToCategory(event, category.id)}\r\n                />\r\n            );\r\n        });\r\n\r\n        const dividerAndNewCategory = [\r\n            <Menu.Separator key='ChannelMenu-moveToDivider'/>,\r\n            <Menu.Item\r\n                id={`moveToNewCategory-${props.channel.id}`}\r\n                key={`moveToNewCategory-${props.channel.id}`}\r\n                aria-haspopup={true}\r\n                leadingElement={<FolderMoveOutlineIcon size={18}/>}\r\n                labels={\r\n                    <FormattedMessage\r\n                        id='sidebar_left.sidebar_channel_menu.moveToNewCategory'\r\n                        defaultMessage='New Category'\r\n                    />\r\n                }\r\n                onClick={handleMoveToNewCategory}\r\n            />,\r\n        ];\r\n\r\n        return [...allCategories, ...dividerAndNewCategory];\r\n    }\r\n\r\n    function filterCategoriesBasedOnChannelType(categories: ChannelCategory[], isDmOrGm = false) {\r\n        if (isDmOrGm) {\r\n            return categories.filter((category) => category.type !== CategoryTypes.CHANNELS);\r\n        }\r\n\r\n        return categories.filter((category) => category.type !== CategoryTypes.DIRECT_MESSAGES);\r\n    }\r\n\r\n    function getMoveToCategorySubmenuItems(categories: ChannelCategory[], currentCategory?: ChannelCategory) {\r\n        const isSubmenuOneOfSelectedChannels = multiSelectedChannelIds.includes(props.channel.id);\r\n\r\n        // If sub menu is in channel header dropdown OR If multiple channels are selected but the menu is open outside of those selected channels\r\n        if (props.inHeaderDropdown || !isSubmenuOneOfSelectedChannels) {\r\n            const isDmOrGm = props.channel.type === Constants.DM_CHANNEL || props.channel.type === Constants.GM_CHANNEL;\r\n            const filteredCategories = filterCategoriesBasedOnChannelType(categories, isDmOrGm);\r\n            return createSubmenuItemsForCategoryArray(filteredCategories, currentCategory);\r\n        }\r\n\r\n        const areAllSelectedChannelsDMorGM = multiSelectedChannelIds.every((channelId) => allChannels[channelId].type === Constants.DM_CHANNEL || allChannels[channelId].type === Constants.GM_CHANNEL);\r\n        if (areAllSelectedChannelsDMorGM) {\r\n            const filteredCategories = filterCategoriesBasedOnChannelType(categories, true);\r\n            return createSubmenuItemsForCategoryArray(filteredCategories, currentCategory);\r\n        }\r\n\r\n        const areAllSelectedChannelsAreNotDMorGM = multiSelectedChannelIds.every((channelId) => allChannels[channelId].type !== Constants.DM_CHANNEL && allChannels[channelId].type !== Constants.GM_CHANNEL);\r\n        if (areAllSelectedChannelsAreNotDMorGM) {\r\n            const filteredCategories = filterCategoriesBasedOnChannelType(categories, false);\r\n            return createSubmenuItemsForCategoryArray(filteredCategories, currentCategory);\r\n        }\r\n\r\n        // If we have a mix of channel types, we need to filter out both the DM and Channel categories\r\n        const filteredCategories = categories.filter((category) => category.type !== CategoryTypes.CHANNELS && category.type !== CategoryTypes.DIRECT_MESSAGES);\r\n        return createSubmenuItemsForCategoryArray(filteredCategories, currentCategory);\r\n    }\r\n\r\n    if (!categories) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <Menu.SubMenu\r\n            id={`moveTo-${props.channel.id}`}\r\n            labels={\r\n                <FormattedMessage\r\n                    id='sidebar_left.sidebar_channel_menu.moveTo'\r\n                    defaultMessage='Move to...'\r\n                />\r\n            }\r\n            leadingElement={props.inHeaderDropdown ? null : <FolderMoveOutlineIcon size={18}/>}\r\n            trailingElements={<ChevronRightIcon size={16}/>}\r\n            menuId={`moveTo-${props.channel.id}-menu`}\r\n            menuAriaLabel={formatMessage({id: 'sidebar_left.sidebar_channel_menu.moveTo.dropdownAriaLabel', defaultMessage: 'Move to submenu'})}\r\n        >\r\n            {getMoveToCategorySubmenuItems(categories, currentCategory)}\r\n        </Menu.SubMenu>\r\n    );\r\n};\r\n\r\nexport default memo(ChannelMoveToSubMenu);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport {GenericModal} from '@mattermost/components';\r\n\r\nimport QuickInput, {MaxLengthInput} from 'components/quick_input';\r\n\r\nimport {localizeMessage} from 'utils/utils';\r\n\r\nimport '../category_modal.scss';\r\n\r\nconst MAX_LENGTH = 22;\r\nconst ACTION_WAIT_MS = 1000;\r\n\r\ntype Props = {\r\n    onExited: () => void;\r\n    currentTeamId: string;\r\n    categoryId?: string;\r\n    initialCategoryName?: string;\r\n    channelIdsToAdd?: string[];\r\n    actions: {\r\n        createCategory: (teamId: string, displayName: string, channelIds?: string[] | undefined) => void;\r\n        renameCategory: (categoryId: string, newName: string) => void;\r\n    };\r\n};\r\n\r\ntype State = {\r\n    categoryName: string;\r\n}\r\n\r\nexport default class EditCategoryModal extends React.PureComponent<Props, State> {\r\n    timeoutId: NodeJS.Timeout | null = null;\r\n    isProcessing = false;\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            categoryName: props.initialCategoryName || '',\r\n        };\r\n    }\r\n\r\n    handleClear = () => {\r\n        this.setState({categoryName: ''});\r\n    };\r\n\r\n    handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({categoryName: e.target.value});\r\n    };\r\n\r\n    handleCancel = () => {\r\n        this.handleClear();\r\n    };\r\n\r\n    componentWillUnmount() {\r\n        if (this.timeoutId) {\r\n            clearTimeout(this.timeoutId);\r\n        }\r\n    }\r\n\r\n    handleConfirm = () => {\r\n        if (this.isProcessing) {\r\n            return;\r\n        }\r\n        this.isProcessing = true;\r\n        this.timeoutId = setTimeout(() => {\r\n            this.isProcessing = false;\r\n        }, ACTION_WAIT_MS);\r\n\r\n        if (this.props.categoryId) {\r\n            this.props.actions.renameCategory(this.props.categoryId, this.state.categoryName);\r\n        } else {\r\n            this.props.actions.createCategory(this.props.currentTeamId, this.state.categoryName, this.props.channelIdsToAdd);\r\n        }\r\n    };\r\n\r\n    isConfirmDisabled = () => {\r\n        return !this.state.categoryName ||\r\n            (Boolean(this.props.initialCategoryName) && this.props.initialCategoryName === this.state.categoryName) || this.state.categoryName.length > MAX_LENGTH;\r\n    };\r\n\r\n    getText = () => {\r\n        let modalHeaderText;\r\n        let editButtonText;\r\n        let helpText;\r\n\r\n        if (this.props.categoryId) {\r\n            modalHeaderText = (\r\n                <FormattedMessage\r\n                    id='rename_category_modal.renameCategory'\r\n                    defaultMessage='Rename Category'\r\n                />\r\n            );\r\n            editButtonText = (\r\n                <FormattedMessage\r\n                    id='rename_category_modal.rename'\r\n                    defaultMessage='Rename'\r\n                />\r\n            );\r\n        } else {\r\n            modalHeaderText = (\r\n                <FormattedMessage\r\n                    id='create_category_modal.createCategory'\r\n                    defaultMessage='Create New Category'\r\n                />\r\n            );\r\n            editButtonText = (\r\n                <FormattedMessage\r\n                    id='create_category_modal.create'\r\n                    defaultMessage='Create'\r\n                />\r\n            );\r\n            helpText = (\r\n                <FormattedMessage\r\n                    id='edit_category_modal.helpText'\r\n                    defaultMessage='Drag channels into this category to organize your sidebar.'\r\n                />\r\n            );\r\n        }\r\n\r\n        return {\r\n            modalHeaderText,\r\n            editButtonText,\r\n            helpText,\r\n        };\r\n    };\r\n\r\n    render() {\r\n        const {\r\n            modalHeaderText,\r\n            editButtonText,\r\n            helpText,\r\n        } = this.getText();\r\n\r\n        return (\r\n            <GenericModal\r\n                id='editCategoryModal'\r\n                modalHeaderText={modalHeaderText}\r\n                confirmButtonText={editButtonText}\r\n                compassDesign={true}\r\n                onExited={this.props.onExited}\r\n                handleEnterKeyPress={this.handleConfirm}\r\n                handleConfirm={this.handleConfirm}\r\n                handleCancel={this.handleCancel}\r\n                isConfirmDisabled={this.isConfirmDisabled()}\r\n            >\r\n                <QuickInput\r\n                    inputComponent={MaxLengthInput}\r\n                    autoFocus={true}\r\n                    className='form-control filter-textbox'\r\n                    type='text'\r\n                    value={this.state.categoryName}\r\n                    placeholder={localizeMessage({id: 'edit_category_modal.placeholder', defaultMessage: 'Name your category'})}\r\n                    clearable={true}\r\n                    onClear={this.handleClear}\r\n                    onChange={this.handleChange}\r\n                    maxLength={MAX_LENGTH}\r\n                />\r\n                {Boolean(helpText) && <span className='edit-category__helpText'>\r\n                    {helpText}\r\n                </span>}\r\n            </GenericModal>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {renameCategory} from 'mattermost-redux/actions/channel_categories';\r\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport {createCategory} from 'actions/views/channel_sidebar';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport EditCategoryModal from './edit_category_modal';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    return {\r\n        currentTeamId: getCurrentTeamId(state),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            createCategory,\r\n            renameCategory,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(EditCategoryModal);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {Modal} from 'react-bootstrap';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport type {UserProfile} from '@mattermost/types/users';\r\n\r\nimport * as UserUtils from 'mattermost-redux/utils/user_utils';\r\n\r\nimport Constants from 'utils/constants';\r\nimport {isKeyPressed} from 'utils/keyboard';\r\n\r\ntype Props = {\r\n    currentUser: UserProfile;\r\n    currentUserId: string;\r\n    currentTeamId: string;\r\n    numOfPublicChannels: number;\r\n    numOfPrivateChannels: number;\r\n    onExited: () => void;\r\n    actions: {\r\n        leaveTeam: (teamId: string, userId: string) => void;\r\n        toggleSideBarRightMenu: () => void;\r\n    };\r\n};\r\n\r\ntype State = {\r\n    show: boolean;\r\n};\r\n\r\nexport default class LeaveTeamModal extends React.PureComponent<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            show: true,\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        document.addEventListener('keypress', this.handleKeyPress);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        document.removeEventListener('keypress', this.handleKeyPress);\r\n    }\r\n\r\n    handleHide = () => {\r\n        this.setState({\r\n            show: false,\r\n        });\r\n    };\r\n\r\n    handleKeyPress = (e: KeyboardEvent) => {\r\n        if (isKeyPressed(e, Constants.KeyCodes.ENTER)) {\r\n            this.handleSubmit();\r\n        }\r\n    };\r\n\r\n    handleSubmit = () => {\r\n        this.handleHide();\r\n\r\n        this.props.actions.leaveTeam(\r\n            this.props.currentTeamId,\r\n            this.props.currentUserId,\r\n        );\r\n        this.props.actions.toggleSideBarRightMenu();\r\n    };\r\n\r\n    render() {\r\n        const {\r\n            currentUser,\r\n            numOfPrivateChannels,\r\n            numOfPublicChannels,\r\n        } = this.props;\r\n\r\n        const isGuest = UserUtils.isGuest(currentUser.roles);\r\n\r\n        let modalMessage;\r\n        if (isGuest) {\r\n            if (numOfPublicChannels !== 0 && numOfPrivateChannels !== 0) {\r\n                modalMessage = (\r\n                    <FormattedMessage\r\n                        id='leave_team_modal_guest.description'\r\n                        defaultMessage='<strong>You will be removed from {num_of_public_channels} public {num_of_public_channels,plural,one {channel} other {channels}} and {num_of_private_channels} private {num_of_private_channels,plural,one {channel} other {channels}} on this team.</strong> You won&apos;t be able to rejoin it without an invitation from another team member. Are you sure?'\r\n                        values={{\r\n                            num_of_public_channels: numOfPublicChannels,\r\n                            num_of_private_channels: numOfPrivateChannels,\r\n                            strong: (chunks: React.ReactNode) => <strong>{chunks}</strong>,\r\n                        }}\r\n                    />\r\n                );\r\n            } else if (numOfPublicChannels === 0) {\r\n                modalMessage = (\r\n                    <FormattedMessage\r\n                        id='leave_team_modal_guest_only_private.description'\r\n                        defaultMessage='<strong>You will be removed from {num_of_private_channels} private {num_of_private_channels,plural,one {channel} other {channels}} on this team.</strong> You won&apos;t be able to rejoin it without an invitation from another team member. Are you sure?'\r\n                        values={{\r\n                            num_of_private_channels: numOfPrivateChannels,\r\n                            strong: (chunks: React.ReactNode) => <strong>{chunks}</strong>,\r\n                        }}\r\n                    />\r\n                );\r\n            } else {\r\n                modalMessage = (\r\n                    <FormattedMessage\r\n                        id='leave_team_modal_guest_only_public.description'\r\n                        defaultMessage='<strong>You will be removed from {num_of_public_channels} public {num_of_public_channels,plural,one {channel} other {channels}} on this team.</strong> You won&apos;t be able to rejoin it without an invitation from another team member. Are you sure?'\r\n                        values={{\r\n                            num_of_public_channels: numOfPublicChannels,\r\n                            strong: (chunks: React.ReactNode) => <strong>{chunks}</strong>,\r\n                        }}\r\n                    />\r\n                );\r\n            }\r\n        } else if (numOfPublicChannels !== 0 && numOfPrivateChannels !== 0) {\r\n            modalMessage = (\r\n                <FormattedMessage\r\n                    id='leave_team_modal.description'\r\n                    defaultMessage='<strong>You will be removed from {num_of_public_channels} public {num_of_public_channels,plural,one {channel} other {channels}} and {num_of_private_channels} private {num_of_private_channels,plural,one {channel} other {channels}} on this team.</strong> If the team is private you won&apos;t be able to rejoin it without an invitation from another team member. Are you sure?'\r\n                    values={{\r\n                        num_of_public_channels: numOfPublicChannels,\r\n                        num_of_private_channels: numOfPrivateChannels,\r\n                        strong: (chunks: React.ReactNode) => <strong>{chunks}</strong>,\r\n                    }}\r\n                />\r\n            );\r\n        } else if (numOfPublicChannels === 0) {\r\n            modalMessage = (\r\n                <FormattedMessage\r\n                    id='leave_team_modal_private.description'\r\n                    defaultMessage='<strong>You will be removed from {num_of_private_channels} private {num_of_private_channels,plural,one {channel} other {channels}} on this team.</strong> If the team is private you won&apos;t be able to rejoin it without an invitation from another team member. Are you sure?'\r\n                    values={{\r\n                        num_of_private_channels: numOfPrivateChannels,\r\n                        strong: (chunks: React.ReactNode) => <strong>{chunks}</strong>,\r\n                    }}\r\n                />\r\n            );\r\n        } else {\r\n            modalMessage = (\r\n                <FormattedMessage\r\n                    id='leave_team_modal_public.description'\r\n                    defaultMessage='<strong>You will be removed from {num_of_public_channels} public {num_of_public_channels,plural,one {channel} other {channels}} on this team.</strong> Are you sure?'\r\n                    values={{\r\n                        num_of_public_channels: numOfPublicChannels,\r\n                        strong: (chunks: React.ReactNode) => <strong>{chunks}</strong>,\r\n                    }}\r\n                />\r\n            );\r\n        }\r\n\r\n        return (\r\n            <Modal\r\n                dialogClassName='a11y__modal'\r\n                className='modal-confirm'\r\n                show={this.state.show}\r\n                onExited={this.props.onExited}\r\n                onHide={this.handleHide}\r\n                id='leaveTeamModal'\r\n                role='none'\r\n                aria-labelledby='leaveTeamModalLabel'\r\n            >\r\n                <Modal.Header closeButton={false}>\r\n                    <Modal.Title\r\n                        componentClass='h1'\r\n                        id='leaveTeamModalLabel'\r\n                    >\r\n                        <FormattedMessage\r\n                            id='leave_team_modal.title'\r\n                            defaultMessage='Leave the team?'\r\n                        />\r\n                    </Modal.Title>\r\n                </Modal.Header>\r\n                <Modal.Body>\r\n                    {modalMessage}\r\n                </Modal.Body>\r\n                <Modal.Footer>\r\n                    <button\r\n                        type='button'\r\n                        className='btn btn-tertiary'\r\n                        onClick={this.handleHide}\r\n                        id='leaveTeamNo'\r\n                    >\r\n                        <FormattedMessage\r\n                            id='leave_team_modal.no'\r\n                            defaultMessage='No'\r\n                        />\r\n                    </button>\r\n                    <button\r\n                        type='button'\r\n                        className='btn btn-danger'\r\n                        onClick={this.handleSubmit}\r\n                        id='leaveTeamYes'\r\n                    >\r\n                        <FormattedMessage\r\n                            id='leave_team_modal.yes'\r\n                            defaultMessage='Yes'\r\n                        />\r\n                    </button>\r\n                </Modal.Footer>\r\n            </Modal>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {removeUserFromTeam as leaveTeam} from 'mattermost-redux/actions/teams';\r\nimport {getMyChannels} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getCurrentUserId, getCurrentUser} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {toggleSideBarRightMenuAction} from 'actions/global_actions';\r\n\r\nimport {Constants} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport LeaveTeamModal from './leave_team_modal';\r\n\r\nfunction getNumOfPrivateChannels(state: GlobalState) {\r\n    const channels = getMyChannels(state);\r\n\r\n    return channels.filter((channel) => channel.type === Constants.PRIVATE_CHANNEL).length;\r\n}\r\n\r\nfunction getNumOfPublicChannels(state: GlobalState) {\r\n    const channels = getMyChannels(state);\r\n\r\n    return channels.filter((channel) => channel.type === Constants.OPEN_CHANNEL).length;\r\n}\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const currentUserId = getCurrentUserId(state);\r\n    const currentTeamId = getCurrentTeamId(state);\r\n    const currentUser = getCurrentUser(state);\r\n\r\n    return {\r\n        currentUserId,\r\n        currentTeamId,\r\n        currentUser,\r\n        numOfPrivateChannels: getNumOfPrivateChannels(state),\r\n        numOfPublicChannels: getNumOfPublicChannels(state),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            leaveTeam,\r\n            toggleSideBarRightMenu: toggleSideBarRightMenuAction,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(LeaveTeamModal);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {Modal} from 'react-bootstrap';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport type {Group} from '@mattermost/types/groups';\r\n\r\nimport LoadingScreen from 'components/loading_screen';\r\n\r\nexport const DEFAULT_NUM_PER_PAGE = 50;\r\n\r\ntype Props = {\r\n\r\n    /**\r\n     * titleText (optional) a string to show at the top bar of the modal.\r\n     */\r\n    titleText?: string;\r\n\r\n    /**\r\n     * searchPlaceholderText (optional) a string to show as a placeholder in the search input.\r\n     */\r\n    searchPlaceholderText?: string;\r\n\r\n    /**\r\n     * titleBarButtonText (optional) a string representing a title bar button text.\r\n     */\r\n    titleBarButtonText?: string;\r\n\r\n    /**\r\n     * numPerPage (optional) a number setting how many items per page should be displayed. Defaults to\r\n     * DEFAULT_NUM_PER_PAGE.\r\n     */\r\n    numPerPage?: number;\r\n\r\n    /**\r\n     * show (optional) a boolean setting to hide the modal via props rather then unmounting it.\r\n     */\r\n    show?: boolean;\r\n\r\n    /**\r\n     * titleBarButtonOnClick (optional) a func to handle title button bar clicks.\r\n     */\r\n    titleBarButtonOnClick?: () => void;\r\n\r\n    /**\r\n     * loadItems is a function that receives the params (pageNumber, searchTerm) and should return an object\r\n     * with the shape {items: [], totalCount: 0}.\r\n     * items: an array of objects that are passed to each renderRow function.\r\n     * totalCount: an integer representing the total number of items as displayed in the pagination text.\r\n     *\r\n     * Example:\r\n     *     const loadItems = async (pageNumber, searchTerm) => {\r\n     *         const {data} = await loadFromServer(searchTerm, pageNumber, PER_PAGE);\r\n     *         return {\r\n     *             items: data.users,\r\n     *             totalCount: data.total,\r\n     *         };\r\n     *     };\r\n     */\r\n    loadItems: (page: number, searchTerm: string) => Promise<{\r\n        items: Group[];\r\n        totalCount: number;\r\n    }>;\r\n\r\n    /**\r\n     * onHide (optional) a function to be invoked when the modal is closed.\r\n     */\r\n    onHide?: () => void;\r\n\r\n    /**\r\n     * renderRow is a function that receives the params (item, listModal) and should return JSX.\r\n     * item: an object as returned by each entry in the loadItems function's 'items' array.\r\n     * listModal: the instance of the ListModal component class.\r\n     *\r\n     * Example:\r\n     *     const renderRow = (item, listModal) => <div>{item.id}</div>;\r\n     */\r\n    renderRow: (item: Group, listModal: ListModal) => JSX.Element;\r\n}\r\n\r\ntype State = {\r\n    show: boolean;\r\n    page: number;\r\n    items: Group[];\r\n    totalCount: number;\r\n    loading: boolean;\r\n    searchTerm: string;\r\n}\r\n\r\nexport default class ListModal extends React.PureComponent<Props, State> {\r\n    static defaultProps = {\r\n        show: true,\r\n    };\r\n    numPerPage: number;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.numPerPage = props.numPerPage || DEFAULT_NUM_PER_PAGE;\r\n\r\n        this.state = {\r\n            show: true,\r\n            page: 0,\r\n            items: [],\r\n            totalCount: 0,\r\n            loading: true,\r\n            searchTerm: '',\r\n        };\r\n    }\r\n\r\n    async componentDidMount() {\r\n        const {totalCount, items} = await this.props.loadItems(0, '');\r\n        this.setState({totalCount, items, loading: false});\r\n    }\r\n\r\n    handleHide = () => {\r\n        this.setState({show: false});\r\n    };\r\n\r\n    handleExit = () => {\r\n        if (this.props.onHide) {\r\n            this.props.onHide();\r\n        }\r\n    };\r\n\r\n    renderRows() {\r\n        if (this.state.loading) {\r\n            return (\r\n                <div>\r\n                    <LoadingScreen\r\n                        position='absolute'\r\n                        key='loading'\r\n                    />\r\n                </div>\r\n            );\r\n        }\r\n        return this.state.items.map((item) => (\r\n            this.props.renderRow(item, this)\r\n        ));\r\n    }\r\n\r\n    onNext = () => {\r\n        const nextPage = this.state.page + 1;\r\n        this.onPageChange(nextPage);\r\n    };\r\n\r\n    onPrev = () => {\r\n        const prevPage = this.state.page - 1;\r\n        this.onPageChange(prevPage);\r\n    };\r\n\r\n    onPageChange = async (page: number) => {\r\n        this.setState({loading: true});\r\n        const result = await this.props.loadItems(page, this.state.searchTerm);\r\n        this.setState({page, items: result.items, loading: false});\r\n    };\r\n\r\n    onSearchInput = async (event: React.ChangeEvent<HTMLInputElement>) => {\r\n        const {target} = event;\r\n        const searchTerm = target.value;\r\n        this.setState({loading: true, searchTerm});\r\n        const result = await this.props.loadItems(0, searchTerm);\r\n        const {items, totalCount} = result;\r\n        this.setState({loading: false, items, totalCount});\r\n    };\r\n\r\n    paginationRange() {\r\n        let startCount = (this.state.page * this.numPerPage) + 1;\r\n        const endCount = (startCount + this.state.items.length) - 1;\r\n        if (endCount === 0) {\r\n            startCount = 0;\r\n        }\r\n        return {startCount, endCount};\r\n    }\r\n\r\n    render() {\r\n        if (!this.props.show) {\r\n            return null;\r\n        }\r\n        const {endCount, startCount} = this.paginationRange();\r\n        return (\r\n            <div>\r\n                <Modal\r\n                    dialogClassName='a11y__modal more-modal more-modal--action'\r\n                    show={this.state.show}\r\n                    onHide={this.handleHide}\r\n                    onExited={this.handleExit}\r\n                >\r\n                    <Modal.Header closeButton={true}>\r\n                        <Modal.Title componentClass='h1'>\r\n                            <span className='name'>{this.props.titleText}</span>\r\n                        </Modal.Title>\r\n                        {this.props.titleBarButtonText && this.props.titleBarButtonOnClick &&\r\n                            <a\r\n                                className='btn btn-md btn-primary'\r\n                                href='#'\r\n                                onClick={this.props.titleBarButtonOnClick}\r\n                            >\r\n                                {this.props.titleBarButtonText}\r\n                            </a>}\r\n                    </Modal.Header>\r\n                    <Modal.Body>\r\n                        <div className='filtered-user-list'>\r\n                            <div className='filter-row'>\r\n                                <div className='col-xs-12'>\r\n                                    <label\r\n                                        className='hidden-label'\r\n                                        htmlFor='searchUsersInput'\r\n                                    >\r\n                                        {this.props.searchPlaceholderText}\r\n                                    </label>\r\n                                    <input\r\n                                        id='searchUsersInput'\r\n                                        className='form-control filter-textbox'\r\n                                        placeholder={this.props.searchPlaceholderText}\r\n                                        onChange={this.onSearchInput}\r\n                                    />\r\n                                </div>\r\n                                <div className='col-sm-12'>\r\n                                    <span className='member-count pull-left'>\r\n                                        <FormattedMessage\r\n                                            id='list_modal.paginatorCount'\r\n                                            defaultMessage='{startCount, number} - {endCount, number} of {total, number} total'\r\n                                            values={{\r\n                                                startCount,\r\n                                                endCount,\r\n                                                total: this.state.totalCount,\r\n                                            }}\r\n                                        />\r\n                                    </span>\r\n                                </div>\r\n                            </div>\r\n                            <div className='more-modal__list'>\r\n                                <div>\r\n                                    {this.renderRows()}\r\n                                </div>\r\n                            </div>\r\n                            <div className='filter-controls'>\r\n                                {this.state.page > 0 &&\r\n                                <button\r\n                                    onClick={this.onPrev}\r\n                                    className='btn btn-sm btn-tertiary filter-control filter-control__prev'\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='filtered_user_list.prev'\r\n                                        defaultMessage='Previous'\r\n                                    />\r\n                                </button>}\r\n                                {this.props.numPerPage && (this.state.items.length >= this.props.numPerPage) && endCount !== this.state.totalCount &&\r\n                                <button\r\n                                    onClick={this.onNext}\r\n                                    className='btn btn-sm btn-tertiary filter-control filter-control__next'\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='filtered_user_list.next'\r\n                                        defaultMessage='Next'\r\n                                    />\r\n                                </button>}\r\n                            </div>\r\n                        </div>\r\n                    </Modal.Body>\r\n                </Modal>\r\n            </div >\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\n\r\nimport {ShortcutKey, ShortcutKeyVariant} from 'components/shortcut_key';\r\n\r\nimport {isDesktopApp, isMac} from 'utils/user_agent';\r\n\r\nimport './search_shortcut.scss';\r\n\r\nexport type SearchShortcutProps = {\r\n    className?: string;\r\n    variant?: ShortcutKeyVariant;\r\n}\r\n\r\nexport const SearchShortcut = ({className, variant}: SearchShortcutProps) => {\r\n    const controlKey = isMac() ? '' : 'Ctrl';\r\n    const shortcutKeyVariant = variant || ShortcutKeyVariant.Contrast;\r\n\r\n    return (\r\n        <span className={classNames('search-shortcut', className)}>\r\n            <ShortcutKey variant={shortcutKeyVariant}>{controlKey}</ShortcutKey>\r\n            {!isDesktopApp() && <ShortcutKey variant={shortcutKeyVariant}>{'Shift'}</ShortcutKey>}\r\n            <ShortcutKey variant={shortcutKeyVariant}>{'F'}</ShortcutKey>\r\n        </span>\r\n    );\r\n};\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback} from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\nimport {useDispatch} from 'react-redux';\r\n\r\nimport {FolderPlusOutlineIcon} from '@mattermost/compass-icons/components';\r\n\r\nimport {openModal} from 'actions/views/modals';\r\n\r\nimport EditCategoryModal from 'components/edit_category_modal';\r\nimport * as Menu from 'components/menu';\r\n\r\nimport {ModalIdentifiers} from 'utils/constants';\r\n\r\ntype Props = {\r\n    id: string;\r\n}\r\n\r\nconst CreateNewCategoryMenuItem = ({\r\n    id,\r\n    ...otherProps\r\n}: Props) => {\r\n    const dispatch = useDispatch();\r\n    const handleCreateCategory = useCallback(() => {\r\n        dispatch(openModal({\r\n            modalId: ModalIdentifiers.EDIT_CATEGORY,\r\n            dialogType: EditCategoryModal,\r\n        }));\r\n    }, [dispatch]);\r\n\r\n    return (\r\n        <Menu.Item\r\n            id={`create-${id}`}\r\n            onClick={handleCreateCategory}\r\n            aria-haspopup={true}\r\n            leadingElement={<FolderPlusOutlineIcon size={18}/>}\r\n            labels={(\r\n                <FormattedMessage\r\n                    id='sidebar_left.sidebar_category_menu.createCategory'\r\n                    defaultMessage='Create New Category'\r\n                />\r\n            )}\r\n            {...otherProps}\r\n        />\r\n    );\r\n};\r\n\r\nexport default CreateNewCategoryMenuItem;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nimport {GenericModal} from '@mattermost/components';\r\n\r\nimport 'components/category_modal.scss';\r\n\r\ntype Props = {\r\n    handleConfirm: () => void;\r\n    numChannels: number;\r\n    onExited: () => void;\r\n};\r\n\r\nconst handleCancel = () => null;\r\n\r\nconst MarkAsReadConfirmModal = ({\r\n    handleConfirm,\r\n    numChannels,\r\n    onExited,\r\n}: Props) => {\r\n    const intl = useIntl();\r\n\r\n    const header = intl.formatMessage({id: 'mark_as_read_confirm_modal.header', defaultMessage: 'Mark as read'});\r\n    const body = intl.formatMessage({id: 'mark_as_read_confirm_modal.body', defaultMessage: 'Are you sure you want to mark {numChannels} channels as read?'}, {numChannels});\r\n    const confirm = intl.formatMessage({id: 'mark_as_read_confirm_modal.confirm', defaultMessage: 'Mark as read'});\r\n\r\n    return (\r\n        <GenericModal\r\n            ariaLabel={header}\r\n            compassDesign={true}\r\n            modalHeaderText={header}\r\n            handleConfirm={handleConfirm}\r\n            handleCancel={handleCancel}\r\n            onExited={onExited}\r\n            confirmButtonText={confirm}\r\n        >\r\n            <span className='mark-as-read__helpText'>\r\n                {body}\r\n            </span>\r\n        </GenericModal>\r\n    );\r\n};\r\n\r\nexport default MarkAsReadConfirmModal;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback} from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\nimport {useDispatch} from 'react-redux';\r\n\r\nimport {MarkAsUnreadIcon} from '@mattermost/compass-icons/components';\r\n\r\nimport {openModal} from 'actions/views/modals';\r\n\r\nimport * as Menu from 'components/menu';\r\n\r\nimport {ModalIdentifiers} from 'utils/constants';\r\n\r\nimport MarkAsReadConfirmModal from './mark_as_read_confirm_modal';\r\n\r\ntype Props = {\r\n    id: string;\r\n    handleViewCategory: () => void;\r\n    numChannels: number;\r\n}\r\n\r\nconst MarkAsUnreadItem = ({\r\n    id,\r\n    handleViewCategory,\r\n    numChannels,\r\n    ...otherProps\r\n}: Props) => {\r\n    const dispatch = useDispatch();\r\n\r\n    const onClick = useCallback(() => {\r\n        if (numChannels <= 0) {\r\n            return;\r\n        }\r\n\r\n        if (numChannels === 1) {\r\n            handleViewCategory();\r\n            return;\r\n        }\r\n\r\n        dispatch(openModal({\r\n            modalId: ModalIdentifiers.DELETE_CATEGORY,\r\n            dialogType: MarkAsReadConfirmModal,\r\n            dialogProps: {\r\n                handleConfirm: handleViewCategory,\r\n                numChannels,\r\n            },\r\n        }));\r\n    }, [dispatch, handleViewCategory, numChannels]);\r\n\r\n    return (\r\n        <Menu.Item\r\n            id={`view-${id}`}\r\n            onClick={onClick}\r\n            aria-haspopup={numChannels > 1}\r\n            leadingElement={<MarkAsUnreadIcon size={18}/>}\r\n            labels={(\r\n                <FormattedMessage\r\n                    id='sidebar_left.sidebar_category_menu.viewCategory'\r\n                    defaultMessage='Mark category as read'\r\n                />\r\n            )}\r\n            {...otherProps}\r\n        />\r\n    );\r\n};\r\n\r\nexport default MarkAsUnreadItem;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React, {memo, useState} from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nimport {\r\n    DotsVerticalIcon,\r\n} from '@mattermost/compass-icons/components';\r\n\r\nimport * as Menu from 'components/menu';\r\n\r\ntype Props = {\r\n    id: string;\r\n    children: React.ReactNode[];\r\n    name: string;\r\n};\r\n\r\nconst SidebarCategoryGenericMenu = ({\r\n    id,\r\n    children,\r\n    name,\r\n}: Props) => {\r\n    const [isMenuOpen, setIsMenuOpen] = useState(false);\r\n\r\n    const {formatMessage} = useIntl();\r\n\r\n    function handleMenuToggle(isOpen: boolean) {\r\n        setIsMenuOpen(isOpen);\r\n    }\r\n\r\n    return (\r\n        <div\r\n            className={classNames(\r\n                'SidebarMenu',\r\n                'MenuWrapper',\r\n                {\r\n                    'MenuWrapper--open': isMenuOpen,\r\n                    menuOpen: isMenuOpen,\r\n                },\r\n            )}\r\n        >\r\n            <Menu.Container\r\n                menuButton={{\r\n                    id: `SidebarCategoryMenu-Button-${id}`,\r\n                    'aria-label': formatMessage({id: 'sidebar_left.sidebar_category_menu.editCategory', defaultMessage: 'Category options'}, {name}),\r\n                    class: 'SidebarMenu_menuButton',\r\n                    children: <DotsVerticalIcon size={16}/>,\r\n                }}\r\n                menuButtonTooltip={{\r\n                    text: formatMessage({id: 'sidebar_left.sidebar_category_menu.editCategory', defaultMessage: 'Category options'}, {name}),\r\n                    class: 'hidden-xs',\r\n                }}\r\n                menu={{\r\n                    id: `SidebarChannelMenu-MenuList-${id}`,\r\n                    'aria-label': formatMessage({id: 'sidebar_left.sidebar_category_menu.dropdownAriaLabel', defaultMessage: 'Edit category menu'}),\r\n                    onToggle: handleMenuToggle,\r\n                }}\r\n            >\r\n                {children}\r\n            </Menu.Container>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default memo(SidebarCategoryGenericMenu);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\nimport type {DraggableProvidedDragHandleProps} from 'react-beautiful-dnd';\r\n\r\nimport {wrapEmojis} from 'utils/emoji_utils';\r\n\r\ntype StaticProps = {\r\n    children?: React.ReactNode;\r\n    displayName: string;\r\n}\r\n\r\nexport const SidebarCategoryHeaderStatic = React.forwardRef((props: StaticProps, ref?: React.Ref<HTMLDivElement>) => {\r\n    return (\r\n        <div className='SidebarChannelGroupHeader SidebarChannelGroupHeader--static'>\r\n            <div\r\n                ref={ref}\r\n                className='SidebarChannelGroupHeader_groupButton'\r\n            >\r\n                <div className='SidebarChannelGroupHeader_text'>\r\n                    {wrapEmojis(props.displayName)}\r\n                </div>\r\n                {props.children}\r\n            </div>\r\n        </div>\r\n    );\r\n});\r\nSidebarCategoryHeaderStatic.displayName = 'SidebarCategoryHeaderStatic';\r\n\r\ntype Props = StaticProps & {\r\n    dragHandleProps?: DraggableProvidedDragHandleProps;\r\n    isCollapsed: boolean;\r\n    isCollapsible: boolean;\r\n    isDragging?: boolean;\r\n    isDraggingOver?: boolean;\r\n    muted: boolean;\r\n    onClick: (event: React.MouseEvent<HTMLElement>) => void;\r\n}\r\n\r\nexport const SidebarCategoryHeader = React.forwardRef(({\r\n    children,\r\n    displayName,\r\n    dragHandleProps,\r\n    isCollapsed,\r\n    isCollapsible = true,\r\n    isDragging = false,\r\n    muted,\r\n    onClick,\r\n}: Props, ref?: React.Ref<HTMLButtonElement>) => {\r\n    // (Accessibility) Ensures interactive controls are not nested as they are not always announced\r\n    // by screen readers or can cause focus problems for assistive technologies.\r\n    if (dragHandleProps && dragHandleProps.role) {\r\n        Reflect.deleteProperty(dragHandleProps, 'role');\r\n    }\r\n\r\n    return (\r\n        <div\r\n            className={classNames('SidebarChannelGroupHeader', {\r\n                muted,\r\n                dragging: isDragging,\r\n            })}\r\n        >\r\n            <button\r\n                ref={ref}\r\n                className={classNames('SidebarChannelGroupHeader_groupButton')}\r\n                aria-label={displayName}\r\n                onClick={onClick}\r\n                aria-expanded={!isCollapsed}\r\n            >\r\n                <i\r\n                    className={classNames('icon icon-chevron-down', {\r\n                        'icon-rotate-minus-90': isCollapsed,\r\n                        'hide-arrow': !isCollapsible,\r\n                    })}\r\n                />\r\n                <div\r\n                    className='SidebarChannelGroupHeader_text'\r\n                    {...dragHandleProps}\r\n                    tabIndex={-1}\r\n                >\r\n                    {wrapEmojis(displayName)}\r\n                </div>\r\n            </button>\r\n            {children}\r\n        </div>\r\n    );\r\n});\r\nSidebarCategoryHeader.displayName = 'SidebarCategoryHeader';\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\n\r\ntype Props = {\r\n    unreadMentions: number;\r\n    hasUrgent?: boolean;\r\n    icon?: React.ReactNode;\r\n    className?: string;\r\n};\r\n\r\nexport default function ChannelMentionBadge({unreadMentions, hasUrgent, icon, className}: Props) {\r\n    if (unreadMentions > 0) {\r\n        return (\r\n            <span\r\n                id='unreadMentions'\r\n                className={classNames({badge: true, urgent: hasUrgent}, className)}\r\n            >\r\n                {icon}\r\n                <span className='unreadMentions'>\r\n                    {unreadMentions}\r\n                </span>\r\n            </span>\r\n        );\r\n    }\r\n\r\n    return null;\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {memo} from 'react';\r\n\r\nimport './channel_pencil_icon.scss';\r\n\r\ntype Props = {\r\n    hasDraft: boolean;\r\n};\r\n\r\nfunction ChannelPencilIcon({hasDraft}: Props) {\r\n    if (hasDraft) {\r\n        return (\r\n            <i\r\n                data-testid='draftIcon'\r\n                className='icon icon-pencil-outline channel-pencil-icon'\r\n            />\r\n        );\r\n    }\r\n    return null;\r\n}\r\n\r\nexport default memo(ChannelPencilIcon);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\n\r\nimport {getCurrentChannelId} from 'mattermost-redux/selectors/entities/channels';\r\n\r\nimport {getPostDraft} from 'selectors/rhs';\r\n\r\nimport {StoragePrefixes} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\nimport type {PostDraft} from 'types/store/draft';\r\n\r\nimport ChannelPencilIcon from './channel_pencil_icon';\r\n\r\ntype OwnProps = {\r\n    id: Channel['id'];\r\n}\r\n\r\nfunction hasDraft(draft: PostDraft|null, id: Channel['id'], currentChannelId?: string): boolean {\r\n    if (draft === null) {\r\n        return false;\r\n    }\r\n\r\n    return Boolean(draft.message.trim() || draft.fileInfos.length || draft.uploadsInProgress.length) && currentChannelId !== id;\r\n}\r\n\r\nfunction mapStateToProps(state: GlobalState, ownProps: OwnProps) {\r\n    const currentChannelId = getCurrentChannelId(state);\r\n    const draft = getPostDraft(state, StoragePrefixes.DRAFT, ownProps.id);\r\n\r\n    return {\r\n        hasDraft: hasDraft(draft, ownProps.id, currentChannelId),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps)(ChannelPencilIcon);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\n\r\ntype Props = {\r\n    icon: JSX.Element | null;\r\n    isDeleted: boolean;\r\n};\r\n\r\nfunction SidebarChannelIcon({isDeleted, icon}: Props) {\r\n    if (isDeleted) {\r\n        return (\r\n            <i className='icon icon-archive-outline'/>\r\n        );\r\n    }\r\n    return icon;\r\n}\r\n\r\nexport default SidebarChannelIcon;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useRef, memo} from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\n\r\nimport {\r\n    MarkAsUnreadIcon,\r\n    StarIcon,\r\n    StarOutlineIcon,\r\n    BellOutlineIcon,\r\n    BellOffOutlineIcon,\r\n    LinkVariantIcon,\r\n    AccountPlusOutlineIcon,\r\n    DotsVerticalIcon,\r\n    ExitToAppIcon,\r\n} from '@mattermost/compass-icons/components';\r\n\r\nimport ChannelInviteModal from 'components/channel_invite_modal';\r\nimport ChannelMoveToSubmenu from 'components/channel_move_to_sub_menu';\r\nimport * as Menu from 'components/menu';\r\n\r\nimport Constants, {ModalIdentifiers} from 'utils/constants';\r\nimport {copyToClipboard} from 'utils/utils';\r\n\r\nimport type {PropsFromRedux, OwnProps} from './index';\r\n\r\ntype Props = PropsFromRedux & OwnProps;\r\n\r\nconst SidebarChannelMenu = ({\r\n    channel,\r\n    channelLink,\r\n    currentUserId,\r\n    favoriteChannel,\r\n    isFavorite,\r\n    isMuted,\r\n    isUnread,\r\n    managePrivateChannelMembers,\r\n    managePublicChannelMembers,\r\n    readMultipleChannels,\r\n    markMostRecentPostInChannelAsUnread,\r\n    muteChannel,\r\n    onMenuToggle,\r\n    openModal,\r\n    unfavoriteChannel,\r\n    unmuteChannel,\r\n    channelLeaveHandler,\r\n}: Props) => {\r\n    const isLeaving = useRef(false);\r\n\r\n    const {formatMessage} = useIntl();\r\n\r\n    let markAsReadUnreadMenuItem: JSX.Element | null = null;\r\n    if (isUnread) {\r\n        function handleMarkAsRead() {\r\n            // We use mark multiple to not update the active channel in the server\r\n            readMultipleChannels([channel.id]);\r\n        }\r\n\r\n        markAsReadUnreadMenuItem = (\r\n            <Menu.Item\r\n                id={`markAsRead-${channel.id}`}\r\n                onClick={handleMarkAsRead}\r\n                leadingElement={<MarkAsUnreadIcon size={18}/>}\r\n                labels={(\r\n                    <FormattedMessage\r\n                        id='sidebar_left.sidebar_channel_menu.markAsRead'\r\n                        defaultMessage='Mark as Read'\r\n                    />\r\n                )}\r\n            />\r\n\r\n        );\r\n    } else {\r\n        function handleMarkAsUnread() {\r\n            markMostRecentPostInChannelAsUnread(channel.id);\r\n        }\r\n\r\n        markAsReadUnreadMenuItem = (\r\n            <Menu.Item\r\n                id={`markAsUnread-${channel.id}`}\r\n                onClick={handleMarkAsUnread}\r\n                leadingElement={<MarkAsUnreadIcon size={18}/>}\r\n                labels={(\r\n                    <FormattedMessage\r\n                        id='sidebar_left.sidebar_channel_menu.markAsUnread'\r\n                        defaultMessage='Mark as Unread'\r\n                    />\r\n                )}\r\n            />\r\n        );\r\n    }\r\n\r\n    let favoriteUnfavoriteMenuItem: JSX.Element | null = null;\r\n    if (isFavorite) {\r\n        function handleUnfavoriteChannel() {\r\n            unfavoriteChannel(channel.id);\r\n        }\r\n\r\n        favoriteUnfavoriteMenuItem = (\r\n            <Menu.Item\r\n                id={`unfavorite-${channel.id}`}\r\n                onClick={handleUnfavoriteChannel}\r\n                leadingElement={<StarIcon size={18}/>}\r\n                labels={(\r\n                    <FormattedMessage\r\n                        id='sidebar_left.sidebar_channel_menu.unfavoriteChannel'\r\n                        defaultMessage='Unfavorite'\r\n                    />\r\n                )}\r\n            />\r\n        );\r\n    } else {\r\n        function handleFavoriteChannel() {\r\n            favoriteChannel(channel.id);\r\n        }\r\n\r\n        favoriteUnfavoriteMenuItem = (\r\n\r\n            <Menu.Item\r\n                id={`favorite-${channel.id}`}\r\n                onClick={handleFavoriteChannel}\r\n                leadingElement={<StarOutlineIcon size={18}/>}\r\n                labels={(\r\n                    <FormattedMessage\r\n                        id='sidebar_left.sidebar_channel_menu.favoriteChannel'\r\n                        defaultMessage='Favorite'\r\n                    />\r\n                )}\r\n            />\r\n        );\r\n    }\r\n\r\n    let muteUnmuteChannelMenuItem: JSX.Element | null = null;\r\n    if (isMuted) {\r\n        let muteChannelText = (\r\n            <FormattedMessage\r\n                id='sidebar_left.sidebar_channel_menu.unmuteChannel'\r\n                defaultMessage='Unmute Channel'\r\n            />\r\n        );\r\n        if (channel.type === Constants.DM_CHANNEL || channel.type === Constants.GM_CHANNEL) {\r\n            muteChannelText = (\r\n                <FormattedMessage\r\n                    id='sidebar_left.sidebar_channel_menu.unmute'\r\n                    defaultMessage='Unmute'\r\n                />\r\n            );\r\n        }\r\n\r\n        function handleUnmuteChannel() {\r\n            unmuteChannel(currentUserId, channel.id);\r\n        }\r\n\r\n        muteUnmuteChannelMenuItem = (\r\n            <Menu.Item\r\n                id={`unmute-${channel.id}`}\r\n                onClick={handleUnmuteChannel}\r\n                leadingElement={<BellOffOutlineIcon size={18}/>}\r\n                labels={muteChannelText}\r\n            />\r\n        );\r\n    } else {\r\n        let muteChannelText = (\r\n            <FormattedMessage\r\n                id='sidebar_left.sidebar_channel_menu.muteChannel'\r\n                defaultMessage='Mute Channel'\r\n            />\r\n        );\r\n        if (channel.type === Constants.DM_CHANNEL || channel.type === Constants.GM_CHANNEL) {\r\n            muteChannelText = (\r\n                <FormattedMessage\r\n                    id='sidebar_left.sidebar_channel_menu.mute'\r\n                    defaultMessage='Mute'\r\n                />\r\n            );\r\n        }\r\n\r\n        function handleMuteChannel() {\r\n            muteChannel(currentUserId, channel.id);\r\n        }\r\n\r\n        muteUnmuteChannelMenuItem = (\r\n            <Menu.Item\r\n                id={`mute-${channel.id}`}\r\n                onClick={handleMuteChannel}\r\n                leadingElement={<BellOutlineIcon size={18}/>}\r\n                labels={muteChannelText}\r\n            />\r\n        );\r\n    }\r\n\r\n    let copyLinkMenuItem: JSX.Element | null = null;\r\n    if (channel.type === Constants.OPEN_CHANNEL || channel.type === Constants.PRIVATE_CHANNEL) {\r\n        function handleCopyLink() {\r\n            copyToClipboard(channelLink);\r\n        }\r\n\r\n        copyLinkMenuItem = (\r\n            <Menu.Item\r\n                id={`copyLink-${channel.id}`}\r\n                onClick={handleCopyLink}\r\n                leadingElement={<LinkVariantIcon size={18}/>}\r\n                labels={(\r\n                    <FormattedMessage\r\n                        id='sidebar_left.sidebar_channel_menu.copyLink'\r\n                        defaultMessage='Copy Link'\r\n                    />\r\n                )}\r\n            />\r\n        );\r\n    }\r\n\r\n    let addMembersMenuItem: JSX.Element | null = null;\r\n    if ((channel.type === Constants.PRIVATE_CHANNEL && managePrivateChannelMembers) || (channel.type === Constants.OPEN_CHANNEL && managePublicChannelMembers)) {\r\n        function handleAddMembers() {\r\n            openModal({\r\n                modalId: ModalIdentifiers.CHANNEL_INVITE,\r\n                dialogType: ChannelInviteModal,\r\n                dialogProps: {channel},\r\n            });\r\n        }\r\n\r\n        addMembersMenuItem = (\r\n            <Menu.Item\r\n                id={`addMembers-${channel.id}`}\r\n                onClick={handleAddMembers}\r\n                aria-haspopup='true'\r\n                leadingElement={<AccountPlusOutlineIcon size={18}/>}\r\n                labels={(\r\n                    <FormattedMessage\r\n                        id='sidebar_left.sidebar_channel_menu.addMembers'\r\n                        defaultMessage='Add Members'\r\n                    />\r\n                )}\r\n            />\r\n        );\r\n    }\r\n\r\n    let leaveChannelMenuItem: JSX.Element | null = null;\r\n    if (channel.name !== Constants.DEFAULT_CHANNEL) {\r\n        let leaveChannelText = (\r\n            <FormattedMessage\r\n                id='sidebar_left.sidebar_channel_menu.leaveChannel'\r\n                defaultMessage='Leave Channel'\r\n            />\r\n        );\r\n        if (channel.type === Constants.DM_CHANNEL || channel.type === Constants.GM_CHANNEL) {\r\n            leaveChannelText = (\r\n                <FormattedMessage\r\n                    id='sidebar_left.sidebar_channel_menu.leaveConversation'\r\n                    defaultMessage='Close Conversation'\r\n                />\r\n            );\r\n        }\r\n\r\n        function handleLeaveChannel() {\r\n            if (isLeaving.current || !channelLeaveHandler) {\r\n                return;\r\n            }\r\n\r\n            isLeaving.current = true;\r\n\r\n            channelLeaveHandler(() => {\r\n                isLeaving.current = false;\r\n            });\r\n        }\r\n\r\n        leaveChannelMenuItem = (\r\n            <Menu.Item\r\n                id={`leave-${channel.id}`}\r\n                onClick={handleLeaveChannel}\r\n                leadingElement={<ExitToAppIcon size={18}/>}\r\n                labels={leaveChannelText}\r\n                isDestructive={true}\r\n            />\r\n        );\r\n    }\r\n\r\n    return (\r\n        <Menu.Container\r\n            menuButton={{\r\n                id: `SidebarChannelMenu-Button-${channel.id}`,\r\n                class: 'SidebarMenu_menuButton',\r\n                'aria-label': formatMessage({\r\n                    id: 'sidebar_left.sidebar_channel_menu.editChannel.ariaLabel',\r\n                    defaultMessage: 'Channel options for {channelName}',\r\n                }, {channelName: channel.name}),\r\n                children: <DotsVerticalIcon size={16}/>,\r\n            }}\r\n            menuButtonTooltip={{\r\n                class: 'hidden-xs',\r\n                text: formatMessage({id: 'sidebar_left.sidebar_channel_menu.editChannel', defaultMessage: 'Channel options'}),\r\n            }}\r\n            menu={{\r\n                id: `SidebarChannelMenu-MenuList-${channel.id}`,\r\n                'aria-label': formatMessage({id: 'sidebar_left.sidebar_channel_menu.dropdownAriaLabel', defaultMessage: 'Edit channel menu'}),\r\n                onToggle: onMenuToggle,\r\n            }}\r\n        >\r\n            {markAsReadUnreadMenuItem}\r\n            {favoriteUnfavoriteMenuItem}\r\n            {muteUnmuteChannelMenuItem}\r\n            <Menu.Separator/>\r\n            <ChannelMoveToSubmenu channel={channel}/>\r\n            {(copyLinkMenuItem || addMembersMenuItem) && <Menu.Separator/>}\r\n            {copyLinkMenuItem}\r\n            {addMembersMenuItem}\r\n            {leaveChannelMenuItem && <Menu.Separator/>}\r\n            {leaveChannelMenuItem}\r\n        </Menu.Container>\r\n    );\r\n};\r\n\r\nexport default memo(SidebarChannelMenu);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport type {ConnectedProps} from 'react-redux';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\n\r\nimport {favoriteChannel, unfavoriteChannel, readMultipleChannels} from 'mattermost-redux/actions/channels';\r\nimport Permissions from 'mattermost-redux/constants/permissions';\r\nimport {isFavoriteChannel} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getMyChannelMemberships, getCurrentUserId} from 'mattermost-redux/selectors/entities/common';\r\nimport {haveIChannelPermission} from 'mattermost-redux/selectors/entities/roles';\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\nimport {isChannelMuted} from 'mattermost-redux/utils/channel_utils';\r\n\r\nimport {unmuteChannel, muteChannel} from 'actions/channel_actions';\r\nimport {markMostRecentPostInChannelAsUnread} from 'actions/post_actions';\r\nimport {openModal} from 'actions/views/modals';\r\n\r\nimport {getSiteURL} from 'utils/url';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport SidebarChannelMenu from './sidebar_channel_menu';\r\n\r\nexport type OwnProps = {\r\n    channel: Channel;\r\n    channelLink: string;\r\n    isUnread: boolean;\r\n    channelLeaveHandler?: (callback: () => void) => void;\r\n    onMenuToggle: (open: boolean) => void;\r\n}\r\n\r\nfunction mapStateToProps(state: GlobalState, ownProps: OwnProps) {\r\n    const member = getMyChannelMemberships(state)[ownProps.channel.id];\r\n    const currentTeam = getCurrentTeam(state);\r\n\r\n    let managePublicChannelMembers = false;\r\n    let managePrivateChannelMembers = false;\r\n\r\n    if (currentTeam) {\r\n        managePublicChannelMembers = haveIChannelPermission(state, currentTeam.id, ownProps.channel.id, Permissions.MANAGE_PUBLIC_CHANNEL_MEMBERS);\r\n        managePrivateChannelMembers = haveIChannelPermission(state, currentTeam.id, ownProps.channel.id, Permissions.MANAGE_PRIVATE_CHANNEL_MEMBERS);\r\n    }\r\n\r\n    return {\r\n        currentUserId: getCurrentUserId(state),\r\n        isFavorite: isFavoriteChannel(state, ownProps.channel.id),\r\n        isMuted: isChannelMuted(member),\r\n        channelLink: `${getSiteURL()}${ownProps.channelLink}`,\r\n        managePublicChannelMembers,\r\n        managePrivateChannelMembers,\r\n    };\r\n}\r\n\r\nconst mapDispatchToProps = {\r\n    readMultipleChannels,\r\n    markMostRecentPostInChannelAsUnread,\r\n    favoriteChannel,\r\n    unfavoriteChannel,\r\n    muteChannel,\r\n    unmuteChannel,\r\n    openModal,\r\n};\r\n\r\nconst connector = connect(mapStateToProps, mapDispatchToProps);\r\n\r\nexport type PropsFromRedux = ConnectedProps<typeof connector>;\r\n\r\nexport default connector(SidebarChannelMenu);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\nimport {type WrappedComponentProps, injectIntl} from 'react-intl';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\n\r\nimport {mark} from 'actions/telemetry_actions';\r\n\r\nimport CustomStatusEmoji from 'components/custom_status/custom_status_emoji';\r\nimport SharedChannelIndicator from 'components/shared_channel_indicator';\r\nimport {ChannelsAndDirectMessagesTour} from 'components/tours/onboarding_tour';\r\nimport WithTooltip from 'components/with_tooltip';\r\n\r\nimport Pluggable from 'plugins/pluggable';\r\nimport Constants, {RHSStates} from 'utils/constants';\r\nimport {wrapEmojis} from 'utils/emoji_utils';\r\nimport {cmdOrCtrlPressed} from 'utils/keyboard';\r\nimport {Mark} from 'utils/performance_telemetry';\r\n\r\nimport type {RhsState} from 'types/store/rhs';\r\n\r\nimport ChannelMentionBadge from '../channel_mention_badge';\r\nimport ChannelPencilIcon from '../channel_pencil_icon';\r\nimport SidebarChannelIcon from '../sidebar_channel_icon';\r\nimport SidebarChannelMenu from '../sidebar_channel_menu';\r\n\r\ntype Props = WrappedComponentProps & {\r\n    channel: Channel;\r\n    link: string;\r\n    label: string;\r\n    ariaLabelPrefix?: string;\r\n    channelLeaveHandler?: (callback: () => void) => void;\r\n    icon: JSX.Element | null;\r\n\r\n    /**\r\n     * Number of unread mentions in this channel\r\n     */\r\n    unreadMentions: number;\r\n\r\n    /**\r\n     * Whether or not the channel is shown as unread\r\n     */\r\n    isUnread: boolean;\r\n\r\n    /**\r\n     * Checks if the current channel is muted\r\n     */\r\n    isMuted: boolean;\r\n\r\n    isChannelSelected: boolean;\r\n\r\n    teammateId?: string;\r\n\r\n    firstChannelName?: string;\r\n\r\n    showChannelsTutorialStep: boolean;\r\n\r\n    hasUrgent: boolean;\r\n    rhsState?: RhsState;\r\n    rhsOpen?: boolean;\r\n    isSharedChannel?: boolean;\r\n    remoteNames: string[];\r\n\r\n    actions: {\r\n        markMostRecentPostInChannelAsUnread: (channelId: string) => void;\r\n        clearChannelSelection: () => void;\r\n        multiSelectChannelTo: (channelId: string) => void;\r\n        multiSelectChannelAdd: (channelId: string) => void;\r\n        unsetEditingPost: () => void;\r\n        closeRightHandSide: () => void;\r\n        fetchChannelRemotes: (channelId: string) => void;\r\n    };\r\n};\r\n\r\ntype State = {\r\n    isMenuOpen: boolean;\r\n    showTooltip: boolean;\r\n};\r\n\r\nexport class SidebarChannelLink extends React.PureComponent<Props, State> {\r\n    labelRef: React.RefObject<HTMLDivElement>;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.labelRef = React.createRef();\r\n\r\n        this.state = {\r\n            isMenuOpen: false,\r\n            showTooltip: false,\r\n        };\r\n    }\r\n\r\n    componentDidMount(): void {\r\n        this.enableToolTipIfNeeded();\r\n\r\n        if (this.props.isSharedChannel && this.props.channel?.id && this.props.remoteNames.length === 0) {\r\n            this.props.actions.fetchChannelRemotes(this.props.channel.id);\r\n        }\r\n    }\r\n\r\n    componentDidUpdate(prevProps: Props): void {\r\n        if (prevProps.label !== this.props.label) {\r\n            this.enableToolTipIfNeeded();\r\n        }\r\n\r\n        if (this.props.isSharedChannel &&\r\n            (prevProps.channel?.id !== this.props.channel?.id || prevProps.channel?.team_id !== this.props.channel?.team_id) &&\r\n            this.props.remoteNames.length === 0 &&\r\n            this.props.channel?.id) {\r\n            this.props.actions.fetchChannelRemotes(this.props.channel.id);\r\n        }\r\n    }\r\n\r\n    enableToolTipIfNeeded = (): void => {\r\n        const element = this.labelRef.current;\r\n        const showTooltip = element && element.offsetWidth < element.scrollWidth;\r\n        this.setState({showTooltip: Boolean(showTooltip)});\r\n    };\r\n\r\n    getAriaLabel = (): string => {\r\n        const {label, ariaLabelPrefix, unreadMentions, intl} = this.props;\r\n\r\n        let ariaLabel = label;\r\n\r\n        if (ariaLabelPrefix) {\r\n            ariaLabel += ` ${ariaLabelPrefix}`;\r\n        }\r\n\r\n        if (unreadMentions === 1) {\r\n            ariaLabel += ` ${unreadMentions} ${intl.formatMessage({id: 'accessibility.sidebar.types.mention', defaultMessage: 'mention'})}`;\r\n        } else if (unreadMentions > 1) {\r\n            ariaLabel += ` ${unreadMentions} ${intl.formatMessage({id: 'accessibility.sidebar.types.mentions', defaultMessage: 'mentions'})}`;\r\n        }\r\n\r\n        if (this.props.isUnread && unreadMentions === 0) {\r\n            ariaLabel += ` ${intl.formatMessage({id: 'accessibility.sidebar.types.unread', defaultMessage: 'unread'})}`;\r\n        }\r\n\r\n        return ariaLabel.toLowerCase();\r\n    };\r\n\r\n    handleChannelClick = (event: React.MouseEvent<HTMLAnchorElement>): void => {\r\n        mark(Mark.ChannelLinkClicked);\r\n        this.handleSelectChannel(event);\r\n\r\n        if (this.props.rhsOpen && this.props.rhsState === RHSStates.EDIT_HISTORY) {\r\n            this.props.actions.closeRightHandSide();\r\n        }\r\n    };\r\n\r\n    handleSelectChannel = (event: React.MouseEvent<HTMLAnchorElement>): void => {\r\n        if (event.defaultPrevented || event.button !== 0) {\r\n            return;\r\n        }\r\n\r\n        if (cmdOrCtrlPressed(event as unknown as React.KeyboardEvent)) {\r\n            event.preventDefault();\r\n            this.props.actions.multiSelectChannelAdd(this.props.channel.id);\r\n        } else if (event.shiftKey) {\r\n            event.preventDefault();\r\n            this.props.actions.multiSelectChannelTo(this.props.channel.id);\r\n        } else if (event.altKey && !this.props.isUnread) {\r\n            event.preventDefault();\r\n            this.props.actions.markMostRecentPostInChannelAsUnread(this.props.channel.id);\r\n        } else {\r\n            this.props.actions.clearChannelSelection();\r\n        }\r\n    };\r\n\r\n    handleMenuToggle = (isMenuOpen: boolean) => {\r\n        this.setState({isMenuOpen});\r\n    };\r\n\r\n    render(): JSX.Element {\r\n        const {\r\n            channel,\r\n            icon,\r\n            isChannelSelected,\r\n            isMuted,\r\n            isUnread,\r\n            label,\r\n            link,\r\n            unreadMentions,\r\n            firstChannelName,\r\n            showChannelsTutorialStep,\r\n            hasUrgent,\r\n        } = this.props;\r\n\r\n        let channelsTutorialTip: JSX.Element | null = null;\r\n\r\n        // firstChannelName is based on channel.name,\r\n        // but we want to display `display_name` to the user, so we check against `.name` for channel equality but pass in the .display_name value\r\n        if (firstChannelName === channel.name || (!firstChannelName && showChannelsTutorialStep && channel.name === Constants.DEFAULT_CHANNEL)) {\r\n            channelsTutorialTip = firstChannelName ? (<ChannelsAndDirectMessagesTour firstChannelName={channel.display_name}/>) : <ChannelsAndDirectMessagesTour/>;\r\n        }\r\n\r\n        let labelElement: JSX.Element = (\r\n            <span\r\n                ref={this.labelRef}\r\n                className='SidebarChannelLinkLabel'\r\n            >\r\n                {wrapEmojis(label)}\r\n            </span>\r\n        );\r\n        if (this.state.showTooltip) {\r\n            labelElement = (\r\n                <WithTooltip\r\n                    title={label}\r\n                >\r\n                    {labelElement}\r\n                </WithTooltip>\r\n            );\r\n        }\r\n\r\n        const customStatus = this.props.teammateId ? (\r\n            <CustomStatusEmoji\r\n                userID={this.props.teammateId}\r\n                showTooltip={true}\r\n                spanStyle={{\r\n                    height: 18,\r\n                }}\r\n                emojiStyle={{\r\n                    marginTop: -4,\r\n                    marginBottom: 0,\r\n                    opacity: 0.8,\r\n                }}\r\n            />\r\n        ) : null;\r\n\r\n        const sharedChannelIcon = this.props.isSharedChannel ? (\r\n            <SharedChannelIndicator\r\n                className='icon'\r\n                withTooltip={true}\r\n                remoteNames={this.props.remoteNames}\r\n            />\r\n        ) : null;\r\n\r\n        const content = (\r\n            <>\r\n                <SidebarChannelIcon\r\n                    isDeleted={channel.delete_at !== 0}\r\n                    icon={icon}\r\n                />\r\n                <div\r\n                    className='SidebarChannelLinkLabel_wrapper'\r\n                >\r\n                    {labelElement}\r\n                    {customStatus}\r\n                    <Pluggable\r\n                        pluggableName='SidebarChannelLinkLabel'\r\n                        channel={this.props.channel}\r\n                    />\r\n                    {sharedChannelIcon}\r\n                </div>\r\n                <ChannelPencilIcon id={channel.id}/>\r\n                <ChannelMentionBadge\r\n                    unreadMentions={unreadMentions}\r\n                    hasUrgent={hasUrgent}\r\n                />\r\n                <div\r\n                    className={classNames(\r\n                        'SidebarMenu',\r\n                        'MenuWrapper',\r\n                        {menuOpen: this.state.isMenuOpen},\r\n                        {'MenuWrapper--open': this.state.isMenuOpen},\r\n                    )}\r\n                >\r\n                    <SidebarChannelMenu\r\n                        channel={channel}\r\n                        channelLink={link}\r\n                        isUnread={isUnread}\r\n                        channelLeaveHandler={this.props.channelLeaveHandler}\r\n                        onMenuToggle={this.handleMenuToggle}\r\n                    />\r\n                </div>\r\n            </>\r\n        );\r\n\r\n        // NOTE: class added to temporarily support the desktop app's at-mention DOM scraping of the old sidebar\r\n        const className = classNames([\r\n            'SidebarLink',\r\n            {\r\n                menuOpen: this.state.isMenuOpen,\r\n                muted: isMuted,\r\n                'unread-title': this.props.isUnread,\r\n                selected: isChannelSelected,\r\n            },\r\n        ]);\r\n        return (\r\n            <Link\r\n                className={className}\r\n                id={`sidebarItem_${channel.name}`}\r\n                aria-label={this.getAriaLabel()}\r\n                to={link}\r\n                onClick={this.handleChannelClick}\r\n                tabIndex={0}\r\n            >\r\n                {content}\r\n                {channelsTutorialTip}\r\n            </Link>\r\n        );\r\n    }\r\n}\r\n\r\nexport default injectIntl(SidebarChannelLink);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\n\r\nimport {fetchChannelRemotes} from 'mattermost-redux/actions/shared_channels';\r\nimport {makeGetChannelUnreadCount} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getCurrentUserId, getMyChannelMemberships} from 'mattermost-redux/selectors/entities/common';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {getInt} from 'mattermost-redux/selectors/entities/preferences';\r\nimport {getRemoteNamesForChannel} from 'mattermost-redux/selectors/entities/shared_channels';\r\nimport {isChannelMuted} from 'mattermost-redux/utils/channel_utils';\r\n\r\nimport {markMostRecentPostInChannelAsUnread, unsetEditingPost} from 'actions/post_actions';\r\nimport {clearChannelSelection, multiSelectChannelAdd, multiSelectChannelTo} from 'actions/views/channel_sidebar';\r\nimport {closeRightHandSide} from 'actions/views/rhs';\r\nimport {getFirstChannelName} from 'selectors/onboarding';\r\nimport {getIsRhsOpen, getRhsState} from 'selectors/rhs';\r\nimport {isChannelSelected} from 'selectors/views/channel_sidebar';\r\n\r\nimport {\r\n    GenericTaskSteps,\r\n    OnboardingTaskCategory,\r\n    OnboardingTasksName,\r\n} from 'components/onboarding_tasks';\r\nimport {FINISHED, OnboardingTourSteps, TutorialTourName} from 'components/tours';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport SidebarChannelLink from './sidebar_channel_link';\r\n\r\ntype OwnProps = {\r\n    channel: Channel;\r\n}\r\n\r\nfunction makeMapStateToProps() {\r\n    const getUnreadCount = makeGetChannelUnreadCount();\r\n\r\n    return (state: GlobalState, ownProps: OwnProps) => {\r\n        const member = getMyChannelMemberships(state)[ownProps.channel.id];\r\n        const unreadCount = getUnreadCount(state, ownProps.channel.id);\r\n        const config = getConfig(state);\r\n        const enableTutorial = config.EnableTutorial === 'true';\r\n        const currentUserId = getCurrentUserId(state);\r\n        const tutorialStep = getInt(state, TutorialTourName.ONBOARDING_TUTORIAL_STEP, currentUserId, 0);\r\n        const triggerStep = getInt(state, OnboardingTaskCategory, OnboardingTasksName.CHANNELS_TOUR, FINISHED);\r\n        const channelTourTriggered = triggerStep === GenericTaskSteps.STARTED;\r\n        const isOnboardingFlowEnabled = config.EnableOnboardingFlow;\r\n        const showChannelsTour = enableTutorial && tutorialStep === OnboardingTourSteps.CHANNELS_AND_DIRECT_MESSAGES;\r\n        const showChannelsTutorialStep = showChannelsTour && channelTourTriggered && isOnboardingFlowEnabled === 'true';\r\n\r\n        const remoteNames = ownProps.channel?.shared ?\r\n            getRemoteNamesForChannel(state, ownProps.channel.id) : [];\r\n\r\n        return {\r\n            unreadMentions: unreadCount.mentions,\r\n            unreadMsgs: unreadCount.messages,\r\n            isUnread: unreadCount.showUnread,\r\n            isMuted: isChannelMuted(member),\r\n            hasUrgent: unreadCount.hasUrgent,\r\n            isChannelSelected: isChannelSelected(state, ownProps.channel.id),\r\n            firstChannelName: showChannelsTutorialStep ? getFirstChannelName(state) : '',\r\n            showChannelsTutorialStep,\r\n            rhsState: getRhsState(state),\r\n            rhsOpen: getIsRhsOpen(state),\r\n            remoteNames,\r\n        };\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            markMostRecentPostInChannelAsUnread,\r\n            unsetEditingPost,\r\n            clearChannelSelection,\r\n            multiSelectChannelTo,\r\n            multiSelectChannelAdd,\r\n            closeRightHandSide,\r\n            fetchChannelRemotes,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(makeMapStateToProps, mapDispatchToProps)(SidebarChannelLink);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback} from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\n\r\nimport LeaveChannelModal from 'components/leave_channel_modal';\r\nimport SidebarChannelLink from 'components/sidebar/sidebar_channel/sidebar_channel_link';\r\n\r\nimport Constants, {ModalIdentifiers} from 'utils/constants';\r\n\r\nimport SidebarBaseChannelIcon from './sidebar_base_channel_icon';\r\n\r\nimport type {PropsFromRedux} from './index';\r\n\r\nexport interface Props extends PropsFromRedux {\r\n    channel: Channel;\r\n    currentTeamName: string;\r\n}\r\n\r\nconst SidebarBaseChannel = ({\r\n    channel,\r\n    currentTeamName,\r\n    actions,\r\n}: Props) => {\r\n    const intl = useIntl();\r\n\r\n    const handleLeavePublicChannel = useCallback((callback: () => void) => {\r\n        actions.leaveChannel(channel.id);\r\n        callback();\r\n    }, [channel.id, actions.leaveChannel]);\r\n\r\n    const handleLeavePrivateChannel = useCallback((callback: () => void) => {\r\n        actions.openModal({modalId: ModalIdentifiers.LEAVE_PRIVATE_CHANNEL_MODAL, dialogType: LeaveChannelModal, dialogProps: {channel}});\r\n        callback();\r\n    }, [channel, actions.openModal]);\r\n\r\n    let channelLeaveHandler = null;\r\n    if (channel.type === Constants.OPEN_CHANNEL && channel.name !== Constants.DEFAULT_CHANNEL) {\r\n        channelLeaveHandler = handleLeavePublicChannel;\r\n    } else if (channel.type === Constants.PRIVATE_CHANNEL) {\r\n        channelLeaveHandler = handleLeavePrivateChannel;\r\n    }\r\n\r\n    const channelIcon = (\r\n        <SidebarBaseChannelIcon\r\n            channelType={channel.type}\r\n        />\r\n    );\r\n\r\n    let ariaLabelPrefix;\r\n    if (channel.type === Constants.OPEN_CHANNEL) {\r\n        ariaLabelPrefix = intl.formatMessage({id: 'accessibility.sidebar.types.public', defaultMessage: 'public channel'});\r\n    } else if (channel.type === Constants.PRIVATE_CHANNEL) {\r\n        ariaLabelPrefix = intl.formatMessage({id: 'accessibility.sidebar.types.private', defaultMessage: 'private channel'});\r\n    }\r\n\r\n    return (\r\n        <SidebarChannelLink\r\n            channel={channel}\r\n            link={`/${currentTeamName}/channels/${channel.name}`}\r\n            label={channel.display_name}\r\n            ariaLabelPrefix={ariaLabelPrefix}\r\n            channelLeaveHandler={channelLeaveHandler!}\r\n            icon={channelIcon}\r\n            isSharedChannel={channel.shared}\r\n        />\r\n    );\r\n};\r\n\r\nexport default SidebarBaseChannel;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport type {ConnectedProps} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {leaveChannel} from 'actions/views/channel';\r\nimport {openModal} from 'actions/views/modals';\r\n\r\nimport SidebarBaseChannel from './sidebar_base_channel';\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            leaveChannel,\r\n            openModal,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nconst connector = connect(null, mapDispatchToProps);\r\n\r\nexport type PropsFromRedux = ConnectedProps<typeof connector>;\r\n\r\nexport default connector(SidebarBaseChannel);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {injectIntl} from 'react-intl';\r\nimport type {IntlShape} from 'react-intl';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {PreferenceType} from '@mattermost/types/preferences';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\n\r\nimport {Client4} from 'mattermost-redux/client';\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport ProfilePicture from 'components/profile_picture';\r\n\r\nimport {getHistory} from 'utils/browser_history';\r\nimport {Constants} from 'utils/constants';\r\n\r\nimport SidebarChannelLink from '../sidebar_channel_link';\r\n\r\ntype Props = {\r\n    intl: IntlShape;\r\n    channel: Channel;\r\n    teammate?: UserProfile;\r\n    currentTeamName: string;\r\n    currentUserId: string;\r\n    redirectChannel: string;\r\n    active: boolean;\r\n    actions: {\r\n        savePreferences: (userId: string, preferences: PreferenceType[]) => Promise<ActionResult>;\r\n        leaveDirectChannel: (channelId: string) => Promise<ActionResult>;\r\n    };\r\n};\r\n\r\nclass SidebarDirectChannel extends React.PureComponent<Props> {\r\n    handleLeaveChannel = (callback: () => void) => {\r\n        const id = this.props.channel.teammate_id;\r\n        const category = Constants.Preferences.CATEGORY_DIRECT_CHANNEL_SHOW;\r\n\r\n        const currentUserId = this.props.currentUserId;\r\n        this.props.actions.savePreferences(currentUserId, [{user_id: currentUserId, category, name: id!, value: 'false'}]).then(callback);\r\n        this.props.actions.leaveDirectChannel(this.props.channel.name);\r\n\r\n        if (this.props.active) {\r\n            getHistory().push(`/${this.props.currentTeamName}/channels/${this.props.redirectChannel}`);\r\n        }\r\n    };\r\n\r\n    getIcon = () => {\r\n        const {channel, teammate} = this.props;\r\n\r\n        if (!teammate) {\r\n            return null;\r\n        }\r\n\r\n        if (teammate.id && teammate.delete_at) {\r\n            return (\r\n                <i className='icon icon-archive-outline'/>\r\n            );\r\n        }\r\n\r\n        let className = '';\r\n        if (channel.status === 'online') {\r\n            className = 'status-online';\r\n        } else if (channel.status === 'away') {\r\n            className = 'status-away';\r\n        } else if (channel.status === 'dnd') {\r\n            className = 'status-dnd';\r\n        }\r\n\r\n        return (\r\n            <ProfilePicture\r\n                src={Client4.getProfilePictureUrl(teammate.id, teammate.last_picture_update)}\r\n                size={'xs'}\r\n                status={teammate.is_bot ? '' : channel.status}\r\n                wrapperClass='DirectChannel__profile-picture'\r\n                newStatusIcon={true}\r\n                statusClass={`DirectChannel__status-icon ${className}`}\r\n            />\r\n        );\r\n    };\r\n\r\n    render() {\r\n        const {channel, teammate, currentTeamName} = this.props;\r\n\r\n        if (!teammate) {\r\n            return null;\r\n        }\r\n\r\n        let displayName = channel.display_name;\r\n        if (this.props.currentUserId === teammate.id) {\r\n            displayName = this.props.intl.formatMessage({\r\n                id: 'sidebar.directchannel.you',\r\n                defaultMessage: '{displayname} (you)',\r\n            }, {\r\n                displayname: channel.display_name,\r\n            });\r\n        }\r\n\r\n        return (\r\n            <SidebarChannelLink\r\n                teammateId={teammate.id}\r\n                channel={channel}\r\n                link={`/${currentTeamName}/messages/@${teammate.username}`}\r\n                label={displayName}\r\n                channelLeaveHandler={this.handleLeaveChannel}\r\n                icon={this.getIcon()}\r\n                isSharedChannel={Boolean(teammate.remote_id)}\r\n            />\r\n        );\r\n    }\r\n}\r\n\r\nexport default injectIntl(SidebarDirectChannel);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {savePreferences} from 'mattermost-redux/actions/preferences';\r\nimport {getCurrentChannelId, getRedirectChannelNameForTeam} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getCurrentUser, getUser} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {leaveDirectChannel} from 'actions/views/channel';\r\n\r\nimport SidebarDirectChannel from './sidebar_direct_channel';\r\n\r\ntype OwnProps = {\r\n    channel: Channel;\r\n    currentTeamName: string;\r\n}\r\n\r\nfunction mapStateToProps(state: GlobalState, ownProps: OwnProps) {\r\n    const teammate = getUser(state, ownProps.channel.teammate_id!);\r\n    const currentUser = getCurrentUser(state);\r\n    const currentTeam = getCurrentTeam(state);\r\n    const redirectChannel = currentTeam ? getRedirectChannelNameForTeam(state, currentTeam.id) : '';\r\n    const currentChannelId = getCurrentChannelId(state);\r\n    const active = ownProps.channel.id === currentChannelId;\r\n\r\n    return {\r\n        teammate,\r\n        currentUserId: currentUser.id,\r\n        redirectChannel,\r\n        active,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            savePreferences,\r\n            leaveDirectChannel,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(SidebarDirectChannel);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {memo, useCallback} from 'react';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {PreferenceType} from '@mattermost/types/preferences';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport SidebarChannelLink from 'components/sidebar/sidebar_channel/sidebar_channel_link';\r\n\r\nimport {getHistory} from 'utils/browser_history';\r\nimport Constants from 'utils/constants';\r\n\r\ntype Props = {\r\n    channel: Channel;\r\n    currentTeamName: string;\r\n    currentUserId: string;\r\n    redirectChannel: string;\r\n    active: boolean;\r\n    membersCount: number;\r\n    actions: {\r\n        savePreferences: (userId: string, preferences: PreferenceType[]) => Promise<ActionResult>;\r\n    };\r\n};\r\n\r\nconst SidebarGroupChannel = ({\r\n    channel,\r\n    currentUserId,\r\n    actions,\r\n    active,\r\n    currentTeamName,\r\n    redirectChannel,\r\n    membersCount,\r\n}: Props) => {\r\n    const handleLeaveChannel = useCallback((callback: () => void) => {\r\n        const id = channel.id;\r\n        const category = Constants.Preferences.CATEGORY_GROUP_CHANNEL_SHOW;\r\n\r\n        actions.savePreferences(currentUserId, [{user_id: currentUserId, category, name: id, value: 'false'}]).then(callback);\r\n\r\n        if (active) {\r\n            getHistory().push(`/${currentTeamName}/channels/${redirectChannel}`);\r\n        }\r\n    }, [channel.id, actions, active, currentTeamName, redirectChannel, currentUserId]);\r\n\r\n    const getIcon = () => {\r\n        return (\r\n            <div className='status status--group'>{membersCount}</div>\r\n        );\r\n    };\r\n\r\n    return (\r\n        <SidebarChannelLink\r\n            channel={channel}\r\n            link={`/${currentTeamName}/messages/${channel.name}`}\r\n            label={channel.display_name}\r\n            channelLeaveHandler={handleLeaveChannel}\r\n            icon={getIcon()}\r\n        />\r\n    );\r\n};\r\n\r\nexport default memo(SidebarGroupChannel);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {savePreferences} from 'mattermost-redux/actions/preferences';\r\nimport {getCurrentChannelId, getRedirectChannelNameForTeam, makeGetGmChannelMemberCount} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport SidebarGroupChannel from './sidebar_group_channel';\r\n\r\ntype OwnProps = {\r\n    channel: Channel;\r\n}\r\n\r\nfunction makeMapStateToProps() {\r\n    const getMemberCount = makeGetGmChannelMemberCount();\r\n\r\n    return (state: GlobalState, ownProps: OwnProps) => {\r\n        const currentUserId = getCurrentUserId(state);\r\n        const currentTeam = getCurrentTeam(state);\r\n        const redirectChannel = currentTeam ? getRedirectChannelNameForTeam(state, currentTeam.id) : '';\r\n        const currentChannelId = getCurrentChannelId(state);\r\n        const membersCount = getMemberCount(state, ownProps.channel);\r\n        const active = ownProps.channel.id === currentChannelId;\r\n\r\n        return {\r\n            currentUserId,\r\n            redirectChannel,\r\n            active,\r\n            membersCount,\r\n        };\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            savePreferences,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(makeMapStateToProps, mapDispatchToProps)(SidebarGroupChannel);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport type {ConnectedProps} from 'react-redux';\r\n\r\nimport {getCurrentChannelId, makeGetChannel, makeGetChannelUnreadCount} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport {getAutoSortedCategoryIds, getDraggingState, isChannelSelected} from 'selectors/views/channel_sidebar';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport SidebarChannel from './sidebar_channel';\r\n\r\ntype OwnProps = {\r\n    channelId: string;\r\n    channelIndex: number;\r\n    isCategoryCollapsed: boolean;\r\n    isCategoryDragged: boolean;\r\n    isDraggable: boolean;\r\n    isAutoSortedCategory: boolean;\r\n\r\n    /**\r\n     * Sets the ref for the sidebar channel div element, so that it can be used by parent components\r\n     */\r\n    setChannelRef: (channelId: string, ref: HTMLLIElement) => void;\r\n}\r\n\r\nfunction makeMapStateToProps() {\r\n    const getChannel = makeGetChannel();\r\n    const getUnreadCount = makeGetChannelUnreadCount();\r\n\r\n    return (state: GlobalState, ownProps: OwnProps) => {\r\n        const channel = getChannel(state, ownProps.channelId);\r\n        const currentTeam = getCurrentTeam(state);\r\n\r\n        const currentChannelId = getCurrentChannelId(state);\r\n\r\n        const unreadCount = getUnreadCount(state, channel?.id || '');\r\n\r\n        return {\r\n            channel,\r\n            isCurrentChannel: channel?.id === currentChannelId,\r\n            currentTeamName: currentTeam?.name,\r\n            unreadMentions: unreadCount.mentions,\r\n            isUnread: unreadCount.showUnread,\r\n            draggingState: getDraggingState(state),\r\n            isChannelSelected: isChannelSelected(state, ownProps.channelId),\r\n            multiSelectedChannelIds: state.views.channelSidebar.multiSelectedChannelIds,\r\n            autoSortedCategoryIds: getAutoSortedCategoryIds(state),\r\n        };\r\n    };\r\n}\r\n\r\nconst connector = connect(makeMapStateToProps);\r\n\r\ntype PropsFromRedux = Omit<ConnectedProps<typeof connector>, 'dispatch'>;\r\n\r\nexport type Props = OwnProps & PropsFromRedux;\r\n\r\nexport default connector(SidebarChannel);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React, {useState} from 'react';\r\nimport type {AnimationEvent, ReactNode} from 'react';\r\nimport {Draggable} from 'react-beautiful-dnd';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport Constants from 'utils/constants';\r\n\r\nimport SidebarBaseChannel from './sidebar_base_channel';\r\nimport SidebarDirectChannel from './sidebar_direct_channel';\r\nimport SidebarGroupChannel from './sidebar_group_channel';\r\n\r\nimport type {Props} from './index';\r\n\r\nfunction SidebarChannel({\r\n    isCategoryCollapsed,\r\n    isCategoryDragged,\r\n    isUnread,\r\n    isCurrentChannel,\r\n    setChannelRef,\r\n    channel,\r\n    currentTeamName,\r\n    isDraggable,\r\n    isChannelSelected,\r\n    draggingState,\r\n    multiSelectedChannelIds,\r\n    channelIndex,\r\n    isAutoSortedCategory,\r\n    autoSortedCategoryIds,\r\n}: Props) {\r\n    const [show, setShow] = useState(true);\r\n    if (!channel) {\r\n        return null;\r\n    }\r\n\r\n    if (!currentTeamName) {\r\n        return null;\r\n    }\r\n\r\n    function isCollapsed() {\r\n        return isCategoryDragged || (isCategoryCollapsed && !isUnread && !isCurrentChannel);\r\n    }\r\n\r\n    function setRef(refMethod?: (element: HTMLLIElement) => void) {\r\n        return (ref: HTMLLIElement) => {\r\n            setChannelRef(channel?.id || '', ref);\r\n            refMethod?.(ref);\r\n        };\r\n    }\r\n\r\n    function handleAnimationStart(event: AnimationEvent) {\r\n        if (event && event.animationName === 'toOpaqueAnimation' && !isCollapsed()) {\r\n            setShow(true);\r\n        }\r\n    }\r\n\r\n    function handleAnimationEnd(event: AnimationEvent) {\r\n        if (event && event.animationName === 'toTransparentAnimation' && isCollapsed()) {\r\n            setShow(false);\r\n        }\r\n    }\r\n\r\n    let component: ReactNode;\r\n    if (!show) {\r\n        component = null;\r\n    } else if (channel.type === Constants.DM_CHANNEL) {\r\n        component = (\r\n            <SidebarDirectChannel\r\n                channel={channel}\r\n                currentTeamName={currentTeamName}\r\n            />\r\n        );\r\n    } else if (channel.type === Constants.GM_CHANNEL) {\r\n        component = (\r\n            <SidebarGroupChannel\r\n                channel={channel}\r\n                currentTeamName={currentTeamName}\r\n            />\r\n        );\r\n    } else {\r\n        component = (\r\n            <SidebarBaseChannel\r\n                channel={channel}\r\n                currentTeamName={currentTeamName}\r\n            />\r\n        );\r\n    }\r\n\r\n    if (isDraggable) {\r\n        let selectedCount: React.ReactNode;\r\n        if (isChannelSelected && draggingState.state && draggingState.id === channel.id && multiSelectedChannelIds.length > 1) {\r\n            selectedCount = show ? (\r\n                <div className='SidebarChannel__selectedCount'>\r\n                    <FormattedMessage\r\n                        id='sidebar_left.sidebar_channel.selectedCount'\r\n                        defaultMessage='{count} selected'\r\n                        values={{count: multiSelectedChannelIds.length}}\r\n                    />\r\n                </div>\r\n            ) : null;\r\n        }\r\n\r\n        return (\r\n            <Draggable\r\n                draggableId={channel.id}\r\n                index={channelIndex}\r\n            >\r\n                {(provided, snapshot) => {\r\n                    return (\r\n                        <li\r\n                            draggable='false'\r\n                            ref={setRef(provided.innerRef)}\r\n                            className={classNames('SidebarChannel', {\r\n                                collapsed: isCollapsed(),\r\n                                expanded: !isCollapsed(),\r\n                                unread: isUnread,\r\n                                active: isCurrentChannel,\r\n                                dragging: snapshot.isDragging,\r\n                                selectedDragging: isChannelSelected && draggingState.state && draggingState.id !== channel.id,\r\n                                fadeOnDrop: snapshot.isDropAnimating && snapshot.draggingOver && autoSortedCategoryIds.has(snapshot.draggingOver),\r\n                                noFloat: isAutoSortedCategory && !snapshot.isDragging,\r\n                            })}\r\n                            {...provided.draggableProps}\r\n                            {...provided.dragHandleProps}\r\n                            onAnimationStart={handleAnimationStart}\r\n                            onAnimationEnd={handleAnimationEnd}\r\n                            role='listitem'\r\n                            tabIndex={-1}\r\n                        >\r\n                            {component}\r\n                            {selectedCount}\r\n                        </li>\r\n                    );\r\n                }}\r\n            </Draggable>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <li\r\n            ref={setRef()}\r\n            className={classNames('SidebarChannel', {\r\n                collapsed: isCollapsed(),\r\n                expanded: !isCollapsed(),\r\n                unread: isUnread,\r\n                active: isCurrentChannel,\r\n            })}\r\n            onAnimationStart={handleAnimationStart}\r\n            onAnimationEnd={handleAnimationEnd}\r\n            role='listitem'\r\n        >\r\n            {component}\r\n        </li>\r\n    );\r\n}\r\n\r\nexport default SidebarChannel;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {ServerError} from '@mattermost/types/errors';\r\nimport type {GetGroupsForUserParams, GetGroupsParams} from '@mattermost/types/groups';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport {fetchChannelsAndMembers} from 'mattermost-redux/actions/channels';\r\nimport {logError} from 'mattermost-redux/actions/errors';\r\nimport {getGroups, getAllGroupsAssociatedToChannelsInTeam, getAllGroupsAssociatedToTeam, getGroupsByUserIdPaginated} from 'mattermost-redux/actions/groups';\r\nimport {forceLogoutIfNecessary} from 'mattermost-redux/actions/helpers';\r\nimport {getTeamByName, selectTeam} from 'mattermost-redux/actions/teams';\r\nimport {getIsUserStatusesConfigEnabled} from 'mattermost-redux/selectors/entities/common';\r\nimport {getLicense} from 'mattermost-redux/selectors/entities/general';\r\nimport {isCustomGroupsEnabled} from 'mattermost-redux/selectors/entities/preferences';\r\nimport {getCurrentUser} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {addVisibleUsersInCurrentChannelAndSelfToStatusPoll} from 'actions/status_actions';\r\nimport {addUserToTeam} from 'actions/team_actions';\r\nimport LocalStorageStore from 'stores/local_storage_store';\r\n\r\nimport {isSuccess} from 'types/actions';\r\nimport type {ActionFuncAsync} from 'types/store';\r\n\r\nexport function initializeTeam(team: Team): ActionFuncAsync<Team> {\r\n    return async (dispatch, getState) => {\r\n        dispatch(selectTeam(team.id));\r\n\r\n        const state = getState();\r\n        const currentUser = getCurrentUser(state);\r\n        LocalStorageStore.setPreviousTeamId(currentUser.id, team.id);\r\n\r\n        const enabledUserStatuses = getIsUserStatusesConfigEnabled(state);\r\n        if (enabledUserStatuses) {\r\n            dispatch(addVisibleUsersInCurrentChannelAndSelfToStatusPoll());\r\n        }\r\n\r\n        const license = getLicense(state);\r\n        const customGroupEnabled = isCustomGroupsEnabled(state);\r\n        if (license &&\r\n            license.IsLicensed === 'true' &&\r\n            (license.LDAPGroups === 'true' || customGroupEnabled)) {\r\n            const groupsParams: GetGroupsParams = {\r\n                filter_allow_reference: false,\r\n                page: 0,\r\n                per_page: 60,\r\n                include_member_count: true,\r\n                include_member_ids: true,\r\n                include_archived: false,\r\n            };\r\n            const myGroupsParams: GetGroupsForUserParams = {\r\n                ...groupsParams,\r\n                filter_has_member: currentUser.id,\r\n            };\r\n\r\n            if (currentUser) {\r\n                dispatch(getGroupsByUserIdPaginated(myGroupsParams));\r\n            }\r\n\r\n            if (license.LDAPGroups === 'true') {\r\n                dispatch(getAllGroupsAssociatedToChannelsInTeam(team.id, true));\r\n            }\r\n\r\n            if (team.group_constrained && license.LDAPGroups === 'true') {\r\n                dispatch(getAllGroupsAssociatedToTeam(team.id, true));\r\n            } else {\r\n                dispatch(getGroups(groupsParams));\r\n            }\r\n        }\r\n\r\n        return {data: team};\r\n    };\r\n}\r\n\r\nexport function joinTeam(teamname: string, joinedOnFirstLoad: boolean): ActionFuncAsync<Team> {\r\n    return async (dispatch, getState) => {\r\n        const state = getState();\r\n        const currentUser = getCurrentUser(state);\r\n\r\n        try {\r\n            const teamByNameResult = await dispatch(getTeamByName(teamname));\r\n            if (isSuccess(teamByNameResult)) {\r\n                const team = teamByNameResult.data;\r\n\r\n                if (currentUser && team && team.delete_at === 0) {\r\n                    const addUserToTeamResult = await dispatch(addUserToTeam(team.id, currentUser.id));\r\n                    if (isSuccess(addUserToTeamResult)) {\r\n                        if (joinedOnFirstLoad) {\r\n                            LocalStorageStore.setTeamIdJoinedOnLoad(team.id);\r\n                        }\r\n\r\n                        await dispatch(initializeTeam(team));\r\n\r\n                        try {\r\n                            await dispatch(fetchChannelsAndMembers(team.id));\r\n                        } catch (error) {\r\n                            forceLogoutIfNecessary(error as ServerError, dispatch, getState);\r\n                            dispatch(logError(error as ServerError));\r\n                            return {error: error as ServerError};\r\n                        }\r\n\r\n                        return {data: team};\r\n                    }\r\n                    throw addUserToTeamResult.error;\r\n                }\r\n                throw new Error('Team not found or deleted');\r\n            } else {\r\n                throw teamByNameResult.error;\r\n            }\r\n        } catch (error) {\r\n            forceLogoutIfNecessary(error as ServerError, dispatch, getState);\r\n            dispatch(logError(error as ServerError));\r\n            return {error: error as ServerError};\r\n        }\r\n    };\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {History} from 'history';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {joinChannel, getChannelByNameAndTeamName, getChannelMember, markGroupChannelOpen, fetchChannelsAndMembers} from 'mattermost-redux/actions/channels';\r\nimport {getUser, getUserByUsername, getUserByEmail} from 'mattermost-redux/actions/users';\r\nimport {Client4} from 'mattermost-redux/client';\r\nimport {getChannelByName, getOtherChannels, getChannel, getChannelsNameMapInTeam, getRedirectChannelNameForTeam} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getTeamByName} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getCurrentUserId, getUserByUsername as selectUserByUsername, getUser as selectUser, getUserByEmail as selectUserByEmail} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {openDirectChannelToUserId} from 'actions/channel_actions';\r\nimport * as GlobalActions from 'actions/global_actions';\r\n\r\nimport {joinPrivateChannelPrompt} from 'utils/channel_utils';\r\nimport {Constants} from 'utils/constants';\r\nimport * as Utils from 'utils/utils';\r\n\r\nimport type {ActionFuncAsync} from 'types/store';\r\n\r\nimport type {Match, MatchAndHistory} from './channel_identifier_router';\r\n\r\nconst LENGTH_OF_ID = 26;\r\nconst LENGTH_OF_GROUP_ID = 40;\r\nconst LENGTH_OF_USER_ID_PAIR = 54;\r\nconst USER_ID_PAIR_REGEXP = new RegExp(`^[a-zA-Z0-9]{${LENGTH_OF_ID}}__[a-zA-Z0-9]{${LENGTH_OF_ID}}$`);\r\n\r\nexport function onChannelByIdentifierEnter({match, history}: MatchAndHistory): ActionFuncAsync {\r\n    return async (dispatch, getState) => {\r\n        const state = getState();\r\n        const {path, identifier, team} = match.params;\r\n\r\n        if (!identifier) {\r\n            return {data: undefined};\r\n        }\r\n\r\n        const teamObj = getTeamByName(state, team);\r\n        if (!teamObj) {\r\n            return {data: undefined};\r\n        }\r\n\r\n        const channelPath = await getPathFromIdentifier(state, path, identifier);\r\n\r\n        switch (channelPath) {\r\n        case 'channel_name':\r\n            dispatch(goToChannelByChannelName(match, history));\r\n            break;\r\n        case 'channel_id':\r\n            dispatch(goToChannelByChannelId(match, history));\r\n            break;\r\n        case 'group_channel_group_id':\r\n            dispatch(goToGroupChannelByGroupId(match, history));\r\n            break;\r\n        case 'direct_channel_username':\r\n            dispatch(goToDirectChannelByUsername(match, history));\r\n            break;\r\n        case 'direct_channel_email':\r\n            dispatch(goToDirectChannelByEmail(match, history));\r\n            break;\r\n        case 'direct_channel_user_ids':\r\n            dispatch(goToDirectChannelByUserIds(match, history));\r\n            break;\r\n        case 'direct_channel_user_id':\r\n            dispatch(goToDirectChannelByUserId(match, history, identifier));\r\n            break;\r\n        case 'error':\r\n            await dispatch(fetchChannelsAndMembers(teamObj!.id));\r\n            handleError(match, history, getRedirectChannelNameForTeam(state, teamObj!.id));\r\n            break;\r\n        }\r\n        return {data: undefined};\r\n    };\r\n}\r\n\r\nexport async function getPathFromIdentifier(state: GlobalState, path: string, identifier: string) {\r\n    if (path === 'channels') {\r\n        // It's hard to tell an ID apart from a channel name of the same length, so check first if\r\n        // the identifier matches a channel that we have\r\n        const channelsByName = getChannelByName(state, identifier);\r\n        const moreChannelsByName = getOtherChannels(state).find((chan) => chan.name === identifier);\r\n\r\n        if (identifier.length === LENGTH_OF_ID) {\r\n            if (!channelsByName && !moreChannelsByName) {\r\n                try {\r\n                    await Client4.getChannel(identifier);\r\n                    return 'channel_id';\r\n                } catch (e) {\r\n                    if (e.status_code === 404) {\r\n                        return 'channel_name';\r\n                    }\r\n                    return 'error';\r\n                }\r\n            }\r\n            return 'channel_name';\r\n        } else if (\r\n            (!channelsByName && !moreChannelsByName && identifier.length === LENGTH_OF_GROUP_ID) ||\r\n            (\r\n                (channelsByName && channelsByName.type === Constants.GM_CHANNEL) ||\r\n                (moreChannelsByName && moreChannelsByName.type === Constants.GM_CHANNEL)\r\n            )\r\n        ) {\r\n            return 'group_channel_group_id';\r\n        } else if (isDirectChannelIdentifier(identifier)) {\r\n            return 'direct_channel_user_ids';\r\n        }\r\n        return 'channel_name';\r\n    } else if (path === 'messages') {\r\n        if (identifier.indexOf('@') === 0) {\r\n            return 'direct_channel_username';\r\n        } else if (identifier.indexOf('@') > 0) {\r\n            return 'direct_channel_email';\r\n        } else if (identifier.length === LENGTH_OF_ID) {\r\n            return 'direct_channel_user_id';\r\n        } else if (identifier.length === LENGTH_OF_GROUP_ID) {\r\n            return 'group_channel_group_id';\r\n        }\r\n        return 'error';\r\n    }\r\n\r\n    return 'error';\r\n}\r\n\r\nexport function goToChannelByChannelId(match: Match, history: History): ActionFuncAsync {\r\n    return async (dispatch, getState) => {\r\n        const state = getState();\r\n        const {team, identifier} = match.params;\r\n        const channelId = identifier.toLowerCase();\r\n\r\n        let channel = getChannel(state, channelId);\r\n        const member = state.entities.channels.myMembers[channelId];\r\n        const teamObj = getTeamByName(state, team);\r\n        if (!channel || !member) {\r\n            const dispatchResult = await dispatch(joinChannel(getCurrentUserId(state), teamObj!.id, channelId, ''));\r\n            if ('error' in dispatchResult) {\r\n                await dispatch(fetchChannelsAndMembers(teamObj!.id));\r\n                handleChannelJoinError(match, history, getRedirectChannelNameForTeam(state, teamObj!.id));\r\n                return {data: undefined};\r\n            }\r\n            channel = dispatchResult.data!.channel;\r\n        }\r\n\r\n        if (channel.type === Constants.DM_CHANNEL) {\r\n            dispatch(goToDirectChannelByUserId(match, history, Utils.getUserIdFromChannelId(channel.name, getCurrentUserId(state))));\r\n        } else if (channel.type === Constants.GM_CHANNEL) {\r\n            history.replace(`/${team}/messages/${channel.name}`);\r\n        } else {\r\n            history.replace(`/${team}/channels/${channel.name}`);\r\n        }\r\n        return {data: undefined};\r\n    };\r\n}\r\n\r\nexport function goToChannelByChannelName(match: Match, history: History): ActionFuncAsync {\r\n    return async (dispatch, getState) => {\r\n        const state = getState();\r\n        const {team, identifier} = match.params;\r\n        const channelName = identifier.toLowerCase();\r\n\r\n        const teamObj = getTeamByName(state, team);\r\n        if (!teamObj) {\r\n            return {data: undefined};\r\n        }\r\n\r\n        let channel = getChannelsNameMapInTeam(state, teamObj!.id)[channelName];\r\n        if (!channel) {\r\n            const getChannelDispatchResult = await dispatch(getChannelByNameAndTeamName(team, channelName, true));\r\n            if ('data' in getChannelDispatchResult) {\r\n                channel = getChannelDispatchResult.data!;\r\n            }\r\n        }\r\n\r\n        let member;\r\n        if (channel) {\r\n            member = state.entities.channels.myMembers[channel.id];\r\n            if (!member) {\r\n                const membership = await dispatch(getChannelMember(channel.id, getCurrentUserId(state)));\r\n                if ('data' in membership) {\r\n                    member = membership.data;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (!channel || !member) {\r\n            if (channel?.type === Constants.PRIVATE_CHANNEL) {\r\n                // If we are here, we have permissions to join the channel\r\n                // and the channel is private. Therefore prompt always.\r\n                const joinPromptResult = await dispatch(joinPrivateChannelPrompt(teamObj, channel.display_name));\r\n                if ('data' in joinPromptResult && !joinPromptResult.data!.join) {\r\n                    return {data: undefined};\r\n                }\r\n            }\r\n\r\n            const joinChannelDispatchResult = await dispatch(joinChannel(getCurrentUserId(state), teamObj!.id, channel?.id || '', channelName));\r\n            if ('error' in joinChannelDispatchResult) {\r\n                if (!channel) {\r\n                    const getChannelDispatchResult = await dispatch(getChannelByNameAndTeamName(team, channelName, true));\r\n                    if ('error' in getChannelDispatchResult || getChannelDispatchResult.data!.delete_at === 0) {\r\n                        await dispatch(fetchChannelsAndMembers(teamObj!.id));\r\n                        handleChannelJoinError(match, history, getRedirectChannelNameForTeam(state, teamObj!.id));\r\n                        return {data: undefined};\r\n                    }\r\n                    channel = getChannelDispatchResult.data!;\r\n                }\r\n            } else {\r\n                channel = joinChannelDispatchResult.data!.channel;\r\n            }\r\n        }\r\n\r\n        if (channel.type === Constants.DM_CHANNEL) {\r\n            dispatch(goToDirectChannelByUserIds(match, history));\r\n        } else if (channel.type === Constants.GM_CHANNEL) {\r\n            history.replace(`/${team}/messages/${channel.name}`);\r\n        } else {\r\n            doChannelChange(channel);\r\n        }\r\n        return {data: undefined};\r\n    };\r\n}\r\n\r\nfunction goToDirectChannelByUsername(match: Match, history: History): ActionFuncAsync {\r\n    return async (dispatch, getState) => {\r\n        const state = getState();\r\n        const {team, identifier} = match.params;\r\n        const username = identifier.slice(1, identifier.length).toLowerCase();\r\n        const teamObj = getTeamByName(state, team);\r\n\r\n        let user = selectUserByUsername(state, username);\r\n        if (!user) {\r\n            const dispatchResult = await dispatch(getUserByUsername(username));\r\n            if ('error' in dispatchResult) {\r\n                await dispatch(fetchChannelsAndMembers(teamObj!.id));\r\n                handleError(match, history, getRedirectChannelNameForTeam(state, teamObj!.id));\r\n                return {data: undefined};\r\n            }\r\n            user = dispatchResult.data!;\r\n        }\r\n\r\n        const directChannelDispatchRes = await dispatch(openDirectChannelToUserId(user.id));\r\n        if ('error' in directChannelDispatchRes) {\r\n            await dispatch(fetchChannelsAndMembers(teamObj!.id));\r\n            handleError(match, history, getRedirectChannelNameForTeam(state, teamObj!.id));\r\n            return {data: undefined};\r\n        }\r\n\r\n        doChannelChange(directChannelDispatchRes.data!);\r\n        return {data: undefined};\r\n    };\r\n}\r\n\r\nexport function goToDirectChannelByUserId(match: Match, history: History, userId: string): ActionFuncAsync {\r\n    return async (dispatch, getState) => {\r\n        const state = getState();\r\n        const {team} = match.params;\r\n        const teamObj = getTeamByName(state, team);\r\n\r\n        let user = selectUser(state, userId);\r\n        if (!user) {\r\n            const dispatchResult = await dispatch(getUser(userId));\r\n            if ('error' in dispatchResult) {\r\n                await dispatch(fetchChannelsAndMembers(teamObj!.id));\r\n                handleError(match, history, getRedirectChannelNameForTeam(state, teamObj!.id));\r\n                return {data: undefined};\r\n            }\r\n            user = dispatchResult.data!;\r\n        }\r\n\r\n        history.replace(`/${team}/messages/@${user.username}`);\r\n        return {data: undefined};\r\n    };\r\n}\r\n\r\nexport function goToDirectChannelByUserIds(match: Match, history: History): ActionFuncAsync {\r\n    return async (dispatch, getState) => {\r\n        const state = getState();\r\n        const {team, identifier} = match.params;\r\n        const userId = Utils.getUserIdFromChannelId(identifier.toLowerCase(), getCurrentUserId(getState()));\r\n        const teamObj = getTeamByName(state, team);\r\n\r\n        let user = selectUser(state, userId);\r\n        if (!user) {\r\n            const dispatchResult = await dispatch(getUser(userId));\r\n            if ('error' in dispatchResult) {\r\n                await dispatch(fetchChannelsAndMembers(teamObj!.id));\r\n                handleError(match, history, getRedirectChannelNameForTeam(state, teamObj!.id));\r\n                return {data: undefined};\r\n            }\r\n            user = dispatchResult.data!;\r\n        }\r\n\r\n        history.replace(`/${team}/messages/@${user.username}`);\r\n        return {data: undefined};\r\n    };\r\n}\r\n\r\nexport function goToDirectChannelByEmail(match: Match, history: History): ActionFuncAsync {\r\n    return async (dispatch, getState) => {\r\n        const state = getState();\r\n        const {team, identifier} = match.params;\r\n        const email = identifier.toLowerCase();\r\n        const teamObj = getTeamByName(state, team);\r\n\r\n        let user = selectUserByEmail(state, email);\r\n        if (!user) {\r\n            const dispatchResult = await dispatch(getUserByEmail(email));\r\n            if ('error' in dispatchResult) {\r\n                await dispatch(fetchChannelsAndMembers(teamObj!.id));\r\n                handleError(match, history, getRedirectChannelNameForTeam(state, teamObj!.id));\r\n                return {data: undefined};\r\n            }\r\n            user = dispatchResult.data!;\r\n        }\r\n\r\n        history.replace(`/${team}/messages/@${user.username}`);\r\n        return {data: undefined};\r\n    };\r\n}\r\n\r\nfunction goToGroupChannelByGroupId(match: Match, history: History): ActionFuncAsync {\r\n    return async (dispatch, getState) => {\r\n        const state = getState();\r\n        const {identifier, team} = match.params;\r\n        const groupId = identifier.toLowerCase();\r\n\r\n        history.replace(match.url.replace('/channels/', '/messages/'));\r\n\r\n        let channel = getChannelByName(state, groupId);\r\n        const teamObj = getTeamByName(state, team);\r\n        if (!channel) {\r\n            const dispatchResult = await dispatch(joinChannel(getCurrentUserId(state), teamObj!.id, '', groupId));\r\n            if ('error' in dispatchResult) {\r\n                await dispatch(fetchChannelsAndMembers(teamObj!.id));\r\n                handleError(match, history, getRedirectChannelNameForTeam(state, teamObj!.id));\r\n                return {data: undefined};\r\n            }\r\n            channel = dispatchResult.data!.channel;\r\n        }\r\n\r\n        dispatch(markGroupChannelOpen(channel!.id));\r\n\r\n        doChannelChange(channel!);\r\n        return {data: undefined};\r\n    };\r\n}\r\n\r\nfunction doChannelChange(channel: Channel) {\r\n    GlobalActions.emitChannelClickEvent(channel);\r\n}\r\n\r\nfunction handleError(match: Match, history: History, defaultChannel: string) {\r\n    const {team} = match.params;\r\n    history.push(team ? `/${team}/channels/${defaultChannel}` : '/');\r\n}\r\n\r\nfunction isDirectChannelIdentifier(identifier: string) {\r\n    return identifier.length === LENGTH_OF_USER_ID_PAIR && USER_ID_PAIR_REGEXP.test(identifier);\r\n}\r\n\r\nasync function handleChannelJoinError(match: Match, history: History, defaultChannel: string) {\r\n    const {team} = match.params;\r\n    history.push(team ? `/error?type=channel_not_found&returnTo=/${team}/channels/${defaultChannel}` : '/');\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport * as React from 'react';\r\n\r\ntype SvgProps = {\r\n    width?: number;\r\n    height?: number;\r\n};\r\n\r\nconst PrivateChannelIntroSvg = (props: SvgProps) => (\r\n    <svg\r\n        width={props.width ?? '130'}\r\n        height={props.height ?? '102'}\r\n        viewBox='0 0 130 102'\r\n        fill='none'\r\n        xmlns='http://www.w3.org/2000/svg'\r\n        xmlnsXlink='http://www.w3.org/1999/xlink'\r\n        {...props}\r\n    >\r\n        <g clipPath='url(#clip0_4212_90419)'>\r\n            <path\r\n                d='M2.50001 16L2.5 31L127.5 31L127.5 75L66 75'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.32'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M2.5 69L2.5 42L29 42'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.32'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M18.5 70.5L18.5 56.5L106 56.5'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.32'\r\n                strokeLinecap='round'\r\n            />\r\n            <circle\r\n                cx='2.5'\r\n                cy='2.5'\r\n                r='2.5'\r\n                transform='matrix(1 8.74228e-08 8.74228e-08 -1 0 16)'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.32'\r\n            />\r\n            <circle\r\n                cx='2.5'\r\n                cy='2.5'\r\n                r='2.5'\r\n                transform='matrix(1 8.74228e-08 8.74228e-08 -1 0 74)'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.32'\r\n            />\r\n            <circle\r\n                cx='2.5'\r\n                cy='2.5'\r\n                r='2.5'\r\n                transform='matrix(1 8.74228e-08 8.74228e-08 -1 16 74)'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.32'\r\n            />\r\n            <circle\r\n                cx='71'\r\n                cy='59'\r\n                r='43'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.12'\r\n            />\r\n            <path\r\n                d='M110.748 91.5258L119 100V56C119 54.8954 118.105 54 117 54H76.0005C74.8959 54 74.0005 54.8954 74.0005 56V88.9211C74.0005 90.0256 74.8959 90.9211 76.0005 90.9211H109.316C109.855 90.9211 110.372 91.1391 110.748 91.5258Z'\r\n                fill='#28427B'\r\n            />\r\n            <circle\r\n                opacity='0.48'\r\n                cx='86.831'\r\n                cy='65.831'\r\n                r='5.83099'\r\n                fill='var(--button-color)'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M96 64H112'\r\n                stroke='var(--button-color-rgb)'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M82 79H103.38'\r\n                stroke='rgba(var(--button-color-rgb))'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M82 83H96.2535'\r\n                stroke='rgba(var(--button-color-rgb))'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M96 68H110'\r\n                stroke='rgba(var(--button-color-rgb))'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M82 75H93.0141'\r\n                stroke='rgba(var(--button-color-rgb))'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M95.6064 75H107.268'\r\n                stroke='rgba(var(--button-color-rgb))'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M28.605 67.5638L15 81V12C15 10.8954 15.8954 10 17 10H83C84.1046 10 85 10.8954 85 12V64.9868C85 66.0914 84.1046 66.9868 83 66.9868H30.0103C29.4842 66.9868 28.9793 67.1941 28.605 67.5638Z'\r\n                fill='var(--center-channel-bg)'\r\n            />\r\n            <path\r\n                d='M28.2536 67.2081L15.5 79.8035V12C15.5 11.1716 16.1716 10.5 17 10.5H83C83.8284 10.5 84.5 11.1716 84.5 12V64.9868C84.5 65.8153 83.8284 66.4868 83 66.4868H30.0103C29.3527 66.4868 28.7215 66.746 28.2536 67.2081Z'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.8'\r\n            />\r\n            <circle\r\n                cx='33'\r\n                cy='29'\r\n                r='9'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.4'\r\n            />\r\n            <path\r\n                d='M48 25H64'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.4'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M25 49H62'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.4'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M25 55H47'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.4'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M48 31H73'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.4'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M25 43H42'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.4'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M46 43H64'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.4'\r\n                strokeLinecap='round'\r\n            />\r\n            <circle\r\n                cx='78'\r\n                cy='19'\r\n                r='19'\r\n                fill='#32539A'\r\n            />\r\n            <path\r\n                d='M98 49L80 49'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.8'\r\n                strokeLinecap='round'\r\n                strokeLinejoin='round'\r\n            />\r\n            <path\r\n                d='M76 49L70 49'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.8'\r\n                strokeLinecap='round'\r\n                strokeLinejoin='round'\r\n            />\r\n            <path\r\n                d='M67 49L65 49'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.8'\r\n                strokeLinecap='round'\r\n                strokeLinejoin='round'\r\n            />\r\n            <circle\r\n                cx='44'\r\n                cy='75'\r\n                r='2'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.32'\r\n            />\r\n            <circle\r\n                cx='52'\r\n                cy='75'\r\n                r='2'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.32'\r\n            />\r\n            <circle\r\n                cx='60'\r\n                cy='75'\r\n                r='2'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.32'\r\n            />\r\n            <rect\r\n                x='70.5'\r\n                y='15.5'\r\n                width='15'\r\n                height='12'\r\n                rx='1.5'\r\n                stroke='var(--button-color)'\r\n            />\r\n            <path\r\n                d='M73 16V13C73 10.2386 75.2386 8 78 8V8C80.7614 8 83 10.2386 83 13V16'\r\n                stroke='var(--button-color)'\r\n            />\r\n        </g>\r\n        <defs>\r\n            <clipPath id='clip0_4212_90419'>\r\n                <rect\r\n                    width='130'\r\n                    height='102'\r\n                    fill='white'\r\n                />\r\n            </clipPath>\r\n        </defs>\r\n    </svg>\r\n);\r\n\r\nexport default PrivateChannelIntroSvg;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\n\r\ntype SvgProps = {\r\n    width?: number;\r\n    height?: number;\r\n};\r\n\r\nconst PublicChannelIntroSvg = (props: SvgProps) => (\r\n    <svg\r\n        width={props.width ?? '130'}\r\n        height={props.height ?? '102'}\r\n        viewBox='0 0 130 102'\r\n        fill='none'\r\n        xmlns='http://www.w3.org/2000/svg'\r\n        xmlnsXlink='http://www.w3.org/1999/xlink'\r\n    >\r\n        <g clipPath='url(#clip0_4212_90121)'>\r\n            <path\r\n                d='M2.50001 16L2.5 31L127.5 31L127.5 75L66 75'\r\n                stroke='rgba(var(--center-channel-color-rgb), 0.32)'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M2.5 69L2.5 42L29 42'\r\n                stroke='rgba(var(--center-channel-color-rgb), 0.32)'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M18.5 70.5L18.5 56.5L106 56.5'\r\n                stroke='rgba(var(--center-channel-color-rgb), 0.32)'\r\n                strokeLinecap='round'\r\n            />\r\n            <circle\r\n                cx='2.5'\r\n                cy='2.5'\r\n                r='2.5'\r\n                transform='matrix(1 8.74228e-08 8.74228e-08 -1 0 16)'\r\n                fill='rgba(var(--center-channel-color-rgb), 0.32)'\r\n            />\r\n            <circle\r\n                cx='2.5'\r\n                cy='2.5'\r\n                r='2.5'\r\n                transform='matrix(1 8.74228e-08 8.74228e-08 -1 0 74)'\r\n                fill='rgba(var(--center-channel-color-rgb), 0.32)'\r\n            />\r\n            <circle\r\n                cx='2.5'\r\n                cy='2.5'\r\n                r='2.5'\r\n                transform='matrix(1 8.74228e-08 8.74228e-08 -1 16 74)'\r\n                fill='rgba(var(--center-channel-color-rgb), 0.32)'\r\n            />\r\n            <circle\r\n                cx='71'\r\n                cy='59'\r\n                r='43'\r\n                fill='rgba(var(--center-channel-color-rgb), 0.12)'\r\n            />\r\n            <path\r\n                d='M110.748 91.5258L119 100V56C119 54.8954 118.105 54 117 54H76.0005C74.8959 54 74.0005 54.8954 74.0005 56V88.9211C74.0005 90.0256 74.8959 90.9211 76.0005 90.9211H109.316C109.855 90.9211 110.372 91.1391 110.748 91.5258Z'\r\n                fill='#28427B'\r\n            />\r\n            <circle\r\n                opacity='0.48'\r\n                cx='86.831'\r\n                cy='65.831'\r\n                r='5.83099'\r\n                fill='var(--button-color)'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M96 64H112'\r\n                stroke='var(--button-color-rgb)'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M82 79H103.38'\r\n                stroke='rgba(var(--button-color-rgb))'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M82 83H96.2535'\r\n                stroke='rgba(var(--button-color-rgb))'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M96 68H110'\r\n                stroke='rgba(var(--button-color-rgb))'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M82 75H93.0141'\r\n                stroke='rgba(var(--button-color-rgb))'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M95.6064 75H107.268'\r\n                stroke='rgba(var(--button-color-rgb))'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M28.605 67.5638L15 81V12C15 10.8954 15.8954 10 17 10H83C84.1046 10 85 10.8954 85 12V64.9868C85 66.0914 84.1046 66.9868 83 66.9868H30.0103C29.4842 66.9868 28.9793 67.1941 28.605 67.5638Z'\r\n                fill='rgba(var(--center-channel-bg-rgb))'\r\n            />\r\n            <path\r\n                d='M28.2536 67.2081L15.5 79.8035V12C15.5 11.1716 16.1716 10.5 17 10.5H83C83.8284 10.5 84.5 11.1716 84.5 12V64.9868C84.5 65.8153 83.8284 66.4868 83 66.4868H30.0103C29.3527 66.4868 28.7215 66.746 28.2536 67.2081Z'\r\n                stroke='rgba(var(--center-channel-color-rgb), 0.8)'\r\n            />\r\n            <circle\r\n                cx='33'\r\n                cy='29'\r\n                r='9'\r\n                fill='rgba(var(--center-channel-color-rgb), 0.4)'\r\n            />\r\n            <path\r\n                d='M48 25H64'\r\n                stroke='rgba(var(--center-channel-color-rgb), 0.4)'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M25 49H62'\r\n                stroke='rgba(var(--center-channel-color-rgb), 0.4)'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M25 55H47'\r\n                stroke='rgba(var(--center-channel-color-rgb), 0.4)'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M48 31H73'\r\n                stroke='rgba(var(--center-channel-color-rgb), 0.4)'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M25 43H42'\r\n                stroke='rgba(var(--center-channel-color-rgb), 0.4)'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M46 43H64'\r\n                stroke='rgba(var(--center-channel-color-rgb), 0.4)'\r\n                strokeLinecap='round'\r\n            />\r\n            <circle\r\n                cx='78'\r\n                cy='19'\r\n                r='19'\r\n                fill='#32539A'\r\n            />\r\n            <path\r\n                d='M98 49L80 49'\r\n                stroke='rgba(var(--center-channel-color-rgb), 0.8)'\r\n                strokeLinecap='round'\r\n                strokeLinejoin='round'\r\n            />\r\n            <path\r\n                d='M76 49L70 49'\r\n                stroke='rgba(var(--center-channel-color-rgb), 0.8)'\r\n                strokeLinecap='round'\r\n                strokeLinejoin='round'\r\n            />\r\n            <path\r\n                d='M67 49L65 49'\r\n                stroke='rgba(var(--center-channel-color-rgb), 0.8)'\r\n                strokeLinecap='round'\r\n                strokeLinejoin='round'\r\n            />\r\n            <circle\r\n                cx='44'\r\n                cy='75'\r\n                r='2'\r\n                fill='rgba(var(--center-channel-color-rgb), 0.32)'\r\n            />\r\n            <circle\r\n                cx='52'\r\n                cy='75'\r\n                r='2'\r\n                fill='rgba(var(--center-channel-color-rgb), 0.32)'\r\n            />\r\n            <circle\r\n                cx='60'\r\n                cy='75'\r\n                r='2'\r\n                fill='rgba(var(--center-channel-color-rgb), 0.32)'\r\n            />\r\n            <circle\r\n                cx='78'\r\n                cy='19'\r\n                r='9.5'\r\n                stroke='rgba(var(--button-color-rgb))'\r\n            />\r\n            <path\r\n                d='M87.5 20.2525C86.1859 21.8482 82.4292 23 78 23C73.5708 23 69.8141 21.8482 68.5 20.2525'\r\n                stroke='rgba(var(--button-color-rgb))'\r\n            />\r\n            <path\r\n                d='M86.6622 15C84.9331 16.1956 81.7014 17 78 17C74.2986 17 71.0669 16.1956 69.3378 15'\r\n                stroke='rgba(var(--button-color-rgb))'\r\n            />\r\n            <path\r\n                d='M81.5 19C81.5 21.7141 81.059 24.1482 80.3642 25.8854C80.0162 26.7553 79.6144 27.4258 79.1937 27.8706C78.7741 28.3143 78.3705 28.5 78 28.5C77.6295 28.5 77.2259 28.3143 76.8063 27.8706C76.3856 27.4258 75.9838 26.7553 75.6358 25.8854C74.941 24.1482 74.5 21.7141 74.5 19C74.5 16.2859 74.941 13.8518 75.6358 12.1146C75.9838 11.2447 76.3856 10.5742 76.8063 10.1294C77.2259 9.6857 77.6295 9.5 78 9.5C78.3705 9.5 78.7741 9.6857 79.1937 10.1294C79.6144 10.5742 80.0162 11.2447 80.3642 12.1146C81.059 13.8518 81.5 16.2859 81.5 19Z'\r\n                stroke='rgba(var(--button-color-rgb))'\r\n            />\r\n        </g>\r\n        <defs>\r\n            <clipPath id='clip0_4212_90121'>\r\n                <rect\r\n                    width='130'\r\n                    height='102'\r\n                    fill='rgba(var(--center-channel-bg-rgb))'\r\n                />\r\n            </clipPath>\r\n        </defs>\r\n    </svg>\r\n\r\n);\r\n\r\nexport default PublicChannelIntroSvg;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport * as React from 'react';\r\n\r\ntype SvgProps = {\r\n    width?: number;\r\n    height?: number;\r\n};\r\n\r\nconst SvgComponent = (props: SvgProps) => (\r\n    <svg\r\n        width={props.width ?? '130'}\r\n        height={props.height ?? '92'}\r\n        viewBox='0 0 130 92'\r\n        fill='none'\r\n        xmlns='http://www.w3.org/2000/svg'\r\n        xmlnsXlink='http://www.w3.org/1999/xlink'\r\n        {...props}\r\n    >\r\n        <g clipPath='url(#clip0_4210_88396)'>\r\n            <path\r\n                d='M2.50001 6.00001L2.5 21L127.5 21L127.5 65L66 65'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.24'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M2.49999 59L2.49999 32L29 32'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.24'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M18.5 60.5L18.5 46.5L106 46.5'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.24'\r\n                strokeLinecap='round'\r\n            />\r\n            <circle\r\n                cx='2.5'\r\n                cy='2.5'\r\n                r='2.5'\r\n                transform='matrix(1 8.74228e-08 8.74228e-08 -1 0 6)'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.32'\r\n            />\r\n            <circle\r\n                cx='2.5'\r\n                cy='2.5'\r\n                r='2.5'\r\n                transform='matrix(1 8.74228e-08 8.74228e-08 -1 0 64)'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.32'\r\n            />\r\n            <circle\r\n                cx='2.5'\r\n                cy='2.5'\r\n                r='2.5'\r\n                transform='matrix(1 8.74228e-08 8.74228e-08 -1 16 64)'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.4'\r\n            />\r\n            <circle\r\n                cx='71'\r\n                cy='49'\r\n                r='43'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.12'\r\n            />\r\n            <path\r\n                d='M109.748 82.5258L117.999 91V47C117.999 45.8954 117.104 45 115.999 45H74.9998C73.8952 45 72.9998 45.8954 72.9998 47V79.9211C72.9998 81.0256 73.8952 81.9211 74.9998 81.9211H108.315C108.855 81.9211 109.371 82.1391 109.748 82.5258Z'\r\n                fill='#28427B'\r\n            />\r\n            <circle\r\n                opacity='0.48'\r\n                cx='85.8309'\r\n                cy='56.831'\r\n                r='5.83099'\r\n                fill='#FFFFFF'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M94.9999 55H111'\r\n                stroke='#FFFFFF'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M80.9999 70H102.38'\r\n                stroke='#FFFFFF'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M80.9999 74H95.2535'\r\n                stroke='#FFFFFF'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M94.9999 59H109'\r\n                stroke='#FFFFFF'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M80.9999 66H92.014'\r\n                stroke='#FFFFFF'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                opacity='0.4'\r\n                d='M94.6064 66H106.268'\r\n                stroke='#FFFFFF'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M28.605 57.5638L15 71V2C15 0.895431 15.8954 0 17 0H83C84.1046 0 85 0.89543 85 2V54.9868C85 56.0914 84.1046 56.9868 83 56.9868H30.0103C29.4842 56.9868 28.9793 57.1941 28.605 57.5638Z'\r\n                fill='var(--center-channel-bg)'\r\n            />\r\n            <path\r\n                d='M28.2536 57.2081L15.5 69.8035V2C15.5 1.17157 16.1716 0.5 17 0.5H83C83.8284 0.5 84.5 1.17157 84.5 2V54.9868C84.5 55.8153 83.8284 56.4868 83 56.4868H30.0103C29.3527 56.4868 28.7215 56.746 28.2536 57.2081Z'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.8'\r\n            />\r\n            <circle\r\n                cx='33'\r\n                cy='19'\r\n                r='9'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.4'\r\n            />\r\n            <path\r\n                d='M48 15H64'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.4'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M25 39H69'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.4'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M25 45H47'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.4'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M48 21H73'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.4'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M25 33H42'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.4'\r\n                strokeLinecap='round'\r\n            />\r\n            <path\r\n                d='M46 33H64'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.4'\r\n                strokeLinecap='round'\r\n            />\r\n            <circle\r\n                cx='44'\r\n                cy='65'\r\n                r='2'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.32'\r\n            />\r\n            <circle\r\n                cx='52'\r\n                cy='65'\r\n                r='2'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.32'\r\n            />\r\n            <circle\r\n                cx='60'\r\n                cy='65'\r\n                r='2'\r\n                fill='var(--center-channel-color)'\r\n                fillOpacity='0.32'\r\n            />\r\n            <path\r\n                d='M101 33L83 33'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.8'\r\n                strokeLinecap='round'\r\n                strokeLinejoin='round'\r\n            />\r\n            <path\r\n                d='M79 33L73 33'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.8'\r\n                strokeLinecap='round'\r\n                strokeLinejoin='round'\r\n            />\r\n            <path\r\n                d='M70 33L68 33'\r\n                stroke='var(--center-channel-color)'\r\n                strokeOpacity='0.8'\r\n                strokeLinecap='round'\r\n                strokeLinejoin='round'\r\n            />\r\n        </g>\r\n        <defs>\r\n            <clipPath id='clip0_4210_88396'>\r\n                <rect\r\n                    width='130'\r\n                    height='92'\r\n                    fill='white'\r\n                />\r\n            </clipPath>\r\n        </defs>\r\n    </svg>\r\n);\r\n\r\nexport default SvgComponent;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\nimport {useSelector} from 'react-redux';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\n\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport AddGroupsToChannelModal from 'components/add_groups_to_channel_modal';\r\nimport ChannelInviteModal from 'components/channel_invite_modal';\r\nimport InvitationModal from 'components/invitation_modal';\r\nimport ChannelPermissionGate from 'components/permissions_gates/channel_permission_gate';\r\nimport TeamPermissionGate from 'components/permissions_gates/team_permission_gate';\r\nimport ToggleModalButton from 'components/toggle_modal_button';\r\nimport LoadingSpinner from 'components/widgets/loading/loading_spinner';\r\n\r\nimport {Constants, ModalIdentifiers} from 'utils/constants';\r\n\r\nimport './add_members_button.scss';\r\n\r\nexport interface AddMembersButtonProps {\r\n    totalUsers?: number;\r\n    usersLimit: number;\r\n    channel: Channel;\r\n    pluginButtons?: React.ReactNode;\r\n}\r\n\r\nconst AddMembersButton: React.FC<AddMembersButtonProps> = ({totalUsers, usersLimit, channel, pluginButtons}: AddMembersButtonProps) => {\r\n    const currentTeamId = useSelector(getCurrentTeamId);\r\n\r\n    if (!totalUsers) {\r\n        return (<LoadingSpinner/>);\r\n    }\r\n\r\n    const inviteUsers = totalUsers < usersLimit;\r\n\r\n    return (\r\n        <TeamPermissionGate\r\n            teamId={currentTeamId}\r\n            permissions={[Permissions.ADD_USER_TO_TEAM, Permissions.INVITE_GUEST]}\r\n        >\r\n            {inviteUsers ? (\r\n                <LessThanMaxFreeUsers\r\n                    pluginButtons={pluginButtons}\r\n                />\r\n            ) : (\r\n                <MoreThanMaxFreeUsers\r\n                    channel={channel}\r\n                    pluginButtons={pluginButtons}\r\n                />\r\n            )}\r\n        </TeamPermissionGate>\r\n    );\r\n};\r\n\r\nconst LessThanMaxFreeUsers = ({pluginButtons}: {pluginButtons: React.ReactNode}) => {\r\n    const {formatMessage} = useIntl();\r\n\r\n    return (\r\n        <>\r\n            {pluginButtons}\r\n            <div className='LessThanMaxFreeUsers'>\r\n                <ToggleModalButton\r\n                    id='introTextInvite'\r\n                    className='btn btn-sm btn-primary'\r\n                    modalId={ModalIdentifiers.INVITATION}\r\n                    dialogType={InvitationModal}\r\n                    dialogProps={{focusOriginElement: 'browseOrAddChannelMenuButton'}}\r\n                >\r\n                    <i\r\n                        className='icon-email-plus-outline'\r\n                        title={formatMessage({id: 'generic_icons.add', defaultMessage: 'Add Icon'})}\r\n                        aria-hidden='true'\r\n                    />\r\n                    <FormattedMessage\r\n                        id='intro_messages.inviteOthersToWorkspace.button'\r\n                        defaultMessage='Invite others to the workspace'\r\n                    />\r\n                </ToggleModalButton>\r\n            </div>\r\n        </>\r\n    );\r\n};\r\n\r\nconst MoreThanMaxFreeUsers = ({channel, pluginButtons}: {channel: Channel; pluginButtons: React.ReactNode}) => {\r\n    const {formatMessage} = useIntl();\r\n\r\n    const modalId = channel.group_constrained ? ModalIdentifiers.ADD_GROUPS_TO_CHANNEL : ModalIdentifiers.CHANNEL_INVITE;\r\n    const modal = channel.group_constrained ? AddGroupsToChannelModal : ChannelInviteModal;\r\n    const channelIsArchived = channel.delete_at !== 0;\r\n    if (channelIsArchived) {\r\n        return null;\r\n    }\r\n    const isPrivate = channel.type === Constants.PRIVATE_CHANNEL;\r\n\r\n    return (\r\n        <div className='MoreThanMaxFreeUsersWrapper'>\r\n            <div className='MoreThanMaxFreeUsers'>\r\n                <ChannelPermissionGate\r\n                    channelId={channel.id}\r\n                    teamId={channel.team_id}\r\n                    permissions={[isPrivate ? Permissions.MANAGE_PRIVATE_CHANNEL_MEMBERS : Permissions.MANAGE_PUBLIC_CHANNEL_MEMBERS]}\r\n                >\r\n                    <ToggleModalButton\r\n                        className='action-button'\r\n                        modalId={modalId}\r\n                        dialogType={modal}\r\n                        dialogProps={{channel}}\r\n                    >\r\n                        <i\r\n                            className='icon-account-plus-outline'\r\n                            title={formatMessage({id: 'generic_icons.add', defaultMessage: 'Add Icon'})}\r\n                            aria-hidden='true'\r\n                        />\r\n                        {channel.group_constrained &&\r\n                            <FormattedMessage\r\n                                id='intro_messages.inviteGropusToChannel.button'\r\n                                defaultMessage='Add groups'\r\n                            />}\r\n                        {!channel.group_constrained &&\r\n                            <FormattedMessage\r\n                                id='intro_messages.inviteMembersToChannel.button'\r\n                                defaultMessage='Add people'\r\n                            />}\r\n                    </ToggleModalButton>\r\n                </ChannelPermissionGate>\r\n            </div>\r\n            {pluginButtons}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default React.memo(AddMembersButton);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\n\r\nimport type {Channel, ChannelMembership} from '@mattermost/types/channels';\r\n\r\nimport {usePluginVisibilityInSharedChannel} from 'components/common/hooks/usePluginVisibilityInSharedChannel';\r\n\r\nimport type {ChannelIntroButtonAction} from 'types/store/plugins';\r\n\r\ntype Props = {\r\n    channel: Channel;\r\n    channelMember?: ChannelMembership;\r\n    pluginButtons: ChannelIntroButtonAction[];\r\n}\r\n\r\nconst PluggableIntroButtons = React.memo(({\r\n    channel,\r\n    pluginButtons,\r\n    channelMember,\r\n}: Props) => {\r\n    const channelIsArchived = channel.delete_at !== 0;\r\n    const pluginItemsVisible = usePluginVisibilityInSharedChannel(channel.id);\r\n\r\n    if (!pluginItemsVisible) {\r\n        return null;\r\n    }\r\n\r\n    if (channelIsArchived || pluginButtons.length === 0 || !channelMember) {\r\n        return null;\r\n    }\r\n\r\n    const buttons = pluginButtons.map((buttonProps) => {\r\n        return (\r\n            <button\r\n                key={buttonProps.id}\r\n                className={'action-button'}\r\n                onClick={() => buttonProps.action?.(channel, channelMember)}\r\n            >\r\n                {buttonProps.icon}\r\n                {buttonProps.text}\r\n            </button>\r\n        );\r\n    });\r\n\r\n    return <>{buttons}</>;\r\n});\r\nPluggableIntroButtons.displayName = 'PluggableIntroButtons';\r\n\r\nexport default PluggableIntroButtons;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\n\r\nimport {getMyChannelMembership} from 'mattermost-redux/selectors/entities/channels';\r\n\r\nimport {getChannelIntroPluginButtons} from 'selectors/plugins';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport PluggableIntroButtons from './pluggable_intro_buttons';\r\n\r\ntype OwnProps = {\r\n    channel: Channel;\r\n}\r\n\r\nfunction mapStateToProps(state: GlobalState, ownProps: OwnProps) {\r\n    return {\r\n        channelMember: getMyChannelMembership(state, ownProps.channel.id),\r\n        pluginButtons: getChannelIntroPluginButtons(state),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps)(PluggableIntroButtons);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedDate, FormattedMessage, defineMessages} from 'react-intl';\r\n\r\nimport {BellRingOutlineIcon, GlobeIcon, PencilOutlineIcon, StarOutlineIcon, LockOutlineIcon, StarIcon} from '@mattermost/compass-icons/components';\r\nimport type {Channel, ChannelMembership} from '@mattermost/types/channels';\r\nimport type {UserProfile as UserProfileType} from '@mattermost/types/users';\r\n\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {NotificationLevel} from 'mattermost-redux/constants/channels';\r\nimport {isChannelMuted} from 'mattermost-redux/utils/channel_utils';\r\n\r\nimport AddGroupsToTeamModal from 'components/add_groups_to_team_modal';\r\nimport ChannelNotificationsModal from 'components/channel_notifications_modal';\r\nimport ChannelIntroPrivateSvg from 'components/common/svg_images_components/channel_intro_private_svg';\r\nimport ChannelIntroPublicSvg from 'components/common/svg_images_components/channel_intro_public_svg';\r\nimport ChannelIntroTownSquareSvg from 'components/common/svg_images_components/channel_intro_town_square_svg';\r\nimport EditChannelHeaderModal from 'components/edit_channel_header_modal';\r\nimport ChannelPermissionGate from 'components/permissions_gates/channel_permission_gate';\r\nimport TeamPermissionGate from 'components/permissions_gates/team_permission_gate';\r\nimport ProfilePicture from 'components/profile_picture';\r\nimport ToggleModalButton from 'components/toggle_modal_button';\r\nimport UserProfile from 'components/user_profile';\r\n\r\nimport {Constants, ModalIdentifiers} from 'utils/constants';\r\nimport {getMonthLong} from 'utils/i18n';\r\nimport * as Utils from 'utils/utils';\r\n\r\nimport AddMembersButton from './add_members_button';\r\nimport PluggableIntroButtons from './pluggable_intro_buttons';\r\n\r\ntype Props = {\r\n    currentUserId: string;\r\n    channel?: Channel;\r\n    fullWidth: boolean;\r\n    locale: string;\r\n    channelProfiles: UserProfileType[];\r\n    enableUserCreation?: boolean;\r\n    isReadOnly?: boolean;\r\n    isFavorite: boolean;\r\n    teamIsGroupConstrained?: boolean;\r\n    creatorName: string;\r\n    teammate?: UserProfileType;\r\n    teammateName?: string;\r\n    currentUser: UserProfileType;\r\n    stats: any;\r\n    usersLimit: number;\r\n    channelMember?: ChannelMembership;\r\n    isMobileView: boolean;\r\n    actions: {\r\n        getTotalUsersStats: () => any;\r\n        favoriteChannel: (channelId: string) => any;\r\n        unfavoriteChannel: (channelId: string) => any;\r\n    };\r\n}\r\n\r\nexport default class ChannelIntroMessage extends React.PureComponent<Props> {\r\n    toggleFavorite = () => {\r\n        if (!this.props.channel) {\r\n            return;\r\n        }\r\n\r\n        if (this.props.isFavorite) {\r\n            this.props.actions.unfavoriteChannel(this.props.channel.id);\r\n        } else {\r\n            this.props.actions.favoriteChannel(this.props.channel.id);\r\n        }\r\n    };\r\n\r\n    componentDidMount() {\r\n        if (!this.props.stats?.total_users_count) {\r\n            this.props.actions.getTotalUsersStats();\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const {\r\n            currentUserId,\r\n            channel,\r\n            fullWidth,\r\n            locale,\r\n            channelProfiles,\r\n            enableUserCreation,\r\n            isReadOnly,\r\n            isFavorite,\r\n            teamIsGroupConstrained,\r\n            creatorName,\r\n            teammate,\r\n            teammateName,\r\n            currentUser,\r\n            stats,\r\n            usersLimit,\r\n            channelMember,\r\n            isMobileView,\r\n        } = this.props;\r\n\r\n        let centeredIntro = '';\r\n        if (!fullWidth) {\r\n            centeredIntro = 'channel-intro--centered';\r\n        }\r\n\r\n        if (!channel) {\r\n            return null;\r\n        }\r\n\r\n        if (channel.type === Constants.DM_CHANNEL) {\r\n            return createDMIntroMessage(channel, centeredIntro, currentUser, isFavorite, isMobileView, this.toggleFavorite, teammate, teammateName);\r\n        } else if (channel.type === Constants.GM_CHANNEL) {\r\n            return createGMIntroMessage(channel, centeredIntro, isFavorite, isMobileView, this.toggleFavorite, channelProfiles, currentUserId, currentUser, channelMember);\r\n        } else if (channel.name === Constants.DEFAULT_CHANNEL) {\r\n            return createDefaultIntroMessage(channel, centeredIntro, currentUser, isFavorite, isMobileView, this.toggleFavorite, stats, usersLimit, enableUserCreation, isReadOnly, teamIsGroupConstrained);\r\n        } else if (channel.name === Constants.OFFTOPIC_CHANNEL) {\r\n            return createOffTopicIntroMessage(channel, centeredIntro, isFavorite, isMobileView, currentUser, this.toggleFavorite, stats, usersLimit);\r\n        } else if (channel.type === Constants.OPEN_CHANNEL || channel.type === Constants.PRIVATE_CHANNEL) {\r\n            return createStandardIntroMessage(channel, centeredIntro, currentUser, isFavorite, isMobileView, this.toggleFavorite, stats, usersLimit, locale, creatorName);\r\n        }\r\n        return null;\r\n    }\r\n}\r\n\r\nconst gmIntroMessages = defineMessages({\r\n    muted: {id: 'intro_messages.GM.muted', defaultMessage: 'This group message is currently <b>muted</b>, so you will not be notified.'},\r\n    [NotificationLevel.ALL]: {id: 'intro_messages.GM.all', defaultMessage: 'You\\'ll be notified <b>for all activity</b> in this group message.'},\r\n    [NotificationLevel.DEFAULT]: {id: 'intro_messages.GM.all', defaultMessage: 'You\\'ll be notified <b>for all activity</b> in this group message.'},\r\n    [NotificationLevel.MENTION]: {id: 'intro_messages.GM.mention', defaultMessage: 'You have selected to be notified <b>only when mentioned</b> in this group message.'},\r\n    [NotificationLevel.NONE]: {id: 'intro_messages.GM.none', defaultMessage: 'You have selected to <b>never</b> be notified in this group message.'},\r\n});\r\n\r\nconst getGMIntroMessageSpecificPart = (userProfile: UserProfileType | undefined, membership: ChannelMembership | undefined) => {\r\n    const isMuted = isChannelMuted(membership);\r\n    if (isMuted) {\r\n        return (\r\n            <FormattedMessage\r\n                {...gmIntroMessages.muted}\r\n                values={{\r\n                    b: (chunks) => <b>{chunks}</b>,\r\n                }}\r\n            />\r\n        );\r\n    }\r\n    const channelNotifyProp = membership?.notify_props?.desktop || NotificationLevel.DEFAULT;\r\n    const userNotifyProp = userProfile?.notify_props?.desktop || NotificationLevel.MENTION;\r\n    let notifyLevelToUse = channelNotifyProp;\r\n    if (notifyLevelToUse === NotificationLevel.DEFAULT) {\r\n        notifyLevelToUse = userNotifyProp;\r\n    }\r\n    if (channelNotifyProp === NotificationLevel.DEFAULT && userNotifyProp === NotificationLevel.MENTION) {\r\n        notifyLevelToUse = NotificationLevel.ALL;\r\n    }\r\n\r\n    return (\r\n        <FormattedMessage\r\n            {...gmIntroMessages[notifyLevelToUse]}\r\n            values={{\r\n                b: (chunks) => <b>{chunks}</b>,\r\n            }}\r\n        />\r\n    );\r\n};\r\n\r\nfunction createGMIntroMessage(\r\n    channel: Channel,\r\n    centeredIntro: string,\r\n    isFavorite: boolean,\r\n    isMobileView: boolean,\r\n    toggleFavorite: () => void,\r\n    profiles: UserProfileType[],\r\n    currentUserId: string,\r\n    currentUser: UserProfileType,\r\n    channelMembership?: ChannelMembership,\r\n) {\r\n    const channelIntroId = 'channelIntro';\r\n\r\n    if (profiles.length > 0) {\r\n        const currentUserProfile = profiles.find((v) => v.id === currentUserId);\r\n\r\n        const pictures = profiles.\r\n            filter((profile) => profile.id !== currentUserId).\r\n            map((profile) => (\r\n                <ProfilePicture\r\n                    key={'introprofilepicture' + profile.id}\r\n                    src={Utils.imageURLForUser(profile.id, profile.last_picture_update)}\r\n                    size='xl-custom-GM'\r\n                    userId={profile.id}\r\n                    username={profile.username}\r\n                />\r\n            ));\r\n\r\n        const actionButtons = (\r\n            <div className='channel-intro__actions'>\r\n                {createFavoriteButton(isFavorite, toggleFavorite)}\r\n                {createSetHeaderButton(channel)}\r\n                {!isMobileView && createNotificationPreferencesButton(channel, currentUser)}\r\n                <PluggableIntroButtons channel={channel}/>\r\n            </div>\r\n        );\r\n\r\n        return (\r\n            <div\r\n                id={channelIntroId}\r\n                className={'channel-intro ' + centeredIntro}\r\n            >\r\n                <div className='post-profile-img__container channel-intro-img channel-intro-img__group'>\r\n                    {pictures}\r\n                </div>\r\n                <h2 className='channel-intro__title'>\r\n                    {channel.display_name}\r\n                </h2>\r\n                <p className='channel-intro__text'>\r\n                    <FormattedMessage\r\n                        id='intro_messages.group_message'\r\n                        defaultMessage={'This is the start of your group message history with these teammates. '}\r\n                    />\r\n                    {getGMIntroMessageSpecificPart(currentUserProfile, channelMembership)}\r\n                </p>\r\n                {actionButtons}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div\r\n            id={channelIntroId}\r\n            className={'channel-intro ' + centeredIntro}\r\n        >\r\n            <p className='channel-intro__text'>\r\n                <FormattedMessage\r\n                    id='intro_messages.group_message'\r\n                    defaultMessage='This is the start of your group message history with these teammates. Messages and files shared here are not shown to people outside this area.'\r\n                />\r\n            </p>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction createDMIntroMessage(\r\n    channel: Channel,\r\n    centeredIntro: string,\r\n    currentUser: UserProfileType,\r\n    isFavorite: boolean,\r\n    isMobileView: boolean,\r\n    toggleFavorite: () => void,\r\n    teammate?: UserProfileType,\r\n    teammateName?: string,\r\n) {\r\n    const channelIntroId = 'channelIntro';\r\n    if (teammate) {\r\n        const src = teammate ? Utils.imageURLForUser(teammate.id, teammate.last_picture_update) : '';\r\n\r\n        let pluggableButton = null;\r\n        let setHeaderButton = null;\r\n        if (!teammate?.is_bot) {\r\n            pluggableButton = <PluggableIntroButtons channel={channel}/>;\r\n            setHeaderButton = createSetHeaderButton(channel);\r\n        }\r\n\r\n        const actionButtons = (\r\n            <div className='channel-intro__actions'>\r\n                {createFavoriteButton(isFavorite, toggleFavorite)}\r\n                {setHeaderButton}\r\n                {pluggableButton}\r\n            </div>\r\n        );\r\n\r\n        return (\r\n            <div\r\n                id={channelIntroId}\r\n                className={'channel-intro ' + centeredIntro}\r\n            >\r\n                <div className='post-profile-img__container channel-intro-img'>\r\n                    <ProfilePicture\r\n                        src={src}\r\n                        size='xl-custom-DM'\r\n                        status={teammate.is_bot ? '' : channel.status}\r\n                        userId={teammate?.id}\r\n                        username={teammate?.username}\r\n                    />\r\n                </div>\r\n                <h2 className='channel-intro__title'>\r\n                    <UserProfile\r\n                        userId={teammate?.id}\r\n                    />\r\n                </h2>\r\n                <p className='channel-intro__text'>\r\n                    <FormattedMessage\r\n                        id='intro_messages.DM'\r\n                        defaultMessage='This is the start of your direct message history with {teammate}. Messages and files shared here are not shown to anyone else.'\r\n                        values={{\r\n                            teammate: teammateName,\r\n                        }}\r\n                    />\r\n                </p>\r\n                {actionButtons}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div\r\n            id={channelIntroId}\r\n            className={'channel-intro ' + centeredIntro}\r\n        >\r\n            <p className='channel-intro__text'>\r\n                <FormattedMessage\r\n                    id='intro_messages.teammate'\r\n                    defaultMessage='This is the start of your direct message history with this teammate. Messages and files shared here are not shown to anyone else.'\r\n                />\r\n            </p>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction createOffTopicIntroMessage(\r\n    channel: Channel,\r\n    centeredIntro: string,\r\n    isFavorite: boolean,\r\n    isMobileView: boolean,\r\n    currentUser: UserProfileType,\r\n    toggleFavorite: () => void,\r\n    stats: any,\r\n    usersLimit: number,\r\n) {\r\n    const isPrivate = channel.type === Constants.PRIVATE_CHANNEL;\r\n    const children = createSetHeaderButton(channel);\r\n    const totalUsers = stats.total_users_count;\r\n    const inviteUsers = totalUsers < usersLimit;\r\n\r\n    let setHeaderButton = null;\r\n    let actionButtons = null;\r\n\r\n    if (children) {\r\n        setHeaderButton = (\r\n            <ChannelPermissionGate\r\n                teamId={channel.team_id}\r\n                channelId={channel.id}\r\n                permissions={[isPrivate ? Permissions.MANAGE_PRIVATE_CHANNEL_PROPERTIES : Permissions.MANAGE_PUBLIC_CHANNEL_PROPERTIES]}\r\n            >\r\n                {children}\r\n            </ChannelPermissionGate>\r\n        );\r\n    }\r\n\r\n    const channelInviteButton = (\r\n        <AddMembersButton\r\n            totalUsers={totalUsers}\r\n            usersLimit={usersLimit}\r\n            channel={channel}\r\n            pluginButtons={<PluggableIntroButtons channel={channel}/>}\r\n        />\r\n    );\r\n\r\n    if (inviteUsers) {\r\n        actionButtons = (\r\n            <div className='channel-intro__actions'>\r\n                {actionButtons = channelInviteButton}\r\n            </div>\r\n        );\r\n    } else {\r\n        actionButtons = (\r\n            <div className='channel-intro__actions'>\r\n                {createFavoriteButton(isFavorite, toggleFavorite)}\r\n                {setHeaderButton}\r\n                {createNotificationPreferencesButton(channel, currentUser)}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div\r\n            id='channelIntro'\r\n            className={'channel-intro ' + centeredIntro}\r\n        >\r\n            <ChannelIntroPublicSvg/>\r\n            <h2 className='channel-intro__title'>\r\n                {channel.display_name}\r\n            </h2>\r\n            <p className='channel-intro__text'>\r\n                <FormattedMessage\r\n                    id='intro_messages.offTopic'\r\n                    defaultMessage='This is the start of {display_name}, a channel for non-work-related conversations.'\r\n                    values={{\r\n                        display_name: channel.display_name,\r\n                    }}\r\n                />\r\n            </p>\r\n            {actionButtons}\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction createDefaultIntroMessage(\r\n    channel: Channel,\r\n    centeredIntro: string,\r\n    currentUser: UserProfileType,\r\n    isFavorite: boolean,\r\n    isMobileView: boolean,\r\n    toggleFavorite: () => void,\r\n    stats: any,\r\n    usersLimit: number,\r\n    enableUserCreation?: boolean,\r\n    isReadOnly?: boolean,\r\n    teamIsGroupConstrained?: boolean,\r\n) {\r\n    let teamInviteLink = null;\r\n    const totalUsers = stats.total_users_count;\r\n    const isPrivate = channel.type === Constants.PRIVATE_CHANNEL;\r\n    const inviteUsers = totalUsers < usersLimit;\r\n\r\n    let setHeaderButton = null;\r\n    let pluginButtons = null;\r\n    let actionButtons = null;\r\n\r\n    if (!isReadOnly) {\r\n        pluginButtons = <PluggableIntroButtons channel={channel}/>;\r\n        const children = createSetHeaderButton(channel);\r\n        if (children) {\r\n            setHeaderButton = (\r\n                <ChannelPermissionGate\r\n                    teamId={channel.team_id}\r\n                    channelId={channel.id}\r\n                    permissions={[isPrivate ? Permissions.MANAGE_PRIVATE_CHANNEL_PROPERTIES : Permissions.MANAGE_PUBLIC_CHANNEL_PROPERTIES]}\r\n                >\r\n                    {children}\r\n                </ChannelPermissionGate>\r\n            );\r\n        }\r\n    }\r\n\r\n    if (!isReadOnly && enableUserCreation) {\r\n        teamInviteLink = (\r\n            <TeamPermissionGate\r\n                teamId={channel.team_id}\r\n                permissions={[Permissions.INVITE_USER]}\r\n            >\r\n                <TeamPermissionGate\r\n                    teamId={channel.team_id}\r\n                    permissions={[Permissions.ADD_USER_TO_TEAM]}\r\n                >\r\n                    {!teamIsGroupConstrained &&\r\n                        <AddMembersButton\r\n                            totalUsers={totalUsers}\r\n                            usersLimit={usersLimit}\r\n                            channel={channel}\r\n                            pluginButtons={pluginButtons}\r\n                        />\r\n                    }\r\n                    {teamIsGroupConstrained &&\r\n                    <ToggleModalButton\r\n                        className='intro-links color--link'\r\n                        modalId={ModalIdentifiers.ADD_GROUPS_TO_TEAM}\r\n                        dialogType={AddGroupsToTeamModal}\r\n                        dialogProps={{channel}}\r\n                    >\r\n                        <i\r\n                            className='fa fa-user-plus'\r\n                        />\r\n                        <FormattedMessage\r\n                            id='intro_messages.addGroupsToTeam'\r\n                            defaultMessage='Add other groups to this team'\r\n                        />\r\n                    </ToggleModalButton>\r\n                    }\r\n                </TeamPermissionGate>\r\n            </TeamPermissionGate>\r\n        );\r\n    }\r\n\r\n    if (inviteUsers) {\r\n        actionButtons = (\r\n            <div className='channel-intro__actions'>\r\n                {actionButtons = teamInviteLink}\r\n            </div>\r\n        );\r\n    } else {\r\n        actionButtons = (\r\n            <div className='channel-intro__actions'>\r\n                {createFavoriteButton(isFavorite, toggleFavorite)}\r\n                {setHeaderButton}\r\n                {createNotificationPreferencesButton(channel, currentUser)}\r\n                {teamIsGroupConstrained && pluginButtons}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div\r\n            id='channelIntro'\r\n            className={'channel-intro ' + centeredIntro}\r\n        >\r\n            <ChannelIntroTownSquareSvg/>\r\n            <h2 className='channel-intro__title'>\r\n                {channel.display_name}\r\n            </h2>\r\n            <p className='channel-intro__text'>\r\n                {!isReadOnly &&\r\n                    <FormattedMessage\r\n                        id='intro_messages.default'\r\n                        defaultMessage='Welcome to {display_name}. Post messages here that you want everyone to see. Everyone automatically becomes a member of this channel when they join the team.'\r\n                        values={{\r\n                            display_name: channel.display_name,\r\n                        }}\r\n                    />\r\n                }\r\n                {isReadOnly &&\r\n                    <FormattedMessage\r\n                        id='intro_messages.readonly.default'\r\n                        defaultMessage='Welcome to {display_name}. Messages can only be posted by admins. Everyone automatically becomes a permanent member of this channel when they join the team.'\r\n                        values={{\r\n                            display_name: channel.display_name,\r\n                        }}\r\n                    />\r\n                }\r\n            </p>\r\n            {actionButtons}\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction createStandardIntroMessage(\r\n    channel: Channel,\r\n    centeredIntro: string,\r\n    currentUser: UserProfileType,\r\n    isFavorite: boolean,\r\n    isMobileView: boolean,\r\n    toggleFavorite: () => void,\r\n    stats: any,\r\n    usersLimit: number,\r\n    locale: string,\r\n    creatorName: string,\r\n) {\r\n    const uiName = channel.display_name;\r\n    let memberMessage;\r\n    let teamInviteLink = null;\r\n    const channelIsArchived = channel.delete_at !== 0;\r\n    const totalUsers = stats.total_users_count;\r\n    const inviteUsers = totalUsers < usersLimit;\r\n\r\n    if (channelIsArchived) {\r\n        memberMessage = '';\r\n    } else if (channel.type === Constants.PRIVATE_CHANNEL) {\r\n        memberMessage = (\r\n            <FormattedMessage\r\n                id='intro_messages.onlyInvited'\r\n                defaultMessage='This is the start of {display_name}. Only invited members can see this private channel.'\r\n                values={{\r\n                    display_name: channel.display_name,\r\n                }}\r\n            />\r\n        );\r\n    } else {\r\n        memberMessage = (\r\n            <FormattedMessage\r\n                id='intro_messages.anyMember'\r\n                defaultMessage='This is the start of {display_name}. Any team member can join and read this channel.'\r\n                values={{\r\n                    display_name: channel.display_name,\r\n                }}\r\n            />\r\n        );\r\n    }\r\n\r\n    const date = (\r\n        <FormattedDate\r\n            value={channel.create_at}\r\n            month={getMonthLong(locale)}\r\n            day='2-digit'\r\n            year='numeric'\r\n        />\r\n    );\r\n\r\n    let createMessage;\r\n    if (creatorName === '') {\r\n        if (channel.type === Constants.PRIVATE_CHANNEL) {\r\n            createMessage = (\r\n                <FormattedMessage\r\n                    id='intro_messages.noCreatorPrivate'\r\n                    defaultMessage='Private channel created on {date}.'\r\n                    values={{name: (uiName), date}}\r\n                />\r\n            );\r\n        } else if (channel.type === Constants.OPEN_CHANNEL) {\r\n            createMessage = (\r\n                <FormattedMessage\r\n                    id='intro_messages.noCreator'\r\n                    defaultMessage='Public channel created on {date}.'\r\n                    values={{name: (uiName), date}}\r\n                />\r\n            );\r\n        }\r\n    } else if (channel.type === Constants.PRIVATE_CHANNEL) {\r\n        createMessage = (\r\n            <span>\r\n                <FormattedMessage\r\n                    id='intro_messages.creatorPrivate'\r\n                    defaultMessage='Private channel created by {creator} on {date}.'\r\n                    values={{\r\n                        name: (uiName),\r\n                        creator: (creatorName),\r\n                        date,\r\n                    }}\r\n                />\r\n            </span>\r\n        );\r\n    } else if (channel.type === Constants.OPEN_CHANNEL) {\r\n        createMessage = (\r\n            <span>\r\n                <FormattedMessage\r\n                    id='intro_messages.creator'\r\n                    defaultMessage='Public channel created by {creator} on {date}.'\r\n                    values={{\r\n                        name: (uiName),\r\n                        creator: (creatorName),\r\n                        date,\r\n                    }}\r\n                />\r\n            </span>\r\n        );\r\n    }\r\n\r\n    let purposeMessage;\r\n    if (channel.purpose && channel.purpose !== '') {\r\n        purposeMessage = (\r\n            <span>\r\n                <FormattedMessage\r\n                    id='intro_messages.purpose'\r\n                    defaultMessage=\" This channel's purpose is: {purpose}\"\r\n                    values={{purpose: channel.purpose}}\r\n                />\r\n            </span>\r\n        );\r\n    }\r\n\r\n    const isPrivate = channel.type === Constants.PRIVATE_CHANNEL;\r\n    let setHeaderButton = null;\r\n    let actionButtons = null;\r\n    const children = createSetHeaderButton(channel);\r\n    if (children) {\r\n        setHeaderButton = (\r\n            <ChannelPermissionGate\r\n                teamId={channel.team_id}\r\n                channelId={channel.id}\r\n                permissions={[isPrivate ? Permissions.MANAGE_PRIVATE_CHANNEL_PROPERTIES : Permissions.MANAGE_PUBLIC_CHANNEL_PROPERTIES]}\r\n            >\r\n                {children}\r\n            </ChannelPermissionGate>\r\n        );\r\n    }\r\n\r\n    teamInviteLink = (\r\n        <AddMembersButton\r\n            totalUsers={totalUsers}\r\n            usersLimit={usersLimit}\r\n            channel={channel}\r\n            pluginButtons={<PluggableIntroButtons channel={channel}/>}\r\n        />\r\n    );\r\n\r\n    if (inviteUsers) {\r\n        actionButtons = (\r\n            <div className='channel-intro__actions'>\r\n                {actionButtons = teamInviteLink}\r\n            </div>\r\n        );\r\n    } else {\r\n        actionButtons = (\r\n            <div className='channel-intro__actions'>\r\n                {createFavoriteButton(isFavorite, toggleFavorite)}\r\n                {teamInviteLink}\r\n                {setHeaderButton}\r\n                {!isMobileView && createNotificationPreferencesButton(channel, currentUser)}\r\n                <PluggableIntroButtons channel={channel}/>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div\r\n            id='channelIntro'\r\n            className={'channel-intro ' + centeredIntro}\r\n        >\r\n            {isPrivate ? <ChannelIntroPrivateSvg/> : <ChannelIntroPublicSvg/>}\r\n            <h2 className='channel-intro__title'>\r\n                {channel.display_name}\r\n            </h2>\r\n            <div className='channel-intro__created'>\r\n                {isPrivate ? <LockOutlineIcon size={14}/> : <GlobeIcon size={14}/>}\r\n                {createMessage}\r\n            </div>\r\n            <p className='channel-intro__text'>\r\n                {memberMessage}\r\n                {purposeMessage}\r\n            </p>\r\n            {actionButtons}\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction createSetHeaderButton(channel: Channel) {\r\n    const channelIsArchived = channel.delete_at !== 0;\r\n    if (channelIsArchived) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <ToggleModalButton\r\n            modalId={ModalIdentifiers.EDIT_CHANNEL_HEADER}\r\n            ariaLabel={Utils.localizeMessage({id: 'intro_messages.setHeader', defaultMessage: 'Set header'})}\r\n            className={'action-button'}\r\n            dialogType={EditChannelHeaderModal}\r\n            dialogProps={{channel}}\r\n        >\r\n            <PencilOutlineIcon\r\n                size={24}\r\n            />\r\n            <FormattedMessage\r\n                id='intro_messages.setHeader'\r\n                defaultMessage='Set header'\r\n            />\r\n        </ToggleModalButton>\r\n    );\r\n}\r\n\r\nfunction createFavoriteButton(isFavorite: boolean, toggleFavorite: () => void, classes?: string) {\r\n    let favoriteText;\r\n    if (isFavorite) {\r\n        favoriteText = (\r\n            <FormattedMessage\r\n                id='channel_info_rhs.top_buttons.favorited'\r\n                defaultMessage='Favorited'\r\n            />);\r\n    } else {\r\n        favoriteText = (\r\n            <FormattedMessage\r\n                id='channel_info_rhs.top_buttons.favorite'\r\n                defaultMessage='Favorite'\r\n            />);\r\n    }\r\n    return (\r\n        <button\r\n            id='toggleFavoriteIntroButton'\r\n            className={`action-button ${isFavorite ? 'active' : ''}  ${classes}`}\r\n            onClick={toggleFavorite}\r\n            aria-label={'Favorite'}\r\n        >\r\n            {isFavorite ? <StarIcon size={24}/> : <StarOutlineIcon size={24}/>}\r\n            {favoriteText}\r\n        </button>\r\n    );\r\n}\r\n\r\nfunction createNotificationPreferencesButton(channel: Channel, currentUser: UserProfileType) {\r\n    return (\r\n        <ToggleModalButton\r\n            id='channelIntroNotificationPreferencesButton'\r\n            modalId={ModalIdentifiers.CHANNEL_NOTIFICATIONS}\r\n            ariaLabel={Utils.localizeMessage({id: 'intro_messages.notificationPreferences', defaultMessage: 'Notification Preferences'})}\r\n            className={'action-button'}\r\n            dialogType={ChannelNotificationsModal}\r\n            dialogProps={{channel, currentUser, focusOriginElement: 'channelIntroNotificationPreferencesButton'}}\r\n        >\r\n            <BellRingOutlineIcon size={24}/>\r\n            <FormattedMessage\r\n                id='intro_messages.notificationPreferences'\r\n                defaultMessage='Notifications'\r\n            />\r\n        </ToggleModalButton>\r\n    );\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {favoriteChannel, unfavoriteChannel} from 'mattermost-redux/actions/channels';\r\nimport {getTotalUsersStats} from 'mattermost-redux/actions/users';\r\nimport {getCurrentChannel, getDirectTeammate, getMyCurrentChannelMembership, isCurrentChannelFavorite} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {get} from 'mattermost-redux/selectors/entities/preferences';\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getCurrentUser, getProfilesInCurrentChannel, getCurrentUserId, getUser, getTotalUsersStats as getTotalUsersStatsSelector} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {getCurrentLocale} from 'selectors/i18n';\r\nimport {getIsMobileView} from 'selectors/views/browser';\r\n\r\nimport {Preferences} from 'utils/constants';\r\nimport {getDisplayNameByUser} from 'utils/utils';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport ChannelIntroMessage from './channel_intro_message';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const config = getConfig(state);\r\n    const enableUserCreation = config.EnableUserCreation === 'true';\r\n    const isReadOnly = false;\r\n    const team = getCurrentTeam(state);\r\n    const channel = getCurrentChannel(state);\r\n    const channelMember = getMyCurrentChannelMembership(state);\r\n    const teammate = channel ? getDirectTeammate(state, channel.id) : undefined;\r\n    const currentUser = getCurrentUser(state);\r\n    const creator = channel ? getUser(state, channel.creator_id) : undefined;\r\n\r\n    const usersLimit = 10;\r\n\r\n    const stats = getTotalUsersStatsSelector(state) || {total_users_count: 0};\r\n\r\n    return {\r\n        currentUserId: getCurrentUserId(state),\r\n        channel,\r\n        fullWidth: get(state, Preferences.CATEGORY_DISPLAY_SETTINGS, Preferences.CHANNEL_DISPLAY_MODE, Preferences.CHANNEL_DISPLAY_MODE_DEFAULT) === Preferences.CHANNEL_DISPLAY_MODE_FULL_SCREEN,\r\n        locale: getCurrentLocale(state),\r\n        channelProfiles: getProfilesInCurrentChannel(state),\r\n        enableUserCreation,\r\n        isReadOnly,\r\n        isFavorite: isCurrentChannelFavorite(state),\r\n        teamIsGroupConstrained: Boolean(team?.group_constrained),\r\n        creatorName: getDisplayNameByUser(state, creator),\r\n        teammate,\r\n        teammateName: getDisplayNameByUser(state, teammate),\r\n        currentUser,\r\n        stats,\r\n        usersLimit,\r\n        channelMember,\r\n        isMobileView: getIsMobileView(state),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            getTotalUsersStats,\r\n            favoriteChannel,\r\n            unfavoriteChannel,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ChannelIntroMessage);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport type {Post} from '@mattermost/types/posts';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\n\r\nimport * as PostListUtils from 'mattermost-redux/utils/post_list';\r\n\r\nimport type {emitShortcutReactToLastPostFrom} from 'actions/post_actions';\r\n\r\nimport CenterMessageLock from 'components/center_message_lock';\r\nimport PostComponent from 'components/post';\r\nimport ChannelIntroMessage from 'components/post_view/channel_intro_message/';\r\nimport CombinedUserActivityPost from 'components/post_view/combined_user_activity_post';\r\nimport DateSeparator from 'components/post_view/date_separator';\r\nimport NewMessageSeparator from 'components/post_view/new_message_separator/new_message_separator';\r\n\r\nimport {PostListRowListIds, Locations} from 'utils/constants';\r\nimport {isIdNotPost} from 'utils/post_utils';\r\n\r\nimport type {NewMessagesSeparatorActionComponent} from 'types/store/plugins';\r\n\r\nexport type PostListRowProps = {\r\n    listId: string;\r\n    previousListId?: string;\r\n    fullWidth?: boolean;\r\n    shouldHighlight?: boolean;\r\n    loadOlderPosts: () => void;\r\n    loadNewerPosts: () => void;\r\n    togglePostMenu: (opened: boolean) => void;\r\n    post: Post;\r\n    currentUserId: UserProfile['id'];\r\n\r\n    /**\r\n     * To Check if the current post is last in the list\r\n     */\r\n    isLastPost: boolean;\r\n\r\n    /**\r\n     * To check if the state of emoji for last message and from where it was emitted\r\n     */\r\n    shortcutReactToLastPostEmittedFrom: string;\r\n\r\n    /**\r\n     * is used for hiding animation of loader\r\n     */\r\n    loadingNewerPosts: boolean;\r\n    loadingOlderPosts: boolean;\r\n    exceededLimitChannelId?: string;\r\n    firstInaccessiblePostTime?: number;\r\n    channelId: string;\r\n\r\n    newMessagesSeparatorActions: NewMessagesSeparatorActionComponent[];\r\n\r\n    actions: {\r\n\r\n        /**\r\n          * Function to set or unset emoji picker for last message\r\n          */\r\n        emitShortcutReactToLastPostFrom: typeof emitShortcutReactToLastPostFrom;\r\n    };\r\n}\r\n\r\nexport default class PostListRow extends React.PureComponent<PostListRowProps> {\r\n    blockShortcutReactToLastPostForNonMessages(listId: string) {\r\n        const {actions: {emitShortcutReactToLastPostFrom}} = this.props;\r\n\r\n        if (isIdNotPost(listId)) {\r\n            // This is a good escape hatch as any of the above conditions don't return <Post/> component, Emoji picker is only at Post component\r\n            emitShortcutReactToLastPostFrom(Locations.NO_WHERE);\r\n        }\r\n    }\r\n\r\n    componentDidUpdate(prevProps: PostListRowProps) {\r\n        const {listId, isLastPost, shortcutReactToLastPostEmittedFrom} = this.props;\r\n\r\n        const shortcutReactToLastPostEmittedFromCenter = prevProps.shortcutReactToLastPostEmittedFrom !== shortcutReactToLastPostEmittedFrom &&\r\n            shortcutReactToLastPostEmittedFrom === Locations.CENTER;\r\n\r\n        // If last post is not a message then we block the shortcut to react to last message, early on\r\n        if (isLastPost && shortcutReactToLastPostEmittedFromCenter) {\r\n            this.blockShortcutReactToLastPostForNonMessages(listId);\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const {listId, previousListId, loadingOlderPosts, loadingNewerPosts} = this.props;\r\n        const {\r\n            OLDER_MESSAGES_LOADER,\r\n            NEWER_MESSAGES_LOADER,\r\n            CHANNEL_INTRO_MESSAGE,\r\n            LOAD_OLDER_MESSAGES_TRIGGER,\r\n            LOAD_NEWER_MESSAGES_TRIGGER,\r\n        } = PostListRowListIds;\r\n\r\n        if (PostListUtils.isDateLine(listId)) {\r\n            const date = PostListUtils.getDateForDateLine(listId);\r\n\r\n            return (\r\n                <DateSeparator\r\n                    key={date}\r\n                    date={date}\r\n                />\r\n            );\r\n        }\r\n\r\n        if (PostListUtils.isStartOfNewMessages(listId)) {\r\n            return (\r\n                <NewMessageSeparator\r\n                    separatorId={listId}\r\n                    newMessagesSeparatorActions={this.props.newMessagesSeparatorActions}\r\n                    channelId={this.props.channelId}\r\n                />\r\n            );\r\n        }\r\n\r\n        if (this.props.exceededLimitChannelId) {\r\n            return (\r\n                <CenterMessageLock/>\r\n            );\r\n        }\r\n\r\n        if (listId === CHANNEL_INTRO_MESSAGE) {\r\n            return (\r\n                <ChannelIntroMessage/>\r\n            );\r\n        }\r\n\r\n        if (listId === LOAD_OLDER_MESSAGES_TRIGGER || listId === LOAD_NEWER_MESSAGES_TRIGGER) {\r\n            return (\r\n                <button\r\n                    className='more-messages-text theme style--none color--link'\r\n                    onClick={listId === LOAD_OLDER_MESSAGES_TRIGGER ? this.props.loadOlderPosts : this.props.loadNewerPosts}\r\n                >\r\n                    <FormattedMessage\r\n                        id='posts_view.loadMore'\r\n                        defaultMessage='Load More Messages'\r\n                    />\r\n                </button>\r\n            );\r\n        }\r\n\r\n        const isOlderMessagesLoader = listId === OLDER_MESSAGES_LOADER;\r\n        const isNewerMessagesLoader = listId === NEWER_MESSAGES_LOADER;\r\n        if (isOlderMessagesLoader || isNewerMessagesLoader) {\r\n            const shouldHideAnimation = !loadingOlderPosts && !loadingNewerPosts;\r\n\r\n            return (\r\n                <div\r\n                    className='loading-screen'\r\n                >\r\n                    <div className={classNames('loading__content', {hideAnimation: shouldHideAnimation})}>\r\n                        <div className='round round-1'/>\r\n                        <div className='round round-2'/>\r\n                        <div className='round round-3'/>\r\n                    </div>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        const postProps = {\r\n            previousPostId: previousListId,\r\n            shouldHighlight: Boolean(this.props.shouldHighlight),\r\n            togglePostMenu: this.props.togglePostMenu,\r\n            isLastPost: this.props.isLastPost,\r\n        };\r\n\r\n        if (PostListUtils.isCombinedUserActivityPost(listId)) {\r\n            return (\r\n                <CombinedUserActivityPost\r\n                    location={Locations.CENTER}\r\n                    combinedId={listId}\r\n                    {...postProps}\r\n                />\r\n            );\r\n        }\r\n\r\n        // Don't render if post has been deleted/removed\r\n        if (!this.props.post) {\r\n            return null;\r\n        }\r\n\r\n        return (\r\n            <PostComponent\r\n                post={this.props.post}\r\n                location={Locations.CENTER}\r\n                {...postProps}\r\n            />\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {getCurrentChannelId, getCurrentUserId} from 'mattermost-redux/selectors/entities/common';\r\nimport {getLimitedViews, getPost} from 'mattermost-redux/selectors/entities/posts';\r\n\r\nimport {emitShortcutReactToLastPostFrom} from 'actions/post_actions';\r\nimport {getShortcutReactToLastPostEmittedFrom} from 'selectors/emojis';\r\n\r\nimport {PostListRowListIds} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport PostListRow from './post_list_row';\r\nimport type {PostListRowProps} from './post_list_row';\r\n\r\ntype OwnProps = Pick<PostListRowProps, 'listId'>\r\n\r\nfunction mapStateToProps(state: GlobalState, ownProps: OwnProps) {\r\n    const shortcutReactToLastPostEmittedFrom = getShortcutReactToLastPostEmittedFrom(state);\r\n    const post = getPost(state, ownProps.listId);\r\n    const currentUserId = getCurrentUserId(state);\r\n    const newMessagesSeparatorActions = state.plugins.components.NewMessagesSeparatorAction;\r\n\r\n    const props: Pick<\r\n    PostListRowProps,\r\n    'shortcutReactToLastPostEmittedFrom'| 'exceededLimitChannelId' | 'firstInaccessiblePostTime' | 'post' | 'currentUserId' | 'newMessagesSeparatorActions'\r\n    > = {\r\n        shortcutReactToLastPostEmittedFrom,\r\n        post,\r\n        currentUserId,\r\n        newMessagesSeparatorActions,\r\n    };\r\n    if ((ownProps.listId === PostListRowListIds.OLDER_MESSAGES_LOADER || ownProps.listId === PostListRowListIds.CHANNEL_INTRO_MESSAGE)) {\r\n        const currentChannelId = getCurrentChannelId(state);\r\n        const firstInaccessiblePostTime = getLimitedViews(state).channels[currentChannelId];\r\n        const channelLimitExceeded = Boolean(firstInaccessiblePostTime) || firstInaccessiblePostTime === 0;\r\n        if (channelLimitExceeded) {\r\n            props.exceededLimitChannelId = currentChannelId;\r\n            props.firstInaccessiblePostTime = firstInaccessiblePostTime;\r\n        }\r\n    }\r\n    return props;\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            emitShortcutReactToLastPostFrom,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(PostListRow);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nexport default function ScrollToBottomIcon(props: React.HTMLAttributes<HTMLSpanElement>) {\r\n    const {formatMessage} = useIntl();\r\n    return (\r\n        <span {...props}>\r\n            <svg\r\n                x='0px'\r\n                y='0px'\r\n                viewBox='-239 239 21 23'\r\n                enableBackground='new -239 239 21 23'\r\n                role='img'\r\n                aria-label={formatMessage({id: 'generic_icons.arrow.down', defaultMessage: 'Down Arrow Icon'})}\r\n            >\r\n                <path d='M-239,241.4l2.4-2.4l8.1,8.2l8.1-8.2l2.4,2.4l-10.5,10.6L-239,241.4z M-228.5,257.2l8.1-8.2l2.4,2.4l-10.5,10.6l-10.5-10.6 l2.4-2.4L-228.5,257.2z'/>\r\n            </svg>\r\n        </span>\r\n    );\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\n\r\nimport ScrollToBottomIcon from 'components/widgets/icons/scroll_to_bottom_icon';\r\n\r\ntype Props = {\r\n    isScrolling: boolean;\r\n    atBottom?: boolean;\r\n    onClick: () => void;\r\n};\r\n\r\nconst ScrollToBottomArrows = ({isScrolling, atBottom, onClick}: Props) => {\r\n    // only show on mobile\r\n    if (window.innerWidth > 768) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <div\r\n            className={classNames('post-list__arrows', {\r\n                scrolling: isScrolling && atBottom === false,\r\n            })}\r\n            onClick={onClick}\r\n        >\r\n            <ScrollToBottomIcon/>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ScrollToBottomArrows;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\n\r\nimport CloseIcon from 'components/widgets/icons/close_icon';\r\n\r\nimport './hint_toast.scss';\r\n\r\nexport const HINT_TOAST_TESTID = 'hint-toast';\r\n\r\ntype Props = {\r\n    children: React.ReactNode;\r\n    onDismiss: () => void;\r\n}\r\n\r\nexport const HintToast: React.FC<Props> = ({children, onDismiss}: Props) => {\r\n    const handleDismiss = () => {\r\n        if (typeof onDismiss === 'function') {\r\n            onDismiss();\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div\r\n            data-testid={HINT_TOAST_TESTID}\r\n            className='hint-toast'\r\n        >\r\n            <div\r\n                className='hint-toast__message'\r\n            >\r\n                {children}\r\n            </div>\r\n            <div\r\n                className='hint-toast__dismiss'\r\n                onClick={handleDismiss}\r\n                data-testid='dismissHintToast'\r\n            >\r\n                <CloseIcon\r\n                    className='close-btn'\r\n                    id='dismissHintToast'\r\n                />\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nimport CloseIcon from 'components/widgets/icons/close_icon';\r\nimport UnreadBelowIcon from 'components/widgets/icons/unread_below_icon';\r\n\r\nimport './scroll_to_bottom_toast.scss';\r\n\r\nexport const SCROLL_TO_BOTTOM_TOAST_TESTID = 'scroll-to-bottom-toast';\r\nexport const SCROLL_TO_BOTTOM_DISMISS_BUTTON_TESTID = 'scroll-to-bottom-toast--dismiss-button';\r\n\r\ntype ScrollToBottomToastProps = {\r\n    onDismiss: () => void;\r\n    onClick: () => void;\r\n}\r\n\r\nexport const ScrollToBottomToast = ({onDismiss, onClick}: ScrollToBottomToastProps) => {\r\n    const {formatMessage} = useIntl();\r\n\r\n    const jumpToRecentsMessage = formatMessage({\r\n        id: 'postlist.toast.scrollToBottom',\r\n        defaultMessage: 'Jump to recents',\r\n    });\r\n\r\n    const handleScrollToBottom: React.MouseEventHandler<HTMLDivElement> = (e) => {\r\n        e.preventDefault();\r\n        onClick();\r\n    };\r\n\r\n    const handleDismiss: React.MouseEventHandler<HTMLDivElement> = (e) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        onDismiss();\r\n    };\r\n\r\n    return (\r\n        <div\r\n            data-testid={SCROLL_TO_BOTTOM_TOAST_TESTID}\r\n            className='scroll-to-bottom-toast btn btn-primary'\r\n            onClick={handleScrollToBottom}\r\n        >\r\n            <UnreadBelowIcon/>\r\n            {jumpToRecentsMessage}\r\n            <div\r\n                className='scroll-to-bottom-toast__dismiss'\r\n                onClick={handleDismiss}\r\n                data-testid={SCROLL_TO_BOTTOM_DISMISS_BUTTON_TESTID}\r\n            >\r\n                <CloseIcon\r\n                    className='close-btn'\r\n                    id='dismissScrollToBottomToast'\r\n                />\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ScrollToBottomToast;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport ScrollToBottomToast from './scroll_to_bottom_toast';\r\n\r\nexport default ScrollToBottomToast;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage, injectIntl} from 'react-intl';\r\nimport type {IntlShape, WrappedComponentProps} from 'react-intl';\r\nimport type {RouteComponentProps} from 'react-router-dom';\r\n\r\nimport {Preferences} from 'mattermost-redux/constants';\r\nimport {getNewMessagesIndex} from 'mattermost-redux/utils/post_list';\r\n\r\nimport {HintToast} from 'components/hint-toast/hint_toast';\r\nimport ScrollToBottomToast from 'components/scroll_to_bottom_toast';\r\nimport {SearchShortcut} from 'components/search_shortcut';\r\nimport Timestamp, {RelativeRanges} from 'components/timestamp';\r\nimport Toast from 'components/toast/toast';\r\n\r\nimport {getHistory} from 'utils/browser_history';\r\nimport Constants from 'utils/constants';\r\nimport {isToday} from 'utils/datetime';\r\nimport {isKeyPressed} from 'utils/keyboard';\r\nimport {isIdNotPost} from 'utils/post_utils';\r\n\r\nimport './toast__wrapper.scss';\r\n\r\nconst TOAST_TEXT_COLLAPSE_WIDTH = 500;\r\n\r\nconst TOAST_REL_RANGES = [\r\n    RelativeRanges.TODAY_YESTERDAY,\r\n];\r\n\r\nexport type Props = WrappedComponentProps & RouteComponentProps<{team: string}> & {\r\n    channelMarkedAsUnread?: boolean;\r\n    postListIds: string[];\r\n    latestPostTimeStamp?: number;\r\n    atBottom: boolean | null;\r\n    lastViewedBottom: number;\r\n    width: number;\r\n    focusedPostId?: string;\r\n    initScrollOffsetFromBottom: number;\r\n    updateNewMessagesAtInChannel: (lastViewedAt?: number) => void;\r\n    scrollToNewMessage: () => void;\r\n    scrollToLatestMessages: () => void;\r\n    scrollToUnreadMessages: () => void;\r\n    updateLastViewedBottomAt: (lastViewedBottom?: number) => void;\r\n    showSearchHintToast: boolean;\r\n    onSearchHintDismiss: () => void;\r\n    showScrollToBottomToast: boolean;\r\n    onScrollToBottomToastDismiss: () => void;\r\n    hideScrollToBottomToast: () => void;\r\n    shouldStartFromBottomWhenUnread: boolean;\r\n    isNewMessageLineReached: boolean;\r\n    rootPosts: Record<string, boolean>;\r\n    lastViewedAt: number;\r\n    newRecentMessagesCount: number;\r\n    unreadScrollPosition: string;\r\n    isCollapsedThreadsEnabled: boolean;\r\n    unreadCountInChannel: number;\r\n    atLatestPost?: boolean;\r\n    channelId: string;\r\n    intl: IntlShape;\r\n    actions: {\r\n        updateToastStatus: (status: boolean) => void;\r\n    };\r\n};\r\n\r\ntype State = {\r\n    unreadCount: number;\r\n    unreadCountInChannel: number;\r\n    channelMarkedAsUnread?: boolean;\r\n    lastViewedAt?: number;\r\n    showUnreadToast?: boolean;\r\n    showNewMessagesToast?: boolean;\r\n    showMessageHistoryToast?: boolean;\r\n    showUnreadWithBottomStartToast?: boolean;\r\n    showScrollToBottomToast?: boolean;\r\n};\r\n\r\nexport class ToastWrapperClass extends React.PureComponent<Props, State> {\r\n    mounted?: boolean;\r\n    static defaultProps = {\r\n        focusedPostId: '',\r\n    };\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n        this.state = {\r\n            unreadCountInChannel: props.unreadCountInChannel,\r\n            unreadCount: 0,\r\n        };\r\n    }\r\n\r\n    static countNewMessages = (rootPosts: Record<string, boolean>, isCollapsedThreadsEnabled: boolean, postListIds: string[] = []) => {\r\n        const mark = getNewMessagesIndex(postListIds);\r\n        if (mark <= 0) {\r\n            return 0;\r\n        }\r\n        let newMessages = postListIds.slice(0, mark).filter((id) => !isIdNotPost(id));\r\n        if (isCollapsedThreadsEnabled) { // in collapsed mode we only count root posts\r\n            newMessages = newMessages.filter((id) => rootPosts[id]);\r\n        }\r\n        return newMessages.length;\r\n    };\r\n\r\n    static getDerivedStateFromProps(props: Props, prevState: State) {\r\n        let {showUnreadToast, showNewMessagesToast, showMessageHistoryToast, showUnreadWithBottomStartToast} = prevState;\r\n        let unreadCount;\r\n\r\n        if (props.atLatestPost) {\r\n            if (props.unreadScrollPosition === Preferences.UNREAD_SCROLL_POSITION_START_FROM_NEWEST && prevState.unreadCountInChannel) {\r\n                unreadCount = prevState.unreadCountInChannel + props.newRecentMessagesCount;\r\n            } else {\r\n                unreadCount = ToastWrapperClass.countNewMessages(props.rootPosts, props.isCollapsedThreadsEnabled, props.postListIds);\r\n            }\r\n        } else if (props.channelMarkedAsUnread) {\r\n            if (props.unreadScrollPosition === Preferences.UNREAD_SCROLL_POSITION_START_FROM_NEWEST) {\r\n                unreadCount = props.unreadCountInChannel + props.newRecentMessagesCount;\r\n            } else {\r\n                unreadCount = prevState.unreadCountInChannel;\r\n            }\r\n        } else {\r\n            unreadCount = prevState.unreadCountInChannel + props.newRecentMessagesCount;\r\n        }\r\n\r\n        // show unread toast on mount when channel is not at bottom and unread count greater than 0\r\n        if (typeof showUnreadToast === 'undefined' && props.atBottom !== null) {\r\n            showUnreadToast = unreadCount > 0 && !props.atBottom;\r\n        }\r\n\r\n        if (typeof showMessageHistoryToast === 'undefined' && props.focusedPostId !== '' && props.atBottom !== null) {\r\n            showMessageHistoryToast = props.initScrollOffsetFromBottom > 1000 || !props.atLatestPost;\r\n        }\r\n\r\n        // show unread toast when a channel is marked as unread\r\n        if (props.channelMarkedAsUnread && (props.atBottom === false) && !prevState.channelMarkedAsUnread && !prevState.showUnreadToast) {\r\n            showUnreadToast = true;\r\n        }\r\n\r\n        // show unread toast when a channel is remarked as unread using the change in lastViewedAt\r\n        // lastViewedAt changes only if a channel is remarked as unread in channelMarkedAsUnread state\r\n        if (props.channelMarkedAsUnread && props.lastViewedAt !== prevState.lastViewedAt && (props.atBottom === false)) {\r\n            showUnreadToast = true;\r\n        }\r\n\r\n        if (!showUnreadToast && unreadCount > 0 && (props.atBottom === false) && props.latestPostTimeStamp && (props.lastViewedBottom < props.latestPostTimeStamp)) {\r\n            showNewMessagesToast = true;\r\n        }\r\n\r\n        if (props.unreadScrollPosition === Preferences.UNREAD_SCROLL_POSITION_START_FROM_NEWEST && !props.channelMarkedAsUnread) {\r\n            showUnreadToast = false;\r\n        }\r\n\r\n        if (!unreadCount) {\r\n            showUnreadToast = false;\r\n            showNewMessagesToast = false;\r\n        }\r\n\r\n        if (props.isNewMessageLineReached) {\r\n            showUnreadWithBottomStartToast = false;\r\n        }\r\n\r\n        if (\r\n            typeof showUnreadWithBottomStartToast === 'undefined' &&\r\n            props.lastViewedAt &&\r\n            props.lastViewedAt !== prevState.lastViewedAt &&\r\n            props.shouldStartFromBottomWhenUnread &&\r\n            unreadCount > 0 &&\r\n            !props.isNewMessageLineReached\r\n        ) {\r\n            showUnreadWithBottomStartToast = true;\r\n        }\r\n\r\n        return {\r\n            unreadCount,\r\n            showUnreadToast,\r\n            showNewMessagesToast,\r\n            showUnreadWithBottomStartToast,\r\n            lastViewedAt: props.lastViewedAt,\r\n            atBottom: props.atBottom,\r\n            channelMarkedAsUnread: props.channelMarkedAsUnread,\r\n            showMessageHistoryToast,\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.mounted = true;\r\n        const {showUnreadToast, showNewMessagesToast, showMessageHistoryToast, showUnreadWithBottomStartToast} = this.state;\r\n        const toastPresent = Boolean(showUnreadToast || showNewMessagesToast || showMessageHistoryToast || showUnreadWithBottomStartToast);\r\n        document.addEventListener('keydown', this.handleShortcut);\r\n        this.props.actions.updateToastStatus(toastPresent);\r\n    }\r\n\r\n    componentDidUpdate(prevProps: Props, prevState: State) {\r\n        const {showUnreadToast, showNewMessagesToast, showMessageHistoryToast, showUnreadWithBottomStartToast} = this.state;\r\n        const {\r\n            atBottom,\r\n            atLatestPost,\r\n            postListIds,\r\n            lastViewedBottom,\r\n            updateNewMessagesAtInChannel,\r\n            actions,\r\n        } = this.props;\r\n\r\n        if (!prevProps.atBottom && atBottom && atLatestPost) {\r\n            this.hideNewMessagesToast(false);\r\n            this.hideUnreadToast();\r\n            this.hideArchiveToast();\r\n        }\r\n\r\n        const prevPostsCount = prevProps.postListIds.length;\r\n        const presentPostsCount = postListIds.length;\r\n        const postsAddedAtBottom = presentPostsCount !== prevPostsCount && postListIds[0] !== prevProps.postListIds[0];\r\n        const notBottomWithLatestPosts = atBottom === false && atLatestPost && presentPostsCount > 0;\r\n\r\n        //Marking existing messages as read based on last time user reached to the bottom\r\n        //This moves the new message indicator to the latest posts and keeping in sync with the toast count\r\n        if (postsAddedAtBottom && notBottomWithLatestPosts && !showUnreadToast) {\r\n            updateNewMessagesAtInChannel(lastViewedBottom);\r\n        }\r\n\r\n        const toastStateChanged = prevState.showUnreadToast !== showUnreadToast ||\r\n                                  prevState.showNewMessagesToast !== showNewMessagesToast ||\r\n                                  prevState.showMessageHistoryToast !== showMessageHistoryToast ||\r\n                                  prevState.showUnreadWithBottomStartToast !== showUnreadWithBottomStartToast;\r\n\r\n        if (toastStateChanged) {\r\n            const toastPresent = Boolean(showUnreadToast || showNewMessagesToast || showMessageHistoryToast || showUnreadWithBottomStartToast);\r\n            actions.updateToastStatus(toastPresent);\r\n        }\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        document.removeEventListener('keydown', this.handleShortcut);\r\n    }\r\n\r\n    handleShortcut = (e: KeyboardEvent) => {\r\n        if (isKeyPressed(e, Constants.KeyCodes.ESCAPE)) {\r\n            if (this.state.showUnreadToast) {\r\n                this.hideUnreadToast();\r\n            } else if (this.state.showNewMessagesToast) {\r\n                this.hideNewMessagesToast();\r\n            } else if (this.state.showUnreadWithBottomStartToast) {\r\n                this.hideUnreadWithBottomStartToast();\r\n            } else {\r\n                this.hideArchiveToast();\r\n            }\r\n        }\r\n    };\r\n\r\n    hideUnreadToast = () => {\r\n        if (this.state.showUnreadToast) {\r\n            this.setState({\r\n                showUnreadToast: false,\r\n            });\r\n        }\r\n    };\r\n\r\n    hideArchiveToast = () => {\r\n        if (this.state.showMessageHistoryToast) {\r\n            this.setState({\r\n                showMessageHistoryToast: false,\r\n            });\r\n        }\r\n    };\r\n\r\n    hideNewMessagesToast = (updateLastViewedBottomAt = true) => {\r\n        if (this.state.showNewMessagesToast) {\r\n            this.setState({\r\n                showNewMessagesToast: false,\r\n            });\r\n            if (updateLastViewedBottomAt) {\r\n                this.props.updateLastViewedBottomAt();\r\n            }\r\n        }\r\n    };\r\n\r\n    hideSearchHintToast = () => {\r\n        if (this.props.onSearchHintDismiss) {\r\n            this.props.onSearchHintDismiss();\r\n        }\r\n    };\r\n\r\n    hideUnreadWithBottomStartToast = () => {\r\n        if (this.state.showUnreadWithBottomStartToast) {\r\n            this.setState({\r\n                showUnreadWithBottomStartToast: false,\r\n            });\r\n        }\r\n    };\r\n\r\n    newMessagesToastText = (count: number | undefined, since: number) => {\r\n        if (this.props.width > TOAST_TEXT_COLLAPSE_WIDTH && typeof since !== 'undefined') {\r\n            return (\r\n                <FormattedMessage\r\n                    id='postlist.toast.newMessagesSince'\r\n                    defaultMessage='{count, number} new {count, plural, one {message} other {messages}} {isToday, select, true {} other {since}} {date}'\r\n                    values={{\r\n                        count,\r\n                        isToday: isToday(new Date(since)).toString(),\r\n                        date: (\r\n                            <Timestamp\r\n                                value={since}\r\n                                useTime={false}\r\n                                ranges={TOAST_REL_RANGES}\r\n                            />\r\n                        ),\r\n                    }}\r\n                />\r\n            );\r\n        }\r\n        return (\r\n            <FormattedMessage\r\n                id='postlist.toast.newMessages'\r\n                defaultMessage={'{count, number} new {count, plural, one {message} other {messages}}'}\r\n                values={{count}}\r\n            />\r\n        );\r\n    };\r\n\r\n    archiveToastText = () => {\r\n        return (\r\n            <FormattedMessage\r\n                id='postlist.toast.history'\r\n                defaultMessage='Viewing message history'\r\n            />\r\n        );\r\n    };\r\n\r\n    getSearchHintToastText = () => {\r\n        return (\r\n            <FormattedMessage\r\n                id='postlist.toast.searchHint'\r\n                defaultMessage='Tip: Try {searchShortcut} to search this channel'\r\n                values={{\r\n                    searchShortcut: <SearchShortcut/>,\r\n                }}\r\n            />\r\n        );\r\n    };\r\n\r\n    changeUrlToRemountChannelView = () => {\r\n        const {match} = this.props;\r\n\r\n        // Inorder of mount the channel view we are redirecting to /team url to load the channel again\r\n        // Todo: Can be changed to dispatch if we put focussedPostId in redux state.\r\n        getHistory().replace(`/${match.params.team}`);\r\n    };\r\n\r\n    scrollToNewMessage = () => {\r\n        const {focusedPostId, atLatestPost, scrollToNewMessage, updateLastViewedBottomAt} = this.props;\r\n\r\n        // if latest set of posts are not loaded in the view then we cannot scroll to the message\r\n        // We will be chaging the url to remount the channel view so we can remove the focussedPostId react state\r\n        // if we don't remove the focussedPostId state then scroll tries to correct to that instead of new message line\r\n        if (focusedPostId && !atLatestPost) {\r\n            this.changeUrlToRemountChannelView();\r\n            return;\r\n        }\r\n\r\n        scrollToNewMessage();\r\n        updateLastViewedBottomAt();\r\n        this.hideNewMessagesToast();\r\n    };\r\n\r\n    scrollToLatestMessages = () => {\r\n        const {focusedPostId, atLatestPost, scrollToLatestMessages} = this.props;\r\n\r\n        if (focusedPostId) {\r\n            if (!atLatestPost) {\r\n                this.changeUrlToRemountChannelView();\r\n                return;\r\n            }\r\n            this.hideArchiveToast();\r\n        }\r\n\r\n        scrollToLatestMessages();\r\n        this.hideUnreadToast();\r\n        this.props.hideScrollToBottomToast?.();\r\n    };\r\n\r\n    scrollToUnreadMessages = () => {\r\n        this.props.scrollToUnreadMessages();\r\n        this.hideUnreadWithBottomStartToast();\r\n    };\r\n\r\n    getToastToRender() {\r\n        const {atLatestPost, atBottom, width, lastViewedAt, showSearchHintToast, showScrollToBottomToast} = this.props;\r\n        const {showUnreadToast, showNewMessagesToast, showMessageHistoryToast, showUnreadWithBottomStartToast, unreadCount} = this.state;\r\n\r\n        const unreadToastProps = {\r\n            show: true,\r\n            width,\r\n            onDismiss: this.hideUnreadToast,\r\n            onClick: this.scrollToLatestMessages,\r\n            onClickMessage: (\r\n                <FormattedMessage\r\n                    id='postlist.toast.scrollToBottom'\r\n                    defaultMessage='Jump to recents'\r\n                />\r\n            ),\r\n            showActions: !atLatestPost || (atLatestPost && (atBottom === false)),\r\n        };\r\n\r\n        if (showUnreadToast && unreadCount > 0) {\r\n            return (\r\n                <Toast {...unreadToastProps}>\r\n                    {this.newMessagesToastText(unreadCount, lastViewedAt)}\r\n                </Toast>\r\n            );\r\n        }\r\n\r\n        const unreadWithBottomStartToastProps = {\r\n            show: true,\r\n            width,\r\n            onDismiss: this.hideUnreadWithBottomStartToast,\r\n            onClick: this.scrollToUnreadMessages,\r\n            onClickMessage: (\r\n                <FormattedMessage\r\n                    id='postlist.toast.scrollToUnread'\r\n                    defaultMessage='Jump to unreads'\r\n                />\r\n            ),\r\n            showActions: true,\r\n            jumpDirection: 'up' as const,\r\n        };\r\n\r\n        if (showUnreadWithBottomStartToast && unreadCount > 0) {\r\n            return (\r\n                <Toast {...unreadWithBottomStartToastProps}>\r\n                    {this.newMessagesToastText(unreadCount, lastViewedAt)}\r\n                </Toast>\r\n            );\r\n        }\r\n\r\n        if (showNewMessagesToast) {\r\n            const showNewMessagesToastOverrides = {\r\n                onDismiss: this.hideNewMessagesToast,\r\n                onClick: this.scrollToNewMessage,\r\n                onClickMessage: (\r\n                    <FormattedMessage\r\n                        id='postlist.toast.scrollToLatest'\r\n                        defaultMessage='Jump to new messages'\r\n                    />\r\n                ),\r\n            };\r\n\r\n            return (\r\n                <Toast\r\n                    {...unreadToastProps}\r\n                    {...showNewMessagesToastOverrides}\r\n                >\r\n                    {this.newMessagesToastText(unreadCount, lastViewedAt)}\r\n                </Toast>\r\n            );\r\n        }\r\n\r\n        if (showMessageHistoryToast) {\r\n            const archiveToastProps = {\r\n                show: true,\r\n                width,\r\n                onDismiss: this.hideArchiveToast,\r\n                onClick: this.scrollToLatestMessages,\r\n                onClickMessage: (\r\n                    <FormattedMessage\r\n                        id='postlist.toast.scrollToBottom'\r\n                        defaultMessage='Jump to recents'\r\n                    />\r\n                ),\r\n                showActions: true,\r\n                extraClasses: 'toast__history',\r\n            };\r\n\r\n            return (\r\n                <Toast {...archiveToastProps}>\r\n                    {this.archiveToastText()}\r\n                </Toast>\r\n            );\r\n        }\r\n\r\n        const toasts = [];\r\n        if (showScrollToBottomToast) {\r\n            toasts.push(\r\n                <ScrollToBottomToast\r\n                    key='scroll-to-bottom-toast'\r\n                    onClick={this.scrollToLatestMessages}\r\n                    onDismiss={this.props.onScrollToBottomToastDismiss}\r\n                />,\r\n            );\r\n        }\r\n\r\n        if (showSearchHintToast) {\r\n            toasts.push(\r\n                <HintToast\r\n                    key='search-hint-toast'\r\n                    onDismiss={this.hideSearchHintToast}\r\n                >\r\n                    {this.getSearchHintToastText()}\r\n                </HintToast>,\r\n            );\r\n        }\r\n\r\n        if (toasts.length > 0) {\r\n            return (\r\n                <div className='toasts-wrapper'>\r\n                    {toasts}\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    render() {\r\n        const toastToRender = this.getToastToRender();\r\n\r\n        return (\r\n            <>\r\n                {toastToRender}\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nexport default injectIntl(ToastWrapperClass);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {withRouter} from 'react-router-dom';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {Posts} from 'mattermost-redux/constants';\r\nimport {createSelector} from 'mattermost-redux/selectors/create_selector';\r\nimport {getCurrentChannel, countCurrentChannelUnreadMessages, isManuallyUnread} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getAllPosts, getPostIdsInChannel} from 'mattermost-redux/selectors/entities/posts';\r\nimport {getUnreadScrollPositionPreference, isCollapsedThreadsEnabled} from 'mattermost-redux/selectors/entities/preferences';\r\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\r\nimport {makePreparePostIdsForPostList} from 'mattermost-redux/utils/post_list';\r\n\r\nimport {updateToastStatus} from 'actions/views/channel';\r\n\r\nimport type {GlobalState} from 'types/store/index';\r\n\r\nimport ToastWrapper from './toast_wrapper';\r\n\r\ninterface OwnProps {\r\n    atLatestPost?: boolean;\r\n    channelId: string;\r\n}\r\n\r\nexport function makeGetRootPosts() {\r\n    return createSelector(\r\n        'makeGetRootPosts',\r\n        getAllPosts,\r\n        getCurrentUserId,\r\n        getCurrentChannel,\r\n        (allPosts, currentUserId, channel) => {\r\n            // Count the number of new posts that haven't been deleted and are root posts\r\n            return Object.values(allPosts).filter((post) => {\r\n                return (\r\n                    post.root_id === '' &&\r\n                    post.channel_id === channel?.id &&\r\n                    post.state !== Posts.POST_DELETED\r\n                );\r\n            }).reduce((map: Record<string, boolean>, obj) => {\r\n                map[obj.id] = true;\r\n                return map;\r\n            }, {});\r\n        },\r\n    );\r\n}\r\n\r\nexport function makeCountUnreadsBelow() {\r\n    return createSelector(\r\n        'makeCountUnreadsBelow',\r\n        getAllPosts,\r\n        getCurrentUserId,\r\n        (state: GlobalState, postIds: string[]) => postIds,\r\n        (state: GlobalState, postIds, lastViewedBottom: number) => lastViewedBottom,\r\n        isCollapsedThreadsEnabled,\r\n        (allPosts, currentUserId, postIds, lastViewedBottom, isCollapsed) => {\r\n            if (!postIds) {\r\n                return 0;\r\n            }\r\n\r\n            // Count the number of new posts made by other users that haven't been deleted\r\n            return postIds.map((id) => allPosts[id]).filter((post) => {\r\n                return post &&\r\n                    post.user_id !== currentUserId &&\r\n                    post.state !== Posts.POST_DELETED &&\r\n                    post.create_at > lastViewedBottom &&\r\n                    (isCollapsed ? post.root_id === '' : true); // in collapsed threads mode, only count root posts\r\n            }).length;\r\n        },\r\n    );\r\n}\r\n\r\n/* This connected component is written mainly for maintaining the unread count to be passed to the toast\r\n   Unread count logic:\r\n   * If channel is at the latest set of posts:\r\n      Unread count is the Number of posts below new message line\r\n   * if channel is not at the latest set of posts:\r\n      1. UnreadCount + any recent messages in the latest chunk.\r\n      2. If channel was marked as unread.\r\n        * Unread count of channel alone.\r\n*/\r\n\r\nfunction makeMapStateToProps() {\r\n    const countUnreadsBelow = makeCountUnreadsBelow();\r\n    const getRootPosts = makeGetRootPosts();\r\n    const preparePostIdsForPostList = makePreparePostIdsForPostList();\r\n    return function mapStateToProps(state: GlobalState, ownProps: OwnProps) {\r\n        let newRecentMessagesCount = 0;\r\n        const channelMarkedAsUnread = isManuallyUnread(state, ownProps.channelId);\r\n        const lastViewedAt = state.views.channel.lastChannelViewTime[ownProps.channelId];\r\n        const unreadScrollPosition = getUnreadScrollPositionPreference(state);\r\n        if (!ownProps.atLatestPost) {\r\n            let postIds = getPostIdsInChannel(state, ownProps.channelId) || [];\r\n            if (postIds) {\r\n                postIds = preparePostIdsForPostList(state, {postIds, lastViewedAt});\r\n            }\r\n            newRecentMessagesCount = countUnreadsBelow(state, postIds, lastViewedAt);\r\n        }\r\n        return {\r\n            rootPosts: getRootPosts(state),\r\n            lastViewedAt,\r\n            newRecentMessagesCount,\r\n            unreadScrollPosition,\r\n            isCollapsedThreadsEnabled: isCollapsedThreadsEnabled(state),\r\n            unreadCountInChannel: countCurrentChannelUnreadMessages(state),\r\n            channelMarkedAsUnread,\r\n        };\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            updateToastStatus,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default withRouter(connect(makeMapStateToProps, mapDispatchToProps)(ToastWrapper));\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useMemo} from 'react';\r\nimport {useSelector} from 'react-redux';\r\n\r\nimport type {Post} from '@mattermost/types/posts';\r\n\r\nimport {getPost} from 'mattermost-redux/selectors/entities/posts';\r\n\r\nimport {getLatestPostId, usePostAriaLabel} from 'utils/post_utils';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\ninterface Props {\r\n    postIds?: string[];\r\n}\r\n\r\nconst LatestPostReader = (props: Props): JSX.Element => {\r\n    const {postIds} = props;\r\n    const latestPostId = useMemo(() => getLatestPostId(postIds || []), [postIds]);\r\n    const latestPost = useSelector<GlobalState, Post>((state) => getPost(state, latestPostId));\r\n\r\n    const ariaLabel = usePostAriaLabel(latestPost);\r\n\r\n    return (\r\n        <span\r\n            className='sr-only'\r\n            aria-live='polite'\r\n        >\r\n            {ariaLabel}\r\n        </span>\r\n    );\r\n};\r\n\r\nexport default LatestPostReader;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport AutoSizer from 'react-virtualized-auto-sizer';\r\n\r\nimport EventEmitter from 'mattermost-redux/utils/event_emitter';\r\nimport {getNewMessagesIndex, isDateLine, isStartOfNewMessages} from 'mattermost-redux/utils/post_list';\r\n\r\nimport type {updateNewMessagesAtInChannel} from 'actions/global_actions';\r\nimport type {CanLoadMorePosts} from 'actions/views/channel';\r\n\r\nimport {DynamicVirtualizedList} from 'components/dynamic_virtualized_list';\r\nimport type {OnItemsRenderedArgs} from 'components/dynamic_virtualized_list';\r\nimport FloatingTimestamp from 'components/post_view/floating_timestamp';\r\nimport PostListRow from 'components/post_view/post_list_row';\r\nimport ScrollToBottomArrows from 'components/post_view/scroll_to_bottom_arrows';\r\nimport ToastWrapper from 'components/toast_wrapper';\r\n\r\nimport Pluggable from 'plugins/pluggable';\r\nimport Constants, {PostListRowListIds, EventTypes, PostRequestTypes} from 'utils/constants';\r\nimport DelayedAction from 'utils/delayed_action';\r\nimport {getPreviousPostId, getLatestPostId} from 'utils/post_utils';\r\nimport * as Utils from 'utils/utils';\r\n\r\nimport LatestPostReader from './latest_post_reader';\r\n\r\nconst OVERSCAN_COUNT_BACKWARD = 80;\r\nconst OVERSCAN_COUNT_FORWARD = 80;\r\nconst HEIGHT_TRIGGER_FOR_MORE_POSTS = 1000;\r\nconst BUFFER_TO_BE_CONSIDERED_BOTTOM = 10;\r\n\r\nconst MAXIMUM_POSTS_FOR_SLICING = {\r\n    channel: 50,\r\n    permalink: 100,\r\n};\r\n\r\nconst postListStyle = {\r\n    padding: '14px 0px 7px',\r\n};\r\n\r\nconst virtListStyles = {\r\n    position: 'absolute',\r\n    bottom: '0',\r\n    maxHeight: '100%',\r\n};\r\n\r\nconst OFFSET_TO_SHOW_TOAST = -50;\r\n\r\ntype Props = {\r\n\r\n    /*\r\n     * Array of Ids in the channel including date separators, new message indicator, more messages loader,\r\n     * manual load messages trigger and postId in the order of newest to oldest for populating virtual list rows\r\n     */\r\n    postListIds?: string[];\r\n\r\n    /*\r\n     * The current channel id\r\n     */\r\n    channelId: string;\r\n\r\n    /*\r\n     * Used for disabling auto retry of posts and enabling manual link for loading posts\r\n     */\r\n    autoRetryEnable: boolean;\r\n\r\n    /*\r\n     * Used in passing to post row for enabling animation when loading posts\r\n     */\r\n    loadingNewerPosts: boolean;\r\n    loadingOlderPosts: boolean;\r\n\r\n    isMobileView: boolean;\r\n\r\n    /*\r\n     * Used for populating header, scroll correction and disabling triggering loadOlderPosts\r\n     */\r\n    atOldestPost?: boolean;\r\n\r\n    /*\r\n     * Used for disabling triggering loadNewerPosts\r\n     */\r\n    atLatestPost?: boolean;\r\n\r\n    latestPostTimeStamp?: number;\r\n    lastViewedAt: number;\r\n\r\n    /*\r\n     * Set to focus this post\r\n     */\r\n    focusedPostId?: string;\r\n\r\n    shouldStartFromBottomWhenUnread: boolean;\r\n\r\n    actions: {\r\n\r\n        /*\r\n         * Function to get older posts in the channel\r\n         */\r\n        loadOlderPosts: () => Promise<void>;\r\n\r\n        /*\r\n         * Function to get newer posts in the channel\r\n         */\r\n        loadNewerPosts: () => Promise<void>;\r\n\r\n        /*\r\n         * Function used for autoLoad of posts incase screen is not filled with posts\r\n         */\r\n        canLoadMorePosts: (type: CanLoadMorePosts) => Promise<void>;\r\n\r\n        /*\r\n         * Function to change the post selected for postList\r\n         */\r\n        changeUnreadChunkTimeStamp: (lastViewedAt: number) => void;\r\n\r\n        updateNewMessagesAtInChannel: typeof updateNewMessagesAtInChannel;\r\n\r\n        toggleShouldStartFromBottomWhenUnread: () => void;\r\n    };\r\n}\r\n\r\ntype State = {\r\n    isScrolling: boolean;\r\n\r\n    // Intentionally setting null so that toast can determine when the first time this state is defined\r\n    atBottom: boolean | null;\r\n    lastViewedBottom: number;\r\n    postListIds: string[];\r\n    topPostId: string;\r\n    postMenuOpened: boolean;\r\n    dynamicListStyle: {\r\n        willChange: string;\r\n    };\r\n    initScrollCompleted: boolean;\r\n    initScrollOffsetFromBottom: number;\r\n    showSearchHint: boolean;\r\n    isSearchHintDismissed: boolean;\r\n    isMobileView?: boolean;\r\n    isNewMessageLineReached: boolean;\r\n    showScrollToBottomToast: boolean;\r\n    isScrollToBottomDismissed: boolean;\r\n}\r\n\r\nexport default class PostList extends React.PureComponent<Props, State> {\r\n    listRef: React.RefObject<DynamicVirtualizedList>;\r\n    postListRef: React.RefObject<HTMLDivElement>;\r\n    scrollStopAction: DelayedAction | null = null;\r\n    initRangeToRender: number[];\r\n    showSearchHintThreshold: number;\r\n    mounted: boolean;\r\n    newMessageLineIndex: number;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        const channelIntroMessage = PostListRowListIds.CHANNEL_INTRO_MESSAGE;\r\n        this.mounted = true;\r\n\r\n        this.state = {\r\n            isScrolling: false,\r\n\r\n            // Intentionally setting null so that toast can determine when the first time this state is defined\r\n            atBottom: null,\r\n            lastViewedBottom: Date.now(),\r\n            postListIds: [channelIntroMessage],\r\n            topPostId: '',\r\n            postMenuOpened: false,\r\n            dynamicListStyle: {\r\n                willChange: 'transform',\r\n            },\r\n            initScrollCompleted: false,\r\n            initScrollOffsetFromBottom: 0,\r\n            showSearchHint: false,\r\n            isSearchHintDismissed: false,\r\n            isNewMessageLineReached: false,\r\n            showScrollToBottomToast: false,\r\n            isScrollToBottomDismissed: false,\r\n        };\r\n\r\n        this.listRef = React.createRef();\r\n        this.postListRef = React.createRef();\r\n        if (this.props.isMobileView) {\r\n            this.scrollStopAction = new DelayedAction(this.handleScrollStop);\r\n        }\r\n\r\n        this.initRangeToRender = this.props.focusedPostId ? [0, MAXIMUM_POSTS_FOR_SLICING.permalink] : [0, MAXIMUM_POSTS_FOR_SLICING.channel];\r\n\r\n        let postIndex = 0;\r\n        if (props.focusedPostId) {\r\n            postIndex = (this.props.postListIds || []).findIndex((postId) => postId === this.props.focusedPostId);\r\n        } else {\r\n            postIndex = getNewMessagesIndex(props.postListIds || []);\r\n        }\r\n        this.newMessageLineIndex = getNewMessagesIndex(props.postListIds || []);\r\n\r\n        const maxPostsForSlicing = props.focusedPostId ? MAXIMUM_POSTS_FOR_SLICING.permalink : MAXIMUM_POSTS_FOR_SLICING.channel;\r\n        this.initRangeToRender = [\r\n            Math.max(postIndex - 30, 0),\r\n            Math.max(postIndex + 30, Math.min((props.postListIds || []).length - 1, maxPostsForSlicing)),\r\n        ];\r\n        this.showSearchHintThreshold = this.getShowSearchHintThreshold();\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.mounted = true;\r\n\r\n        window.addEventListener('resize', this.handleWindowResize);\r\n        EventEmitter.addListener(EventTypes.POST_LIST_SCROLL_TO_BOTTOM, this.scrollToLatestMessages);\r\n    }\r\n\r\n    getSnapshotBeforeUpdate(prevProps: Props) {\r\n        if (this.postListRef && this.postListRef.current) {\r\n            const postsAddedAtTop = this.props.postListIds && this.props.postListIds.length !== (prevProps.postListIds || []).length && this.props.postListIds[0] === (prevProps.postListIds || [])[0];\r\n            const channelHeaderAdded = this.props.atOldestPost !== prevProps.atOldestPost;\r\n            if ((postsAddedAtTop || channelHeaderAdded) && this.state.atBottom === false) {\r\n                const postListNode = this.postListRef.current;\r\n                const previousScrollTop = postListNode.parentElement?.scrollTop;\r\n                const previousScrollHeight = postListNode.scrollHeight;\r\n\r\n                return {\r\n                    previousScrollTop,\r\n                    previousScrollHeight,\r\n                };\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    componentDidUpdate(prevProps: Props, _prevState: State, snapshot: {previousScrollTop: number; previousScrollHeight: number}) {\r\n        if (this.props.isMobileView && !prevProps.isMobileView) {\r\n            this.scrollStopAction = new DelayedAction(this.handleScrollStop);\r\n        }\r\n\r\n        if (!this.postListRef.current) {\r\n            return;\r\n        }\r\n        const prevPostsCount = (prevProps.postListIds || []).length;\r\n        const presentPostsCount = (this.props.postListIds || []).length;\r\n\r\n        this.newMessageLineIndex = getNewMessagesIndex(this.props.postListIds || []);\r\n\r\n        if (snapshot) {\r\n            const postlistScrollHeight = this.postListRef.current.scrollHeight;\r\n            const postsAddedAtTop = presentPostsCount !== prevPostsCount && (this.props.postListIds || [])[0] === (prevProps.postListIds || [])[0];\r\n            const channelHeaderAdded = this.props.atOldestPost !== prevProps.atOldestPost;\r\n            if ((postsAddedAtTop || channelHeaderAdded) && !this.state.atBottom && snapshot) {\r\n                const scrollValue = snapshot.previousScrollTop + (postlistScrollHeight - snapshot.previousScrollHeight);\r\n                if (scrollValue !== 0 && (scrollValue - snapshot.previousScrollTop) !== 0) {\r\n                    //true as third param so chrome can use animationFrame when correcting scroll\r\n                    this.listRef.current?.scrollTo(scrollValue, scrollValue - snapshot.previousScrollTop, true);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.mounted = false;\r\n        window.removeEventListener('resize', this.handleWindowResize);\r\n        EventEmitter.removeListener(EventTypes.POST_LIST_SCROLL_TO_BOTTOM, this.scrollToLatestMessages);\r\n    }\r\n\r\n    static getDerivedStateFromProps(props: Props, state: State) {\r\n        const postListIds = props.postListIds || [];\r\n        let newPostListIds;\r\n\r\n        if (props.atOldestPost) {\r\n            newPostListIds = [...postListIds, PostListRowListIds.CHANNEL_INTRO_MESSAGE];\r\n        } else if (props.autoRetryEnable) {\r\n            newPostListIds = [...postListIds, PostListRowListIds.OLDER_MESSAGES_LOADER];\r\n        } else {\r\n            newPostListIds = [...postListIds, PostListRowListIds.LOAD_OLDER_MESSAGES_TRIGGER];\r\n        }\r\n\r\n        if (!props.atLatestPost) {\r\n            if (props.autoRetryEnable) {\r\n                newPostListIds = [PostListRowListIds.NEWER_MESSAGES_LOADER, ...newPostListIds];\r\n            } else {\r\n                newPostListIds = [PostListRowListIds.LOAD_NEWER_MESSAGES_TRIGGER, ...newPostListIds];\r\n            }\r\n        }\r\n\r\n        const nextState: Partial<State> = {\r\n            postListIds: newPostListIds,\r\n        };\r\n\r\n        if (props.isMobileView !== state.isMobileView) {\r\n            nextState.isMobileView = props.isMobileView;\r\n\r\n            const dynamicListStyle = state.dynamicListStyle;\r\n            if (state.postMenuOpened) {\r\n                if (!props.isMobileView && dynamicListStyle.willChange === 'unset') {\r\n                    nextState.dynamicListStyle = {\r\n                        ...dynamicListStyle,\r\n                        willChange: 'transform',\r\n                    };\r\n                } else if (props.isMobileView && dynamicListStyle.willChange === 'transform') {\r\n                    nextState.dynamicListStyle = {\r\n                        ...dynamicListStyle,\r\n                        willChange: 'unset',\r\n                    };\r\n                }\r\n            }\r\n        }\r\n\r\n        return nextState;\r\n    }\r\n\r\n    handleWindowResize = () => {\r\n        this.showSearchHintThreshold = this.getShowSearchHintThreshold();\r\n    };\r\n\r\n    togglePostMenu = (opened: boolean) => {\r\n        let dynamicListStyle = this.state.dynamicListStyle;\r\n        if (this.props.isMobileView) {\r\n            dynamicListStyle = {\r\n                ...dynamicListStyle,\r\n                willChange: opened ? 'unset' : 'transform',\r\n            };\r\n        }\r\n\r\n        this.setState({\r\n            postMenuOpened: opened,\r\n            dynamicListStyle,\r\n        });\r\n    };\r\n\r\n    onNewMessageLineReached = () => {\r\n        this.setState({\r\n            isNewMessageLineReached: true,\r\n        });\r\n    };\r\n\r\n    renderRow = ({data, itemId, style}: {data: string[]; itemId: string; style: Record<string, string>}) => {\r\n        const index = data.indexOf(itemId);\r\n        let className = '';\r\n        const basePaddingClass = 'post-row__padding';\r\n        const previousItemId = (index !== -1 && index < data.length - 1) ? data[index + 1] : '';\r\n        const nextItemId = (index > 0 && index < data.length) ? data[index - 1] : '';\r\n\r\n        if (isDateLine(nextItemId) || isStartOfNewMessages(nextItemId)) {\r\n            className += basePaddingClass + ' bottom';\r\n        }\r\n\r\n        if (isDateLine(previousItemId) || isStartOfNewMessages(previousItemId)) {\r\n            if (className.includes(basePaddingClass)) {\r\n                className += ' top';\r\n            } else {\r\n                className += basePaddingClass + ' top';\r\n            }\r\n        }\r\n\r\n        // Since the first in the list is the latest message\r\n        const isLastPost = itemId === this.state.postListIds[0];\r\n\r\n        const isLoader = itemId === PostListRowListIds.OLDER_MESSAGES_LOADER || itemId === PostListRowListIds.NEWER_MESSAGES_LOADER;\r\n        const shouldHideLoader = isLoader && !this.props.loadingOlderPosts && !this.props.loadingNewerPosts;\r\n        const rowStyle = shouldHideLoader ? {...style, display: 'none'} : style;\r\n\r\n        return (\r\n            <div\r\n                style={rowStyle}\r\n                className={className}\r\n            >\r\n                <PostListRow\r\n                    listId={itemId}\r\n                    previousListId={getPreviousPostId(data, index)}\r\n                    shouldHighlight={itemId === this.props.focusedPostId}\r\n                    loadOlderPosts={this.props.actions.loadOlderPosts}\r\n                    loadNewerPosts={this.props.actions.loadNewerPosts}\r\n                    togglePostMenu={this.togglePostMenu}\r\n                    isLastPost={isLastPost}\r\n                    loadingNewerPosts={this.props.loadingNewerPosts}\r\n                    loadingOlderPosts={this.props.loadingOlderPosts}\r\n                    channelId={this.props.channelId}\r\n                />\r\n            </div>\r\n        );\r\n    };\r\n\r\n    scrollToFailed = (index: number) => {\r\n        if (index === 0) {\r\n            this.props.actions.changeUnreadChunkTimeStamp(0);\r\n        } else {\r\n            this.props.actions.changeUnreadChunkTimeStamp(this.props.lastViewedAt);\r\n        }\r\n    };\r\n\r\n    onScroll = ({\r\n        scrollDirection,\r\n        scrollOffset,\r\n        scrollUpdateWasRequested,\r\n        clientHeight,\r\n        scrollHeight}:\r\n    {\r\n        scrollDirection: string;\r\n        scrollOffset: number;\r\n        scrollUpdateWasRequested: boolean;\r\n        clientHeight: number;\r\n        scrollHeight: number;\r\n    }) => {\r\n        if (scrollHeight <= 0) {\r\n            return;\r\n        }\r\n\r\n        const didUserScrollBackwards = scrollDirection === 'backward' && !scrollUpdateWasRequested;\r\n        const didUserScrollForwards = scrollDirection === 'forward' && !scrollUpdateWasRequested;\r\n        const isOffsetWithInRange = scrollOffset < HEIGHT_TRIGGER_FOR_MORE_POSTS;\r\n        const offsetFromBottom = this.getOffsetFromBottom(scrollOffset, scrollHeight, clientHeight);\r\n        const shouldLoadNewPosts = offsetFromBottom < HEIGHT_TRIGGER_FOR_MORE_POSTS;\r\n\r\n        if (didUserScrollBackwards && isOffsetWithInRange && !this.props.atOldestPost) {\r\n            this.props.actions.loadOlderPosts();\r\n        } else if (didUserScrollForwards && shouldLoadNewPosts && !this.props.atLatestPost) {\r\n            this.props.actions.loadNewerPosts();\r\n        }\r\n\r\n        if (this.props.isMobileView) {\r\n            if (!this.state.isScrolling) {\r\n                this.setState({\r\n                    isScrolling: true,\r\n                });\r\n            }\r\n\r\n            if (this.scrollStopAction) {\r\n                this.scrollStopAction.fireAfter(Constants.SCROLL_DELAY);\r\n            }\r\n        }\r\n\r\n        this.checkBottom(scrollOffset, scrollHeight, clientHeight);\r\n\r\n        if (scrollUpdateWasRequested) { //if scroll change is programatically requested i.e by calling scrollTo\r\n            //This is a private method on virtlist\r\n            const postsRenderedRange = this.listRef.current?._getRangeToRender(); //eslint-disable-line no-underscore-dangle\r\n\r\n            // postsRenderedRange[3] is the visibleStopIndex which is post at the bottom of the screen\r\n            if (postsRenderedRange && postsRenderedRange[3] <= 1 && !this.props.atLatestPost) {\r\n                this.props.actions.canLoadMorePosts(PostRequestTypes.AFTER_ID);\r\n            }\r\n\r\n            if (!this.state.atBottom && scrollHeight) {\r\n                this.setState({\r\n                    initScrollOffsetFromBottom: offsetFromBottom,\r\n                });\r\n            }\r\n        }\r\n\r\n        if (this.props.isMobileView && this.state.showSearchHint) {\r\n            this.setState({\r\n                showSearchHint: false,\r\n            });\r\n        }\r\n\r\n        if (!this.props.isMobileView && !this.state.isSearchHintDismissed) {\r\n            this.setState({\r\n                showSearchHint: offsetFromBottom > this.showSearchHintThreshold,\r\n            });\r\n        }\r\n\r\n        this.updateScrollToBottomToastVisibility(scrollOffset, scrollHeight, clientHeight);\r\n    };\r\n\r\n    getShowSearchHintThreshold = () => {\r\n        return window.screen.height * 3;\r\n    };\r\n\r\n    checkBottom = (scrollOffset: number, scrollHeight: number, clientHeight: number) => {\r\n        this.updateAtBottom(this.isAtBottom(scrollOffset, scrollHeight, clientHeight));\r\n    };\r\n\r\n    // Calculate how far the post list is from being scrolled to the bottom\r\n    getOffsetFromBottom = (scrollOffset: number, scrollHeight: number, clientHeight: number) => scrollHeight - clientHeight - scrollOffset;\r\n\r\n    isAtBottom = (scrollOffset: number, scrollHeight: number, clientHeight: number) => {\r\n        const offsetFromBottom = this.getOffsetFromBottom(scrollOffset, scrollHeight, clientHeight);\r\n\r\n        return offsetFromBottom <= BUFFER_TO_BE_CONSIDERED_BOTTOM && scrollHeight > 0;\r\n    };\r\n\r\n    updateAtBottom = (atBottom: boolean) => {\r\n        if (atBottom !== this.state.atBottom) {\r\n            // Update lastViewedBottom when the list reaches or leaves the bottom\r\n            let lastViewedBottom = Date.now();\r\n            if (this.props.latestPostTimeStamp && this.props.latestPostTimeStamp > lastViewedBottom) {\r\n                lastViewedBottom = this.props.latestPostTimeStamp;\r\n            }\r\n\r\n            // if we hit the bottom, we haven't just landed on the unread channel\r\n            this.setState({\r\n                atBottom,\r\n                lastViewedBottom,\r\n            });\r\n        }\r\n    };\r\n\r\n    updateLastViewedBottomAt = (lastViewedBottom = Date.now()) => {\r\n        this.setState({\r\n            lastViewedBottom,\r\n        });\r\n    };\r\n\r\n    handleScrollStop = () => {\r\n        if (this.mounted) {\r\n            this.setState({\r\n                isScrolling: false,\r\n            });\r\n        }\r\n    };\r\n\r\n    handleSearchHintDismiss = () => {\r\n        this.setState({\r\n            showSearchHint: false,\r\n            isSearchHintDismissed: true,\r\n        });\r\n    };\r\n\r\n    handleScrollToBottomToastDismiss = () => {\r\n        this.setState({\r\n            showScrollToBottomToast: false,\r\n            isScrollToBottomDismissed: true,\r\n        });\r\n    };\r\n\r\n    hideScrollToBottomToast = () => {\r\n        this.setState({\r\n            showScrollToBottomToast: false,\r\n        });\r\n    };\r\n\r\n    /*\r\n     * - Show the scroll-to-bottom toast at the same time as the search-hint toast.\r\n     * - Only show if the user hasn't dismissed it before, within a session.\r\n     * - Hide it if the user is at the bottom of the list.\r\n     */\r\n    updateScrollToBottomToastVisibility = (scrollOffset: number, scrollHeight: number, clientHeight: number) => {\r\n        if (this.state.showScrollToBottomToast && this.state.atBottom) {\r\n            this.setState({\r\n                showScrollToBottomToast: false,\r\n            });\r\n            return;\r\n        }\r\n\r\n        if (!this.state.isScrollToBottomDismissed) {\r\n            const offsetFromBottom = this.getOffsetFromBottom(scrollOffset, scrollHeight, clientHeight);\r\n            this.setState({\r\n                showScrollToBottomToast: offsetFromBottom > this.showSearchHintThreshold,\r\n            });\r\n        }\r\n    };\r\n\r\n    updateFloatingTimestamp = (visibleTopItem: number) => {\r\n        if (!this.props.isMobileView) {\r\n            return;\r\n        }\r\n\r\n        if (!this.props.postListIds) {\r\n            return;\r\n        }\r\n\r\n        this.setState({\r\n            topPostId: getLatestPostId(this.props.postListIds.slice(visibleTopItem)),\r\n        });\r\n    };\r\n\r\n    onItemsRendered = ({visibleStartIndex, visibleStopIndex}: Pick<OnItemsRenderedArgs, 'visibleStartIndex' | 'visibleStopIndex'>) => {\r\n        this.updateFloatingTimestamp(visibleStartIndex);\r\n\r\n        if (\r\n            this.newMessageLineIndex > 0 &&\r\n             !this.state.isNewMessageLineReached &&\r\n             this.newMessageLineIndex <= visibleStartIndex &&\r\n             this.newMessageLineIndex >= visibleStopIndex\r\n        ) {\r\n            this.onNewMessageLineReached();\r\n        }\r\n    };\r\n\r\n    initScrollToIndex = () => {\r\n        if (this.props.focusedPostId) {\r\n            const index = this.state.postListIds.findIndex(\r\n                (item) => item === this.props.focusedPostId,\r\n            );\r\n            return {\r\n                index,\r\n                position: 'center',\r\n            };\r\n        }\r\n\r\n        if (this.props.shouldStartFromBottomWhenUnread) {\r\n            return {\r\n                index: 0,\r\n                position: 'end',\r\n            };\r\n        }\r\n\r\n        const newMessagesSeparatorIndex = getNewMessagesIndex(this.state.postListIds);\r\n\r\n        if (newMessagesSeparatorIndex > 0) {\r\n            // if there is a dateLine above START_OF_NEW_MESSAGES then scroll to date line\r\n            if (isDateLine(this.state.postListIds[newMessagesSeparatorIndex + 1])) {\r\n                return {\r\n                    index: newMessagesSeparatorIndex + 1,\r\n                    position: 'start',\r\n                    offset: OFFSET_TO_SHOW_TOAST,\r\n                };\r\n            }\r\n            return {\r\n                index: newMessagesSeparatorIndex,\r\n                position: 'start',\r\n                offset: OFFSET_TO_SHOW_TOAST,\r\n            };\r\n        }\r\n\r\n        return {\r\n            index: 0,\r\n            position: 'end',\r\n        };\r\n    };\r\n\r\n    scrollToLatestMessages = () => {\r\n        if (this.props.atLatestPost) {\r\n            this.scrollToBottom();\r\n        } else {\r\n            this.updateNewMessagesAtInChannel();\r\n            this.props.actions.changeUnreadChunkTimeStamp(0);\r\n        }\r\n    };\r\n\r\n    scrollToUnreadMessages = () => {\r\n        this.props.actions.toggleShouldStartFromBottomWhenUnread();\r\n    };\r\n\r\n    scrollToBottom = () => {\r\n        this.listRef.current?.scrollToItem(0, 'end');\r\n    };\r\n\r\n    scrollToNewMessage = () => {\r\n        this.listRef.current?.scrollToItem(getNewMessagesIndex(this.state.postListIds), 'start', OFFSET_TO_SHOW_TOAST);\r\n    };\r\n\r\n    updateNewMessagesAtInChannel = (lastViewedAt = Date.now()) => {\r\n        this.props.actions.updateNewMessagesAtInChannel(this.props.channelId, lastViewedAt);\r\n    };\r\n\r\n    renderToasts = (width: number) => {\r\n        return (\r\n            <ToastWrapper\r\n                atLatestPost={this.props.atLatestPost}\r\n                postListIds={this.state.postListIds}\r\n                atBottom={this.state.atBottom}\r\n                width={width}\r\n                lastViewedBottom={this.state.lastViewedBottom}\r\n                latestPostTimeStamp={this.props.latestPostTimeStamp}\r\n                scrollToUnreadMessages={this.scrollToUnreadMessages}\r\n                scrollToNewMessage={this.scrollToNewMessage}\r\n                scrollToLatestMessages={this.scrollToLatestMessages}\r\n                updateNewMessagesAtInChannel={this.updateNewMessagesAtInChannel}\r\n                updateLastViewedBottomAt={this.updateLastViewedBottomAt}\r\n                shouldStartFromBottomWhenUnread={this.props.shouldStartFromBottomWhenUnread}\r\n                isNewMessageLineReached={this.state.isNewMessageLineReached}\r\n                channelId={this.props.channelId}\r\n                focusedPostId={this.props.focusedPostId}\r\n                initScrollOffsetFromBottom={this.state.initScrollOffsetFromBottom}\r\n                onSearchHintDismiss={this.handleSearchHintDismiss}\r\n                showSearchHintToast={this.state.showSearchHint}\r\n                showScrollToBottomToast={this.state.showScrollToBottomToast}\r\n                onScrollToBottomToastDismiss={this.handleScrollToBottomToastDismiss}\r\n                hideScrollToBottomToast={this.hideScrollToBottomToast}\r\n            />\r\n        );\r\n    };\r\n\r\n    render() {\r\n        const {dynamicListStyle} = this.state;\r\n\r\n        return (\r\n            <div\r\n                className='a11y__region'\r\n                data-a11y-sort-order='1'\r\n                data-a11y-focus-child={true}\r\n                data-a11y-order-reversed={true}\r\n                data-a11y-loop-navigation={false}\r\n                aria-label={Utils.localizeMessage({id: 'accessibility.sections.centerContent', defaultMessage: 'message list main region'})}\r\n            >\r\n                {this.props.isMobileView && (\r\n                    <>\r\n                        <FloatingTimestamp\r\n                            isScrolling={this.state.isScrolling}\r\n                            postId={this.state.topPostId}\r\n                        />\r\n                        <ScrollToBottomArrows\r\n                            isScrolling={this.state.isScrolling}\r\n                            atBottom={Boolean(this.state.atBottom)}\r\n                            onClick={this.scrollToBottom}\r\n                        />\r\n                    </>\r\n                )}\r\n                <div className='post-list-holder-by-time'>\r\n                    <div\r\n                        className='post-list__table'\r\n                    >\r\n                        <div\r\n                            id='postListContent'\r\n                            className='post-list__content'\r\n                        >\r\n                            <LatestPostReader postIds={this.props.postListIds}/>\r\n                            <AutoSizer>\r\n                                {({height, width}) => (\r\n                                    <>\r\n                                        <div>\r\n                                            <Pluggable pluggableName='ChannelToast'/>\r\n\r\n                                            {this.renderToasts(width)}\r\n                                        </div>\r\n\r\n                                        <DynamicVirtualizedList\r\n                                            ref={this.listRef}\r\n                                            id='postListScrollContainer'\r\n                                            className='post-list__dynamic'\r\n                                            height={height}\r\n                                            width={width}\r\n                                            itemData={this.state.postListIds}\r\n                                            overscanCountForward={OVERSCAN_COUNT_FORWARD}\r\n                                            overscanCountBackward={OVERSCAN_COUNT_BACKWARD}\r\n                                            onScroll={this.onScroll}\r\n                                            initScrollToIndex={this.initScrollToIndex}\r\n                                            canLoadMorePosts={this.props.actions.canLoadMorePosts}\r\n                                            innerRef={this.postListRef}\r\n                                            style={{...virtListStyles, ...dynamicListStyle}}\r\n                                            innerListStyle={postListStyle}\r\n                                            initRangeToRender={this.initRangeToRender}\r\n                                            loaderId={PostListRowListIds.OLDER_MESSAGES_LOADER}\r\n                                            correctScrollToBottom={this.props.atLatestPost}\r\n                                            onItemsRendered={this.onItemsRendered}\r\n                                            scrollToFailed={this.scrollToFailed}\r\n                                        >\r\n                                            {this.renderRow}\r\n                                        </DynamicVirtualizedList>\r\n                                    </>\r\n                                )}\r\n                            </AutoSizer>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport type {updateNewMessagesAtInChannel} from 'actions/global_actions';\r\nimport {clearMarks, mark} from 'actions/telemetry_actions.jsx';\r\nimport type {LoadPostsParameters, LoadPostsReturnValue, CanLoadMorePosts} from 'actions/views/channel';\r\n\r\nimport LoadingScreen from 'components/loading_screen';\r\nimport VirtPostList from 'components/post_view/post_list_virtualized/post_list_virtualized';\r\n\r\nimport {PostRequestTypes, Constants} from 'utils/constants';\r\nimport {Mark, Measure, measureAndReport} from 'utils/performance_telemetry';\r\nimport {getOldestPostId, getLatestPostId} from 'utils/post_utils';\r\n\r\nconst MAX_NUMBER_OF_AUTO_RETRIES = 3;\r\nexport const MAX_EXTRA_PAGES_LOADED = 30;\r\n\r\n// Post loading page sizes\r\nconst USER_SCROLL_POSTS_PER_PAGE = Constants.POST_CHUNK_SIZE / 2; // 30 posts for user scroll\r\nconst AUTO_LOAD_POSTS_PER_PAGE = 200; // Maximum server limit for auto-loading\r\n\r\n// Measures the time between channel or team switch started and the post list component rendering posts.\r\n// Set \"fresh\" to true when the posts have not been loaded before.\r\nfunction markAndMeasureChannelSwitchEnd(fresh = false) {\r\n    mark(Mark.PostListLoaded);\r\n\r\n    // Send new performance metrics to server\r\n    measureAndReport({\r\n        name: Measure.ChannelSwitch,\r\n        startMark: Mark.ChannelLinkClicked,\r\n        endMark: Mark.PostListLoaded,\r\n        labels: {\r\n            fresh: fresh.toString(),\r\n        },\r\n        canFail: true,\r\n    });\r\n    measureAndReport({\r\n        name: Measure.TeamSwitch,\r\n        startMark: Mark.TeamLinkClicked,\r\n        endMark: Mark.PostListLoaded,\r\n        labels: {\r\n            fresh: fresh.toString(),\r\n        },\r\n        canFail: true,\r\n    });\r\n\r\n    // Clear all the metrics so that we can differentiate between a channel and team switch next time this is called\r\n    clearMarks([\r\n        Mark.ChannelLinkClicked,\r\n        Mark.TeamLinkClicked,\r\n        Mark.PostListLoaded,\r\n    ]);\r\n}\r\n\r\nexport interface Props {\r\n\r\n    /**\r\n     *  Array of formatted post ids in the channel\r\n     *  This will be different from postListIds because of grouping and filtering of posts\r\n     *  This array should be used for making Before and After API calls\r\n     */\r\n    formattedPostIds?: string[];\r\n\r\n    /**\r\n     *  Array of post ids in the channel, ordered from newest to oldest\r\n     */\r\n    postListIds?: string[];\r\n\r\n    /**\r\n     * The channel the posts are in\r\n     */\r\n    channelId: string;\r\n\r\n    /*\r\n     * To get posts for perma view\r\n     */\r\n    focusedPostId?: string;\r\n\r\n    /*\r\n     * Used for determining if we are not at the recent most chunk in channel\r\n     */\r\n    atLatestPost: boolean;\r\n\r\n    /*\r\n     * Used for determining if we are at the channels oldest post\r\n     */\r\n    atOldestPost?: boolean;\r\n\r\n    /*\r\n     * Used for loading posts using unread API\r\n     */\r\n    isFirstLoad: boolean;\r\n\r\n    /*\r\n     * Used for syncing posts and is also passed down to virt list for newMessages indicator\r\n     */\r\n    latestPostTimeStamp?: number;\r\n\r\n    /*\r\n     * Used for passing down to virt list so it can change the chunk of posts selected\r\n     */\r\n    changeUnreadChunkTimeStamp: (lastViewedAt: number) => void;\r\n\r\n    /*\r\n     * Used for skipping the call on load\r\n     */\r\n    isPrefetchingInProcess: boolean;\r\n\r\n    isMobileView: boolean;\r\n\r\n    lastViewedAt: number;\r\n\r\n    toggleShouldStartFromBottomWhenUnread: () => void;\r\n    shouldStartFromBottomWhenUnread: boolean;\r\n    hasInaccessiblePosts: boolean;\r\n\r\n    actions: {\r\n\r\n        /*\r\n         * Used for getting permalink view posts\r\n         */\r\n        loadPostsAround: (channelId: string, focusedPostId: string) => Promise<ActionResult>;\r\n\r\n        /*\r\n         * Used for geting unreads posts\r\n         */\r\n        loadUnreads: (channelId: string) => Promise<ActionResult>;\r\n\r\n        /*\r\n         * Used for getting posts using BEFORE_ID and AFTER_ID\r\n         */\r\n        loadPosts: (parameters: LoadPostsParameters) => Promise<LoadPostsReturnValue>;\r\n\r\n        /*\r\n         * Used to loading posts since a timestamp to sync the posts\r\n         */\r\n        syncPostsInChannel: (channelId: string, since: number, prefetch: boolean) => Promise<ActionResult>;\r\n\r\n        /*\r\n         * Used to loading posts if it not first visit, permalink or there exists any postListIds\r\n         * This happens when previous channel visit has a chunk which is not the latest set of posts\r\n         */\r\n        loadLatestPosts: (channelId: string) => Promise<ActionResult>;\r\n\r\n        markChannelAsRead: (channelId: string) => void;\r\n        updateNewMessagesAtInChannel: typeof updateNewMessagesAtInChannel;\r\n    };\r\n}\r\n\r\ninterface State {\r\n    loadingNewerPosts: boolean;\r\n    loadingOlderPosts: boolean;\r\n    autoRetryEnable: boolean;\r\n}\r\n\r\nexport default class PostList extends React.PureComponent<Props, State> {\r\n    private autoRetriesCount: number;\r\n    private actionsForPostList: {\r\n        loadOlderPosts: () => Promise<void>;\r\n        loadNewerPosts: () => Promise<void>;\r\n        canLoadMorePosts: (type: CanLoadMorePosts) => Promise<void>;\r\n        changeUnreadChunkTimeStamp: (lastViewedAt: number) => void;\r\n        updateNewMessagesAtInChannel: typeof updateNewMessagesAtInChannel;\r\n        toggleShouldStartFromBottomWhenUnread: () => void;\r\n    };\r\n    private mounted: boolean | undefined;\r\n\r\n    // public for testing purposes only\r\n    public extraPagesLoaded: number;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n        this.state = {\r\n            loadingNewerPosts: false,\r\n            loadingOlderPosts: false,\r\n            autoRetryEnable: true,\r\n        };\r\n\r\n        this.extraPagesLoaded = 0;\r\n\r\n        this.autoRetriesCount = 0;\r\n        this.actionsForPostList = {\r\n            loadOlderPosts: this.getPostsBefore,\r\n            loadNewerPosts: this.getPostsAfter,\r\n            canLoadMorePosts: this.canLoadMorePosts,\r\n            changeUnreadChunkTimeStamp: props.changeUnreadChunkTimeStamp,\r\n            toggleShouldStartFromBottomWhenUnread: props.toggleShouldStartFromBottomWhenUnread,\r\n            updateNewMessagesAtInChannel: this.props.actions.updateNewMessagesAtInChannel,\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.mounted = true;\r\n        if (this.props.channelId) {\r\n            this.postsOnLoad(this.props.channelId);\r\n            if (this.props.postListIds) {\r\n                markAndMeasureChannelSwitchEnd();\r\n            }\r\n        }\r\n    }\r\n\r\n    componentDidUpdate(prevProps: Props) {\r\n        if (this.props.channelId !== prevProps.channelId) {\r\n            this.postsOnLoad(this.props.channelId);\r\n        }\r\n        if (this.props.postListIds != null && prevProps.postListIds == null) {\r\n            markAndMeasureChannelSwitchEnd(true);\r\n        }\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.mounted = false;\r\n    }\r\n\r\n    postsOnLoad = async (channelId: string) => {\r\n        const {focusedPostId, isFirstLoad, latestPostTimeStamp, isPrefetchingInProcess, actions} = this.props;\r\n        if (focusedPostId) {\r\n            await actions.loadPostsAround(channelId, focusedPostId);\r\n        } else if (isFirstLoad) {\r\n            if (!isPrefetchingInProcess) {\r\n                await actions.loadUnreads(channelId);\r\n            }\r\n        } else if (latestPostTimeStamp) {\r\n            await actions.syncPostsInChannel(channelId, latestPostTimeStamp, false);\r\n        } else {\r\n            await actions.loadLatestPosts(channelId);\r\n        }\r\n\r\n        if (!focusedPostId) {\r\n            // Posts are marked as read from here to not cause a race when loading posts\r\n            // marking channel as read and viewed after calling for posts in channel\r\n            this.props.actions.markChannelAsRead(channelId);\r\n        }\r\n\r\n        if (this.mounted) {\r\n            this.setState({\r\n                loadingOlderPosts: false,\r\n                loadingNewerPosts: false,\r\n            });\r\n        }\r\n    };\r\n\r\n    callLoadPosts = async (channelId: string, postId: string, type: CanLoadMorePosts, perPage: number) => {\r\n        const {error} = await this.props.actions.loadPosts({\r\n            channelId,\r\n            postId,\r\n            type,\r\n            perPage,\r\n        });\r\n\r\n        if (type === PostRequestTypes.BEFORE_ID) {\r\n            this.setState({loadingOlderPosts: false});\r\n        } else {\r\n            this.setState({loadingNewerPosts: false});\r\n        }\r\n\r\n        if (error) {\r\n            if (this.autoRetriesCount < MAX_NUMBER_OF_AUTO_RETRIES) {\r\n                this.autoRetriesCount++;\r\n                await this.callLoadPosts(channelId, postId, type, perPage);\r\n            } else if (this.mounted) {\r\n                this.setState({autoRetryEnable: false});\r\n            }\r\n        } else {\r\n            if (this.mounted) {\r\n                this.setState({autoRetryEnable: true});\r\n            }\r\n\r\n            if (!this.state.autoRetryEnable) {\r\n                this.autoRetriesCount = 0;\r\n            }\r\n        }\r\n\r\n        return {error};\r\n    };\r\n\r\n    getOldestVisiblePostId = () => {\r\n        return getOldestPostId(this.props.postListIds || []);\r\n    };\r\n\r\n    getLatestVisiblePostId = () => {\r\n        return getLatestPostId(this.props.postListIds || []);\r\n    };\r\n\r\n    canLoadMorePosts = async (type: CanLoadMorePosts = PostRequestTypes.BEFORE_ID) => {\r\n        if (this.props.hasInaccessiblePosts) {\r\n            return;\r\n        }\r\n\r\n        if (!this.props.postListIds) {\r\n            return;\r\n        }\r\n\r\n        if (this.state.loadingOlderPosts || this.state.loadingNewerPosts) {\r\n            return;\r\n        }\r\n\r\n        if (this.extraPagesLoaded > MAX_EXTRA_PAGES_LOADED) {\r\n            // Prevent this from loading a lot of pages in a channel with only hidden messages\r\n            // Enable load more messages manual link\r\n            if (this.state.autoRetryEnable) {\r\n                this.setState({autoRetryEnable: false});\r\n            }\r\n            return;\r\n        }\r\n\r\n        if (!this.props.atOldestPost && type === PostRequestTypes.BEFORE_ID) {\r\n            await this.getPostsBeforeAutoLoad();\r\n        } else if (!this.props.atLatestPost) {\r\n            // if all olderPosts are loaded load new ones\r\n            await this.getPostsAfter();\r\n        }\r\n\r\n        this.extraPagesLoaded += 1;\r\n    };\r\n\r\n    getPostsBefore = async () => {\r\n        if (this.state.loadingOlderPosts) {\r\n            return;\r\n        }\r\n\r\n        // Reset counter after \"Load more\" button click\r\n        if (!this.state.autoRetryEnable) {\r\n            this.extraPagesLoaded = 0;\r\n        }\r\n\r\n        const oldestPostId = this.getOldestVisiblePostId();\r\n        this.setState({loadingOlderPosts: true});\r\n        await this.callLoadPosts(this.props.channelId, oldestPostId, PostRequestTypes.BEFORE_ID, USER_SCROLL_POSTS_PER_PAGE);\r\n    };\r\n\r\n    getPostsAfter = async () => {\r\n        if (this.state.loadingNewerPosts) {\r\n            return;\r\n        }\r\n\r\n        // Reset counter after \"Load more\" button click\r\n        if (!this.state.autoRetryEnable) {\r\n            this.extraPagesLoaded = 0;\r\n        }\r\n\r\n        const latestPostId = this.getLatestVisiblePostId();\r\n        this.setState({loadingNewerPosts: true});\r\n        await this.callLoadPosts(this.props.channelId, latestPostId, PostRequestTypes.AFTER_ID, USER_SCROLL_POSTS_PER_PAGE);\r\n    };\r\n\r\n    getPostsBeforeAutoLoad = async () => {\r\n        if (this.state.loadingOlderPosts) {\r\n            return;\r\n        }\r\n\r\n        const oldestPostId = this.getOldestVisiblePostId();\r\n        this.setState({loadingOlderPosts: true});\r\n        await this.callLoadPosts(this.props.channelId, oldestPostId, PostRequestTypes.BEFORE_ID, AUTO_LOAD_POSTS_PER_PAGE);\r\n    };\r\n\r\n    render() {\r\n        if (!this.props.postListIds) {\r\n            return (\r\n                <LoadingScreen centered={true}/>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div className='post-list-holder-by-time'>\r\n                <div className='post-list__table'>\r\n                    <div\r\n                        id='virtualizedPostListContent'\r\n                        className='post-list__content'\r\n                    >\r\n                        <VirtPostList\r\n                            loadingNewerPosts={this.state.loadingNewerPosts}\r\n                            loadingOlderPosts={this.state.loadingOlderPosts}\r\n                            atOldestPost={this.props.atOldestPost}\r\n                            atLatestPost={this.props.atLatestPost}\r\n                            focusedPostId={this.props.focusedPostId}\r\n                            channelId={this.props.channelId}\r\n                            autoRetryEnable={this.state.autoRetryEnable}\r\n                            shouldStartFromBottomWhenUnread={this.props.shouldStartFromBottomWhenUnread}\r\n                            actions={this.actionsForPostList}\r\n                            postListIds={this.props.formattedPostIds}\r\n                            latestPostTimeStamp={this.props.latestPostTimeStamp}\r\n                            isMobileView={this.props.isMobileView}\r\n                            lastViewedAt={this.props.lastViewedAt}\r\n                        />\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {markChannelAsRead} from 'mattermost-redux/actions/channels';\r\nimport {RequestStatus} from 'mattermost-redux/constants';\r\nimport {getRecentPostsChunkInChannel, makeGetPostsChunkAroundPost, getUnreadPostsChunk, getPost, isPostsChunkIncludingUnreadsPosts, getLimitedViews} from 'mattermost-redux/selectors/entities/posts';\r\nimport {memoizeResult} from 'mattermost-redux/utils/helpers';\r\nimport {makePreparePostIdsForPostList} from 'mattermost-redux/utils/post_list';\r\n\r\nimport {updateNewMessagesAtInChannel} from 'actions/global_actions';\r\nimport {\r\n    loadPosts,\r\n    loadUnreads,\r\n    loadPostsAround,\r\n    syncPostsInChannel,\r\n    loadLatestPosts,\r\n} from 'actions/views/channel';\r\nimport {getIsMobileView} from 'selectors/views/browser';\r\n\r\nimport {getLatestPostId} from 'utils/post_utils';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport PostList from './post_list';\r\n\r\nconst isFirstLoad = (state: GlobalState, channelId: string) => !state.entities.posts.postsInChannel[channelId];\r\nconst memoizedGetLatestPostId = memoizeResult((postIds: string[]) => getLatestPostId(postIds));\r\n\r\n// This function is added as a fail safe for the channel sync issue we have.\r\n// When the user switches to a team for the first time we show the channel of previous team and then settle for the right channel after that\r\n// This causes the scroll correction etc an issue because post_list is not mounted for new channel instead it is updated\r\n\r\ninterface Props {\r\n    focusedPostId?: string;\r\n    unreadChunkTimeStamp?: number;\r\n    changeUnreadChunkTimeStamp: (lastViewedAt: number) => void;\r\n    channelId: string;\r\n}\r\n\r\nfunction makeMapStateToProps() {\r\n    const getPostsChunkAroundPost = makeGetPostsChunkAroundPost();\r\n    const preparePostIdsForPostList = makePreparePostIdsForPostList();\r\n\r\n    return function mapStateToProps(state: GlobalState, ownProps: Pick<Props, 'focusedPostId' | 'unreadChunkTimeStamp' | 'channelId'> & {shouldStartFromBottomWhenUnread: boolean}) {\r\n        let latestPostTimeStamp = 0;\r\n        let postIds: string[] | undefined;\r\n        let chunk;\r\n        let atLatestPost = false;\r\n        let atOldestPost = false;\r\n        let formattedPostIds: string[] | undefined;\r\n        const {focusedPostId, unreadChunkTimeStamp, channelId, shouldStartFromBottomWhenUnread} = ownProps;\r\n        const channelViewState = state.views.channel;\r\n        const lastViewedAt = channelViewState.lastChannelViewTime[channelId];\r\n        const isPrefetchingInProcess = channelViewState.channelPrefetchStatus[channelId] === RequestStatus.STARTED;\r\n        const limitedViews = getLimitedViews(state);\r\n        const hasInaccessiblePosts = Boolean(limitedViews.channels[channelId]) || limitedViews.channels[channelId] === 0;\r\n\r\n        const focusedPost = getPost(state, focusedPostId || '');\r\n\r\n        if (focusedPostId && focusedPost !== undefined) {\r\n            chunk = getPostsChunkAroundPost(state, focusedPostId, channelId);\r\n        } else if (unreadChunkTimeStamp && !shouldStartFromBottomWhenUnread) {\r\n            chunk = getUnreadPostsChunk(state, channelId, unreadChunkTimeStamp);\r\n        } else {\r\n            chunk = getRecentPostsChunkInChannel(state, channelId);\r\n        }\r\n\r\n        if (chunk) {\r\n            postIds = chunk.order;\r\n            atLatestPost = Boolean(chunk.recent);\r\n            atOldestPost = Boolean(chunk.oldest);\r\n        }\r\n\r\n        let shouldHideNewMessageIndicator = false;\r\n        if (unreadChunkTimeStamp != null) {\r\n            shouldHideNewMessageIndicator = shouldStartFromBottomWhenUnread && !isPostsChunkIncludingUnreadsPosts(state, chunk!, unreadChunkTimeStamp);\r\n        }\r\n\r\n        if (postIds) {\r\n            formattedPostIds = preparePostIdsForPostList(state, {postIds, lastViewedAt, indicateNewMessages: !shouldHideNewMessageIndicator});\r\n            if (postIds.length) {\r\n                const latestPostId = memoizedGetLatestPostId(postIds);\r\n                const latestPost = getPost(state, latestPostId);\r\n                latestPostTimeStamp = latestPost.create_at;\r\n            }\r\n        }\r\n\r\n        return {\r\n            lastViewedAt,\r\n            isFirstLoad: isFirstLoad(state, channelId),\r\n            formattedPostIds,\r\n            atLatestPost,\r\n            atOldestPost,\r\n            latestPostTimeStamp,\r\n            postListIds: postIds,\r\n            isPrefetchingInProcess,\r\n            shouldStartFromBottomWhenUnread,\r\n            isMobileView: getIsMobileView(state),\r\n            hasInaccessiblePosts,\r\n        };\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            loadUnreads,\r\n            loadPosts,\r\n            loadLatestPosts,\r\n            loadPostsAround,\r\n            syncPostsInChannel,\r\n            markChannelAsRead,\r\n            updateNewMessagesAtInChannel,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(makeMapStateToProps, mapDispatchToProps)(PostList);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\n\r\nimport LoadingScreen from 'components/loading_screen';\r\n\r\nimport {Preferences} from 'utils/constants';\r\n\r\nimport PostList from './post_list';\r\n\r\ntype Props = {\r\n    lastViewedAt?: number;\r\n    channelLoading: boolean;\r\n    channelId: string;\r\n    focusedPostId?: string;\r\n    unreadScrollPosition: string;\r\n};\r\n\r\ninterface State {\r\n    unreadChunkTimeStamp?: number;\r\n    loaderForChangeOfPostsChunk: boolean;\r\n    channelLoading: boolean;\r\n    shouldStartFromBottomWhenUnread: boolean;\r\n}\r\n\r\nexport default class PostView extends React.PureComponent<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n        const shouldStartFromBottomWhenUnread = this.props.unreadScrollPosition === Preferences.UNREAD_SCROLL_POSITION_START_FROM_NEWEST;\r\n        this.state = {\r\n            unreadChunkTimeStamp: props.lastViewedAt,\r\n            shouldStartFromBottomWhenUnread,\r\n            loaderForChangeOfPostsChunk: false,\r\n            channelLoading: props.channelLoading,\r\n        };\r\n    }\r\n\r\n    static getDerivedStateFromProps(props: Props, state: State) {\r\n        if (state.unreadChunkTimeStamp === null && props.lastViewedAt) {\r\n            return {\r\n                unreadChunkTimeStamp: props.lastViewedAt,\r\n            };\r\n        }\r\n        if (props.channelLoading !== state.channelLoading) {\r\n            return {\r\n                unreadChunkTimeStamp: props.lastViewedAt,\r\n                channelLoading: props.channelLoading,\r\n            };\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    changeUnreadChunkTimeStamp = (unreadChunkTimeStamp: number) => {\r\n        this.setState({\r\n            unreadChunkTimeStamp,\r\n            loaderForChangeOfPostsChunk: true,\r\n        }, () => {\r\n            window.requestAnimationFrame(() => {\r\n                this.setState({\r\n                    loaderForChangeOfPostsChunk: false,\r\n                });\r\n            });\r\n        });\r\n    };\r\n\r\n    toggleShouldStartFromBottomWhenUnread = () => {\r\n        this.setState((state) => ({\r\n            loaderForChangeOfPostsChunk: true,\r\n            shouldStartFromBottomWhenUnread: !state.shouldStartFromBottomWhenUnread,\r\n        }), () => {\r\n            window.requestAnimationFrame(() => {\r\n                this.setState({\r\n                    loaderForChangeOfPostsChunk: false,\r\n                });\r\n            });\r\n        });\r\n    };\r\n\r\n    render() {\r\n        if (this.props.channelLoading || this.state.loaderForChangeOfPostsChunk) {\r\n            return (\r\n                <div id='post-list'>\r\n                    <LoadingScreen centered={true}/>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div\r\n                id='post-list'\r\n                role='main'\r\n            >\r\n                <PostList\r\n                    unreadChunkTimeStamp={this.state.unreadChunkTimeStamp}\r\n                    channelId={this.props.channelId}\r\n                    changeUnreadChunkTimeStamp={this.changeUnreadChunkTimeStamp}\r\n                    shouldStartFromBottomWhenUnread={this.state.shouldStartFromBottomWhenUnread}\r\n                    toggleShouldStartFromBottomWhenUnread={this.toggleShouldStartFromBottomWhenUnread}\r\n                    focusedPostId={this.props.focusedPostId}\r\n                />\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {withRouter} from 'react-router-dom';\r\nimport type {RouteComponentProps} from 'react-router-dom';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {Team, TeamMembership} from '@mattermost/types/teams';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\n\r\nimport {getChannel} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getUnreadScrollPositionPreference} from 'mattermost-redux/selectors/entities/preferences';\r\nimport {getTeamByName, getTeamMemberships} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getUser} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {Constants} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport PostView from './post_view';\r\n\r\nexport const isChannelLoading = (params: RouteViewParams, channel?: Channel, team?: Team, teammate?: UserProfile, teamMemberships?: Record<string, TeamMembership>) => {\r\n    if (params.postid) {\r\n        return false;\r\n    }\r\n\r\n    const identifier = params.identifier?.toLowerCase();\r\n\r\n    if (channel && team) {\r\n        if (channel.type !== Constants.DM_CHANNEL && channel.name !== identifier) {\r\n            return true;\r\n        } else if (channel.type === Constants.DM_CHANNEL && teammate && identifier !== `@${teammate.username}`) {\r\n            return true;\r\n        }\r\n\r\n        const teamId = team.id;\r\n        if ((channel.team_id && channel.team_id !== teamId) || (teamMemberships && !teamMemberships[teamId])) {\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    return true;\r\n};\r\n\r\ntype RouteViewParams = {\r\n    team?: string;\r\n    identifier?: string;\r\n    postid?: string;\r\n};\r\n\r\ntype Props = {channelId: string} & RouteComponentProps<RouteViewParams>\r\n\r\nfunction makeMapStateToProps() {\r\n    return function mapStateToProps(state: GlobalState, ownProps: Props) {\r\n        const params = ownProps.match?.params;\r\n        const team = getTeamByName(state, params?.team || '');\r\n        let teammate;\r\n\r\n        const channel = getChannel(state, ownProps.channelId);\r\n        let lastViewedAt = state.views.channel.lastChannelViewTime[ownProps.channelId];\r\n        if (channel) {\r\n            if (channel.type === Constants.DM_CHANNEL && channel.teammate_id) {\r\n                teammate = getUser(state, channel.teammate_id);\r\n            }\r\n            lastViewedAt = channel.last_post_at ? lastViewedAt : channel.last_post_at;\r\n        }\r\n\r\n        const teamMemberships = getTeamMemberships(state);\r\n        const channelLoading = isChannelLoading(params!, channel, team, teammate, teamMemberships);\r\n        const unreadScrollPosition = getUnreadScrollPositionPreference(state);\r\n        return {\r\n            unreadScrollPosition,\r\n            lastViewedAt,\r\n            channelLoading,\r\n        };\r\n    };\r\n}\r\n\r\nexport default withRouter(connect(makeMapStateToProps)(PostView));\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useEffect, useState} from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nconst onClickRefresh = () => {\r\n    location.reload();\r\n};\r\n\r\nconst TIME_TO_SHOW = 5000;\r\nconst TIME_TO_DISMISS = 2000;\r\n\r\ntype Props = {\r\n    updateWaitForLoader: (v: boolean) => void;\r\n}\r\n\r\nconst InputLoading = ({\r\n    updateWaitForLoader,\r\n}: Props) => {\r\n    const [showMessage, setShowMessage] = useState(false);\r\n\r\n    useEffect(() => {\r\n        let timeout = setTimeout(() => {\r\n            setShowMessage(true);\r\n            updateWaitForLoader(true);\r\n            timeout = setTimeout(() => {\r\n                updateWaitForLoader(false);\r\n            }, TIME_TO_DISMISS);\r\n        }, TIME_TO_SHOW);\r\n\r\n        return () => {\r\n            clearTimeout(timeout);\r\n            updateWaitForLoader(false);\r\n        };\r\n    }, []);\r\n\r\n    return (\r\n        <div\r\n            className='AdvancedTextEditor__skeleton'\r\n        >\r\n            {showMessage && (\r\n                <>\r\n                    <FormattedMessage\r\n                        id='center_panel.input.cannot_load_component'\r\n                        defaultMessage='Something went wrong while loading the component. Please wait a moment, or try reloading the app.'\r\n                    />\r\n                    <button\r\n                        className='btn btn-tertiary channel-archived__close-btn'\r\n                        onClick={onClickRefresh}\r\n                    >\r\n                        <FormattedMessage\r\n                            id='center_panel.reloadPage'\r\n                            defaultMessage='Reload'\r\n                        />\r\n                    </button>\r\n                </>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default InputLoading;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {lazy} from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\nimport type {RouteComponentProps} from 'react-router-dom';\r\n\r\nimport {makeAsyncComponent} from 'components/async_load';\r\nimport deferComponentRender from 'components/deferComponentRender';\r\nimport {DropOverlayIdCenterChannel} from 'components/file_upload_overlay/file_upload_overlay';\r\nimport PostView from 'components/post_view';\r\n\r\nimport WebSocketClient from 'client/web_websocket_client';\r\n\r\nimport InputLoading from './input_loading';\r\n\r\nimport type {PropsFromRedux} from './index';\r\n\r\nconst ChannelHeader = makeAsyncComponent('ChannelHeader', lazy(() => import('components/channel_header')));\r\nconst FileUploadOverlay = makeAsyncComponent('FileUploadOverlay', lazy(() => import('components/file_upload_overlay')));\r\nconst ChannelBookmarks = makeAsyncComponent('ChannelBookmarks', lazy(() => import('components/channel_bookmarks')));\r\nconst AdvancedCreatePost = makeAsyncComponent('AdvancedCreatePost', lazy(() => import('components/advanced_create_post')));\r\nconst ChannelBanner = makeAsyncComponent('ChannelBanner', lazy(() => import('components/channel_banner/channel_banner')));\r\n\r\nexport type Props = PropsFromRedux & RouteComponentProps<{\r\n    postid?: string;\r\n}>;\r\n\r\ntype State = {\r\n    channelId: string;\r\n    url: string;\r\n    focusedPostId?: string;\r\n    deferredPostView: any;\r\n    waitForLoader: boolean;\r\n};\r\n\r\nexport default class ChannelView extends React.PureComponent<Props, State> {\r\n    public static createDeferredPostView = () => {\r\n        return deferComponentRender(\r\n            PostView,\r\n            <div\r\n                id='post-list'\r\n                className='a11y__region'\r\n                data-a11y-sort-order='1'\r\n                data-a11y-focus-child={true}\r\n                data-a11y-order-reversed={true}\r\n            />,\r\n        );\r\n    };\r\n\r\n    static getDerivedStateFromProps(props: Props, state: State) {\r\n        let updatedState = {};\r\n        const focusedPostId = props.match.params.postid;\r\n\r\n        if (props.match.url !== state.url && props.channelId !== state.channelId) {\r\n            updatedState = {deferredPostView: ChannelView.createDeferredPostView(), url: props.match.url, focusedPostId};\r\n        }\r\n\r\n        if (props.channelId !== state.channelId) {\r\n            updatedState = {...updatedState, channelId: props.channelId, focusedPostId};\r\n        }\r\n\r\n        if (focusedPostId && focusedPostId !== state.focusedPostId) {\r\n            updatedState = {...updatedState, focusedPostId};\r\n        }\r\n\r\n        if (Object.keys(updatedState).length) {\r\n            return updatedState;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    channelViewRef: React.RefObject<HTMLDivElement>;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            url: props.match.url,\r\n            channelId: props.channelId,\r\n            focusedPostId: props.match.params.postid,\r\n            deferredPostView: ChannelView.createDeferredPostView(),\r\n            waitForLoader: false,\r\n        };\r\n\r\n        this.channelViewRef = React.createRef();\r\n    }\r\n\r\n    onClickCloseChannel = () => {\r\n        this.props.goToLastViewedChannel();\r\n    };\r\n\r\n    onUpdateInputShowLoader = (v: boolean) => {\r\n        this.setState({waitForLoader: v});\r\n    };\r\n\r\n    componentDidUpdate(prevProps: Props) {\r\n        // TODO: debounce\r\n        if (prevProps.channelId !== this.props.channelId && this.props.enableWebSocketEventScope) {\r\n            WebSocketClient.updateActiveChannel(this.props.channelId);\r\n        }\r\n\r\n        // If we're restricting direct messages and the value is not yet set, fetch it\r\n        if (this.props.canRestrictDirectMessage && this.props.restrictDirectMessage === undefined) {\r\n            this.props.fetchIsRestrictedDM(this.props.channelId);\r\n        }\r\n    }\r\n\r\n    render() {\r\n        let createPost;\r\n        if (this.props.deactivatedChannel) {\r\n            createPost = (\r\n                <div\r\n                    className='post-create__container AdvancedTextEditor__ctr'\r\n                    id='post-create'\r\n                >\r\n                    <div\r\n                        className='channel-archived__message'\r\n                    >\r\n                        <FormattedMessage\r\n                            id='channelView.archivedChannelWithDeactivatedUser'\r\n                            defaultMessage='You are viewing an archived channel with a <b>deactivated user</b>. New messages cannot be posted.'\r\n                            values={{\r\n                                b: (chunks) => <b>{chunks}</b>,\r\n                            }}\r\n                        />\r\n                        <button\r\n                            className='btn btn-primary channel-archived__close-btn'\r\n                            onClick={this.onClickCloseChannel}\r\n                        >\r\n                            <FormattedMessage\r\n                                id='center_panel.archived.closeChannel'\r\n                                defaultMessage='Close Channel'\r\n                            />\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            );\r\n        } else if (this.props.channelIsArchived) {\r\n            createPost = (\r\n                <div\r\n                    className='post-create__container'\r\n                    id='post-create'\r\n                >\r\n                    <div\r\n                        id='channelArchivedMessage'\r\n                        className='channel-archived__message'\r\n                    >\r\n                        <FormattedMessage\r\n                            id='channelView.archivedChannel'\r\n                            defaultMessage='You are viewing an <b>archived channel</b>. New messages cannot be posted.'\r\n                            values={{\r\n                                b: (chunks) => <b>{chunks}</b>,\r\n                            }}\r\n                        />\r\n                        <button\r\n                            className='btn btn-primary channel-archived__close-btn'\r\n                            onClick={this.onClickCloseChannel}\r\n                        >\r\n                            <FormattedMessage\r\n                                id='center_panel.archived.closeChannel'\r\n                                defaultMessage='Close Channel'\r\n                            />\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            );\r\n        } else if (this.props.restrictDirectMessage) {\r\n            createPost = (\r\n                <div\r\n                    className='post-create__container'\r\n                    id='post-create'\r\n                >\r\n                    <div\r\n                        id='noSharedTeamMessage'\r\n                        className='channel-archived__message'\r\n                    >\r\n                        <FormattedMessage\r\n                            id='channelView.noSharedTeam'\r\n                            defaultMessage='You no longer have any teams in common with this user. New messages cannot be posted.'\r\n                            values={{\r\n                                b: (chunks) => <b>{chunks}</b>,\r\n                            }}\r\n                        />\r\n                        <button\r\n                            className='btn btn-primary channel-archived__close-btn'\r\n                            onClick={this.onClickCloseChannel}\r\n                        >\r\n                            <FormattedMessage\r\n                                id='center_panel.noSharedTeam.closeChannel'\r\n                                defaultMessage='Close Channel'\r\n                            />\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            );\r\n        } else if (this.props.missingChannelRole || this.state.waitForLoader) {\r\n            createPost = <InputLoading updateWaitForLoader={this.onUpdateInputShowLoader}/>;\r\n        } else {\r\n            createPost = (\r\n                <div\r\n                    id='post-create'\r\n                    data-testid='post-create'\r\n                    className='post-create__container AdvancedTextEditor__ctr'\r\n                >\r\n                    <AdvancedCreatePost/>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        const DeferredPostView = this.state.deferredPostView;\r\n\r\n        return (\r\n            <div\r\n                ref={this.channelViewRef}\r\n                id='app-content'\r\n                className='app__content'\r\n            >\r\n                <FileUploadOverlay\r\n                    overlayType='center'\r\n                    id={DropOverlayIdCenterChannel}\r\n                />\r\n                <ChannelHeader/>\r\n                {this.props.isChannelBookmarksEnabled && <ChannelBookmarks channelId={this.props.channelId}/>}\r\n                <ChannelBanner channelId={this.props.channelId}/>\r\n                <DeferredPostView\r\n                    channelId={this.props.channelId}\r\n                    focusedPostId={this.state.focusedPostId}\r\n                />\r\n                {createPost}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport type {ConnectedProps} from 'react-redux';\r\nimport {withRouter} from 'react-router-dom';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\n\r\nimport {fetchIsRestrictedDM} from 'mattermost-redux/actions/channels';\r\nimport {\r\n    getCurrentChannel,\r\n    getMyChannelMembership,\r\n    isDeactivatedDirectChannel,\r\n} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getConfig, getLicense} from 'mattermost-redux/selectors/entities/general';\r\nimport {getRoles} from 'mattermost-redux/selectors/entities/roles_helpers';\r\nimport {getCurrentRelativeTeamUrl} from 'mattermost-redux/selectors/entities/teams';\r\nimport {isFirstAdmin} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {goToLastViewedChannel} from 'actions/views/channel';\r\n\r\nimport {getIsChannelBookmarksEnabled} from 'components/channel_bookmarks/utils';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport ChannelView from './channel_view';\r\n\r\nfunction isMissingChannelRoles(state: GlobalState, channel?: Channel) {\r\n    const channelRoles = channel ? getMyChannelMembership(state, channel.id)?.roles || '' : '';\r\n    return !channelRoles.split(' ').some((v) => Boolean(getRoles(state)[v]));\r\n}\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const channel = getCurrentChannel(state);\r\n\r\n    const config = getConfig(state);\r\n\r\n    const enableOnboardingFlow = config.EnableOnboardingFlow === 'true';\r\n    const enableWebSocketEventScope = config.FeatureFlagWebSocketEventScope === 'true';\r\n\r\n    const missingChannelRole = isMissingChannelRoles(state, channel);\r\n\r\n    return {\r\n        channelId: channel ? channel.id : '',\r\n        deactivatedChannel: channel ? isDeactivatedDirectChannel(state, channel.id) : false,\r\n        enableOnboardingFlow,\r\n        channelIsArchived: channel ? channel.delete_at !== 0 : false,\r\n        isCloud: getLicense(state).Cloud === 'true',\r\n        teamUrl: getCurrentRelativeTeamUrl(state),\r\n        isFirstAdmin: isFirstAdmin(state),\r\n        enableWebSocketEventScope,\r\n        canRestrictDirectMessage: config.RestrictDirectMessage === 'team' && (channel?.type === 'D' || channel?.type === 'G'),\r\n        restrictDirectMessage: channel ? state.entities.channels.restrictedDMs[channel.id] : false,\r\n        isChannelBookmarksEnabled: getIsChannelBookmarksEnabled(state),\r\n        missingChannelRole,\r\n    };\r\n}\r\n\r\nconst mapDispatchToProps = ({\r\n    goToLastViewedChannel,\r\n    fetchIsRestrictedDM,\r\n});\r\n\r\nconst connector = connect(mapStateToProps, mapDispatchToProps);\r\n\r\nexport type PropsFromRedux = ConnectedProps<typeof connector>;\r\n\r\nexport default withRouter(connector(ChannelView));\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {History} from 'history';\r\nimport React from 'react';\r\nimport type {match} from 'react-router-dom';\r\n\r\nimport ChannelView from 'components/channel_view/index';\r\n\r\nimport {getHistory} from 'utils/browser_history';\r\nimport Constants from 'utils/constants';\r\n\r\nexport type Match = match<{\r\n    identifier: string;\r\n    team: string;\r\n    postid?: string;\r\n    path: string;\r\n}>;\r\n\r\nexport type MatchAndHistory = Pick<Props, 'match' | 'history'>\r\n\r\ntype Props = {\r\n    match: Match;\r\n    actions: {\r\n        onChannelByIdentifierEnter: (props: MatchAndHistory) => void;\r\n    };\r\n    history: History;\r\n};\r\n\r\nexport default class ChannelIdentifierRouter extends React.PureComponent<Props> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            prevProps: props,\r\n        };\r\n    }\r\n\r\n    private replaceUrlTimeout!: NodeJS.Timeout;\r\n\r\n    componentDidUpdate(prevProps: Props) {\r\n        if (this.props.match.params.team !== prevProps.match.params.team ||\r\n            this.props.match.params.identifier !== prevProps.match.params.identifier) {\r\n            clearTimeout(this.replaceUrlTimeout);\r\n            this.props.actions.onChannelByIdentifierEnter(this.props);\r\n            this.replaceUrlIfPermalink();\r\n        }\r\n    }\r\n    componentDidMount() {\r\n        this.props.actions.onChannelByIdentifierEnter(this.props);\r\n        this.replaceUrlIfPermalink();\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        clearTimeout(this.replaceUrlTimeout);\r\n    }\r\n\r\n    replaceUrlIfPermalink = () => {\r\n        if (this.props.match.params.postid) {\r\n            this.replaceUrlTimeout = setTimeout(() => {\r\n                const channelUrl = this.props.match.url.split('/').slice(0, -1).join('/');\r\n                getHistory().replace(channelUrl);\r\n            }, Constants.PERMALINK_FADEOUT);\r\n        }\r\n    };\r\n\r\n    render() {\r\n        return <ChannelView/>;\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {withRouter} from 'react-router-dom';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {onChannelByIdentifierEnter} from './actions';\r\nimport ChannelIdentifierRouter from './channel_identifier_router';\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            onChannelByIdentifierEnter,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default withRouter(connect(null, mapDispatchToProps)(ChannelIdentifierRouter));\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React, {lazy} from 'react';\r\nimport {Route, Switch, Redirect} from 'react-router-dom';\r\n\r\nimport {makeAsyncComponent} from 'components/async_load';\r\nimport ChannelIdentifierRouter from 'components/channel_layout/channel_identifier_router';\r\nimport LoadingScreen from 'components/loading_screen';\r\n\r\nimport {SCHEDULED_POST_URL_SUFFIX} from 'utils/constants';\r\nimport {IDENTIFIER_PATH_PATTERN, ID_PATH_PATTERN, TEAM_NAME_PATH_PATTERN} from 'utils/path';\r\n\r\nimport type {OwnProps, PropsFromRedux} from './index';\r\n\r\nconst MobileChannelHeader = makeAsyncComponent('MobileChannelHeader', lazy(() => import('components/mobile_channel_header')));\r\nconst GlobalThreads = makeAsyncComponent('GlobalThreads', lazy(() => import('components/threading/global_threads')),\r\n    (\r\n        <div className='app__content'>\r\n            <LoadingScreen/>\r\n        </div>\r\n    ),\r\n);\r\nconst Drafts = makeAsyncComponent('Drafts', lazy(() => import('components/drafts')),\r\n    (\r\n        <div className='app__content'>\r\n            <LoadingScreen/>\r\n        </div>\r\n    ),\r\n);\r\nconst PermalinkView = makeAsyncComponent('PermalinkView', lazy(() => import('components/permalink_view')));\r\nconst PlaybookRunner = makeAsyncComponent('PlaybookRunner', lazy(() => import('components/channel_layout/playbook_runner')));\r\n\r\ntype Props = PropsFromRedux & OwnProps;\r\n\r\ntype State = {\r\n    returnTo: string;\r\n    lastReturnTo: string;\r\n};\r\n\r\nexport default class CenterChannel extends React.PureComponent<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n        this.state = {\r\n            returnTo: '',\r\n            lastReturnTo: '',\r\n        };\r\n    }\r\n\r\n    static getDerivedStateFromProps(nextProps: Props, prevState: State) {\r\n        if (prevState.lastReturnTo !== nextProps.location.pathname && nextProps.location.pathname.includes('/pl/')) {\r\n            return {\r\n                lastReturnTo: nextProps.location.pathname,\r\n                returnTo: prevState.lastReturnTo,\r\n            };\r\n        }\r\n        return {lastReturnTo: nextProps.location.pathname};\r\n    }\r\n\r\n    async componentDidMount() {\r\n        const {actions} = this.props;\r\n        await actions.getProfiles();\r\n    }\r\n\r\n    render() {\r\n        const {lastChannelPath, isCollapsedThreadsEnabled, isMobileView} = this.props;\r\n        const url = this.props.match.url;\r\n\r\n        return (\r\n            <div\r\n                key='inner-wrap'\r\n                className={classNames('inner-wrap', 'channel__wrap', {\r\n                    'move--right': this.props.lhsOpen,\r\n                    'move--left': this.props.rhsOpen,\r\n                    'move--left-small': this.props.rhsMenuOpen,\r\n                })}\r\n            >\r\n                {isMobileView && <MobileChannelHeader/>}\r\n                <div className='row main'>\r\n                    <Switch>\r\n                        <Route\r\n                            path={`${url}/pl/:postid(${ID_PATH_PATTERN})`}\r\n                            render={(props) => (\r\n                                <PermalinkView\r\n                                    {...props}\r\n                                    returnTo={this.state.returnTo}\r\n                                />\r\n                            )}\r\n                        />\r\n                        <Route\r\n                            path={`/:team(${TEAM_NAME_PATH_PATTERN})/:path(channels|messages)/:identifier(${IDENTIFIER_PATH_PATTERN})/:postid(${ID_PATH_PATTERN})?`}\r\n                            component={ChannelIdentifierRouter}\r\n                        />\r\n                        <Route\r\n                            path={`/:team(${TEAM_NAME_PATH_PATTERN})/_playbooks/:playbookId(${ID_PATH_PATTERN})/run`}\r\n                        >\r\n                            <PlaybookRunner/>\r\n                        </Route>\r\n                        {isCollapsedThreadsEnabled ? (\r\n                            <Route\r\n                                path={`/:team(${TEAM_NAME_PATH_PATTERN})/threads/:threadIdentifier(${ID_PATH_PATTERN})?`}\r\n                                component={GlobalThreads}\r\n                            />\r\n                        ) : null}\r\n                        <Route\r\n                            path={`/:team(${TEAM_NAME_PATH_PATTERN})/drafts`}\r\n                            component={Drafts}\r\n                        />\r\n                        <Route\r\n                            path={`/:team(${TEAM_NAME_PATH_PATTERN})/${SCHEDULED_POST_URL_SUFFIX}`}\r\n                            component={Drafts}\r\n                        />\r\n\r\n                        <Redirect to={lastChannelPath}/>\r\n                    </Switch>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport type {ConnectedProps} from 'react-redux';\r\nimport {withRouter} from 'react-router-dom';\r\nimport type {RouteComponentProps} from 'react-router-dom';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {getProfiles} from 'mattermost-redux/actions/users';\r\nimport {getRedirectChannelNameForTeam} from 'mattermost-redux/selectors/entities/channels';\r\nimport {isCollapsedThreadsEnabled} from 'mattermost-redux/selectors/entities/preferences';\r\nimport {getTeamByName} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {getIsLhsOpen} from 'selectors/lhs';\r\nimport {getLastViewedChannelNameByTeamName, getLastViewedTypeByTeamName, getPreviousTeamId, getPreviousTeamLastViewedType} from 'selectors/local_storage';\r\nimport {getIsRhsOpen, getIsRhsMenuOpen} from 'selectors/rhs';\r\nimport {getIsMobileView} from 'selectors/views/browser';\r\n\r\nimport {PreviousViewedTypes} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport CenterChannel from './center_channel';\r\n\r\ntype Params = {\r\n    team: string;\r\n}\r\n\r\nexport type OwnProps = RouteComponentProps<Params>;\r\n\r\nconst mapStateToProps = (state: GlobalState, ownProps: OwnProps) => {\r\n    const lastViewedType = getLastViewedTypeByTeamName(state, ownProps.match.params.team);\r\n    let channelName = getLastViewedChannelNameByTeamName(state, ownProps.match.params.team);\r\n\r\n    const previousTeamId = getPreviousTeamId(state);\r\n    const team = getTeamByName(state, ownProps.match.params.team);\r\n\r\n    let previousTeamLastViewedType;\r\n\r\n    if (previousTeamId !== team?.id) {\r\n        previousTeamLastViewedType = getPreviousTeamLastViewedType(state);\r\n    }\r\n\r\n    if (!channelName) {\r\n        channelName = getRedirectChannelNameForTeam(state, team!.id);\r\n    }\r\n\r\n    let lastChannelPath;\r\n    if (isCollapsedThreadsEnabled(state) && (previousTeamLastViewedType === PreviousViewedTypes.THREADS || lastViewedType === PreviousViewedTypes.THREADS)) {\r\n        lastChannelPath = `${ownProps.match.url}/threads`;\r\n    } else {\r\n        lastChannelPath = `${ownProps.match.url}/channels/${channelName}`;\r\n    }\r\n\r\n    return {\r\n        lastChannelPath,\r\n        lhsOpen: getIsLhsOpen(state),\r\n        rhsOpen: getIsRhsOpen(state),\r\n        rhsMenuOpen: getIsRhsMenuOpen(state),\r\n        isCollapsedThreadsEnabled: isCollapsedThreadsEnabled(state),\r\n        currentUserId: getCurrentUserId(state),\r\n        isMobileView: getIsMobileView(state),\r\n    };\r\n};\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            getProfiles,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nconst connector = connect(mapStateToProps, mapDispatchToProps);\r\n\r\nexport type PropsFromRedux = ConnectedProps<typeof connector>;\r\n\r\nexport default withRouter(connector(CenterChannel));\r\n\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {useEffect} from 'react';\r\nimport {useDispatch} from 'react-redux';\r\nimport {useHistory, useLocation} from 'react-router-dom';\r\n\r\nimport {openModal} from 'actions/views/modals';\r\n\r\nimport InvitationModal from 'components/invitation_modal';\r\n\r\nimport {ModalIdentifiers} from 'utils/constants';\r\n\r\nimport type {ModalData} from 'types/actions';\r\n\r\ninterface ActionMap {\r\n    [key: string]: ModalData<any>;\r\n}\r\n\r\nfunction QueryParamActionController() {\r\n    const location = useLocation();\r\n    const dispatch = useDispatch();\r\n    const history = useHistory();\r\n\r\n    const actionMap: ActionMap = {\r\n        open_invitation_modal: {\r\n            modalId: ModalIdentifiers.INVITATION,\r\n            dialogType: InvitationModal,\r\n        },\r\n    };\r\n\r\n    useEffect(() => {\r\n        const searchParams = new URLSearchParams(location.search);\r\n        const action = searchParams.get('action');\r\n\r\n        if (action && actionMap[action]) {\r\n            dispatch(openModal(actionMap[action]));\r\n\r\n            // Delete the action after it's been invoked so that it's not locked for subsequent refreshes\r\n            searchParams.delete('action');\r\n            history.replace({\r\n                search: searchParams.toString(),\r\n            });\r\n        }\r\n    }, [location, actionMap]);\r\n\r\n    return null;\r\n}\r\n\r\nexport default QueryParamActionController;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {Channel, ChannelMembership} from '@mattermost/types/channels';\r\nimport type {RelationOneToOne} from '@mattermost/types/utilities';\r\n\r\nimport {isChannelMuted} from 'mattermost-redux/utils/channel_utils';\r\nimport {memoizeResult} from 'mattermost-redux/utils/helpers';\r\n\r\nenum Priority {\r\n    high = 1,\r\n    medium,\r\n    low\r\n}\r\n\r\nenum PrefetchLimits {\r\n    mentionMax = 10,\r\n    unreadMax = 20,\r\n}\r\n\r\n// function to return a queue obj with priotiy as key and array of channelIds as values.\r\n// high priority has channels with mentions\r\n// medium priority has channels with unreads\r\n// <10 unread channels. Prefetch everything.\r\n// 10-20 unread. Prefetch only mentions, capped to 10.\r\n// >20 unread. Don't prefetch anything.\r\nexport const prefetchQueue = memoizeResult((\r\n    unreadChannels: Channel[],\r\n    memberships: RelationOneToOne<Channel, ChannelMembership>,\r\n    collapsedThreads: boolean,\r\n) => {\r\n    const unreadChannelsCount = unreadChannels.length;\r\n    let result: {\r\n        1: string[];\r\n        2: string[];\r\n        3: string[];\r\n    } = {\r\n        [Priority.high]: [], // 1 being high priority requests\r\n        [Priority.medium]: [],\r\n        [Priority.low]: [], //TODO: add chanenls such as fav.\r\n    };\r\n    if (!unreadChannelsCount || unreadChannelsCount > PrefetchLimits.unreadMax) {\r\n        return result;\r\n    }\r\n    for (const channel of unreadChannels) {\r\n        const channelId = channel.id;\r\n        const membership = memberships[channelId];\r\n\r\n        if (unreadChannelsCount >= PrefetchLimits.mentionMax && result[Priority.high].length >= PrefetchLimits.mentionMax) {\r\n            break;\r\n        }\r\n\r\n        // TODO We check for muted channels 3 times here: getUnreadChannels checks it, this checks it, and the mark_unread\r\n        // check below is equivalent to checking if its muted.\r\n        if (membership && !isChannelMuted(membership)) {\r\n            if (collapsedThreads ? membership.mention_count_root : membership.mention_count) {\r\n                result = {\r\n                    ...result,\r\n                    [Priority.high]: [...result[Priority.high], channelId],\r\n                };\r\n            } else if (\r\n                membership.notify_props &&\r\n                membership.notify_props.mark_unread !== 'mention' &&\r\n                unreadChannelsCount < PrefetchLimits.mentionMax\r\n            ) {\r\n                result = {\r\n                    ...result,\r\n                    [Priority.medium]: [...result[Priority.medium], channelId],\r\n                };\r\n            }\r\n        }\r\n    }\r\n    return result;\r\n});\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport PQueue from 'p-queue';\r\nimport React from 'react';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport {loadProfilesForSidebar} from 'actions/user_actions';\r\n\r\nimport {Constants} from 'utils/constants';\r\n\r\nconst queue = new PQueue({concurrency: 2});\r\n\r\ntype Props = {\r\n    currentChannelId: string;\r\n    prefetchQueueObj: Record<string, string[]>;\r\n    prefetchRequestStatus: Record<string, string>;\r\n\r\n    // Whether or not the categories in the sidebar have been loaded for the current team\r\n    sidebarLoaded: boolean;\r\n\r\n    unreadChannels: Channel[];\r\n\r\n    actions: {\r\n        prefetchChannelPosts: (channelId: string, delay?: number) => Promise<ActionResult>;\r\n    };\r\n}\r\n\r\n/*\r\n    This component is responsible for prefetching data. As of now component only fetches for channel posts based on the below set of rules.\r\n    * Priority order:\r\n        Fetches channel posts 2 at a time, with mentions followed channels with unreads.\r\n\r\n    * Conditions for prefetching posts:\r\n        On load of webapp\r\n        On socket reconnect or system comes from sleep\r\n        On new message in a channel where user has not visited in the present session\r\n        On addition of user to a channel/GM\r\n        On Team switch\r\n\r\n        In order to solve the above conditions the component looks for changes in selector unread channels.\r\n        if there is a change in unreads selector, then component clears existing queue as it can be obselete\r\n        i.e there can be new mentions and we need to prioritise instead of unreads so, contructs a new queue\r\n        with dispacthes of unreads posts for channels which do not have prefetched requests.\r\n\r\n    * other changes:\r\n        Adds current channel posts requests to be dispatched as soon as it is set in redux state instead of dispatching it from actions down the hierarchy. Otherwise couple of prefetching requests are sent before the postlist makes a request for posts.\r\n        Add a jitter(0-1sec) for delaying post requests in case of a new message in open/private channels. This is to prevent a case when all clients request messages when new post is made in a channel with thousands of users.\r\n*/\r\nexport default class DataPrefetch extends React.PureComponent<Props> {\r\n    private prefetchTimeout?: number;\r\n\r\n    async componentDidUpdate(prevProps: Props) {\r\n        const {currentChannelId, prefetchQueueObj, sidebarLoaded} = this.props;\r\n        if (sidebarLoaded && !prevProps.sidebarLoaded) {\r\n            loadProfilesForSidebar();\r\n        }\r\n\r\n        if (currentChannelId && sidebarLoaded && (!prevProps.currentChannelId || !prevProps.sidebarLoaded)) {\r\n            queue.add(async () => this.prefetchPosts(currentChannelId));\r\n            this.prefetchData();\r\n        } else if (prevProps.prefetchQueueObj !== prefetchQueueObj) {\r\n            clearTimeout(this.prefetchTimeout);\r\n            await queue.clear();\r\n            this.prefetchData();\r\n        }\r\n    }\r\n\r\n    public prefetchPosts = (channelId: string) => {\r\n        let delay;\r\n        const channel = this.props.unreadChannels.find((unreadChannel) => channelId === unreadChannel.id);\r\n        if (channel && (channel.type === Constants.PRIVATE_CHANNEL || channel.type === Constants.OPEN_CHANNEL)) {\r\n            const isLatestPostInLastMin = (Date.now() - channel.last_post_at) <= 1000;\r\n            if (isLatestPostInLastMin) {\r\n                delay = Math.random() * 1000; // 1ms - 1000ms random wait to not choke server\r\n            }\r\n        }\r\n        return this.props.actions.prefetchChannelPosts(channelId, delay);\r\n    };\r\n\r\n    private prefetchData = () => {\r\n        const {prefetchRequestStatus, prefetchQueueObj} = this.props;\r\n        for (const priority in prefetchQueueObj) {\r\n            if (!Object.hasOwn(prefetchQueueObj, priority)) {\r\n                continue;\r\n            }\r\n\r\n            const priorityQueue = prefetchQueueObj[priority];\r\n            for (const channelId of priorityQueue) {\r\n                if (!Object.hasOwn(prefetchRequestStatus, channelId)) {\r\n                    queue.add(async () => this.prefetchPosts(channelId));\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    render() {\r\n        return null;\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {getCurrentChannelId, getUnreadChannels} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getMyChannelMemberships} from 'mattermost-redux/selectors/entities/common';\r\nimport {isCollapsedThreadsEnabled} from 'mattermost-redux/selectors/entities/preferences';\r\n\r\nimport {prefetchChannelPosts} from 'actions/views/channel';\r\nimport {getCategoriesForCurrentTeam} from 'selectors/views/channel_sidebar';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport {prefetchQueue} from './actions';\r\nimport DataPrefetch from './data_prefetch';\r\n\r\nfunction isSidebarLoaded(state: GlobalState) {\r\n    return getCategoriesForCurrentTeam(state).length > 0;\r\n}\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const lastUnreadChannel = state.views.channel.lastUnreadChannel;\r\n    const memberships = getMyChannelMemberships(state);\r\n    const unreadChannels = getUnreadChannels(state, lastUnreadChannel);\r\n    const prefetchQueueObj = prefetchQueue(unreadChannels, memberships, isCollapsedThreadsEnabled(state));\r\n    const prefetchRequestStatus = state.views.channel.channelPrefetchStatus;\r\n\r\n    return {\r\n        currentChannelId: getCurrentChannelId(state),\r\n        prefetchQueueObj,\r\n        prefetchRequestStatus,\r\n        sidebarLoaded: isSidebarLoaded(state),\r\n        unreadChannels,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            prefetchChannelPosts,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(DataPrefetch);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {HTMLAttributes} from 'react';\r\nimport React, {useRef} from 'react';\r\n\r\nimport {DEFAULT_LHS_WIDTH, CssVarKeyForResizable, ResizeDirection} from '../constants';\r\nimport ResizableDivider from '../resizable_divider';\r\n\r\ninterface Props extends HTMLAttributes<'div'> {\r\n    children: React.ReactNode;\r\n}\r\n\r\nfunction ResizableLhs({\r\n    children,\r\n    id,\r\n    className,\r\n}: Props) {\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n\r\n    return (\r\n        <div\r\n            id={id}\r\n            className={className}\r\n            ref={containerRef}\r\n        >\r\n            {children}\r\n            <ResizableDivider\r\n                name={'lhsResizeHandle'}\r\n                globalCssVar={CssVarKeyForResizable.LHS}\r\n                defaultWidth={DEFAULT_LHS_WIDTH}\r\n                dir={ResizeDirection.LEFT}\r\n                containerRef={containerRef}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default ResizableLhs;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback} from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\nimport {useHistory} from 'react-router-dom';\r\n\r\nimport {\r\n    LightbulbOutlineIcon,\r\n    AccountPlusOutlineIcon,\r\n    AccountMultiplePlusOutlineIcon,\r\n    SettingsOutlineIcon,\r\n    AccountMultipleOutlineIcon,\r\n    ExitToAppIcon,\r\n    MessagePlusOutlineIcon,\r\n    PlusIcon,\r\n    MonitorAccountIcon,\r\n} from '@mattermost/compass-icons/components';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {getCloudSubscription, getSubscriptionProduct} from 'mattermost-redux/selectors/entities/cloud';\r\nimport {getConfig, getLicense} from 'mattermost-redux/selectors/entities/general';\r\nimport {haveICurrentTeamPermission} from 'mattermost-redux/selectors/entities/roles';\r\nimport {haveISystemPermission} from 'mattermost-redux/selectors/entities/roles_helpers';\r\nimport {getJoinableTeamIds} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport {openModal} from 'actions/views/modals';\r\nimport {getMainMenuPluginComponents} from 'selectors/plugins';\r\n\r\nimport AddGroupsToTeamModal from 'components/add_groups_to_team_modal';\r\nimport useGetUsageDeltas from 'components/common/hooks/useGetUsageDeltas';\r\nimport InvitationModal from 'components/invitation_modal';\r\nimport LeaveTeamModal from 'components/leave_team_modal';\r\nimport * as Menu from 'components/menu';\r\nimport TeamGroupsManageModal from 'components/team_groups_manage_modal';\r\nimport TeamMembersModal from 'components/team_members_modal';\r\nimport TeamSettingsModal from 'components/team_settings_modal';\r\nimport RestrictedIndicator from 'components/widgets/menu/menu_items/restricted_indicator';\r\n\r\nimport {FREEMIUM_TO_ENTERPRISE_TRIAL_LENGTH_DAYS} from 'utils/cloud_utils';\r\nimport {LicenseSkus, ModalIdentifiers, MattermostFeatures, CloudProducts} from 'utils/constants';\r\nimport {isCloudLicense} from 'utils/license_utils';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\ninterface Props {\r\n    currentTeam: Team;\r\n}\r\n\r\nexport default function SidebarTeamMenu(props: Props) {\r\n    const license = useSelector(getLicense);\r\n    const config = useSelector(getConfig);\r\n\r\n    const havePermissionToCreateTeam = useSelector((state: GlobalState) => haveISystemPermission(state, {permission: Permissions.CREATE_TEAM}));\r\n    const havePermissionToManageTeam = useSelector((state: GlobalState) => haveICurrentTeamPermission(state, Permissions.MANAGE_TEAM));\r\n    const havePermissionToAddUserToTeam = useSelector((state: GlobalState) => haveICurrentTeamPermission(state, Permissions.ADD_USER_TO_TEAM));\r\n    const havePermissionToInviteGuest = useSelector((state: GlobalState) => haveICurrentTeamPermission(state, Permissions.INVITE_GUEST));\r\n    const isCloud = isCloudLicense(license);\r\n    const isGuestAccessEnabled = config?.EnableGuestAccounts === 'true';\r\n    const isTeamGroupConstrained = Boolean(props.currentTeam?.group_constrained);\r\n    const isLicensedForLDAPGroups = license?.LDAPGroups === 'true';\r\n    const experimentalPrimaryTeam = config.ExperimentalPrimaryTeam;\r\n    const joinableTeams = useSelector(getJoinableTeamIds);\r\n    const haveMoreJoinableTeams = joinableTeams?.length > 0;\r\n    const canJoinAnotherTeam = !experimentalPrimaryTeam && haveMoreJoinableTeams;\r\n\r\n    const tooltipText = props.currentTeam.description ? props.currentTeam.description : props.currentTeam.display_name;\r\n\r\n    return (\r\n        <Menu.Container\r\n            menuButton={{\r\n                id: 'sidebarTeamMenuButton',\r\n                class: 'btn btn-sm btn-quaternary btn-inverted',\r\n                children: (\r\n                    <>\r\n                        <span>{props.currentTeam.display_name}</span>\r\n                        <i className='icon icon-chevron-down'/>\r\n                    </>\r\n                ),\r\n            }}\r\n            menuButtonTooltip={{\r\n                text: tooltipText,\r\n            }}\r\n            menu={{\r\n                id: 'sidebarTeamMenu',\r\n            }}\r\n        >\r\n            {((isGuestAccessEnabled && havePermissionToInviteGuest) || havePermissionToAddUserToTeam) && (\r\n                <InvitePeopleMenuItem/>\r\n            )}\r\n            {isTeamGroupConstrained && isLicensedForLDAPGroups && havePermissionToManageTeam && (\r\n                <AddGroupsToTeamMenuItem/>\r\n            )}\r\n            {havePermissionToManageTeam && (\r\n                <TeamSettingsMenuItem/>\r\n            )}\r\n            <ManageViewMembersMenuItem/>\r\n            {(isTeamGroupConstrained && isLicensedForLDAPGroups && havePermissionToManageTeam) && (\r\n                <ManageGroupsMenuItem\r\n                    teamID={props.currentTeam.id}\r\n                />\r\n            )}\r\n            {(!isTeamGroupConstrained && experimentalPrimaryTeam !== props.currentTeam.name) && (\r\n                <LeaveTeamMenuItem/>\r\n            )}\r\n            {(canJoinAnotherTeam || havePermissionToCreateTeam) && <Menu.Separator/>}\r\n            {canJoinAnotherTeam &&\r\n                <JoinAnotherTeamMenuItem/>\r\n            }\r\n            {havePermissionToCreateTeam && (\r\n                <CreateTeamMenuItem\r\n                    isCloud={isCloud}\r\n                />\r\n            )}\r\n            <Menu.Separator/>\r\n            <LearnAboutTeamsMenuItem/>\r\n            <PluginMenuItems/>\r\n        </Menu.Container>\r\n    );\r\n}\r\n\r\nfunction InvitePeopleMenuItem(props: Menu.FirstMenuItemProps) {\r\n    const dispatch = useDispatch();\r\n\r\n    const handleClick = useCallback(() => {\r\n        dispatch(openModal({\r\n            modalId: ModalIdentifiers.INVITATION,\r\n            dialogType: InvitationModal,\r\n            dialogProps: {\r\n                focusOriginElement: 'sidebarTeamMenuButton',\r\n            },\r\n        }));\r\n    }, [dispatch]);\r\n\r\n    return (\r\n        <Menu.Item\r\n            onClick={handleClick}\r\n            leadingElement={(\r\n                <AccountMultiplePlusOutlineIcon\r\n                    size={18}\r\n                    aria-hidden='true'\r\n                />\r\n            )}\r\n            labels={(\r\n                <>\r\n                    <FormattedMessage\r\n                        id='sidebarLeft.teamMenu.invitePeopleMenuItem.primaryLabel'\r\n                        defaultMessage='Invite people'\r\n                    />\r\n                    <FormattedMessage\r\n                        id='sidebarLeft.teamMenu.invitePeopleMenuItem.secondaryLabel'\r\n                        defaultMessage='Add or invite people to the team'\r\n                    />\r\n                </>\r\n            )}\r\n            aria-haspopup='dialog'\r\n            {...props}\r\n        />\r\n    );\r\n}\r\n\r\nfunction AddGroupsToTeamMenuItem(props: Menu.FirstMenuItemProps) {\r\n    const dispatch = useDispatch();\r\n\r\n    const handleClick = useCallback(() => {\r\n        dispatch(openModal({\r\n            modalId: ModalIdentifiers.ADD_GROUPS_TO_TEAM,\r\n            dialogType: AddGroupsToTeamModal,\r\n            dialogProps: {\r\n                focusOriginElement: 'sidebarTeamMenuButton',\r\n            },\r\n        }));\r\n    }, [dispatch]);\r\n\r\n    return (\r\n        <Menu.Item\r\n            onClick={handleClick}\r\n            leadingElement={(\r\n                <AccountPlusOutlineIcon\r\n                    size={18}\r\n                    aria-hidden='true'\r\n                />\r\n            )}\r\n            labels={(\r\n                <FormattedMessage\r\n                    id='sidebarLeft.teamMenu.addGroupsToTeamMenuItem.primaryLabel'\r\n                    defaultMessage='Add groups'\r\n                />\r\n            )}\r\n            aria-haspopup='dialog'\r\n            {...props}\r\n        />\r\n    );\r\n}\r\n\r\nfunction TeamSettingsMenuItem(props: Menu.FirstMenuItemProps) {\r\n    const dispatch = useDispatch();\r\n\r\n    const handleClick = useCallback(() => {\r\n        dispatch(openModal({\r\n            modalId: ModalIdentifiers.TEAM_SETTINGS,\r\n            dialogType: TeamSettingsModal,\r\n            dialogProps: {\r\n                focusOriginElement: 'sidebarTeamMenuButton',\r\n            },\r\n        }));\r\n    }, [dispatch]);\r\n\r\n    return (\r\n        <Menu.Item\r\n            leadingElement={(\r\n                <SettingsOutlineIcon\r\n                    size={18}\r\n                    aria-hidden='true'\r\n                />\r\n            )}\r\n            onClick={handleClick}\r\n            labels={(\r\n                <FormattedMessage\r\n                    id='sidebarLeft.teamMenu.teamSettingsMenuItem.primaryLabel'\r\n                    defaultMessage='Team settings'\r\n                />\r\n            )}\r\n            aria-haspopup='dialog'\r\n            {...props}\r\n        />\r\n    );\r\n}\r\n\r\nfunction ManageViewMembersMenuItem(props: Menu.FirstMenuItemProps) {\r\n    const dispatch = useDispatch();\r\n\r\n    const havePermissionToRemoveUserFromTeam = useSelector((state: GlobalState) => haveICurrentTeamPermission(state, Permissions.REMOVE_USER_FROM_TEAM));\r\n    const havePermissionToManageTeamRoles = useSelector((state: GlobalState) => haveICurrentTeamPermission(state, Permissions.MANAGE_TEAM_ROLES));\r\n\r\n    const handleClick = useCallback(() => {\r\n        dispatch(openModal({\r\n            modalId: ModalIdentifiers.TEAM_MEMBERS,\r\n            dialogType: TeamMembersModal,\r\n            dialogProps: {\r\n                focusOriginElement: 'sidebarTeamMenuButton',\r\n            },\r\n        }));\r\n    }, [dispatch]);\r\n\r\n    let label = (\r\n        <FormattedMessage\r\n            id='sidebarLeft.teamMenu.viewMembersMenuItem.primaryLabel'\r\n            defaultMessage='View members'\r\n        />\r\n    );\r\n    if (havePermissionToRemoveUserFromTeam && havePermissionToManageTeamRoles) {\r\n        label = (\r\n            <FormattedMessage\r\n                id='sidebarLeft.teamMenu.manageMembersMenuItem.primaryLabel'\r\n                defaultMessage='Manage members'\r\n            />\r\n        );\r\n    }\r\n\r\n    return (\r\n        <Menu.Item\r\n            leadingElement={(\r\n                <AccountMultipleOutlineIcon\r\n                    size={18}\r\n                    aria-hidden='true'\r\n                />\r\n            )}\r\n            onClick={handleClick}\r\n            labels={label}\r\n            aria-haspopup='dialog'\r\n            {...props}\r\n        />\r\n    );\r\n}\r\n\r\ninterface ManageGroupsMenuItemProps {\r\n    teamID: Team['id'];\r\n}\r\n\r\nfunction ManageGroupsMenuItem({teamID}: ManageGroupsMenuItemProps) {\r\n    const dispatch = useDispatch();\r\n\r\n    const handleClick = useCallback(() => {\r\n        dispatch(openModal({\r\n            modalId: ModalIdentifiers.MANAGE_TEAM_GROUPS,\r\n            dialogType: TeamGroupsManageModal,\r\n            dialogProps: {\r\n                teamID,\r\n            },\r\n        }));\r\n    }, [dispatch, teamID]);\r\n\r\n    return (\r\n        <Menu.Item\r\n            leadingElement={(\r\n                <MonitorAccountIcon\r\n                    size={18}\r\n                    aria-hidden='true'\r\n                />\r\n            )}\r\n            onClick={handleClick}\r\n            labels={(\r\n                <FormattedMessage\r\n                    id='sidebarLeft.teamMenu.manageGroupsMenuItem.primaryLabel'\r\n                    defaultMessage='Manage groups'\r\n                />\r\n            )}\r\n            aria-haspopup='dialog'\r\n        />\r\n    );\r\n}\r\n\r\nfunction LeaveTeamMenuItem() {\r\n    const dispatch = useDispatch();\r\n\r\n    const handleClick = useCallback(() => {\r\n        dispatch(openModal({\r\n            modalId: ModalIdentifiers.LEAVE_TEAM,\r\n            dialogType: LeaveTeamModal,\r\n        }));\r\n    }, [dispatch]);\r\n\r\n    return (\r\n        <Menu.Item\r\n            leadingElement={(\r\n                <ExitToAppIcon\r\n                    size={18}\r\n                    aria-hidden='true'\r\n                />\r\n            )}\r\n            onClick={handleClick}\r\n            isDestructive={true}\r\n            labels={(\r\n                <FormattedMessage\r\n                    id='sidebarLeft.teamMenu.leaveTeamMenuItem.primaryLabel'\r\n                    defaultMessage='Leave team'\r\n                />\r\n            )}\r\n            aria-haspopup='dialog'\r\n        />\r\n    );\r\n}\r\n\r\nfunction JoinAnotherTeamMenuItem() {\r\n    const history = useHistory();\r\n\r\n    const handleClick = useCallback(() => {\r\n        history.push('/select_team');\r\n    }, [history]);\r\n\r\n    return (\r\n        <Menu.Item\r\n            leadingElement={(\r\n                <MessagePlusOutlineIcon\r\n                    size={18}\r\n                    aria-hidden='true'\r\n                />\r\n            )}\r\n            onClick={handleClick}\r\n            labels={(\r\n                <FormattedMessage\r\n                    id='sidebarLeft.teamMenu.joinAnotherTeamMenuItem.primaryLabel'\r\n                    defaultMessage='Join another team'\r\n                />\r\n            )}\r\n        />\r\n    );\r\n}\r\n\r\ninterface CreateTeamMenuItemProps {\r\n    isCloud: boolean;\r\n}\r\n\r\nfunction CreateTeamMenuItem({isCloud}: CreateTeamMenuItemProps) {\r\n    const history = useHistory();\r\n\r\n    const cloudSubscription = useSelector(getCloudSubscription);\r\n    const subscriptionProduct = useSelector(getSubscriptionProduct);\r\n    const isFreeTrial = isCloud && cloudSubscription?.is_free_trial === 'true';\r\n    const isStarterFree = isCloud && subscriptionProduct?.sku === CloudProducts.STARTER;\r\n    const usageDeltas = useGetUsageDeltas();\r\n    const isTeamsLimitReached = isStarterFree && !isFreeTrial && usageDeltas.teams.active >= 0;\r\n    const isTeamCreateRestricted = isCloud && (isFreeTrial || isTeamsLimitReached);\r\n\r\n    const handleClick = useCallback(() => {\r\n        if (isTeamsLimitReached || isTeamCreateRestricted) {\r\n            return;\r\n        }\r\n\r\n        history.push('/create_team');\r\n    }, [history, isTeamsLimitReached]);\r\n\r\n    return (\r\n        <Menu.Item\r\n            leadingElement={(\r\n                <PlusIcon\r\n                    size={18}\r\n                    aria-hidden='true'\r\n                />\r\n            )}\r\n            onClick={handleClick}\r\n            labels={(\r\n                <FormattedMessage\r\n                    id='sidebarLeft.teamMenu.createTeamMenuItem.primaryLabel'\r\n                    defaultMessage='Create a team'\r\n                />\r\n            )}\r\n            trailingElements={isTeamCreateRestricted && <RestrictedIndicatorForCreateTeam isFreeTrial={isFreeTrial}/>}\r\n        />\r\n    );\r\n}\r\n\r\nfunction RestrictedIndicatorForCreateTeam({isFreeTrial}: {isFreeTrial: boolean}) {\r\n    const {formatMessage} = useIntl();\r\n\r\n    return (\r\n        <RestrictedIndicator\r\n            feature={MattermostFeatures.CREATE_MULTIPLE_TEAMS}\r\n            minimumPlanRequiredForFeature={LicenseSkus.Professional}\r\n            blocked={!isFreeTrial}\r\n            tooltipMessage={formatMessage({\r\n                id: 'navbar_dropdown.create.tooltip.cloudFreeTrial',\r\n                defaultMessage: 'During your trial you are able to create multiple teams. These teams will be archived after your trial.',\r\n            })}\r\n            titleAdminPreTrial={formatMessage({\r\n                id: 'navbar_dropdown.create.modal.titleAdminPreTrial',\r\n                defaultMessage: 'Try unlimited teams with a free trial',\r\n            })}\r\n            messageAdminPreTrial={formatMessage({\r\n                id: 'navbar_dropdown.create.modal.messageAdminPreTrial',\r\n                defaultMessage: 'Create unlimited teams with one of our paid plans. Get the full experience of Enterprise when you start a free, {trialLength} day trial.',\r\n            },\r\n            {\r\n                trialLength: FREEMIUM_TO_ENTERPRISE_TRIAL_LENGTH_DAYS,\r\n            },\r\n            )}\r\n            titleAdminPostTrial={formatMessage({\r\n                id: 'navbar_dropdown.create.modal.titleAdminPostTrial',\r\n                defaultMessage: 'Upgrade to create unlimited teams',\r\n            })}\r\n            messageAdminPostTrial={formatMessage({\r\n                id: 'navbar_dropdown.create.modal.messageAdminPostTrial',\r\n                defaultMessage: \"Multiple teams allow for context-specific spaces that are more attuned to your and your teams' needs. Upgrade to the Professional plan to create unlimited teams.\",\r\n            })}\r\n            titleEndUser={formatMessage({\r\n                id: 'navbar_dropdown.create.modal.titleEndUser',\r\n                defaultMessage: 'Multiple teams available in paid plans',\r\n            })}\r\n            messageEndUser={formatMessage({\r\n                id: 'navbar_dropdown.create.modal.messageEndUser',\r\n                defaultMessage: \"Multiple teams allow for context-specific spaces that are more attuned to your teams' needs.\",\r\n            })}\r\n        />\r\n    );\r\n}\r\n\r\nconst MATTERMOST_ACADEMY_TEAM_TRAINING_LINK = 'https://mattermost.com/pl/mattermost-academy-team-training';\r\n\r\nfunction LearnAboutTeamsMenuItem() {\r\n    const handleClick = useCallback(() => {\r\n        window.open(MATTERMOST_ACADEMY_TEAM_TRAINING_LINK, '_blank', 'noopener noreferrer');\r\n    }, []);\r\n\r\n    return (\r\n        <Menu.Item\r\n            className='learnAboutTeamsMenuItem'\r\n            onClick={handleClick}\r\n            leadingElement={(\r\n                <LightbulbOutlineIcon\r\n                    size={18}\r\n                    aria-hidden='true'\r\n                />\r\n            )}\r\n            labels={(\r\n                <FormattedMessage\r\n                    id='sidebarLeft.teamMenu.learnAboutTeamsMenuItem.primaryLabel'\r\n                    defaultMessage='Learn about teams'\r\n                />\r\n            )}\r\n        />\r\n    );\r\n}\r\n\r\nfunction PluginMenuItems() {\r\n    const pluginInMainMenu = useSelector(getMainMenuPluginComponents);\r\n\r\n    if (pluginInMainMenu.length > 0) {\r\n        const pluginMenuItems = pluginInMainMenu.map((plugin) => {\r\n            function handleClick() {\r\n                if (plugin.action) {\r\n                    plugin.action();\r\n                }\r\n            }\r\n\r\n            return (\r\n                <Menu.Item\r\n                    id={`${plugin.id}_pluginmenuitem`}\r\n                    key={plugin.id}\r\n                    onClick={handleClick}\r\n                    labels={<span>{plugin.text}</span>}\r\n                />\r\n            );\r\n        });\r\n\r\n        return (\r\n            <>\r\n                <Menu.Separator/>\r\n                {pluginMenuItems}\r\n            </>\r\n        );\r\n    }\r\n\r\n    return null;\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {useSelector} from 'react-redux';\r\n\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport SidebarBrowseOrAddChannelMenu from './sidebar_browse_or_add_channel_menu';\r\nimport SidebarTeamMenu from './sidebar_team_menu';\r\n\r\nimport './sidebar_header.scss';\r\n\r\nexport type Props = {\r\n    showNewChannelModal: () => void;\r\n    showMoreChannelsModal: () => void;\r\n    showCreateUserGroupModal: () => void;\r\n    invitePeopleModal: () => void;\r\n    showCreateCategoryModal: () => void;\r\n    canCreateChannel: boolean;\r\n    canJoinPublicChannel: boolean;\r\n    handleOpenDirectMessagesModal: () => void;\r\n    unreadFilterEnabled: boolean;\r\n    canCreateCustomGroups: boolean;\r\n}\r\n\r\nconst SidebarHeader = (props: Props) => {\r\n    const currentTeam = useSelector(getCurrentTeam);\r\n\r\n    if (!currentTeam) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <div className='sidebarHeaderContainer'>\r\n            <SidebarTeamMenu currentTeam={currentTeam}/>\r\n            {(props.canCreateChannel || props.canJoinPublicChannel) && (\r\n                <SidebarBrowseOrAddChannelMenu\r\n                    canCreateChannel={props.canCreateChannel}\r\n                    onCreateNewChannelClick={props.showNewChannelModal}\r\n                    canJoinPublicChannel={props.canJoinPublicChannel}\r\n                    onBrowseChannelClick={props.showMoreChannelsModal}\r\n                    onOpenDirectMessageClick={props.handleOpenDirectMessagesModal}\r\n                    canCreateCustomGroups={props.canCreateCustomGroups}\r\n                    onCreateNewUserGroupClick={props.showCreateUserGroupModal}\r\n                    unreadFilterEnabled={props.unreadFilterEnabled}\r\n                    onCreateNewCategoryClick={props.showCreateCategoryModal}\r\n                    onInvitePeopleClick={props.invitePeopleModal}\r\n                />\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default SidebarHeader;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport SidebarHeader from './sidebar_header';\r\n\r\nexport default SidebarHeader;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage, injectIntl} from 'react-intl';\r\nimport type {WrappedComponentProps} from 'react-intl';\r\n\r\nimport {GenericModal} from '@mattermost/components';\r\nimport type {Channel} from '@mattermost/types/channels';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport NoResultsIndicator from 'components/no_results_indicator/no_results_indicator';\r\nimport {NoResultsVariant} from 'components/no_results_indicator/types';\r\nimport SuggestionBox from 'components/suggestion/suggestion_box';\r\nimport type SuggestionBoxComponent from 'components/suggestion/suggestion_box/suggestion_box';\r\nimport SuggestionList from 'components/suggestion/suggestion_list';\r\nimport {flattenItems, isItemLoaded, type SuggestionResults} from 'components/suggestion/suggestion_results';\r\nimport SwitchChannelProvider from 'components/suggestion/switch_channel_provider';\r\n\r\nimport {focusElement} from 'utils/a11y_utils';\r\nimport {getHistory} from 'utils/browser_history';\r\nimport Constants, {RHSStates} from 'utils/constants';\r\nimport * as UserAgent from 'utils/user_agent';\r\nimport * as Utils from 'utils/utils';\r\n\r\nimport type {RhsState} from 'types/store/rhs';\r\n\r\nconst CHANNEL_MODE = 'channel';\r\n\r\nexport type Props = WrappedComponentProps & {\r\n    onExited: () => void;\r\n\r\n    isMobileView: boolean;\r\n    rhsState?: RhsState;\r\n    rhsOpen?: boolean;\r\n\r\n    actions: {\r\n        joinChannelById: (channelId: string) => Promise<ActionResult>;\r\n        switchToChannel: (channel: Channel) => Promise<ActionResult>;\r\n        closeRightHandSide: () => void;\r\n    };\r\n    focusOriginElement: string;\r\n};\r\n\r\ntype State = {\r\n    text: string;\r\n    mode: string | null;\r\n    hasSuggestions: boolean;\r\n    shouldShowLoadingSpinner: boolean;\r\n    pretext: string;\r\n};\r\n\r\nexport class QuickSwitchModal extends React.PureComponent<Props, State> {\r\n    private channelProviders: SwitchChannelProvider[];\r\n    private switchBox: SuggestionBoxComponent | null;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.channelProviders = [new SwitchChannelProvider()];\r\n        this.switchBox = null;\r\n\r\n        this.state = {\r\n            text: '',\r\n            mode: CHANNEL_MODE,\r\n            hasSuggestions: true,\r\n            shouldShowLoadingSpinner: true,\r\n            pretext: '',\r\n        };\r\n    }\r\n\r\n    private focusTextbox = (): void => {\r\n        if (this.switchBox === null) {\r\n            return;\r\n        }\r\n        const textbox = this.switchBox.getTextbox();\r\n        if (document.activeElement !== textbox) {\r\n            textbox.focus();\r\n            Utils.placeCaretAtEnd(textbox);\r\n        }\r\n    };\r\n\r\n    private setSwitchBoxRef = (input: SuggestionBoxComponent): void => {\r\n        this.switchBox = input;\r\n        this.focusTextbox();\r\n    };\r\n\r\n    private hideOnSelect = (): void => {\r\n        this.focusPostTextbox();\r\n        this.setState({\r\n            text: '',\r\n        });\r\n        this.props.onExited();\r\n    };\r\n\r\n    private focusPostTextbox = (): void => {\r\n        if (!UserAgent.isMobile()) {\r\n            setTimeout(() => {\r\n                const textbox = document.querySelector('#post_textbox') as HTMLElement;\r\n                if (textbox) {\r\n                    textbox.focus();\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    private hideOnCancel = () => {\r\n        this.props.onExited?.();\r\n        focusElement(this.props.focusOriginElement, true);\r\n    };\r\n\r\n    private onChange = (e: React.ChangeEvent<HTMLInputElement>): void => {\r\n        this.setState({text: e.target.value, shouldShowLoadingSpinner: true});\r\n    };\r\n\r\n    public handleSubmit = async (selected?: any): Promise<void> => {\r\n        if (!selected) {\r\n            return;\r\n        }\r\n\r\n        if (this.props.rhsOpen && this.props.rhsState === RHSStates.EDIT_HISTORY) {\r\n            this.props.actions.closeRightHandSide();\r\n        }\r\n\r\n        if (this.state.mode === CHANNEL_MODE) {\r\n            const {joinChannelById, switchToChannel} = this.props.actions;\r\n            const selectedChannel = selected.channel;\r\n\r\n            if (selected.type === Constants.MENTION_MORE_CHANNELS && selectedChannel.type === Constants.OPEN_CHANNEL) {\r\n                await joinChannelById(selectedChannel.id);\r\n            }\r\n            switchToChannel(selectedChannel).then((result: ActionResult) => {\r\n                if ('data' in result) {\r\n                    this.hideOnSelect();\r\n                }\r\n            });\r\n        } else {\r\n            getHistory().push('/' + selected.name);\r\n            this.hideOnSelect();\r\n        }\r\n    };\r\n\r\n    private handleSuggestionsReceived = (suggestions: SuggestionResults): void => {\r\n        const suggestionItems = flattenItems(suggestions);\r\n        const loadingPropPresent = suggestionItems.some((item) => !isItemLoaded(item));\r\n        this.setState({\r\n            shouldShowLoadingSpinner: loadingPropPresent,\r\n            pretext: suggestions.matchedPretext,\r\n            hasSuggestions: suggestionItems.length > 0,\r\n        });\r\n    };\r\n\r\n    public render = (): JSX.Element => {\r\n        const providers: SwitchChannelProvider[] = this.channelProviders;\r\n\r\n        const header = (\r\n            <h2 id='quickSwitchHeader'>\r\n                <FormattedMessage\r\n                    id='quick_switch_modal.switchChannels'\r\n                    defaultMessage='Find Channels'\r\n                />\r\n            </h2>\r\n        );\r\n\r\n        let help: React.ReactNode;\r\n        if (this.props.isMobileView) {\r\n            help = (\r\n                <FormattedMessage\r\n                    id='quick_switch_modal.help_mobile'\r\n                    defaultMessage='Type to find a channel.'\r\n                />\r\n            );\r\n        } else {\r\n            help = (\r\n                <FormattedMessage\r\n                    id='quickSwitchModal.help_no_team'\r\n                    defaultMessage='Type to find a channel. Use <b>UP/DOWN</b> to browse, <b>ENTER</b> to select, <b>ESC</b> to dismiss.'\r\n                    values={{\r\n                        b: (chunks) => <b>{chunks}</b>,\r\n                    }}\r\n                />\r\n            );\r\n        }\r\n\r\n        const modalHeaderText = (\r\n            <div className='channel-switcher__header'>\r\n                {header}\r\n            </div>\r\n        );\r\n\r\n        const modalSubheaderText = (\r\n            <div\r\n                className='channel-switcher__hint'\r\n                id='quickSwitchHint'\r\n            >\r\n                {help}\r\n            </div>\r\n        );\r\n\r\n        return (\r\n            <GenericModal\r\n                className='a11y__modal channel-switcher'\r\n                id='quickSwitchModal'\r\n                show={true}\r\n                bodyPadding={false}\r\n                enforceFocus={false}\r\n                onExited={this.hideOnCancel}\r\n                onHide={this.hideOnCancel}\r\n                ariaLabel={this.props.intl.formatMessage({id: 'quick_switch_modal.switchChannels', defaultMessage: 'Find Channels'})}\r\n                modalHeaderText={modalHeaderText}\r\n                modalSubheaderText={modalSubheaderText}\r\n                compassDesign={true}\r\n            >\r\n                <div className='channel-switcher__suggestion-box'>\r\n                    <i className='icon icon-magnify icon-16'/>\r\n                    <SuggestionBox\r\n                        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\r\n                        // @ts-ignore\r\n                        ref={this.setSwitchBoxRef}\r\n                        id='quickSwitchInput'\r\n                        aria-label={this.props.intl.formatMessage({id: 'quick_switch_modal.input', defaultMessage: 'quick switch input'})}\r\n                        className='form-control focused'\r\n                        onChange={this.onChange}\r\n                        value={this.state.text}\r\n                        onItemSelected={this.handleSubmit}\r\n                        listComponent={SuggestionList}\r\n                        listPosition='bottom'\r\n                        maxLength='64'\r\n                        providers={providers}\r\n                        completeOnTab={false}\r\n                        spellCheck='false'\r\n                        delayInputUpdate={true}\r\n                        openWhenEmpty={true}\r\n                        onSuggestionsReceived={this.handleSuggestionsReceived}\r\n                        forceSuggestionsWhenBlur={true}\r\n                        shouldSearchCompleteText={true}\r\n                    />\r\n                    {\r\n                        !this.state.shouldShowLoadingSpinner &&\r\n                        !this.state.hasSuggestions &&\r\n                        this.state.text &&\r\n                        (\r\n                            <NoResultsIndicator\r\n                                variant={NoResultsVariant.Search}\r\n                                titleValues={{channelName: `${this.state.pretext}`}}\r\n                            />\r\n                        )\r\n                    }\r\n                </div>\r\n            </GenericModal>\r\n        );\r\n    };\r\n}\r\n\r\nexport default injectIntl(QuickSwitchModal);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {joinChannelById, switchToChannel} from 'actions/views/channel';\r\nimport {closeRightHandSide} from 'actions/views/rhs';\r\nimport {getIsRhsOpen, getRhsState} from 'selectors/rhs';\r\nimport {getIsMobileView} from 'selectors/views/browser';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport QuickSwitchModal from './quick_switch_modal';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    return {\r\n        isMobileView: getIsMobileView(state),\r\n        rhsState: getRhsState(state),\r\n        rhsOpen: getIsRhsOpen(state),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            joinChannelById,\r\n            switchToChannel,\r\n            closeRightHandSide,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(QuickSwitchModal);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\nimport {defineMessages, injectIntl} from 'react-intl';\r\nimport type {IntlShape} from 'react-intl';\r\n\r\nimport WithTooltip from 'components/with_tooltip';\r\nimport {ShortcutKeys} from 'components/with_tooltip/tooltip_shortcut';\r\n\r\nimport Constants from 'utils/constants';\r\nimport * as Keyboard from 'utils/keyboard';\r\n\r\nconst messages = defineMessages({\r\n    disableTooltip: {\r\n        id: 'sidebar_left.channel_filter.showAllChannels',\r\n        defaultMessage: 'Show all channels',\r\n    },\r\n    enableTooltip: {\r\n        id: 'sidebar_left.channel_filter.filterByUnread',\r\n        defaultMessage: 'Filter by unread',\r\n    },\r\n});\r\n\r\nconst shortcut = {\r\n    default: [ShortcutKeys.ctrl, ShortcutKeys.shift, 'U'],\r\n    mac: [ShortcutKeys.cmd, ShortcutKeys.shift, 'U'],\r\n};\r\n\r\ntype Props = {\r\n    intl: IntlShape;\r\n    unreadFilterEnabled: boolean;\r\n    actions: {\r\n        setUnreadFilterEnabled: (enabled: boolean) => void;\r\n    };\r\n};\r\n\r\nexport class ChannelFilter extends React.PureComponent<Props> {\r\n    componentDidMount() {\r\n        document.addEventListener('keydown', this.handleUnreadFilterKeyPress);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        document.removeEventListener('keydown', this.handleUnreadFilterKeyPress);\r\n    }\r\n\r\n    handleUnreadFilterClick = (e?: React.MouseEvent) => {\r\n        e?.preventDefault();\r\n        e?.stopPropagation();\r\n        this.toggleUnreadFilter();\r\n    };\r\n\r\n    handleUnreadFilterKeyPress = (e: KeyboardEvent) => {\r\n        if (Keyboard.cmdOrCtrlPressed(e) && e.shiftKey && Keyboard.isKeyPressed(e, Constants.KeyCodes.U)) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            this.toggleUnreadFilter();\r\n        }\r\n    };\r\n\r\n    toggleUnreadFilter = () => {\r\n        const {unreadFilterEnabled} = this.props;\r\n\r\n        this.props.actions.setUnreadFilterEnabled(!unreadFilterEnabled);\r\n    };\r\n\r\n    render() {\r\n        const {intl, unreadFilterEnabled} = this.props;\r\n\r\n        const unreadsAriaLabel = intl.formatMessage({id: 'sidebar_left.channel_filter.filterUnreadAria', defaultMessage: 'unreads filter'});\r\n\r\n        return (\r\n            <div className='SidebarFilters'>\r\n                <WithTooltip\r\n                    title={unreadFilterEnabled ? messages.disableTooltip : messages.enableTooltip}\r\n                    shortcut={shortcut}\r\n                >\r\n                    <a\r\n                        href='#'\r\n                        className={classNames('SidebarFilters_filterButton', {\r\n                            active: unreadFilterEnabled,\r\n                        })}\r\n                        onClick={this.toggleUnreadFilter}\r\n                        aria-label={unreadsAriaLabel}\r\n                    >\r\n                        <i className='icon icon-filter-variant'/>\r\n                    </a>\r\n                </WithTooltip>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default injectIntl(ChannelFilter);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {getMyTeams} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport {setUnreadFilterEnabled} from 'actions/views/channel_sidebar';\r\nimport {isUnreadFilterEnabled} from 'selectors/views/channel_sidebar';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport ChannelFilter from './channel_filter';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const teams = getMyTeams(state);\r\n\r\n    return {\r\n        hasMultipleTeams: teams && teams.length > 1,\r\n        unreadFilterEnabled: isUnreadFilterEnabled(state),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            setUnreadFilterEnabled,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ChannelFilter);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage, injectIntl} from 'react-intl';\r\nimport type {WrappedComponentProps} from 'react-intl';\r\n\r\nimport QuickSwitchModal from 'components/quick_switch_modal';\r\n\r\nimport Constants, {ModalIdentifiers} from 'utils/constants';\r\nimport * as Keyboard from 'utils/keyboard';\r\nimport * as UserAgent from 'utils/user_agent';\r\nimport * as Utils from 'utils/utils';\r\n\r\nimport type {ModalData} from 'types/actions';\r\n\r\nimport ChannelFilter from '../channel_filter';\r\n\r\nexport type Props = WrappedComponentProps & {\r\n    showUnreadsCategory: boolean;\r\n    isQuickSwitcherOpen: boolean;\r\n    actions: {\r\n        openModal: <P>(modalData: ModalData<P>) => void;\r\n        closeModal: (modalId: string) => void;\r\n    };\r\n};\r\n\r\nclass ChannelNavigator extends React.PureComponent<Props> {\r\n    componentDidMount() {\r\n        document.addEventListener('keydown', this.handleShortcut);\r\n        document.addEventListener('keydown', this.handleQuickSwitchKeyPress);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        document.removeEventListener('keydown', this.handleShortcut);\r\n        document.removeEventListener('keydown', this.handleQuickSwitchKeyPress);\r\n    }\r\n\r\n    openQuickSwitcher = (e: React.MouseEvent<HTMLButtonElement, MouseEvent>) => {\r\n        e.preventDefault();\r\n\r\n        this.props.actions.openModal({\r\n            modalId: ModalIdentifiers.QUICK_SWITCH,\r\n            dialogType: QuickSwitchModal,\r\n            dialogProps: {focusOriginElement: 'SidebarChannelNavigatorButton'},\r\n        });\r\n    };\r\n\r\n    handleShortcut = (e: KeyboardEvent) => {\r\n        const {actions: {closeModal}} = this.props;\r\n\r\n        if (Keyboard.cmdOrCtrlPressed(e) && e.shiftKey) {\r\n            if (Keyboard.isKeyPressed(e, Constants.KeyCodes.M)) {\r\n                e.preventDefault();\r\n                closeModal(ModalIdentifiers.QUICK_SWITCH);\r\n            }\r\n            if (Keyboard.isKeyPressed(e, Constants.KeyCodes.L)) {\r\n                // just close the modal if it's open, but let someone else handle the shortcut\r\n                closeModal(ModalIdentifiers.QUICK_SWITCH);\r\n            }\r\n        }\r\n    };\r\n\r\n    handleQuickSwitchKeyPress = (e: KeyboardEvent) => {\r\n        if (Keyboard.cmdOrCtrlPressed(e) && !e.shiftKey && Keyboard.isKeyPressed(e, Constants.KeyCodes.K)) {\r\n            if (!e.altKey && !Utils.isTextSelectedInPostOrReply(e)) {\r\n                e.preventDefault();\r\n                this.toggleQuickSwitchModal();\r\n            }\r\n        }\r\n    };\r\n\r\n    toggleQuickSwitchModal = () => {\r\n        const {isQuickSwitcherOpen, actions: {openModal, closeModal}} = this.props;\r\n\r\n        if (isQuickSwitcherOpen) {\r\n            closeModal(ModalIdentifiers.QUICK_SWITCH);\r\n        } else {\r\n            openModal({\r\n                modalId: ModalIdentifiers.QUICK_SWITCH,\r\n                dialogType: QuickSwitchModal,\r\n                dialogProps: {focusOriginElement: 'SidebarChannelNavigatorButton'},\r\n            });\r\n        }\r\n    };\r\n\r\n    render() {\r\n        return (\r\n            <div className={'SidebarChannelNavigator webapp'}>\r\n                {!this.props.showUnreadsCategory && <ChannelFilter/>}\r\n                <button\r\n                    className={'SidebarChannelNavigator_jumpToButton'}\r\n                    onClick={this.openQuickSwitcher}\r\n                    aria-label={this.props.intl.formatMessage({id: 'sidebar_left.channel_navigator.channelSwitcherLabel', defaultMessage: 'Channel Switcher'})}\r\n                    aria-haspopup='dialog'\r\n                    data-testid='SidebarChannelNavigatorButton'\r\n                    id='SidebarChannelNavigatorButton'\r\n                >\r\n                    <i className='icon icon-magnify'/>\r\n                    <FormattedMessage\r\n                        id='sidebar_left.channel_navigator.jumpTo'\r\n                        defaultMessage='Find channel'\r\n                    />\r\n                    <div className={'SidebarChannelNavigator_shortcutText'}>\r\n                        {`${UserAgent.isMac() ? '' : 'Ctrl+'}K`}\r\n                    </div>\r\n                </button>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default injectIntl(ChannelNavigator);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {shouldShowUnreadsCategory} from 'mattermost-redux/selectors/entities/preferences';\r\n\r\nimport {openModal, closeModal} from 'actions/views/modals';\r\nimport {isModalOpen} from 'selectors/views/modals';\r\n\r\nimport {ModalIdentifiers} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport ChannelNavigator from './channel_navigator';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    return {\r\n        showUnreadsCategory: shouldShowUnreadsCategory(state),\r\n        isQuickSwitcherOpen: isModalOpen(state, ModalIdentifiers.QUICK_SWITCH),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            openModal,\r\n            closeModal,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ChannelNavigator);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback} from 'react';\r\nimport {FormattedMessage, defineMessages, useIntl} from 'react-intl';\r\n\r\nimport {GenericModal} from '@mattermost/components';\r\nimport type {ChannelCategory} from '@mattermost/types/channel_categories';\r\n\r\nimport '../category_modal.scss';\r\n\r\ntype Props = {\r\n    category: ChannelCategory;\r\n    onExited: () => void;\r\n    actions: {\r\n        deleteCategory: (categoryId: string) => void;\r\n    };\r\n};\r\n\r\nexport default function DeleteCategoryModal(props: Props) {\r\n    const intl = useIntl();\r\n\r\n    const handleConfirm = useCallback(() => {\r\n        props.actions.deleteCategory(props.category.id);\r\n    }, [props.actions.deleteCategory, props.category]);\r\n\r\n    return (\r\n        <GenericModal\r\n            compassDesign={true}\r\n            ariaLabel={intl.formatMessage({id: 'delete_category_modal.deleteCategory', defaultMessage: 'Delete this category?'})}\r\n            onExited={props.onExited}\r\n            modalHeaderText={(\r\n                <FormattedMessage\r\n                    id='delete_category_modal.deleteCategory'\r\n                    defaultMessage='Delete this category?'\r\n                />\r\n            )}\r\n            handleCancel={props.onExited}\r\n            handleConfirm={handleConfirm}\r\n            confirmButtonText={(\r\n                <FormattedMessage\r\n                    id='delete_category_modal.delete'\r\n                    defaultMessage='Delete'\r\n                />\r\n            )}\r\n            confirmButtonClassName={'delete'}\r\n        >\r\n            <span className='delete-category__helpText'>\r\n                <FormattedMessage\r\n                    id='delete_category_modal.helpText'\r\n                    defaultMessage=\"Channels in <b>{category_name}</b> will move back to the Channels and Direct messages categories. You're not removed from any channels.\"\r\n                    values={{\r\n                        category_name: props.category.display_name,\r\n                        b: (chunks) => <b>{chunks}</b>,\r\n                    }}\r\n                />\r\n            </span>\r\n        </GenericModal>\r\n    );\r\n}\r\n\r\n// TODO MM-52680 These strings are properly defined in @mattermost/components, but the i18n tooling currently can't\r\n// find them there, so we've had to redefine them here\r\ndefineMessages({\r\n    cancel: {\r\n        id: 'generic_modal.cancel',\r\n        defaultMessage: 'Cancel',\r\n    },\r\n    confirm: {\r\n        id: 'generic_modal.confirm',\r\n        defaultMessage: 'Confirm',\r\n    },\r\n    paginationCount: {\r\n        id: 'footer_pagination.count',\r\n        defaultMessage: 'Showing {startCount, number}-{endCount, number} of {total, number}',\r\n    },\r\n    paginationNext: {\r\n        id: 'footer_pagination.next',\r\n        defaultMessage: 'Next',\r\n    },\r\n    paginationPrev: {\r\n        id: 'footer_pagination.prev',\r\n        defaultMessage: 'Previous',\r\n    },\r\n});\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {deleteCategory} from 'mattermost-redux/actions/channel_categories';\r\n\r\nimport DeleteCategoryModal from './delete_category_modal';\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            deleteCategory,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(null, mapDispatchToProps)(DeleteCategoryModal);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {memo, useCallback, useMemo} from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\n\r\nimport {\r\n    BellOutlineIcon,\r\n    TrashCanOutlineIcon,\r\n    PencilOutlineIcon,\r\n    FormatListBulletedIcon,\r\n    SortAlphabeticalAscendingIcon,\r\n    ClockOutlineIcon,\r\n    ChevronRightIcon,\r\n    CheckIcon,\r\n} from '@mattermost/compass-icons/components';\r\nimport type {ChannelCategory} from '@mattermost/types/channel_categories';\r\nimport {CategorySorting} from '@mattermost/types/channel_categories';\r\n\r\nimport {setCategoryMuted, setCategorySorting} from 'mattermost-redux/actions/channel_categories';\r\nimport {readMultipleChannels} from 'mattermost-redux/actions/channels';\r\nimport {CategoryTypes} from 'mattermost-redux/constants/channel_categories';\r\nimport {shouldShowUnreadsCategory} from 'mattermost-redux/selectors/entities/preferences';\r\n\r\nimport {openModal} from 'actions/views/modals';\r\nimport {makeGetUnreadIdsForCategory} from 'selectors/views/channel_sidebar';\r\n\r\nimport DeleteCategoryModal from 'components/delete_category_modal';\r\nimport EditCategoryModal from 'components/edit_category_modal';\r\nimport * as Menu from 'components/menu';\r\n\r\nimport {ModalIdentifiers} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport CreateNewCategoryMenuItem from './create_new_category_menu_item';\r\nimport MarkAsReadMenuItem from './mark_as_read_menu_item';\r\nimport SidebarCategoryGenericMenu from './sidebar_category_generic_menu';\r\n\r\ntype Props = {\r\n    category: ChannelCategory;\r\n};\r\n\r\nconst SidebarCategoryMenu = ({\r\n    category,\r\n}: Props) => {\r\n    const dispatch = useDispatch();\r\n    const showUnreadsCategory = useSelector(shouldShowUnreadsCategory);\r\n    const getUnreadsIdsForCategory = useMemo(makeGetUnreadIdsForCategory, [category]);\r\n    const unreadsIds = useSelector((state: GlobalState) => getUnreadsIdsForCategory(state, category));\r\n    const {formatMessage} = useIntl();\r\n\r\n    let muteUnmuteCategoryMenuItem: JSX.Element | null = null;\r\n    if (category.type !== CategoryTypes.DIRECT_MESSAGES) {\r\n        function toggleCategoryMute() {\r\n            dispatch(setCategoryMuted(category.id, !category.muted));\r\n        }\r\n\r\n        muteUnmuteCategoryMenuItem = (\r\n            <Menu.Item\r\n                id={`mute-${category.id}`}\r\n                onClick={toggleCategoryMute}\r\n                leadingElement={<BellOutlineIcon size={18}/>}\r\n                labels={\r\n                    category.muted ? (\r\n                        <FormattedMessage\r\n                            id='sidebar_left.sidebar_category_menu.unmuteCategory'\r\n                            defaultMessage='Unmute Category'\r\n                        />\r\n                    ) : (\r\n                        <FormattedMessage\r\n                            id='sidebar_left.sidebar_category_menu.muteCategory'\r\n                            defaultMessage='Mute Category'\r\n                        />\r\n                    )\r\n                }\r\n            />\r\n        );\r\n    }\r\n\r\n    let deleteCategoryMenuItem: JSX.Element | null = null;\r\n    let renameCategoryMenuItem: JSX.Element | null = null;\r\n    if (category.type === CategoryTypes.CUSTOM) {\r\n        function handleDeleteCategory() {\r\n            dispatch(openModal({\r\n                modalId: ModalIdentifiers.DELETE_CATEGORY,\r\n                dialogType: DeleteCategoryModal,\r\n                dialogProps: {\r\n                    category,\r\n                },\r\n            }));\r\n        }\r\n\r\n        deleteCategoryMenuItem = (\r\n            <Menu.Item\r\n                id={`delete-${category.id}`}\r\n                isDestructive={true}\r\n                aria-haspopup={true}\r\n                onClick={handleDeleteCategory}\r\n                leadingElement={<TrashCanOutlineIcon size={18}/>}\r\n                labels={(\r\n                    <FormattedMessage\r\n                        id='sidebar_left.sidebar_category_menu.deleteCategory'\r\n                        defaultMessage='Delete Category'\r\n                    />\r\n                )}\r\n            />\r\n        );\r\n\r\n        function handleRenameCategory() {\r\n            dispatch(openModal({\r\n                modalId: ModalIdentifiers.EDIT_CATEGORY,\r\n                dialogType: EditCategoryModal,\r\n                dialogProps: {\r\n                    categoryId: category.id,\r\n                    initialCategoryName: category.display_name,\r\n                },\r\n            }));\r\n        }\r\n\r\n        renameCategoryMenuItem = (\r\n            <Menu.Item\r\n                id={`rename-${category.id}`}\r\n                onClick={handleRenameCategory}\r\n                aria-haspopup={true}\r\n                leadingElement={<PencilOutlineIcon size={18}/>}\r\n                labels={(\r\n                    <FormattedMessage\r\n                        id='sidebar_left.sidebar_category_menu.renameCategory'\r\n                        defaultMessage='Rename Category'\r\n                    />\r\n                )}\r\n            />\r\n        );\r\n    }\r\n\r\n    function handleSortChannels(sorting: CategorySorting) {\r\n        dispatch(setCategorySorting(category.id, sorting));\r\n    }\r\n\r\n    let sortChannelsSelectedValue = (\r\n        <FormattedMessage\r\n            id='sidebar.sortedManually'\r\n            defaultMessage='Manually'\r\n        />\r\n    );\r\n    let sortChannelsIcon = <FormatListBulletedIcon size={18}/>;\r\n    if (category.sorting === CategorySorting.Alphabetical) {\r\n        sortChannelsSelectedValue = (\r\n            <FormattedMessage\r\n                id='user.settings.sidebar.sortAlpha'\r\n                defaultMessage='Alphabetically'\r\n            />\r\n        );\r\n        sortChannelsIcon = <SortAlphabeticalAscendingIcon size={18}/>;\r\n    } else if (category.sorting === CategorySorting.Recency) {\r\n        sortChannelsSelectedValue = (\r\n            <FormattedMessage\r\n                id='user.settings.sidebar.recent'\r\n                defaultMessage='Recent Activity'\r\n            />\r\n        );\r\n        sortChannelsIcon = <ClockOutlineIcon size={18}/>;\r\n    }\r\n\r\n    const sortChannelsMenuItem = (\r\n        <Menu.SubMenu\r\n            id={`sortChannels-${category.id}`}\r\n            leadingElement={sortChannelsIcon}\r\n            labels={(\r\n                <FormattedMessage\r\n                    id='sidebar.sort'\r\n                    defaultMessage='Sort'\r\n                />\r\n            )}\r\n            trailingElements={(\r\n                <>\r\n                    {sortChannelsSelectedValue}\r\n                    <ChevronRightIcon size={16}/>\r\n                </>\r\n            )}\r\n            menuId={`sortChannels-${category.id}-menu`}\r\n            menuAriaLabel={formatMessage({id: 'sidebar_left.sidebar_category_menu.sort.dropdownAriaLabel', defaultMessage: 'Sort submenu'})}\r\n        >\r\n            <Menu.Item\r\n                id={`sortAplhabetical-${category.id}`}\r\n                labels={(\r\n                    <FormattedMessage\r\n                        id='user.settings.sidebar.sortAlpha'\r\n                        defaultMessage='Alphabetically'\r\n                    />\r\n                )}\r\n                onClick={() => handleSortChannels(CategorySorting.Alphabetical)}\r\n                trailingElements={category.sorting === CategorySorting.Alphabetical ? <CheckIcon size={16}/> : null}\r\n            />\r\n            <Menu.Item\r\n                id={`sortByMostRecent-${category.id}`}\r\n                labels={(\r\n                    <FormattedMessage\r\n                        id='sidebar.sortedByRecencyLabel'\r\n                        defaultMessage='Recent Activity'\r\n                    />\r\n                )}\r\n                onClick={() => handleSortChannels(CategorySorting.Recency)}\r\n                trailingElements={category.sorting === CategorySorting.Recency ? <CheckIcon size={16}/> : null}\r\n            />\r\n            <Menu.Item\r\n                id={`sortManual-${category.id}`}\r\n                labels={(\r\n                    <FormattedMessage\r\n                        id='sidebar.sortedManually'\r\n                        defaultMessage='Manually'\r\n                    />\r\n                )}\r\n                onClick={() => handleSortChannels(CategorySorting.Manual)}\r\n                trailingElements={category.sorting === CategorySorting.Manual ? <CheckIcon size={16}/> : null}\r\n            />\r\n        </Menu.SubMenu>\r\n    );\r\n\r\n    const handleViewCategory = useCallback(() => {\r\n        dispatch(readMultipleChannels(unreadsIds));\r\n    }, [dispatch, unreadsIds]);\r\n\r\n    const markAsReadMenuItem = showUnreadsCategory === false ? (\r\n        <MarkAsReadMenuItem\r\n            id={category.id}\r\n            handleViewCategory={handleViewCategory}\r\n            numChannels={unreadsIds.length}\r\n        />\r\n    ) : null;\r\n\r\n    return (\r\n        <SidebarCategoryGenericMenu\r\n            id={category.id}\r\n            name={category.display_name}\r\n        >\r\n            {markAsReadMenuItem}\r\n            {markAsReadMenuItem && <Menu.Separator/>}\r\n            {muteUnmuteCategoryMenuItem}\r\n            {renameCategoryMenuItem}\r\n            {deleteCategoryMenuItem}\r\n            <Menu.Separator/>\r\n            {sortChannelsMenuItem}\r\n            <Menu.Separator/>\r\n            <CreateNewCategoryMenuItem id={category.id}/>\r\n        </SidebarCategoryGenericMenu>\r\n    );\r\n};\r\n\r\nexport default memo(SidebarCategoryMenu);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React, {memo, useState} from 'react';\r\nimport type {MouseEvent, KeyboardEvent} from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\n\r\nimport {\r\n    SortAlphabeticalAscendingIcon,\r\n    ClockOutlineIcon,\r\n    AccountMultipleOutlineIcon,\r\n    AccountPlusOutlineIcon,\r\n    DotsVerticalIcon,\r\n    ChevronRightIcon,\r\n    CheckIcon,\r\n} from '@mattermost/compass-icons/components';\r\nimport type {ChannelCategory} from '@mattermost/types/channel_categories';\r\nimport {CategorySorting} from '@mattermost/types/channel_categories';\r\n\r\nimport {setCategorySorting} from 'mattermost-redux/actions/channel_categories';\r\nimport {savePreferences} from 'mattermost-redux/actions/preferences';\r\nimport {Preferences} from 'mattermost-redux/constants';\r\nimport {getVisibleDmGmLimit} from 'mattermost-redux/selectors/entities/preferences';\r\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport * as Menu from 'components/menu';\r\n\r\nimport Constants from 'utils/constants';\r\n\r\ntype Props = {\r\n    category: ChannelCategory;\r\n    handleOpenDirectMessagesModal: (e: MouseEvent<HTMLLIElement> | KeyboardEvent<HTMLLIElement>) => void;\r\n};\r\n\r\nconst SidebarCategorySortingMenu = ({\r\n    category,\r\n    handleOpenDirectMessagesModal,\r\n}: Props) => {\r\n    const [isMenuOpen, setIsMenuOpen] = useState(false);\r\n    const {formatMessage} = useIntl();\r\n\r\n    const dispatch = useDispatch();\r\n    const selectedDmNumber = useSelector(getVisibleDmGmLimit);\r\n    const currentUserId = useSelector(getCurrentUserId);\r\n\r\n    function handleSortDirectMessages(sorting: CategorySorting) {\r\n        dispatch(setCategorySorting(category.id, sorting));\r\n    }\r\n\r\n    let sortDirectMessagesIcon = <ClockOutlineIcon size={18}/>;\r\n    let sortDirectMessagesSelectedValue = (\r\n        <FormattedMessage\r\n            id='user.settings.sidebar.recent'\r\n            defaultMessage='Recent Activity'\r\n        />\r\n    );\r\n    if (category.sorting === CategorySorting.Alphabetical) {\r\n        sortDirectMessagesSelectedValue = (\r\n            <FormattedMessage\r\n                id='user.settings.sidebar.sortAlpha'\r\n                defaultMessage='Alphabetically'\r\n            />\r\n        );\r\n        sortDirectMessagesIcon = <SortAlphabeticalAscendingIcon size={18}/>;\r\n    }\r\n\r\n    const sortDirectMessagesMenuItem = (\r\n        <Menu.SubMenu\r\n            id={`sortDirectMessages-${category.id}`}\r\n            leadingElement={sortDirectMessagesIcon}\r\n            labels={(\r\n                <FormattedMessage\r\n                    id='sidebar.sort'\r\n                    defaultMessage='Sort'\r\n                />\r\n            )}\r\n            trailingElements={\r\n                <>\r\n                    {sortDirectMessagesSelectedValue}\r\n                    <ChevronRightIcon size={16}/>\r\n                </>\r\n            }\r\n            menuId={`sortDirectMessages-${category.id}-menu`}\r\n        >\r\n            <Menu.Item\r\n                id={`sortAlphabetical-${category.id}`}\r\n                labels={(\r\n                    <FormattedMessage\r\n                        id='user.settings.sidebar.sortAlpha'\r\n                        defaultMessage='Alphabetically'\r\n                    />\r\n                )}\r\n                onClick={() => handleSortDirectMessages(CategorySorting.Alphabetical)}\r\n                trailingElements={category.sorting === CategorySorting.Alphabetical ? <CheckIcon size={16}/> : null}\r\n            />\r\n            <Menu.Item\r\n                id={`sortByMostRecent-${category.id}`}\r\n                labels={(\r\n                    <FormattedMessage\r\n                        id='sidebar.sortedByRecencyLabel'\r\n                        defaultMessage='Recent Activity'\r\n                    />\r\n                )}\r\n                onClick={() => handleSortDirectMessages(CategorySorting.Recency)}\r\n                trailingElements={category.sorting === CategorySorting.Recency ? <CheckIcon size={16}/> : null}\r\n            />\r\n        </Menu.SubMenu>\r\n\r\n    );\r\n\r\n    function handlelimitVisibleDMsGMs(number: number) {\r\n        dispatch(savePreferences(currentUserId, [{\r\n            user_id: currentUserId,\r\n            category: Constants.Preferences.CATEGORY_SIDEBAR_SETTINGS,\r\n            name: Preferences.LIMIT_VISIBLE_DMS_GMS,\r\n            value: number.toString(),\r\n        }]));\r\n    }\r\n\r\n    let showMessagesCountSelectedValue = <span>{selectedDmNumber}</span>;\r\n    if (selectedDmNumber === 10000) {\r\n        showMessagesCountSelectedValue = (\r\n            <FormattedMessage\r\n                id='channel_notifications.levels.all'\r\n                defaultMessage='All'\r\n            />\r\n        );\r\n    }\r\n\r\n    const showMessagesCountMenuItem = (\r\n        <Menu.SubMenu\r\n            id={`showMessagesCount-${category.id}`}\r\n            leadingElement={<AccountMultipleOutlineIcon size={18}/>}\r\n            labels={(\r\n                <FormattedMessage\r\n                    id='sidebar.show'\r\n                    defaultMessage='Show'\r\n                />\r\n            )}\r\n            trailingElements={(\r\n                <>\r\n                    {showMessagesCountSelectedValue}\r\n                    <ChevronRightIcon size={16}/>\r\n                </>\r\n            )}\r\n            menuId={`showMessagesCount-${category.id}-menu`}\r\n        >\r\n            {Constants.DM_AND_GM_SHOW_COUNTS.map((dmGmShowCount) => (\r\n                <Menu.Item\r\n                    id={`showDmCount-${category.id}-${dmGmShowCount}`}\r\n                    key={`showDmCount-${category.id}-${dmGmShowCount}`}\r\n                    labels={<span>{dmGmShowCount}</span>}\r\n                    onClick={() => handlelimitVisibleDMsGMs(dmGmShowCount)}\r\n                    trailingElements={selectedDmNumber === dmGmShowCount ? <CheckIcon size={16}/> : null}\r\n                />\r\n            ))}\r\n        </Menu.SubMenu>\r\n\r\n    );\r\n\r\n    const openDirectMessageMenuItem = (\r\n        <Menu.Item\r\n            id={`openDirectMessage-${category.id}`}\r\n            onClick={handleOpenDirectMessagesModal}\r\n            leadingElement={<AccountPlusOutlineIcon size={18}/>}\r\n            labels={(\r\n                <FormattedMessage\r\n                    id='sidebar.openDirectMessage'\r\n                    defaultMessage='Open a direct message'\r\n                />\r\n            )}\r\n        />\r\n    );\r\n\r\n    function handleMenuToggle(isOpen: boolean) {\r\n        setIsMenuOpen(isOpen);\r\n    }\r\n\r\n    return (\r\n        <div\r\n            className={classNames(\r\n                'SidebarMenu',\r\n                'MenuWrapper',\r\n                {menuOpen: isMenuOpen},\r\n                {'MenuWrapper--open': isMenuOpen},\r\n            )}\r\n        >\r\n            <Menu.Container\r\n                menuButton={{\r\n                    id: `SidebarCategorySortingMenu-Button-${category.id}`,\r\n                    'aria-label': formatMessage({id: 'sidebar_left.sidebar_category_menu.editCategory', defaultMessage: 'Category options'}, {name: category.display_name}),\r\n                    class: 'SidebarMenu_menuButton sortingMenu',\r\n                    children: <DotsVerticalIcon size={16}/>,\r\n                }}\r\n                menuButtonTooltip={{\r\n                    text: formatMessage({id: 'sidebar_left.sidebar_category_menu.editCategory', defaultMessage: 'Category options'}, {name: category.display_name}),\r\n                    class: 'hidden-xs',\r\n                }}\r\n                menu={{\r\n                    id: `SidebarCategorySortingMenu-MenuList-${category.id}`,\r\n                    'aria-label': formatMessage({id: 'sidebar_left.sidebar_category_menu.dropdownAriaLabel', defaultMessage: 'Edit category menu'}),\r\n                    onToggle: handleMenuToggle,\r\n                }}\r\n            >\r\n                {sortDirectMessagesMenuItem}\r\n                {showMessagesCountMenuItem}\r\n                <Menu.Separator/>\r\n                {openDirectMessageMenuItem}\r\n            </Menu.Container>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default memo(SidebarCategorySortingMenu);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nexport function isAddChannelCtaDropdownOpen(state: GlobalState) {\r\n    return state.views.addChannelCtaDropdown.isOpen;\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback} from 'react';\r\nimport {useIntl} from 'react-intl';\r\nimport {useSelector, useDispatch} from 'react-redux';\r\n\r\nimport {savePreferences} from 'mattermost-redux/actions/preferences';\r\nimport Permissions from 'mattermost-redux/constants/permissions';\r\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/common';\r\nimport {getBool} from 'mattermost-redux/selectors/entities/preferences';\r\nimport {haveICurrentChannelPermission} from 'mattermost-redux/selectors/entities/roles';\r\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport {setAddChannelCtaDropdown} from 'actions/views/add_channel_dropdown';\r\nimport {openModal} from 'actions/views/modals';\r\nimport {isAddChannelCtaDropdownOpen} from 'selectors/views/add_channel_dropdown';\r\n\r\nimport BrowseChannels from 'components/browse_channels';\r\nimport NewChannelModal from 'components/new_channel_modal/new_channel_modal';\r\nimport Menu from 'components/widgets/menu/menu';\r\nimport MenuWrapper from 'components/widgets/menu/menu_wrapper';\r\n\r\nimport {ModalIdentifiers, Preferences, Touched} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nconst AddChannelsCtaButton = (): JSX.Element | null => {\r\n    const dispatch = useDispatch();\r\n    const currentTeamId = useSelector(getCurrentTeamId);\r\n    const intl = useIntl();\r\n    const touchedAddChannelsCtaButton = useSelector((state: GlobalState) => getBool(state, Preferences.TOUCHED, Touched.ADD_CHANNELS_CTA));\r\n\r\n    const canCreatePublicChannel = useSelector((state: GlobalState) => haveICurrentChannelPermission(state, Permissions.CREATE_PUBLIC_CHANNEL));\r\n    const canCreatePrivateChannel = useSelector((state: GlobalState) => haveICurrentChannelPermission(state, Permissions.CREATE_PRIVATE_CHANNEL));\r\n    const canCreateChannel = canCreatePrivateChannel || canCreatePublicChannel;\r\n    const canJoinPublicChannel = useSelector((state: GlobalState) => haveICurrentChannelPermission(state, Permissions.JOIN_PUBLIC_CHANNELS));\r\n    const isAddChannelCtaOpen = useSelector(isAddChannelCtaDropdownOpen);\r\n    const currentUserId = useSelector(getCurrentUserId);\r\n    const openAddChannelsCtaOpen = useCallback((open: boolean) => {\r\n        dispatch(setAddChannelCtaDropdown(open));\r\n    }, []);\r\n\r\n    let buttonClass = 'SidebarChannelNavigator__addChannelsCtaLhsButton';\r\n\r\n    if (!touchedAddChannelsCtaButton) {\r\n        buttonClass += ' SidebarChannelNavigator__addChannelsCtaLhsButton--untouched';\r\n    }\r\n\r\n    if ((!canCreateChannel && !canJoinPublicChannel) || !currentTeamId) {\r\n        return null;\r\n    }\r\n\r\n    const showMoreChannelsModal = () => {\r\n        dispatch(openModal({\r\n            modalId: ModalIdentifiers.MORE_CHANNELS,\r\n            dialogType: BrowseChannels,\r\n        }));\r\n    };\r\n\r\n    const showNewChannelModal = () => {\r\n        dispatch(openModal({\r\n            modalId: ModalIdentifiers.NEW_CHANNEL_MODAL,\r\n            dialogType: NewChannelModal,\r\n        }));\r\n    };\r\n\r\n    const renderDropdownItems = () => {\r\n        let joinPublicChannel;\r\n        if (canJoinPublicChannel) {\r\n            joinPublicChannel = (\r\n                <Menu.ItemAction\r\n                    id='showMoreChannels'\r\n                    onClick={showMoreChannelsModal}\r\n                    icon={<i className='icon-globe'/>}\r\n                    text={intl.formatMessage({id: 'sidebar_left.add_channel_dropdown.browseChannels', defaultMessage: 'Browse channels'})}\r\n                />\r\n            );\r\n        }\r\n\r\n        let createChannel;\r\n        if (canCreateChannel) {\r\n            createChannel = (\r\n                <Menu.ItemAction\r\n                    id='showNewChannel'\r\n                    onClick={showNewChannelModal}\r\n                    icon={<i className='icon-plus'/>}\r\n                    text={intl.formatMessage({id: 'sidebar_left.add_channel_dropdown.createNewChannel', defaultMessage: 'Create new channel'})}\r\n                />\r\n            );\r\n        }\r\n\r\n        return (\r\n            <>\r\n                <Menu.Group>\r\n                    {createChannel}\r\n                    {joinPublicChannel}\r\n                </Menu.Group>\r\n            </>\r\n        );\r\n    };\r\n\r\n    const addChannelsButton = (btnCallback?: () => void) => {\r\n        const handleClick = () => btnCallback?.();\r\n        return (\r\n            <button\r\n                className={buttonClass}\r\n                id={'addChannelsCta'}\r\n                aria-label={intl.formatMessage({id: 'sidebar_left.add_channel_dropdown.dropdownAriaLabel', defaultMessage: 'Add Channel Dropdown'})}\r\n                onClick={handleClick}\r\n            >\r\n                <div\r\n                    aria-label={intl.formatMessage({id: 'sidebar_left.sidebar_channel_navigator.addChannelsCta', defaultMessage: 'Add channels'})}\r\n                >\r\n                    <i className='icon-plus-box'/>\r\n                    <span>\r\n                        {intl.formatMessage({id: 'sidebar_left.addChannelsCta', defaultMessage: 'Add Channels'})}\r\n                    </span>\r\n                </div>\r\n            </button>\r\n        );\r\n    };\r\n\r\n    const storePreferencesAndTrackEvent = () => {\r\n        if (!touchedAddChannelsCtaButton) {\r\n            dispatch(savePreferences(\r\n                currentUserId,\r\n                [{\r\n                    category: Preferences.TOUCHED,\r\n                    user_id: currentUserId,\r\n                    name: Touched.ADD_CHANNELS_CTA,\r\n                    value: 'true',\r\n                }],\r\n            ));\r\n        }\r\n    };\r\n\r\n    const trackOpen = (opened: boolean) => {\r\n        openAddChannelsCtaOpen(opened);\r\n        storePreferencesAndTrackEvent();\r\n    };\r\n\r\n    if (!canCreateChannel) {\r\n        const browseChannelsAction = () => {\r\n            showMoreChannelsModal();\r\n            storePreferencesAndTrackEvent();\r\n        };\r\n        return addChannelsButton(browseChannelsAction);\r\n    }\r\n\r\n    return (\r\n        <MenuWrapper\r\n            className='AddChannelsCtaDropdown'\r\n            onToggle={trackOpen}\r\n            open={isAddChannelCtaOpen}\r\n        >\r\n            {addChannelsButton()}\r\n            <Menu\r\n                id='AddChannelCtaDropdown'\r\n                ariaLabel={intl.formatMessage({id: 'sidebar_left.add_channel_cta_dropdown.dropdownAriaLabel', defaultMessage: 'Add Channels Dropdown'})}\r\n            >\r\n                {renderDropdownItems()}\r\n            </Menu>\r\n        </MenuWrapper>\r\n    );\r\n};\r\n\r\nexport default AddChannelsCtaButton;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {ActionTypes} from 'utils/constants';\r\n\r\nexport function setAddChannelCtaDropdown(open: boolean) {\r\n    return {\r\n        type: ActionTypes.ADD_CHANNEL_CTA_DROPDOWN_TOGGLE,\r\n        open,\r\n    };\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {useIntl, FormattedMessage} from 'react-intl';\r\nimport {useSelector} from 'react-redux';\r\n\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport InvitationModal from 'components/invitation_modal';\r\nimport TeamPermissionGate from 'components/permissions_gates/team_permission_gate';\r\nimport ToggleModalButton from 'components/toggle_modal_button';\r\n\r\nimport {ModalIdentifiers} from 'utils/constants';\r\n\r\ntype Props = {\r\n    className?: string;\r\n}\r\n\r\nconst InviteMembersButton = (props: Props): JSX.Element | null => {\r\n    const intl = useIntl();\r\n    const currentTeamId = useSelector(getCurrentTeamId);\r\n\r\n    if (!currentTeamId) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <TeamPermissionGate\r\n            teamId={currentTeamId}\r\n            permissions={[Permissions.ADD_USER_TO_TEAM, Permissions.INVITE_GUEST]}\r\n        >\r\n            <ToggleModalButton\r\n                ariaLabel={intl.formatMessage({id: 'sidebar_left.inviteMembers', defaultMessage: 'Invite Members'})}\r\n                id='inviteMembersButton'\r\n                className={`intro-links color--link cursor--pointer${props.className ? ` ${props.className}` : ''}`}\r\n                modalId={ModalIdentifiers.INVITATION}\r\n                dialogType={InvitationModal}\r\n                dialogProps={{focusOriginElement: 'inviteMembersButton'}}\r\n            >\r\n                <div\r\n                    className='SidebarChannelNavigator__inviteMembersLhsButton'\r\n                    aria-label={intl.formatMessage({id: 'sidebar_left.sidebar_channel_navigator.inviteUsers', defaultMessage: 'Invite Members'})}\r\n                >\r\n                    <i\r\n                        className='icon-plus-box'\r\n                        aria-hidden='true'\r\n                    />\r\n                    <FormattedMessage\r\n                        id={'sidebar_left.inviteMembers'}\r\n                        defaultMessage='Invite Members'\r\n                    />\r\n                </div>\r\n            </ToggleModalButton>\r\n        </TeamPermissionGate>\r\n    );\r\n};\r\n\r\nexport default InviteMembersButton;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\nimport type {MouseEvent, KeyboardEvent} from 'react';\r\nimport {Draggable, Droppable} from 'react-beautiful-dnd';\r\nimport {FormattedMessage, defineMessages} from 'react-intl';\r\n\r\nimport type {ChannelCategory} from '@mattermost/types/channel_categories';\r\nimport {CategorySorting} from '@mattermost/types/channel_categories';\r\nimport type {PreferenceType} from '@mattermost/types/preferences';\r\n\r\nimport {CategoryTypes} from 'mattermost-redux/constants/channel_categories';\r\nimport {localizeMessage} from 'mattermost-redux/utils/i18n_utils';\r\n\r\nimport KeyboardShortcutSequence, {\r\n    KEYBOARD_SHORTCUTS,\r\n} from 'components/keyboard_shortcuts/keyboard_shortcuts_sequence';\r\nimport WithTooltip from 'components/with_tooltip';\r\n\r\nimport Constants, {A11yCustomEventTypes, DraggingStateTypes, DraggingStates} from 'utils/constants';\r\nimport {isKeyPressed} from 'utils/keyboard';\r\n\r\nimport type {DraggingState} from 'types/store';\r\n\r\nimport SidebarCategoryMenu from './sidebar_category_menu';\r\nimport SidebarCategorySortingMenu from './sidebar_category_sorting_menu';\r\n\r\nimport AddChannelsCtaButton from '../add_channels_cta_button';\r\nimport InviteMembersButton from '../invite_members_button';\r\nimport {SidebarCategoryHeader} from '../sidebar_category_header';\r\nimport SidebarChannel from '../sidebar_channel';\r\n\r\ntype Props = {\r\n    category: ChannelCategory;\r\n    categoryIndex: number;\r\n    channelIds: string[];\r\n    setChannelRef: (channelId: string, ref: HTMLLIElement) => void;\r\n    handleOpenMoreDirectChannelsModal: (e: Event) => void;\r\n    isNewCategory: boolean;\r\n    draggingState: DraggingState;\r\n    currentUserId: string;\r\n    isAdmin: boolean;\r\n    actions: {\r\n        setCategoryCollapsed: (categoryId: string, collapsed: boolean) => void;\r\n        setCategorySorting: (categoryId: string, sorting: CategorySorting) => void;\r\n        savePreferences: (userId: string, preferences: PreferenceType[]) => void;\r\n    };\r\n};\r\n\r\ntype State = {\r\n    isMenuOpen: boolean;\r\n}\r\n\r\nexport default class SidebarCategory extends React.PureComponent<Props, State> {\r\n    categoryTitleRef: React.RefObject<HTMLButtonElement>;\r\n    newDropBoxRef: React.RefObject<HTMLDivElement>;\r\n\r\n    a11yKeyDownRegistered: boolean;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.categoryTitleRef = React.createRef();\r\n        this.newDropBoxRef = React.createRef();\r\n\r\n        this.state = {\r\n            isMenuOpen: false,\r\n        };\r\n\r\n        this.a11yKeyDownRegistered = false;\r\n    }\r\n\r\n    componentDidUpdate(prevProps: Props) {\r\n        if (this.props.category.collapsed !== prevProps.category.collapsed && this.newDropBoxRef.current) {\r\n            this.newDropBoxRef.current.classList.add('animating');\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.categoryTitleRef.current?.addEventListener(A11yCustomEventTypes.ACTIVATE, this.handleA11yActivateEvent);\r\n        this.categoryTitleRef.current?.addEventListener(A11yCustomEventTypes.DEACTIVATE, this.handleA11yDeactivateEvent);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.categoryTitleRef.current?.removeEventListener(A11yCustomEventTypes.ACTIVATE, this.handleA11yActivateEvent);\r\n        this.categoryTitleRef.current?.removeEventListener(A11yCustomEventTypes.DEACTIVATE, this.handleA11yDeactivateEvent);\r\n\r\n        if (this.a11yKeyDownRegistered) {\r\n            this.handleA11yDeactivateEvent();\r\n        }\r\n    }\r\n\r\n    handleA11yActivateEvent = () => {\r\n        this.categoryTitleRef.current?.addEventListener('keydown', this.handleA11yKeyDown);\r\n\r\n        this.a11yKeyDownRegistered = true;\r\n    };\r\n\r\n    handleA11yDeactivateEvent = () => {\r\n        this.categoryTitleRef.current?.removeEventListener('keydown', this.handleA11yKeyDown);\r\n\r\n        this.a11yKeyDownRegistered = false;\r\n    };\r\n\r\n    handleA11yKeyDown = (e: KeyboardEvent<HTMLButtonElement>['nativeEvent']) => {\r\n        if (isKeyPressed(e, Constants.KeyCodes.ENTER)) {\r\n            e.preventDefault();\r\n            this.handleCollapse();\r\n        }\r\n    };\r\n\r\n    renderChannel = (channelId: string, index: number) => {\r\n        const {setChannelRef, category, draggingState} = this.props;\r\n        return (\r\n            <SidebarChannel\r\n                key={channelId}\r\n                channelIndex={index}\r\n                channelId={channelId}\r\n                isDraggable={true}\r\n                setChannelRef={setChannelRef}\r\n                isCategoryCollapsed={category.collapsed}\r\n                isCategoryDragged={draggingState.type === DraggingStateTypes.CATEGORY && draggingState.id === category.id}\r\n                isAutoSortedCategory={category.sorting === CategorySorting.Alphabetical || category.sorting === CategorySorting.Recency}\r\n            />\r\n        );\r\n    };\r\n\r\n    handleCollapse = () => {\r\n        const {category} = this.props;\r\n\r\n        this.props.actions.setCategoryCollapsed(category.id, !category.collapsed);\r\n    };\r\n\r\n    removeAnimation = () => {\r\n        if (this.newDropBoxRef.current) {\r\n            this.newDropBoxRef.current.classList.remove('animating');\r\n        }\r\n    };\r\n\r\n    handleOpenDirectMessagesModal = (event: MouseEvent<HTMLLIElement | HTMLButtonElement> | KeyboardEvent<HTMLLIElement | HTMLButtonElement>) => {\r\n        event.preventDefault();\r\n\r\n        this.props.handleOpenMoreDirectChannelsModal(event.nativeEvent);\r\n    };\r\n\r\n    isDropDisabled = () => {\r\n        const {draggingState, category} = this.props;\r\n\r\n        if (category.type === CategoryTypes.DIRECT_MESSAGES) {\r\n            return draggingState.type === DraggingStateTypes.CHANNEL;\r\n        } else if (category.type === CategoryTypes.CHANNELS) {\r\n            return draggingState.type === DraggingStateTypes.DM;\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    renderNewDropBox = (isDraggingOver: boolean) => {\r\n        const {draggingState, category, isNewCategory, channelIds} = this.props;\r\n\r\n        if (!isNewCategory || channelIds?.length) {\r\n            return null;\r\n        }\r\n\r\n        return (\r\n            <>\r\n                <Draggable\r\n                    draggableId={`NEW_CHANNEL_SPACER__${category.id}`}\r\n                    isDragDisabled={true}\r\n                    index={0}\r\n                >\r\n                    {(provided) => {\r\n                        // NEW_CHANNEL_SPACER here is used as a spacer to ensure react-beautiful-dnd will not try and place the first channel\r\n                        // on the header. This acts as a space filler for the header so that the first channel dragged in will float below it.\r\n                        return (\r\n                            <li\r\n                                ref={provided.innerRef}\r\n                                draggable='false'\r\n                                className={'SidebarChannel noFloat newChannelSpacer'}\r\n                                {...provided.draggableProps}\r\n                                tabIndex={-1}\r\n                            />\r\n                        );\r\n                    }}\r\n                </Draggable>\r\n                <div className='SidebarCategory_newDropBox'>\r\n                    <div\r\n                        ref={this.newDropBoxRef}\r\n                        className={classNames('SidebarCategory_newDropBox-content', {\r\n                            collapsed: category.collapsed || (draggingState.type === DraggingStateTypes.CATEGORY && draggingState.id === category.id),\r\n                            isDraggingOver,\r\n                        })}\r\n                        onTransitionEnd={this.removeAnimation}\r\n                    >\r\n                        <i className='icon-hand-right'/>\r\n                        <span className='SidebarCategory_newDropBox-label'>\r\n                            <FormattedMessage\r\n                                id='sidebar_left.sidebar_category.newDropBoxLabel'\r\n                                defaultMessage='Drag channels here...'\r\n                            />\r\n                        </span>\r\n                    </div>\r\n                </div>\r\n            </>\r\n        );\r\n    };\r\n\r\n    showPlaceholder = () => {\r\n        const {channelIds, draggingState, category, isNewCategory} = this.props;\r\n\r\n        if (category.sorting === CategorySorting.Alphabetical ||\r\n            category.sorting === CategorySorting.Recency ||\r\n            isNewCategory) {\r\n            // Always show the placeholder if the channel being dragged is from the current category\r\n            if (channelIds.find((id) => id === draggingState.id)) {\r\n                return true;\r\n            }\r\n\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    };\r\n\r\n    render() {\r\n        const {\r\n            category,\r\n            categoryIndex,\r\n            channelIds,\r\n            isNewCategory,\r\n        } = this.props;\r\n\r\n        if (!category) {\r\n            return null;\r\n        }\r\n\r\n        if (category.type === CategoryTypes.FAVORITES && !channelIds?.length) {\r\n            return null;\r\n        }\r\n\r\n        const renderedChannels = channelIds.map(this.renderChannel);\r\n\r\n        let categoryMenu: JSX.Element;\r\n        let newLabel: JSX.Element;\r\n        const directMessagesModalButton: JSX.Element | null = null;\r\n        let isCollapsible = true;\r\n        if (isNewCategory) {\r\n            newLabel = (\r\n                <div className='SidebarCategory_newLabel'>\r\n                    <FormattedMessage\r\n                        id='sidebar_left.sidebar_category.newLabel'\r\n                        defaultMessage='new'\r\n                    />\r\n                </div>\r\n            );\r\n\r\n            categoryMenu = <SidebarCategoryMenu category={category}/>;\r\n        } else if (category.type === CategoryTypes.DIRECT_MESSAGES) {\r\n            const addHelpLabel = localizeMessage({id: 'sidebar.createDirectMessage', defaultMessage: 'Create new direct message'});\r\n\r\n            categoryMenu = (\r\n                <>\r\n                    <SidebarCategorySortingMenu\r\n                        category={category}\r\n                        handleOpenDirectMessagesModal={this.handleOpenDirectMessagesModal}\r\n                    />\r\n                    <WithTooltip\r\n                        title={\r\n                            <>\r\n                                {addHelpLabel}\r\n                                <KeyboardShortcutSequence\r\n                                    shortcut={KEYBOARD_SHORTCUTS.navDMMenu}\r\n                                    hideDescription={true}\r\n                                    isInsideTooltip={true}\r\n                                />\r\n                            </>\r\n                        }\r\n                    >\r\n                        <button\r\n                            id='newDirectMessageButton'\r\n                            className='SidebarChannelGroupHeader_addButton'\r\n                            onClick={this.handleOpenDirectMessagesModal}\r\n                            aria-label={addHelpLabel}\r\n                        >\r\n                            <i className='icon-plus'/>\r\n                        </button>\r\n                    </WithTooltip>\r\n                </>\r\n            );\r\n\r\n            if (!channelIds || !channelIds.length) {\r\n                isCollapsible = false;\r\n            }\r\n        } else {\r\n            categoryMenu = <SidebarCategoryMenu category={category}/>;\r\n        }\r\n\r\n        let displayName = category.display_name;\r\n        if (category.type !== CategoryTypes.CUSTOM) {\r\n            const message = categoryNames[category.type as keyof typeof categoryNames];\r\n            displayName = localizeMessage({id: message.id, defaultMessage: message.defaultMessage});\r\n        }\r\n\r\n        return (\r\n            <Draggable\r\n                draggableId={category.id}\r\n                index={categoryIndex}\r\n                disableInteractiveElementBlocking={true}\r\n            >\r\n                {(provided, snapshot) => {\r\n                    let inviteMembersButton = null;\r\n                    if (category.type === 'direct_messages' && !category.collapsed) {\r\n                        inviteMembersButton = (\r\n                            <InviteMembersButton\r\n                                className='followingSibling'\r\n                            />\r\n                        );\r\n                    }\r\n\r\n                    let addChannelsCtaButton = null;\r\n                    if (category.type === 'channels' && !category.collapsed) {\r\n                        addChannelsCtaButton = (\r\n                            <AddChannelsCtaButton/>\r\n                        );\r\n                    }\r\n\r\n                    return (\r\n                        <div\r\n                            className={classNames('SidebarChannelGroup a11y__section', {\r\n                                dropDisabled: this.isDropDisabled(),\r\n                                menuIsOpen: this.state.isMenuOpen,\r\n                                capture: this.props.draggingState.state === DraggingStates.CAPTURE,\r\n                                isCollapsed: category.collapsed,\r\n                            })}\r\n                            ref={provided.innerRef}\r\n                            {...provided.draggableProps}\r\n                        >\r\n                            <Droppable\r\n                                droppableId={category.id}\r\n                                type='SIDEBAR_CHANNEL'\r\n                                isDropDisabled={this.isDropDisabled()}\r\n                            >\r\n                                {(droppableProvided, droppableSnapshot) => {\r\n                                    return (\r\n                                        <div\r\n                                            {...droppableProvided.droppableProps}\r\n                                            ref={droppableProvided.innerRef}\r\n                                            className={classNames({\r\n                                                draggingOver: droppableSnapshot.isDraggingOver,\r\n                                            })}\r\n                                        >\r\n                                            <SidebarCategoryHeader\r\n                                                ref={this.categoryTitleRef}\r\n                                                displayName={displayName}\r\n                                                dragHandleProps={provided.dragHandleProps}\r\n                                                isCollapsed={category.collapsed}\r\n                                                isCollapsible={isCollapsible}\r\n                                                isDragging={snapshot.isDragging}\r\n                                                isDraggingOver={droppableSnapshot.isDraggingOver}\r\n                                                muted={category.muted}\r\n                                                onClick={this.handleCollapse}\r\n                                            >\r\n                                                {newLabel}\r\n                                                {directMessagesModalButton}\r\n                                                {categoryMenu}\r\n                                            </SidebarCategoryHeader>\r\n                                            <div\r\n                                                className={classNames('SidebarChannelGroup_content')}\r\n                                            >\r\n                                                <ul\r\n                                                    className='NavGroupContent'\r\n                                                >\r\n                                                    {this.renderNewDropBox(droppableSnapshot.isDraggingOver)}\r\n                                                    {renderedChannels}\r\n                                                    {this.showPlaceholder() ? droppableProvided.placeholder : null}\r\n                                                </ul>\r\n                                            </div>\r\n                                        </div>\r\n                                    );\r\n                                }}\r\n                            </Droppable>\r\n                            {inviteMembersButton}\r\n                            {addChannelsCtaButton}\r\n                        </div>\r\n                    );\r\n                }}\r\n            </Draggable>\r\n        );\r\n    }\r\n}\r\n\r\nconst categoryNames = defineMessages({\r\n    channels: {\r\n        id: 'sidebar.types.channels',\r\n        defaultMessage: 'CHANNELS',\r\n    },\r\n    direct_messages: {\r\n        id: 'sidebar.types.direct_messages',\r\n        defaultMessage: 'DIRECT MESSAGES',\r\n    },\r\n    favorites: {\r\n        id: 'sidebar.types.favorites',\r\n        defaultMessage: 'FAVORITES',\r\n    },\r\n});\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {ChannelCategory} from '@mattermost/types/channel_categories';\r\n\r\nimport {setCategoryCollapsed, setCategorySorting} from 'mattermost-redux/actions/channel_categories';\r\nimport {savePreferences} from 'mattermost-redux/actions/preferences';\r\nimport {getCurrentUser, getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\r\nimport {isAdmin} from 'mattermost-redux/utils/user_utils';\r\n\r\nimport {getDraggingState, makeGetFilteredChannelIdsForCategory} from 'selectors/views/channel_sidebar';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport SidebarCategory from './sidebar_category';\r\n\r\ntype OwnProps = {\r\n    category: ChannelCategory;\r\n}\r\n\r\nfunction makeMapStateToProps() {\r\n    const getChannelIdsForCategory = makeGetFilteredChannelIdsForCategory();\r\n\r\n    return (state: GlobalState, ownProps: OwnProps) => {\r\n        return {\r\n            channelIds: getChannelIdsForCategory(state, ownProps.category),\r\n            draggingState: getDraggingState(state),\r\n            currentUserId: getCurrentUserId(state),\r\n            isAdmin: isAdmin(getCurrentUser(state).roles),\r\n        };\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            setCategoryCollapsed,\r\n            setCategorySorting,\r\n            savePreferences,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(makeMapStateToProps, mapDispatchToProps)(SidebarCategory);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport debounce from 'lodash/debounce';\r\nimport React, {lazy} from 'react';\r\nimport {DragDropContext, Droppable} from 'react-beautiful-dnd';\r\nimport type {DropResult, DragStart, BeforeCapture} from 'react-beautiful-dnd';\r\nimport {FormattedMessage, injectIntl, type WrappedComponentProps} from 'react-intl';\r\nimport {SpringSystem} from 'rebound';\r\nimport type {Spring} from 'rebound';\r\n\r\nimport type {ChannelCategory} from '@mattermost/types/channel_categories';\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport {General} from 'mattermost-redux/constants';\r\n\r\nimport {makeAsyncComponent} from 'components/async_load';\r\nimport Scrollbars from 'components/common/scrollbars';\r\nimport SidebarCategory from 'components/sidebar/sidebar_category';\r\n\r\nimport {findNextUnreadChannelId} from 'utils/channel_utils';\r\nimport {Constants, DraggingStates, DraggingStateTypes} from 'utils/constants';\r\nimport {isKeyPressed, cmdOrCtrlPressed} from 'utils/keyboard';\r\nimport {mod} from 'utils/utils';\r\n\r\nimport type {DraggingState} from 'types/store';\r\nimport type {StaticPage} from 'types/store/lhs';\r\n\r\nconst DraftsLink = makeAsyncComponent('DraftsLink', lazy(() => import('components/drafts/drafts_link/drafts_link')));\r\nconst GlobalThreadsLink = makeAsyncComponent('GlobalThreadsLink', lazy(() => import('components/threading/global_threads_link')));\r\nconst UnreadChannelIndicator = makeAsyncComponent('UnreadChannelIndicator', lazy(() => import('../unread_channel_indicator')));\r\nconst UnreadChannels = makeAsyncComponent('UnreadChannels', lazy(() => import('../unread_channels')));\r\n\r\ntype Props = WrappedComponentProps & {\r\n    currentTeam?: Team;\r\n    currentChannelId: string;\r\n    categories: ChannelCategory[];\r\n    unreadChannelIds: string[];\r\n    isUnreadFilterEnabled: boolean;\r\n    displayedChannels: Channel[];\r\n    newCategoryIds: string[];\r\n    draggingState: DraggingState;\r\n    multiSelectedChannelIds: string[];\r\n    showUnreadsCategory: boolean;\r\n    collapsedThreads: boolean;\r\n    hasUnreadThreads: boolean;\r\n    currentStaticPageId: string;\r\n    staticPages: StaticPage[];\r\n\r\n    handleOpenMoreDirectChannelsModal: (e: Event) => void;\r\n    onDragStart: (initial: DragStart) => void;\r\n    onDragEnd: (result: DropResult) => void;\r\n\r\n    actions: {\r\n        moveChannelsInSidebar: (categoryId: string, targetIndex: number, draggableChannelId: string) => void;\r\n        moveCategory: (teamId: string, categoryId: string, newIndex: number) => void;\r\n        switchToChannelById: (channelId: string) => void;\r\n        switchToLhsStaticPage: (pageId: string) => void;\r\n        close: () => void;\r\n        setDraggingState: (data: DraggingState) => void;\r\n        stopDragging: () => void;\r\n        clearChannelSelection: () => void;\r\n    };\r\n};\r\n\r\ntype State = {\r\n    showTopUnread: boolean;\r\n    showBottomUnread: boolean;\r\n};\r\n\r\n// scrollMargin is the margin at the edge of the channel list that we leave when scrolling to a channel.\r\nconst scrollMargin = 10;\r\n\r\n// categoryHeaderHeight is the height of the category header\r\nconst categoryHeaderHeight = 32;\r\n\r\n// scrollMarginWithUnread is the margin that we leave at the edge of the channel list when scrolling to a channel so\r\n// that the channel is not under the unread indicator.\r\nconst scrollMarginWithUnread = 55;\r\n\r\nexport class SidebarList extends React.PureComponent<Props, State> {\r\n    channelRefs: Map<string, HTMLLIElement>;\r\n    scrollbar: React.RefObject<HTMLDivElement>;\r\n    animate: SpringSystem;\r\n    scrollAnimation: Spring;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.channelRefs = new Map();\r\n        this.state = {\r\n            showTopUnread: false,\r\n            showBottomUnread: false,\r\n        };\r\n        this.scrollbar = React.createRef();\r\n\r\n        this.animate = new SpringSystem();\r\n        this.scrollAnimation = this.animate.createSpring();\r\n        this.scrollAnimation.setOvershootClampingEnabled(true); // disables the spring action at the end of animation\r\n        this.scrollAnimation.addListener({onSpringUpdate: this.handleScrollAnimationUpdate});\r\n    }\r\n\r\n    componentDidMount() {\r\n        document.addEventListener('keydown', this.navigateChannelShortcut);\r\n        document.addEventListener('keydown', this.navigateUnreadChannelShortcut);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        document.removeEventListener('keydown', this.navigateChannelShortcut);\r\n        document.removeEventListener('keydown', this.navigateUnreadChannelShortcut);\r\n    }\r\n\r\n    componentDidUpdate(prevProps: Props) {\r\n        if (!this.props.currentChannelId || !prevProps.currentChannelId) {\r\n            return;\r\n        }\r\n\r\n        // reset the scrollbar upon switching teams\r\n        if (this.props.currentTeam !== prevProps.currentTeam) {\r\n            this.scrollbar.current!.scrollTo({top: 0});\r\n        }\r\n\r\n        // Scroll to selected channel so it's in view\r\n        if (this.props.currentChannelId !== prevProps.currentChannelId) {\r\n            // This will be re-enabled when we can avoid animating the scroll on first load and team switch\r\n            // this.scrollToChannel(this.props.currentChannelId);\r\n        }\r\n\r\n        // TODO: Copying over so it doesn't get lost, but we don't have a design for the sidebar on mobile yet\r\n        // close the LHS on mobile when you change channels\r\n        if (this.props.currentChannelId !== prevProps.currentChannelId) {\r\n            this.props.actions.close();\r\n        }\r\n\r\n        this.updateUnreadIndicators();\r\n    }\r\n\r\n    getDisplayedChannelIds = () => {\r\n        return this.props.displayedChannels.map((channel) => channel.id);\r\n    };\r\n\r\n    getDisplayedStaticPageIds = () => {\r\n        return this.props.staticPages.map((item) => item.id);\r\n    };\r\n\r\n    setChannelRef = (channelId: string, ref: HTMLLIElement) => {\r\n        if (ref) {\r\n            this.channelRefs.set(channelId, ref);\r\n        } else {\r\n            this.channelRefs.delete(channelId);\r\n        }\r\n    };\r\n\r\n    getFirstUnreadChannelFromChannelIdArray = (channelIds: string[]) => {\r\n        return channelIds.find((channelId) => {\r\n            return channelId !== this.props.currentChannelId && this.props.unreadChannelIds.includes(channelId);\r\n        });\r\n    };\r\n\r\n    handleScrollAnimationUpdate = (spring: Spring) => {\r\n        const val = spring.getCurrentValue();\r\n        this.scrollbar.current!.scrollTo?.({top: val});\r\n    };\r\n\r\n    scrollToFirstUnreadChannel = () => {\r\n        this.scrollToChannel(this.getFirstUnreadChannel(), true);\r\n    };\r\n\r\n    scrollToLastUnreadChannel = () => {\r\n        this.scrollToChannel(this.getLastUnreadChannel(), true);\r\n    };\r\n\r\n    scrollToChannel = (channelId: string | null | undefined, scrollingToUnread = false) => {\r\n        if (!channelId) {\r\n            return;\r\n        }\r\n\r\n        const element = this.channelRefs.get(channelId);\r\n        if (!element) {\r\n            return;\r\n        }\r\n\r\n        const top = element.offsetTop;\r\n        const bottom = top + element.offsetHeight;\r\n\r\n        const scrollTop = this.scrollbar.current!.scrollTop;\r\n        const clientHeight = this.scrollbar.current!.clientHeight;\r\n\r\n        if (top < (scrollTop + categoryHeaderHeight)) {\r\n            // Scroll up to the item\r\n            const margin = (scrollingToUnread || !this.state.showTopUnread) ? scrollMargin : scrollMarginWithUnread;\r\n\r\n            let scrollEnd;\r\n            const displayedChannels = this.getDisplayedChannelIds();\r\n            if (displayedChannels.length > 0 && displayedChannels[0] === channelId) {\r\n                // This is the first channel, so scroll right to the top\r\n                scrollEnd = 0;\r\n            } else {\r\n                scrollEnd = top - margin - categoryHeaderHeight;\r\n            }\r\n\r\n            this.scrollToPosition(scrollEnd);\r\n        } else if (bottom > scrollTop + clientHeight) {\r\n            // Scroll down to the item\r\n            const margin = (scrollingToUnread || !this.state.showBottomUnread) ? scrollMargin : scrollMarginWithUnread;\r\n            const scrollEnd = (bottom - clientHeight) + margin;\r\n\r\n            this.scrollToPosition(scrollEnd);\r\n        }\r\n    };\r\n\r\n    scrollToPosition = (scrollEnd: number) => {\r\n        // Stop the current animation before scrolling\r\n        this.scrollAnimation.setCurrentValue(this.scrollbar.current!.scrollTop).setAtRest();\r\n\r\n        this.scrollAnimation.setEndValue(scrollEnd);\r\n    };\r\n\r\n    updateUnreadIndicators = () => {\r\n        if (this.props.draggingState.state) {\r\n            this.setState({\r\n                showTopUnread: false,\r\n                showBottomUnread: false,\r\n            });\r\n            return;\r\n        }\r\n\r\n        let showTopUnread = false;\r\n        let showBottomUnread = false;\r\n\r\n        // Consider partially obscured channels as above/below\r\n        const firstUnreadChannel = this.getFirstUnreadChannel();\r\n        const lastUnreadChannel = this.getLastUnreadChannel();\r\n\r\n        if (firstUnreadChannel) {\r\n            const firstUnreadElement = this.channelRefs.get(firstUnreadChannel);\r\n\r\n            if (firstUnreadElement && ((firstUnreadElement.offsetTop + firstUnreadElement.offsetHeight) - scrollMargin - categoryHeaderHeight) < this.scrollbar.current!.scrollTop) {\r\n                showTopUnread = true;\r\n            }\r\n        }\r\n\r\n        if (lastUnreadChannel) {\r\n            const lastUnreadElement = this.channelRefs.get(lastUnreadChannel);\r\n\r\n            if (lastUnreadElement && (lastUnreadElement.offsetTop + scrollMargin) > (this.scrollbar.current!.scrollTop + this.scrollbar.current!.clientHeight)) {\r\n                showBottomUnread = true;\r\n            }\r\n        }\r\n\r\n        if (showTopUnread !== this.state.showTopUnread || showBottomUnread !== this.state.showBottomUnread) {\r\n            this.setState({\r\n                showTopUnread,\r\n                showBottomUnread,\r\n            });\r\n        }\r\n    };\r\n\r\n    getFirstUnreadChannel = () => {\r\n        return this.getFirstUnreadChannelFromChannelIdArray(this.getDisplayedChannelIds());\r\n    };\r\n\r\n    getLastUnreadChannel = () => {\r\n        return this.getFirstUnreadChannelFromChannelIdArray(this.getDisplayedChannelIds().reverse());\r\n    };\r\n\r\n    navigateById = (id: string) => {\r\n        if (this.props.staticPages.findIndex((i) => i.id === id) === -1) {\r\n            this.props.actions.switchToChannelById(id);\r\n        } else {\r\n            this.props.actions.switchToLhsStaticPage(id);\r\n        }\r\n    };\r\n\r\n    navigateChannelShortcut = (e: KeyboardEvent) => {\r\n        if (e.altKey && !e.shiftKey && !e.ctrlKey && !e.metaKey && (isKeyPressed(e, Constants.KeyCodes.UP) || isKeyPressed(e, Constants.KeyCodes.DOWN))) {\r\n            e.preventDefault();\r\n\r\n            const staticPageIds = this.getDisplayedStaticPageIds();\r\n            const allIds = [...staticPageIds, ...this.getDisplayedChannelIds()];\r\n\r\n            const curSelectedId = this.props.currentChannelId || this.props.currentStaticPageId;\r\n            const curIndex = allIds.indexOf(curSelectedId);\r\n\r\n            let nextIndex;\r\n            if (isKeyPressed(e, Constants.KeyCodes.DOWN)) {\r\n                nextIndex = curIndex + 1;\r\n            } else {\r\n                nextIndex = curIndex - 1;\r\n            }\r\n\r\n            const nextId = allIds[mod(nextIndex, allIds.length)];\r\n            this.navigateById(nextId);\r\n            if (nextIndex >= staticPageIds.length) {\r\n                this.scrollToChannel(nextId);\r\n            }\r\n        } else if (cmdOrCtrlPressed(e) && e.shiftKey && isKeyPressed(e, Constants.KeyCodes.K)) {\r\n            this.props.handleOpenMoreDirectChannelsModal(e);\r\n        }\r\n    };\r\n\r\n    navigateUnreadChannelShortcut = (e: KeyboardEvent) => {\r\n        if (e.altKey && e.shiftKey && !e.ctrlKey && !e.metaKey && (isKeyPressed(e, Constants.KeyCodes.UP) || isKeyPressed(e, Constants.KeyCodes.DOWN))) {\r\n            e.preventDefault();\r\n\r\n            const allChannelIds = this.getDisplayedChannelIds();\r\n            const unreadChannelIds = [...this.props.unreadChannelIds];\r\n\r\n            if (this.props.collapsedThreads) {\r\n                allChannelIds.unshift('');\r\n\r\n                if (this.props.hasUnreadThreads) {\r\n                    unreadChannelIds.unshift('');\r\n                }\r\n            }\r\n\r\n            let direction = 0;\r\n            if (isKeyPressed(e, Constants.KeyCodes.UP)) {\r\n                direction = -1;\r\n            } else {\r\n                direction = 1;\r\n            }\r\n\r\n            const nextIndex = findNextUnreadChannelId(\r\n                this.props.currentChannelId,\r\n                allChannelIds,\r\n                unreadChannelIds,\r\n                direction,\r\n            );\r\n\r\n            if (nextIndex !== -1) {\r\n                const nextChannelId = allChannelIds[nextIndex];\r\n                this.navigateById(nextChannelId);\r\n                this.scrollToChannel(nextChannelId);\r\n            }\r\n        }\r\n    };\r\n\r\n    renderCategory = (category: ChannelCategory, index: number) => {\r\n        return (\r\n            <SidebarCategory\r\n                key={category.id}\r\n                category={category}\r\n                categoryIndex={index}\r\n                setChannelRef={this.setChannelRef}\r\n                handleOpenMoreDirectChannelsModal={this.props.handleOpenMoreDirectChannelsModal}\r\n                isNewCategory={this.props.newCategoryIds.includes(category.id)}\r\n            />\r\n        );\r\n    };\r\n\r\n    onScroll = debounce(() => {\r\n        this.updateUnreadIndicators();\r\n    }, 100);\r\n\r\n    onTransitionEnd = debounce(() => {\r\n        this.updateUnreadIndicators();\r\n    }, 100);\r\n\r\n    onBeforeCapture = (before: BeforeCapture) => {\r\n        // // Ensure no channels are animating\r\n        this.channelRefs.forEach((ref) => ref.classList.remove('animating'));\r\n\r\n        // Turn off scrolling temporarily so that dimensions can be captured\r\n        const droppable = [...document.querySelectorAll<HTMLDivElement>('[data-rbd-droppable-id*=\"droppable-categories\"]')];\r\n        droppable[0].style.height = `${droppable[0].scrollHeight}px`;\r\n\r\n        if (!this.props.multiSelectedChannelIds.find((id) => before.draggableId === id)) {\r\n            this.props.actions.clearChannelSelection();\r\n        }\r\n\r\n        const draggingState: DraggingState = {\r\n            state: DraggingStates.CAPTURE,\r\n            id: before.draggableId,\r\n        };\r\n\r\n        if (this.props.categories.some((category) => category.id === before.draggableId)) {\r\n            draggingState.type = DraggingStateTypes.CATEGORY;\r\n        } else {\r\n            const draggingChannels = this.props.displayedChannels.filter((channel) => this.props.multiSelectedChannelIds.indexOf(channel.id) !== -1 || channel.id === before.draggableId);\r\n            if (draggingChannels.every((channel) => channel.type === General.DM_CHANNEL || channel.type === General.GM_CHANNEL)) {\r\n                draggingState.type = DraggingStateTypes.DM;\r\n            } else if (draggingChannels.every((channel) => channel.type !== General.DM_CHANNEL && channel.type !== General.GM_CHANNEL)) {\r\n                draggingState.type = DraggingStateTypes.CHANNEL;\r\n            } else {\r\n                draggingState.type = DraggingStateTypes.MIXED_CHANNELS;\r\n            }\r\n        }\r\n\r\n        this.props.actions.setDraggingState(draggingState);\r\n    };\r\n\r\n    onBeforeDragStart = () => {\r\n        this.props.actions.setDraggingState({state: DraggingStates.BEFORE});\r\n    };\r\n\r\n    onDragStart = (initial: DragStart) => {\r\n        this.props.onDragStart(initial);\r\n\r\n        this.props.actions.setDraggingState({state: DraggingStates.DURING});\r\n\r\n        // Re-enable scroll box resizing\r\n        const droppable = [...document.querySelectorAll<HTMLDivElement>('[data-rbd-droppable-id*=\"droppable-categories\"]')];\r\n        droppable[0].style.height = '';\r\n    };\r\n\r\n    onDragEnd = (result: DropResult) => {\r\n        this.props.onDragEnd(result);\r\n\r\n        if (result.reason === 'DROP' && result.destination) {\r\n            if (result.type === 'SIDEBAR_CHANNEL') {\r\n                this.props.actions.moveChannelsInSidebar(result.destination.droppableId, result.destination.index, result.draggableId);\r\n            } else if (result.type === 'SIDEBAR_CATEGORY') {\r\n                this.props.actions.moveCategory(this.props.currentTeam!.id, result.draggableId, result.destination.index);\r\n            }\r\n        }\r\n\r\n        this.props.actions.stopDragging();\r\n    };\r\n\r\n    render() {\r\n        const {categories} = this.props;\r\n\r\n        let channelList: React.ReactNode;\r\n        if (this.props.isUnreadFilterEnabled) {\r\n            channelList = (\r\n                <UnreadChannels\r\n                    setChannelRef={this.setChannelRef}\r\n                />\r\n            );\r\n        } else {\r\n            let unreadsCategory;\r\n            if (this.props.showUnreadsCategory) {\r\n                unreadsCategory = (\r\n                    <UnreadChannels\r\n                        setChannelRef={this.setChannelRef}\r\n                    />\r\n                );\r\n            }\r\n\r\n            const renderedCategories = categories.map(this.renderCategory);\r\n\r\n            channelList = (\r\n                <>\r\n                    {unreadsCategory}\r\n                    <DragDropContext\r\n                        onDragEnd={this.onDragEnd}\r\n                        onBeforeDragStart={this.onBeforeDragStart}\r\n                        onBeforeCapture={this.onBeforeCapture}\r\n                        onDragStart={this.onDragStart}\r\n                    >\r\n                        <Droppable\r\n                            droppableId='droppable-categories'\r\n                            type='SIDEBAR_CATEGORY'\r\n                        >\r\n                            {(provided) => {\r\n                                return (\r\n                                    <div\r\n                                        id={'sidebar-droppable-categories'}\r\n                                        ref={provided.innerRef}\r\n                                        {...provided.droppableProps}\r\n                                    >\r\n                                        {renderedCategories}\r\n                                        {provided.placeholder}\r\n                                    </div>\r\n                                );\r\n                            }}\r\n                        </Droppable>\r\n                    </DragDropContext>\r\n                </>\r\n            );\r\n        }\r\n\r\n        const above = (\r\n            <FormattedMessage\r\n                id='sidebar.unreads'\r\n                defaultMessage='More unreads'\r\n            />\r\n        );\r\n\r\n        const below = (\r\n            <FormattedMessage\r\n                id='sidebar.unreads'\r\n                defaultMessage='More unreads'\r\n            />\r\n        );\r\n\r\n        const ariaLabel = this.props.intl.formatMessage({id: 'accessibility.sections.lhsList', defaultMessage: 'channel sidebar region'});\r\n\r\n        return (\r\n\r\n            // NOTE: id attribute added to temporarily support the desktop app's at-mention DOM scraping of the old sidebar\r\n            <>\r\n                <GlobalThreadsLink/>\r\n                <DraftsLink/>\r\n                <div\r\n                    id='sidebar-left'\r\n                    role='application'\r\n                    aria-label={ariaLabel}\r\n                    className={classNames('SidebarNavContainer a11y__region', {\r\n                        disabled: this.props.isUnreadFilterEnabled,\r\n                    })}\r\n                    data-a11y-disable-nav={Boolean(this.props.draggingState.type)}\r\n                    data-a11y-sort-order='7'\r\n                    onTransitionEnd={this.onTransitionEnd}\r\n                >\r\n                    <UnreadChannelIndicator\r\n                        name='Top'\r\n                        show={this.state.showTopUnread}\r\n                        onClick={this.scrollToFirstUnreadChannel}\r\n                        extraClass='nav-pills__unread-indicator-top'\r\n                        content={above}\r\n                    />\r\n                    <UnreadChannelIndicator\r\n                        name='Bottom'\r\n                        show={this.state.showBottomUnread}\r\n                        onClick={this.scrollToLastUnreadChannel}\r\n                        extraClass='nav-pills__unread-indicator-bottom'\r\n                        content={below}\r\n                    />\r\n                    <Scrollbars\r\n                        ref={this.scrollbar}\r\n                        onScroll={this.onScroll}\r\n                    >\r\n                        {channelList}\r\n                    </Scrollbars>\r\n                </div>\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nexport default injectIntl(SidebarList);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {moveCategory} from 'mattermost-redux/actions/channel_categories';\r\nimport {getCurrentChannelId, getUnreadChannelIds} from 'mattermost-redux/selectors/entities/channels';\r\nimport {shouldShowUnreadsCategory, isCollapsedThreadsEnabled} from 'mattermost-redux/selectors/entities/preferences';\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getThreadCountsInCurrentTeam} from 'mattermost-redux/selectors/entities/threads';\r\n\r\nimport {switchToChannelById} from 'actions/views/channel';\r\nimport {\r\n    moveChannelsInSidebar,\r\n    setDraggingState,\r\n    stopDragging,\r\n    clearChannelSelection,\r\n} from 'actions/views/channel_sidebar';\r\nimport {close, switchToLhsStaticPage} from 'actions/views/lhs';\r\nimport {getCurrentStaticPageId, getVisibleStaticPages} from 'selectors/lhs';\r\nimport {\r\n    getDisplayedChannels,\r\n    getDraggingState,\r\n    getCategoriesForCurrentTeam,\r\n    isUnreadFilterEnabled,\r\n} from 'selectors/views/channel_sidebar';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport SidebarList from './sidebar_list';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const currentTeam = getCurrentTeam(state);\r\n    const collapsedThreads = isCollapsedThreadsEnabled(state);\r\n\r\n    let hasUnreadThreads = false;\r\n    if (collapsedThreads) {\r\n        hasUnreadThreads = Boolean(getThreadCountsInCurrentTeam(state)?.total_unread_threads);\r\n    }\r\n\r\n    return {\r\n        currentTeam,\r\n        currentChannelId: getCurrentChannelId(state),\r\n        categories: getCategoriesForCurrentTeam(state),\r\n        isUnreadFilterEnabled: isUnreadFilterEnabled(state),\r\n        unreadChannelIds: getUnreadChannelIds(state),\r\n        displayedChannels: getDisplayedChannels(state),\r\n        draggingState: getDraggingState(state),\r\n        newCategoryIds: state.views.channelSidebar.newCategoryIds,\r\n        multiSelectedChannelIds: state.views.channelSidebar.multiSelectedChannelIds,\r\n        showUnreadsCategory: shouldShowUnreadsCategory(state),\r\n        collapsedThreads,\r\n        hasUnreadThreads,\r\n        currentStaticPageId: getCurrentStaticPageId(state),\r\n        staticPages: getVisibleStaticPages(state),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            close,\r\n            switchToChannelById,\r\n            moveChannelsInSidebar,\r\n            moveCategory,\r\n            setDraggingState,\r\n            stopDragging,\r\n            clearChannelSelection,\r\n            switchToLhsStaticPage,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(SidebarList);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React, {lazy} from 'react';\r\n\r\nimport {makeAsyncComponent} from 'components/async_load';\r\nimport DataPrefetch from 'components/data_prefetch';\r\nimport ResizableLhs from 'components/resizable_sidebar/resizable_lhs';\r\nimport SidebarHeader from 'components/sidebar/sidebar_header';\r\n\r\nimport Pluggable from 'plugins/pluggable';\r\nimport Constants, {ModalIdentifiers, RHSStates} from 'utils/constants';\r\nimport {isKeyPressed, cmdOrCtrlPressed} from 'utils/keyboard';\r\nimport {localizeMessage} from 'utils/utils';\r\n\r\nimport type {ModalData} from 'types/actions';\r\nimport type {RhsState} from 'types/store/rhs';\r\n\r\nimport ChannelNavigator from './channel_navigator';\r\nimport SidebarList from './sidebar_list';\r\n\r\nconst MobileSidebarHeader = makeAsyncComponent('MobileSidebarHeader', lazy(() => import('./mobile_sidebar_header')));\r\nconst MoreDirectChannels = makeAsyncComponent('MoreDirectChannels', lazy(() => import('components/more_direct_channels')));\r\nconst BrowseChannels = makeAsyncComponent('BrowseChannels', lazy(() => import('components/browse_channels')));\r\nconst EditCategoryModal = makeAsyncComponent('EditCategoryModal', lazy(() => import('components/edit_category_modal')));\r\nconst CreateUserGroupsModal = makeAsyncComponent('CreateUserGroupsModal', lazy(() => import('components/create_user_groups_modal')));\r\nconst InvitationModal = makeAsyncComponent('InvitationModal', lazy(() => import('components/invitation_modal')));\r\nconst KeyboardShortcutsModal = makeAsyncComponent('KeyboardShortcutsModal', lazy(() => import('components/keyboard_shortcuts/keyboard_shortcuts_modal/keyboard_shortcuts_modal')));\r\nconst NewChannelModal = makeAsyncComponent('NewChannelModal', lazy(() => import('components/new_channel_modal/new_channel_modal')));\r\nconst UserSettingsModal = makeAsyncComponent('UserSettingsModal', lazy(() => import('components/user_settings/modal')));\r\n\r\ntype Props = {\r\n    teamId: string;\r\n    canCreatePublicChannel: boolean;\r\n    canCreatePrivateChannel: boolean;\r\n    canJoinPublicChannel: boolean;\r\n    isOpen: boolean;\r\n    actions: {\r\n        fetchMyCategories: (teamId: string) => void;\r\n        openModal: <P>(modalData: ModalData<P>) => void;\r\n        closeModal: (modalId: string) => void;\r\n        clearChannelSelection: () => void;\r\n        closeRightHandSide: () => void;\r\n    };\r\n    unreadFilterEnabled: boolean;\r\n    isMobileView: boolean;\r\n    isKeyBoardShortcutModalOpen: boolean;\r\n    canCreateCustomGroups: boolean;\r\n    rhsState?: RhsState;\r\n    rhsOpen?: boolean;\r\n};\r\n\r\ntype State = {\r\n    showDirectChannelsModal: boolean;\r\n    isDragging: boolean;\r\n};\r\n\r\nexport default class Sidebar extends React.PureComponent<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n        this.state = {\r\n            showDirectChannelsModal: false,\r\n            isDragging: false,\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (this.props.teamId) {\r\n            this.props.actions.fetchMyCategories(this.props.teamId);\r\n        }\r\n\r\n        window.addEventListener('click', this.handleClickClearChannelSelection);\r\n        window.addEventListener('keydown', this.handleKeyDownEvent);\r\n    }\r\n\r\n    componentDidUpdate(prevProps: Props) {\r\n        if (this.props.teamId && prevProps.teamId !== this.props.teamId) {\r\n            this.props.actions.fetchMyCategories(this.props.teamId);\r\n        }\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        window.removeEventListener('click', this.handleClickClearChannelSelection);\r\n        window.removeEventListener('keydown', this.handleKeyDownEvent);\r\n    }\r\n\r\n    handleClickClearChannelSelection = (event: MouseEvent) => {\r\n        if (event.defaultPrevented) {\r\n            return;\r\n        }\r\n\r\n        this.props.actions.clearChannelSelection();\r\n    };\r\n\r\n    handleKeyDownEvent = (event: KeyboardEvent) => {\r\n        if (isKeyPressed(event, Constants.KeyCodes.ESCAPE)) {\r\n            this.props.actions.clearChannelSelection();\r\n            return;\r\n        }\r\n\r\n        const ctrlOrMetaKeyPressed = cmdOrCtrlPressed(event, true);\r\n\r\n        if (ctrlOrMetaKeyPressed) {\r\n            if (isKeyPressed(event, Constants.KeyCodes.FORWARD_SLASH)) {\r\n                event.preventDefault();\r\n                if (this.props.isKeyBoardShortcutModalOpen) {\r\n                    this.props.actions.closeModal(ModalIdentifiers.KEYBOARD_SHORTCUTS_MODAL);\r\n                } else {\r\n                    this.props.actions.openModal({\r\n                        modalId: ModalIdentifiers.KEYBOARD_SHORTCUTS_MODAL,\r\n                        dialogType: KeyboardShortcutsModal,\r\n                    });\r\n                }\r\n            } else if (isKeyPressed(event, Constants.KeyCodes.A) && event.shiftKey) {\r\n                event.preventDefault();\r\n\r\n                this.props.actions.openModal({\r\n                    modalId: ModalIdentifiers.USER_SETTINGS,\r\n                    dialogType: UserSettingsModal,\r\n                    dialogProps: {\r\n                        isContentProductSettings: true,\r\n                        focusOriginElement: 'sidebar.tsx',\r\n                    },\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    showMoreDirectChannelsModal = () => {\r\n        this.setState({showDirectChannelsModal: true});\r\n    };\r\n\r\n    hideMoreDirectChannelsModal = () => {\r\n        this.setState({showDirectChannelsModal: false});\r\n    };\r\n\r\n    showCreateCategoryModal = () => {\r\n        this.props.actions.openModal({\r\n            modalId: ModalIdentifiers.EDIT_CATEGORY,\r\n            dialogType: EditCategoryModal,\r\n            dialogProps: {},\r\n        });\r\n    };\r\n\r\n    showMoreChannelsModal = () => {\r\n        this.props.actions.openModal({\r\n            modalId: ModalIdentifiers.MORE_CHANNELS,\r\n            dialogType: BrowseChannels,\r\n        });\r\n    };\r\n\r\n    invitePeopleModal = () => {\r\n        this.props.actions.openModal({\r\n            modalId: ModalIdentifiers.INVITATION,\r\n            dialogType: InvitationModal,\r\n            dialogProps: {focusOriginElement: 'browseOrAddChannelMenuButton'},\r\n        });\r\n    };\r\n\r\n    showNewChannelModal = () => {\r\n        this.props.actions.openModal({\r\n            modalId: ModalIdentifiers.NEW_CHANNEL_MODAL,\r\n            dialogType: NewChannelModal,\r\n        });\r\n        this.closeEditRHS();\r\n    };\r\n\r\n    showCreateUserGroupModal = () => {\r\n        this.props.actions.openModal({\r\n            modalId: ModalIdentifiers.USER_GROUPS_CREATE,\r\n            dialogType: CreateUserGroupsModal,\r\n        });\r\n    };\r\n\r\n    handleOpenMoreDirectChannelsModal = (e?: Event) => {\r\n        e?.preventDefault();\r\n        if (this.state.showDirectChannelsModal) {\r\n            this.hideMoreDirectChannelsModal();\r\n        } else {\r\n            this.showMoreDirectChannelsModal();\r\n            this.closeEditRHS();\r\n        }\r\n    };\r\n\r\n    onDragStart = () => {\r\n        this.setState({isDragging: true});\r\n    };\r\n\r\n    onDragEnd = () => {\r\n        this.setState({isDragging: false});\r\n    };\r\n\r\n    renderModals = () => {\r\n        let moreDirectChannelsModal;\r\n        if (this.state.showDirectChannelsModal) {\r\n            moreDirectChannelsModal = (\r\n                <MoreDirectChannels\r\n                    onModalDismissed={this.hideMoreDirectChannelsModal}\r\n                    isExistingChannel={false}\r\n                    focusOriginElement='newDirectMessageButton'\r\n                />\r\n            );\r\n        }\r\n\r\n        return (\r\n            <>\r\n                {moreDirectChannelsModal}\r\n            </>\r\n        );\r\n    };\r\n\r\n    closeEditRHS = () => {\r\n        if (this.props.rhsOpen && this.props.rhsState === RHSStates.EDIT_HISTORY) {\r\n            this.props.actions.closeRightHandSide();\r\n        }\r\n    };\r\n\r\n    render() {\r\n        if (!this.props.teamId) {\r\n            return (<div/>);\r\n        }\r\n\r\n        const ariaLabel = localizeMessage({id: 'accessibility.sections.lhsNavigator', defaultMessage: 'channel navigator region'});\r\n\r\n        return (\r\n            <ResizableLhs\r\n                id='SidebarContainer'\r\n                className={classNames({\r\n                    'move--right': this.props.isOpen && this.props.isMobileView,\r\n                    dragging: this.state.isDragging,\r\n                })}\r\n            >\r\n                {this.props.isMobileView ? <MobileSidebarHeader/> : (\r\n                    <SidebarHeader\r\n                        showNewChannelModal={this.showNewChannelModal}\r\n                        showMoreChannelsModal={this.showMoreChannelsModal}\r\n                        showCreateUserGroupModal={this.showCreateUserGroupModal}\r\n                        invitePeopleModal={this.invitePeopleModal}\r\n                        showCreateCategoryModal={this.showCreateCategoryModal}\r\n                        canCreateChannel={this.props.canCreatePrivateChannel || this.props.canCreatePublicChannel}\r\n                        canJoinPublicChannel={this.props.canJoinPublicChannel}\r\n                        handleOpenDirectMessagesModal={this.handleOpenMoreDirectChannelsModal}\r\n                        unreadFilterEnabled={this.props.unreadFilterEnabled}\r\n                        canCreateCustomGroups={this.props.canCreateCustomGroups}\r\n                    />\r\n                )}\r\n                <div\r\n                    id='lhsNavigator'\r\n                    role='application'\r\n                    aria-label={ariaLabel}\r\n                    className='a11y__region'\r\n                    data-a11y-sort-order='6'\r\n                >\r\n                    <ChannelNavigator/>\r\n                </div>\r\n                <div className='sidebar--left__icons'>\r\n                    <Pluggable pluggableName='LeftSidebarHeader'/>\r\n                </div>\r\n                <SidebarList\r\n                    handleOpenMoreDirectChannelsModal={this.handleOpenMoreDirectChannelsModal}\r\n                    onDragStart={this.onDragStart}\r\n                    onDragEnd={this.onDragEnd}\r\n                />\r\n                <DataPrefetch/>\r\n                {this.renderModals()}\r\n            </ResizableLhs>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {fetchMyCategories} from 'mattermost-redux/actions/channel_categories';\r\nimport Permissions from 'mattermost-redux/constants/permissions';\r\nimport {isCustomGroupsEnabled} from 'mattermost-redux/selectors/entities/preferences';\r\nimport {haveICurrentChannelPermission, haveISystemPermission} from 'mattermost-redux/selectors/entities/roles';\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport {clearChannelSelection} from 'actions/views/channel_sidebar';\r\nimport {closeModal, openModal} from 'actions/views/modals';\r\nimport {closeRightHandSide} from 'actions/views/rhs';\r\nimport {getIsLhsOpen} from 'selectors/lhs';\r\nimport {getIsRhsOpen, getRhsState} from 'selectors/rhs';\r\nimport {getIsMobileView} from 'selectors/views/browser';\r\nimport {isUnreadFilterEnabled} from 'selectors/views/channel_sidebar';\r\nimport {isModalOpen} from 'selectors/views/modals';\r\n\r\nimport {ModalIdentifiers} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport Sidebar from './sidebar';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const currentTeam = getCurrentTeam(state);\r\n    const unreadFilterEnabled = isUnreadFilterEnabled(state);\r\n\r\n    let canCreatePublicChannel = false;\r\n    let canCreatePrivateChannel = false;\r\n    let canJoinPublicChannel = false;\r\n\r\n    if (currentTeam) {\r\n        canCreatePublicChannel = haveICurrentChannelPermission(state, Permissions.CREATE_PUBLIC_CHANNEL);\r\n        canCreatePrivateChannel = haveICurrentChannelPermission(state, Permissions.CREATE_PRIVATE_CHANNEL);\r\n        canJoinPublicChannel = haveICurrentChannelPermission(state, Permissions.JOIN_PUBLIC_CHANNELS);\r\n    }\r\n\r\n    const canCreateCustomGroups = isCustomGroupsEnabled(state) && haveISystemPermission(state, {permission: Permissions.CREATE_CUSTOM_GROUP});\r\n\r\n    return {\r\n        teamId: currentTeam ? currentTeam.id : '',\r\n        canCreatePrivateChannel,\r\n        canCreatePublicChannel,\r\n        canJoinPublicChannel,\r\n        isOpen: getIsLhsOpen(state),\r\n        unreadFilterEnabled,\r\n        isMobileView: getIsMobileView(state),\r\n        isKeyBoardShortcutModalOpen: isModalOpen(state, ModalIdentifiers.KEYBOARD_SHORTCUTS_MODAL),\r\n        canCreateCustomGroups,\r\n        rhsState: getRhsState(state),\r\n        rhsOpen: getIsRhsOpen(state),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            clearChannelSelection,\r\n            fetchMyCategories,\r\n            openModal,\r\n            closeModal,\r\n            closeRightHandSide,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Sidebar);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {useEffect, useRef} from 'react';\r\nimport {useSelector, useDispatch} from 'react-redux';\r\n\r\nimport {resetReloadPostsInChannel} from 'mattermost-redux/actions/posts';\r\nimport {isCollapsedThreadsEnabled} from 'mattermost-redux/selectors/entities/preferences';\r\n\r\nconst PostsChannelResetWatcher = () => {\r\n    const dispatch = useDispatch();\r\n    const isCRTEnabled = useSelector(isCollapsedThreadsEnabled);\r\n    const loaded = useRef(false);\r\n    useEffect(() => {\r\n        if (loaded.current) {\r\n            dispatch(resetReloadPostsInChannel());\r\n        } else {\r\n            loaded.current = true;\r\n        }\r\n    }, [isCRTEnabled]);\r\n    return null;\r\n};\r\n\r\nexport default PostsChannelResetWatcher;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React, {lazy, useEffect} from 'react';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\n\r\nimport {cleanUpStatusAndProfileFetchingPoll} from 'mattermost-redux/actions/status_profile_polling';\r\nimport {getIsUserStatusesConfigEnabled} from 'mattermost-redux/selectors/entities/common';\r\n\r\nimport {addVisibleUsersInCurrentChannelAndSelfToStatusPoll} from 'actions/status_actions';\r\nimport {getIsMobileView} from 'selectors/views/browser';\r\n\r\nimport {makeAsyncComponent} from 'components/async_load';\r\nimport CenterChannel from 'components/channel_layout/center_channel';\r\nimport LoadingScreen from 'components/loading_screen';\r\nimport QueryParamActionController from 'components/query_param_actions/query_param_action_controller';\r\nimport Sidebar from 'components/sidebar';\r\nimport CRTPostsChannelResetWatcher from 'components/threading/channel_threads/posts_channel_reset_watcher';\r\nimport UnreadsStatusHandler from 'components/unreads_status_handler';\r\n\r\nimport Pluggable from 'plugins/pluggable';\r\nimport {Constants} from 'utils/constants';\r\nimport {isInternetExplorer, isEdge} from 'utils/user_agent';\r\n\r\nconst ProductNoticesModal = makeAsyncComponent('ProductNoticesModal', lazy(() => import('components/product_notices_modal')));\r\nconst ResetStatusModal = makeAsyncComponent('ResetStatusModal', lazy(() => import('components/reset_status_modal')));\r\nconst MobileSidebarRight = makeAsyncComponent('MobileSidebarRight', lazy(() => import('components/mobile_sidebar_right')));\r\n\r\nconst BODY_CLASS_FOR_CHANNEL = ['app__body', 'channel-view'];\r\n\r\ntype Props = {\r\n    shouldRenderCenterChannel: boolean;\r\n}\r\n\r\nexport default function ChannelController(props: Props) {\r\n    const isMobileView = useSelector(getIsMobileView);\r\n    const enabledUserStatuses = useSelector(getIsUserStatusesConfigEnabled);\r\n    const dispatch = useDispatch();\r\n\r\n    useEffect(() => {\r\n        const isMsBrowser = isInternetExplorer() || isEdge();\r\n        const {navigator} = window;\r\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\r\n        // @ts-ignore\r\n        const platform = navigator?.userAgentData?.platform || navigator?.platform || 'unknown';\r\n        document.body.classList.add(...getClassnamesForBody(platform, isMsBrowser));\r\n\r\n        return () => {\r\n            document.body.classList.remove(...BODY_CLASS_FOR_CHANNEL);\r\n\r\n            // This cleans up the status and profile setInterval of fetching poll we use to batch requests\r\n            // when fetching statuses and profiles for a list of users.\r\n            dispatch(cleanUpStatusAndProfileFetchingPoll());\r\n        };\r\n    }, []);\r\n\r\n    // Starts a regular interval to fetch statuses of users.\r\n    // see function \"addVisibleUsersInCurrentChannelAndSelfToStatusPoll\" for more details on which user's statuses are fetched.\r\n    useEffect(() => {\r\n        let loadStatusesIntervalId: NodeJS.Timeout;\r\n        if (enabledUserStatuses) {\r\n            loadStatusesIntervalId = setInterval(() => {\r\n                dispatch(addVisibleUsersInCurrentChannelAndSelfToStatusPoll());\r\n            }, Constants.STATUS_INTERVAL);\r\n        }\r\n\r\n        return () => {\r\n            clearInterval(loadStatusesIntervalId);\r\n        };\r\n    }, [enabledUserStatuses]);\r\n\r\n    return (\r\n        <>\r\n            <CRTPostsChannelResetWatcher/>\r\n            <QueryParamActionController/>\r\n            <Sidebar/>\r\n            <div\r\n                id='channel_view'\r\n                className='channel-view'\r\n                data-testid='channel_view'\r\n            >\r\n                <UnreadsStatusHandler/>\r\n                <ProductNoticesModal/>\r\n                <div className={classNames('container-fluid channel-view-inner')}>\r\n                    {props.shouldRenderCenterChannel ? <CenterChannel/> : <LoadingScreen centered={true}/>}\r\n                    <Pluggable pluggableName='Root'/>\r\n                    <ResetStatusModal/>\r\n                </div>\r\n            </div>\r\n            {isMobileView && <MobileSidebarRight/>}\r\n        </>\r\n    );\r\n}\r\n\r\nexport function getClassnamesForBody(platform: Window['navigator']['platform'], isMsBrowser = false) {\r\n    const bodyClass = [...BODY_CLASS_FOR_CHANNEL];\r\n\r\n    // OS Detection\r\n    if (platform === 'Win32' || platform === 'Win64') {\r\n        bodyClass.push('os--windows');\r\n    } else if (platform === 'MacIntel' || platform === 'MacPPC') {\r\n        bodyClass.push('os--mac');\r\n    }\r\n\r\n    // IE Detection\r\n    if (isMsBrowser) {\r\n        bodyClass.push('browser--ie');\r\n    }\r\n\r\n    return bodyClass;\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport iNoBounce from 'inobounce';\r\nimport React, {lazy, memo, useEffect, useRef, useState} from 'react';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\nimport {Route, Switch, useHistory, useParams} from 'react-router-dom';\r\n\r\nimport type {ServerError} from '@mattermost/types/errors';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport {getTeamContentFlaggingStatus} from 'mattermost-redux/actions/content_flagging';\r\nimport {\r\n    contentFlaggingFeatureEnabled,\r\n} from 'mattermost-redux/selectors/entities/content_flagging';\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport {reconnect} from 'actions/websocket_actions.jsx';\r\nimport LocalStorageStore from 'stores/local_storage_store';\r\n\r\nimport {makeAsyncComponent, makeAsyncPluggableComponent} from 'components/async_load';\r\nimport ChannelController from 'components/channel_layout/channel_controller';\r\nimport useTelemetryIdentitySync from 'components/common/hooks/useTelemetryIdentifySync';\r\nimport InitialLoadingScreen from 'components/initial_loading_screen';\r\n\r\nimport Constants from 'utils/constants';\r\nimport DesktopApp from 'utils/desktop_api';\r\nimport {cmdOrCtrlPressed, isKeyPressed} from 'utils/keyboard';\r\nimport {TEAM_NAME_PATH_PATTERN} from 'utils/path';\r\nimport {isIosSafari} from 'utils/user_agent';\r\n\r\nimport type {OwnProps, PropsFromRedux} from './index';\r\n\r\nconst BackstageController = makeAsyncComponent('BackstageController', lazy(() => import('components/backstage')));\r\nconst Pluggable = makeAsyncPluggableComponent();\r\n\r\nconst WAKEUP_CHECK_INTERVAL = 30000; // 30 seconds\r\nconst WAKEUP_THRESHOLD = 60000; // 60 seconds\r\nconst UNREAD_CHECK_TIME_MILLISECONDS = 120 * 1000;\r\n\r\ndeclare global {\r\n    interface Window {\r\n        isActive: boolean;\r\n    }\r\n}\r\n\r\ntype Props = PropsFromRedux & OwnProps;\r\n\r\nfunction TeamController(props: Props) {\r\n    const dispatch = useDispatch();\r\n    const history = useHistory();\r\n    const {team: teamNameParam} = useParams<Props['match']['params']>();\r\n\r\n    const [initialChannelsLoaded, setInitialChannelsLoaded] = useState(false);\r\n\r\n    const [team, setTeam] = useState<Team | null>(getTeamFromTeamList(props.teamsList, teamNameParam));\r\n\r\n    const contentFlaggingEnabled = useSelector(contentFlaggingFeatureEnabled);\r\n\r\n    const blurTime = useRef(Date.now());\r\n    const lastTime = useRef(Date.now());\r\n\r\n    useTelemetryIdentitySync();\r\n\r\n    useEffect(() => {\r\n        InitialLoadingScreen.stop('team_controller');\r\n        DesktopApp.reactAppInitialized();\r\n        async function fetchAllChannels() {\r\n            await props.fetchAllMyTeamsChannels();\r\n            setInitialChannelsLoaded(true);\r\n        }\r\n\r\n        props.fetchAllMyChannelMembers();\r\n        fetchAllChannels();\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (props.disableWakeUpReconnectHandler) {\r\n            return () => {};\r\n        }\r\n\r\n        const wakeUpIntervalId = setInterval(() => {\r\n            const currentTime = Date.now();\r\n            if ((currentTime - lastTime.current) > WAKEUP_THRESHOLD) {\r\n                console.log('computer woke up - reconnecting'); //eslint-disable-line no-console\r\n                reconnect();\r\n            }\r\n            lastTime.current = currentTime;\r\n        }, WAKEUP_CHECK_INTERVAL);\r\n\r\n        return () => {\r\n            clearInterval(wakeUpIntervalId);\r\n        };\r\n    }, [props.disableWakeUpReconnectHandler]);\r\n\r\n    // Effect runs on mount, add event listeners on windows object\r\n    useEffect(() => {\r\n        function handleFocus() {\r\n            window.isActive = true;\r\n            props.markAsReadOnFocus();\r\n\r\n            // Temporary flag to disable refetching of channel members on browser focus\r\n            if (!props.disableRefetchingOnBrowserFocus) {\r\n                const currentTime = Date.now();\r\n                if ((currentTime - blurTime.current) > UNREAD_CHECK_TIME_MILLISECONDS && props.currentTeamId) {\r\n                    props.fetchChannelsAndMembers(props.currentTeamId);\r\n                }\r\n            }\r\n        }\r\n\r\n        function handleBlur() {\r\n            window.isActive = false;\r\n            blurTime.current = Date.now();\r\n            props.unsetActiveChannelOnServer();\r\n        }\r\n\r\n        function handleKeydown(event: KeyboardEvent) {\r\n            if (event.shiftKey && cmdOrCtrlPressed(event) && isKeyPressed(event, Constants.KeyCodes.L)) {\r\n                const replyTextbox = document.querySelector<HTMLElement>('#sidebar-right.is-open.expanded #reply_textbox');\r\n                if (replyTextbox) {\r\n                    replyTextbox.focus();\r\n                } else {\r\n                    const postTextbox = document.getElementById('post_textbox');\r\n                    if (postTextbox) {\r\n                        postTextbox.focus();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        window.addEventListener('focus', handleFocus);\r\n        window.addEventListener('blur', handleBlur);\r\n        window.addEventListener('keydown', handleKeydown);\r\n\r\n        return () => {\r\n            window.removeEventListener('focus', handleFocus);\r\n            window.removeEventListener('blur', handleBlur);\r\n            window.removeEventListener('keydown', handleKeydown);\r\n        };\r\n    }, [props.currentTeamId]);\r\n\r\n    // Load team content flagging status on team switch\r\n    useEffect(() => {\r\n        if (contentFlaggingEnabled && props.currentTeamId) {\r\n            dispatch(getTeamContentFlaggingStatus(props.currentTeamId));\r\n        }\r\n    }, [contentFlaggingEnabled, dispatch, props.currentTeamId]);\r\n\r\n    // Effect runs on mount, adds active state to window\r\n    useEffect(() => {\r\n        const browserIsIosSafari = isIosSafari();\r\n        if (browserIsIosSafari) {\r\n            // Use iNoBounce to prevent scrolling past the boundaries of the page\r\n            iNoBounce.enable();\r\n        }\r\n\r\n        // Set up tracking for whether the window is active\r\n        window.isActive = true;\r\n\r\n        LocalStorageStore.setTeamIdJoinedOnLoad(null);\r\n\r\n        return () => {\r\n            window.isActive = false;\r\n\r\n            if (browserIsIosSafari) {\r\n                iNoBounce.disable();\r\n            }\r\n        };\r\n    }, []);\r\n\r\n    async function initTeamOrRedirect(team: Team) {\r\n        const {data: joinedTeam, error} = await props.initializeTeam(team) as ActionResult<Team, ServerError>; // Fix in MM-46907;\r\n        if (error) {\r\n            history.push('/error?type=team_not_found');\r\n            return;\r\n        }\r\n        if (joinedTeam) {\r\n            setTeam(joinedTeam);\r\n        }\r\n    }\r\n\r\n    async function joinTeamOrRedirect(teamNameParam: string, joinedOnFirstLoad: boolean) {\r\n        setTeam(null);\r\n\r\n        const {data: joinedTeam, error} = await props.joinTeam(teamNameParam, joinedOnFirstLoad) as ActionResult<Team, ServerError>; // Fix in MM-46907;\r\n        if (error) {\r\n            history.push('/error?type=team_not_found');\r\n            return;\r\n        }\r\n        if (joinedTeam) {\r\n            setTeam(joinedTeam);\r\n        }\r\n    }\r\n\r\n    const teamsListDependency = props.teamsList.map((team) => team.id).sort().join('+');\r\n\r\n    // Effect to run when url for team or teamsList changes\r\n    useEffect(() => {\r\n        if (teamNameParam) {\r\n            // skip reserved team names\r\n            if (Constants.RESERVED_TEAM_NAMES.includes(teamNameParam)) {\r\n                return;\r\n            }\r\n\r\n            const teamFromTeamNameParam = getTeamFromTeamList(props.teamsList, teamNameParam);\r\n            if (teamFromTeamNameParam) {\r\n                // If the team is already in the teams list, initialize it when we switch teams\r\n                initTeamOrRedirect(teamFromTeamNameParam);\r\n            } else if (team && team.name !== teamNameParam) {\r\n                // When we are already in a team and the new team is not in the teams list, attempt to join it\r\n                joinTeamOrRedirect(teamNameParam, false);\r\n            } else if (!team) {\r\n                // When we are not in a team and the new team is not in the teams list, attempt to join it\r\n                joinTeamOrRedirect(teamNameParam, true);\r\n            }\r\n        }\r\n    }, [teamNameParam, teamsListDependency]);\r\n\r\n    if (props.mfaRequired) {\r\n        history.push('/mfa/setup');\r\n        return null;\r\n    }\r\n\r\n    if (team === null) {\r\n        return null;\r\n    }\r\n\r\n    const teamLoaded = team?.name.toLowerCase() === teamNameParam?.toLowerCase();\r\n\r\n    return (\r\n        <Switch>\r\n            <Route\r\n                path={`/:team(${TEAM_NAME_PATH_PATTERN})/integrations`}\r\n                component={BackstageController}\r\n            />\r\n            <Route\r\n                path={`/:team(${TEAM_NAME_PATH_PATTERN})/emoji`}\r\n                component={BackstageController}\r\n            />\r\n            {props.plugins?.map((plugin) => (\r\n                <Route\r\n                    key={plugin.id}\r\n                    path={`/:team(${TEAM_NAME_PATH_PATTERN})/` + (plugin as any).route}\r\n                    render={() => (\r\n                        <Pluggable\r\n                            pluggableName={'NeedsTeamComponent'}\r\n                            pluggableId={plugin.id}\r\n                            css={{gridArea: 'center'}}\r\n                        />\r\n                    )}\r\n                />\r\n            ))}\r\n            <ChannelController shouldRenderCenterChannel={initialChannelsLoaded && teamLoaded}/>\r\n        </Switch>\r\n    );\r\n}\r\n\r\nfunction getTeamFromTeamList(teamsList: Props['teamsList'], teamName?: string) {\r\n    if (!teamName) {\r\n        return null;\r\n    }\r\n\r\n    const team = teamsList.find((teamInList) => teamInList.name === teamName) ?? null;\r\n    if (!team) {\r\n        return null;\r\n    }\r\n\r\n    return team;\r\n}\r\n\r\nexport default memo(TeamController);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {useEffect} from 'react';\r\nimport {useSelector} from 'react-redux';\r\n\r\nimport {Client4} from 'mattermost-redux/client';\r\nimport {getCurrentUser} from 'mattermost-redux/selectors/entities/users';\r\n\r\n/**\r\n * The purpose of this hook is to sync the user's id and role with client4's user id and role,\r\n * which is essential to identify the user in telemetry.\r\n */\r\nfunction useTelemetryIdentitySync() {\r\n    const user = useSelector(getCurrentUser);\r\n    const userId = user?.id ?? '';\r\n    const userRoles = user?.roles ?? '';\r\n\r\n    useEffect(() => {\r\n        if (userId) {\r\n            Client4.setUserId(userId);\r\n        }\r\n        if (userRoles) {\r\n            Client4.setUserRoles(userRoles);\r\n        }\r\n    }, [userId, userRoles]);\r\n}\r\n\r\nexport default useTelemetryIdentitySync;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport type {ConnectedProps} from 'react-redux';\r\nimport type {RouteComponentProps} from 'react-router-dom';\r\n\r\nimport {fetchAllMyTeamsChannels, fetchAllMyChannelMembers, fetchChannelsAndMembers, unsetActiveChannelOnServer} from 'mattermost-redux/actions/channels';\r\nimport {getCurrentChannelId} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getLicense, getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {getCurrentTeamId, getMyTeams} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getCurrentUser} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {markAsReadOnFocus} from 'actions/views/channel';\r\nimport {getSelectedPostId} from 'selectors/rhs';\r\nimport {getSelectedThreadIdInCurrentTeam} from 'selectors/views/threads';\r\n\r\nimport {initializeTeam, joinTeam} from 'components/team_controller/actions';\r\n\r\nimport {checkIfMFARequired} from 'utils/route';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport TeamController from './team_controller';\r\n\r\ntype Params = {\r\n    url: string;\r\n    team?: string;\r\n}\r\n\r\nexport type OwnProps = RouteComponentProps<Params>;\r\n\r\nfunction mapStateToProps(state: GlobalState, ownProps: OwnProps) {\r\n    const license = getLicense(state);\r\n    const config = getConfig(state);\r\n    const currentUser = getCurrentUser(state);\r\n    const plugins = state.plugins.components.NeedsTeamComponent;\r\n    const disableRefetchingOnBrowserFocus = config.DisableRefetchingOnBrowserFocus === 'true';\r\n    const disableWakeUpReconnectHandler = config.DisableWakeUpReconnectHandler === 'true';\r\n\r\n    return {\r\n        currentTeamId: getCurrentTeamId(state),\r\n        currentChannelId: getCurrentChannelId(state),\r\n        teamsList: getMyTeams(state),\r\n        plugins,\r\n        selectedThreadId: getSelectedThreadIdInCurrentTeam(state),\r\n        selectedPostId: getSelectedPostId(state),\r\n        mfaRequired: checkIfMFARequired(currentUser, license, config, ownProps.match.url),\r\n        disableRefetchingOnBrowserFocus,\r\n        disableWakeUpReconnectHandler,\r\n    };\r\n}\r\n\r\nconst mapDispatchToProps = {\r\n    fetchChannelsAndMembers,\r\n    fetchAllMyTeamsChannels,\r\n    fetchAllMyChannelMembers,\r\n    markAsReadOnFocus,\r\n    initializeTeam,\r\n    joinTeam,\r\n    unsetActiveChannelOnServer,\r\n};\r\n\r\nconst connector = connect(mapStateToProps, mapDispatchToProps);\r\n\r\nexport type PropsFromRedux = ConnectedProps<typeof connector>;\r\n\r\nexport default connector(TeamController);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage, injectIntl} from 'react-intl';\r\nimport type {IntlShape} from 'react-intl';\r\n\r\nimport {SyncableType} from '@mattermost/types/groups';\r\nimport type {Group, SyncablePatch} from '@mattermost/types/groups';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport AddGroupsToTeamModal from 'components/add_groups_to_team_modal';\r\nimport ConfirmModal from 'components/confirm_modal';\r\nimport Nbsp from 'components/html_entities/nbsp';\r\nimport ListModal, {DEFAULT_NUM_PER_PAGE} from 'components/list_modal';\r\nimport DropdownIcon from 'components/widgets/icons/fa_dropdown_icon';\r\nimport Menu from 'components/widgets/menu/menu';\r\nimport MenuWrapper from 'components/widgets/menu/menu_wrapper';\r\n\r\nimport groupsAvatar from 'images/groups-avatar.png';\r\nimport {ModalIdentifiers} from 'utils/constants';\r\nimport * as Utils from 'utils/utils';\r\n\r\nimport type {ModalData} from 'types/actions';\r\n\r\ntype Props = {\r\n    intl: IntlShape;\r\n    team: Team;\r\n    actions: {\r\n        getGroupsAssociatedToTeam: (teamID: string, q: string, page: number, perPage: number, filterAllowReference: boolean) => Promise<ActionResult<{groups: Group[]; totalGroupCount: number}>>;\r\n        closeModal: (modalId: string) => void;\r\n        openModal: <P>(modalData: ModalData<P>) => void;\r\n        unlinkGroupSyncable: (groupID: string, syncableID: string, syncableType: SyncableType) => Promise<ActionResult>;\r\n        patchGroupSyncable: (groupID: string, syncableID: string, syncableType: SyncableType, patch: Partial<SyncablePatch>) => Promise<ActionResult>;\r\n        getMyTeamMembers: () => void;\r\n    };\r\n};\r\n\r\ntype State = {\r\n    showConfirmModal: boolean;\r\n    item: Group;\r\n    listModal?: ListModal;\r\n}\r\n\r\nclass TeamGroupsManageModal extends React.PureComponent<Props, State> {\r\n    state = {\r\n        showConfirmModal: false,\r\n        item: {\r\n            member_count: 0,\r\n        },\r\n    } as State;\r\n\r\n    loadItems = async (pageNumber: number, searchTerm: string) => {\r\n        const {data} = await this.props.actions.getGroupsAssociatedToTeam(this.props.team.id, searchTerm, pageNumber, DEFAULT_NUM_PER_PAGE, true);\r\n\r\n        return {\r\n            items: data!.groups,\r\n            totalCount: data!.totalGroupCount,\r\n        };\r\n    };\r\n\r\n    handleDeleteCanceled = () => {\r\n        this.setState({showConfirmModal: false});\r\n    };\r\n\r\n    handleDeleteConfirmed = () => {\r\n        this.setState({showConfirmModal: false});\r\n        const {item, listModal} = this.state;\r\n        this.props.actions.unlinkGroupSyncable(item.id, this.props.team.id, SyncableType.Team).then(async () => {\r\n            if (listModal) {\r\n                listModal.setState({loading: true});\r\n                const {items, totalCount} = await listModal.props.loadItems(listModal.state.page, listModal.state.searchTerm);\r\n\r\n                listModal.setState({loading: false, items, totalCount});\r\n            }\r\n        });\r\n    };\r\n\r\n    onClickRemoveGroup = (item: Group, listModal: ListModal) => {\r\n        this.setState({showConfirmModal: true, item, listModal});\r\n    };\r\n\r\n    onClickConfirmRemoveGroup = (item: Group, listModal: ListModal) => this.props.actions.unlinkGroupSyncable(item.id, this.props.team.id, SyncableType.Team).then(async () => {\r\n        listModal.setState({loading: true});\r\n        const {items, totalCount} = await listModal.props.loadItems(listModal.state.page, listModal.state.searchTerm);\r\n        listModal.setState({loading: false, items, totalCount});\r\n    });\r\n\r\n    onHide = () => {\r\n        this.props.actions.closeModal(ModalIdentifiers.MANAGE_TEAM_GROUPS);\r\n    };\r\n\r\n    titleButtonOnClick = () => {\r\n        this.onHide();\r\n        this.props.actions.openModal({modalId: ModalIdentifiers.ADD_GROUPS_TO_TEAM, dialogType: AddGroupsToTeamModal});\r\n    };\r\n\r\n    setTeamMemberStatus = async (item: Group, listModal: ListModal, isTeamAdmin: boolean) => {\r\n        this.props.actions.patchGroupSyncable(item.id, this.props.team.id, SyncableType.Team, {scheme_admin: isTeamAdmin}).then(async () => {\r\n            listModal.setState({loading: true});\r\n            const {items, totalCount} = await listModal.props.loadItems(listModal.state.page, listModal.state.searchTerm);\r\n\r\n            this.props.actions.getMyTeamMembers();\r\n\r\n            listModal.setState({loading: false, items, totalCount});\r\n        });\r\n    };\r\n\r\n    renderRow = (item: Group, listModal: ListModal) => {\r\n        let title;\r\n        if (item.scheme_admin) {\r\n            title = (\r\n                <FormattedMessage\r\n                    id='team_members_dropdown.teamAdmins'\r\n                    defaultMessage='Team Admins'\r\n                />\r\n            );\r\n        } else {\r\n            title = (\r\n                <FormattedMessage\r\n                    id='team_members_dropdown.teamMembers'\r\n                    defaultMessage='Team Members'\r\n                />\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div\r\n                key={item.id}\r\n                className='more-modal__row'\r\n            >\r\n                <img\r\n                    className='more-modal__image'\r\n                    src={groupsAvatar}\r\n                    alt='group picture'\r\n                    width='32'\r\n                    height='32'\r\n                />\r\n                <div className='more-modal__details'>\r\n                    <div\r\n                        className='more-modal__name'\r\n                        data-testid='group-name'\r\n                    >{item.display_name} <Nbsp/> {'-'} <Nbsp/>\r\n                        <span className='more-modal__name_count'>\r\n                            <FormattedMessage\r\n                                id='numMembers'\r\n                                defaultMessage='{num, number} {num, plural, one {member} other {members}}'\r\n                                values={{\r\n                                    num: item.member_count,\r\n                                }}\r\n                            />\r\n                        </span>\r\n                    </div>\r\n                </div>\r\n                <div className='more-modal__actions'>\r\n                    <MenuWrapper>\r\n                        <button\r\n                            id={`teamGroupsDropdown_${item.display_name}`}\r\n                            className='dropdown-toggle theme color--link style--none'\r\n                            type='button'\r\n                            aria-expanded='true'\r\n                            data-testid='menu-button'\r\n                        >\r\n                            <span>{title} </span>\r\n                            <DropdownIcon/>\r\n                        </button>\r\n                        <Menu\r\n                            openLeft={true}\r\n                            ariaLabel={Utils.localizeMessage({id: 'team_members_dropdown.menuAriaLabel', defaultMessage: 'Change the role of a team member'})}\r\n                        >\r\n                            <Menu.ItemAction\r\n                                show={!item.scheme_admin}\r\n                                onClick={() => this.setTeamMemberStatus(item, listModal, true)}\r\n                                text={Utils.localizeMessage({id: 'team_members_dropdown.makeTeamAdmins', defaultMessage: 'Make Team Admins'})}\r\n                            />\r\n                            <Menu.ItemAction\r\n                                show={Boolean(item.scheme_admin)}\r\n                                onClick={() => this.setTeamMemberStatus(item, listModal, false)}\r\n                                text={Utils.localizeMessage({id: 'team_members_dropdown.makeTeamMembers', defaultMessage: 'Make Team Members'})}\r\n                            />\r\n                            <Menu.ItemAction\r\n                                id='remove-group'\r\n                                onClick={() => this.onClickRemoveGroup(item, listModal)}\r\n                                text={Utils.localizeMessage({id: 'group_list_modal.removeGroupButton', defaultMessage: 'Remove Group'})}\r\n                            />\r\n                        </Menu>\r\n                    </MenuWrapper>\r\n                </div>\r\n            </div>\r\n        );\r\n    };\r\n\r\n    render() {\r\n        const {formatMessage} = this.props.intl;\r\n        const memberCount = this.state.item.member_count;\r\n        return (\r\n            <>\r\n                <ListModal\r\n                    show={!this.state.showConfirmModal}\r\n                    titleText={formatMessage({id: 'team_groups', defaultMessage: '{team} Groups'}, {team: this.props.team.display_name})}\r\n                    searchPlaceholderText={formatMessage({id: 'manage_team_groups_modal.search_placeholder', defaultMessage: 'Search groups'})}\r\n                    renderRow={this.renderRow}\r\n                    loadItems={this.loadItems}\r\n                    onHide={this.onHide}\r\n                    titleBarButtonText={formatMessage({id: 'group_list_modal.addGroupButton', defaultMessage: 'Add Groups'})}\r\n                    titleBarButtonOnClick={this.titleButtonOnClick}\r\n                    data-testid='list-modal'\r\n                />\r\n                <ConfirmModal\r\n                    show={this.state.showConfirmModal}\r\n                    title={formatMessage({id: 'remove_group_confirm_title', defaultMessage: 'Remove Group and {memberCount, number} {memberCount, plural, one {Member} other {Members}}'}, {memberCount})}\r\n                    message={formatMessage({id: 'remove_group_confirm_message', defaultMessage: '{memberCount, number} {memberCount, plural, one {member} other {members}} associated to this group will be removed from the team. Are you sure you wish to remove this group and {memberCount} {memberCount, plural, one {member} other {members}}?'}, {memberCount})}\r\n                    confirmButtonText={formatMessage({id: 'remove_group_confirm_button', defaultMessage: 'Yes, Remove Group and {memberCount, plural, one {Member} other {Members}}'}, {memberCount})}\r\n                    onConfirm={this.handleDeleteConfirmed}\r\n                    onCancel={this.handleDeleteCanceled}\r\n                    id='confirm-modal'\r\n                />\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nexport default injectIntl(TeamGroupsManageModal);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {getGroupsAssociatedToTeam, unlinkGroupSyncable, patchGroupSyncable} from 'mattermost-redux/actions/groups';\r\nimport {getMyTeamMembers} from 'mattermost-redux/actions/teams';\r\n\r\nimport {closeModal, openModal} from 'actions/views/modals';\r\n\r\nimport TeamGroupsManageModal from './team_groups_manage_modal';\r\n\r\ntype OwnProps = {\r\n    teamID: string;\r\n};\r\n\r\nconst mapStateToProps = (state: GlobalState, ownProps: OwnProps) => {\r\n    return {\r\n        team: state.entities.teams.teams[ownProps.teamID],\r\n    };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch: Dispatch) => ({\r\n    actions: bindActionCreators({\r\n        getGroupsAssociatedToTeam,\r\n        closeModal,\r\n        openModal,\r\n        unlinkGroupSyncable,\r\n        patchGroupSyncable,\r\n        getMyTeamMembers,\r\n    }, dispatch),\r\n});\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(TeamGroupsManageModal);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage, injectIntl} from 'react-intl';\r\nimport type {WrappedComponentProps} from 'react-intl';\r\n\r\nimport type {Team, TeamMembership} from '@mattermost/types/teams';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\n\r\nimport type {isCollapsedThreadsEnabled} from 'mattermost-redux/selectors/entities/preferences';\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\nimport {isGuest, isAdmin, isSystemAdmin} from 'mattermost-redux/utils/user_utils';\r\n\r\nimport ConfirmModal from 'components/confirm_modal';\r\nimport * as Menu from 'components/menu';\r\nimport DropdownIcon from 'components/widgets/icons/fa_dropdown_icon';\r\n\r\nimport {getHistory} from 'utils/browser_history';\r\n\r\nconst ROWS_FROM_BOTTOM_TO_OPEN_UP = 3;\r\n\r\ntype Props = WrappedComponentProps & {\r\n    user: UserProfile;\r\n    currentUser: UserProfile;\r\n    teamMember: TeamMembership;\r\n    teamUrl: string;\r\n    currentTeam?: Team;\r\n    index: number;\r\n    totalUsers: number;\r\n    collapsedThreads: ReturnType<typeof isCollapsedThreadsEnabled>;\r\n    actions: {\r\n        getMyTeamMembers: () => void;\r\n        getMyTeamUnreads: (collapsedThreads: boolean) => void;\r\n        getUser: (id: string) => void;\r\n        getTeamMember: (teamId: string, userId: string) => void;\r\n        getTeamStats: (teamId: string) => void;\r\n        getChannelStats: (channelId: string) => void;\r\n        updateTeamMemberSchemeRoles: (teamId: string, userId: string, b1: boolean, b2: boolean) => Promise<ActionResult>;\r\n        updateUserActive: (userId: string, active: boolean) => Promise<ActionResult>;\r\n        removeUserFromTeamAndGetStats: (teamId: string, userId: string) => Promise<ActionResult>;\r\n    };\r\n};\r\n\r\ntype State = {\r\n    serverError: string|null;\r\n    showDemoteModal: boolean;\r\n    user: UserProfile|null;\r\n    role: string|null;\r\n}\r\n\r\nclass TeamMembersDropdown extends React.PureComponent<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            serverError: null,\r\n            showDemoteModal: false,\r\n            user: null,\r\n            role: null,\r\n        };\r\n    }\r\n\r\n    private handleMakeMember = async () => {\r\n        const me = this.props.currentUser;\r\n        if (this.props.user.id === me.id && me.roles.includes('system_admin')) {\r\n            this.handleDemote(this.props.user, 'team_user');\r\n        } else {\r\n            const {error} = await this.props.actions.updateTeamMemberSchemeRoles(this.props.teamMember.team_id, this.props.user.id, true, false);\r\n            if (error) {\r\n                this.setState({serverError: error.message});\r\n            } else {\r\n                this.props.actions.getUser(this.props.user.id);\r\n                this.props.actions.getTeamMember(this.props.teamMember.team_id, this.props.user.id);\r\n                if (this.props.user.id === me.id) {\r\n                    await this.props.actions.getMyTeamMembers();\r\n                    this.props.actions.getMyTeamUnreads(this.props.collapsedThreads);\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    private handleRemoveFromTeam = async () => {\r\n        const {error} = await this.props.actions.removeUserFromTeamAndGetStats(this.props.teamMember.team_id, this.props.user.id);\r\n        if (error) {\r\n            this.setState({serverError: error.message});\r\n        }\r\n    };\r\n\r\n    private handleMakeAdmin = async () => {\r\n        const me = this.props.currentUser;\r\n        if (this.props.user.id === me.id && me.roles.includes('system_admin')) {\r\n            this.handleDemote(this.props.user, 'team_user team_admin');\r\n        } else {\r\n            const {error} = await this.props.actions.updateTeamMemberSchemeRoles(this.props.teamMember.team_id, this.props.user.id, true, true);\r\n            if (error) {\r\n                this.setState({serverError: error.message});\r\n            } else {\r\n                this.props.actions.getUser(this.props.user.id);\r\n                this.props.actions.getTeamMember(this.props.teamMember.team_id, this.props.user.id);\r\n            }\r\n        }\r\n    };\r\n\r\n    private handleDemote = (user: UserProfile, role: string): void => {\r\n        this.setState({\r\n            serverError: this.state.serverError,\r\n            showDemoteModal: true,\r\n            user,\r\n            role,\r\n        });\r\n    };\r\n\r\n    private handleDemoteCancel = (): void => {\r\n        this.setState({\r\n            serverError: null,\r\n            showDemoteModal: false,\r\n            user: null,\r\n            role: null,\r\n        });\r\n    };\r\n\r\n    private handleDemoteSubmit = async () => {\r\n        const {error} = await this.props.actions.updateTeamMemberSchemeRoles(this.props.teamMember.team_id, this.props.user.id, true, false);\r\n        if (error) {\r\n            this.setState({serverError: error.message});\r\n        } else {\r\n            this.props.actions.getUser(this.props.user.id);\r\n            getHistory().push(this.props.teamUrl);\r\n        }\r\n    };\r\n\r\n    render() {\r\n        let serverError = null;\r\n        if (this.state.serverError) {\r\n            serverError = (\r\n                <div className='has-error'>\r\n                    <label className='has-error control-label'>{this.state.serverError}</label>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        const {currentTeam, teamMember, user, intl} = this.props;\r\n\r\n        let currentRoles = null;\r\n\r\n        if (isGuest(user.roles)) {\r\n            currentRoles = (\r\n                <FormattedMessage\r\n                    id='team_members_dropdown.guest'\r\n                    defaultMessage='Guest'\r\n                />\r\n            );\r\n        } else if (user.roles.length > 0 && isSystemAdmin(user.roles)) {\r\n            currentRoles = (\r\n                <FormattedMessage\r\n                    id='team_members_dropdown.systemAdmin'\r\n                    defaultMessage='System Admin'\r\n                />\r\n            );\r\n        } else if ((teamMember.roles.length > 0 && isAdmin(teamMember.roles)) || teamMember.scheme_admin) {\r\n            currentRoles = (\r\n                <FormattedMessage\r\n                    id='team_members_dropdown.teamAdmin'\r\n                    defaultMessage='Team Admin'\r\n                />\r\n            );\r\n        } else {\r\n            currentRoles = (\r\n                <FormattedMessage\r\n                    id='team_members_dropdown.member'\r\n                    defaultMessage='Member'\r\n                />\r\n            );\r\n        }\r\n\r\n        const me = this.props.currentUser;\r\n        let showMakeMember = !isGuest(user.roles) && (isAdmin(teamMember.roles) || teamMember.scheme_admin) && !isSystemAdmin(user.roles);\r\n        let showMakeAdmin = !isGuest(user.roles) && !isAdmin(teamMember.roles) && !isSystemAdmin(user.roles) && !teamMember.scheme_admin;\r\n\r\n        if (user.delete_at > 0) {\r\n            currentRoles = (\r\n                <FormattedMessage\r\n                    id='team_members_dropdown.inactive'\r\n                    defaultMessage='Inactive'\r\n                />\r\n            );\r\n            showMakeMember = false;\r\n            showMakeAdmin = false;\r\n        }\r\n\r\n        const canRemoveFromTeam = user.id !== me.id && (!currentTeam?.group_constrained || user.is_bot);\r\n\r\n        let makeDemoteModal = null;\r\n        if (user.id === me.id) {\r\n            const title = (\r\n                <FormattedMessage\r\n                    id='team_members_dropdown.confirmDemoteRoleTitle'\r\n                    defaultMessage='Confirm Demotion from System Admin Role'\r\n                />\r\n            );\r\n\r\n            const message = (\r\n                <div>\r\n                    <FormattedMessage\r\n                        id='team_members_dropdown.confirmDemoteDescription'\r\n                        defaultMessage=\"If you demote yourself from the System Admin role and there is not another user with System Admin privileges, you'll need to re-assign a System Admin by accessing the Mattermost server through a terminal and running the following command.\"\r\n                    />\r\n                    <br/>\r\n                    <br/>\r\n                    <FormattedMessage\r\n                        id='team_members_dropdown.confirmDemotionCmd'\r\n                        defaultMessage='platform roles system_admin {username}'\r\n                        values={{\r\n                            username: me.username,\r\n                        }}\r\n                    />\r\n                    {serverError}\r\n                </div>\r\n            );\r\n\r\n            const confirmButton = (\r\n                <FormattedMessage\r\n                    id='team_members_dropdown.confirmDemotion'\r\n                    defaultMessage='Confirm Demotion'\r\n                />\r\n            );\r\n\r\n            makeDemoteModal = (\r\n                <ConfirmModal\r\n                    show={this.state.showDemoteModal}\r\n                    title={title}\r\n                    message={message}\r\n                    confirmButtonText={confirmButton}\r\n                    onConfirm={this.handleDemoteSubmit}\r\n                    onCancel={this.handleDemoteCancel}\r\n                />\r\n            );\r\n        }\r\n\r\n        if (!canRemoveFromTeam && !showMakeAdmin && !showMakeMember) {\r\n            return <div>{currentRoles}</div>;\r\n        }\r\n\r\n        const {index, totalUsers} = this.props;\r\n        let openUp = false;\r\n        if (totalUsers > ROWS_FROM_BOTTOM_TO_OPEN_UP && totalUsers - index <= ROWS_FROM_BOTTOM_TO_OPEN_UP) {\r\n            openUp = true;\r\n        }\r\n\r\n        const menuRemove = (\r\n            <Menu.Item\r\n                id='removeFromTeam'\r\n                onClick={this.handleRemoveFromTeam}\r\n                labels={\r\n                    <FormattedMessage\r\n                        id='team_members_dropdown.leave_team'\r\n                        defaultMessage='Remove from Team'\r\n                    />\r\n                }\r\n            />\r\n        );\r\n        const menuMakeAdmin = (\r\n            <Menu.Item\r\n                onClick={this.handleMakeAdmin}\r\n                labels={\r\n                    <FormattedMessage\r\n                        id='team_members_dropdown.makeAdmin'\r\n                        defaultMessage='Make Team Admin'\r\n                    />\r\n                }\r\n            />\r\n        );\r\n        const menuMakeMember = (\r\n            <Menu.Item\r\n                onClick={this.handleMakeMember}\r\n                labels={\r\n                    <FormattedMessage\r\n                        id='team_members_dropdown.makeMember'\r\n                        defaultMessage='Make Team Member'\r\n                    />\r\n                }\r\n            />\r\n        );\r\n        return (\r\n            <>\r\n                <Menu.Container\r\n                    menuButton={{\r\n                        id: `teamMembersDropdown_${user.username}`,\r\n                        class: 'dropdown-toggle theme color--link style--none',\r\n                        children: (\r\n                            <>\r\n                                <span>{currentRoles} </span>\r\n                                <DropdownIcon/>\r\n                            </>\r\n                        ),\r\n                    }}\r\n                    menu={{\r\n                        id: `teamMembersDropdown_${user.username}_menu`,\r\n                        'aria-label': intl.formatMessage({id: 'team_members_dropdown.menuAriaLabel', defaultMessage: 'Change the role of a team member'}),\r\n                    }}\r\n                    anchorOrigin={{\r\n                        vertical: openUp ? 'top' : 'bottom',\r\n                        horizontal: 'right',\r\n                    }}\r\n                    transformOrigin={{\r\n                        vertical: openUp ? 'bottom' : 'top',\r\n                        horizontal: 'right',\r\n                    }}\r\n                >\r\n                    {canRemoveFromTeam ? menuRemove : null}\r\n                    {showMakeAdmin ? menuMakeAdmin : null}\r\n                    {showMakeMember ? menuMakeMember : null}\r\n                </Menu.Container>\r\n                {makeDemoteModal}\r\n                {serverError}\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nexport default injectIntl(TeamMembersDropdown);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {getChannelStats} from 'mattermost-redux/actions/channels';\r\nimport {\r\n    getMyTeamMembers,\r\n    getMyTeamUnreads,\r\n    getTeamStats,\r\n    getTeamMember,\r\n    updateTeamMemberSchemeRoles,\r\n} from 'mattermost-redux/actions/teams';\r\nimport {getUser, updateUserActive} from 'mattermost-redux/actions/users';\r\nimport {isCollapsedThreadsEnabled} from 'mattermost-redux/selectors/entities/preferences';\r\nimport {getCurrentRelativeTeamUrl, getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getCurrentUser} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {removeUserFromTeamAndGetStats} from 'actions/team_actions';\r\n\r\nimport TeamMembersDropdown from './team_members_dropdown';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    return {\r\n        currentUser: getCurrentUser(state),\r\n        teamUrl: getCurrentRelativeTeamUrl(state),\r\n        currentTeam: getCurrentTeam(state),\r\n        collapsedThreads: isCollapsedThreadsEnabled(state),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            getMyTeamMembers,\r\n            getMyTeamUnreads,\r\n            getUser,\r\n            getTeamMember,\r\n            getTeamStats,\r\n            getChannelStats,\r\n            updateUserActive,\r\n            updateTeamMemberSchemeRoles,\r\n            removeUserFromTeamAndGetStats,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(TeamMembersDropdown);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\n\r\nimport type {TeamMembership, TeamStats, GetTeamMembersOpts} from '@mattermost/types/teams';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\n\r\nimport {Teams} from 'mattermost-redux/constants';\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport SearchableUserList from 'components/searchable_user_list/searchable_user_list_container';\r\nimport TeamMembersDropdown from 'components/team_members_dropdown';\r\n\r\nimport Constants from 'utils/constants';\r\nimport * as UserAgent from 'utils/user_agent';\r\n\r\nconst USERS_PER_PAGE = 50;\r\n\r\ntype Props = {\r\n    searchTerm: string;\r\n    users: UserProfile[];\r\n    teamMembers: {\r\n        [userId: string]: TeamMembership;\r\n    };\r\n    currentTeamId: string;\r\n    totalTeamMembers: number;\r\n    canManageTeamMembers?: boolean;\r\n    actions: {\r\n        getTeamMembers: (teamId: string, page?: number, perPage?: number, options?: GetTeamMembersOpts) => Promise<ActionResult<TeamMembership[]>>;\r\n        searchProfiles: (term: string, options?: {[key: string]: any}) => Promise<ActionResult<UserProfile[]>>;\r\n        getTeamStats: (teamId: string) => Promise<ActionResult<TeamStats>>;\r\n        loadProfilesAndTeamMembers: (page: number, perPage: number, teamId: string, options?: {[key: string]: any}) => Promise<ActionResult>;\r\n        loadStatusesForProfilesList: (users: UserProfile[]) => void;\r\n        loadTeamMembersForProfilesList: (profiles: any, teamId: string, reloadAllMembers: boolean) => Promise<ActionResult>;\r\n        setModalSearchTerm: (term: string) => ActionResult;\r\n    };\r\n}\r\n\r\ntype State = {\r\n    loading: boolean;\r\n}\r\n\r\nexport default class MemberListTeam extends React.PureComponent<Props, State> {\r\n    private searchTimeoutId: number;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.searchTimeoutId = 0;\r\n\r\n        this.state = {\r\n            loading: true,\r\n        };\r\n    }\r\n\r\n    async componentDidMount() {\r\n        await Promise.all([\r\n            this.props.actions.loadProfilesAndTeamMembers(0, Constants.PROFILE_CHUNK_SIZE, this.props.currentTeamId, {active: true}),\r\n            this.props.actions.getTeamMembers(this.props.currentTeamId, 0, Constants.DEFAULT_MAX_USERS_PER_TEAM,\r\n                {\r\n                    sort: Teams.SORT_USERNAME_OPTION,\r\n                    exclude_deleted_users: true,\r\n                },\r\n            ),\r\n            this.props.actions.getTeamStats(this.props.currentTeamId),\r\n        ]);\r\n        this.loadComplete();\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.props.actions.setModalSearchTerm('');\r\n    }\r\n\r\n    componentDidUpdate(prevProps: Props) {\r\n        if (prevProps.searchTerm !== this.props.searchTerm) {\r\n            clearTimeout(this.searchTimeoutId);\r\n\r\n            const searchTerm = this.props.searchTerm;\r\n            if (searchTerm === '') {\r\n                this.loadComplete();\r\n                this.searchTimeoutId = 0;\r\n                return;\r\n            }\r\n\r\n            const searchTimeoutId = window.setTimeout(\r\n                async () => {\r\n                    const {\r\n                        loadStatusesForProfilesList,\r\n                        loadTeamMembersForProfilesList,\r\n                        searchProfiles,\r\n                    } = this.props.actions;\r\n                    const {data} = await searchProfiles(searchTerm, {team_id: this.props.currentTeamId});\r\n\r\n                    if (searchTimeoutId !== this.searchTimeoutId) {\r\n                        return;\r\n                    }\r\n\r\n                    this.setState({loading: true});\r\n\r\n                    loadStatusesForProfilesList(data!);\r\n                    loadTeamMembersForProfilesList(data, this.props.currentTeamId, true).then(({data: membersLoaded}) => {\r\n                        if (membersLoaded) {\r\n                            this.loadComplete();\r\n                        }\r\n                    });\r\n                },\r\n                Constants.SEARCH_TIMEOUT_MILLISECONDS,\r\n            );\r\n\r\n            this.searchTimeoutId = searchTimeoutId;\r\n        }\r\n    }\r\n\r\n    loadComplete = () => {\r\n        this.setState({loading: false});\r\n    };\r\n\r\n    nextPage = async (page: number) => {\r\n        this.setState({loading: true});\r\n        await Promise.all([\r\n            this.props.actions.loadProfilesAndTeamMembers(page, USERS_PER_PAGE, this.props.currentTeamId, {active: true}),\r\n            this.props.actions.getTeamMembers(this.props.currentTeamId, page, Constants.DEFAULT_MAX_USERS_PER_TEAM,\r\n                {\r\n                    sort: Teams.SORT_USERNAME_OPTION,\r\n                    exclude_deleted_users: true,\r\n                } as GetTeamMembersOpts,\r\n            ),\r\n        ]);\r\n        this.loadComplete();\r\n    };\r\n\r\n    search = (term: string) => {\r\n        this.props.actions.setModalSearchTerm(term);\r\n    };\r\n\r\n    render() {\r\n        let teamMembersDropdown;\r\n        if (this.props.canManageTeamMembers) {\r\n            teamMembersDropdown = [TeamMembersDropdown];\r\n        }\r\n\r\n        const teamMembers = this.props.teamMembers;\r\n        const users = this.props.users;\r\n        const actionUserProps: {\r\n            [userId: string]: {\r\n                teamMember: TeamMembership;\r\n            };\r\n        } = {};\r\n\r\n        let usersToDisplay;\r\n        if (this.state.loading) {\r\n            usersToDisplay = null;\r\n        } else {\r\n            usersToDisplay = [];\r\n\r\n            for (let i = 0; i < users.length; i++) {\r\n                const user = users[i];\r\n\r\n                if (teamMembers[user.id] && user.delete_at === 0) {\r\n                    usersToDisplay.push(user);\r\n                    actionUserProps[user.id] = {\r\n                        teamMember: teamMembers[user.id],\r\n                    };\r\n                }\r\n            }\r\n        }\r\n\r\n        return (\r\n            <SearchableUserList\r\n                users={usersToDisplay}\r\n                usersPerPage={USERS_PER_PAGE}\r\n                total={this.props.totalTeamMembers}\r\n                nextPage={this.nextPage}\r\n                search={this.search}\r\n                actions={teamMembersDropdown}\r\n                actionUserProps={actionUserProps}\r\n                focusOnMount={!UserAgent.isMobile()}\r\n            />\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {getTeamStats, getTeamMembers} from 'mattermost-redux/actions/teams';\r\nimport {searchProfiles} from 'mattermost-redux/actions/users';\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {haveITeamPermission} from 'mattermost-redux/selectors/entities/roles';\r\nimport {getMembersInCurrentTeam, getCurrentTeamStats} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getProfilesInCurrentTeam, searchProfilesInCurrentTeam} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {loadStatusesForProfilesList} from 'actions/status_actions';\r\nimport {loadProfilesAndTeamMembers, loadTeamMembersForProfilesList} from 'actions/user_actions';\r\nimport {setModalSearchTerm} from 'actions/views/search';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport MemberListTeam from './member_list_team';\r\n\r\ntype Props = {\r\n    teamId?: string;\r\n}\r\n\r\nfunction mapStateToProps(state: GlobalState, ownProps: Props) {\r\n    const canManageTeamMembers = haveITeamPermission(state, ownProps.teamId, Permissions.MANAGE_TEAM_ROLES);\r\n\r\n    const searchTerm = state.views.search.modalSearch;\r\n\r\n    let users;\r\n    if (searchTerm) {\r\n        users = searchProfilesInCurrentTeam(state, searchTerm);\r\n    } else {\r\n        users = getProfilesInCurrentTeam(state);\r\n    }\r\n\r\n    const stats = getCurrentTeamStats(state) || {active_member_count: 0};\r\n\r\n    return {\r\n        searchTerm,\r\n        users,\r\n        teamMembers: getMembersInCurrentTeam(state) || {},\r\n        currentTeamId: state.entities.teams.currentTeamId,\r\n        totalTeamMembers: stats.active_member_count,\r\n        canManageTeamMembers,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            searchProfiles,\r\n            getTeamStats,\r\n            getTeamMembers,\r\n            loadProfilesAndTeamMembers,\r\n            loadStatusesForProfilesList,\r\n            loadTeamMembersForProfilesList,\r\n            setModalSearchTerm,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(MemberListTeam);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport {GenericModal} from '@mattermost/components';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport Permissions from 'mattermost-redux/constants/permissions';\r\n\r\nimport InvitationModal from 'components/invitation_modal';\r\nimport MemberListTeam from 'components/member_list_team';\r\nimport TeamPermissionGate from 'components/permissions_gates/team_permission_gate';\r\n\r\nimport {focusElement} from 'utils/a11y_utils';\r\nimport {ModalIdentifiers} from 'utils/constants';\r\n\r\nimport type {ModalData} from 'types/actions';\r\n\r\nimport './team_members_modal.scss';\r\n\r\ntype Props = {\r\n    currentTeam?: Team;\r\n    onExited: () => void;\r\n    onLoad?: () => void;\r\n    focusOriginElement?: string;\r\n    actions: {\r\n        openModal: <P>(modalData: ModalData<P>) => void;\r\n    };\r\n}\r\n\r\ntype State = {\r\n    show: boolean;\r\n}\r\n\r\nexport default class TeamMembersModal extends React.PureComponent<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            show: true,\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (this.props.onLoad) {\r\n            this.props.onLoad();\r\n        }\r\n    }\r\n\r\n    handleHide = () => {\r\n        this.setState({show: false});\r\n    };\r\n\r\n    handleInvitePeople = () => {\r\n        const {actions} = this.props;\r\n\r\n        actions.openModal({\r\n            modalId: ModalIdentifiers.INVITATION,\r\n            dialogType: InvitationModal,\r\n        });\r\n\r\n        this.handleHide();\r\n    };\r\n\r\n    handleExit = () => {\r\n        if (this.props.focusOriginElement) {\r\n            focusElement(this.props.focusOriginElement, true);\r\n        }\r\n        this.props.onExited();\r\n    };\r\n\r\n    render() {\r\n        let teamDisplayName = '';\r\n        if (this.props.currentTeam) {\r\n            teamDisplayName = this.props.currentTeam.display_name;\r\n        }\r\n\r\n        return (\r\n            <GenericModal\r\n                id='teamMembersModal'\r\n                className='more-modal'\r\n                compassDesign={true}\r\n                show={this.state.show}\r\n                onHide={this.handleHide}\r\n                onExited={this.handleExit}\r\n                modalHeaderTextId='teamMemberModalLabel'\r\n                modalHeaderText={\r\n                    <FormattedMessage\r\n                        id='team_member_modal.members'\r\n                        defaultMessage='{team} Members'\r\n                        values={{\r\n                            team: teamDisplayName,\r\n                        }}\r\n                    />\r\n                }\r\n                ariaLabelledby='teamMemberModalLabel'\r\n                headerButton={\r\n                    <TeamPermissionGate\r\n                        teamId={this.props.currentTeam?.id}\r\n                        permissions={[Permissions.ADD_USER_TO_TEAM, Permissions.INVITE_GUEST]}\r\n                    >\r\n                        <button\r\n                            id='invitePeople'\r\n                            type='button'\r\n                            className='btn btn-primary btn-sm invite-people-btn'\r\n                            onClick={this.handleInvitePeople}\r\n                        >\r\n                            <FormattedMessage\r\n                                id='team_member_modal.invitePeople'\r\n                                defaultMessage='Invite People'\r\n                            />\r\n                        </button>\r\n                    </TeamPermissionGate>\r\n                }\r\n                enforceFocus={false}\r\n                modalLocation='top'\r\n                bodyPadding={false}\r\n            >\r\n                <MemberListTeam\r\n                    teamId={this.props.currentTeam?.id}\r\n                />\r\n            </GenericModal>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport {openModal} from 'actions/views/modals';\r\nimport {isModalOpen} from 'selectors/views/modals';\r\n\r\nimport {ModalIdentifiers} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport TeamMembersModal from './team_members_modal';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const modalId = ModalIdentifiers.TEAM_MEMBERS;\r\n    return {\r\n        currentTeam: getCurrentTeam(state),\r\n        show: isModalOpen(state, modalId),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            openModal,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(TeamMembersModal);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback, useMemo} from 'react';\r\nimport type {KeyboardEventHandler} from 'react';\r\nimport type {StylesConfig} from 'react-select';\r\nimport CreatableSelect from 'react-select/creatable';\r\n\r\nimport './select_text_input.scss';\r\n\r\nconst components = {\r\n    DropdownIndicator: null,\r\n};\r\n\r\nexport interface SelectTextInputOption {\r\n    label: string;\r\n    value: string;\r\n}\r\n\r\ntype Props = {\r\n    placeholder: string;\r\n    value: string[];\r\n    handleNewSelection: (selection: string) => void;\r\n    onChange: (option?: readonly SelectTextInputOption[] | null) => void;\r\n    id?: string;\r\n    isClearable?: boolean;\r\n    description?: string;\r\n}\r\n\r\nconst styles = {\r\n    control: (baseStyles) => ({\r\n        ...baseStyles,\r\n        background: 'var(--center-channel-color-rgb)',\r\n    }),\r\n    input: (baseStyles) => ({\r\n        ...baseStyles,\r\n        color: 'rgba(var(--center-channel-color-rgb), 0.64)',\r\n    }),\r\n    multiValue: (baseStyles) => ({\r\n        ...baseStyles,\r\n        borderRadius: '10px',\r\n        background: 'rgba(var(--center-channel-color-rgb), 0.08)',\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n    }),\r\n    multiValueLabel: (baseStyles) => ({\r\n        ...baseStyles,\r\n        padding: '4px 6px 4px 10px',\r\n        color: 'var(--center-channel-color)',\r\n        fontFamily: 'Open Sans',\r\n        fontSize: '10px',\r\n        fontWeight: 600,\r\n        lineHeight: '12px',\r\n        letterSpacing: '0.2px',\r\n    }),\r\n    multiValueRemove: (baseStyles) => ({\r\n        ...baseStyles,\r\n        borderRadius: '50%',\r\n        background: 'rgba(var(--center-channel-color-rgb), 0.32)',\r\n        fontFamily: 'compass-icons',\r\n        fontSize: '12px',\r\n        fontWeight: 400,\r\n        color: 'white',\r\n        width: '10px',\r\n        height: '10px',\r\n        padding: 0,\r\n        marginRight: '4px',\r\n        ':hover': {\r\n            background: 'rgba(var(--center-channel-color-rgb), 0.32)',\r\n            color: 'white',\r\n        },\r\n    }),\r\n} satisfies StylesConfig<SelectTextInputOption, true>;\r\n\r\nconst SelectTextInput = ({placeholder, value, handleNewSelection, onChange, id, isClearable, description}: Props) => {\r\n    const [inputValue, setInputValue] = React.useState('');\r\n\r\n    const handleTextEnter = useCallback(() => {\r\n        // do not add the value if already exists\r\n        if (value?.includes(inputValue.trim()) || inputValue.length === 0) {\r\n            return;\r\n        }\r\n        handleNewSelection(inputValue);\r\n        setInputValue('');\r\n    }, [handleNewSelection, inputValue, value]);\r\n\r\n    const handleKeyDown: KeyboardEventHandler = useCallback((event) => {\r\n        if (!inputValue) {\r\n            return;\r\n        }\r\n        switch (event.key) {\r\n        case ' ':\r\n        case ',':\r\n        case 'Enter':\r\n            handleTextEnter();\r\n            event.preventDefault();\r\n        }\r\n    }, [inputValue, handleTextEnter]);\r\n\r\n    const selectValues = useMemo(() => {\r\n        return value.map((singleValue) => ({label: singleValue, value: singleValue}));\r\n    }, [value]);\r\n\r\n    return (\r\n        <>\r\n            <CreatableSelect<SelectTextInputOption, true>\r\n                id={id}\r\n                className='select-text-input'\r\n                styles={styles}\r\n                components={components}\r\n                isClearable={isClearable}\r\n                onChange={useCallback((value: readonly SelectTextInputOption[]) => onChange(value), [onChange])}\r\n                inputValue={inputValue}\r\n                isMulti={true}\r\n                menuIsOpen={false}\r\n                onInputChange={setInputValue}\r\n                onKeyDown={handleKeyDown}\r\n                placeholder={placeholder}\r\n                value={selectValues}\r\n                onBlur={handleTextEnter}\r\n            />\r\n            {description ? <p className='select-text-description'>{description}</p> : undefined}\r\n        </>\r\n    );\r\n};\r\n\r\nexport default SelectTextInput;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback, useState} from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\n\r\nimport SelectTextInput, {type SelectTextInputOption} from 'components/common/select_text_input/select_text_input';\r\nimport CheckboxSettingItem from 'components/widgets/modals/components/checkbox_setting_item';\r\nimport {type SaveChangesPanelState} from 'components/widgets/modals/components/save_changes_panel';\r\n\r\ntype Props = {\r\n    allowedDomains: string[];\r\n    setAllowedDomains: (domains: string[]) => void;\r\n    setHasChanges: (hasChanges: boolean) => void;\r\n    setSaveChangesPanelState: (state: SaveChangesPanelState) => void;\r\n}\r\n\r\nconst AllowedDomainsSelect = ({allowedDomains, setAllowedDomains, setHasChanges, setSaveChangesPanelState}: Props) => {\r\n    const [showAllowedDomains, setShowAllowedDomains] = useState<boolean>(allowedDomains.length > 0);\r\n    const {formatMessage} = useIntl();\r\n\r\n    const handleEnableAllowedDomains = useCallback((enabled: boolean) => {\r\n        setShowAllowedDomains(enabled);\r\n        if (!enabled) {\r\n            setAllowedDomains([]);\r\n        }\r\n    }, [setAllowedDomains]);\r\n\r\n    const updateAllowedDomains = useCallback((domain: string) => {\r\n        setHasChanges(true);\r\n        setSaveChangesPanelState('editing');\r\n        setAllowedDomains([...allowedDomains, domain]);\r\n    }, [allowedDomains, setAllowedDomains, setHasChanges, setSaveChangesPanelState]);\r\n\r\n    const handleOnChangeDomains = useCallback((allowedDomainsOptions?: readonly SelectTextInputOption[] | null) => {\r\n        setHasChanges(true);\r\n        setSaveChangesPanelState('editing');\r\n        setAllowedDomains(allowedDomainsOptions?.map((domain) => domain.value) || []);\r\n    }, [setAllowedDomains, setHasChanges, setSaveChangesPanelState]);\r\n\r\n    return (\r\n        <>\r\n            <CheckboxSettingItem\r\n                inputFieldTitle={\r\n                    <FormattedMessage\r\n                        id='general_tab.allowedDomains'\r\n                        defaultMessage='Allow only users with a specific email domain to join this team'\r\n                    />\r\n                }\r\n                data-testid='allowedDomainsCheckbox'\r\n                className='access-allowed-domains-section'\r\n                title={formatMessage({\r\n                    id: 'general_tab.AllowedDomainsTitle',\r\n                    defaultMessage: 'Users with a specific email domain',\r\n                })}\r\n                description={formatMessage({\r\n                    id: 'general_tab.AllowedDomainsInfo',\r\n                    defaultMessage: 'When enabled, users can only join the team if their email matches a specific domain (e.g. \"mattermost.org\")',\r\n                })}\r\n                descriptionAboveContent={true}\r\n                inputFieldData={{name: 'showAllowedDomains'}}\r\n                inputFieldValue={showAllowedDomains}\r\n                handleChange={handleEnableAllowedDomains}\r\n            />\r\n            {showAllowedDomains &&\r\n            <SelectTextInput\r\n                id='allowedDomains'\r\n                placeholder={formatMessage({id: 'general_tab.AllowedDomainsExample', defaultMessage: 'corp.mattermost.com, mattermost.com'})}\r\n                aria-label={formatMessage({id: 'general_tab.allowedDomains.ariaLabel', defaultMessage: 'Allowed Domains'})}\r\n                value={allowedDomains}\r\n                onChange={handleOnChangeDomains}\r\n                handleNewSelection={updateAllowedDomains}\r\n                isClearable={false}\r\n                description={formatMessage({id: 'general_tab.AllowedDomainsTip', defaultMessage: 'Seperate multiple domains with a space, comma, tab or enter.'})}\r\n            />\r\n            }\r\n        </>\r\n    );\r\n};\r\n\r\nexport default AllowedDomainsSelect;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback, useState, useEffect} from 'react';\r\nimport {defineMessages, useIntl} from 'react-intl';\r\nimport {useSelector} from 'react-redux';\r\n\r\nimport {RefreshIcon} from '@mattermost/compass-icons/components';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {haveITeamPermission} from 'mattermost-redux/selectors/entities/roles';\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport Input from 'components/widgets/inputs/input/input';\r\nimport type {BaseSettingItemProps} from 'components/widgets/modals/components/base_setting_item';\r\nimport BaseSettingItem from 'components/widgets/modals/components/base_setting_item';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nconst translations = defineMessages({\r\n    OpenInviteDescriptionError: {\r\n        id: 'team_settings.openInviteDescription.error',\r\n        defaultMessage: 'There was an error generating the invite code, please try again',\r\n    },\r\n});\r\n\r\ntype Props = {\r\n    regenerateTeamInviteId: (teamId: string) => Promise<ActionResult>;\r\n}\r\n\r\nconst InviteSectionInput = ({regenerateTeamInviteId}: Props) => {\r\n    const team = useSelector((state: GlobalState) => getCurrentTeam(state));\r\n    const canInviteTeamMembers = useSelector((state: GlobalState) => haveITeamPermission(state, team?.id || '', Permissions.INVITE_USER));\r\n    const [inviteId, setInviteId] = useState<Team['invite_id']>(team?.invite_id ?? '');\r\n    const [inviteIdError, setInviteIdError] = useState<BaseSettingItemProps['error'] | undefined>();\r\n    const {formatMessage} = useIntl();\r\n\r\n    useEffect(() => {\r\n        setInviteId(team?.invite_id || '');\r\n    }, [team?.invite_id]);\r\n\r\n    const handleRegenerateInviteId = useCallback(async () => {\r\n        const {data, error} = await regenerateTeamInviteId(team?.id || '');\r\n\r\n        if (data?.invite_id) {\r\n            setInviteId(data.invite_id);\r\n            return;\r\n        }\r\n\r\n        if (error) {\r\n            setInviteIdError(translations.OpenInviteDescriptionError);\r\n        }\r\n    }, [regenerateTeamInviteId, team?.id]);\r\n\r\n    if (!canInviteTeamMembers) {\r\n        return null;\r\n    }\r\n    const inviteSectionInput = (\r\n        <div\r\n            data-testid='teamInviteContainer'\r\n            id='teamInviteContainer'\r\n        >\r\n            <Input\r\n                id='teamInviteId'\r\n                type='text'\r\n                value={inviteId}\r\n                maxLength={32}\r\n            />\r\n            <button\r\n                data-testid='regenerateButton'\r\n                id='regenerateButton'\r\n                className='btn btn-tertiary'\r\n                onClick={handleRegenerateInviteId}\r\n            >\r\n                <RefreshIcon/>\r\n                {formatMessage({id: 'general_tab.regenerate', defaultMessage: 'Regenerate'})}\r\n            </button>\r\n        </div>\r\n    );\r\n\r\n    return (\r\n        <BaseSettingItem\r\n            className='access-invite-section'\r\n            title={formatMessage({\r\n                id: 'general_tab.codeTitle',\r\n                defaultMessage: 'Invite Code',\r\n            })}\r\n            description={formatMessage({\r\n                id: 'general_tab.codeLongDesc',\r\n                defaultMessage: 'The Invite Code is part of the unique team invitation link which is sent to members youre inviting to this team. Regenerating the code creates a new invitation link and invalidates the previous link.',\r\n\r\n            })}\r\n            content={inviteSectionInput}\r\n            error={inviteIdError}\r\n            descriptionAboveContent={true}\r\n        />\r\n    );\r\n};\r\n\r\nexport default InviteSectionInput;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\n\r\nimport ExternalLink from 'components/external_link';\r\nimport BaseSettingItem from 'components/widgets/modals/components/base_setting_item';\r\nimport CheckboxSettingItem from 'components/widgets/modals/components/checkbox_setting_item';\r\n\r\ntype Props = {\r\n    allowOpenInvite: boolean;\r\n    isGroupConstrained?: boolean;\r\n    setAllowOpenInvite: (value: boolean) => void;\r\n};\r\n\r\nconst OpenInvite = ({isGroupConstrained, allowOpenInvite, setAllowOpenInvite}: Props) => {\r\n    const {formatMessage} = useIntl();\r\n    if (isGroupConstrained) {\r\n        const groupConstrainedContent = (\r\n            <p id='groupConstrainedContent' >{\r\n                formatMessage({\r\n                    id: 'team_settings.openInviteDescription.groupConstrained',\r\n                    defaultMessage: 'Members of this team are added and removed by linked groups. <link>Learn More</link>',\r\n                }, {\r\n                    link: (msg: React.ReactNode) => (\r\n                        <ExternalLink\r\n                            href='https://mattermost.com/pl/default-ldap-group-constrained-team-channel.html'\r\n                            location='open_invite'\r\n                        >\r\n                            {msg}\r\n                        </ExternalLink>\r\n                    ),\r\n                })}\r\n            </p>\r\n        );\r\n        return (\r\n            <BaseSettingItem\r\n                className='access-invite-domains-section'\r\n                title={formatMessage({\r\n                    id: 'general_tab.openInviteText',\r\n                    defaultMessage: 'Users on this server',\r\n                })}\r\n                description={formatMessage({\r\n                    id: 'general_tab.openInviteDesc',\r\n                    defaultMessage: 'When enabled, a link to this team will be included on the landing page allowing anyone with an account to join this team. Changing this setting will create a new invitation link and invalidate the previous link.',\r\n                })}\r\n                descriptionAboveContent={true}\r\n                content={groupConstrainedContent}\r\n            />\r\n        );\r\n    }\r\n\r\n    return (\r\n        <CheckboxSettingItem\r\n            className='access-invite-domains-section'\r\n            inputFieldTitle={\r\n                <FormattedMessage\r\n                    id='general_tab.openInviteTitle'\r\n                    defaultMessage='Allow any user with an account on this server to join this team'\r\n                />\r\n            }\r\n            inputFieldData={{name: 'allowOpenInvite'}}\r\n            inputFieldValue={allowOpenInvite}\r\n            handleChange={setAllowOpenInvite}\r\n            title={formatMessage({\r\n                id: 'general_tab.openInviteText',\r\n                defaultMessage: 'Users on this server',\r\n            })}\r\n            description={formatMessage({\r\n                id: 'general_tab.openInviteDesc',\r\n                defaultMessage: 'When enabled, a link to this team will be included on the landing page allowing anyone with an account to join this team. Changing this setting will create a new invitation link and invalidate the previous link.',\r\n            })}\r\n            descriptionAboveContent={true}\r\n        />\r\n    );\r\n};\r\n\r\nexport default OpenInvite;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback, useState} from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nimport ModalSection from 'components/widgets/modals/components/modal_section';\r\nimport SaveChangesPanel, {type SaveChangesPanelState} from 'components/widgets/modals/components/save_changes_panel';\r\n\r\nimport AllowedDomainsSelect from './allowed_domains_select';\r\nimport InviteSectionInput from './invite_section_input';\r\nimport OpenInvite from './open_invite';\r\n\r\nimport type {PropsFromRedux, OwnProps} from '.';\r\n\r\nimport './team_access_tab.scss';\r\n\r\nconst generateAllowedDomainOptions = (allowedDomains?: string) => {\r\n    if (!allowedDomains || allowedDomains.length === 0) {\r\n        return [];\r\n    }\r\n    const domainList = allowedDomains.includes(',') ? allowedDomains.split(',') : [allowedDomains];\r\n    return domainList.map((domain) => domain.trim());\r\n};\r\n\r\ntype Props = PropsFromRedux & OwnProps;\r\n\r\nconst AccessTab = ({closeModal, collapseModal, hasChangeTabError, hasChanges, setHasChangeTabError, setHasChanges, setJustSaved, team, actions}: Props) => {\r\n    const [allowedDomains, setAllowedDomains] = useState<string[]>(() => generateAllowedDomainOptions(team.allowed_domains));\r\n    const [allowOpenInvite, setAllowOpenInvite] = useState<boolean>(team.allow_open_invite ?? false);\r\n    const [saveChangesPanelState, setSaveChangesPanelState] = useState<SaveChangesPanelState>();\r\n    const {formatMessage} = useIntl();\r\n\r\n    const handleAllowedDomainsSubmit = useCallback(async (): Promise<boolean> => {\r\n        const {error} = await actions.patchTeam({\r\n            id: team.id,\r\n            allowed_domains: allowedDomains.length === 1 ? allowedDomains[0] : allowedDomains.join(', '),\r\n        });\r\n        if (error) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }, [actions, allowedDomains, team]);\r\n\r\n    const handleOpenInviteSubmit = useCallback(async (): Promise<boolean> => {\r\n        if (allowOpenInvite === team.allow_open_invite) {\r\n            return true;\r\n        }\r\n        const data = {\r\n            id: team.id,\r\n            allow_open_invite: allowOpenInvite,\r\n        };\r\n\r\n        const {error} = await actions.patchTeam(data);\r\n        if (error) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }, [actions, allowOpenInvite, team]);\r\n\r\n    const updateOpenInvite = useCallback((value: boolean) => {\r\n        setHasChanges(true);\r\n        setSaveChangesPanelState('editing');\r\n        setAllowOpenInvite(value);\r\n    }, [setHasChanges]);\r\n\r\n    const handleClose = useCallback(() => {\r\n        setSaveChangesPanelState('editing');\r\n        setHasChanges(false);\r\n        setHasChangeTabError(false);\r\n        setJustSaved(false); // Reset flag when panel closes\r\n    }, [setHasChangeTabError, setHasChanges, setJustSaved]);\r\n\r\n    const handleCancel = useCallback(() => {\r\n        setAllowedDomains(generateAllowedDomainOptions(team.allowed_domains));\r\n        setAllowOpenInvite(team.allow_open_invite ?? false);\r\n        handleClose();\r\n    }, [handleClose, team.allow_open_invite, team.allowed_domains]);\r\n\r\n    const collapseModalHandler = useCallback(() => {\r\n        if (hasChanges) {\r\n            setHasChangeTabError(true);\r\n            return;\r\n        }\r\n        collapseModal();\r\n    }, [collapseModal, hasChanges, setHasChangeTabError]);\r\n\r\n    const handleSaveChanges = useCallback(async () => {\r\n        const allowedDomainSuccess = await handleAllowedDomainsSubmit();\r\n        const openInviteSuccess = await handleOpenInviteSubmit();\r\n        if (!allowedDomainSuccess || !openInviteSuccess) {\r\n            setSaveChangesPanelState('error');\r\n            return;\r\n        }\r\n        setSaveChangesPanelState('saved');\r\n        setHasChangeTabError(false);\r\n        setJustSaved(true); // Flag that save just completed\r\n    }, [handleAllowedDomainsSubmit, handleOpenInviteSubmit, setHasChangeTabError, setJustSaved]);\r\n\r\n    return (\r\n        <ModalSection\r\n            content={\r\n                <>\r\n                    <div className='modal-header'>\r\n                        <button\r\n                            id='closeButton'\r\n                            type='button'\r\n                            className='close'\r\n                            data-dismiss='modal'\r\n                            onClick={closeModal}\r\n                        >\r\n                            <span aria-hidden='true'>{''}</span>\r\n                        </button>\r\n                        <h4 className='modal-title'>\r\n                            <div className='modal-back'>\r\n                                <i\r\n                                    className='fa fa-angle-left'\r\n                                    aria-label={formatMessage({\r\n                                        id: 'generic_icons.collapse',\r\n                                        defaultMessage: 'Collapes Icon',\r\n                                    })}\r\n                                    onClick={collapseModalHandler}\r\n                                />\r\n                            </div>\r\n                            <span>{formatMessage({id: 'team_settings_modal.title', defaultMessage: 'Team Settings'})}</span>\r\n                        </h4>\r\n                    </div>\r\n                    <div\r\n                        className='modal-access-tab-content user-settings'\r\n                        id='accessSettings'\r\n                        aria-labelledby='accessButton'\r\n                        role='tabpanel'\r\n                    >\r\n                        {team.group_constrained ?\r\n                            undefined :\r\n                            <AllowedDomainsSelect\r\n                                allowedDomains={allowedDomains}\r\n                                setAllowedDomains={setAllowedDomains}\r\n                                setHasChanges={setHasChanges}\r\n                                setSaveChangesPanelState={setSaveChangesPanelState}\r\n                            />\r\n                        }\r\n                        <div className='divider-light'/>\r\n                        <OpenInvite\r\n                            isGroupConstrained={team.group_constrained}\r\n                            allowOpenInvite={allowOpenInvite}\r\n                            setAllowOpenInvite={updateOpenInvite}\r\n                        />\r\n                        <div className='divider-light'/>\r\n                        {team.group_constrained ?\r\n                            undefined :\r\n                            <InviteSectionInput regenerateTeamInviteId={actions.regenerateTeamInviteId}/>\r\n                        }\r\n                        {hasChanges ?\r\n                            <SaveChangesPanel\r\n                                handleCancel={handleCancel}\r\n                                handleSubmit={handleSaveChanges}\r\n                                handleClose={handleClose}\r\n                                tabChangeError={hasChangeTabError}\r\n                                state={saveChangesPanelState}\r\n                            /> : undefined}\r\n                    </div>\r\n                </>\r\n            }\r\n        />\r\n    );\r\n};\r\nexport default AccessTab;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport type {ConnectedProps} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport {patchTeam, regenerateTeamInviteId} from 'mattermost-redux/actions/teams';\r\n\r\nimport TeamAccessTab from './team_access_tab';\r\n\r\nexport type OwnProps = {\r\n    team: Team;\r\n    hasChanges: boolean;\r\n    hasChangeTabError: boolean;\r\n    setHasChanges: (hasChanges: boolean) => void;\r\n    setHasChangeTabError: (hasChangesError: boolean) => void;\r\n    setJustSaved: (justSaved: boolean) => void;\r\n    closeModal: () => void;\r\n    collapseModal: () => void;\r\n};\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            patchTeam,\r\n            regenerateTeamInviteId,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nconst connector = connect(null, mapDispatchToProps);\r\n\r\nexport type PropsFromRedux = ConnectedProps<typeof connector>;\r\n\r\nexport default connector(TeamAccessTab);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback} from 'react';\r\nimport type {ChangeEvent} from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport Input from 'components/widgets/inputs/input/input';\r\nimport BaseSettingItem, {type BaseSettingItemProps} from 'components/widgets/modals/components/base_setting_item';\r\n\r\nimport Constants from 'utils/constants';\r\n\r\ntype Props = {\r\n    handleDescriptionChanges: (name: string) => void;\r\n    description: Team['description'];\r\n    clientError?: BaseSettingItemProps['error'];\r\n};\r\n\r\nconst TeamDescriptionSection = ({handleDescriptionChanges, clientError, description}: Props) => {\r\n    const {formatMessage} = useIntl();\r\n\r\n    const updateDescription = useCallback((e: ChangeEvent<HTMLInputElement>) => {\r\n        handleDescriptionChanges(e.target.value);\r\n    }, [handleDescriptionChanges]);\r\n\r\n    const descriptionSectionInput = (\r\n        <Input\r\n            id='teamDescription'\r\n            data-testid='teamDescriptionInput'\r\n            containerClassName='description-section-input'\r\n            type='textarea'\r\n            maxLength={Constants.MAX_TEAMDESCRIPTION_LENGTH}\r\n            onChange={updateDescription}\r\n            value={description}\r\n            label={formatMessage({id: 'general_tab.teamDescription', defaultMessage: 'Description'})}\r\n        />\r\n    );\r\n\r\n    return (\r\n        <BaseSettingItem\r\n            description={formatMessage({\r\n                id: 'general_tab.teamDescriptionInfo',\r\n                defaultMessage: 'Team description provides additional information to help users select the right team. Maximum of 50 characters.',\r\n            })}\r\n            content={descriptionSectionInput}\r\n            className='description-setting-item'\r\n            error={clientError}\r\n        />\r\n    );\r\n};\r\n\r\nexport default TeamDescriptionSection;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback} from 'react';\r\nimport type {ChangeEvent} from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport Input from 'components/widgets/inputs/input/input';\r\nimport BaseSettingItem, {type BaseSettingItemProps} from 'components/widgets/modals/components/base_setting_item';\r\n\r\nimport Constants from 'utils/constants';\r\n\r\ntype Props = {\r\n    handleNameChanges: (name: string) => void;\r\n    name: Team['display_name'];\r\n    clientError: BaseSettingItemProps['error'];\r\n};\r\n\r\nconst TeamNameSection = ({clientError, handleNameChanges, name}: Props) => {\r\n    const {formatMessage} = useIntl();\r\n\r\n    const updateName = useCallback((e: ChangeEvent<HTMLInputElement>) => handleNameChanges(e.target.value), [handleNameChanges]);\r\n\r\n    const nameSectionInput = (\r\n        <Input\r\n            id='teamName'\r\n            data-testid='teamNameInput'\r\n            type='text'\r\n            maxLength={Constants.MAX_TEAMNAME_LENGTH}\r\n            onChange={updateName}\r\n            value={name}\r\n            label={formatMessage({id: 'general_tab.teamName', defaultMessage: 'Team Name'})}\r\n        />\r\n    );\r\n\r\n    return (\r\n        <BaseSettingItem\r\n            title={formatMessage({\r\n                id: 'general_tab.teamInfo',\r\n                defaultMessage: 'Team info',\r\n            })}\r\n            description={formatMessage({\r\n                id: 'general_tab.teamNameInfo',\r\n                defaultMessage: 'This name will appear on your sign-in screen and at the top of the left sidebar.',\r\n            })}\r\n            content={nameSectionInput}\r\n            error={clientError}\r\n        />\r\n    );\r\n};\r\n\r\nexport default TeamNameSection;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {type ChangeEvent, useRef, useState, useEffect, useCallback} from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nimport {TrashCanOutlineIcon} from '@mattermost/compass-icons/components';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport EditIcon from 'components/widgets/icons/fa_edit_icon';\r\nimport BaseSettingItem from 'components/widgets/modals/components/base_setting_item';\r\nimport type {BaseSettingItemProps} from 'components/widgets/modals/components/base_setting_item';\r\n\r\nimport Constants from 'utils/constants';\r\nimport * as FileUtils from 'utils/file_utils';\r\nimport {imageURLForTeam} from 'utils/utils';\r\n\r\nimport './team_picture_section.scss';\r\n\r\ntype Props = {\r\n    team: Team;\r\n    file?: File | null;\r\n    teamName: string;\r\n    disabled: boolean;\r\n    onFileChange: (e: ChangeEvent<HTMLInputElement>) => void;\r\n    onRemove: () => void;\r\n    clientError?: BaseSettingItemProps['error'];\r\n};\r\n\r\nconst TeamPictureSection = ({team, file, teamName, disabled, onFileChange, onRemove, clientError}: Props) => {\r\n    const selectInput = useRef<HTMLInputElement>(null);\r\n    const [image, setImage] = useState<string>('');\r\n    const [orientationStyles, setOrientationStyles] = useState<{transform: string; transformOrigin: string}>();\r\n    const {formatMessage} = useIntl();\r\n\r\n    const teamImageSource = imageURLForTeam(team);\r\n\r\n    const handleInputFile = useCallback(() => {\r\n        if (selectInput.current) {\r\n            selectInput.current.value = '';\r\n            selectInput.current.click();\r\n        }\r\n    }, []);\r\n\r\n    const editIcon = () => {\r\n        return (\r\n            <>\r\n                <input\r\n                    data-testid='uploadPicture'\r\n                    ref={selectInput}\r\n                    className='hidden'\r\n                    accept={Constants.ACCEPT_STATIC_IMAGE}\r\n                    disabled={disabled}\r\n                    type='file'\r\n                    onChange={onFileChange}\r\n                    aria-hidden={true}\r\n                    tabIndex={-1}\r\n                />\r\n                <span\r\n                    disabled={disabled}\r\n                    onClick={handleInputFile}\r\n                >\r\n                    <EditIcon/>\r\n                </span>\r\n            </>\r\n        );\r\n    };\r\n\r\n    const teamImage = () => {\r\n        if (file) {\r\n            const imageStyles = {\r\n                backgroundImage: 'url(' + image + ')',\r\n                backgroundSize: 'cover',\r\n                backgroundRepeat: 'round',\r\n                ...orientationStyles,\r\n            };\r\n\r\n            return (\r\n                <div\r\n                    id='teamIconImage'\r\n                    style={imageStyles}\r\n                    className='team-img-preview'\r\n                    onClick={handleInputFile}\r\n                />\r\n            );\r\n        }\r\n        if (teamImageSource) {\r\n            return (\r\n                <img\r\n                    id='teamIconImage'\r\n                    className='team-img-preview'\r\n                    src={teamImageSource}\r\n                    onClick={handleInputFile}\r\n                />\r\n            );\r\n        }\r\n        return (\r\n            <div className='team-picture-section__team-icon' >\r\n                <span\r\n                    id='teamIconInitial'\r\n                    onClick={handleInputFile}\r\n                    className='team-picture-section__team-name'\r\n                >{teamName.charAt(0).toUpperCase() + teamName.charAt(1)}</span>\r\n            </div>\r\n        );\r\n    };\r\n\r\n    const setPicture = (file: File) => {\r\n        if (file) {\r\n            const previewBlob = URL.createObjectURL(file);\r\n\r\n            const reader = new FileReader();\r\n            reader.onload = (e) => {\r\n                const orientation = FileUtils.getExifOrientation(e.target!.result! as ArrayBuffer);\r\n                const orientationStyles = FileUtils.getOrientationStyles(orientation);\r\n\r\n                setImage(previewBlob);\r\n                setOrientationStyles(orientationStyles);\r\n            };\r\n            reader.readAsArrayBuffer(file);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        if (file) {\r\n            setPicture(file);\r\n        }\r\n    }, [file]);\r\n\r\n    const removeImageButton = () => {\r\n        if (file || teamImageSource) {\r\n            return (\r\n                <button\r\n                    onClick={onRemove}\r\n                    data-testid='removeImageButton'\r\n                    className='style--none picture-setting-item__remove-button'\r\n                >\r\n                    <TrashCanOutlineIcon/>\r\n                    {formatMessage({id: 'setting_picture.remove_image', defaultMessage: 'Remove image'})}\r\n                </button>\r\n            );\r\n        }\r\n\r\n        return null;\r\n    };\r\n\r\n    const teamPictureSection = (\r\n        <>\r\n            <div className='team-picture-section' >\r\n                {teamImage()}\r\n                {editIcon()}\r\n            </div>\r\n            {removeImageButton()}\r\n        </>\r\n    );\r\n\r\n    return (\r\n        <BaseSettingItem\r\n            title={formatMessage({\r\n                id: 'setting_picture.title',\r\n                defaultMessage: 'Team Icon',\r\n            })}\r\n            description={teamImageSource ? undefined : formatMessage(\r\n                {\r\n                    id: 'setting_picture.help.profile',\r\n                    defaultMessage: 'Upload a picture in BMP, JPG, JPEG, or PNG format. Maximum file size: {max}',\r\n                },\r\n                {\r\n                    max: '50MB',\r\n                },\r\n            )}\r\n            content={teamPictureSection}\r\n            className='picture-setting-item'\r\n            error={clientError}\r\n        />\r\n    );\r\n};\r\n\r\nexport default TeamPictureSection;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback, useState} from 'react';\r\nimport type {ChangeEvent} from 'react';\r\nimport {defineMessages, useIntl} from 'react-intl';\r\n\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport type {BaseSettingItemProps} from 'components/widgets/modals/components/base_setting_item';\r\nimport ModalSection from 'components/widgets/modals/components/modal_section';\r\nimport SaveChangesPanel, {type SaveChangesPanelState} from 'components/widgets/modals/components/save_changes_panel';\r\n\r\nimport Constants from 'utils/constants';\r\n\r\nimport TeamDescriptionSection from './team_description_section';\r\nimport TeamNameSection from './team_name_section';\r\nimport TeamPictureSection from './team_picture_section';\r\n\r\nimport type {PropsFromRedux, OwnProps} from '.';\r\n\r\nimport './team_info_tab.scss';\r\n\r\nconst ACCEPTED_TEAM_IMAGE_TYPES = ['image/jpeg', 'image/png', 'image/bmp'];\r\nconst translations = defineMessages({\r\n    Required: {\r\n        id: 'general_tab.required',\r\n        defaultMessage: 'This field is required',\r\n    },\r\n    TeamNameRestrictions: {\r\n        id: 'general_tab.teamNameRestrictions',\r\n        defaultMessage: 'Team Name must be {min} or more characters up to a maximum of {max}. You can add a longer team description.',\r\n        values: {min: Constants.MIN_TEAMNAME_LENGTH, max: Constants.MAX_TEAMNAME_LENGTH},\r\n    },\r\n    TeamIconInvalidFileType: {\r\n        id: 'general_tab.teamIconInvalidFileType',\r\n        defaultMessage: 'Only BMP, JPG or PNG images may be used for team icons',\r\n    },\r\n    TeamIconTooLarge: {\r\n        id: 'general_tab.teamIconTooLarge',\r\n        defaultMessage: 'Unable to upload team icon. File is too large.',\r\n    },\r\n    TeamIconError: {\r\n        id: 'general_tab.teamIconError',\r\n        defaultMessage: 'An error occurred while selecting the image.',\r\n    },\r\n});\r\ntype Props = PropsFromRedux & OwnProps;\r\n\r\nconst InfoTab = ({team, hasChanges, maxFileSize, closeModal, collapseModal, hasChangeTabError, setHasChangeTabError, setHasChanges, setJustSaved, actions}: Props) => {\r\n    const [name, setName] = useState<Team['display_name']>(team.display_name);\r\n    const [description, setDescription] = useState<Team['description']>(team.description);\r\n    const [teamIconFile, setTeamIconFile] = useState<File | undefined>();\r\n    const [loading, setLoading] = useState<boolean>(false);\r\n    const [imageClientError, setImageClientError] = useState<BaseSettingItemProps['error'] | undefined>();\r\n    const [nameClientError, setNameClientError] = useState<BaseSettingItemProps['error'] | undefined>();\r\n    const [saveChangesPanelState, setSaveChangesPanelState] = useState<SaveChangesPanelState>();\r\n    const {formatMessage} = useIntl();\r\n\r\n    const handleNameDescriptionSubmit = useCallback(async (): Promise<boolean> => {\r\n        if (name.trim() === team.display_name && description === team.description) {\r\n            return true;\r\n        }\r\n\r\n        if (!name) {\r\n            setNameClientError(translations.Required);\r\n            return false;\r\n        } else if (name.length < Constants.MIN_TEAMNAME_LENGTH) {\r\n            setNameClientError(translations.TeamNameRestrictions);\r\n            return false;\r\n        }\r\n        setNameClientError(undefined);\r\n        const {error} = await actions.patchTeam({id: team.id, display_name: name, description});\r\n        if (error) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }, [actions, description, name, team.description, team.display_name, team.id]);\r\n\r\n    const handleTeamIconSubmit = useCallback(async (): Promise<boolean> => {\r\n        if (!teamIconFile) {\r\n            return true;\r\n        }\r\n        setLoading(true);\r\n        setImageClientError(undefined);\r\n        const {error} = await actions.setTeamIcon(team.id, teamIconFile);\r\n        setLoading(false);\r\n        if (error) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }, [actions, team, teamIconFile]);\r\n\r\n    const handleSaveChanges = useCallback(async () => {\r\n        const nameDescriptionSuccess = await handleNameDescriptionSubmit();\r\n        const teamIconSuccess = await handleTeamIconSubmit();\r\n        if (!teamIconSuccess || !nameDescriptionSuccess) {\r\n            setSaveChangesPanelState('error');\r\n            return;\r\n        }\r\n        setSaveChangesPanelState('saved');\r\n        setHasChangeTabError(false);\r\n        setJustSaved(true); // Flag that save just completed\r\n    }, [handleNameDescriptionSubmit, handleTeamIconSubmit, setHasChangeTabError, setJustSaved]);\r\n\r\n    const handleClose = useCallback(() => {\r\n        setSaveChangesPanelState('editing');\r\n        setHasChanges(false);\r\n        setHasChangeTabError(false);\r\n        setJustSaved(false); // Reset flag when panel closes\r\n    }, [setHasChangeTabError, setHasChanges, setJustSaved]);\r\n\r\n    const handleCancel = useCallback(() => {\r\n        setName(team.display_name ?? team.name);\r\n        setDescription(team.description);\r\n        setTeamIconFile(undefined);\r\n        setImageClientError(undefined);\r\n        setNameClientError(undefined);\r\n        handleClose();\r\n    }, [handleClose, team.description, team.display_name, team.name]);\r\n\r\n    const handleTeamIconRemove = useCallback(async () => {\r\n        setLoading(true);\r\n        setImageClientError(undefined);\r\n        setTeamIconFile(undefined);\r\n        handleClose();\r\n\r\n        const {error} = await actions.removeTeamIcon(team.id);\r\n        setLoading(false);\r\n        if (error) {\r\n            setSaveChangesPanelState('error');\r\n            setHasChanges(true);\r\n            setHasChangeTabError(true);\r\n        }\r\n    }, [actions, handleClose, setHasChangeTabError, setHasChanges, team.id]);\r\n\r\n    const updateTeamIcon = useCallback((e: ChangeEvent<HTMLInputElement>) => {\r\n        if (e && e.target && e.target.files && e.target.files[0]) {\r\n            const file = e.target.files[0];\r\n\r\n            if (!ACCEPTED_TEAM_IMAGE_TYPES.includes(file.type)) {\r\n                setImageClientError(translations.TeamIconInvalidFileType);\r\n            } else if (file.size > maxFileSize) {\r\n                setImageClientError(translations.TeamIconTooLarge);\r\n            } else {\r\n                setTeamIconFile(file);\r\n                setImageClientError(undefined);\r\n                setSaveChangesPanelState('editing');\r\n                setHasChanges(true);\r\n            }\r\n        } else {\r\n            setTeamIconFile(undefined);\r\n            setImageClientError(translations.TeamIconError);\r\n        }\r\n    }, [maxFileSize, setHasChanges]);\r\n\r\n    const handleNameChanges = useCallback((name: string) => {\r\n        setHasChanges(true);\r\n        setSaveChangesPanelState('editing');\r\n        setName(name);\r\n    }, [setHasChanges]);\r\n\r\n    const handleDescriptionChanges = useCallback((description: string) => {\r\n        setHasChanges(true);\r\n        setSaveChangesPanelState('editing');\r\n        setDescription(description);\r\n    }, [setHasChanges]);\r\n\r\n    const handleCollapseModal = useCallback(() => {\r\n        if (hasChanges) {\r\n            setHasChangeTabError(true);\r\n            return;\r\n        }\r\n        collapseModal();\r\n    }, [collapseModal, hasChanges, setHasChangeTabError]);\r\n\r\n    const modalSectionContent = (\r\n        <>\r\n            <div className='modal-header'>\r\n                <button\r\n                    id='closeButton'\r\n                    type='button'\r\n                    className='close'\r\n                    data-dismiss='modal'\r\n                    onClick={closeModal}\r\n                >\r\n                    <span aria-hidden='true'>{''}</span>\r\n                </button>\r\n                <h4 className='modal-title'>\r\n                    <div className='modal-back'>\r\n                        <i\r\n                            className='fa fa-angle-left'\r\n                            aria-label={formatMessage({\r\n                                id: 'generic_icons.collapse',\r\n                                defaultMessage: 'Collapes Icon',\r\n                            })}\r\n                            onClick={handleCollapseModal}\r\n                        />\r\n                    </div>\r\n                    <span>{formatMessage({id: 'team_settings_modal.title', defaultMessage: 'Team Settings'})}</span>\r\n                </h4>\r\n            </div>\r\n            <div\r\n                className='modal-info-tab-content user-settings'\r\n                id='infoSettings'\r\n                aria-labelledby='infoButton'\r\n                role='tabpanel'\r\n            >\r\n                <div className='name-description-container' >\r\n                    <TeamNameSection\r\n                        name={name}\r\n                        clientError={nameClientError}\r\n                        handleNameChanges={handleNameChanges}\r\n                    />\r\n                    <TeamDescriptionSection\r\n                        description={description}\r\n                        handleDescriptionChanges={handleDescriptionChanges}\r\n                    />\r\n                </div>\r\n                <TeamPictureSection\r\n                    team={team}\r\n                    file={teamIconFile}\r\n                    disabled={loading}\r\n                    onFileChange={updateTeamIcon}\r\n                    onRemove={handleTeamIconRemove}\r\n                    teamName={team.display_name ?? team.name}\r\n                    clientError={imageClientError}\r\n                />\r\n                {hasChanges ?\r\n                    <SaveChangesPanel\r\n                        handleCancel={handleCancel}\r\n                        handleSubmit={handleSaveChanges}\r\n                        handleClose={handleClose}\r\n                        tabChangeError={hasChangeTabError}\r\n                        state={saveChangesPanelState}\r\n                    /> : undefined}\r\n            </div>\r\n        </>\r\n    );\r\n\r\n    return <ModalSection content={modalSectionContent}/>;\r\n};\r\nexport default InfoTab;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport type {ConnectedProps} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport {getTeam, patchTeam, removeTeamIcon, setTeamIcon} from 'mattermost-redux/actions/teams';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\n\r\nimport type {GlobalState} from 'types/store/index';\r\n\r\nimport TeamInfoTab from './team_info_tab';\r\n\r\nexport type OwnProps = {\r\n    team: Team;\r\n    hasChanges: boolean;\r\n    hasChangeTabError: boolean;\r\n    setHasChanges: (hasChanges: boolean) => void;\r\n    setHasChangeTabError: (hasChangesError: boolean) => void;\r\n    setJustSaved: (justSaved: boolean) => void;\r\n    closeModal: () => void;\r\n    collapseModal: () => void;\r\n};\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const config = getConfig(state);\r\n    const maxFileSize = parseInt(config.MaxFileSize ?? '', 10);\r\n\r\n    return {\r\n        maxFileSize,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            getTeam,\r\n            patchTeam,\r\n            removeTeamIcon,\r\n            setTeamIcon,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nconst connector = connect(mapStateToProps, mapDispatchToProps);\r\n\r\nexport type PropsFromRedux = ConnectedProps<typeof connector>;\r\n\r\nexport default connector(TeamInfoTab);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\n\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport AccessTab from './team_access_tab';\r\nimport InfoTab from './team_info_tab';\r\n\r\ntype Props = {\r\n    activeTab: string;\r\n    hasChanges: boolean;\r\n    hasChangeTabError: boolean;\r\n    setHasChanges: (hasChanges: boolean) => void;\r\n    setHasChangeTabError: (hasChangesError: boolean) => void;\r\n    setJustSaved: (justSaved: boolean) => void;\r\n    closeModal: () => void;\r\n    collapseModal: () => void;\r\n    team?: Team;\r\n};\r\n\r\nconst TeamSettings = ({\r\n    activeTab = '',\r\n    closeModal,\r\n    collapseModal,\r\n    team,\r\n    hasChanges,\r\n    hasChangeTabError,\r\n    setHasChanges,\r\n    setHasChangeTabError,\r\n    setJustSaved,\r\n}: Props) => {\r\n    if (!team) {\r\n        return null;\r\n    }\r\n\r\n    let result;\r\n    switch (activeTab) {\r\n    case 'info':\r\n        result = (\r\n            <InfoTab\r\n                team={team}\r\n                hasChanges={hasChanges}\r\n                setHasChanges={setHasChanges}\r\n                hasChangeTabError={hasChangeTabError}\r\n                setHasChangeTabError={setHasChangeTabError}\r\n                setJustSaved={setJustSaved}\r\n                closeModal={closeModal}\r\n                collapseModal={collapseModal}\r\n            />\r\n        );\r\n        break;\r\n    case 'access':\r\n        result = (\r\n            <AccessTab\r\n                team={team}\r\n                hasChanges={hasChanges}\r\n                setHasChanges={setHasChanges}\r\n                hasChangeTabError={hasChangeTabError}\r\n                setHasChangeTabError={setHasChangeTabError}\r\n                setJustSaved={setJustSaved}\r\n                closeModal={closeModal}\r\n                collapseModal={collapseModal}\r\n            />\r\n        );\r\n        break;\r\n    default:\r\n        result = (\r\n            <div/>\r\n        );\r\n        break;\r\n    }\r\n\r\n    return result;\r\n};\r\n\r\nexport default TeamSettings;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\n\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport TeamSettings from './team_settings';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    return {\r\n        team: getCurrentTeam(state),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps)(TeamSettings);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useState, useRef, useCallback} from 'react';\r\nimport {Modal, type ModalBody} from 'react-bootstrap';\r\nimport ReactDOM from 'react-dom';\r\nimport {useIntl} from 'react-intl';\r\n\r\nimport TeamSettings from 'components/team_settings';\r\n\r\nimport {focusElement} from 'utils/a11y_utils';\r\n\r\nconst SettingsSidebar = React.lazy(() => import('components/settings_sidebar'));\r\n\r\nconst SHOW_PANEL_ERROR_STATE_TAB_SWITCH_TIMEOUT = 3000;\r\n\r\ntype Props = {\r\n    onExited: () => void;\r\n    canInviteUsers: boolean;\r\n    focusOriginElement?: string;\r\n}\r\n\r\nconst TeamSettingsModal = ({onExited, canInviteUsers, focusOriginElement}: Props) => {\r\n    const [activeTab, setActiveTab] = useState('info');\r\n    const [show, setShow] = useState<boolean>(true);\r\n    const [hasChanges, setHasChanges] = useState<boolean>(false);\r\n    const [hasChangeTabError, setHasChangeTabError] = useState<boolean>(false);\r\n    const [hasBeenWarned, setHasBeenWarned] = useState<boolean>(false);\r\n    const [justSaved, setJustSaved] = useState<boolean>(false);\r\n    const modalBodyRef = useRef<ModalBody>(null);\r\n    const {formatMessage} = useIntl();\r\n\r\n    const updateTab = useCallback((tab: string) => {\r\n        if (hasChanges) {\r\n            setHasChangeTabError(true);\r\n            return;\r\n        }\r\n        setActiveTab(tab);\r\n        setHasChanges(false);\r\n        setHasChangeTabError(false);\r\n        setHasBeenWarned(false);\r\n    }, [hasChanges]);\r\n\r\n    const handleHide = useCallback(() => {\r\n        // Prevent modal closing if there are unsaved changes (warn once, then allow)\r\n        // Don't warn if showing \"Settings saved\"\r\n        if (hasChanges && !hasBeenWarned && !justSaved) {\r\n            setHasBeenWarned(true);\r\n            setHasChangeTabError(true);\r\n            setTimeout(() => {\r\n                setHasChangeTabError(false);\r\n            }, SHOW_PANEL_ERROR_STATE_TAB_SWITCH_TIMEOUT);\r\n        } else {\r\n            setShow(false);\r\n        }\r\n    }, [hasChanges, hasBeenWarned, justSaved]);\r\n\r\n    const handleClose = useCallback(() => {\r\n        if (focusOriginElement) {\r\n            focusElement(focusOriginElement, true);\r\n        }\r\n        setActiveTab('info');\r\n        setHasChanges(false);\r\n        setHasChangeTabError(false);\r\n        setHasBeenWarned(false);\r\n        setJustSaved(false);\r\n        onExited();\r\n    }, [onExited, focusOriginElement]);\r\n\r\n    const handleCollapse = useCallback(() => {\r\n        const el = ReactDOM.findDOMNode(modalBodyRef.current) as HTMLDivElement;\r\n        el?.closest('.modal-dialog')!.classList.remove('display--content');\r\n        setActiveTab('');\r\n    }, []);\r\n\r\n    const tabs = [\r\n        {name: 'info', uiName: formatMessage({id: 'team_settings_modal.infoTab', defaultMessage: 'Info'}), icon: 'icon icon-information-outline', iconTitle: formatMessage({id: 'generic_icons.info', defaultMessage: 'Info Icon'})},\r\n    ];\r\n    if (canInviteUsers) {\r\n        tabs.push({name: 'access', uiName: formatMessage({id: 'team_settings_modal.accessTab', defaultMessage: 'Access'}), icon: 'icon icon-account-multiple-outline', iconTitle: formatMessage({id: 'generic_icons.member', defaultMessage: 'Member Icon'})});\r\n    }\r\n\r\n    return (\r\n        <Modal\r\n            dialogClassName='a11y__modal settings-modal'\r\n            show={show}\r\n            onHide={handleHide}\r\n            onExited={handleClose}\r\n            role='none'\r\n            aria-labelledby='teamSettingsModalLabel'\r\n            id='teamSettingsModal'\r\n        >\r\n            <Modal.Header\r\n                id='teamSettingsModalLabel'\r\n                closeButton={true}\r\n            >\r\n                <Modal.Title\r\n                    componentClass='h2'\r\n                    className='modal-header__title'\r\n                >\r\n                    {formatMessage({id: 'team_settings_modal.title', defaultMessage: 'Team Settings'})}\r\n                </Modal.Title>\r\n            </Modal.Header>\r\n            <Modal.Body ref={modalBodyRef}>\r\n                <div className='settings-table'>\r\n                    <div className='settings-links'>\r\n                        <React.Suspense fallback={null}>\r\n                            <SettingsSidebar\r\n                                tabs={tabs}\r\n                                activeTab={activeTab}\r\n                                updateTab={updateTab}\r\n                            />\r\n                        </React.Suspense>\r\n                    </div>\r\n                    <div className='settings-content minimize-settings'>\r\n                        <TeamSettings\r\n                            activeTab={activeTab}\r\n                            hasChanges={hasChanges}\r\n                            setHasChanges={setHasChanges}\r\n                            hasChangeTabError={hasChangeTabError}\r\n                            setHasChangeTabError={setHasChangeTabError}\r\n                            setJustSaved={setJustSaved}\r\n                            closeModal={handleHide}\r\n                            collapseModal={handleCollapse}\r\n                        />\r\n                    </div>\r\n                </div>\r\n            </Modal.Body>\r\n        </Modal>\r\n    );\r\n};\r\n\r\nexport default TeamSettingsModal;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\n\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {haveITeamPermission} from 'mattermost-redux/selectors/entities/roles';\r\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport {isModalOpen} from 'selectors/views/modals';\r\n\r\nimport {ModalIdentifiers} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport TeamSettingsModal from './team_settings_modal';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const teamId = getCurrentTeamId(state);\r\n    const canInviteUsers = haveITeamPermission(state, teamId, Permissions.INVITE_USER);\r\n    const modalId = ModalIdentifiers.TEAM_SETTINGS;\r\n    return {\r\n        show: isModalOpen(state, modalId),\r\n        canInviteUsers,\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps)(TeamSettingsModal);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {injectIntl} from 'react-intl';\r\nimport type {IntlShape} from 'react-intl';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport {basicUnreadMeta} from 'mattermost-redux/selectors/entities/channels';\r\nimport type {BasicUnreadStatus} from 'mattermost-redux/selectors/entities/channels';\r\nimport {ensureString} from 'mattermost-redux/utils/post_utils';\r\n\r\nimport faviconDefault16x16 from 'images/favicon/favicon-default-16x16.png';\r\nimport faviconDefault24x24 from 'images/favicon/favicon-default-24x24.png';\r\nimport faviconDefault32x32 from 'images/favicon/favicon-default-32x32.png';\r\nimport faviconDefault64x64 from 'images/favicon/favicon-default-64x64.png';\r\nimport faviconDefault96x96 from 'images/favicon/favicon-default-96x96.png';\r\nimport faviconMention16x16 from 'images/favicon/favicon-mentions-16x16.png';\r\nimport faviconMention24x24 from 'images/favicon/favicon-mentions-24x24.png';\r\nimport faviconMention32x32 from 'images/favicon/favicon-mentions-32x32.png';\r\nimport faviconMention64x64 from 'images/favicon/favicon-mentions-64x64.png';\r\nimport faviconMention96x96 from 'images/favicon/favicon-mentions-96x96.png';\r\nimport faviconUnread16x16 from 'images/favicon/favicon-unread-16x16.png';\r\nimport faviconUnread24x24 from 'images/favicon/favicon-unread-24x24.png';\r\nimport faviconUnread32x32 from 'images/favicon/favicon-unread-32x32.png';\r\nimport faviconUnread64x64 from 'images/favicon/favicon-unread-64x64.png';\r\nimport faviconUnread96x96 from 'images/favicon/favicon-unread-96x96.png';\r\nimport {Constants} from 'utils/constants';\r\nimport DesktopApp from 'utils/desktop_api';\r\nimport * as UserAgent from 'utils/user_agent';\r\n\r\nenum BadgeStatus {\r\n    Mention = 'Mention',\r\n    Unread = 'Unread',\r\n    None = 'None'\r\n}\r\n\r\ntype Props = {\r\n    intl: IntlShape;\r\n    unreadStatus: BasicUnreadStatus;\r\n    siteName?: string;\r\n    currentChannel?: Channel;\r\n    currentTeam?: Team;\r\n    currentTeammate: Channel | null;\r\n    inGlobalThreads: boolean;\r\n    inDrafts: boolean;\r\n    inScheduledPosts: boolean;\r\n};\r\n\r\nexport class UnreadsStatusHandlerClass extends React.PureComponent<Props> {\r\n    componentDidUpdate(prevProps: Props) {\r\n        this.updateTitle();\r\n        const oldBadgeStatus = this.getBadgeStatus(prevProps.unreadStatus);\r\n        const newBadgeStatus = this.getBadgeStatus(this.props.unreadStatus);\r\n\r\n        if (oldBadgeStatus !== newBadgeStatus) {\r\n            this.updateFavicon(newBadgeStatus);\r\n        }\r\n\r\n        this.updateDesktopApp();\r\n    }\r\n\r\n    get isDynamicFaviconSupported() {\r\n        return UserAgent.isChrome() || UserAgent.isFirefox();\r\n    }\r\n\r\n    getBadgeStatus(unreadStatus: BasicUnreadStatus) {\r\n        if (typeof unreadStatus === 'number') {\r\n            return BadgeStatus.Mention;\r\n        } else if (unreadStatus) {\r\n            return BadgeStatus.Unread;\r\n        }\r\n        return BadgeStatus.None;\r\n    }\r\n\r\n    updateDesktopApp = () => {\r\n        const {unreadStatus} = this.props;\r\n        const {isUnread, unreadMentionCount} = basicUnreadMeta(unreadStatus);\r\n\r\n        DesktopApp.updateUnreadsAndMentions(isUnread, unreadMentionCount);\r\n    };\r\n\r\n    updateTitle = () => {\r\n        const {\r\n            siteName,\r\n            currentChannel,\r\n            currentTeam,\r\n            currentTeammate,\r\n            unreadStatus,\r\n            inGlobalThreads,\r\n            inDrafts,\r\n            inScheduledPosts,\r\n        } = this.props;\r\n        const {formatMessage} = this.props.intl;\r\n\r\n        const currentSiteName = siteName || '';\r\n\r\n        const {isUnread, unreadMentionCount} = basicUnreadMeta(unreadStatus);\r\n\r\n        const mentionTitle = unreadMentionCount > 0 ? `(${unreadMentionCount}) ` : '';\r\n        const unreadTitle = !this.isDynamicFaviconSupported && isUnread ? '* ' : '';\r\n\r\n        if (currentChannel && currentTeam && currentChannel.id) {\r\n            let currentChannelName = currentChannel.display_name;\r\n            if (currentChannel.type === Constants.DM_CHANNEL) {\r\n                if (currentTeammate != null) {\r\n                    currentChannelName = currentTeammate.display_name;\r\n                }\r\n            }\r\n            document.title = `${mentionTitle}${unreadTitle}${currentChannelName} - ${currentTeam.display_name} ${currentSiteName}`;\r\n        } else if (currentTeam && inGlobalThreads) {\r\n            document.title = formatMessage({\r\n                id: 'globalThreads.title',\r\n                defaultMessage: '{prefix}Threads - {displayName} {siteName}',\r\n            }, {\r\n                prefix: `${mentionTitle}${unreadTitle}`,\r\n                displayName: currentTeam.display_name,\r\n                siteName: currentSiteName,\r\n            });\r\n        } else if (currentTeam && inDrafts) {\r\n            document.title = formatMessage({\r\n                id: 'drafts.title',\r\n                defaultMessage: '{prefix}Drafts - {displayName} {siteName}',\r\n            }, {\r\n                prefix: `${mentionTitle}${unreadTitle}`,\r\n                displayName: currentTeam.display_name,\r\n                siteName: currentSiteName,\r\n            });\r\n        } else if (currentTeam && inScheduledPosts) {\r\n            document.title = formatMessage({\r\n                id: 'scheduledPosts.title',\r\n                defaultMessage: '{prefix}Scheduled - {displayName} {siteName}',\r\n            }, {\r\n                prefix: `${mentionTitle}${unreadTitle}`,\r\n                displayName: currentTeam.display_name,\r\n                siteName: currentSiteName,\r\n            });\r\n        } else {\r\n            document.title = formatMessage({id: 'sidebar.team_select', defaultMessage: '{siteName} - Join a team'}, {siteName: currentSiteName || 'Mattermost'});\r\n        }\r\n    };\r\n\r\n    updateFavicon = (badgeStatus: BadgeStatus) => {\r\n        if (!(UserAgent.isFirefox() || UserAgent.isChrome())) {\r\n            return;\r\n        }\r\n\r\n        const link = document.querySelector('link[rel=\"icon\"]');\r\n\r\n        if (!link) {\r\n            return;\r\n        }\r\n        const link16x16 = document.querySelector<HTMLLinkElement>('link[rel=\"icon\"][sizes=\"16x16\"]');\r\n        const link24x24 = document.querySelector<HTMLLinkElement>('link[rel=\"icon\"][sizes=\"24x24\"]');\r\n        const link32x32 = document.querySelector<HTMLLinkElement>('link[rel=\"icon\"][sizes=\"32x32\"]');\r\n        const link64x64 = document.querySelector<HTMLLinkElement>('link[rel=\"icon\"][sizes=\"64x64\"]');\r\n        const link96x96 = document.querySelector<HTMLLinkElement>('link[rel=\"icon\"][sizes=\"96x96\"]');\r\n\r\n        const getFavicon = (url: string): string => ensureString(url);\r\n\r\n        switch (badgeStatus) {\r\n        case BadgeStatus.Mention: {\r\n            link16x16!.href = getFavicon(faviconMention16x16);\r\n            link24x24!.href = getFavicon(faviconMention24x24);\r\n            link32x32!.href = getFavicon(faviconMention32x32);\r\n            link64x64!.href = getFavicon(faviconMention64x64);\r\n            link96x96!.href = getFavicon(faviconMention96x96);\r\n            break;\r\n        }\r\n        case BadgeStatus.Unread: {\r\n            link16x16!.href = getFavicon(faviconUnread16x16);\r\n            link24x24!.href = getFavicon(faviconUnread24x24);\r\n            link32x32!.href = getFavicon(faviconUnread32x32);\r\n            link64x64!.href = getFavicon(faviconUnread64x64);\r\n            link96x96!.href = getFavicon(faviconUnread96x96);\r\n            break;\r\n        }\r\n        default: {\r\n            link16x16!.href = getFavicon(faviconDefault16x16);\r\n            link24x24!.href = getFavicon(faviconDefault24x24);\r\n            link32x32!.href = getFavicon(faviconDefault32x32);\r\n            link64x64!.href = getFavicon(faviconDefault64x64);\r\n            link96x96!.href = getFavicon(faviconDefault96x96);\r\n        }\r\n        }\r\n    };\r\n\r\n    render() {\r\n        return null;\r\n    }\r\n}\r\n\r\nexport default injectIntl(UnreadsStatusHandlerClass);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {Location} from 'history';\r\nimport {connect} from 'react-redux';\r\nimport {withRouter, matchPath} from 'react-router-dom';\r\n\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {getCurrentChannel, getUnreadStatus} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport UnreadsStatusHandler from './unreads_status_handler';\r\n\r\ntype Props = {location: Location};\r\n\r\nfunction mapStateToProps(state: GlobalState, {location: {pathname}}: Props) {\r\n    const config = getConfig(state);\r\n    const currentChannel = getCurrentChannel(state);\r\n    const currentTeammate = (currentChannel && currentChannel.teammate_id) ? currentChannel : null;\r\n    const currentTeam = getCurrentTeam(state);\r\n\r\n    return {\r\n        currentChannel,\r\n        currentTeam,\r\n        currentTeammate,\r\n        siteName: config.SiteName,\r\n        unreadStatus: getUnreadStatus(state),\r\n        inGlobalThreads: matchPath(pathname, {path: '/:team/threads/:threadIdentifier?'}) != null,\r\n        inDrafts: matchPath(pathname, {path: '/:team/drafts'}) != null,\r\n        inScheduledPosts: matchPath(pathname, {path: '/:team/scheduled_posts'}) != null,\r\n    };\r\n}\r\n\r\nexport default withRouter(connect(mapStateToProps)(UnreadsStatusHandler));\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nexport default function EditIcon() {\r\n    const {formatMessage} = useIntl();\r\n    return (\r\n        <i\r\n            className='icon-pencil-outline'\r\n            aria-hidden='true'\r\n            title={formatMessage({id: 'generic_icons.edit', defaultMessage: 'Edit Icon'})}\r\n        />\r\n    );\r\n}\r\n\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React, {useEffect} from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport {AlertCircleOutlineIcon} from '@mattermost/compass-icons/components';\r\n\r\nimport './save_changes_panel.scss';\r\n\r\nexport type SaveChangesPanelState = 'editing' | 'saved' | 'error' | undefined;\r\n\r\nconst CLOSE_TIMEOUT = 1200;\r\n\r\ntype Props = {\r\n    handleSubmit: () => void;\r\n    handleCancel: () => void;\r\n    handleClose: () => void;\r\n    tabChangeError?: boolean;\r\n    state: SaveChangesPanelState;\r\n    customErrorMessage?: string;\r\n    saveButtonText?: React.ReactNode;\r\n    cancelButtonText?: React.ReactNode;\r\n}\r\nfunction SaveChangesPanel({\r\n    handleSubmit,\r\n    handleCancel,\r\n    handleClose,\r\n    tabChangeError = false,\r\n    state = 'editing',\r\n    customErrorMessage,\r\n    saveButtonText,\r\n    cancelButtonText,\r\n}: Props) {\r\n    const panelClassName = classNames('SaveChangesPanel', {error: tabChangeError || state === 'error'}, {saved: state === 'saved'});\r\n    const messageClassName = classNames('SaveChangesPanel__message', {error: tabChangeError || state === 'error'}, {saved: state === 'saved'});\r\n    const cancelButtonClassName = classNames('btn btn-tertiary btn-sm SaveChangesPanel__cancel-btn', {error: tabChangeError || state === 'error'}, {saved: state === 'saved'});\r\n    const saveButtonClassName = classNames('btn btn-primary btn-sm SaveChangesPanel__save-btn', {error: tabChangeError || state === 'error'}, {saved: state === 'saved'});\r\n\r\n    useEffect(() => {\r\n        let timeoutId: NodeJS.Timeout;\r\n        if (state === 'saved') {\r\n            timeoutId = setTimeout(() => {\r\n                handleClose();\r\n            }, CLOSE_TIMEOUT);\r\n        }\r\n\r\n        return () => clearTimeout(timeoutId);\r\n    }, [handleClose, state]);\r\n\r\n    const generateMessage = () => {\r\n        if (customErrorMessage && (tabChangeError || state === 'error')) {\r\n            return customErrorMessage;\r\n        }\r\n\r\n        if (tabChangeError || state === 'editing') {\r\n            return (\r\n                <FormattedMessage\r\n                    id='saveChangesPanel.message'\r\n                    defaultMessage='You have unsaved changes'\r\n                />\r\n            );\r\n        }\r\n\r\n        if (state === 'error') {\r\n            return (\r\n                <FormattedMessage\r\n                    id='saveChangesPanel.error'\r\n                    defaultMessage='There was an error saving your settings'\r\n                />\r\n            );\r\n        }\r\n\r\n        return (\r\n            <FormattedMessage\r\n                id='saveChangesPanel.saved'\r\n                defaultMessage='Settings saved'\r\n            />\r\n        );\r\n    };\r\n\r\n    const generateControlButtons = () => {\r\n        if (state === 'saved') {\r\n            return (\r\n                <div className='SaveChangesPanel__btn-ctr'>\r\n                    <button\r\n                        id='panelCloseButton'\r\n                        type='button'\r\n                        className='btn btn-icon btn-sm'\r\n                        onClick={handleClose}\r\n                    >\r\n                        <i\r\n                            className='icon icon-close'\r\n                        />\r\n                    </button>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        const saveButtonDisabled = tabChangeError || state === 'error';\r\n\r\n        return (\r\n            <div className='SaveChangesPanel__btn-ctr'>\r\n                <button\r\n                    data-testid='SaveChangesPanel__cancel-btn'\r\n                    className={cancelButtonClassName}\r\n                    onClick={handleCancel}\r\n                >\r\n                    {cancelButtonText || (\r\n                        <FormattedMessage\r\n                            id='saveChangesPanel.cancel'\r\n                            defaultMessage='Undo'\r\n                        />\r\n                    )}\r\n                </button>\r\n                <button\r\n                    data-testid='SaveChangesPanel__save-btn'\r\n                    className={saveButtonClassName}\r\n                    onClick={handleSubmit}\r\n                    disabled={saveButtonDisabled}\r\n                >\r\n                    {saveButtonText || (\r\n                        <FormattedMessage\r\n                            id='saveChangesPanel.save'\r\n                            defaultMessage='Save'\r\n                        />\r\n                    )}\r\n                </button>\r\n            </div>\r\n        );\r\n    };\r\n\r\n    return (\r\n        <div className={panelClassName}>\r\n            <p className={messageClassName}>\r\n                <AlertCircleOutlineIcon\r\n                    size={18}\r\n                    color={'currentcolor'}\r\n                />\r\n                {generateMessage()}\r\n            </p>\r\n            {generateControlButtons()}\r\n        </div>\r\n    );\r\n}\r\nexport default SaveChangesPanel;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {ChannelBookmarksState} from '@mattermost/types/channel_bookmarks';\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nconst EMPTY_BOOKMARKS = {};\r\n\r\nexport const getChannelBookmarks = (state: GlobalState, channelId: string): ChannelBookmarksState['byChannelId'][string] => {\r\n    const bookmarks = state.entities.channelBookmarks.byChannelId[channelId];\r\n\r\n    if (!bookmarks) {\r\n        return EMPTY_BOOKMARKS;\r\n    }\r\n\r\n    return bookmarks;\r\n};\r\n\r\nexport const getChannelBookmark = (state: GlobalState, channelId: string, bookmarkId: string) => {\r\n    return getChannelBookmarks(state, channelId)[bookmarkId];\r\n};\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {createSelector} from 'mattermost-redux/selectors/create_selector';\r\nimport {\r\n    isCollapsedThreadsEnabled,\r\n} from 'mattermost-redux/selectors/entities/preferences';\r\n\r\nimport {makeGetDraftsCount} from 'selectors/drafts';\r\n\r\nimport type {SidebarSize} from 'components/resizable_sidebar/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\nimport type {StaticPage} from 'types/store/lhs';\r\n\r\nexport function getIsLhsOpen(state: GlobalState): boolean {\r\n    return state.views.lhs.isOpen;\r\n}\r\n\r\nexport function getLhsSize(state: GlobalState): SidebarSize {\r\n    return state.views.lhs.size;\r\n}\r\n\r\nexport function getCurrentStaticPageId(state: GlobalState): string {\r\n    return state.views.lhs.currentStaticPageId;\r\n}\r\n\r\nexport const getDraftsCount = makeGetDraftsCount();\r\n\r\nexport const getVisibleStaticPages = createSelector(\r\n    'getVisibleSidebarStaticPages',\r\n    isCollapsedThreadsEnabled,\r\n    getDraftsCount,\r\n    (collapsedThreadsEnabled, draftsCount) => {\r\n        const staticPages: StaticPage[] = [];\r\n\r\n        if (collapsedThreadsEnabled) {\r\n            staticPages.push({\r\n                id: 'threads',\r\n                isVisible: true,\r\n            });\r\n        }\r\n\r\n        staticPages.push({\r\n            id: 'drafts',\r\n            isVisible: draftsCount > 0,\r\n        });\r\n\r\n        return staticPages.filter((item) => item.isVisible);\r\n    },\r\n);\r\n"],"names":["deleteBookmark","channelId","id","dispatch","getState","state","connectionId","getConnectionId","async","bookmark","getChannelBookmark","Client4","deleteChannelBookmark","type","ChannelBookmarkTypes","BOOKMARK_DELETED","data","error","Actions","createBookmark","createdBookmark","createChannelBookmark","RECEIVED_BOOKMARK","editBookmark","patch","updated","deleted","updateChannelBookmark","reorderBookmark","newOrder","bookmarks","updateChannelBookmarkSortOrder","RECEIVED_BOOKMARKS","fetchChannelBookmarks","getChannelBookmarks","forceLogoutIfNecessary","logError","setUnreadFilterEnabled","enabled","ActionTypes","SET_UNREAD_FILTER_ENABLED","setDraggingState","SIDEBAR_DRAGGING_SET_STATE","stopDragging","SIDEBAR_DRAGGING_STOP","createCategory","teamId","displayName","channelIds","multiSelectedChannelIds","views","channelSidebar","forEach","indexOf","multiSelectChannelAdd","result","createCategoryRedux","ADD_NEW_CATEGORY_ID","addChannelsInSidebar","categoryId","moveChannelsInSidebar","targetIndex","draggableChannelId","setManualSorting","arguments","length","undefined","categories","getCategoriesForCurrentTeam","displayedChannels","getDisplayedChannels","channelsToMove","targetCategory","find","category","filter","selectedChannel","channel","isDMGM","General","DM_CHANNEL","GM_CHANNEL","CategoryTypes","CUSTOM","FAVORITES","DIRECT_MESSAGES","displayedChannelIds","map","sort","a","b","newIndex","getCategory","filteredChannelIds","makeGetChannelIdsForCategory","removedChannelsAboveInsert","index","shiftedIndex","channel_ids","updatedChannelIds","insertMultipleWithoutDuplicates","previousChannelId","sourceIndex","Math","max","adjustTargetIndexForMove","moveChannelsToCategory","clearChannelSelection","MULTISELECT_CHANNEL_CLEAR","currentChannel","getCurrentChannelId","MULTISELECT_CHANNEL","MULTISELECT_CHANNEL_ADD","multiSelectChannelTo","lastSelected","lastSelectedChannel","allChannelsIdsInOrder","getChannelsInCategoryOrder","indexOfNew","indexOfLast","start","min","end","inBetween","slice","MULTISELECT_CHANNEL_TO","SearchableChannelList","React","getDerivedStateFromProps","props","isSearch","page","constructor","super","_defineProperty","e","target","isEnterKeyPressed","isKeyPressed","Constants","KeyCodes","ENTER","shiftKey","ctrlKey","altKey","classList","contains","click","stopPropagation","this","setState","joiningChannel","handleJoin","isMemberOfChannel","closeModal","ModalIdentifiers","MORE_CHANNELS","_this$props$channelsM","ariaLabel","concat","display_name","purpose","toLowerCase","channelTypeIcon","isArchivedChannel","ArchiveOutlineIcon","size","isPrivateChannel","LockOutlineIcon","GlobeIcon","memberCount","channelsMemberCount","membershipIndicator","intl","formatMessage","defaultMessage","CheckIcon","FormattedMessage","channelPurposeContainerAriaLabel","messages","channelPurpose","channelPurposeContainer","className","AccountOutlineIcon","name","joinViewChannelButtonClass","classNames","joinViewChannelButton","onClick","disabled","Boolean","tabIndex","LoadingWrapper","loading","text","joiningButton","sharedChannelIcon","shared","SharedChannelIndicator","withTooltip","key","role","values","channelName","_this$channelListScro","preventDefault","nextDisabled","nextTimeoutId","setTimeout","nextPage","channelListScroll","current","scrollTo","top","_this$channelListScro2","search","channelSearchValue","filterType","changeFilter","currentTarget","value","doSearch","rememberHideJoinedChannelsChecked","hideJoinedChannelsPreference","tagName","Filter","Archived","Private","Public","componentDidMount","UserAgent","focus","document","addEventListener","onKeyDown","componentWillUnmount","removeEventListener","myChannelMemberships","render","channels","listContent","nextButton","previousButton","LoadingScreen","noMore","MagnifyingGlassSVG","getEmptyStateMessage","noResultsText","pageStart","channelsPerPage","pageEnd","channelsToDisplay","createChannelRow","previousPage","input","QuickInput","ref","placeholder","onInput","handleChange","clearable","onClear","handleClear","checkIcon","color","channelDropdownItems","Menu","filterChange","All","leadingElement","GlobeCheckedIcon","labels","trailingElements","push","menuButton","getFilterLabel","ChevronDownIcon","channelDropdown","children","menu","item","hideJoinedButtonClass","checked","hideJoinedPreferenceCheckbox","handleChecked","CheckboxCheckedIcon","channelCountLabel","channelCount","count","dropDownContainer","_pt","isRequired","defineMessages","injectIntl","BrowseChannels","handleExit","closeEditRHS","actions","openModal","modalId","NEW_CHANNEL_MODAL","dialogType","NewChannelModal","rhsOpen","rhsState","RHSStates","EDIT_HISTORY","closeRightHandSide","force","searchedChannels","serverError","getChannels","then","getChannelsMemberCount","done","_result","currentUserId","teamName","joinChannel","message","getHistory","getRelativeChannelURL","term","clearTimeout","searchTimeoutId","onChange","searching","searchTerm","window","searchAllChannels","team_ids","nonAdminSearch","include_deleted","channelIDsForMemberCount","setSearchResults","team_id","ignoredErr","c","PRIVATE_CHANNEL","OPEN_CHANNEL","delete_at","shouldHideJoinedChannels","getChannelsWithoutJoined","setGlobalItem","StoragePrefixes","HIDE_JOINED_CHANNELS","toString","channelList","archivedChannels","privateChannels","allChannels","localeCompare","allChannelsWithoutJoined","publicChannelsWithoutJoined","archivedChannelsWithoutJoined","privateChannelsWithoutJoined","filterOptions","loadComplete","promises","CHANNELS_CHUNK_SIZE","getArchivedChannels","Promise","all","results","flatMap","channelsRequestStarted","serverErrorState","activeChannels","getActiveChannels","createNewChannelButton","icon","buttonClassName","TeamPermissionGate","permissions","Permissions","CREATE_PUBLIC_CHANNEL","handleNewChannel","localizeMessage","body","handleShowJoinedChannelsPreference","title","GenericModal","onExited","compassDesign","modalHeaderText","headerButton","autoCloseOnConfirmButton","enforceFocus","bodyPadding","getChannelsWithoutArchived","createSelector","getChannelsInCurrentTeam","getArchivedOtherChannels","getPrivateChannelsSelector","connect","team","getCurrentTeam","getGlobalItem","makeGetGlobalItem","getCurrentUserId","getCurrentTeamId","requests","status","RequestStatus","STARTED","getMyChannelMemberships","getRhsState","getIsRhsOpen","getChannelsMemberCountSelector","bindActionCreators","MAX_BOOKMARKS_PER_CHANNEL","BOOKMARK_PERMISSION","ADD_BOOKMARK_PUBLIC_CHANNEL","EDIT_BOOKMARK_PUBLIC_CHANNEL","DELETE_BOOKMARK_PUBLIC_CHANNEL","ORDER_BOOKMARK_PUBLIC_CHANNEL","ADD_BOOKMARK_PRIVATE_CHANNEL","EDIT_BOOKMARK_PRIVATE_CHANNEL","DELETE_BOOKMARK_PRIVATE_CHANNEL","ORDER_BOOKMARK_PRIVATE_CHANNEL","useChannelBookmarkPermission","action","useSelector","getHaveIChannelBookmarkPermission","getChannel","myMembership","getMyChannelMember","channel_id","permission","haveIChannelPermission","useCanUploadFiles","canUploadFiles","getConfig","useCanGetPublicLink","isPublicLinksEnabled","getIsChannelBookmarksEnabled","getFeatureFlagValue","license","getLicense","IsLicensed","useChannelBookmarks","useDispatch","order","useMemo","Object","keys","sort_order","tempOrder","setTempOrder","useState","useEffect","emojis","reduce","_ref","emoji","trimmedEmojiName","loadCustomEmojisIfNeeded","reorder","prevOrder","nextOrder","insertWithoutDuplicates","ChannelMoveToSubMenu","useIntl","getAllChannels","currentTeam","currentCategory","getCategoryInTeamWithChannel","handleMoveToCategory","event","handleMoveToNewCategory","EDIT_CATEGORY","EditCategoryModal","dialogProps","channelIdsToAdd","createSubmenuItemsForCategoryArray","CHANNELS","selectedCategory","StarOutlineIcon","FolderOutlineIcon","FolderMoveOutlineIcon","filterCategoriesBasedOnChannelType","inHeaderDropdown","ChevronRightIcon","menuId","menuAriaLabel","isSubmenuOneOfSelectedChannels","includes","every","getMoveToCategorySubmenuItems","memo","categoryName","isProcessing","timeoutId","renameCategory","currentTeamId","initialCategoryName","editButtonText","helpText","getText","confirmButtonText","handleEnterKeyPress","handleConfirm","handleCancel","isConfirmDisabled","inputComponent","MaxLengthInput","autoFocus","maxLength","LeaveTeamModal","show","handleSubmit","handleHide","leaveTeam","toggleSideBarRightMenu","handleKeyPress","currentUser","numOfPrivateChannels","numOfPublicChannels","modalMessage","UserUtils","roles","num_of_public_channels","num_of_private_channels","strong","chunks","Modal","dialogClassName","onHide","Header","closeButton","Title","componentClass","Body","Footer","getNumOfPrivateChannels","getMyChannels","getNumOfPublicChannels","getCurrentUser","toggleSideBarRightMenuAction","DEFAULT_NUM_PER_PAGE","ListModal","onPageChange","prevPage","loadItems","items","totalCount","numPerPage","renderRows","position","renderRow","paginationRange","startCount","endCount","titleText","titleBarButtonText","titleBarButtonOnClick","href","htmlFor","searchPlaceholderText","onSearchInput","total","onPrev","onNext","SearchShortcut","variant","controlKey","isMac","shortcutKeyVariant","ShortcutKeyVariant","Contrast","ShortcutKey","isDesktopApp","propTypes","CreateNewCategoryMenuItem","otherProps","_objectWithoutProperties","_excluded","handleCreateCategory","useCallback","assign","FolderPlusOutlineIcon","MarkAsReadConfirmModal","numChannels","header","confirm","MarkAsUnreadItem","handleViewCategory","DELETE_CATEGORY","MarkAsUnreadIcon","SidebarCategoryGenericMenu","isMenuOpen","setIsMenuOpen","menuOpen","class","DotsVerticalIcon","menuButtonTooltip","onToggle","isOpen","SidebarCategoryHeaderStatic","wrapEmojis","SidebarCategoryHeader","dragHandleProps","isCollapsed","isCollapsible","isDragging","muted","Reflect","deleteProperty","dragging","isDraggingOver","ChannelMentionBadge","unreadMentions","hasUrgent","badge","urgent","ChannelPencilIcon","hasDraft","draft","currentChannelId","trim","fileInfos","uploadsInProgress","ownProps","getPostDraft","DRAFT","SidebarChannelIcon","isDeleted","SidebarChannelMenu","channelLink","favoriteChannel","isFavorite","isMuted","isUnread","managePrivateChannelMembers","managePublicChannelMembers","readMultipleChannels","markMostRecentPostInChannelAsUnread","muteChannel","onMenuToggle","unfavoriteChannel","unmuteChannel","channelLeaveHandler","isLeaving","useRef","markAsReadUnreadMenuItem","handleMarkAsRead","handleMarkAsUnread","favoriteUnfavoriteMenuItem","handleUnfavoriteChannel","StarIcon","handleFavoriteChannel","muteUnmuteChannelMenuItem","muteChannelText","handleUnmuteChannel","BellOffOutlineIcon","handleMuteChannel","BellOutlineIcon","copyLinkMenuItem","handleCopyLink","copyToClipboard","LinkVariantIcon","addMembersMenuItem","handleAddMembers","CHANNEL_INVITE","ChannelInviteModal","AccountPlusOutlineIcon","leaveChannelMenuItem","DEFAULT_CHANNEL","leaveChannelText","handleLeaveChannel","ExitToAppIcon","isDestructive","ChannelMoveToSubmenu","mapDispatchToProps","member","MANAGE_PUBLIC_CHANNEL_MEMBERS","MANAGE_PRIVATE_CHANNEL_MEMBERS","isFavoriteChannel","isChannelMuted","getSiteURL","SidebarChannelLink","element","labelRef","showTooltip","offsetWidth","scrollWidth","label","ariaLabelPrefix","mark","Mark","ChannelLinkClicked","handleSelectChannel","defaultPrevented","button","cmdOrCtrlPressed","_this$props$channel","enableToolTipIfNeeded","isSharedChannel","remoteNames","fetchChannelRemotes","componentDidUpdate","prevProps","_prevProps$channel","_this$props$channel2","_prevProps$channel2","_this$props$channel3","_this$props$channel4","isChannelSelected","link","firstChannelName","showChannelsTutorialStep","channelsTutorialTip","ChannelsAndDirectMessagesTour","labelElement","WithTooltip","customStatus","teammateId","CustomStatusEmoji","userID","spanStyle","height","emojiStyle","marginTop","marginBottom","opacity","content","Pluggable","pluggableName","handleMenuToggle","selected","Link","getAriaLabel","to","handleChannelClick","unsetEditingPost","getUnreadCount","makeGetChannelUnreadCount","_ownProps$channel","unreadCount","config","enableTutorial","EnableTutorial","tutorialStep","getInt","TutorialTourName","ONBOARDING_TUTORIAL_STEP","channelTourTriggered","OnboardingTaskCategory","OnboardingTasksName","CHANNELS_TOUR","FINISHED","GenericTaskSteps","isOnboardingFlowEnabled","EnableOnboardingFlow","OnboardingTourSteps","CHANNELS_AND_DIRECT_MESSAGES","getRemoteNamesForChannel","mentions","unreadMsgs","showUnread","getFirstChannelName","SidebarBaseChannel","currentTeamName","handleLeavePublicChannel","callback","leaveChannel","handleLeavePrivateChannel","LEAVE_PRIVATE_CHANNEL_MODAL","LeaveChannelModal","channelIcon","SidebarBaseChannelIcon","channelType","SidebarDirectChannel","teammate_id","Preferences","CATEGORY_DIRECT_CHANNEL_SHOW","savePreferences","user_id","leaveDirectChannel","active","redirectChannel","teammate","ProfilePicture","src","getProfilePictureUrl","last_picture_update","is_bot","wrapperClass","newStatusIcon","statusClass","displayname","username","getIcon","remote_id","getUser","getRedirectChannelNameForTeam","SidebarGroupChannel","membersCount","CATEGORY_GROUP_CHANNEL_SHOW","getMemberCount","makeGetGmChannelMemberCount","connector","makeGetChannel","isCurrentChannel","draggingState","getDraggingState","autoSortedCategoryIds","getAutoSortedCategoryIds","isCategoryCollapsed","isCategoryDragged","setChannelRef","isDraggable","channelIndex","isAutoSortedCategory","setShow","setRef","refMethod","handleAnimationStart","animationName","handleAnimationEnd","component","selectedCount","Draggable","draggableId","provided","snapshot","draggable","innerRef","collapsed","expanded","unread","selectedDragging","fadeOnDrop","isDropAnimating","draggingOver","has","noFloat","draggableProps","onAnimationStart","onAnimationEnd","initializeTeam","selectTeam","LocalStorageStore","setPreviousTeamId","getIsUserStatusesConfigEnabled","addVisibleUsersInCurrentChannelAndSelfToStatusPoll","customGroupEnabled","isCustomGroupsEnabled","LDAPGroups","groupsParams","filter_allow_reference","per_page","include_member_count","include_member_ids","include_archived","myGroupsParams","_objectSpread","filter_has_member","getGroupsByUserIdPaginated","getAllGroupsAssociatedToChannelsInTeam","group_constrained","getAllGroupsAssociatedToTeam","getGroups","USER_ID_PAIR_REGEXP","RegExp","onChannelByIdentifierEnter","match","history","path","identifier","params","teamObj","getTeamByName","channelPath","channelsByName","getChannelByName","moreChannelsByName","getOtherChannels","chan","status_code","test","isDirectChannelIdentifier","getPathFromIdentifier","getChannelsNameMapInTeam","getChannelDispatchResult","getChannelByNameAndTeamName","entities","myMembers","membership","getChannelMember","_channel","_channel2","joinPromptResult","joinPrivateChannelPrompt","join","joinChannelDispatchResult","fetchChannelsAndMembers","handleChannelJoinError","goToDirectChannelByUserIds","replace","doChannelChange","goToChannelByChannelName","dispatchResult","goToDirectChannelByUserId","Utils","goToChannelByChannelId","groupId","url","handleError","markGroupChannelOpen","goToGroupChannelByGroupId","user","selectUserByUsername","getUserByUsername","directChannelDispatchRes","openDirectChannelToUserId","goToDirectChannelByUsername","email","selectUserByEmail","getUserByEmail","goToDirectChannelByEmail","userId","selectUser","GlobalActions","defaultChannel","PrivateChannelIntroSvg","_props$width","_props$height","width","viewBox","fill","xmlns","xmlnsXlink","clipPath","d","stroke","strokeOpacity","strokeLinecap","cx","cy","r","transform","fillOpacity","strokeLinejoin","x","y","rx","PublicChannelIntroSvg","SvgComponent","AddMembersButton","totalUsers","usersLimit","pluginButtons","LoadingSpinner","inviteUsers","ADD_USER_TO_TEAM","INVITE_GUEST","LessThanMaxFreeUsers","MoreThanMaxFreeUsers","_ref2","ToggleModalButton","INVITATION","InvitationModal","focusOriginElement","_ref3","ADD_GROUPS_TO_CHANNEL","modal","AddGroupsToChannelModal","isPrivate","ChannelPermissionGate","PluggableIntroButtons","channelMember","channelIsArchived","usePluginVisibilityInSharedChannel","buttons","buttonProps","_buttonProps$action","call","getMyChannelMembership","getChannelIntroPluginButtons","ChannelIntroMessage","_this$props$stats","stats","total_users_count","getTotalUsersStats","fullWidth","locale","channelProfiles","enableUserCreation","isReadOnly","teamIsGroupConstrained","creatorName","teammateName","isMobileView","centeredIntro","toggleFavorite","channelIntroId","pluggableButton","setHeaderButton","createSetHeaderButton","actionButtons","createFavoriteButton","UserProfile","createDMIntroMessage","profiles","channelMembership","currentUserProfile","v","pictures","profile","createNotificationPreferencesButton","getGMIntroMessageSpecificPart","createGMIntroMessage","teamInviteLink","MANAGE_PRIVATE_CHANNEL_PROPERTIES","MANAGE_PUBLIC_CHANNEL_PROPERTIES","INVITE_USER","ADD_GROUPS_TO_TEAM","AddGroupsToTeamModal","ChannelIntroTownSquareSvg","createDefaultIntroMessage","OFFTOPIC_CHANNEL","channelInviteButton","ChannelIntroPublicSvg","createOffTopicIntroMessage","uiName","memberMessage","date","FormattedDate","create_at","month","getMonthLong","day","year","createMessage","purposeMessage","creator","ChannelIntroPrivateSvg","createStandardIntroMessage","gmIntroMessages","NotificationLevel","ALL","DEFAULT","MENTION","NONE","userProfile","_membership$notify_pr","_userProfile$notify_p","channelNotifyProp","notify_props","desktop","userNotifyProp","notifyLevelToUse","EDIT_CHANNEL_HEADER","EditChannelHeaderModal","PencilOutlineIcon","classes","favoriteText","CHANNEL_NOTIFICATIONS","ChannelNotificationsModal","BellRingOutlineIcon","EnableUserCreation","getCurrentChannel","getMyCurrentChannelMembership","getDirectTeammate","creator_id","getTotalUsersStatsSelector","get","CATEGORY_DISPLAY_SETTINGS","CHANNEL_DISPLAY_MODE","CHANNEL_DISPLAY_MODE_DEFAULT","CHANNEL_DISPLAY_MODE_FULL_SCREEN","getCurrentLocale","getProfilesInCurrentChannel","isCurrentChannelFavorite","getDisplayNameByUser","getIsMobileView","PostListRow","blockShortcutReactToLastPostForNonMessages","listId","emitShortcutReactToLastPostFrom","isIdNotPost","Locations","NO_WHERE","isLastPost","shortcutReactToLastPostEmittedFrom","shortcutReactToLastPostEmittedFromCenter","CENTER","previousListId","loadingOlderPosts","loadingNewerPosts","OLDER_MESSAGES_LOADER","NEWER_MESSAGES_LOADER","CHANNEL_INTRO_MESSAGE","LOAD_OLDER_MESSAGES_TRIGGER","LOAD_NEWER_MESSAGES_TRIGGER","PostListRowListIds","PostListUtils","DateSeparator","NewMessageSeparator","separatorId","newMessagesSeparatorActions","exceededLimitChannelId","CenterMessageLock","loadOlderPosts","loadNewerPosts","shouldHideAnimation","hideAnimation","postProps","previousPostId","shouldHighlight","togglePostMenu","CombinedUserActivityPost","location","combinedId","post","PostComponent","firstInaccessiblePostTime","getShortcutReactToLastPostEmittedFrom","getPost","plugins","components","NewMessagesSeparatorAction","getLimitedViews","ScrollToBottomIcon","enableBackground","ScrollToBottomArrows","isScrolling","atBottom","innerWidth","scrolling","HintToast","onDismiss","handleDismiss","CloseIcon","ScrollToBottomToast","jumpToRecentsMessage","UnreadBelowIcon","TOAST_REL_RANGES","RelativeRanges","ToastWrapperClass","_this","ESCAPE","showUnreadToast","hideUnreadToast","showNewMessagesToast","hideNewMessagesToast","showUnreadWithBottomStartToast","hideUnreadWithBottomStartToast","hideArchiveToast","showMessageHistoryToast","updateLastViewedBottomAt","onSearchHintDismiss","since","isToday","Date","Timestamp","useTime","ranges","searchShortcut","focusedPostId","atLatestPost","scrollToNewMessage","changeUrlToRemountChannelView","_this$props$hideScrol","_this$props","scrollToLatestMessages","hideScrollToBottomToast","scrollToUnreadMessages","unreadCountInChannel","prevState","unreadScrollPosition","UNREAD_SCROLL_POSITION_START_FROM_NEWEST","newRecentMessagesCount","countNewMessages","rootPosts","isCollapsedThreadsEnabled","postListIds","channelMarkedAsUnread","initScrollOffsetFromBottom","lastViewedAt","latestPostTimeStamp","lastViewedBottom","isNewMessageLineReached","shouldStartFromBottomWhenUnread","mounted","toastPresent","handleShortcut","updateToastStatus","updateNewMessagesAtInChannel","prevPostsCount","presentPostsCount","getToastToRender","showSearchHintToast","showScrollToBottomToast","unreadToastProps","onClickMessage","showActions","Toast","newMessagesToastText","unreadWithBottomStartToastProps","jumpDirection","showNewMessagesToastOverrides","archiveToastProps","extraClasses","archiveToastText","toasts","onScrollToBottomToastDismiss","hideSearchHintToast","getSearchHintToastText","toastToRender","getNewMessagesIndex","newMessages","withRouter","countUnreadsBelow","getAllPosts","postIds","allPosts","Posts","POST_DELETED","root_id","getRootPosts","obj","preparePostIdsForPostList","makePreparePostIdsForPostList","isManuallyUnread","lastChannelViewTime","getUnreadScrollPositionPreference","getPostIdsInChannel","countCurrentChannelUnreadMessages","ToastWrapper","LatestPostReader","latestPostId","getLatestPostId","latestPost","usePostAriaLabel","postListStyle","padding","virtListStyles","bottom","maxHeight","PostList","showSearchHintThreshold","getShowSearchHintThreshold","opened","dynamicListStyle","willChange","postMenuOpened","itemId","style","basePaddingClass","previousItemId","nextItemId","isDateLine","isStartOfNewMessages","rowStyle","display","getPreviousPostId","changeUnreadChunkTimeStamp","scrollDirection","scrollOffset","scrollUpdateWasRequested","clientHeight","scrollHeight","didUserScrollBackwards","didUserScrollForwards","isOffsetWithInRange","offsetFromBottom","getOffsetFromBottom","shouldLoadNewPosts","atOldestPost","scrollStopAction","fireAfter","SCROLL_DELAY","checkBottom","_this$listRef$current","postsRenderedRange","listRef","_getRangeToRender","canLoadMorePosts","PostRequestTypes","AFTER_ID","showSearchHint","isSearchHintDismissed","updateScrollToBottomToastVisibility","screen","updateAtBottom","isAtBottom","now","isScrollToBottomDismissed","visibleTopItem","topPostId","visibleStartIndex","visibleStopIndex","updateFloatingTimestamp","newMessageLineIndex","onNewMessageLineReached","findIndex","newMessagesSeparatorIndex","offset","scrollToBottom","toggleShouldStartFromBottomWhenUnread","_this$listRef$current2","scrollToItem","_this$listRef$current3","handleSearchHintDismiss","handleScrollToBottomToastDismiss","channelIntroMessage","initScrollCompleted","postListRef","DelayedAction","handleScrollStop","initRangeToRender","postIndex","postId","maxPostsForSlicing","handleWindowResize","EventEmitter","addListener","EventTypes","POST_LIST_SCROLL_TO_BOTTOM","getSnapshotBeforeUpdate","postsAddedAtTop","channelHeaderAdded","_postListNode$parentE","postListNode","previousScrollTop","parentElement","scrollTop","previousScrollHeight","_prevState","postlistScrollHeight","scrollValue","_this$listRef$current4","removeListener","newPostListIds","autoRetryEnable","nextState","FloatingTimestamp","AutoSizer","_ref4","renderToasts","DynamicVirtualizedList","itemData","overscanCountForward","overscanCountBackward","onScroll","initScrollToIndex","innerListStyle","loaderId","correctScrollToBottom","onItemsRendered","scrollToFailed","USER_SCROLL_POSTS_PER_PAGE","POST_CHUNK_SIZE","markAndMeasureChannelSwitchEnd","fresh","PostListLoaded","measureAndReport","Measure","ChannelSwitch","startMark","endMark","canFail","TeamSwitch","TeamLinkClicked","clearMarks","isFirstLoad","isPrefetchingInProcess","loadPostsAround","loadUnreads","syncPostsInChannel","loadLatestPosts","markChannelAsRead","perPage","loadPosts","BEFORE_ID","autoRetriesCount","callLoadPosts","getOldestPostId","hasInaccessiblePosts","extraPagesLoaded","getPostsAfter","getPostsBeforeAutoLoad","oldestPostId","getOldestVisiblePostId","getLatestVisiblePostId","actionsForPostList","getPostsBefore","postsOnLoad","VirtPostList","formattedPostIds","centered","posts","postsInChannel","memoizedGetLatestPostId","memoizeResult","getPostsChunkAroundPost","makeGetPostsChunkAroundPost","chunk","unreadChunkTimeStamp","channelViewState","channelPrefetchStatus","limitedViews","focusedPost","getUnreadPostsChunk","getRecentPostsChunkInChannel","recent","oldest","shouldHideNewMessageIndicator","isPostsChunkIncludingUnreadsPosts","indicateNewMessages","PostView","loaderForChangeOfPostsChunk","requestAnimationFrame","channelLoading","_ownProps$match","last_post_at","isChannelLoading","teamMemberships","_params$identifier","postid","getTeamMemberships","onClickRefresh","reload","InputLoading","updateWaitForLoader","showMessage","setShowMessage","timeout","ChannelHeader","makeAsyncComponent","lazy","FileUploadOverlay","ChannelBookmarks","AdvancedCreatePost","ChannelBanner","ChannelView","updatedState","deferredPostView","createDeferredPostView","goToLastViewedChannel","waitForLoader","channelViewRef","enableWebSocketEventScope","WebSocketClient","updateActiveChannel","canRestrictDirectMessage","restrictDirectMessage","fetchIsRestrictedDM","createPost","deactivatedChannel","onClickCloseChannel","missingChannelRole","onUpdateInputShowLoader","DeferredPostView","overlayType","DropOverlayIdCenterChannel","isChannelBookmarksEnabled","deferComponentRender","enableOnboardingFlow","FeatureFlagWebSocketEventScope","_getMyChannelMembersh","split","some","getRoles","isMissingChannelRoles","isDeactivatedDirectChannel","isCloud","Cloud","teamUrl","getCurrentRelativeTeamUrl","isFirstAdmin","RestrictDirectMessage","restrictedDMs","t","i","Symbol","toPrimitive","TypeError","String","_toPrimitive","_toPropertyKey","defineProperty","enumerable","configurable","writable","ChannelIdentifierRouter","replaceUrlTimeout","channelUrl","PERMALINK_FADEOUT","replaceUrlIfPermalink","MobileChannelHeader","GlobalThreads","Drafts","PermalinkView","PlaybookRunner","CenterChannel","returnTo","lastReturnTo","nextProps","pathname","getProfiles","lastChannelPath","lhsOpen","rhsMenuOpen","Switch","Route","ID_PATH_PATTERN","TEAM_NAME_PATH_PATTERN","IDENTIFIER_PATH_PATTERN","SCHEDULED_POST_URL_SUFFIX","Redirect","mapStateToProps","lastViewedType","getLastViewedTypeByTeamName","getLastViewedChannelNameByTeamName","previousTeamId","getPreviousTeamId","previousTeamLastViewedType","getPreviousTeamLastViewedType","PreviousViewedTypes","THREADS","getIsLhsOpen","getIsRhsMenuOpen","useLocation","useHistory","actionMap","open_invitation_modal","searchParams","URLSearchParams","delete","Priority","PrefetchLimits","prefetchQueue","unreadChannels","memberships","collapsedThreads","unreadChannelsCount","high","medium","low","unreadMax","mentionMax","mention_count_root","mention_count","mark_unread","queue","PQueue","concurrency","DataPrefetch","delay","unreadChannel","random","prefetchChannelPosts","prefetchRequestStatus","prefetchQueueObj","priority","hasOwn","priorityQueue","add","prefetchPosts","sidebarLoaded","loadProfilesForSidebar","prefetchTimeout","clear","prefetchData","isSidebarLoaded","lastUnreadChannel","getUnreadChannels","ResizableLhs","containerRef","ResizableDivider","globalCssVar","CssVarKeyForResizable","LHS","defaultWidth","DEFAULT_LHS_WIDTH","dir","ResizeDirection","LEFT","SidebarTeamMenu","_props$currentTeam","havePermissionToCreateTeam","haveISystemPermission","CREATE_TEAM","havePermissionToManageTeam","haveICurrentTeamPermission","MANAGE_TEAM","havePermissionToAddUserToTeam","havePermissionToInviteGuest","isCloudLicense","isGuestAccessEnabled","EnableGuestAccounts","isTeamGroupConstrained","isLicensedForLDAPGroups","experimentalPrimaryTeam","ExperimentalPrimaryTeam","joinableTeams","getJoinableTeamIds","haveMoreJoinableTeams","canJoinAnotherTeam","tooltipText","description","InvitePeopleMenuItem","AddGroupsToTeamMenuItem","TeamSettingsMenuItem","ManageViewMembersMenuItem","ManageGroupsMenuItem","teamID","LeaveTeamMenuItem","JoinAnotherTeamMenuItem","CreateTeamMenuItem","LearnAboutTeamsMenuItem","PluginMenuItems","handleClick","AccountMultiplePlusOutlineIcon","TEAM_SETTINGS","TeamSettingsModal","SettingsOutlineIcon","havePermissionToRemoveUserFromTeam","REMOVE_USER_FROM_TEAM","havePermissionToManageTeamRoles","MANAGE_TEAM_ROLES","TEAM_MEMBERS","TeamMembersModal","AccountMultipleOutlineIcon","MANAGE_TEAM_GROUPS","TeamGroupsManageModal","MonitorAccountIcon","LEAVE_TEAM","MessagePlusOutlineIcon","cloudSubscription","getCloudSubscription","subscriptionProduct","getSubscriptionProduct","isFreeTrial","is_free_trial","isStarterFree","sku","CloudProducts","STARTER","usageDeltas","useGetUsageDeltas","isTeamsLimitReached","teams","isTeamCreateRestricted","PlusIcon","RestrictedIndicatorForCreateTeam","RestrictedIndicator","feature","MattermostFeatures","CREATE_MULTIPLE_TEAMS","minimumPlanRequiredForFeature","LicenseSkus","Professional","blocked","tooltipMessage","titleAdminPreTrial","messageAdminPreTrial","trialLength","FREEMIUM_TO_ENTERPRISE_TRIAL_LENGTH_DAYS","titleAdminPostTrial","messageAdminPostTrial","titleEndUser","messageEndUser","MATTERMOST_ACADEMY_TEAM_TRAINING_LINK","open","LightbulbOutlineIcon","pluginInMainMenu","getMainMenuPluginComponents","pluginMenuItems","plugin","SidebarHeader","canCreateChannel","canJoinPublicChannel","SidebarBrowseOrAddChannelMenu","onCreateNewChannelClick","showNewChannelModal","onBrowseChannelClick","showMoreChannelsModal","onOpenDirectMessageClick","handleOpenDirectMessagesModal","canCreateCustomGroups","onCreateNewUserGroupClick","showCreateUserGroupModal","unreadFilterEnabled","onCreateNewCategoryClick","showCreateCategoryModal","onInvitePeopleClick","invitePeopleModal","CHANNEL_MODE","QuickSwitchModal","switchBox","textbox","getTextbox","activeElement","focusTextbox","focusPostTextbox","querySelector","_this$props$onExited","focusElement","shouldShowLoadingSpinner","mode","joinChannelById","switchToChannel","MENTION_MORE_CHANNELS","hideOnSelect","suggestions","suggestionItems","flattenItems","loadingPropPresent","isItemLoaded","pretext","matchedPretext","hasSuggestions","providers","channelProviders","help","modalSubheaderText","hideOnCancel","SuggestionBox","setSwitchBoxRef","onItemSelected","listComponent","SuggestionList","listPosition","completeOnTab","spellCheck","delayInputUpdate","openWhenEmpty","onSuggestionsReceived","handleSuggestionsReceived","forceSuggestionsWhenBlur","shouldSearchCompleteText","NoResultsIndicator","NoResultsVariant","Search","titleValues","SwitchChannelProvider","disableTooltip","enableTooltip","shortcut","default","ShortcutKeys","ctrl","shift","mac","cmd","ChannelFilter","toggleUnreadFilter","Keyboard","U","handleUnreadFilterKeyPress","unreadsAriaLabel","getMyTeams","hasMultipleTeams","isUnreadFilterEnabled","ChannelNavigator","QUICK_SWITCH","M","L","K","toggleQuickSwitchModal","isQuickSwitcherOpen","handleQuickSwitchKeyPress","showUnreadsCategory","openQuickSwitcher","shouldShowUnreadsCategory","isModalOpen","DeleteCategoryModal","deleteCategory","confirmButtonClassName","category_name","cancel","paginationCount","paginationNext","paginationPrev","SidebarCategoryMenu","getUnreadsIdsForCategory","makeGetUnreadIdsForCategory","unreadsIds","muteUnmuteCategoryMenuItem","toggleCategoryMute","setCategoryMuted","deleteCategoryMenuItem","renameCategoryMenuItem","handleDeleteCategory","handleRenameCategory","TrashCanOutlineIcon","handleSortChannels","sorting","setCategorySorting","sortChannelsSelectedValue","sortChannelsIcon","FormatListBulletedIcon","CategorySorting","Alphabetical","SortAlphabeticalAscendingIcon","Recency","ClockOutlineIcon","sortChannelsMenuItem","Manual","markAsReadMenuItem","MarkAsReadMenuItem","SidebarCategorySortingMenu","selectedDmNumber","getVisibleDmGmLimit","handleSortDirectMessages","sortDirectMessagesIcon","sortDirectMessagesSelectedValue","sortDirectMessagesMenuItem","showMessagesCountSelectedValue","showMessagesCountMenuItem","DM_AND_GM_SHOW_COUNTS","dmGmShowCount","handlelimitVisibleDMsGMs","number","CATEGORY_SIDEBAR_SETTINGS","LIMIT_VISIBLE_DMS_GMS","openDirectMessageMenuItem","isAddChannelCtaDropdownOpen","addChannelCtaDropdown","AddChannelsCtaButton","touchedAddChannelsCtaButton","getBool","TOUCHED","Touched","ADD_CHANNELS_CTA","canCreatePublicChannel","haveICurrentChannelPermission","CREATE_PRIVATE_CHANNEL","JOIN_PUBLIC_CHANNELS","isAddChannelCtaOpen","openAddChannelsCtaOpen","ADD_CHANNEL_CTA_DROPDOWN_TOGGLE","setAddChannelCtaDropdown","buttonClass","addChannelsButton","btnCallback","storePreferencesAndTrackEvent","MenuWrapper","renderDropdownItems","joinPublicChannel","createChannel","ItemAction","Group","browseChannelsAction","InviteMembersButton","SidebarCategory","_this$categoryTitleRe","categoryTitleRef","handleA11yKeyDown","a11yKeyDownRegistered","_this$categoryTitleRe2","handleCollapse","SidebarChannel","DraggingStateTypes","CATEGORY","setCategoryCollapsed","newDropBoxRef","remove","handleOpenMoreDirectChannelsModal","nativeEvent","CHANNEL","DM","isNewCategory","isDragDisabled","onTransitionEnd","removeAnimation","_this$categoryTitleRe3","_this$categoryTitleRe4","A11yCustomEventTypes","ACTIVATE","handleA11yActivateEvent","DEACTIVATE","handleA11yDeactivateEvent","_this$categoryTitleRe5","_this$categoryTitleRe6","categoryIndex","renderedChannels","renderChannel","categoryMenu","newLabel","addHelpLabel","KeyboardShortcutSequence","KEYBOARD_SHORTCUTS","navDMMenu","hideDescription","isInsideTooltip","categoryNames","disableInteractiveElementBlocking","inviteMembersButton","addChannelsCtaButton","dropDisabled","isDropDisabled","menuIsOpen","capture","DraggingStates","CAPTURE","Droppable","droppableId","droppableProvided","droppableSnapshot","droppableProps","renderNewDropBox","showPlaceholder","direct_messages","favorites","getChannelIdsForCategory","makeGetFilteredChannelIdsForCategory","isAdmin","DraftsLink","GlobalThreadsLink","UnreadChannelIndicator","UnreadChannels","SidebarList","staticPages","channelRefs","set","unreadChannelIds","spring","_scrollTo","val","getCurrentValue","scrollbar","scrollToChannel","getFirstUnreadChannel","getLastUnreadChannel","scrollingToUnread","offsetTop","offsetHeight","margin","showTopUnread","scrollEnd","getDisplayedChannelIds","scrollToPosition","showBottomUnread","scrollAnimation","setCurrentValue","setAtRest","setEndValue","firstUnreadChannel","firstUnreadElement","lastUnreadElement","getFirstUnreadChannelFromChannelIdArray","reverse","switchToChannelById","switchToLhsStaticPage","metaKey","UP","DOWN","staticPageIds","getDisplayedStaticPageIds","allIds","curSelectedId","currentStaticPageId","curIndex","nextIndex","nextId","mod","navigateById","allChannelIds","unshift","hasUnreadThreads","direction","findNextUnreadChannelId","nextChannelId","newCategoryIds","debounce","updateUnreadIndicators","before","droppable","querySelectorAll","draggingChannels","MIXED_CHANNELS","BEFORE","initial","onDragStart","DURING","onDragEnd","reason","destination","moveCategory","Map","animate","SpringSystem","createSpring","setOvershootClampingEnabled","onSpringUpdate","handleScrollAnimationUpdate","navigateChannelShortcut","navigateUnreadChannelShortcut","close","unreadsCategory","renderedCategories","renderCategory","DragDropContext","onBeforeDragStart","onBeforeCapture","above","below","scrollToFirstUnreadChannel","extraClass","scrollToLastUnreadChannel","Scrollbars","_getThreadCountsInCur","getThreadCountsInCurrentTeam","total_unread_threads","getUnreadChannelIds","getCurrentStaticPageId","getVisibleStaticPages","MobileSidebarHeader","MoreDirectChannels","CreateUserGroupsModal","KeyboardShortcutsModal","UserSettingsModal","Sidebar","FORWARD_SLASH","isKeyBoardShortcutModalOpen","KEYBOARD_SHORTCUTS_MODAL","A","USER_SETTINGS","isContentProductSettings","showDirectChannelsModal","USER_GROUPS_CREATE","hideMoreDirectChannelsModal","showMoreDirectChannelsModal","moreDirectChannelsModal","onModalDismissed","isExistingChannel","fetchMyCategories","handleClickClearChannelSelection","handleKeyDownEvent","canCreatePrivateChannel","renderModals","CREATE_CUSTOM_GROUP","PostsChannelResetWatcher","isCRTEnabled","loaded","resetReloadPostsInChannel","ProductNoticesModal","ResetStatusModal","MobileSidebarRight","BODY_CLASS_FOR_CHANNEL","ChannelController","enabledUserStatuses","_navigator$userAgentD","isMsBrowser","isInternetExplorer","isEdge","navigator","platform","userAgentData","bodyClass","getClassnamesForBody","cleanUpStatusAndProfileFetchingPoll","loadStatusesIntervalId","setInterval","STATUS_INTERVAL","clearInterval","CRTPostsChannelResetWatcher","QueryParamActionController","UnreadsStatusHandler","shouldRenderCenterChannel","BackstageController","makeAsyncPluggableComponent","_StyledPluggable","_styled","withConfig","gridArea","TeamController","_props$plugins","teamNameParam","useParams","initialChannelsLoaded","setInitialChannelsLoaded","setTeam","getTeamFromTeamList","teamsList","contentFlaggingEnabled","contentFlaggingFeatureEnabled","blurTime","lastTime","joinTeamOrRedirect","joinedOnFirstLoad","joinedTeam","joinTeam","_user$id","_user$roles","userRoles","setUserId","setUserRoles","useTelemetryIdentitySync","InitialLoadingScreen","stop","DesktopApp","reactAppInitialized","fetchAllMyChannelMembers","fetchAllMyTeamsChannels","fetchAllChannels","disableWakeUpReconnectHandler","wakeUpIntervalId","currentTime","console","log","reconnect","handleFocus","isActive","markAsReadOnFocus","disableRefetchingOnBrowserFocus","handleBlur","unsetActiveChannelOnServer","handleKeydown","replyTextbox","postTextbox","getElementById","getTeamContentFlaggingStatus","browserIsIosSafari","isIosSafari","iNoBounce","setTeamIdJoinedOnLoad","teamsListDependency","RESERVED_TEAM_NAMES","teamFromTeamNameParam","initTeamOrRedirect","mfaRequired","teamLoaded","route","pluggableId","_teamsList$find","teamInList","teamname","teamByNameResult","isSuccess","addUserToTeamResult","addUserToTeam","Error","NeedsTeamComponent","DisableRefetchingOnBrowserFocus","DisableWakeUpReconnectHandler","selectedThreadId","getSelectedThreadIdInCurrentTeam","selectedPostId","getSelectedPostId","checkIfMFARequired","showConfirmModal","member_count","pageNumber","getGroupsAssociatedToTeam","groups","totalGroupCount","listModal","unlinkGroupSyncable","SyncableType","Team","isTeamAdmin","patchGroupSyncable","scheme_admin","getMyTeamMembers","groupsAvatar","alt","Nbsp","num","DropdownIcon","openLeft","setTeamMemberStatus","onClickRemoveGroup","titleButtonOnClick","ConfirmModal","onConfirm","handleDeleteConfirmed","onCancel","handleDeleteCanceled","TeamMembersDropdown","me","handleDemote","updateTeamMemberSchemeRoles","teamMember","getTeamMember","getMyTeamUnreads","removeUserFromTeamAndGetStats","showDemoteModal","currentRoles","isGuest","isSystemAdmin","showMakeMember","showMakeAdmin","canRemoveFromTeam","makeDemoteModal","confirmButton","handleDemoteSubmit","handleDemoteCancel","openUp","menuRemove","handleRemoveFromTeam","menuMakeAdmin","handleMakeAdmin","menuMakeMember","handleMakeMember","anchorOrigin","vertical","horizontal","transformOrigin","getTeamStats","getChannelStats","updateUserActive","MemberListTeam","loadProfilesAndTeamMembers","getTeamMembers","DEFAULT_MAX_USERS_PER_TEAM","Teams","SORT_USERNAME_OPTION","exclude_deleted_users","setModalSearchTerm","PROFILE_CHUNK_SIZE","loadStatusesForProfilesList","loadTeamMembersForProfilesList","searchProfiles","membersLoaded","SEARCH_TIMEOUT_MILLISECONDS","teamMembersDropdown","canManageTeamMembers","teamMembers","users","actionUserProps","usersToDisplay","SearchableUserList","usersPerPage","totalTeamMembers","focusOnMount","haveITeamPermission","modalSearch","searchProfilesInCurrentTeam","getProfilesInCurrentTeam","getCurrentTeamStats","active_member_count","getMembersInCurrentTeam","onLoad","_this$props$currentTe","_this$props$currentTe2","teamDisplayName","modalHeaderTextId","ariaLabelledby","handleInvitePeople","modalLocation","DropdownIndicator","styles","control","baseStyles","background","multiValue","borderRadius","alignItems","multiValueLabel","fontFamily","fontSize","fontWeight","lineHeight","letterSpacing","multiValueRemove","marginRight","handleNewSelection","isClearable","inputValue","setInputValue","handleTextEnter","handleKeyDown","selectValues","singleValue","CreatableSelect","isMulti","onInputChange","onBlur","AllowedDomainsSelect","allowedDomains","setAllowedDomains","setHasChanges","setSaveChangesPanelState","showAllowedDomains","setShowAllowedDomains","handleEnableAllowedDomains","updateAllowedDomains","domain","handleOnChangeDomains","allowedDomainsOptions","CheckboxSettingItem","inputFieldTitle","descriptionAboveContent","inputFieldData","inputFieldValue","SelectTextInput","translations","OpenInviteDescriptionError","InviteSectionInput","_team$invite_id","regenerateTeamInviteId","canInviteTeamMembers","inviteId","setInviteId","invite_id","inviteIdError","setInviteIdError","handleRegenerateInviteId","inviteSectionInput","Input","RefreshIcon","BaseSettingItem","OpenInvite","isGroupConstrained","allowOpenInvite","setAllowOpenInvite","groupConstrainedContent","msg","ExternalLink","generateAllowedDomainOptions","patchTeam","_team$allow_open_invi","collapseModal","hasChangeTabError","hasChanges","setHasChangeTabError","setJustSaved","allowed_domains","allow_open_invite","saveChangesPanelState","handleAllowedDomainsSubmit","handleOpenInviteSubmit","updateOpenInvite","handleClose","_team$allow_open_invi2","collapseModalHandler","handleSaveChanges","allowedDomainSuccess","openInviteSuccess","ModalSection","SaveChangesPanel","tabChangeError","handleDescriptionChanges","clientError","updateDescription","descriptionSectionInput","containerClassName","MAX_TEAMDESCRIPTION_LENGTH","handleNameChanges","updateName","nameSectionInput","MAX_TEAMNAME_LENGTH","TeamPictureSection","file","onFileChange","onRemove","selectInput","image","setImage","orientationStyles","setOrientationStyles","teamImageSource","imageURLForTeam","handleInputFile","previewBlob","URL","createObjectURL","reader","FileReader","onload","orientation","FileUtils","readAsArrayBuffer","setPicture","teamPictureSection","teamImage","imageStyles","backgroundImage","backgroundSize","backgroundRepeat","charAt","toUpperCase","accept","ACCEPT_STATIC_IMAGE","EditIcon","ACCEPTED_TEAM_IMAGE_TYPES","Required","TeamNameRestrictions","MIN_TEAMNAME_LENGTH","TeamIconInvalidFileType","TeamIconTooLarge","TeamIconError","_config$MaxFileSize","maxFileSize","parseInt","MaxFileSize","getTeam","removeTeamIcon","setTeamIcon","_team$display_name2","setName","setDescription","teamIconFile","setTeamIconFile","setLoading","imageClientError","setImageClientError","nameClientError","setNameClientError","handleNameDescriptionSubmit","handleTeamIconSubmit","nameDescriptionSuccess","_team$display_name","handleTeamIconRemove","updateTeamIcon","files","handleCollapseModal","modalSectionContent","TeamNameSection","TeamDescriptionSection","TeamSettings","activeTab","InfoTab","AccessTab","SettingsSidebar","canInviteUsers","setActiveTab","hasBeenWarned","setHasBeenWarned","justSaved","modalBodyRef","updateTab","tab","el","ReactDOM","closest","tabs","iconTitle","fallback","BadgeStatus","UnreadsStatusHandlerClass","unreadStatus","unreadMentionCount","basicUnreadMeta","updateUnreadsAndMentions","siteName","currentTeammate","inGlobalThreads","inDrafts","inScheduledPosts","currentSiteName","mentionTitle","unreadTitle","isDynamicFaviconSupported","currentChannelName","prefix","badgeStatus","link16x16","link24x24","link32x32","link64x64","link96x96","getFavicon","ensureString","Mention","faviconMention16x16","faviconMention24x24","faviconMention32x32","faviconMention64x64","faviconMention96x96","Unread","faviconUnread16x16","faviconUnread24x24","faviconUnread32x32","faviconUnread64x64","faviconUnread96x96","faviconDefault16x16","faviconDefault24x24","faviconDefault32x32","faviconDefault64x64","faviconDefault96x96","updateTitle","oldBadgeStatus","getBadgeStatus","newBadgeStatus","updateFavicon","updateDesktopApp","None","SiteName","getUnreadStatus","matchPath","customErrorMessage","saveButtonText","cancelButtonText","panelClassName","saved","messageClassName","cancelButtonClassName","saveButtonClassName","AlertCircleOutlineIcon","generateControlButtons","saveButtonDisabled","EMPTY_BOOKMARKS","channelBookmarks","byChannelId","bookmarkId","lhs","getDraftsCount","makeGetDraftsCount","collapsedThreadsEnabled","draftsCount","isVisible"],"sourceRoot":""}