"use strict";(self.webpackChunkmattermost_webapp=self.webpackChunkmattermost_webapp||[]).push([[8508],{12423:(e,s,a)=>{a.r(s),a.d(s,{default:()=>K}),a(3188),a(30973),a(17046),a(36169),a(10844),a(43813),a(76685),a(59297),a(29206);var t=a(71633),r=a.n(t),n=a(32858),o=a.n(n),i=a(36418),l=a.n(i),u=a(14778),c=a(37270),d=a(81911),m=a(23739),p=a(17085),g=a(40693),b=a(26614),f=a(77440),w=a(7430),h=a(78546),E=a(91767),y=a(61185),v=a(46859),_=a(97508),M=a(77212),S=a(44553),N=a(82587),L=a(93692),A=a(17518),k=a(11610),U=a(60824),x=a(65844),C=a(1396),R=a(18515),T=a(14309),O=a(42970),P=a(74381),I=a(24767),Y=a(44995),B=a(33081);const D=["id","ariaLabel","text"],G=function(e){const{id:s,ariaLabel:a,text:t}=e,r=function(e,s){if(null==e)return{};var a,t,r=function(e,s){if(null==e)return{};var a={};for(var t in e)if({}.hasOwnProperty.call(e,t)){if(-1!==s.indexOf(t))continue;a[t]=e[t]}return a}(e,s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(t=0;t<n.length;t++)a=n[t],-1===s.indexOf(a)&&{}.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}(e,D);return l().createElement("div",{className:"check-input"},l().createElement("input",Object.assign({},r,{id:s,"aria-label":a,"data-testid":s,type:"checkbox"})),l().createElement("label",{className:"text",htmlFor:s},l().createElement("span",null,t)))};var W=a(98566),H=a(42392),F=a(78451),q=a(79135),z=a(4715),j=a(85873);const K=e=>{var s,a;let{onCustomizeHeader:t}=e;const n=(0,u.useIntl)(),{formatMessage:D}=n,K=(0,c.useDispatch)(),X=(0,d.useHistory)(),{search:Z}=(0,d.useLocation)(),J=new URLSearchParams(Z),V=null!==(s=J.get("t"))&&void 0!==s?s:"",$=null!==(a=J.get("id"))&&void 0!==a?a:"",Q=J.get("d"),ee=Q?JSON.parse(Q):{},{email:se,name:ae}=ee,te=(0,c.useSelector)(b.zj),{EnableOpenServer:re,EnableUserCreation:ne,NoAccounts:oe,EnableSignUpWithEmail:ie,EnableSignUpWithGitLab:le,EnableSignUpWithGoogle:ue,EnableSignUpWithOffice365:ce,EnableSignUpWithOpenId:de,EnableLdap:me,EnableSaml:pe,SamlLoginButtonText:ge,LdapLoginFieldName:be,SiteName:fe,CustomDescriptionText:we,GitLabButtonText:he,GitLabButtonColor:Ee,OpenIdButtonText:ye,OpenIdButtonColor:ve,EnableCustomBrand:_e,CustomBrandText:Me,TermsOfServiceLink:Se,PrivacyPolicyLink:Ne}=te,{IsLicensed:Le}=(0,c.useSelector)(b.Ay),Ae=Boolean((0,c.useSelector)(w.WR)),ke=(0,c.useSelector)(f.Pu),Ue=(0,c.useSelector)((e=>$||Ae||!V?void 0:(0,M.Bf)(e,V,null))),xe=(0,i.useRef)(null),Ce=(0,i.useRef)(null),Re=(0,i.useRef)(null),Te="true"===Le,Oe="true"===ne,Pe=Oe&&"true"===ie,Ie=Oe&&"true"===le,Ye=Oe&&"true"===ue,Be=Oe&&"true"===ce,De=Oe&&"true"===de,Ge="true"===me,We="true"===pe,He="true"===_e,Fe=!($||V||"true"===re||"true"===oe||Oe),[qe,ze]=(0,i.useState)(null!=se?se:""),[je,Ke]=(0,i.useState)(""),[Xe,Ze]=(0,i.useState)(""),[Je,Ve]=(0,i.useState)(Boolean($)),[$e,Qe]=(0,i.useState)(!1),[es,ss]=(0,i.useState)(""),[as,ts]=(0,i.useState)(""),[rs,ns]=(0,i.useState)(""),[os,is]=(0,i.useState)(!1),[ls,us]=(0,i.useState)(""),[cs,ds]=(0,i.useState)(null!=ae?ae:""),[ms,ps]=(0,i.useState)(null),[gs,bs]=(0,i.useState)(!1),[fs,ws]=(0,i.useState)(!1),[hs,Es]=(0,i.useState)(!1),ys=(0,N.A)(),vs=Ie||Be||Ye||De||Ge||We,_s=Boolean(es||as||rs||ls||ms),Ms=Boolean(qe&&je&&Xe)&&!_s&&!Je,Ss=(0,c.useSelector)(b.OG),{error:Ns}=(0,q.s)("",Ss,n),[Ls,As]=(0,i.useState)(""),ks=(0,i.useCallback)((()=>{X.goBack()}),[X]),Us=e=>{let s,{server_error_id:a,message:t}=e;"store.sql_user.save.max_accounts.app_error"!==a&&"api.team.add_user_to_team_from_invite.guest.app_error"!==a||(s=t),us(s||D({id:"signup_user_completed.invalid_invite.title",defaultMessage:"This invite link is invalid"})),Ve(!1)},xs=(0,i.useCallback)((()=>l().createElement(U.A,{className:"signup-body-alternate-link",alternateMessage:D({id:"signup_user_completed.haveAccount",defaultMessage:"Already have an account?"}),alternateLinkPath:"/login",alternateLinkLabel:D({id:"signup_user_completed.signIn",defaultMessage:"Log in"})})),[]),Cs=o()((()=>{bs(window.innerWidth<1200)}),100),Rs=e=>s=>{(0,z.y3)()&&(s.preventDefault(),As(e),X.push("/signup_user_complete/desktop".concat(Z)))};if((0,i.useEffect)((()=>(K((0,y.tc)("team")),Cs(),window.addEventListener("resize",Cs),Z&&(($||V)&&Ae?(async(e,s)=>{const{data:a,error:t}=await K((0,v.cs)(e,s));a?X.push("/"+a.name+"/channels/".concat(F.YM.DEFAULT_CHANNEL)):t&&Us(t)})(V,$):$?(async e=>{const{data:s,error:a}=await K((0,m.Jb)(e));s?(us(""),ds(s.name)):a&&Us(a),Ve(!1)})($):Ae&&(ke?X.push("/"):(0,E.tc)())),()=>{window.removeEventListener("resize",Cs)})),[]),(0,i.useEffect)((()=>{document.title=D({id:"signup.title",defaultMessage:"Create Account | {siteName}"},{siteName:fe||"Mattermost"})}),[D,fe]),(0,i.useEffect)((()=>{t&&t({onBackButtonClick:ks,alternateLink:gs?xs():void 0})}),[t,ks,gs,xs,Z]),(0,i.useEffect)((()=>{hs&&(es&&xe.current?xe.current.focus():as&&Ce.current?Ce.current.focus():rs&&Re.current&&Re.current.focus(),Es(!1))}),[es,as,rs,hs]),Je)return l().createElement(C.A,null);const Ts=()=>{is(!0)},Os=()=>He?Me?l().createElement("div",{className:"signup-body-custom-branding-markdown"},l().createElement(R.A,{message:Me,options:{mentionHighlight:!1}})):null:l().createElement("p",{className:"signup-body-message-subtitle"},D({id:"signup_user_completed.subtitle",defaultMessage:"Create your Mattermost account to start collaborating with your team"})),Ps=e=>{let{target:{value:s}}=e;ze(s),Ds(),es&&ss("")},Is=e=>{let{target:{value:s}}=e;Ke(s),Ds(),as&&ts("")},Ys=e=>{let{target:{value:s}}=e;Ze(s),Ds(),rs&&ns("")},Bs=async()=>{const e=new URLSearchParams(Z).get("redirect_to");await K((0,p.BP)()),V&&(0,y.X2)(V,JSON.stringify({usedBefore:!0})),e?X.push(e):ke?X.push("/"):(0,E.tc)()},Ds=()=>{ps(null)},Gs=async e=>{if(e.preventDefault(),Qe(!0),Es(!0),(()=>{var e,s,a,t;let r=!0;const o=null===(e=xe.current)||void 0===e?void 0:e.value.trim();o?(0,h.xf)(o)||(ss(D({id:"signup_user_completed.validEmail",defaultMessage:"Please enter a valid email address"})),r=!1):(ss(D({id:"signup_user_completed.required",defaultMessage:"This field is required"})),r=!1);const i=null===(s=Ce.current)||void 0===s?void 0:s.value.trim().toLowerCase();if(i){const e=(0,j.Bs)(i);if(e){let s="";s=e.id===F.vJ.RESERVED_NAME?D({id:"signup_user_completed.reserved",defaultMessage:"This username is reserved, please choose a new one."}):D({id:"signup_user_completed.usernameLength",defaultMessage:"Usernames have to begin with a lowercase letter and be {min}-{max} characters long. You can use lowercase letters, numbers, periods, dashes, and underscores."},{min:F.YM.MIN_USERNAME_LENGTH,max:F.YM.MAX_USERNAME_LENGTH}),ts(s),r=!1}}else ts(D({id:"signup_user_completed.required",defaultMessage:"This field is required"})),r=!1;const l=null!==(a=null===(t=Re.current)||void 0===t?void 0:t.value)&&void 0!==a?a:"",{error:u}=(0,q.s)(l,Ss,n);return u&&(ns(u),r=!1),r})()){var s,a,t;ts(""),ss(""),ns(""),us(""),Qe(!0);const e={email:null===(s=xe.current)||void 0===s?void 0:s.value.trim(),username:null===(a=Ce.current)||void 0===a?void 0:a.value.trim().toLowerCase(),password:null===(t=Re.current)||void 0===t?void 0:t.value},r=new URLSearchParams(Z).get("redirect_to"),{data:n,error:o}=await K((0,p.kg)(e,V,$,r));if(o)return ps({mode:"danger",title:o.message,onDismiss:Ds}),Qe(!1),void("app.user.save.username_exists.app_error"===o.server_error_id&&(ts(o.message),Es(!0)));await(async(e,s)=>{const a=new URLSearchParams(Z).get("redirect_to"),{error:t}=await K((0,_.gk)(s.id,e.password));if(t)if("api.user.login.not_verified.app_error"===t.server_error_id){let s="/should_verify_email?email="+encodeURIComponent(e.email);cs&&(s+="&teamname="+encodeURIComponent(cs)),a&&(s+="&redirect_to="+a),X.push(s)}else us(t.message),Qe(!1);else await Bs()})(e,n),fs&&(()=>{try{g.mT.subscribeToNewsletter({email:qe,subscribed_content:"security_newsletter"})}catch(e){console.error(e)}})()}else Qe(!1)},Ws=()=>X.replace("/");return l().createElement("div",{className:"signup-body"},l().createElement("div",{className:"signup-body-content"},(()=>{if(!Pe&&!vs)return l().createElement(x.A,{title:D({id:"login.noMethods.title",defaultMessage:"This server doesn’t have any sign-in methods enabled"}),message:D({id:"login.noMethods.subtitle",defaultMessage:"Please contact your System Administrator to resolve this."})});if(!$e&&(Fe||ls||Ue)){const e=Fe?D({id:"signup_user_completed.no_open_server.title",defaultMessage:"This server doesn’t allow open signups"}):ls||D({id:"signup_user_completed.invalid_invite.title",defaultMessage:"This invite link is invalid"});return l().createElement(x.A,{title:e,message:D({id:"signup_user_completed.invalid_invite.message",defaultMessage:"Please speak with your Administrator to receive an invitation."}),extraContent:l().createElement("div",{className:"signup-body-content-button-container"},l().createElement("button",{className:"signup-body-content-button-return",onClick:Ws},D({id:"signup_user_completed.return",defaultMessage:"Return to log in"})))})}if(Ls)return l().createElement(d.Route,{path:"/signup_user_complete/desktop",render:()=>l().createElement(L.A,{href:Ls,onLogin:Bs})});let e=se?{type:F.Kw.INFO,value:D({id:"signup_user_completed.emailIs",defaultMessage:"You'll use this address to sign in to {siteName}."},{siteName:fe})}:null;return es&&(e={type:F.Kw.ERROR,value:es}),l().createElement(l().Fragment,null,l().createElement("div",{className:r()("signup-body-message",{"custom-branding":He,"with-brand-image":He&&!os,"with-alternate-link":!gs})},He&&!os?l().createElement("img",{className:r()("signup-body-custom-branding-image"),alt:"brand image",src:g.mT.getBrandImageUrl("0"),onError:Ts}):l().createElement("h1",{className:"signup-body-message-title"},D({id:"signup_user_completed.title",defaultMessage:"Let’s get started"})),Os()),l().createElement("div",{className:"signup-body-action"},!gs&&xs(),l().createElement("div",{className:r()("signup-body-card",{"custom-branding":He,"with-error":_s})},l().createElement("div",{className:"signup-body-card-content"},l().createElement("h2",{className:"signup-body-card-title"},we||D(!Pe&&vs?{id:"signup_user_completed.cardtitle.external",defaultMessage:"Create your account with one of the following:"}:{id:"signup_user_completed.cardtitle",defaultMessage:"Create your account"})),He&&Os(),ms&&l().createElement(S.A,{className:"login-body-card-banner",mode:ms.mode,title:ms.title,onDismiss:ms.onDismiss}),Pe&&l().createElement("form",{className:"signup-body-card-form"},l().createElement(W.A,{"data-testid":"signup-body-card-form-email-input",ref:xe,name:"email",className:"signup-body-card-form-email-input",type:"text",inputSize:W.S.LARGE,value:qe,onChange:Ps,placeholder:D({id:"signup_user_completed.emailLabel",defaultMessage:"Email address"}),disabled:$e||Boolean(se),autoFocus:!0,customMessage:e}),l().createElement(W.A,{"data-testid":"signup-body-card-form-name-input",ref:Ce,name:"name",className:"signup-body-card-form-name-input",type:"text",inputSize:W.S.LARGE,value:je,onChange:Is,placeholder:D({id:"signup_user_completed.chooseUser",defaultMessage:"Choose a Username"}),disabled:$e,autoFocus:Boolean(se),customMessage:as?{type:F.Kw.ERROR,value:as}:{type:F.Kw.INFO,value:D({id:"signup_user_completed.userHelp",defaultMessage:"You can use lowercase letters, numbers, periods, dashes, and underscores."})}}),l().createElement(H.A,{"data-testid":"signup-body-card-form-password-input",ref:Re,className:"signup-body-card-form-password-input",value:Xe,inputSize:W.S.LARGE,onChange:Ys,disabled:$e,createMode:!0,info:Ns,error:rs}),ys===N.M.Available?l().createElement(G,{id:"signup-body-card-form-check-newsletter",ariaLabel:D({id:"newsletter_optin.checkmark.box",defaultMessage:"newsletter checkbox"}),name:"newsletter",onChange:()=>ws(!fs),text:D({id:"newsletter_optin.checkmark.text",defaultMessage:"<span>I would like to receive Mattermost security updates via newsletter.</span> By subscribing, I consent to receive emails from Mattermost with product updates, promotions, and company news. I have read the <a>Privacy Policy</a> and understand that I can <aa>unsubscribe</aa> at any time"},{a:e=>l().createElement(A.A,{location:"signup-newsletter-checkmark",href:F.Zd.PRIVACY},e),aa:e=>l().createElement(A.A,{location:"signup-newsletter-checkmark",href:F.Zd.NEWSLETTER_UNSUBSCRIBE_LINK},e),span:e=>l().createElement("span",{className:"header"},e)}),checked:fs}):l().createElement("div",{className:"newsletter"},l().createElement("span",{className:"interested"},D({id:"newsletter_optin.title",defaultMessage:"Interested in receiving Mattermost security, product, promotions, and company updates updates via newsletter?"})),l().createElement("span",{className:"link"},D({id:"newsletter_optin.desc",defaultMessage:"Sign up at <a>{link}</a>."},{link:F.Zd.SECURITY_UPDATES,a:e=>l().createElement(A.A,{location:"signup",href:F.Zd.SECURITY_UPDATES},e)}))),l().createElement(T.A,{extraClasses:"signup-body-card-form-button-submit large",saving:$e,disabled:!Ms,onClick:Gs,defaultMessage:D({id:"signup_user_completed.create",defaultMessage:"Create account"}),savingMessage:D({id:"signup_user_completed.saving",defaultMessage:"Creating account…"})})),Pe&&vs&&l().createElement("div",{className:"signup-body-card-form-divider"},l().createElement("span",{className:"signup-body-card-form-divider-label"},D({id:"signup_user_completed.or",defaultMessage:"or create an account with"}))),vs&&l().createElement("div",{className:r()("signup-body-card-form-login-options",{column:!Pe})},(()=>{const e=[];if(!vs)return e;if(Ie){const s="".concat(g.mT.getOAuthRoute(),"/gitlab/signup").concat(Z);e.push({id:"gitlab",url:s,icon:l().createElement(I.A,null),label:he||D({id:"login.gitlab",defaultMessage:"GitLab"}),style:{color:Ee,borderColor:Ee},onClick:Rs(s)})}if(Te&&Ye){const s="".concat(g.mT.getOAuthRoute(),"/google/signup").concat(Z);e.push({id:"google",url:s,icon:l().createElement(Y.A,null),label:D({id:"login.google",defaultMessage:"Google"}),onClick:Rs(s)})}if(Te&&Be){const s="".concat(g.mT.getOAuthRoute(),"/office365/signup").concat(Z);e.push({id:"office365",url:s,icon:l().createElement(O.A,null),label:D({id:"login.office365",defaultMessage:"Entra ID"}),onClick:Rs(s)})}if(Te&&De){const s="".concat(g.mT.getOAuthRoute(),"/openid/signup").concat(Z);e.push({id:"openid",url:s,icon:l().createElement(B.A,null),label:ye||D({id:"login.openid",defaultMessage:"Open ID"}),style:{color:ve,borderColor:ve},onClick:Rs(s)})}if(Te&&Ge){const s=new URLSearchParams(Z);s.set("extra",F.YM.CREATE_LDAP),e.push({id:"ldap",url:"".concat(g.mT.getUrl(),"/login?").concat(s.toString()),icon:l().createElement(P.A,null),label:be||D({id:"signup.ldap",defaultMessage:"AD/LDAP Credentials"}),onClick:()=>{}})}if(Te&&We){const s=new URLSearchParams(Z);s.set("action","signup");const a="".concat(g.mT.getUrl(),"/login/sso/saml?").concat(s.toString());e.push({id:"saml",url:a,icon:l().createElement(P.A,null),label:ge||D({id:"login.saml",defaultMessage:"SAML"}),onClick:Rs(a)})}return e})().map((e=>l().createElement(k.A,Object.assign({key:e.id,direction:Pe?void 0:"column"},e))))),Pe&&!ls&&l().createElement("p",{className:"signup-body-card-agreement"},l().createElement(u.FormattedMessage,{id:"signup.agreement",defaultMessage:"By proceeding to create your account and use {siteName}, you agree to our <termsOfUseLink>Terms of Use</termsOfUseLink> and <privacyPolicyLink>Privacy Policy</privacyPolicyLink>.  If you do not agree, you cannot use {siteName}.",values:{siteName:fe,termsOfUseLink:e=>l().createElement(A.A,{href:Se,location:"signup-terms-of-use"},e),privacyPolicyLink:e=>l().createElement(A.A,{href:Ne,location:"signup-privacy-policy"},e)}}))))))})()))}},79135:(e,s,a)=>{a.d(s,{b:()=>l,s:()=>i}),a(3188),a(6552);var t=a(36418),r=a.n(t),n=a(14778),o=a(78451);function i(e,s,a){let t=l.passwordError.id,i=!0;const u=s.minimumLength||o.Ay.MIN_PASSWORD_LENGTH;let c;return(e.length<u||e.length>o.Ay.MAX_PASSWORD_LENGTH)&&(i=!1),s.requireLowercase&&(e.match(/[a-z]/)||(i=!1),t+="Lowercase"),s.requireUppercase&&(e.match(/[A-Z]/)||(i=!1),t+="Uppercase"),s.requireNumber&&(e.match(/[0-9]/)||(i=!1),t+="Number"),s.requireSymbol&&(e.match(/[ !"\\#$%&'()*+,-./:;<=>?@[\]^_`|~]/)||(i=!1),t+="Symbol"),i||(c=a?a.formatMessage({id:t,defaultMessage:"Must be {min}-{max} characters long."},{min:u,max:o.Ay.MAX_PASSWORD_LENGTH}):r().createElement(n.FormattedMessage,{id:t,defaultMessage:"Must be {min}-{max} characters long.",values:{min:u,max:o.Ay.MAX_PASSWORD_LENGTH}})),{valid:i,error:c}}const l=(0,n.defineMessages)({passwordError:{id:"user.settings.security.passwordError",defaultMessage:"Your password must be {min}-{max} characters long."},passwordErrorLowercase:{id:"user.settings.security.passwordErrorLowercase",defaultMessage:"Your password must be {min}-{max} characters long and include lowercase letters."},passwordErrorLowercaseNumber:{id:"user.settings.security.passwordErrorLowercaseNumber",defaultMessage:"Your password must be {min}-{max} characters long and include lowercase letters and numbers."},passwordErrorLowercaseNumberSymbol:{id:"user.settings.security.passwordErrorLowercaseNumberSymbol",defaultMessage:"Your password must be {min}-{max} characters long and include lowercase letters, numbers, and special characters."},passwordErrorLowercaseSymbol:{id:"user.settings.security.passwordErrorLowercaseSymbol",defaultMessage:"Your password must be {min}-{max} characters long and include lowercase letters and special characters."},passwordErrorLowercaseUppercase:{id:"user.settings.security.passwordErrorLowercaseUppercase",defaultMessage:"Your password must be {min}-{max} characters long and include both lowercase and uppercase letters."},passwordErrorLowercaseUppercaseNumber:{id:"user.settings.security.passwordErrorLowercaseUppercaseNumber",defaultMessage:"Your password must be {min}-{max} characters long and include both lowercase and uppercase letters, and numbers."},passwordErrorLowercaseUppercaseNumberSymbol:{id:"user.settings.security.passwordErrorLowercaseUppercaseNumberSymbol",defaultMessage:"Your password must be {min}-{max} characters long and include both lowercase and uppercase letters, numbers, and special characters."},passwordErrorLowercaseUppercaseSymbol:{id:"user.settings.security.passwordErrorLowercaseUppercaseSymbol",defaultMessage:"Your password must be {min}-{max} characters long and include both lowercase and uppercase letters, and special characters."},passwordErrorNumber:{id:"user.settings.security.passwordErrorNumber",defaultMessage:"Your password must be {min}-{max} characters long and include numbers."},passwordErrorNumberSymbol:{id:"user.settings.security.passwordErrorNumberSymbol",defaultMessage:"Your password must be {min}-{max} characters long and include numbers and special characters."},passwordErrorSymbol:{id:"user.settings.security.passwordErrorSymbol",defaultMessage:"Your password must be {min}-{max} characters long and include special characters."},passwordErrorUppercase:{id:"user.settings.security.passwordErrorUppercase",defaultMessage:"Your password must be {min}-{max} characters long and include uppercase letters."},passwordErrorUppercaseNumber:{id:"user.settings.security.passwordErrorUppercaseNumber",defaultMessage:"Your password must be {min}-{max} characters long and include uppercase letters, and numbers."},passwordErrorUppercaseNumberSymbol:{id:"user.settings.security.passwordErrorUppercaseNumberSymbol",defaultMessage:"Your password must be {min}-{max} characters long and include uppercase letters, numbers, and special characters."},passwordErrorUppercaseSymbol:{id:"user.settings.security.passwordErrorUppercaseSymbol",defaultMessage:"Your password must be {min}-{max} characters long and include uppercase letters, and special characters."}})}}]);
//# sourceMappingURL=8508.06127b8a423843a887c5.js.map