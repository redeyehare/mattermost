{"version":3,"file":"9838.fbfcc2b840d963bbc734.js","mappings":"+sBAmCA,SAAeA,EAAAA,EAAAA,aAAUC,EAAC,cAAkCC,IAAAA,cACxDC,WAAAA,CAAYC,GACRC,MAAMD,GAAOE,EAAA,sBAuBAC,KACTC,EAAAA,EAAAA,GAAaD,EAAOE,EAAAA,GAAUC,SAASC,SACvCC,KAAKR,MAAMS,UACf,IACHP,EAAA,mBAEaQ,IACHC,EAAAA,EAAAA,IAAmBD,EAAMF,KAAKR,MAAMY,KAAKC,iBACnDX,EAAA,gBAES,KAcC,CACHY,gBAbAhB,IAAAA,cAACiB,EAAAA,iBAAgB,CACbC,GAAG,0CACHC,eAAe,gCAYnBC,kBARApB,IAAAA,cAACiB,EAAAA,iBAAgB,CACbC,GAAG,4CACHC,eAAe,8BAQ1Bf,EAAA,sBAEeiB,UACZ,MAAMC,EAAUZ,KAAKa,MAAMC,iBAAiBC,SACxCH,EAAU,IAAII,aAGZhB,KAAKR,MAAMyB,QAAQC,UAAU,CAC/BC,QAASnB,KAAKR,MAAM4B,OACpBC,OAAQC,EAAAA,GAAaC,IACrBC,cAAcC,EAAAA,EAAAA,IAAmBb,GACjCc,QAAQ,EACRC,kBAAkBF,EAAAA,EAAAA,IAAmBzB,KAAKR,MAAMoC,eAEpD5B,KAAKR,MAAMS,WAAU,IACxBP,EAAA,6BAEuBmC,IACpB7B,KAAK8B,SAAS,CACVhB,iBAAkBe,GACpB,IArEF,MAAM,YAACD,GAAe5B,KAAKR,MAC3B,IAAIsB,EAAmBiB,IAAOH,GAGC,KAA3BA,EAAYI,YAAqBJ,EAAYK,aAAe,KAC5DnB,EAAmBA,EAAiBoB,IAAI,EAAG,OAAOC,QAAQ,OAAOD,IAAI,EAAG,UAG5ElC,KAAKa,MAAQ,CACTC,mBAER,CAEAsB,iBAAAA,GACIC,SAASC,iBAAiB,UAAWtC,KAAKuC,cAC9C,CAEAC,oBAAAA,GACIH,SAASI,oBAAoB,UAAWzC,KAAKuC,cACjD,CAqDAG,MAAAA,GACI,MAAM,gBACFpC,EAAe,kBACfI,GACAV,KAAK2C,WAEH,iBAAC7B,GAAoBd,KAAKa,MAEhC,OACIvB,IAAAA,cAACsD,EAAAA,GAAY,CACTC,eAAe,EACfC,WAAWC,EAAAA,EAAAA,IAAgB,CAACvC,GAAI,0CAA2CC,eAAgB,gCAC3FR,SAAUD,KAAKR,MAAMS,SACrBK,gBAAiBA,EACjBI,kBAAmBA,EACnBsC,cAAehD,KAAKgD,cACpBC,oBAAqBjD,KAAKgD,cAC1BxC,GAAG,2BACH0C,UAAW,0BACXC,UAAW,EACXC,gBAAgB,EAChBC,cAAc,GAEd/D,IAAAA,cAAA,OAAK4D,UAAU,qBACX5D,IAAAA,cAACgE,EAAAA,GAAa,CACVC,KAAMzC,EACN0C,aAAcxD,KAAKyD,qBACnBC,SAAU1D,KAAKR,MAAMkE,SACrBC,cAAc,KAKlC,GACHjE,EAAAL,EAAA,aA7HGY,SAAQ2D,IAAAA,KAAAC,WACRzC,OAAMwC,IAAAA,OAAAC,WACNjC,YAAWgC,IAAAA,WAAA5C,MAAA6C,WACXC,OAAMF,IAAAA,OAAAC,WACNH,SAAQE,IAAAA,OAER3C,QAAO2C,IAAAA,MAAA,CACH1C,UAAS0C,IAAAA,KAAAC,aAAAA,aAAAxE,G","sources":["webpack://mattermost-webapp/./src/components/dnd_custom_time_picker_modal/dnd_custom_time_picker_modal.tsx"],"sourcesContent":["// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport moment from 'moment';\r\nimport React from 'react';\r\nimport {FormattedMessage, injectIntl, type WrappedComponentProps} from 'react-intl';\r\n\r\nimport {GenericModal} from '@mattermost/components';\r\nimport type {UserStatus} from '@mattermost/types/users';\r\n\r\nimport DateTimeInput from 'components/datetime_input/datetime_input';\r\n\r\nimport Constants, {UserStatuses} from 'utils/constants';\r\nimport {toUTCUnixInSeconds, relativeFormatDate} from 'utils/datetime';\r\nimport {isKeyPressed} from 'utils/keyboard';\r\nimport {localizeMessage} from 'utils/utils';\r\n\r\nimport './dnd_custom_time_picker_modal.scss';\r\n\r\ntype Props = {\r\n    onExited: () => void;\r\n    userId: string;\r\n    currentDate: Date;\r\n    locale: string;\r\n    timezone?: string;\r\n\r\n    actions: {\r\n        setStatus: (status: UserStatus) => void;\r\n    };\r\n} & WrappedComponentProps;\r\n\r\ntype State = {\r\n    selectedDateTime: moment.Moment;\r\n}\r\n\r\nexport default injectIntl(class DndCustomTimePicker extends React.PureComponent<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        const {currentDate} = this.props;\r\n        let selectedDateTime = moment(currentDate);\r\n\r\n        // if current time is > 23:20 then we will set date to tomorrow and show all times\r\n        if (currentDate.getHours() === 23 && currentDate.getMinutes() > 20) {\r\n            selectedDateTime = selectedDateTime.add(1, 'day').startOf('day').add(9, 'hours');\r\n        }\r\n\r\n        this.state = {\r\n            selectedDateTime,\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        document.addEventListener('keydown', this.handleKeyDown);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        document.removeEventListener('keydown', this.handleKeyDown);\r\n    }\r\n\r\n    handleKeyDown = (event: KeyboardEvent) => {\r\n        if (isKeyPressed(event, Constants.KeyCodes.ESCAPE)) {\r\n            this.props.onExited();\r\n        }\r\n    };\r\n\r\n    formatDate = (date: moment.Moment): string => {\r\n        return relativeFormatDate(date, this.props.intl.formatMessage);\r\n    };\r\n\r\n    getText = () => {\r\n        const modalHeaderText = (\r\n            <FormattedMessage\r\n                id='dnd_custom_time_picker_modal.defaultMsg'\r\n                defaultMessage='Disable notifications until'\r\n            />\r\n        );\r\n        const confirmButtonText = (\r\n            <FormattedMessage\r\n                id='dnd_custom_time_picker_modal.submitButton'\r\n                defaultMessage='Disable Notifications'\r\n            />\r\n        );\r\n\r\n        return {\r\n            modalHeaderText,\r\n            confirmButtonText,\r\n        };\r\n    };\r\n\r\n    handleConfirm = async () => {\r\n        const endTime = this.state.selectedDateTime.toDate();\r\n        if (endTime < new Date()) {\r\n            return;\r\n        }\r\n        await this.props.actions.setStatus({\r\n            user_id: this.props.userId,\r\n            status: UserStatuses.DND,\r\n            dnd_end_time: toUTCUnixInSeconds(endTime),\r\n            manual: true,\r\n            last_activity_at: toUTCUnixInSeconds(this.props.currentDate),\r\n        });\r\n        this.props.onExited();\r\n    };\r\n\r\n    handleDateTimeChange = (newDateTime: moment.Moment) => {\r\n        this.setState({\r\n            selectedDateTime: newDateTime,\r\n        });\r\n    };\r\n\r\n    render() {\r\n        const {\r\n            modalHeaderText,\r\n            confirmButtonText,\r\n        } = this.getText();\r\n\r\n        const {selectedDateTime} = this.state;\r\n\r\n        return (\r\n            <GenericModal\r\n                compassDesign={true}\r\n                ariaLabel={localizeMessage({id: 'dnd_custom_time_picker_modal.defaultMsg', defaultMessage: 'Disable notifications until'})}\r\n                onExited={this.props.onExited}\r\n                modalHeaderText={modalHeaderText}\r\n                confirmButtonText={confirmButtonText}\r\n                handleConfirm={this.handleConfirm}\r\n                handleEnterKeyPress={this.handleConfirm}\r\n                id='dndCustomTimePickerModal'\r\n                className={'DndModal modal-overflow'}\r\n                tabIndex={-1}\r\n                keyboardEscape={true}\r\n                enforceFocus={false}\r\n            >\r\n                <div className='DndModal__content'>\r\n                    <DateTimeInput\r\n                        time={selectedDateTime}\r\n                        handleChange={this.handleDateTimeChange}\r\n                        timezone={this.props.timezone}\r\n                        relativeDate={true}\r\n                    />\r\n                </div>\r\n            </GenericModal>\r\n        );\r\n    }\r\n});\r\n"],"names":["injectIntl","_DndCustomTimePicker","React","constructor","props","super","_defineProperty","event","isKeyPressed","Constants","KeyCodes","ESCAPE","this","onExited","date","relativeFormatDate","intl","formatMessage","modalHeaderText","FormattedMessage","id","defaultMessage","confirmButtonText","async","endTime","state","selectedDateTime","toDate","Date","actions","setStatus","user_id","userId","status","UserStatuses","DND","dnd_end_time","toUTCUnixInSeconds","manual","last_activity_at","currentDate","newDateTime","setState","moment","getHours","getMinutes","add","startOf","componentDidMount","document","addEventListener","handleKeyDown","componentWillUnmount","removeEventListener","render","getText","GenericModal","compassDesign","ariaLabel","localizeMessage","handleConfirm","handleEnterKeyPress","className","tabIndex","keyboardEscape","enforceFocus","DateTimeInput","time","handleChange","handleDateTimeChange","timezone","relativeDate","_pt","isRequired","locale"],"sourceRoot":""}