{"version":3,"file":"2018.b4ec217c9e69b27596f0.js","mappings":"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","sources":["webpack://mattermost-webapp/./src/components/modal_controller/modal_controller.tsx","webpack://mattermost-webapp/./src/components/modal_controller/index.ts","webpack://mattermost-webapp/./src/components/popout_button.tsx","webpack://mattermost-webapp/./src/components/rhs_plugin_popout/rhs_plugin_popout.tsx","webpack://mattermost-webapp/./src/components/rhs_popout/rhs_popout.tsx","webpack://mattermost-webapp/./src/components/thread_popout/thread_popout.tsx","webpack://mattermost-webapp/./src/components/popout_controller/popout_controller.tsx","webpack://mattermost-webapp/./src/components/search_results_header/search_results_header.tsx","webpack://mattermost-webapp/./src/components/search_results_header/index.tsx","webpack://mattermost-webapp/./src/components/threading/global_threads/thread_menu/thread_menu.tsx","webpack://mattermost-webapp/./src/hooks/useReadout.ts","webpack://mattermost-webapp/./src/components/threading/global_threads/thread_pane/thread_pane.tsx","webpack://mattermost-webapp/./src/components/threading/hooks.ts","webpack://mattermost-webapp/./src/components/unreads_status_handler/unreads_status_handler.tsx","webpack://mattermost-webapp/./src/components/unreads_status_handler/index.ts","webpack://mattermost-webapp/./src/components/widgets/header/header.tsx"],"sourcesContent":["// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\n\r\ntype Modal = {\r\n    open: boolean;\r\n    dialogType: React.ComponentType;\r\n    dialogProps?: Record<string, any>;\r\n}\r\n\r\ntype Props = {\r\n\r\n    /*\r\n     * Object that has map of modal's id and element\r\n     */\r\n    modals: {\r\n        modalState: {\r\n            [modalId: string]: Modal;\r\n        };\r\n    };\r\n\r\n    /*\r\n     * Object with action creators\r\n     */\r\n    actions: {\r\n\r\n        /*\r\n         * Action creator to close modal\r\n         */\r\n        closeModal: (modalId: string) => void;\r\n    };\r\n}\r\n\r\nconst ModalController = ({\r\n    modals,\r\n    actions,\r\n}: Props) => {\r\n    if (!modals) {\r\n        return null;\r\n    }\r\n\r\n    const {modalState} = modals;\r\n    const modalOutput = [];\r\n\r\n    for (const modalId in modalState) {\r\n        if (Object.hasOwn(modalState, modalId)) {\r\n            const modal = modalState[modalId];\r\n            if (modal.open) {\r\n                const modalComponent = React.createElement(modal.dialogType, Object.assign({}, modal.dialogProps, {\r\n                    onExited: () => {\r\n                        actions.closeModal(modalId);\r\n\r\n                        // Call any onExited prop provided by whoever opened the modal, if one was provided\r\n                        modal.dialogProps?.onExited?.();\r\n                    },\r\n                    onHide: actions.closeModal.bind(this, modalId),\r\n                    key: `${modalId}_modal`,\r\n                }));\r\n\r\n                modalOutput.push(modalComponent);\r\n            }\r\n        }\r\n    }\r\n\r\n    return <>{modalOutput}</>;\r\n};\r\n\r\nexport default ModalController;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {closeModal} from 'actions/views/modals';\r\n\r\nimport type {GlobalState} from 'types/store/index.js';\r\n\r\nimport ModalController from './modal_controller';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    return {\r\n        modals: state.views.modals,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            closeModal,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(ModalController);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\n\r\nimport WithTooltip from 'components/with_tooltip';\r\n\r\nimport {canPopout} from 'utils/popouts/popout_windows';\r\n\r\ntype Props = {\r\n    onClick: React.MouseEventHandler<HTMLButtonElement>;\r\n    className?: string;\r\n};\r\n\r\nexport default function PopoutButton({\r\n    onClick,\r\n    className,\r\n}: Props) {\r\n    const intl = useIntl();\r\n\r\n    if (!canPopout()) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <WithTooltip\r\n            title={\r\n                <FormattedMessage\r\n                    id='new_window_button.tooltip'\r\n                    defaultMessage='Open in new window'\r\n                />\r\n            }\r\n        >\r\n            <button\r\n                type='button'\r\n                className={classNames('btn btn-icon btn-sm', 'PopoutButton', className)}\r\n                aria-label={intl.formatMessage({id: 'new_window_button.tooltip', defaultMessage: 'Open in new window'})}\r\n                onClick={onClick}\r\n            >\r\n                <i\r\n                    className='icon icon-dock-window'\r\n                    aria-hidden='true'\r\n                />\r\n            </button>\r\n        </WithTooltip>\r\n    );\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {useSelector} from 'react-redux';\r\nimport {useParams} from 'react-router-dom';\r\n\r\nimport LoadingScreen from 'components/loading_screen';\r\nimport SearchResultsHeader from 'components/search_results_header';\r\n\r\nimport Pluggable from 'plugins/pluggable';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nexport default function RhsPluginPopout() {\r\n    const {pluginId} = useParams<{pluginId: string}>();\r\n\r\n    const {showPluggable, pluggableId, title} = useSelector((state: GlobalState) => {\r\n        const rhsPlugins = state.plugins.components.RightHandSidebarComponent;\r\n        const pluginComponent = rhsPlugins.find((element) => element.pluginId === pluginId);\r\n        const pluginTitle = pluginComponent ? pluginComponent.title : '';\r\n        const componentId = pluginComponent ? pluginComponent.id : '';\r\n\r\n        return {\r\n            showPluggable: Boolean(pluginComponent),\r\n            pluggableId: componentId,\r\n            title: pluginTitle,\r\n        };\r\n    });\r\n\r\n    if (!showPluggable) {\r\n        return <LoadingScreen/>;\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <SearchResultsHeader>\r\n                {title}\r\n            </SearchResultsHeader>\r\n            <Pluggable\r\n                pluggableName='RightHandSidebarComponent'\r\n                pluggableId={pluggableId}\r\n            />\r\n        </>\r\n    );\r\n}\r\n\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useEffect} from 'react';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\nimport {Route, Switch, useParams, useRouteMatch} from 'react-router-dom';\r\n\r\nimport {fetchChannelsAndMembers, getChannelMembers, selectChannel} from 'mattermost-redux/actions/channels';\r\nimport {selectTeam} from 'mattermost-redux/actions/teams';\r\nimport {getChannelByName} from 'mattermost-redux/selectors/entities/channels';\r\n\r\nimport {useTeamByName} from 'components/common/hooks/use_team';\r\nimport RhsPluginPopout from 'components/rhs_plugin_popout';\r\nimport UnreadsStatusHandler from 'components/unreads_status_handler';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport './rhs_popout.scss';\r\n\r\nexport default function RhsPopout() {\r\n    const match = useRouteMatch();\r\n\r\n    const dispatch = useDispatch();\r\n    const {team: teamName, identifier: channelIdentifier} = useParams<{team: string; pluginId: string; identifier: string}>();\r\n\r\n    const team = useTeamByName(teamName);\r\n    const channel = useSelector((state: GlobalState) => getChannelByName(state, channelIdentifier));\r\n\r\n    const teamId = team?.id;\r\n    const channelId = channel?.id;\r\n\r\n    useEffect(() => {\r\n        if (channelId) {\r\n            dispatch(selectChannel(channelId));\r\n            dispatch(getChannelMembers(channelId));\r\n        }\r\n    }, [dispatch, channelId]);\r\n\r\n    useEffect(() => {\r\n        if (teamId) {\r\n            dispatch(selectTeam(teamId));\r\n            dispatch(fetchChannelsAndMembers(teamId));\r\n        }\r\n    }, [dispatch, teamId]);\r\n\r\n    return (\r\n        <>\r\n            <UnreadsStatusHandler/>\r\n            <div className='main-wrapper rhs-popout'>\r\n                <div className='sidebar--right'>\r\n                    <div className='sidebar-right__body'>\r\n                        <Switch>\r\n                            <Route\r\n                                path={`${match.path}/plugin/:pluginId`}\r\n                                component={RhsPluginPopout}\r\n                            />\r\n                        </Switch>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </>\r\n    );\r\n}\r\n\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useEffect, useMemo} from 'react';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\nimport {useParams} from 'react-router-dom';\r\n\r\nimport {fetchChannelsAndMembers, selectChannel} from 'mattermost-redux/actions/channels';\r\nimport {getPostThread} from 'mattermost-redux/actions/posts';\r\nimport {extractUserIdsAndMentionsFromPosts} from 'mattermost-redux/actions/status_profile_polling';\r\nimport {selectTeam} from 'mattermost-redux/actions/teams';\r\nimport {getThread} from 'mattermost-redux/actions/threads';\r\nimport {getProfilesByIds} from 'mattermost-redux/actions/users';\r\nimport {getTeamByName} from 'mattermost-redux/selectors/entities/teams';\r\nimport {makeGetThreadOrSynthetic} from 'mattermost-redux/selectors/entities/threads';\r\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {loadStatusesByIds} from 'actions/status_actions';\r\nimport {markThreadAsRead} from 'actions/views/threads';\r\n\r\nimport {usePost} from 'components/common/hooks/usePost';\r\nimport ThreadPane from 'components/threading/global_threads/thread_pane';\r\nimport ThreadViewer from 'components/threading/thread_viewer';\r\nimport UnreadsStatusHandler from 'components/unreads_status_handler';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nexport default function ThreadPopout() {\r\n    const dispatch = useDispatch();\r\n    const getThreadOrSynthetic = useMemo(() => makeGetThreadOrSynthetic(), []);\r\n\r\n    const {postId, team: teamName} = useParams<{team: string; postId: string}>();\r\n    const currentUserId = useSelector(getCurrentUserId);\r\n\r\n    const post = usePost(postId);\r\n    const team = useSelector((state: GlobalState) => getTeamByName(state, teamName));\r\n    const thread = useSelector((state: GlobalState) => {\r\n        if (!post) {\r\n            return undefined;\r\n        }\r\n        return getThreadOrSynthetic(state, post);\r\n    });\r\n\r\n    const channelId = post?.channel_id;\r\n    useEffect(() => {\r\n        if (channelId) {\r\n            dispatch(selectChannel(channelId));\r\n        }\r\n    }, [dispatch, channelId]);\r\n\r\n    const teamId = team?.id;\r\n    useEffect(() => {\r\n        if (teamId) {\r\n            dispatch(fetchChannelsAndMembers(teamId));\r\n            dispatch(selectTeam(teamId));\r\n        }\r\n    }, [dispatch, teamId]);\r\n\r\n    useEffect(() => {\r\n        if (teamId) {\r\n            dispatch(getThread(currentUserId, teamId, postId));\r\n\r\n            // Since the statuses are fetched properly and timely by the thread viewer, manually fetch them here\r\n            async function fetchPostThread() {\r\n                const {data: posts} = await dispatch(getPostThread(postId, true));\r\n                if (posts) {\r\n                    const {data: result} = await dispatch(extractUserIdsAndMentionsFromPosts(Array.from(Object.values(posts.posts))));\r\n                    if (result) {\r\n                        if (result.userIdsForProfilePoll.length > 0) {\r\n                            await dispatch(getProfilesByIds(result.userIdsForProfilePoll));\r\n                        }\r\n                        if (result.userIdsForStatusPoll.length > 0) {\r\n                            await dispatch(loadStatusesByIds(result.userIdsForStatusPoll));\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            fetchPostThread();\r\n        }\r\n    }, [postId, dispatch, currentUserId, teamId]);\r\n\r\n    useEffect(() => {\r\n        function handleFocus() {\r\n            window.isActive = true;\r\n            dispatch(markThreadAsRead(postId));\r\n        }\r\n        function handleBlur() {\r\n            window.isActive = false;\r\n        }\r\n        window.addEventListener('focus', handleFocus);\r\n        window.addEventListener('blur', handleBlur);\r\n        return () => {\r\n            window.removeEventListener('focus', handleFocus);\r\n            window.removeEventListener('blur', handleBlur);\r\n        };\r\n    }, []);\r\n\r\n    if (!thread) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <UnreadsStatusHandler/>\r\n            <ThreadPane\r\n                thread={thread}\r\n            >\r\n                <ThreadViewer\r\n                    rootPostId={postId}\r\n                    useRelativeTimestamp={true}\r\n                    isThreadView={true}\r\n                />\r\n            </ThreadPane>\r\n        </>\r\n    );\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useEffect} from 'react';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\nimport {Route, Switch} from 'react-router-dom';\r\nimport type {RouteComponentProps} from 'react-router-dom';\r\n\r\nimport {getMe} from 'mattermost-redux/actions/users';\r\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {loadStatusesByIds} from 'actions/status_actions';\r\n\r\nimport LoggedIn from 'components/logged_in';\r\nimport ModalController from 'components/modal_controller';\r\nimport RhsPopout from 'components/rhs_popout';\r\nimport ThreadPopout from 'components/thread_popout';\r\n\r\nimport Pluggable from 'plugins/pluggable';\r\nimport {TEAM_NAME_PATH_PATTERN, ID_PATH_PATTERN, IDENTIFIER_PATH_PATTERN} from 'utils/path';\r\nimport {useBrowserPopout} from 'utils/popouts/use_browser_popout';\r\n\r\nimport './popout_controller.scss';\r\n\r\nconst PopoutController: React.FC<RouteComponentProps> = (routeProps) => {\r\n    const dispatch = useDispatch();\r\n    const currentUserId = useSelector(getCurrentUserId);\r\n    useBrowserPopout();\r\n    useEffect(() => {\r\n        document.body.classList.add('app__body', 'popout');\r\n        dispatch(getMe());\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (currentUserId) {\r\n            dispatch(loadStatusesByIds([currentUserId]));\r\n        }\r\n    }, [dispatch, currentUserId]);\r\n\r\n    return (\r\n        <LoggedIn {...routeProps}>\r\n            <ModalController/>\r\n            <Pluggable pluggableName='Root'/>\r\n            <Switch>\r\n                <Route\r\n                    path={`/_popout/thread/:team(${TEAM_NAME_PATH_PATTERN})/:postId(${ID_PATH_PATTERN})`}\r\n                    component={ThreadPopout}\r\n                />\r\n                <Route\r\n                    path={`/_popout/rhs/:team(${TEAM_NAME_PATH_PATTERN})/:identifier(${IDENTIFIER_PATH_PATTERN})`}\r\n                    component={RhsPopout}\r\n                />\r\n            </Switch>\r\n        </LoggedIn>\r\n    );\r\n};\r\n\r\nexport default PopoutController;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\n\r\nimport KeyboardShortcutSequence, {KEYBOARD_SHORTCUTS} from 'components/keyboard_shortcuts/keyboard_shortcuts_sequence';\r\nimport PopoutButton from 'components/popout_button';\r\nimport WithTooltip from 'components/with_tooltip';\r\n\r\nimport {RHSStates} from 'utils/constants';\r\nimport {isPopoutWindow} from 'utils/popouts/popout_windows';\r\n\r\nimport type {PropsFromRedux} from './index';\r\n\r\nexport interface Props extends PropsFromRedux {\r\n    children: React.ReactNode;\r\n    newWindowHandler?: () => void;\r\n}\r\n\r\nfunction SearchResultsHeader(props: Props) {\r\n    const {formatMessage} = useIntl();\r\n\r\n    const showExpand = props.previousRhsState !== RHSStates.CHANNEL_INFO;\r\n\r\n    // sidebarTooltipContent contains tooltips content for expand or shrink sidebarTooltip.\r\n    // if props.isExpanded is true, defaultMessage would feed from 'shrinkTooltip', else 'expandTooltip'\r\n    const sidebarTooltipContent = props.isExpanded ? (\r\n        <>\r\n            <FormattedMessage\r\n                id='rhs_header.collapseSidebarTooltip'\r\n                defaultMessage='Collapse the right sidebar'\r\n            />\r\n            <KeyboardShortcutSequence\r\n                shortcut={KEYBOARD_SHORTCUTS.navExpandSidebar}\r\n                hideDescription={true}\r\n                isInsideTooltip={true}\r\n            />\r\n        </>\r\n    ) : (\r\n        <>\r\n            <FormattedMessage\r\n                id='rhs_header.expandSidebarTooltip'\r\n                defaultMessage='Expand the right sidebar'\r\n            />\r\n            <KeyboardShortcutSequence\r\n                shortcut={KEYBOARD_SHORTCUTS.navExpandSidebar}\r\n                hideDescription={true}\r\n                isInsideTooltip={true}\r\n            />\r\n        </>\r\n    );\r\n\r\n    const expandOrCollapseSidebarButtonAriaLabel = props.isExpanded ? formatMessage({id: 'rhs_header.collapseSidebarTooltip.icon', defaultMessage: 'Collapse Sidebar Icon'}) : formatMessage({id: 'rhs_header.expandSidebarTooltip.icon', defaultMessage: 'Expand Sidebar Icon'});\r\n\r\n    return (\r\n        <div className='sidebar--right__header'>\r\n            <span\r\n                className='sidebar--right__title'\r\n                id='rhsPanelTitle'\r\n            >\r\n                {props.canGoBack && (\r\n                    <button\r\n                        className='sidebar--right__back btn btn-icon btn-sm'\r\n                        onClick={props.actions.goBack}\r\n                        aria-label={formatMessage({id: 'rhs_header.back.icon', defaultMessage: 'Back Icon'})}\r\n                    >\r\n                        <i className='icon icon-arrow-back-ios'/>\r\n                    </button>\r\n                )}\r\n                {props.children}\r\n            </span>\r\n            <div className='pull-right'>\r\n                {showExpand && !isPopoutWindow() && (\r\n                    <WithTooltip\r\n                        title={sidebarTooltipContent}\r\n                    >\r\n                        <button\r\n                            type='button'\r\n                            className='sidebar--right__expand btn btn-icon btn-sm'\r\n                            onClick={props.actions.toggleRhsExpanded}\r\n                            aria-label={expandOrCollapseSidebarButtonAriaLabel}\r\n                        >\r\n                            <i\r\n                                className='icon icon-arrow-expand'\r\n                                aria-hidden='true'\r\n                            />\r\n                            <i\r\n                                className='icon icon-arrow-collapse'\r\n                                aria-hidden='true'\r\n                            />\r\n                        </button>\r\n                    </WithTooltip>\r\n                )}\r\n                {props.newWindowHandler && (\r\n                    <PopoutButton onClick={props.newWindowHandler}/>\r\n                )}\r\n                {!isPopoutWindow() &&\r\n                    <WithTooltip\r\n                        title={\r\n                            <FormattedMessage\r\n                                id='rhs_header.closeSidebarTooltip'\r\n                                defaultMessage='Close'\r\n                            />\r\n                        }\r\n                    >\r\n                        <button\r\n                            id='searchResultsCloseButton'\r\n                            type='button'\r\n                            className='sidebar--right__close btn btn-icon btn-sm'\r\n                            aria-label='Close'\r\n                            onClick={props.actions.closeRightHandSide}\r\n                        >\r\n                            <i\r\n                                className='icon icon-close'\r\n                                aria-label={formatMessage({id: 'rhs_header.closeTooltip.icon', defaultMessage: 'Close Sidebar Icon'})}\r\n                            />\r\n                        </button>\r\n                    </WithTooltip>\r\n                }\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default SearchResultsHeader;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {ConnectedProps} from 'react-redux';\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {AnyAction, Dispatch} from 'redux';\r\n\r\nimport {getCurrentChannelId} from 'mattermost-redux/selectors/entities/common';\r\n\r\nimport {\r\n    closeRightHandSide,\r\n    toggleRhsExpanded,\r\n    goBack,\r\n} from 'actions/views/rhs';\r\nimport {getIsRhsExpanded, getPreviousRhsState} from 'selectors/rhs';\r\n\r\nimport {RHSStates} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store/index.js';\r\n\r\nimport SearchResultsHeader from './search_results_header';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const previousRhsState = getPreviousRhsState(state);\r\n    const canGoBack = previousRhsState === RHSStates.CHANNEL_INFO ||\r\n        previousRhsState === RHSStates.CHANNEL_MEMBERS ||\r\n        previousRhsState === RHSStates.CHANNEL_FILES ||\r\n        previousRhsState === RHSStates.PIN;\r\n\r\n    return {\r\n        isExpanded: getIsRhsExpanded(state),\r\n        channelId: getCurrentChannelId(state),\r\n        previousRhsState,\r\n        canGoBack,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<AnyAction>) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            closeRightHandSide,\r\n            toggleRhsExpanded,\r\n            goBack,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nconst connector = connect(mapStateToProps, mapDispatchToProps);\r\n\r\nexport type PropsFromRedux = ConnectedProps<typeof connector>;\r\n\r\nexport default connector(SearchResultsHeader);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {memo, useCallback} from 'react';\r\nimport type {ReactNode} from 'react';\r\nimport {useIntl} from 'react-intl';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\n\r\nimport type {UserThread} from '@mattermost/types/threads';\r\n\r\nimport {setThreadFollow, updateThreadRead, markLastPostInThreadAsUnread} from 'mattermost-redux/actions/threads';\r\nimport {isPostFlagged} from 'mattermost-redux/selectors/entities/posts';\r\n\r\nimport {\r\n    flagPost as savePost,\r\n    unflagPost as unsavePost,\r\n} from 'actions/post_actions';\r\nimport {manuallyMarkThreadAsUnread} from 'actions/views/threads';\r\n\r\nimport {focusPost} from 'components/permalink_view/actions';\r\nimport Menu from 'components/widgets/menu/menu';\r\nimport MenuWrapper from 'components/widgets/menu/menu_wrapper';\r\n\r\nimport {useReadout} from 'hooks/useReadout';\r\nimport {canPopout, popoutThread} from 'utils/popouts/popout_windows';\r\nimport {getSiteURL} from 'utils/url';\r\nimport {copyToClipboard} from 'utils/utils';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport {useThreadRouting} from '../../hooks';\r\n\r\nimport './thread_menu.scss';\r\n\r\ntype Props = {\r\n    threadId: UserThread['id'];\r\n    isFollowing?: boolean;\r\n    hasUnreads: boolean;\r\n    children: ReactNode;\r\n    unreadTimestamp: number;\r\n};\r\n\r\nfunction ThreadMenu({\r\n    threadId,\r\n    isFollowing = false,\r\n    unreadTimestamp,\r\n    hasUnreads,\r\n    children,\r\n}: Props) {\r\n    const intl = useIntl();\r\n    const {formatMessage} = intl;\r\n    const dispatch = useDispatch();\r\n    const {\r\n        params: {\r\n            team,\r\n        },\r\n        currentTeamId,\r\n        currentUserId,\r\n        goToInChannel,\r\n    } = useThreadRouting();\r\n\r\n    const isSaved = useSelector((state: GlobalState) => isPostFlagged(state, threadId));\r\n    const readAloud = useReadout();\r\n\r\n    const handleReadUnread = useCallback(() => {\r\n        readAloud(hasUnreads ? formatMessage({\r\n            id: 'threading.threadMenu.markedRead',\r\n            defaultMessage: 'Marked as read',\r\n        }) : formatMessage({\r\n            id: 'threading.threadMenu.markedUnread',\r\n            defaultMessage: 'Marked as unread',\r\n        }));\r\n        const lastViewedAt = hasUnreads ? Date.now() : unreadTimestamp;\r\n\r\n        dispatch(manuallyMarkThreadAsUnread(threadId, lastViewedAt));\r\n        if (hasUnreads) {\r\n            dispatch(updateThreadRead(currentUserId, currentTeamId, threadId, Date.now()));\r\n        } else {\r\n            dispatch(markLastPostInThreadAsUnread(currentUserId, currentTeamId, threadId));\r\n        }\r\n    }, [\r\n        currentUserId,\r\n        currentTeamId,\r\n        threadId,\r\n        hasUnreads,\r\n        updateThreadRead,\r\n        unreadTimestamp,\r\n    ]);\r\n\r\n    const popout = useCallback(() => {\r\n        popoutThread(intl, threadId, team, (postId, returnTo) => {\r\n            dispatch(focusPost(postId, returnTo, currentUserId, {skipRedirectReplyPermalink: true}));\r\n        });\r\n    }, [threadId, team, intl, dispatch, currentUserId]);\r\n\r\n    return (\r\n        <MenuWrapper\r\n            stopPropagationOnToggle={true}\r\n        >\r\n            {children}\r\n            <Menu\r\n                ariaLabel={formatMessage({\r\n                    id: 'threading.threadItem.menu',\r\n                    defaultMessage: 'Actions',\r\n                })}\r\n                openLeft={true}\r\n            >\r\n                {!canPopout() && (\r\n                    <Menu.ItemAction\r\n                        buttonClass='PopoutMenuItem'\r\n                        text={formatMessage({\r\n                            id: 'threading.threadMenu.openInNewWindow',\r\n                            defaultMessage: 'Open in new window',\r\n                        })}\r\n                        onClick={popout}\r\n                        icon={<i className='icon icon-dock-window'/>}\r\n                    />\r\n                )}\r\n                <Menu.ItemAction\r\n                    {...isFollowing ? {\r\n                        text: formatMessage({\r\n                            id: 'threading.threadMenu.unfollow',\r\n                            defaultMessage: 'Unfollow thread',\r\n                        }),\r\n                        extraText: formatMessage({\r\n                            id: 'threading.threadMenu.unfollowExtra',\r\n                            defaultMessage: 'You wonâ€™t be notified about replies',\r\n                        }),\r\n                    } : {\r\n                        text: formatMessage({\r\n                            id: 'threading.threadMenu.follow',\r\n                            defaultMessage: 'Follow thread',\r\n                        }),\r\n                        extraText: formatMessage({\r\n                            id: 'threading.threadMenu.followExtra',\r\n                            defaultMessage: 'You will be notified about replies',\r\n                        }),\r\n                    }}\r\n                    onClick={useCallback(() => {\r\n                        dispatch(setThreadFollow(currentUserId, currentTeamId, threadId, !isFollowing));\r\n                        readAloud(isFollowing ? formatMessage({\r\n                            id: 'threading.threadMenu.unfollowed',\r\n                            defaultMessage: 'Unfollowed thread',\r\n                        }) : formatMessage({\r\n                            id: 'threading.threadMenu.followed',\r\n                            defaultMessage: 'Followed thread',\r\n                        }));\r\n                    }, [currentUserId, currentTeamId, threadId, isFollowing, setThreadFollow, readAloud, formatMessage])}\r\n                />\r\n                <Menu.ItemAction\r\n                    text={formatMessage({\r\n                        id: 'threading.threadMenu.openInChannel',\r\n                        defaultMessage: 'Open in channel',\r\n                    })}\r\n                    onClick={useCallback(() => {\r\n                        goToInChannel(threadId);\r\n                        readAloud(formatMessage({\r\n                            id: 'threading.threadMenu.openingChannel',\r\n                            defaultMessage: 'Opening channel',\r\n                        }));\r\n                    }, [threadId, readAloud, formatMessage])}\r\n                />\r\n                <Menu.ItemAction\r\n                    text={hasUnreads ? formatMessage({\r\n                        id: 'threading.threadMenu.markRead',\r\n                        defaultMessage: 'Mark as read',\r\n                    }) : formatMessage({\r\n                        id: 'threading.threadMenu.markUnread',\r\n                        defaultMessage: 'Mark as unread',\r\n                    })}\r\n                    onClick={handleReadUnread}\r\n                />\r\n\r\n                <Menu.ItemAction\r\n                    text={isSaved ? formatMessage({\r\n                        id: 'threading.threadMenu.unsave',\r\n                        defaultMessage: 'Unsave',\r\n                    }) : formatMessage({\r\n                        id: 'threading.threadMenu.save',\r\n                        defaultMessage: 'Save',\r\n                    })}\r\n                    onClick={useCallback(() => {\r\n                        dispatch(isSaved ? unsavePost(threadId) : savePost(threadId));\r\n                        readAloud(isSaved ? formatMessage({\r\n                            id: 'threading.threadMenu.unsaved',\r\n                            defaultMessage: 'Unsaved',\r\n                        }) : formatMessage({\r\n                            id: 'threading.threadMenu.saved',\r\n                            defaultMessage: 'Saved',\r\n                        }));\r\n                    }, [threadId, isSaved])}\r\n                />\r\n                <Menu.ItemAction\r\n                    text={formatMessage({\r\n                        id: 'threading.threadMenu.copy',\r\n                        defaultMessage: 'Copy link',\r\n                    })}\r\n                    onClick={useCallback(() => {\r\n                        copyToClipboard(`${getSiteURL()}/${team}/pl/${threadId}`);\r\n                        readAloud(formatMessage({\r\n                            id: 'threading.threadMenu.linkCopied',\r\n                            defaultMessage: 'Link copied',\r\n                        }));\r\n                    }, [team, threadId])}\r\n                />\r\n            </Menu>\r\n        </MenuWrapper>\r\n    );\r\n}\r\n\r\nfunction areEqual(prevProps: Props, nextProps: Props) {\r\n    return (\r\n        prevProps.threadId === nextProps.threadId &&\r\n        prevProps.isFollowing === nextProps.isFollowing &&\r\n        prevProps.unreadTimestamp === nextProps.unreadTimestamp &&\r\n        prevProps.hasUnreads === nextProps.hasUnreads\r\n    );\r\n}\r\n\r\nexport default memo(ThreadMenu, areEqual);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {useCallback} from 'react';\r\nimport {useDispatch} from 'react-redux';\r\n\r\nimport {setReadout} from 'actions/views/root';\r\n\r\nexport const useReadout = () => {\r\n    const dispatch = useDispatch();\r\n\r\n    const readAloud = useCallback((message: string) => {\r\n        dispatch(setReadout(message));\r\n    }, [dispatch]);\r\n\r\n    return readAloud;\r\n};\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {memo, useCallback} from 'react';\r\nimport type {ReactNode} from 'react';\r\nimport {useIntl} from 'react-intl';\r\nimport {useSelector, useDispatch} from 'react-redux';\r\n\r\nimport {DotsVerticalIcon} from '@mattermost/compass-icons/components';\r\nimport type {UserThread, UserThreadSynthetic} from '@mattermost/types/threads';\r\n\r\nimport {setThreadFollow} from 'mattermost-redux/actions/threads';\r\nimport {makeGetChannel} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getPost, makeGetPostsForThread} from 'mattermost-redux/selectors/entities/posts';\r\n\r\nimport {focusPost} from 'components/permalink_view/actions';\r\nimport PopoutButton from 'components/popout_button';\r\nimport Header from 'components/widgets/header';\r\nimport WithTooltip from 'components/with_tooltip';\r\n\r\nimport {popoutThread} from 'utils/popouts/popout_windows';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport Button from '../../common/button';\r\nimport FollowButton from '../../common/follow_button';\r\nimport {useThreadRouting} from '../../hooks';\r\nimport ThreadMenu from '../thread_menu';\r\n\r\nimport './thread_pane.scss';\r\n\r\nconst getChannel = makeGetChannel();\r\nconst getPostsForThread = makeGetPostsForThread();\r\n\r\ntype Props = {\r\n    thread: UserThread | UserThreadSynthetic;\r\n    children?: ReactNode;\r\n};\r\n\r\nconst ThreadPane = ({\r\n    thread,\r\n    children,\r\n}: Props) => {\r\n    const intl = useIntl();\r\n    const {formatMessage} = intl;\r\n    const dispatch = useDispatch();\r\n    const {\r\n        params: {\r\n            team,\r\n        },\r\n        currentTeamId,\r\n        currentUserId,\r\n        goToInChannel,\r\n        select,\r\n    } = useThreadRouting();\r\n\r\n    const {\r\n        id: threadId,\r\n        is_following: isFollowing,\r\n        post: {\r\n            channel_id: channelId,\r\n        },\r\n    } = thread;\r\n\r\n    const channel = useSelector((state: GlobalState) => getChannel(state, channelId));\r\n    const post = useSelector((state: GlobalState) => getPost(state, thread.id));\r\n    const postsInThread = useSelector((state: GlobalState) => getPostsForThread(state, post.id));\r\n    const selectHandler = useCallback(() => select(), []);\r\n    let unreadTimestamp = post.edit_at || post.create_at;\r\n\r\n    // if we have the whole thread, get the posts in it, sorted from newest to oldest.\r\n    // First post is latest reply. Use that timestamp\r\n    if (postsInThread.length > 1) {\r\n        const p = postsInThread[0];\r\n        unreadTimestamp = p.edit_at || p.create_at;\r\n    }\r\n    const goToInChannelHandler = useCallback(() => {\r\n        goToInChannel(threadId);\r\n    }, [goToInChannel, threadId]);\r\n\r\n    const followHandler = useCallback(() => {\r\n        dispatch(setThreadFollow(currentUserId, currentTeamId, threadId, !isFollowing));\r\n    }, [dispatch, currentUserId, currentTeamId, threadId, isFollowing]);\r\n\r\n    const popout = useCallback(() => {\r\n        popoutThread(intl, threadId, team, (postId, returnTo) => {\r\n            dispatch(focusPost(postId, returnTo, currentUserId, {skipRedirectReplyPermalink: true}));\r\n        });\r\n    }, [threadId, team, intl, dispatch, currentUserId]);\r\n\r\n    return (\r\n        <div\r\n            id={'thread-pane-container'}\r\n            className='ThreadPane'\r\n        >\r\n            <Header\r\n                className='ThreadPane___header'\r\n                heading={(\r\n                    <>\r\n                        <Button\r\n                            className='Button___icon Button___large back'\r\n                            onClick={selectHandler}\r\n                        >\r\n                            <i className='icon icon-arrow-back-ios'/>\r\n                        </Button>\r\n                        <h3>\r\n                            <span className='separated'>\r\n                                {formatMessage({\r\n                                    id: 'threading.header.heading',\r\n                                    defaultMessage: 'Thread',\r\n                                })}\r\n                            </span>\r\n                            <Button\r\n                                className='separated'\r\n                                allowTextOverflow={true}\r\n                                onClick={goToInChannelHandler}\r\n                            >\r\n                                {channel?.display_name}\r\n                            </Button>\r\n                        </h3>\r\n                    </>\r\n                )}\r\n                right={(\r\n                    <>\r\n                        <FollowButton\r\n                            isFollowing={isFollowing}\r\n                            onClick={followHandler}\r\n                        />\r\n                        <PopoutButton onClick={popout}/>\r\n                        <ThreadMenu\r\n                            threadId={threadId}\r\n                            isFollowing={isFollowing}\r\n                            hasUnreads={isFollowing && Boolean((thread as UserThread).unread_replies || (thread as UserThread).unread_mentions)}\r\n                            unreadTimestamp={unreadTimestamp}\r\n                        >\r\n                            <WithTooltip\r\n                                title={formatMessage({\r\n                                    id: 'threading.threadHeader.menu',\r\n                                    defaultMessage: 'More Actions',\r\n                                })}\r\n                            >\r\n                                <Button className='Button___icon Button___large'>\r\n                                    <DotsVerticalIcon size={18}/>\r\n                                </Button>\r\n                            </WithTooltip>\r\n                        </ThreadMenu>\r\n                    </>\r\n                )}\r\n            />\r\n            {children}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default memo(ThreadPane);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {useMemo, useCallback} from 'react';\r\nimport {useSelector, shallowEqual} from 'react-redux';\r\nimport {useParams, useHistory} from 'react-router-dom';\r\n\r\nimport type {Team} from '@mattermost/types/teams';\r\nimport type {UserThread} from '@mattermost/types/threads';\r\n\r\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\r\n\r\n/**\r\n * GlobalThreads-specific hook for nav/routing, selection, and common data needed for actions.\r\n */\r\nexport function useThreadRouting() {\r\n    const matchParams = useParams<{team: string; threadIdentifier?: UserThread['id']}>();\r\n    const params = useMemo(() => matchParams, [matchParams.threadIdentifier, matchParams.team]);\r\n    const history = useHistory();\r\n\r\n    const currentTeamId = useSelector(getCurrentTeamId, shallowEqual);\r\n    const currentUserId = useSelector(getCurrentUserId, shallowEqual);\r\n\r\n    const select = useCallback((threadId?: UserThread['id']) => {\r\n        return history.push(`/${params.team}/threads${threadId ? '/' + threadId : ''}`);\r\n    }, [params.team]);\r\n\r\n    const clear = useCallback(() => history.replace(`/${params.team}/threads`), [params.team]);\r\n\r\n    const goToInChannel = useCallback((threadId?: UserThread['id'], teamName: Team['name'] = params.team) => {\r\n        return history.push(`/${teamName}/pl/${threadId ?? params.threadIdentifier}`);\r\n    }, [params.threadIdentifier, params.team]);\r\n\r\n    return {\r\n        params,\r\n        history,\r\n        currentTeamId,\r\n        currentUserId,\r\n        clear,\r\n        select,\r\n        goToInChannel,\r\n    };\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {injectIntl} from 'react-intl';\r\nimport type {IntlShape} from 'react-intl';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport {basicUnreadMeta} from 'mattermost-redux/selectors/entities/channels';\r\nimport type {BasicUnreadStatus} from 'mattermost-redux/selectors/entities/channels';\r\nimport {ensureString} from 'mattermost-redux/utils/post_utils';\r\n\r\nimport faviconDefault16x16 from 'images/favicon/favicon-default-16x16.png';\r\nimport faviconDefault24x24 from 'images/favicon/favicon-default-24x24.png';\r\nimport faviconDefault32x32 from 'images/favicon/favicon-default-32x32.png';\r\nimport faviconDefault64x64 from 'images/favicon/favicon-default-64x64.png';\r\nimport faviconDefault96x96 from 'images/favicon/favicon-default-96x96.png';\r\nimport faviconMention16x16 from 'images/favicon/favicon-mentions-16x16.png';\r\nimport faviconMention24x24 from 'images/favicon/favicon-mentions-24x24.png';\r\nimport faviconMention32x32 from 'images/favicon/favicon-mentions-32x32.png';\r\nimport faviconMention64x64 from 'images/favicon/favicon-mentions-64x64.png';\r\nimport faviconMention96x96 from 'images/favicon/favicon-mentions-96x96.png';\r\nimport faviconUnread16x16 from 'images/favicon/favicon-unread-16x16.png';\r\nimport faviconUnread24x24 from 'images/favicon/favicon-unread-24x24.png';\r\nimport faviconUnread32x32 from 'images/favicon/favicon-unread-32x32.png';\r\nimport faviconUnread64x64 from 'images/favicon/favicon-unread-64x64.png';\r\nimport faviconUnread96x96 from 'images/favicon/favicon-unread-96x96.png';\r\nimport {Constants} from 'utils/constants';\r\nimport DesktopApp from 'utils/desktop_api';\r\nimport * as UserAgent from 'utils/user_agent';\r\n\r\nenum BadgeStatus {\r\n    Mention = 'Mention',\r\n    Unread = 'Unread',\r\n    None = 'None'\r\n}\r\n\r\ntype Props = {\r\n    intl: IntlShape;\r\n    unreadStatus: BasicUnreadStatus;\r\n    siteName?: string;\r\n    currentChannel?: Channel;\r\n    currentTeam?: Team;\r\n    currentTeammate: Channel | null;\r\n    inGlobalThreads: boolean;\r\n    inDrafts: boolean;\r\n    inScheduledPosts: boolean;\r\n};\r\n\r\nexport class UnreadsStatusHandlerClass extends React.PureComponent<Props> {\r\n    componentDidUpdate(prevProps: Props) {\r\n        this.updateTitle();\r\n        const oldBadgeStatus = this.getBadgeStatus(prevProps.unreadStatus);\r\n        const newBadgeStatus = this.getBadgeStatus(this.props.unreadStatus);\r\n\r\n        if (oldBadgeStatus !== newBadgeStatus) {\r\n            this.updateFavicon(newBadgeStatus);\r\n        }\r\n\r\n        this.updateDesktopApp();\r\n    }\r\n\r\n    get isDynamicFaviconSupported() {\r\n        return UserAgent.isChrome() || UserAgent.isFirefox();\r\n    }\r\n\r\n    getBadgeStatus(unreadStatus: BasicUnreadStatus) {\r\n        if (typeof unreadStatus === 'number') {\r\n            return BadgeStatus.Mention;\r\n        } else if (unreadStatus) {\r\n            return BadgeStatus.Unread;\r\n        }\r\n        return BadgeStatus.None;\r\n    }\r\n\r\n    updateDesktopApp = () => {\r\n        const {unreadStatus} = this.props;\r\n        const {isUnread, unreadMentionCount} = basicUnreadMeta(unreadStatus);\r\n\r\n        DesktopApp.updateUnreadsAndMentions(isUnread, unreadMentionCount);\r\n    };\r\n\r\n    updateTitle = () => {\r\n        const {\r\n            siteName,\r\n            currentChannel,\r\n            currentTeam,\r\n            currentTeammate,\r\n            unreadStatus,\r\n            inGlobalThreads,\r\n            inDrafts,\r\n            inScheduledPosts,\r\n        } = this.props;\r\n        const {formatMessage} = this.props.intl;\r\n\r\n        const currentSiteName = siteName || '';\r\n\r\n        const {isUnread, unreadMentionCount} = basicUnreadMeta(unreadStatus);\r\n\r\n        const mentionTitle = unreadMentionCount > 0 ? `(${unreadMentionCount}) ` : '';\r\n        const unreadTitle = !this.isDynamicFaviconSupported && isUnread ? '* ' : '';\r\n\r\n        if (currentChannel && currentTeam && currentChannel.id) {\r\n            let currentChannelName = currentChannel.display_name;\r\n            if (currentChannel.type === Constants.DM_CHANNEL) {\r\n                if (currentTeammate != null) {\r\n                    currentChannelName = currentTeammate.display_name;\r\n                }\r\n            }\r\n            document.title = `${mentionTitle}${unreadTitle}${currentChannelName} - ${currentTeam.display_name} ${currentSiteName}`;\r\n        } else if (currentTeam && inGlobalThreads) {\r\n            document.title = formatMessage({\r\n                id: 'globalThreads.title',\r\n                defaultMessage: '{prefix}Threads - {displayName} {siteName}',\r\n            }, {\r\n                prefix: `${mentionTitle}${unreadTitle}`,\r\n                displayName: currentTeam.display_name,\r\n                siteName: currentSiteName,\r\n            });\r\n        } else if (currentTeam && inDrafts) {\r\n            document.title = formatMessage({\r\n                id: 'drafts.title',\r\n                defaultMessage: '{prefix}Drafts - {displayName} {siteName}',\r\n            }, {\r\n                prefix: `${mentionTitle}${unreadTitle}`,\r\n                displayName: currentTeam.display_name,\r\n                siteName: currentSiteName,\r\n            });\r\n        } else if (currentTeam && inScheduledPosts) {\r\n            document.title = formatMessage({\r\n                id: 'scheduledPosts.title',\r\n                defaultMessage: '{prefix}Scheduled - {displayName} {siteName}',\r\n            }, {\r\n                prefix: `${mentionTitle}${unreadTitle}`,\r\n                displayName: currentTeam.display_name,\r\n                siteName: currentSiteName,\r\n            });\r\n        } else {\r\n            document.title = formatMessage({id: 'sidebar.team_select', defaultMessage: '{siteName} - Join a team'}, {siteName: currentSiteName || 'Mattermost'});\r\n        }\r\n    };\r\n\r\n    updateFavicon = (badgeStatus: BadgeStatus) => {\r\n        if (!(UserAgent.isFirefox() || UserAgent.isChrome())) {\r\n            return;\r\n        }\r\n\r\n        const link = document.querySelector('link[rel=\"icon\"]');\r\n\r\n        if (!link) {\r\n            return;\r\n        }\r\n        const link16x16 = document.querySelector<HTMLLinkElement>('link[rel=\"icon\"][sizes=\"16x16\"]');\r\n        const link24x24 = document.querySelector<HTMLLinkElement>('link[rel=\"icon\"][sizes=\"24x24\"]');\r\n        const link32x32 = document.querySelector<HTMLLinkElement>('link[rel=\"icon\"][sizes=\"32x32\"]');\r\n        const link64x64 = document.querySelector<HTMLLinkElement>('link[rel=\"icon\"][sizes=\"64x64\"]');\r\n        const link96x96 = document.querySelector<HTMLLinkElement>('link[rel=\"icon\"][sizes=\"96x96\"]');\r\n\r\n        const getFavicon = (url: string): string => ensureString(url);\r\n\r\n        switch (badgeStatus) {\r\n        case BadgeStatus.Mention: {\r\n            link16x16!.href = getFavicon(faviconMention16x16);\r\n            link24x24!.href = getFavicon(faviconMention24x24);\r\n            link32x32!.href = getFavicon(faviconMention32x32);\r\n            link64x64!.href = getFavicon(faviconMention64x64);\r\n            link96x96!.href = getFavicon(faviconMention96x96);\r\n            break;\r\n        }\r\n        case BadgeStatus.Unread: {\r\n            link16x16!.href = getFavicon(faviconUnread16x16);\r\n            link24x24!.href = getFavicon(faviconUnread24x24);\r\n            link32x32!.href = getFavicon(faviconUnread32x32);\r\n            link64x64!.href = getFavicon(faviconUnread64x64);\r\n            link96x96!.href = getFavicon(faviconUnread96x96);\r\n            break;\r\n        }\r\n        default: {\r\n            link16x16!.href = getFavicon(faviconDefault16x16);\r\n            link24x24!.href = getFavicon(faviconDefault24x24);\r\n            link32x32!.href = getFavicon(faviconDefault32x32);\r\n            link64x64!.href = getFavicon(faviconDefault64x64);\r\n            link96x96!.href = getFavicon(faviconDefault96x96);\r\n        }\r\n        }\r\n    };\r\n\r\n    render() {\r\n        return null;\r\n    }\r\n}\r\n\r\nexport default injectIntl(UnreadsStatusHandlerClass);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {Location} from 'history';\r\nimport {connect} from 'react-redux';\r\nimport {withRouter, matchPath} from 'react-router-dom';\r\n\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {getCurrentChannel, getUnreadStatus} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport UnreadsStatusHandler from './unreads_status_handler';\r\n\r\ntype Props = {location: Location};\r\n\r\nfunction mapStateToProps(state: GlobalState, {location: {pathname}}: Props) {\r\n    const config = getConfig(state);\r\n    const currentChannel = getCurrentChannel(state);\r\n    const currentTeammate = (currentChannel && currentChannel.teammate_id) ? currentChannel : null;\r\n    const currentTeam = getCurrentTeam(state);\r\n\r\n    return {\r\n        currentChannel,\r\n        currentTeam,\r\n        currentTeammate,\r\n        siteName: config.SiteName,\r\n        unreadStatus: getUnreadStatus(state),\r\n        inGlobalThreads: matchPath(pathname, {path: '/:team/threads/:threadIdentifier?'}) != null,\r\n        inDrafts: matchPath(pathname, {path: '/:team/drafts'}) != null,\r\n        inScheduledPosts: matchPath(pathname, {path: '/:team/scheduled_posts'}) != null,\r\n    };\r\n}\r\n\r\nexport default withRouter(connect(mapStateToProps)(UnreadsStatusHandler));\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React, {Fragment} from 'react';\r\nimport type {ReactNode, HTMLAttributes} from 'react';\r\n\r\nimport './header.scss';\r\n\r\ntype Props = {\r\n    heading: ReactNode;\r\n    level?: 0 | 1 | 2 | 3 | 4 | 5 | 6;\r\n    subtitle?: ReactNode;\r\n    right?: ReactNode;\r\n};\r\n\r\ntype HeadingTag = keyof Pick<JSX.IntrinsicElements, 'h1' | 'h2' | 'h3' | 'h4' | 'h5' | 'h6'>;\r\n\r\nconst Headings: Array<typeof Fragment | HeadingTag> = [Fragment, 'h1', 'h2', 'h3', 'h4', 'h5', 'h6'];\r\n\r\nconst Header = ({\r\n    level = 0,\r\n    heading,\r\n    subtitle,\r\n    right,\r\n    ...attrs\r\n}: Props & HTMLAttributes<HTMLElement>) => {\r\n    const H = Headings[level];\r\n    return (\r\n        <div\r\n            {...attrs}\r\n            className={classNames('Header', attrs.className)}\r\n        >\r\n            <div className='left'>\r\n                <H>{heading}</H>\r\n                {subtitle ? <p>{subtitle}</p> : null}\r\n            </div>\r\n            <div className='spacer'/>\r\n            {right}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Header;\r\n"],"names":["ModalController","_ref","modals","actions","modalState","modalOutput","modalId","Object","hasOwn","modal","open","modalComponent","React","dialogType","assign","dialogProps","onExited","_modal$dialogProps","_modal$dialogProps$on","closeModal","call","onHide","bind","key","concat","push","propTypes","_pt","isRequired","connect","state","views","dispatch","bindActionCreators","PopoutButton","onClick","className","intl","useIntl","canPopout","WithTooltip","title","FormattedMessage","id","defaultMessage","type","classNames","formatMessage","RhsPluginPopout","pluginId","useParams","showPluggable","pluggableId","useSelector","pluginComponent","plugins","components","RightHandSidebarComponent","find","element","pluginTitle","componentId","Boolean","SearchResultsHeader","Pluggable","pluggableName","LoadingScreen","RhsPopout","match","useRouteMatch","useDispatch","team","teamName","identifier","channelIdentifier","useTeamByName","channel","getChannelByName","teamId","channelId","useEffect","selectChannel","getChannelMembers","selectTeam","fetchChannelsAndMembers","UnreadsStatusHandler","Switch","Route","path","component","ThreadPopout","getThreadOrSynthetic","useMemo","makeGetThreadOrSynthetic","postId","currentUserId","getCurrentUserId","post","usePost","getTeamByName","thread","channel_id","async","fetchPostThread","data","posts","getPostThread","result","extractUserIdsAndMentionsFromPosts","Array","from","values","userIdsForProfilePoll","length","getProfilesByIds","userIdsForStatusPoll","loadStatusesByIds","getThread","handleFocus","window","isActive","markThreadAsRead","handleBlur","addEventListener","removeEventListener","ThreadPane","ThreadViewer","rootPostId","useRelativeTimestamp","isThreadView","routeProps","useBrowserPopout","document","body","classList","add","getMe","LoggedIn","TEAM_NAME_PATH_PATTERN","ID_PATH_PATTERN","IDENTIFIER_PATH_PATTERN","props","showExpand","previousRhsState","RHSStates","CHANNEL_INFO","sidebarTooltipContent","isExpanded","KeyboardShortcutSequence","shortcut","KEYBOARD_SHORTCUTS","navExpandSidebar","hideDescription","isInsideTooltip","expandOrCollapseSidebarButtonAriaLabel","canGoBack","goBack","children","isPopoutWindow","toggleRhsExpanded","newWindowHandler","closeRightHandSide","getPreviousRhsState","CHANNEL_MEMBERS","CHANNEL_FILES","PIN","getIsRhsExpanded","getCurrentChannelId","ThreadMenu","threadId","isFollowing","unreadTimestamp","hasUnreads","params","currentTeamId","goToInChannel","useThreadRouting","isSaved","isPostFlagged","readAloud","useReadout","useCallback","message","setReadout","handleReadUnread","lastViewedAt","Date","now","manuallyMarkThreadAsUnread","updateThreadRead","markLastPostInThreadAsUnread","popout","popoutThread","returnTo","focusPost","skipRedirectReplyPermalink","MenuWrapper","stopPropagationOnToggle","Menu","ariaLabel","openLeft","ItemAction","buttonClass","text","icon","extraText","setThreadFollow","unsavePost","savePost","copyToClipboard","getSiteURL","areEqual","prevProps","nextProps","memo","getChannel","makeGetChannel","getPostsForThread","makeGetPostsForThread","select","is_following","getPost","postsInThread","selectHandler","edit_at","create_at","p","goToInChannelHandler","followHandler","Header","heading","Button","allowTextOverflow","display_name","right","FollowButton","unread_replies","unread_mentions","DotsVerticalIcon","size","matchParams","threadIdentifier","history","useHistory","getCurrentTeamId","shallowEqual","clear","replace","arguments","undefined","BadgeStatus","UnreadsStatusHandlerClass","constructor","_defineProperty","unreadStatus","this","isUnread","unreadMentionCount","basicUnreadMeta","DesktopApp","updateUnreadsAndMentions","siteName","currentChannel","currentTeam","currentTeammate","inGlobalThreads","inDrafts","inScheduledPosts","currentSiteName","mentionTitle","unreadTitle","isDynamicFaviconSupported","currentChannelName","Constants","DM_CHANNEL","prefix","displayName","badgeStatus","UserAgent","querySelector","link16x16","link24x24","link32x32","link64x64","link96x96","getFavicon","url","ensureString","Mention","href","faviconMention16x16","faviconMention24x24","faviconMention32x32","faviconMention64x64","faviconMention96x96","Unread","faviconUnread16x16","faviconUnread24x24","faviconUnread32x32","faviconUnread64x64","faviconUnread96x96","faviconDefault16x16","faviconDefault24x24","faviconDefault32x32","faviconDefault64x64","faviconDefault96x96","componentDidUpdate","updateTitle","oldBadgeStatus","getBadgeStatus","newBadgeStatus","updateFavicon","updateDesktopApp","None","render","injectIntl","withRouter","location","pathname","config","getConfig","getCurrentChannel","teammate_id","getCurrentTeam","SiteName","getUnreadStatus","matchPath","Headings","Fragment","level","subtitle","attrs","_objectWithoutProperties","_excluded","H"],"sourceRoot":""}