{"version":3,"file":"4446.c60a196a53e7954e9459.js","mappings":"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","sources":["webpack://mattermost-webapp/./src/components/channel_bookmarks/bookmark_icon.tsx","webpack://mattermost-webapp/./src/components/channel_bookmarks/create_modal_name_input.tsx","webpack://mattermost-webapp/./src/components/channel_bookmarks/channel_bookmarks_create_modal.tsx","webpack://mattermost-webapp/./src/components/channel_bookmarks/channel_bookmarks_menu.tsx"],"sourcesContent":["// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {useSelector} from 'react-redux';\r\nimport styled from 'styled-components';\r\n\r\nimport {FileGenericOutlineIcon, BookOutlineIcon} from '@mattermost/compass-icons/components';\r\nimport type {ChannelBookmark} from '@mattermost/types/channel_bookmarks';\r\nimport type {FileInfo} from '@mattermost/types/files';\r\n\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\n\r\nimport RenderEmoji from 'components/emoji/render_emoji';\r\nimport FileThumbnail from 'components/file_attachment/file_thumbnail';\r\nimport type {FilePreviewInfo} from 'components/file_preview/file_preview';\r\n\r\nimport {trimmedEmojiName} from 'utils/emoji_utils';\r\nimport {getImageSrc} from 'utils/post_utils';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\ntype Props = {\r\n    type: ChannelBookmark['type'];\r\n    emoji?: string;\r\n    imageUrl?: string;\r\n    fileInfo?: FileInfo | FilePreviewInfo;\r\n    size?: 16 | 24;\r\n}\r\n\r\nconst BookmarkIcon = ({\r\n    type,\r\n    emoji,\r\n    imageUrl,\r\n    fileInfo,\r\n    size = 16,\r\n}: Props) => {\r\n    let icon = type === 'link' ? <BookOutlineIcon size={size}/> : <FileGenericOutlineIcon size={size}/>;\r\n    const emojiName = emoji && trimmedEmojiName(emoji);\r\n    const hasImageProxy = useSelector((state: GlobalState) => getConfig(state).HasImageProxy === 'true');\r\n\r\n    if (emojiName) {\r\n        icon = (\r\n            <RenderEmoji\r\n                emojiName={emojiName}\r\n                size={size}\r\n            />\r\n        );\r\n    } else if (imageUrl) {\r\n        icon = (\r\n            <BookmarkIconImg\r\n                src={getImageSrc(imageUrl, hasImageProxy)}\r\n                size={size}\r\n            />\r\n        );\r\n    } else if (fileInfo) {\r\n        icon = (\r\n            <FileThumbnail\r\n                fileInfo={fileInfo}\r\n                disablePreview={true}\r\n            />\r\n        );\r\n    }\r\n\r\n    return (\r\n        <Icon $size={size}>\r\n            {icon}\r\n        </Icon>\r\n    );\r\n};\r\n\r\nexport default BookmarkIcon;\r\n\r\nconst Icon = styled.div<{$size: number}>`\r\n    padding: 3px 1px 3px 2px;\r\n    flex-shrink: 0;\r\n    display: flex;\r\n    align-items: center;\r\n\r\n    .file-icon {\r\n        width: ${({$size: size}) => size}px;\r\n        height: ${({$size: size}) => size}px;\r\n        background-size: ${({$size: size}) => size * 0.8}px ${({$size: size}) => size}px;\r\n        margin-top: 1px;\r\n    }\r\n\r\n`;\r\n\r\nconst BookmarkIconImg = styled.img<{size: number}>`\r\n    width: ${({size}) => size}px;\r\n    height: ${({size}) => size}px;\r\n`;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback, useRef} from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\nimport styled from 'styled-components';\r\n\r\nimport {ChevronDownIcon} from '@mattermost/compass-icons/components';\r\nimport type {ChannelBookmark} from '@mattermost/types/channel_bookmarks';\r\nimport type {Emoji} from '@mattermost/types/emojis';\r\nimport type {FileInfo} from '@mattermost/types/files';\r\n\r\nimport useEmojiPicker from 'components/emoji_picker/use_emoji_picker';\r\nimport Input from 'components/widgets/inputs/input/input';\r\n\r\nimport Constants, {A11yCustomEventTypes, type A11yFocusEventDetail} from 'utils/constants';\r\nimport {isKeyPressed} from 'utils/keyboard';\r\n\r\nimport BookmarkIcon from './bookmark_icon';\r\n\r\ntype Props = {\r\n    maxLength: number;\r\n    type: ChannelBookmark['type'];\r\n    fileInfo: FileInfo | undefined;\r\n    imageUrl: string | undefined;\r\n    emoji: string | undefined;\r\n    setEmoji: React.Dispatch<React.SetStateAction<string>>;\r\n    placeholder: string | undefined;\r\n    displayName: string | undefined;\r\n    setDisplayName: React.Dispatch<React.SetStateAction<string | undefined>>;\r\n    showEmojiPicker: boolean;\r\n    setShowEmojiPicker: React.Dispatch<React.SetStateAction<boolean>>;\r\n    onAddCustomEmojiClick?: () => void;\r\n}\r\nconst CreateModalNameInput = ({\r\n    maxLength,\r\n    type,\r\n    imageUrl,\r\n    fileInfo,\r\n    emoji,\r\n    setEmoji,\r\n    placeholder,\r\n    displayName,\r\n    setDisplayName,\r\n    showEmojiPicker,\r\n    setShowEmojiPicker,\r\n    onAddCustomEmojiClick,\r\n}: Props) => {\r\n    const {formatMessage} = useIntl();\r\n\r\n    const targetRef = useRef<HTMLButtonElement>(null);\r\n\r\n    const icon = (\r\n        <BookmarkIcon\r\n            type={type}\r\n            size={24}\r\n            emoji={emoji}\r\n            fileInfo={fileInfo}\r\n            imageUrl={imageUrl}\r\n        />\r\n    );\r\n\r\n    const refocusEmojiButton = () => {\r\n        if (!targetRef.current) {\r\n            return;\r\n        }\r\n\r\n        document.dispatchEvent(new CustomEvent<A11yFocusEventDetail>(\r\n            A11yCustomEventTypes.FOCUS, {\r\n                detail: {\r\n                    target: targetRef.current,\r\n                    keyboardOnly: true,\r\n                },\r\n            },\r\n        ));\r\n    };\r\n\r\n    const toggleEmojiPicker = () => setShowEmojiPicker((prev) => !prev);\r\n\r\n    const handleEmojiClick = (selectedEmoji: Emoji) => {\r\n        setShowEmojiPicker(false);\r\n        const emojiName = ('short_name' in selectedEmoji) ? selectedEmoji.short_name : selectedEmoji.name;\r\n        setEmoji(`:${emojiName}:`);\r\n        refocusEmojiButton();\r\n    };\r\n\r\n    const handleEmojiClear = () => {\r\n        setEmoji('');\r\n    };\r\n\r\n    const handleInputChange = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\r\n        setDisplayName(e.currentTarget.value);\r\n    }, []);\r\n\r\n    const handleEmojiKeyDown = (e: React.KeyboardEvent<HTMLButtonElement>) => {\r\n        if (isKeyPressed(e, Constants.KeyCodes.ENTER)) {\r\n            e.stopPropagation();\r\n        }\r\n    };\r\n\r\n    const handleEmojiResetKeyDown = (e: React.KeyboardEvent<HTMLAnchorElement>) => {\r\n        if (isKeyPressed(e, Constants.KeyCodes.ENTER) || isKeyPressed(e, Constants.KeyCodes.SPACE)) {\r\n            e.stopPropagation();\r\n            handleEmojiClear();\r\n        }\r\n    };\r\n\r\n    const {\r\n        emojiPicker,\r\n        getReferenceProps,\r\n        setReference,\r\n    } = useEmojiPicker({\r\n        showEmojiPicker,\r\n        setShowEmojiPicker,\r\n\r\n        onAddCustomEmojiClick,\r\n        onEmojiClick: handleEmojiClick,\r\n    });\r\n\r\n    return (\r\n        <>\r\n            <NameWrapper>\r\n                <button\r\n                    ref={setReference}\r\n                    type='button'\r\n                    onClick={toggleEmojiPicker}\r\n                    onKeyDown={handleEmojiKeyDown}\r\n                    aria-label={formatMessage({id: 'emoji_picker.emojiPicker.button.ariaLabel', defaultMessage: 'select an emoji'})}\r\n                    className='channelBookmarksMenuButton emoji-picker__container BookmarkCreateModal__emoji-button'\r\n                    {...getReferenceProps()}\r\n                >\r\n                    {icon}\r\n                    <ChevronDownIcon size={'12px'}/>\r\n                </button>\r\n                {emojiPicker}\r\n                <Input\r\n                    maxLength={maxLength}\r\n                    type='text'\r\n                    name='bookmark-display-name'\r\n                    onChange={handleInputChange}\r\n                    value={displayName ?? placeholder ?? ''}\r\n                    placeholder={placeholder}\r\n                    data-testid='titleInput'\r\n                    useLegend={false}\r\n                />\r\n                <Clear\r\n                    visible={Boolean(emoji)}\r\n                    tabIndex={0}\r\n                    onClick={handleEmojiClear}\r\n                    onKeyDown={handleEmojiResetKeyDown}\r\n                >\r\n                    <FormattedMessage\r\n                        id='channel_bookmarks.create.title_input.clear_emoji'\r\n                        defaultMessage='Remove emoji'\r\n                    />\r\n                </Clear>\r\n            </NameWrapper>\r\n        </>\r\n    );\r\n};\r\n\r\nconst Clear = styled.a<{visible: boolean}>`\r\n    font-size: 12px;\r\n    visibility: ${({visible}) => (visible ? 'visible' : 'hidden')};\r\n`;\r\n\r\nconst NameWrapper = styled.div`\r\n    position: relative;\r\n\r\n    > button {\r\n        position: absolute;\r\n        left: 1px;\r\n        top: 1px;\r\n        z-index: 5;\r\n        width: 57px;\r\n        height: 44px;\r\n        border-radius: 4px 0 0 4px;\r\n        border-right: 1px solid rgba(var(--center-channel-color-rgb), 0.16);\r\n\r\n        align-items: center;\r\n        justify-content: center;\r\n        gap: 0;\r\n        padding-left: 6px;\r\n        padding-right: 2px;\r\n\r\n        svg {\r\n            flex-shrink: 0;\r\n        }\r\n    }\r\n\r\n    .Input_container {\r\n\r\n    }\r\n\r\n    .Input_wrapper {\r\n        padding-left: 7rem;\r\n    }\r\n`;\r\n\r\nexport default CreateModalNameInput;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {ChangeEvent, MouseEvent, ReactNode} from 'react';\r\nimport React, {useCallback, useEffect, useRef, useState} from 'react';\r\nimport {FormattedMessage, defineMessages, useIntl} from 'react-intl';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\nimport styled from 'styled-components';\r\n\r\nimport {PencilOutlineIcon, CheckIcon} from '@mattermost/compass-icons/components';\r\nimport {GenericModal} from '@mattermost/components';\r\nimport type {ChannelBookmark, ChannelBookmarkCreate, ChannelBookmarkPatch} from '@mattermost/types/channel_bookmarks';\r\nimport type {FileInfo} from '@mattermost/types/files';\r\n\r\nimport {getFile} from 'mattermost-redux/selectors/entities/files';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport type {UploadFile} from 'actions/file_actions';\r\nimport {uploadFile} from 'actions/file_actions';\r\n\r\nimport FileAttachment from 'components/file_attachment';\r\nimport type {FilePreviewInfo} from 'components/file_preview/file_preview';\r\nimport FileProgressPreview from 'components/file_preview/file_progress_preview';\r\nimport Input from 'components/widgets/inputs/input/input';\r\nimport LoadingSpinner from 'components/widgets/loading/loading_spinner';\r\n\r\nimport Constants from 'utils/constants';\r\nimport {isKeyPressed} from 'utils/keyboard';\r\nimport {removeScheme, validHttpUrl} from 'utils/url';\r\nimport {generateId} from 'utils/utils';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport './bookmark_create_modal.scss';\r\n\r\nimport CreateModalNameInput from './create_modal_name_input';\r\nimport {useCanUploadFiles} from './utils';\r\n\r\nconst MAX_LINK_LENGTH = 1024;\r\nconst MAX_TITLE_LENGTH = 64;\r\n\r\ntype Props = {\r\n    channelId: string;\r\n    bookmarkType?: ChannelBookmark['type'];\r\n    file?: File;\r\n    onExited: () => void;\r\n    onHide: () => void;\r\n} & ({\r\n    bookmark: ChannelBookmark;\r\n    onConfirm: (data: ChannelBookmarkPatch) => Promise<ActionResult<boolean, any>> | ActionResult<boolean, any>;\r\n} | {\r\n    bookmark?: never;\r\n    onConfirm: (data: ChannelBookmarkCreate) => Promise<ActionResult<boolean, any>> | ActionResult<boolean, any>;\r\n});\r\n\r\nfunction ChannelBookmarkCreateModal({\r\n    bookmark,\r\n    bookmarkType,\r\n    file: promptedFile,\r\n    channelId,\r\n    onExited,\r\n    onConfirm,\r\n    onHide,\r\n}: Props) {\r\n    const {formatMessage} = useIntl();\r\n    const dispatch = useDispatch();\r\n\r\n    // common\r\n    const type = bookmark?.type ?? bookmarkType ?? 'link';\r\n    const [showEmojiPicker, setShowEmojiPicker] = useState(false);\r\n    const [emoji, setEmoji] = useState(bookmark?.emoji ?? '');\r\n    const [displayName, setDisplayName] = useState<string | undefined>(bookmark?.display_name);\r\n    const [parsedDisplayName, setParsedDisplayName] = useState<string | undefined>();\r\n    const [saving, setSaving] = useState(false);\r\n    const [saveError, setSaveError] = useState('');\r\n\r\n    const handleKeyDown = useCallback((event: KeyboardEvent) => {\r\n        if (isKeyPressed(event, Constants.KeyCodes.ESCAPE) && !showEmojiPicker) {\r\n            onHide();\r\n        }\r\n    }, [showEmojiPicker, onHide]);\r\n\r\n    useEffect(() => {\r\n        document.addEventListener('keydown', handleKeyDown);\r\n\r\n        return () => {\r\n            document.removeEventListener('keydown', handleKeyDown);\r\n        };\r\n    }, [handleKeyDown]);\r\n\r\n    // type === 'link'\r\n    const icon = bookmark?.image_url;\r\n    const [link, setLinkInner] = useState(bookmark?.link_url ?? '');\r\n    const prevLink = useRef(link);\r\n    const [validatedLink, setValidatedLink] = useState<string>();\r\n    const setLink = useCallback((value: string) => {\r\n        setLinkInner((currentLink) => {\r\n            prevLink.current = currentLink;\r\n            return value;\r\n        });\r\n        if (!value) {\r\n            setValidatedLink(undefined);\r\n        }\r\n    }, []);\r\n\r\n    const [linkError, {loading: checkingLink, suppressed: linkErrorBypass}] = useBookmarkLinkValidation(link === prevLink.current ? '' : link, (validatedLink, forced) => {\r\n        if (!forced) {\r\n            setValidatedLink(validatedLink);\r\n        }\r\n        const parsed = removeScheme(validatedLink);\r\n        setParsedDisplayName(parsed);\r\n        setDisplayName(parsed);\r\n    });\r\n\r\n    const handleLinkChange = useCallback((e: ChangeEvent<HTMLInputElement>) => {\r\n        const {value} = e.target;\r\n        setLink(value);\r\n    }, []);\r\n\r\n    // type === 'file'\r\n    const canUploadFiles = useCanUploadFiles();\r\n    const [pendingFile, setPendingFile] = useState<FilePreviewInfo | null>();\r\n    const [fileError, setFileError] = useState('');\r\n    const [fileId, setFileId] = useState(bookmark?.file_id);\r\n    const uploadRequestRef = useRef<XMLHttpRequest>();\r\n    const fileInfo: FileInfo | undefined = useSelector((state: GlobalState) => (fileId && getFile(state, fileId)) || undefined);\r\n\r\n    const maxFileSize = useSelector((state: GlobalState) => {\r\n        const config = getConfig(state);\r\n        return parseInt(config.MaxFileSize || '', 10);\r\n    });\r\n    const maxFileSizeMB = maxFileSize / 1048576;\r\n\r\n    const handleEditFileClick = (e: MouseEvent<HTMLDivElement>) => {\r\n        const innerClick = document.querySelector(`\r\n            .channel-bookmarks-create-modal .post-image__download a,\r\n            .channel-bookmarks-create-modal a.file-preview__remove\r\n        `);\r\n        if (\r\n            innerClick === e.target ||\r\n            innerClick?.contains(e.target as HTMLElement)\r\n        ) {\r\n            return;\r\n        }\r\n\r\n        fileInputRef.current?.click();\r\n    };\r\n\r\n    const handleFileChanged = useCallback((e: ChangeEvent<HTMLInputElement>) => {\r\n        const file = e.target.files?.[0];\r\n        if (!file) {\r\n            return;\r\n        }\r\n\r\n        doUploadFile(file);\r\n    }, []);\r\n\r\n    const handleFileRemove = () => {\r\n        setPendingFile(null);\r\n        setFileId(bookmark?.file_id);\r\n        setParsedDisplayName(undefined);\r\n        uploadRequestRef.current?.abort();\r\n    };\r\n\r\n    const fileInputRef = useRef<HTMLInputElement>(null);\r\n    const fileInput = (\r\n        <input\r\n            type='file'\r\n            id='bookmark-create-file-input-in-modal'\r\n            className='bookmark-create-file-input'\r\n            ref={fileInputRef}\r\n            onChange={handleFileChanged}\r\n        />\r\n    );\r\n\r\n    const onProgress: UploadFile['onProgress'] = (preview) => {\r\n        setPendingFile(preview);\r\n    };\r\n    const onSuccess: UploadFile['onSuccess'] = ({file_infos: fileInfos}) => {\r\n        setPendingFile(null);\r\n        const newFile: FileInfo = fileInfos?.[0];\r\n        if (newFile) {\r\n            setFileId(newFile.id);\r\n        }\r\n        setFileError('');\r\n    };\r\n    const onError: UploadFile['onError'] = () => {\r\n        setPendingFile(null);\r\n        setFileError(formatMessage({id: 'file_upload.generic_error_file', defaultMessage: 'There was a problem uploading your file.'}));\r\n    };\r\n\r\n    const displayNameValue = displayName || parsedDisplayName || (type === 'file' ? fileInfo?.name : bookmark?.link_url) || '';\r\n\r\n    const doUploadFile = (file: File) => {\r\n        setPendingFile(null);\r\n        setFileId('');\r\n\r\n        if (file.size > maxFileSize) {\r\n            setFileError(formatMessage({\r\n                id: 'file_upload.fileAbove',\r\n                defaultMessage: 'File above {max}MB could not be uploaded: {filename}',\r\n            }, {max: maxFileSizeMB, filename: file.name}));\r\n\r\n            return;\r\n        }\r\n\r\n        if (file.size === 0) {\r\n            setFileError(formatMessage({\r\n                id: 'file_upload.zeroBytesFile',\r\n                defaultMessage: 'You are uploading an empty file: {filename}',\r\n            }, {filename: file.name}));\r\n\r\n            return;\r\n        }\r\n\r\n        setFileError('');\r\n        if (displayNameValue === fileInfo?.name) {\r\n            setDisplayName(file.name);\r\n        }\r\n        setParsedDisplayName(file.name);\r\n\r\n        const clientId = generateId();\r\n\r\n        uploadRequestRef.current = dispatch(uploadFile({\r\n            file,\r\n            name: file.name,\r\n            type: file.type,\r\n            rootId: '',\r\n            channelId,\r\n            clientId,\r\n            onProgress,\r\n            onSuccess,\r\n            onError,\r\n        }, true)) as unknown as XMLHttpRequest;\r\n    };\r\n\r\n    useEffect(() => {\r\n        if (promptedFile) {\r\n            doUploadFile(promptedFile);\r\n        }\r\n    }, [promptedFile]);\r\n\r\n    const handleOnExited = useCallback(() => {\r\n        uploadRequestRef.current?.abort();\r\n        onExited?.();\r\n    }, [onExited]);\r\n\r\n    // controls logic\r\n    const hasChanges = (() => {\r\n        if (displayNameValue !== bookmark?.display_name) {\r\n            return true;\r\n        }\r\n\r\n        if ((emoji || bookmark?.emoji) && emoji !== bookmark?.emoji) {\r\n            return true;\r\n        }\r\n\r\n        if (type === 'file') {\r\n            if (fileId && fileId !== bookmark?.file_id) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        if (type === 'link') {\r\n            return Boolean(link && link !== bookmark?.link_url);\r\n        }\r\n\r\n        return false;\r\n    })();\r\n    const isValid = (() => {\r\n        if (type === 'link') {\r\n            if (!link || linkError) {\r\n                return false;\r\n            }\r\n            if (link && linkErrorBypass) {\r\n                return true;\r\n            }\r\n\r\n            if (validatedLink || link === bookmark?.link_url) {\r\n                return true;\r\n            }\r\n        }\r\n\r\n        if (type === 'file') {\r\n            if (!fileInfo || !displayNameValue || fileError) {\r\n                return false;\r\n            }\r\n\r\n            return true;\r\n        }\r\n\r\n        return undefined;\r\n    })();\r\n\r\n    const cancel = useCallback(() => {\r\n        if (type === 'file') {\r\n            uploadRequestRef.current?.abort();\r\n        }\r\n    }, [type]);\r\n\r\n    const confirm = useCallback(async () => {\r\n        setSaving(true);\r\n        if (type === 'link') {\r\n            const url = validHttpUrl(link);\r\n\r\n            if (!url) {\r\n                setSaveError(formatMessage(msg.linkInvalid));\r\n                return;\r\n            }\r\n\r\n            let validLink = url.toString();\r\n\r\n            if (validLink.endsWith('/')) {\r\n                validLink = validLink.slice(0, -1);\r\n            }\r\n\r\n            const {data: success} = await onConfirm({\r\n                image_url: icon,\r\n                link_url: validLink,\r\n                emoji,\r\n                display_name: displayNameValue,\r\n                type: 'link',\r\n            });\r\n\r\n            setSaving(false);\r\n\r\n            if (success) {\r\n                setSaveError('');\r\n                onHide();\r\n            } else {\r\n                setSaveError(formatMessage(msg.saveError));\r\n            }\r\n        } else if (fileInfo) {\r\n            const {data: success} = await onConfirm({\r\n                file_id: fileInfo.id,\r\n                display_name: displayNameValue,\r\n                type: 'file',\r\n                emoji,\r\n            });\r\n\r\n            if (success) {\r\n                setSaveError('');\r\n                onHide();\r\n            } else {\r\n                setSaveError(formatMessage(msg.saveError));\r\n            }\r\n        }\r\n    }, [type, link, onConfirm, onHide, fileInfo, displayNameValue, emoji, icon]);\r\n\r\n    const confirmDisabled = saving || !isValid || !hasChanges;\r\n\r\n    let linkStatusIndicator;\r\n    if (checkingLink) {\r\n        // loading\r\n        linkStatusIndicator = <LoadingSpinner/>;\r\n    } else if (validatedLink && !linkError) {\r\n        // validated\r\n        linkStatusIndicator = checkedIcon;\r\n    }\r\n\r\n    let linkMessage = formatMessage(msg.linkInfoMessage);\r\n    if (linkErrorBypass) {\r\n        const url = validHttpUrl(link);\r\n        if (url) {\r\n            linkMessage = formatMessage(msg.invalidLinkMessage, {link: url.toString()});\r\n        }\r\n    }\r\n\r\n    return (\r\n        <GenericModal\r\n            enforceFocus={!showEmojiPicker}\r\n            keyboardEscape={false}\r\n            className='channel-bookmarks-create-modal'\r\n            modalHeaderText={formatMessage(bookmark ? msg.editHeading : msg.heading)}\r\n            confirmButtonText={formatMessage(bookmark ? msg.saveText : msg.addBookmarkText)}\r\n            handleCancel={cancel}\r\n            handleConfirm={confirm}\r\n            handleEnterKeyPress={(!confirmDisabled && confirm) || undefined}\r\n            onExited={handleOnExited}\r\n            compassDesign={true}\r\n            isConfirmDisabled={confirmDisabled}\r\n            autoCloseOnConfirmButton={false}\r\n            errorText={saveError}\r\n        >\r\n            <>\r\n                {type === 'link' ? (\r\n                    <>\r\n                        <Input\r\n                            maxLength={MAX_LINK_LENGTH}\r\n                            type='text'\r\n                            name='bookmark-link'\r\n                            containerClassName='linkInput'\r\n                            placeholder={formatMessage(msg.linkPlaceholder)}\r\n                            onChange={handleLinkChange}\r\n                            hasError={Boolean(linkError)}\r\n                            value={link}\r\n                            data-testid='linkInput'\r\n                            autoFocus={true}\r\n                            addon={linkStatusIndicator}\r\n                            customMessage={linkError ? {type: 'error', value: linkError} : {value: linkMessage}}\r\n                        />\r\n                    </>\r\n                ) : (\r\n                    <>\r\n                        <FieldLabel>\r\n                            <FormattedMessage\r\n                                id='channel_bookmarks.create.file_input.label'\r\n                                defaultMessage='Attachment'\r\n                            />\r\n                        </FieldLabel>\r\n                        <FileInputContainer\r\n                            tabIndex={0}\r\n                            role='button'\r\n                            disabled={!canUploadFiles}\r\n                            onClick={(canUploadFiles && handleEditFileClick) || undefined}\r\n                        >\r\n                            {!pendingFile && fileInfo && (\r\n                                <FileItemContainer>\r\n                                    <FileAttachment\r\n                                        key={fileInfo.id}\r\n                                        fileInfo={fileInfo}\r\n                                        index={0}\r\n                                    />\r\n                                </FileItemContainer>\r\n                            )}\r\n                            {pendingFile && (\r\n                                <FileProgressPreview\r\n                                    key={pendingFile.clientId}\r\n                                    clientId={pendingFile.clientId}\r\n                                    fileInfo={pendingFile}\r\n                                    handleRemove={handleFileRemove}\r\n                                />\r\n                            )}\r\n                            {!fileInfo && !pendingFile && (\r\n                                <div className='file-preview__container empty'/>\r\n                            )}\r\n                            <VisualButton>\r\n                                <PencilOutlineIcon size={24}/>\r\n                                {formatMessage(msg.fileInputEdit)}\r\n                            </VisualButton>\r\n                            {fileInput}\r\n                        </FileInputContainer>\r\n                        {fileError && (\r\n                            <div className='Input___customMessage Input___error'>\r\n                                <i className='icon error icon-alert-circle-outline'/>\r\n                                <span>{fileError}</span>\r\n                            </div>\r\n                        )}\r\n                    </>\r\n\r\n                )}\r\n\r\n                <TitleWrapper>\r\n                    <FieldLabel>\r\n                        <FormattedMessage\r\n                            id='channel_bookmarks.create.title_input.label'\r\n                            defaultMessage='Title'\r\n                        />\r\n                    </FieldLabel>\r\n                    <CreateModalNameInput\r\n                        maxLength={MAX_TITLE_LENGTH}\r\n                        type={type}\r\n                        imageUrl={icon}\r\n                        fileInfo={pendingFile || fileInfo}\r\n                        emoji={emoji}\r\n                        setEmoji={setEmoji}\r\n                        displayName={displayName?.substring(0, MAX_TITLE_LENGTH)}\r\n                        placeholder={displayNameValue?.substring(0, MAX_TITLE_LENGTH)}\r\n                        setDisplayName={setDisplayName}\r\n                        onAddCustomEmojiClick={onHide}\r\n                        showEmojiPicker={showEmojiPicker}\r\n                        setShowEmojiPicker={setShowEmojiPicker}\r\n                    />\r\n                </TitleWrapper>\r\n            </>\r\n        </GenericModal>\r\n    );\r\n}\r\n\r\nexport default ChannelBookmarkCreateModal;\r\n\r\nconst TitleWrapper = styled.div`\r\n    margin-top: 20px;\r\n`;\r\n\r\nconst CheckWrapper = styled.span`\r\n    padding: 0px 12px;\r\n    display: flex;\r\n    align-items: center;\r\n`;\r\n\r\nconst checkedIcon = (\r\n    <CheckWrapper>\r\n        <CheckIcon\r\n            size={20}\r\n            color='var(--sys-online-indicator)'\r\n        />\r\n    </CheckWrapper>\r\n);\r\n\r\nconst FieldLabel = styled.span`\r\n    display: inline-block;\r\n    margin-bottom: 8px;\r\n    font-family: Open Sans;\r\n    font-size: 14px;\r\n    line-height: 16px;\r\n    font-style: normal;\r\n    font-weight: 600;\r\n    line-height: 20px;\r\n`;\r\n\r\nconst VisualButton = styled.div`\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    justify-content: center;\r\n    gap: 4px;\r\n    padding: 10px 24px;\r\n    color: rgba(var(--center-channel-color-rgb), 0.56);\r\n    font-size: 11px;\r\n    font-weight: 600;\r\n    font-family: Open Sans;\r\n`;\r\n\r\nconst FileInputContainer = styled.div`\r\n    display: block;\r\n    background: rgba(var(--center-channel-color-rgb), 0.04);\r\n    padding: 12px;\r\n    border-radius: 8px;\r\n    display: flex;\r\n\r\n    &:hover:not([disabled]) {\r\n        background: rgba(var(--center-channel-color-rgb), 0.08);\r\n        color: rgba(var(--center-channel-color-rgb), 0.72);\r\n        cursor: pointer;\r\n    }\r\n\r\n    &:disabled {\r\n        cursor: default;\r\n        ${VisualButton} {\r\n            opacity: 0.4;\r\n        }\r\n    }\r\n\r\n    input[type=\"file\"] {\r\n        opacity: 0;\r\n        width: 0;\r\n        height: 0;\r\n    }\r\n\r\n    .file-preview__container,\r\n    .file-preview {\r\n        width: auto;\r\n        height: auto;\r\n        flex: 1 1 auto;\r\n        padding: 0;\r\n\r\n        &.empty {\r\n            border: 2px dashed rgba(var(--center-channel-color-rgb), 0.16);\r\n            border-radius : 4px;\r\n        }\r\n\r\n        .post-image__column {\r\n            width: 100%;\r\n            margin: 0;\r\n        }\r\n    }\r\n`;\r\n\r\nconst continuableLinkErr = (url: URL, confirm: () => void) => {\r\n    return (\r\n        <FormattedMessage\r\n            id='channel_bookmarks.create.error.invalid_url.continue_anyway'\r\n            defaultMessage='Could not find: {url}. Please enter a valid link, or <Confirm>continue anyway</Confirm>.'\r\n            values={{\r\n                url: url.toString(),\r\n                Confirm: (msg) => (\r\n                    <LinkErrContinue\r\n                        tabIndex={0}\r\n                        onClick={confirm}\r\n                        onKeyDown={(e) => {\r\n                            if (e.key === 'Enter') {\r\n                                confirm();\r\n                            }\r\n                        }}\r\n                    >\r\n                        {msg}\r\n                    </LinkErrContinue>\r\n                ),\r\n            }}\r\n        />\r\n    );\r\n};\r\n\r\nconst LinkErrContinue = styled.a`\r\n    color: unset !important;\r\n    text-decoration: underline;\r\n`;\r\n\r\nconst FileItemContainer = styled.div`\r\n    display: flex;\r\n    flex: 1 1 auto;\r\n\r\n    > div {\r\n        width: 100%;\r\n        margin: 0;\r\n    }\r\n`;\r\n\r\nconst msg = defineMessages({\r\n    heading: {id: 'channel_bookmarks.create.title', defaultMessage: 'Add a bookmark'},\r\n    editHeading: {id: 'channel_bookmarks.create.edit.title', defaultMessage: 'Edit bookmark'},\r\n    linkPlaceholder: {id: 'channel_bookmarks.create.link_placeholder', defaultMessage: 'Link'},\r\n    linkInfoMessage: {id: 'channel_bookmarks.create.link_info', defaultMessage: 'Add a link to any post, file, or any external link'},\r\n    invalidLinkMessage: {id: 'channel_bookmarks.create.error.invalid_url.continuing_anyway', defaultMessage: 'This may not be a valid link: {link}.'},\r\n    addBookmarkText: {id: 'channel_bookmarks.create.confirm_add.button', defaultMessage: 'Add bookmark'},\r\n    saveText: {id: 'channel_bookmarks.create.confirm_save.button', defaultMessage: 'Save bookmark'},\r\n    fileInputEdit: {id: 'channel_bookmarks.create.file_input.edit', defaultMessage: 'Edit'},\r\n    linkInvalid: {id: 'channel_bookmarks.create.error.invalid_url', defaultMessage: 'Please enter a valid link. Could not parse: {link}.'},\r\n    saveError: {id: 'channel_bookmarks.create.error.generic_save', defaultMessage: 'There was an error trying to save the bookmark.'},\r\n});\r\n\r\nconst TYPING_DELAY_MS = 250;\r\nconst REQUEST_TIMEOUT = 10000;\r\nexport const useBookmarkLinkValidation = (link: string, onValidated: (validatedLink: string, forced?: boolean) => void) => {\r\n    const {formatMessage} = useIntl();\r\n\r\n    const [loading, setLoading] = useState<URL>();\r\n    const [error, setError] = useState<ReactNode>();\r\n    const [suppressed, setSuppressed] = useState(false);\r\n    const abort = useRef<AbortController>();\r\n\r\n    const start = useCallback((url: URL) => {\r\n        setLoading(url);\r\n        setError(undefined);\r\n        setSuppressed(false);\r\n        abort.current = new AbortController();\r\n        return abort.current.signal;\r\n    }, []);\r\n\r\n    const cancel = useCallback(() => {\r\n        abort.current?.abort('stale request');\r\n        abort.current = undefined;\r\n        setLoading(undefined);\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        const handler = setTimeout(async () => {\r\n            cancel();\r\n            if (!link) {\r\n                return;\r\n            }\r\n\r\n            const url = validHttpUrl(link);\r\n\r\n            if (!url) {\r\n                setError(formatMessage(msg.linkInvalid, {link}));\r\n                setLoading(undefined);\r\n                return;\r\n            }\r\n\r\n            const signal = start(url);\r\n\r\n            try {\r\n                await fetch(url, {\r\n                    mode: 'no-cors',\r\n                    signal: AbortSignal.any([signal, AbortSignal.timeout(REQUEST_TIMEOUT)]),\r\n                });\r\n                onValidated(link);\r\n            } catch (err) {\r\n                if (signal === abort.current?.signal) {\r\n                    setError(continuableLinkErr(url, () => {\r\n                        onValidated(link, true);\r\n                        setSuppressed(true);\r\n                        setError(undefined);\r\n                    }));\r\n                }\r\n            } finally {\r\n                setLoading((currentUrl) => {\r\n                    if (currentUrl !== url) {\r\n                        // trailing effect of cancelled\r\n                        return currentUrl;\r\n                    }\r\n\r\n                    return undefined;\r\n                });\r\n            }\r\n        }, TYPING_DELAY_MS);\r\n\r\n        return () => clearTimeout(handler);\r\n    }, [link, start, cancel]);\r\n\r\n    return [error, {loading: Boolean(loading), suppressed}] as const;\r\n};\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React, {memo, useCallback} from 'react';\r\nimport {useIntl} from 'react-intl';\r\nimport {useDispatch} from 'react-redux';\r\nimport styled, {css} from 'styled-components';\r\n\r\nimport {\r\n    LinkVariantIcon,\r\n    PaperclipIcon,\r\n    PlusIcon,\r\n} from '@mattermost/compass-icons/components';\r\nimport type {ChannelBookmarkCreate} from '@mattermost/types/channel_bookmarks';\r\n\r\nimport {createBookmark} from 'actions/channel_bookmarks';\r\nimport {openModal} from 'actions/views/modals';\r\n\r\nimport * as Menu from 'components/menu';\r\n\r\nimport {ModalIdentifiers} from 'utils/constants';\r\n\r\nimport ChannelBookmarkCreateModal from './channel_bookmarks_create_modal';\r\nimport {MAX_BOOKMARKS_PER_CHANNEL, useChannelBookmarkPermission} from './utils';\r\n\r\ntype BookmarksMenuProps = {\r\n    channelId: string;\r\n    hasBookmarks: boolean;\r\n    limitReached: boolean;\r\n    canUploadFiles: boolean;};\r\nfunction BookmarksMenu({\r\n    channelId,\r\n    hasBookmarks,\r\n    limitReached,\r\n    canUploadFiles,\r\n}: BookmarksMenuProps) {\r\n    const {formatMessage} = useIntl();\r\n    const showLabel = !hasBookmarks;\r\n\r\n    const {handleCreateLink, handleCreateFile} = useBookmarkAddActions(channelId);\r\n    const canAdd = useChannelBookmarkPermission(channelId, 'add');\r\n\r\n    const addBookmarkLabel = formatMessage({id: 'channel_bookmarks.addBookmark', defaultMessage: 'Add a bookmark'});\r\n\r\n    const addBookmarkLimitReached = formatMessage({id: 'channel_bookmarks.addBookmarkLimitReached', defaultMessage: 'Cannot add more than {limit} bookmarks'}, {limit: MAX_BOOKMARKS_PER_CHANNEL});\r\n    let addBookmarkTooltipText;\r\n\r\n    if (limitReached) {\r\n        addBookmarkTooltipText = addBookmarkLimitReached;\r\n    } else if (hasBookmarks) {\r\n        addBookmarkTooltipText = addBookmarkLabel;\r\n    }\r\n\r\n    const addLinkLabel = formatMessage({id: 'channel_bookmarks.addLink', defaultMessage: 'Add a link'});\r\n    const attachFileLabel = formatMessage({id: 'channel_bookmarks.attachFile', defaultMessage: 'Attach a file'});\r\n\r\n    if (!canAdd) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <MenuButtonContainer\r\n            withLabel={showLabel}\r\n        >\r\n            <Menu.Container\r\n                anchorOrigin={{vertical: 'bottom', horizontal: 'left'}}\r\n                transformOrigin={{vertical: 'top', horizontal: 'left'}}\r\n                menuButton={{\r\n                    id: 'channelBookmarksPlusMenuButton',\r\n                    class: classNames('channelBookmarksMenuButton', {withLabel: showLabel, disabled: limitReached}),\r\n                    children: (\r\n                        <>\r\n                            <PlusIcon size={showLabel ? 16 : 18}/>\r\n                            {showLabel && <span>{addBookmarkLabel}</span>}\r\n                        </>\r\n                    ),\r\n                    'aria-label': addBookmarkLabel,\r\n                    disabled: limitReached,\r\n                }}\r\n                menu={{\r\n                    id: 'channelBookmarksPlusMenuDropdown',\r\n                }}\r\n                menuButtonTooltip={addBookmarkTooltipText ? {\r\n                    text: addBookmarkTooltipText,\r\n                } : undefined}\r\n            >\r\n                <Menu.Item\r\n                    key='channelBookmarksAddLink'\r\n                    id='channelBookmarksAddLink'\r\n                    onClick={handleCreateLink}\r\n                    leadingElement={<LinkVariantIcon size={18}/>}\r\n                    labels={<span>{addLinkLabel}</span>}\r\n                />\r\n                {canUploadFiles && (\r\n                    <Menu.Item\r\n                        key='channelBookmarksAttachFile'\r\n                        id='channelBookmarksAttachFile'\r\n                        onClick={handleCreateFile}\r\n                        leadingElement={<PaperclipIcon size={18}/>}\r\n                        labels={<span>{attachFileLabel}</span>}\r\n                    />\r\n                )}\r\n            </Menu.Container>\r\n        </MenuButtonContainer>\r\n    );\r\n}\r\n\r\nexport default memo(BookmarksMenu);\r\n\r\nconst MenuButtonContainer = styled.div<{withLabel: boolean}>`\r\n    position: sticky;\r\n    right: 0;\r\n    ${({withLabel}) => !withLabel && css`padding: 0 1rem;`}\r\n    background: linear-gradient(to right, rgba(var(--center-channel-bg-rgb), .16), rgba(var(--center-channel-bg-rgb), 1) 25%);\r\n`;\r\n\r\nexport const useBookmarkAddActions = (channelId: string) => {\r\n    const dispatch = useDispatch();\r\n\r\n    const handleCreate = useCallback((file?: File) => {\r\n        dispatch(openModal({\r\n            modalId: ModalIdentifiers.CHANNEL_BOOKMARK_CREATE,\r\n            dialogType: ChannelBookmarkCreateModal,\r\n            dialogProps: {\r\n                channelId,\r\n                bookmarkType: file ? 'file' : 'link',\r\n                file,\r\n                onConfirm: async (data: ChannelBookmarkCreate) => dispatch(createBookmark(channelId, data)),\r\n            },\r\n        }));\r\n    }, [channelId, dispatch]);\r\n\r\n    const handleCreateLink = useCallback(() => {\r\n        handleCreate();\r\n    }, [handleCreate]);\r\n\r\n    const handleCreateFile = useCallback(() => {\r\n        const input: HTMLInputElement = document.createElement('input');\r\n        input.type = 'file';\r\n        input.id = 'bookmark-create-file-input';\r\n        input.hidden = true;\r\n\r\n        input.addEventListener('change', () => {\r\n            const file = input.files?.[0];\r\n            if (file) {\r\n                handleCreate(file);\r\n            }\r\n            input.remove();\r\n        });\r\n        input.addEventListener('cancel', input.remove);\r\n\r\n        document.getElementById('root-portal')?.appendChild(input);\r\n\r\n        input.click();\r\n    }, [handleCreate]);\r\n\r\n    return {handleCreateLink, handleCreateFile};\r\n};\r\n"],"names":["BookmarkIcon","_ref","type","emoji","imageUrl","fileInfo","size","icon","React","BookOutlineIcon","FileGenericOutlineIcon","emojiName","trimmedEmojiName","hasImageProxy","useSelector","state","getConfig","HasImageProxy","RenderEmoji","BookmarkIconImg","src","getImageSrc","FileThumbnail","disablePreview","Icon","$size","propTypes","_pt","styled","withConfig","displayName","_ref2","_ref3","_ref4","_ref5","_ref6","_ref7","CreateModalNameInput","maxLength","setEmoji","placeholder","setDisplayName","showEmojiPicker","setShowEmojiPicker","onAddCustomEmojiClick","formatMessage","useIntl","targetRef","useRef","handleEmojiClear","handleInputChange","useCallback","e","currentTarget","value","emojiPicker","getReferenceProps","setReference","useEmojiPicker","onEmojiClick","selectedEmoji","short_name","name","concat","current","document","dispatchEvent","CustomEvent","A11yCustomEventTypes","FOCUS","detail","target","keyboardOnly","NameWrapper","Object","assign","ref","onClick","toggleEmojiPicker","prev","onKeyDown","isKeyPressed","Constants","KeyCodes","ENTER","stopPropagation","id","defaultMessage","className","ChevronDownIcon","Input","onChange","useLegend","Clear","visible","Boolean","tabIndex","SPACE","FormattedMessage","isRequired","ChannelBookmarkCreateModal","_bookmark$type","_bookmark$emoji","_bookmark$link_url","bookmark","bookmarkType","file","promptedFile","channelId","onExited","onConfirm","onHide","dispatch","useDispatch","useState","display_name","parsedDisplayName","setParsedDisplayName","saving","setSaving","saveError","setSaveError","handleKeyDown","event","ESCAPE","useEffect","addEventListener","removeEventListener","image_url","link","setLinkInner","link_url","prevLink","validatedLink","setValidatedLink","setLink","currentLink","undefined","linkError","loading","checkingLink","suppressed","linkErrorBypass","useBookmarkLinkValidation","forced","parsed","removeScheme","handleLinkChange","canUploadFiles","useCanUploadFiles","pendingFile","setPendingFile","fileError","setFileError","fileId","setFileId","file_id","uploadRequestRef","getFile","maxFileSize","config","parseInt","MaxFileSize","maxFileSizeMB","handleFileChanged","_e$target$files","files","doUploadFile","fileInputRef","fileInput","onProgress","preview","onSuccess","file_infos","fileInfos","newFile","onError","displayNameValue","max","filename","clientId","generateId","uploadFile","rootId","handleOnExited","_uploadRequestRef$cur2","abort","hasChanges","isValid","cancel","_uploadRequestRef$cur3","confirm","async","url","validHttpUrl","msg","linkInvalid","validLink","toString","endsWith","slice","data","success","confirmDisabled","linkStatusIndicator","LoadingSpinner","checkedIcon","linkMessage","linkInfoMessage","invalidLinkMessage","GenericModal","enforceFocus","keyboardEscape","modalHeaderText","editHeading","heading","confirmButtonText","saveText","addBookmarkText","handleCancel","handleConfirm","handleEnterKeyPress","compassDesign","isConfirmDisabled","autoCloseOnConfirmButton","errorText","containerClassName","linkPlaceholder","hasError","autoFocus","addon","customMessage","FieldLabel","FileInputContainer","role","disabled","_fileInputRef$current","innerClick","querySelector","contains","click","FileItemContainer","FileAttachment","key","index","FileProgressPreview","handleRemove","handleFileRemove","_uploadRequestRef$cur","VisualButton","PencilOutlineIcon","fileInputEdit","TitleWrapper","substring","CheckWrapper","CheckIcon","color","LinkErrContinue","defineMessages","onValidated","setLoading","error","setError","setSuppressed","start","AbortController","signal","_abort$current","handler","setTimeout","fetch","mode","AbortSignal","any","timeout","err","_abort$current2","continuableLinkErr","values","Confirm","currentUrl","clearTimeout","BookmarksMenu","hasBookmarks","limitReached","showLabel","handleCreateLink","handleCreateFile","useBookmarkAddActions","canAdd","useChannelBookmarkPermission","addBookmarkLabel","addBookmarkLimitReached","limit","MAX_BOOKMARKS_PER_CHANNEL","addBookmarkTooltipText","addLinkLabel","attachFileLabel","MenuButtonContainer","withLabel","Menu","anchorOrigin","vertical","horizontal","transformOrigin","menuButton","class","classNames","children","PlusIcon","menu","menuButtonTooltip","text","leadingElement","LinkVariantIcon","labels","PaperclipIcon","memo","css","handleCreate","openModal","modalId","ModalIdentifiers","CHANNEL_BOOKMARK_CREATE","dialogType","dialogProps","createBookmark","_document$getElementB","input","createElement","hidden","_input$files","remove","getElementById","appendChild"],"sourceRoot":""}