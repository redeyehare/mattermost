{"version":3,"file":"11.077b2ea56408145a4962.js","mappings":"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","sources":["webpack://mattermost-webapp/./src/components/file_info_preview/file_info_preview.tsx","webpack://mattermost-webapp/./src/components/file_info_preview/index.ts","webpack://mattermost-webapp/./src/components/archived_preview.tsx","webpack://mattermost-webapp/./src/components/audio_video_preview/audio_video_preview.tsx","webpack://mattermost-webapp/./src/components/audio_video_preview/index.ts","webpack://mattermost-webapp/./src/components/code_preview.tsx","webpack://mattermost-webapp/./src/components/file_preview_modal/file_preview_modal_info/file_preview_modal_info.tsx","webpack://mattermost-webapp/./src/components/file_preview_modal/types.ts","webpack://mattermost-webapp/./src/components/file_preview_modal/file_preview_modal_main_actions/file_preview_modal_main_actions.tsx","webpack://mattermost-webapp/./src/components/file_preview_modal/file_preview_modal_footer/file_preview_modal_footer.tsx","webpack://mattermost-webapp/./src/components/file_preview_modal/file_preview_modal_main_nav/file_preview_modal_main_nav.tsx","webpack://mattermost-webapp/./src/components/file_preview_modal/file_preview_modal_header/file_preview_modal_header.tsx","webpack://mattermost-webapp/./src/components/file_preview_modal/image_preview.tsx","webpack://mattermost-webapp/./src/components/file_preview_modal/popover_bar/popover_bar.tsx","webpack://mattermost-webapp/./src/components/file_preview_modal/popover_bar/index.ts","webpack://mattermost-webapp/./src/components/file_preview_modal/file_preview_modal.tsx"],"sourcesContent":["// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nimport type {FileInfo} from '@mattermost/types/files';\r\n\r\nimport * as Utils from 'utils/utils';\r\n\r\ntype Props = {\r\n    fileInfo: FileInfo;\r\n    fileUrl: string;\r\n    canDownloadFiles: boolean;\r\n};\r\n\r\nconst FileInfoPreview = ({\r\n    fileInfo,\r\n    fileUrl,\r\n    canDownloadFiles,\r\n}: Props) => {\r\n    const intl = useIntl();\r\n\r\n    // non-image files include a section providing details about the file\r\n    const infoParts = [];\r\n\r\n    if (fileInfo.extension !== '') {\r\n        infoParts.push(\r\n            intl.formatMessage({id: 'file_info_preview.type', defaultMessage: 'File type '}) +\r\n        fileInfo.extension.toUpperCase(),\r\n        );\r\n    }\r\n\r\n    if (fileInfo.size) {\r\n        infoParts.push(\r\n            intl.formatMessage({id: 'file_info_preview.size', defaultMessage: 'Size '}) +\r\n        Utils.fileSizeToString(fileInfo.size),\r\n        );\r\n    }\r\n\r\n    const infoString = infoParts.join(', ');\r\n\r\n    let preview = null;\r\n    if (canDownloadFiles) {\r\n        preview = (\r\n            <a\r\n                className='file-details__preview'\r\n                href={fileUrl}\r\n            >\r\n                <span className='file-details__preview-helper'/>\r\n                <img\r\n                    alt={'file preview'}\r\n                    src={Utils.getFileIconPath(fileInfo)}\r\n                />\r\n            </a>\r\n        );\r\n    } else {\r\n        preview = (\r\n            <span className='file-details__preview'>\r\n                <span className='file-details__preview-helper'/>\r\n                <img\r\n                    alt={'file preview'}\r\n                    src={Utils.getFileIconPath(fileInfo)}\r\n                />\r\n            </span>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className='file-details__container'>\r\n            {preview}\r\n            <div className='file-details'>\r\n                <div className='file-details__name'>{fileInfo.name}</div>\r\n                <div className='file-details__info'>{infoString}</div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default React.memo(FileInfoPreview);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\n\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\n\r\nimport {canDownloadFiles} from 'utils/file_utils';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport FileInfoPreview from './file_info_preview';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const config = getConfig(state);\r\n\r\n    return {\r\n        canDownloadFiles: canDownloadFiles(config),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps)(FileInfoPreview);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nimport {ArchiveOutlineIcon} from '@mattermost/compass-icons/components';\r\nimport type {FileInfo} from '@mattermost/types/files';\r\n\r\ninterface Props {\r\n    fileInfo: FileInfo;\r\n}\r\n\r\nexport default function FileInfoPreview(props: Props) {\r\n    const intl = useIntl();\r\n\r\n    const infoString = intl.formatMessage({\r\n        id: 'workspace_limits.archived_file.archived',\r\n        defaultMessage: 'This file is archived',\r\n    });\r\n\r\n    const preview = (\r\n        <span className='file-details__preview file-details__preview--archived'>\r\n            <ArchiveOutlineIcon\r\n                size={80}\r\n                color={'rgba(var(--center-channel-color-rgb), 0.48)'}\r\n                data-testid='archived-file-icon'\r\n            />\r\n        </span>\r\n    );\r\n\r\n    return (\r\n        <div className='file-details__container'>\r\n            {preview}\r\n            <div className='file-details'>\r\n                <div className='file-details__name'>{props.fileInfo.name}</div>\r\n                <div className='file-details__info'>{infoString}</div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\n\r\nimport type {FileInfo} from '@mattermost/types/files';\r\n\r\nimport FileInfoPreview from 'components/file_info_preview';\r\n\r\nimport Constants from 'utils/constants';\r\n\r\ntype Props = {\r\n    fileInfo: FileInfo;\r\n    fileUrl: string;\r\n    isMobileView: boolean;\r\n}\r\n\r\ntype State = {\r\n    canPlay: boolean;\r\n}\r\n\r\nexport default class AudioVideoPreview extends React.PureComponent<Props, State> {\r\n    sourceRef = React.createRef<HTMLSourceElement>();\r\n    videoRef = React.createRef<HTMLVideoElement>();\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            canPlay: true,\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.handleFileInfoChanged();\r\n\r\n        if (this.sourceRef.current) {\r\n            this.sourceRef.current.addEventListener('error', this.handleLoadError, {once: true});\r\n        }\r\n    }\r\n\r\n    componentDidUpdate(prevProps: Props) {\r\n        if (this.props.fileUrl !== prevProps.fileUrl) {\r\n            this.handleFileInfoChanged();\r\n        }\r\n\r\n        if (this.sourceRef.current) {\r\n            this.sourceRef.current.addEventListener('error', this.handleLoadError, {once: true});\r\n        }\r\n    }\r\n\r\n    handleFileInfoChanged = () => {\r\n        let video = this.videoRef.current;\r\n        if (!video) {\r\n            video = document.createElement('video');\r\n        }\r\n\r\n        this.setState({\r\n            canPlay: true,\r\n        });\r\n    };\r\n\r\n    handleLoadError = () => {\r\n        this.setState({\r\n            canPlay: false,\r\n        });\r\n    };\r\n\r\n    stop = () => {\r\n        if (this.videoRef.current) {\r\n            const video = this.videoRef.current;\r\n            video.pause();\r\n            video.currentTime = 0;\r\n        }\r\n    };\r\n\r\n    render() {\r\n        if (!this.state.canPlay) {\r\n            return (\r\n                <FileInfoPreview\r\n                    fileInfo={this.props.fileInfo}\r\n                    fileUrl={this.props.fileUrl}\r\n                />\r\n            );\r\n        }\r\n\r\n        let width = Constants.WEB_VIDEO_WIDTH;\r\n        let height = Constants.WEB_VIDEO_HEIGHT;\r\n        if (this.props.isMobileView) {\r\n            width = Constants.MOBILE_VIDEO_WIDTH;\r\n            height = Constants.MOBILE_VIDEO_HEIGHT;\r\n        }\r\n\r\n        // add a key to the video to prevent React from using an old video source while a new one is loading\r\n        return (\r\n            <video\r\n                key={this.props.fileInfo.id}\r\n                ref={this.videoRef}\r\n                data-setup='{}'\r\n                controls={true}\r\n                width={width}\r\n                height={height}\r\n            >\r\n                <source\r\n                    ref={this.sourceRef}\r\n                    src={this.props.fileUrl}\r\n                />\r\n            </video>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\n\r\nimport {getIsMobileView} from 'selectors/views/browser';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport AudioVideoPreview from './audio_video_preview';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    return {\r\n        isMobileView: getIsMobileView(state),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps)(AudioVideoPreview);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useEffect, useState} from 'react';\r\n\r\nimport type {FileInfo} from '@mattermost/types/files';\r\n\r\nimport FileInfoPreview from 'components/file_info_preview';\r\nimport LoadingSpinner from 'components/widgets/loading/loading_spinner';\r\n\r\nimport Constants from 'utils/constants';\r\nimport * as SyntaxHighlighting from 'utils/syntax_highlighting';\r\n\r\nimport type {LinkInfo} from './file_preview_modal/types';\r\n\r\ntype Props = {\r\n    fileInfo: FileInfo;\r\n    fileUrl: string;\r\n    getContent?: (code: string) => void;\r\n};\r\n\r\nexport function hasSupportedLanguage(fileInfo: FileInfo | LinkInfo) {\r\n    return Boolean(SyntaxHighlighting.getLanguageFromFileExtension(fileInfo.extension));\r\n}\r\n\r\nconst CodePreview = ({\r\n    fileInfo,\r\n    fileUrl,\r\n    getContent,\r\n}: Props) => {\r\n    const [codeInfo, setCodeInfo] = useState({\r\n        code: '',\r\n        lang: '',\r\n        highlighted: '',\r\n    });\r\n\r\n    const [status, setStatus] = useState<'success' | 'loading' | 'fail'>('loading');\r\n\r\n    useEffect(() => {\r\n        const usedLanguage = SyntaxHighlighting.getLanguageFromFileExtension(fileInfo.extension);\r\n\r\n        if (!usedLanguage || fileInfo.size > Constants.CODE_PREVIEW_MAX_FILE_SIZE) {\r\n            setCodeInfo({code: '', lang: '', highlighted: ''});\r\n            setStatus('fail');\r\n            return;\r\n        }\r\n\r\n        setCodeInfo({code: '', lang: usedLanguage, highlighted: ''});\r\n        setStatus('loading');\r\n\r\n        const fetchCode = async () => {\r\n            try {\r\n                const response = await fetch(fileUrl);\r\n                let code = await response.text();\r\n\r\n                if (response.headers.get('content-type')?.includes('xml')) {\r\n                    try {\r\n                        const parser = new DOMParser();\r\n                        const xmlDoc = parser.parseFromString(code, 'text/xml');\r\n                        if (xmlDoc.nodeName === '#document') {\r\n                            code = new XMLSerializer().serializeToString(xmlDoc);\r\n                        }\r\n                    } catch {\r\n                        // If XML parsing fails, use the text as-is\r\n                    }\r\n                }\r\n\r\n                getContent?.(code);\r\n\r\n                const highlighted = await SyntaxHighlighting.highlight(usedLanguage, code);\r\n\r\n                setCodeInfo({\r\n                    code,\r\n                    lang: usedLanguage,\r\n                    highlighted,\r\n                });\r\n                setStatus('success');\r\n            } catch (e) {\r\n                setStatus('fail');\r\n            }\r\n        };\r\n\r\n        fetchCode();\r\n    }, [fileUrl, fileInfo.extension, fileInfo.size, getContent]);\r\n\r\n    if (status === 'loading') {\r\n        return (\r\n            <div className='view-image__loading'>\r\n                <LoadingSpinner/>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (status === 'fail') {\r\n        return (\r\n            <FileInfoPreview\r\n                fileInfo={fileInfo}\r\n                fileUrl={fileUrl}\r\n            />\r\n        );\r\n    }\r\n\r\n    const language = SyntaxHighlighting.getLanguageName(codeInfo.lang);\r\n\r\n    return (\r\n        <div className='post-code code-preview'>\r\n            <span className='post-code__language'>\r\n                {`${fileInfo.name} - ${language}`}\r\n            </span>\r\n            <div className='hljs'>\r\n                <div className='post-code__line-numbers'>\r\n                    {SyntaxHighlighting.renderLineNumbers(codeInfo.code)}\r\n                </div>\r\n                <code dangerouslySetInnerHTML={{__html: codeInfo.highlighted}}/>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default React.memo(CodePreview);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {memo} from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\nimport {useSelector} from 'react-redux';\r\n\r\nimport type {Post} from '@mattermost/types/posts';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\n\r\nimport {makeGetChannel} from 'mattermost-redux/selectors/entities/channels';\r\nimport {\r\n    getUser as selectUser,\r\n    makeGetDisplayName,\r\n} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport Avatar from 'components/widgets/users/avatar/avatar';\r\n\r\nimport {imageURLForUser} from 'utils/utils';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport './file_preview_modal_info.scss';\r\n\r\ninterface Props {\r\n    showFileName: boolean;\r\n    filename: string;\r\n    post?: Post;\r\n}\r\n\r\nconst displayNameGetter = makeGetDisplayName();\r\n\r\nconst FilePreviewModalInfo: React.FC<Props> = (props: Props) => {\r\n    const user = useSelector((state: GlobalState) => selectUser(state, props.post?.user_id ?? '')) as UserProfile | undefined;\r\n    const channel = useSelector((state: GlobalState) => {\r\n        const getChannel = makeGetChannel();\r\n        return getChannel(state, props.post?.channel_id ?? '');\r\n    });\r\n    const name = useSelector((state: GlobalState) => displayNameGetter(state, props.post?.user_id ?? '', true));\r\n\r\n    let info;\r\n    const channelName = channel ? (\r\n        <FormattedMessage\r\n            id='file_preview_modal_info.shared_in'\r\n            defaultMessage='Shared in ~{name}'\r\n            values={{\r\n                name: channel.display_name || channel.name,\r\n            }}\r\n        />\r\n    ) : null;\r\n    if (props.showFileName) {\r\n        info = (\r\n            <>\r\n                <h5 className='file-preview-modal__file-name'>{props.filename}\r\n                </h5>\r\n                <span className='file-preview-modal__file-details'>\r\n                    <span className='file-preview-modal__file-details-user-name'>{name}</span>\r\n                    <span className='file-preview-modal__channel'>{channelName}</span>\r\n                </span>\r\n            </>\r\n        );\r\n    } else {\r\n        info = (\r\n            <>\r\n                <h5 className='file-preview-modal__user-name'>{name}\r\n                </h5>\r\n                <span className='file-preview-modal__channel'>{channelName}\r\n                </span>\r\n            </>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className='file-preview-modal__info'>\r\n            {\r\n                (props.post && Object.keys(props.post).length > 0) &&\r\n                <Avatar\r\n                    size='lg'\r\n                    username={user?.username}\r\n                    url={imageURLForUser(props.post.user_id, user?.last_picture_update)}\r\n                    className='file-preview-modal__avatar'\r\n                    alt=''\r\n                />\r\n            }\r\n\r\n            <div className='file-preview-modal__info-details'>\r\n                {info}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default memo(FilePreviewModalInfo);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {FileInfo} from '@mattermost/types/files';\r\n\r\nexport type LinkInfo = {\r\n    has_preview_image: boolean;\r\n    link: string;\r\n    extension: string;\r\n    name: string;\r\n}\r\n\r\nexport function isFileInfo(info: FileInfo | LinkInfo): info is FileInfo {\r\n    return Boolean((info as FileInfo).id);\r\n}\r\n\r\nexport function isLinkInfo(info: FileInfo | LinkInfo): info is LinkInfo {\r\n    return Boolean((info as LinkInfo).link) && !isFileInfo(info);\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {memo, useEffect, useState} from 'react';\r\nimport {useIntl} from 'react-intl';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\n\r\nimport type {FileInfo} from '@mattermost/types/files';\r\n\r\nimport {getFilePublicLink} from 'mattermost-redux/actions/files';\r\nimport {getFilePublicLink as selectFilePublicLink} from 'mattermost-redux/selectors/entities/files';\r\n\r\nimport CopyButton from 'components/copy_button';\r\nimport ExternalLink from 'components/external_link';\r\nimport WithTooltip from 'components/with_tooltip';\r\n\r\nimport {FileTypes} from 'utils/constants';\r\nimport {copyToClipboard, getFileType} from 'utils/utils';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport {isFileInfo} from '../types';\r\nimport type {LinkInfo} from '../types';\r\n\r\nimport './file_preview_modal_main_actions.scss';\r\n\r\nconst COPIED_TOOLTIP_DURATION = 2000;\r\n\r\ninterface Props {\r\n    showOnlyClose?: boolean;\r\n    showClose?: boolean;\r\n    showPublicLink?: boolean;\r\n    filename: string;\r\n    fileURL: string;\r\n    fileInfo: FileInfo | LinkInfo;\r\n    enablePublicLink: boolean;\r\n    canDownloadFiles: boolean;\r\n    canCopyContent: boolean;\r\n    handleModalClose: () => void;\r\n    content: string;\r\n}\r\n\r\nconst FilePreviewModalMainActions: React.FC<Props> = ({\r\n    showOnlyClose = false,\r\n    showClose = true,\r\n    showPublicLink = true,\r\n    filename,\r\n    fileURL,\r\n    fileInfo,\r\n    enablePublicLink,\r\n    canDownloadFiles,\r\n    canCopyContent,\r\n    handleModalClose,\r\n    content,\r\n}: Props) => {\r\n    const intl = useIntl();\r\n\r\n    const selectedFilePublicLink = useSelector((state: GlobalState) => selectFilePublicLink(state)?.link);\r\n    const dispatch = useDispatch();\r\n    const [publicLinkCopied, setPublicLinkCopied] = useState(false);\r\n\r\n    useEffect(() => {\r\n        if (isFileInfo(fileInfo) && enablePublicLink) {\r\n            dispatch(getFilePublicLink(fileInfo.id));\r\n        }\r\n    }, [fileInfo, enablePublicLink]);\r\n\r\n    useEffect(() => {\r\n        if (publicLinkCopied) {\r\n            setTimeout(() => {\r\n                setPublicLinkCopied(false);\r\n            }, COPIED_TOOLTIP_DURATION);\r\n        }\r\n    }, [publicLinkCopied]);\r\n\r\n    const copyPublicLink = () => {\r\n        copyToClipboard(selectedFilePublicLink ?? '');\r\n        setPublicLinkCopied(true);\r\n    };\r\n\r\n    const closeMessage = intl.formatMessage({\r\n        id: 'full_screen_modal.close',\r\n        defaultMessage: 'Close',\r\n    });\r\n    const closeButton = (\r\n        <WithTooltip\r\n            title={closeMessage}\r\n            key='publicLink'\r\n        >\r\n            <button\r\n                className='file-preview-modal-main-actions__action-item'\r\n                onClick={handleModalClose}\r\n                aria-label={closeMessage}\r\n            >\r\n                <i className='icon icon-close'/>\r\n            </button>\r\n        </WithTooltip>\r\n    );\r\n\r\n    let publicTooltipMessage;\r\n    if (publicLinkCopied) {\r\n        publicTooltipMessage = intl.formatMessage({\r\n            id: 'file_preview_modal_main_actions.public_link-copied',\r\n            defaultMessage: 'Public link copied',\r\n        });\r\n    } else {\r\n        publicTooltipMessage = intl.formatMessage({\r\n            id: 'view_image_popover.publicLink',\r\n            defaultMessage: 'Get a public link',\r\n        });\r\n    }\r\n    const publicLink = (\r\n        <WithTooltip\r\n            key='filePreviewPublicLink'\r\n            title={publicTooltipMessage}\r\n        >\r\n            <a\r\n                href='#'\r\n                className='file-preview-modal-main-actions__action-item'\r\n                onClick={copyPublicLink}\r\n                aria-label={publicTooltipMessage}\r\n            >\r\n                <i className='icon icon-link-variant'/>\r\n            </a>\r\n        </WithTooltip>\r\n    );\r\n\r\n    const downloadMessage = intl.formatMessage({\r\n        id: 'view_image_popover.download',\r\n        defaultMessage: 'Download',\r\n    });\r\n    const download = (\r\n        <WithTooltip\r\n            key='download'\r\n            title={downloadMessage}\r\n        >\r\n            <ExternalLink\r\n                href={fileURL}\r\n                className='file-preview-modal-main-actions__action-item'\r\n                location='file_preview_modal_main_actions'\r\n                download={filename}\r\n                aria-label={downloadMessage}\r\n            >\r\n                <i className='icon icon-download-outline'/>\r\n            </ExternalLink>\r\n        </WithTooltip>\r\n    );\r\n\r\n    const copy = (\r\n        <CopyButton\r\n            className='file-preview-modal-main-actions__action-item'\r\n            isForText={getFileType(fileInfo.extension) === FileTypes.TEXT}\r\n            content={content}\r\n        />\r\n    );\r\n    return (\r\n        <div className='file-preview-modal-main-actions__actions'>\r\n            {!showOnlyClose && canCopyContent && copy}\r\n            {!showOnlyClose && enablePublicLink && showPublicLink && publicLink}\r\n            {!showOnlyClose && canDownloadFiles && download}\r\n            {showClose && closeButton}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default memo(FilePreviewModalMainActions);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {memo} from 'react';\r\n\r\nimport type {FileInfo} from '@mattermost/types/files';\r\nimport type {Post} from '@mattermost/types/posts';\r\n\r\nimport FilePreviewModalInfo from '../file_preview_modal_info/file_preview_modal_info';\r\nimport FilePreviewModalMainActions from '../file_preview_modal_main_actions/file_preview_modal_main_actions';\r\nimport type {LinkInfo} from '../types';\r\n\r\nimport './file_preview_modal_footer.scss';\r\n\r\ninterface Props {\r\n    fileInfo: FileInfo | LinkInfo;\r\n    filename: string;\r\n    post?: Post;\r\n    fileURL: string;\r\n    showPublicLink?: boolean;\r\n    enablePublicLink: boolean;\r\n    canDownloadFiles: boolean;\r\n    isExternalFile: boolean;\r\n    handleModalClose: () => void;\r\n    canCopyContent: boolean;\r\n    content: string;\r\n}\r\n\r\nconst FilePreviewModalFooter: React.FC<Props> = ({post, ...actionProps}: Props) => {\r\n    return (\r\n        <div className='file-preview-modal-footer'>\r\n            <FilePreviewModalInfo\r\n                showFileName={false}\r\n                post={post}\r\n                filename={actionProps.filename}\r\n            />\r\n            <FilePreviewModalMainActions\r\n                {...actionProps}\r\n                showClose={false}\r\n                showOnlyClose={false}\r\n            />\r\n        </div>\r\n    );\r\n};\r\nexport default memo(FilePreviewModalFooter);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {memo} from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\n\r\nimport './file_preview_modal_main_nav.scss';\r\n\r\nimport WithTooltip from 'components/with_tooltip';\r\n\r\ninterface Props {\r\n    fileIndex: number;\r\n    totalFiles: number;\r\n    handlePrev: () => void;\r\n    handleNext: () => void;\r\n}\r\n\r\nconst FilePreviewModalMainNav: React.FC<Props> = (props: Props) => {\r\n    const {formatMessage} = useIntl();\r\n    const leftArrow = (\r\n        <WithTooltip\r\n            key='previewArrowLeft'\r\n            title={\r\n                <FormattedMessage\r\n                    id='generic.close'\r\n                    defaultMessage='Close'\r\n                />\r\n            }\r\n        >\r\n            <button\r\n                id='previewArrowLeft'\r\n                className='file_preview_modal_main_nav__prev'\r\n                onClick={props.handlePrev}\r\n                aria-label={formatMessage({id: 'file_preview_modal_main_nav.prevAriaLabel', defaultMessage: 'Previous file'})}\r\n            >\r\n                <i className='icon icon-chevron-left'/>\r\n            </button>\r\n        </WithTooltip>\r\n    );\r\n\r\n    const rightArrow = (\r\n        <WithTooltip\r\n            key='publicLink'\r\n            title={\r\n                <FormattedMessage\r\n                    id='generic.next'\r\n                    defaultMessage='Next'\r\n                />\r\n            }\r\n        >\r\n            <button\r\n                id='previewArrowRight'\r\n                className='file_preview_modal_main_nav__next'\r\n                onClick={props.handleNext}\r\n                aria-label={formatMessage({id: 'file_preview_modal_main_nav.nextAriaLabel', defaultMessage: 'Next file'})}\r\n            >\r\n                <i className='icon icon-chevron-right'/>\r\n            </button>\r\n        </WithTooltip>\r\n    );\r\n    return (\r\n        <div className='file_preview_modal_main_nav'>\r\n            {leftArrow}\r\n            <span\r\n                className='modal-bar-file-count'\r\n                aria-live='polite'\r\n                aria-atomic='true'\r\n            >\r\n                <FormattedMessage\r\n                    id='file_preview_modal_main_nav.file'\r\n                    defaultMessage='{count, number} of {total, number}'\r\n                    values={{\r\n                        count: (props.fileIndex + 1),\r\n                        total: props.totalFiles,\r\n                    }}\r\n                />\r\n            </span>\r\n            {rightArrow}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default memo(FilePreviewModalMainNav);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {memo} from 'react';\r\n\r\nimport type {FileInfo} from '@mattermost/types/files';\r\nimport type {Post} from '@mattermost/types/posts';\r\n\r\nimport FilePreviewModalInfo from '../file_preview_modal_info/file_preview_modal_info';\r\nimport FilePreviewModalMainActions from '../file_preview_modal_main_actions/file_preview_modal_main_actions';\r\nimport FilePreviewModalMainNav from '../file_preview_modal_main_nav/file_preview_modal_main_nav';\r\nimport type {LinkInfo} from '../types';\r\n\r\nimport './file_preview_modal_header.scss';\r\n\r\ninterface Props {\r\n    isMobileView: boolean;\r\n    fileIndex: number;\r\n    fileInfo: FileInfo | LinkInfo;\r\n    totalFiles: number;\r\n    filename: string;\r\n    post: Post;\r\n    fileURL: string;\r\n    showPublicLink?: boolean;\r\n    enablePublicLink: boolean;\r\n    canDownloadFiles: boolean;\r\n    canCopyContent: boolean;\r\n    isExternalFile: boolean;\r\n    handlePrev: () => void;\r\n    handleNext: () => void;\r\n    handleModalClose: () => void;\r\n    content: string;\r\n}\r\n\r\nconst FilePreviewModalHeader: React.FC<Props> = ({post, totalFiles, fileIndex, ...actionProps}: Props) => {\r\n    let mainActions = (<div/>);\r\n    if (totalFiles > 1) {\r\n        mainActions = (\r\n            <FilePreviewModalMainNav\r\n                totalFiles={totalFiles}\r\n                fileIndex={fileIndex}\r\n                handlePrev={actionProps.handlePrev}\r\n                handleNext={actionProps.handleNext}\r\n            />\r\n        );\r\n    }\r\n    const actions = (\r\n        <FilePreviewModalMainActions\r\n            {...actionProps}\r\n            showOnlyClose={actionProps.isMobileView}\r\n        />);\r\n    return (\r\n        <div className='file-preview-modal-header'>\r\n            {actionProps.isMobileView && actions}\r\n            {!actionProps.isMobileView &&\r\n            <FilePreviewModalInfo\r\n                showFileName={true}\r\n                post={post}\r\n                filename={actionProps.filename}\r\n            />\r\n            }\r\n            {mainActions}\r\n            {!actionProps.isMobileView && actions}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default memo(FilePreviewModalHeader);\r\n\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\n\r\nimport type {FileInfo} from '@mattermost/types/files';\r\n\r\nimport {getFilePreviewUrl, getFileDownloadUrl} from 'mattermost-redux/utils/file_utils';\r\n\r\nimport {FileTypes} from 'utils/constants';\r\nimport {getFileType} from 'utils/utils';\r\n\r\nimport './image_preview.scss';\r\n\r\ninterface Props {\r\n    fileInfo: FileInfo;\r\n    canDownloadFiles: boolean;\r\n}\r\n\r\nexport default function ImagePreview({fileInfo, canDownloadFiles}: Props) {\r\n    const isExternalFile = !fileInfo.id;\r\n\r\n    let fileUrl;\r\n    let previewUrl;\r\n    if (isExternalFile) {\r\n        fileUrl = fileInfo.link;\r\n        previewUrl = fileInfo.link;\r\n    } else {\r\n        fileUrl = getFileDownloadUrl(fileInfo.id);\r\n        previewUrl = fileInfo.has_preview_image ? getFilePreviewUrl(fileInfo.id) : fileUrl;\r\n    }\r\n\r\n    if (!canDownloadFiles) {\r\n        return <img src={previewUrl}/>;\r\n    }\r\n\r\n    let conditionalSVGStyleAttribute;\r\n    if (getFileType(fileInfo.extension) === FileTypes.SVG) {\r\n        conditionalSVGStyleAttribute = {\r\n            width: fileInfo.width,\r\n            height: 'auto',\r\n        };\r\n    }\r\n\r\n    return (\r\n        <a\r\n            className='image_preview'\r\n            href='#'\r\n        >\r\n            <img\r\n                className='image_preview__image'\r\n                loading='lazy'\r\n                data-testid='imagePreview'\r\n                alt={'preview url image'}\r\n                src={previewUrl}\r\n                style={conditionalSVGStyleAttribute}\r\n            />\r\n        </a>\r\n    );\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport debounce from 'lodash/debounce';\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport WithTooltip from 'components/with_tooltip';\r\n\r\nimport {ZoomSettings} from 'utils/constants';\r\n\r\nexport interface Props {\r\n    scale?: number;\r\n    showZoomControls?: boolean;\r\n    handleZoomIn?: () => void;\r\n    handleZoomOut?: () => void;\r\n    handleZoomReset?: () => void;\r\n}\r\n\r\nexport default class PopoverBar extends React.PureComponent<Props> {\r\n    render() {\r\n        const zoomControls: React.ReactNode[] = [];\r\n        let wrappedZoomControls: React.ReactNode = null;\r\n        if (this.props.showZoomControls) {\r\n            let zoomResetButton;\r\n            let zoomOutButton;\r\n            let zoomInButton;\r\n\r\n            if (this.props.scale && this.props.scale > ZoomSettings.MIN_SCALE) {\r\n                zoomOutButton = (\r\n                    <span className='modal-zoom-btn'>\r\n                        <a onClick={this.props.handleZoomOut && debounce(this.props.handleZoomOut, 300, {maxWait: 300})}>\r\n                            <i className='icon icon-minus'/>\r\n                        </a>\r\n                    </span>\r\n                );\r\n            } else {\r\n                zoomOutButton = (\r\n                    <span className='btn-inactive'>\r\n                        <i className='icon icon-minus'/>\r\n                    </span>\r\n                );\r\n            }\r\n            zoomControls.push(\r\n                <WithTooltip\r\n                    key='zoomOut'\r\n                    title={\r\n                        <FormattedMessage\r\n                            id='view_image.zoom_out'\r\n                            defaultMessage='Zoom Out'\r\n                        />\r\n                    }\r\n                >\r\n                    {zoomOutButton}\r\n                </WithTooltip>,\r\n            );\r\n\r\n            if (this.props.scale && this.props.scale > ZoomSettings.DEFAULT_SCALE) {\r\n                zoomResetButton = (\r\n                    <span className='modal-zoom-btn'>\r\n                        <a onClick={this.props.handleZoomReset}>\r\n                            <i className='icon icon-magnify-minus'/>\r\n                        </a>\r\n                    </span>\r\n                );\r\n            } else if (this.props.scale && this.props.scale < ZoomSettings.DEFAULT_SCALE) {\r\n                zoomResetButton = (\r\n                    <span className='modal-zoom-btn'>\r\n                        <a onClick={this.props.handleZoomReset}>\r\n                            <i className='icon icon-magnify-plus'/>\r\n                        </a>\r\n                    </span>\r\n                );\r\n            } else {\r\n                zoomResetButton = (\r\n                    <span className='btn-inactive'>\r\n                        <i className='icon icon-magnify-minus'/>\r\n                    </span>\r\n                );\r\n            }\r\n            zoomControls.push(\r\n                <WithTooltip\r\n                    key='zoomReset'\r\n                    title={\r\n                        <FormattedMessage\r\n                            id='view_image.zoom_reset'\r\n                            defaultMessage='Reset Zoom'\r\n                        />\r\n                    }\r\n                >\r\n                    {zoomResetButton}\r\n                </WithTooltip>,\r\n            );\r\n\r\n            if (this.props.scale && this.props.scale < ZoomSettings.MAX_SCALE) {\r\n                zoomInButton = (\r\n                    <span className='modal-zoom-btn'>\r\n                        <a onClick={this.props.handleZoomIn && debounce(this.props.handleZoomIn, 300, {maxWait: 300})}>\r\n                            <i className='icon icon-plus'/>\r\n                        </a>\r\n                    </span>\r\n\r\n                );\r\n            } else {\r\n                zoomInButton = (\r\n                    <span className='btn-inactive'>\r\n                        <i className='icon icon-plus'/>\r\n                    </span>\r\n                );\r\n            }\r\n            zoomControls.push(\r\n                <WithTooltip\r\n                    key='zoomIn'\r\n                    title={\r\n                        <FormattedMessage\r\n                            id='view_image.zoom_in'\r\n                            defaultMessage='Zoom In'\r\n                        />\r\n                    }\r\n                >\r\n                    {zoomInButton}\r\n                </WithTooltip>,\r\n            );\r\n\r\n            wrappedZoomControls = (\r\n                <div className='modal-column'>\r\n                    {zoomControls}\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div\r\n                data-testid='fileCountFooter'\r\n                className='modal-button-bar file-preview-modal__zoom-bar'\r\n            >\r\n                {wrappedZoomControls}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport PopoverBar from './popover_bar';\r\n\r\nexport default PopoverBar;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\nimport {Modal} from 'react-bootstrap';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport type {FileInfo} from '@mattermost/types/files';\r\nimport type {Post} from '@mattermost/types/posts';\r\n\r\nimport {getFileDownloadUrl, getFilePreviewUrl, getFileUrl} from 'mattermost-redux/utils/file_utils';\r\n\r\nimport ArchivedPreview from 'components/archived_preview';\r\nimport AudioVideoPreview from 'components/audio_video_preview';\r\nimport CodePreview, {hasSupportedLanguage} from 'components/code_preview';\r\nimport FileInfoPreview from 'components/file_info_preview';\r\nimport LoadingImagePreview from 'components/loading_image_preview';\r\nimport type {Props as PDFPreviewComponentProps} from 'components/pdf_preview';\r\n\r\nimport Constants, {FileTypes, ZoomSettings} from 'utils/constants';\r\nimport * as Keyboard from 'utils/keyboard';\r\nimport * as Utils from 'utils/utils';\r\n\r\nimport type {FilePreviewComponent} from 'types/store/plugins';\r\n\r\nimport FilePreviewModalFooter from './file_preview_modal_footer/file_preview_modal_footer';\r\nimport FilePreviewModalHeader from './file_preview_modal_header/file_preview_modal_header';\r\nimport ImagePreview from './image_preview';\r\nimport PopoverBar from './popover_bar';\r\nimport {isFileInfo, isLinkInfo} from './types';\r\nimport type {LinkInfo} from './types';\r\n\r\nimport './file_preview_modal.scss';\r\n\r\nconst PDFPreview = React.lazy<React.ComponentType<PDFPreviewComponentProps>>(() => import('components/pdf_preview'));\r\n\r\nconst KeyCodes = Constants.KeyCodes;\r\n\r\nexport type Props = {\r\n    canDownloadFiles: boolean;\r\n    enablePublicLink: boolean;\r\n\r\n    /**\r\n     * List of FileInfo to view\r\n     **/\r\n    fileInfos: Array<FileInfo | LinkInfo>;\r\n\r\n    isMobileView: boolean;\r\n    pluginFilePreviewComponents: FilePreviewComponent[];\r\n    onExited: () => void;\r\n\r\n    /**\r\n     * The id of the post the files are attached to\r\n     */\r\n    postId?: string;\r\n\r\n    /**\r\n     * The post the files are attached to\r\n     * Either postId or post can be passed to FilePreviewModal\r\n     */\r\n    post?: Post;\r\n\r\n    /**\r\n     * The index number of starting image\r\n     **/\r\n    startIndex: number;\r\n}\r\n\r\ntype State = {\r\n    show: boolean;\r\n    imageIndex: number;\r\n    imageHeight: number | string;\r\n    loaded: Record<number, boolean>;\r\n    prevFileInfosCount: number;\r\n    progress: Record<number, number>;\r\n    showCloseBtn: boolean;\r\n    showZoomControls: boolean;\r\n    scale: Record<number, number>;\r\n    content: string;\r\n}\r\n\r\nexport default class FilePreviewModal extends React.PureComponent<Props, State> {\r\n    static defaultProps = {\r\n        fileInfos: [],\r\n        startIndex: 0,\r\n        pluginFilePreviewComponents: [],\r\n    };\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            show: true,\r\n            imageIndex: this.props.startIndex,\r\n            imageHeight: '100%',\r\n            loaded: Utils.fillRecord(false, this.props.fileInfos.length),\r\n            prevFileInfosCount: 0,\r\n            progress: Utils.fillRecord(0, this.props.fileInfos.length),\r\n            showCloseBtn: false,\r\n            showZoomControls: false,\r\n            scale: Utils.fillRecord(ZoomSettings.DEFAULT_SCALE, this.props.fileInfos.length),\r\n            content: '',\r\n        };\r\n    }\r\n\r\n    handleNext = () => {\r\n        let id = this.state.imageIndex + 1;\r\n        if (id > this.props.fileInfos.length - 1) {\r\n            id = 0;\r\n        }\r\n        this.showImage(id);\r\n    };\r\n\r\n    handlePrev = () => {\r\n        let id = this.state.imageIndex - 1;\r\n        if (id < 0) {\r\n            id = this.props.fileInfos.length - 1;\r\n        }\r\n        this.showImage(id);\r\n    };\r\n\r\n    handleKeyPress = (e: KeyboardEvent) => {\r\n        if (Keyboard.isKeyPressed(e, KeyCodes.RIGHT)) {\r\n            this.handleNext();\r\n        } else if (Keyboard.isKeyPressed(e, KeyCodes.LEFT)) {\r\n            this.handlePrev();\r\n        }\r\n    };\r\n\r\n    componentDidMount() {\r\n        document.addEventListener('keyup', this.handleKeyPress);\r\n\r\n        this.showImage(this.props.startIndex);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        document.removeEventListener('keyup', this.handleKeyPress);\r\n    }\r\n\r\n    static getDerivedStateFromProps(props: Props, state: State) {\r\n        const updatedState: Partial<State> = {};\r\n        if (props.fileInfos[state.imageIndex] && props.fileInfos[state.imageIndex].extension === FileTypes.PDF) {\r\n            updatedState.showZoomControls = true;\r\n        } else {\r\n            updatedState.showZoomControls = false;\r\n        }\r\n        if (props.fileInfos.length !== state.prevFileInfosCount) {\r\n            updatedState.loaded = Utils.fillRecord(false, props.fileInfos.length);\r\n            updatedState.progress = Utils.fillRecord(0, props.fileInfos.length);\r\n            updatedState.prevFileInfosCount = props.fileInfos.length;\r\n        }\r\n        return Object.keys(updatedState).length ? updatedState : null;\r\n    }\r\n\r\n    showImage = (id: number) => {\r\n        this.setState({imageIndex: id});\r\n\r\n        const imageHeight = window.innerHeight - 100;\r\n        this.setState({imageHeight});\r\n\r\n        if (!this.state.loaded[id]) {\r\n            this.loadImage(id);\r\n        }\r\n    };\r\n\r\n    isImageUrl = (url: string): boolean => {\r\n        const fileType = Utils.getFileType(url);\r\n        return fileType === FileTypes.IMAGE || fileType === FileTypes.SVG;\r\n    };\r\n\r\n    private getFileTypeFromFileInfo = (fileInfo: FileInfo | LinkInfo): typeof FileTypes[keyof typeof FileTypes] => {\r\n        if (isFileInfo(fileInfo)) {\r\n            return Utils.getFileType(fileInfo.extension);\r\n        }\r\n\r\n        if (isLinkInfo(fileInfo)) {\r\n            // if extension is not available or is longer than 5 characters, use the link to determine the file type\r\n            const maxLenghtExtension = 11; // applescript is the longest extension\r\n            const extensionOrLink = fileInfo.extension && fileInfo.extension.length <= maxLenghtExtension ? fileInfo.extension : fileInfo.link;\r\n            return Utils.getFileType(extensionOrLink);\r\n        }\r\n\r\n        return FileTypes.OTHER;\r\n    };\r\n\r\n    loadImage = (index: number) => {\r\n        const fileInfo = this.props.fileInfos[index];\r\n        if (isFileInfo(fileInfo) && fileInfo.archived) {\r\n            this.handleImageLoaded(index);\r\n            return;\r\n        }\r\n\r\n        // Determine file type using helper method\r\n        const fileType = this.getFileTypeFromFileInfo(fileInfo);\r\n\r\n        // Check if this is an image\r\n        const isImage = fileType === FileTypes.IMAGE;\r\n\r\n        if (isImage) {\r\n            let previewUrl = '';\r\n            if (isFileInfo(fileInfo)) {\r\n                if (fileInfo.has_preview_image) {\r\n                    previewUrl = getFilePreviewUrl(fileInfo.id);\r\n                } else {\r\n                    // some images (eg animated gifs) just show the file itself and not a preview\r\n                    previewUrl = getFileUrl(fileInfo.id);\r\n                }\r\n            } else if (isLinkInfo(fileInfo)) {\r\n                // For LinkInfo, use the link directly\r\n                previewUrl = fileInfo.link;\r\n            }\r\n\r\n            Utils.loadImage(\r\n                previewUrl,\r\n                () => this.handleImageLoaded(index),\r\n                (completedPercentage) => this.handleImageProgress(index, completedPercentage),\r\n            );\r\n        } else {\r\n            // there's nothing to load for non-image files\r\n            this.handleImageLoaded(index);\r\n        }\r\n    };\r\n\r\n    handleImageLoaded = (index: number) => {\r\n        this.setState((prevState) => {\r\n            return {\r\n                loaded: {\r\n                    ...prevState.loaded,\r\n                    [index]: true,\r\n                },\r\n            };\r\n        });\r\n    };\r\n\r\n    handleImageProgress = (index: number, completedPercentage: number) => {\r\n        this.setState((prevState) => {\r\n            return {\r\n                progress: {\r\n                    ...prevState.progress,\r\n                    [index]: completedPercentage,\r\n                },\r\n            };\r\n        });\r\n    };\r\n\r\n    onMouseEnterImage = () => {\r\n        this.setState({showCloseBtn: true});\r\n    };\r\n\r\n    onMouseLeaveImage = () => {\r\n        this.setState({showCloseBtn: false});\r\n    };\r\n\r\n    setScale = (index: number, scale: number) => {\r\n        this.setState((prevState) => {\r\n            return {\r\n                scale: {\r\n                    ...prevState.scale,\r\n                    [index]: scale,\r\n                },\r\n            };\r\n        });\r\n    };\r\n\r\n    handleZoomIn = () => {\r\n        let newScale = this.state.scale[this.state.imageIndex];\r\n        newScale = Math.min(newScale + ZoomSettings.SCALE_DELTA, ZoomSettings.MAX_SCALE);\r\n        this.setScale(this.state.imageIndex, newScale);\r\n    };\r\n\r\n    handleZoomOut = () => {\r\n        let newScale = this.state.scale[this.state.imageIndex];\r\n        newScale = Math.max(newScale - ZoomSettings.SCALE_DELTA, ZoomSettings.MIN_SCALE);\r\n        this.setScale(this.state.imageIndex, newScale);\r\n    };\r\n\r\n    handleZoomReset = () => {\r\n        this.setScale(this.state.imageIndex, ZoomSettings.DEFAULT_SCALE);\r\n    };\r\n\r\n    handleModalClose = () => {\r\n        this.setState({show: false});\r\n    };\r\n\r\n    getContent = (content: string) => {\r\n        this.setState({content});\r\n    };\r\n\r\n    handleBgClose = (e: React.MouseEvent) => {\r\n        if (e.currentTarget === e.target) {\r\n            this.handleModalClose();\r\n        }\r\n    };\r\n\r\n    render() {\r\n        if (this.props.fileInfos.length < 1 || this.props.fileInfos.length - 1 < this.state.imageIndex) {\r\n            return null;\r\n        }\r\n\r\n        const fileInfo = this.props.fileInfos[this.state.imageIndex];\r\n\r\n        // Determine file type using helper method\r\n        const fileType = this.getFileTypeFromFileInfo(fileInfo);\r\n\r\n        let showPublicLink;\r\n        let fileName;\r\n        let fileUrl;\r\n        let fileDownloadUrl;\r\n        let isExternalFile;\r\n        let canCopyContent = false;\r\n        if (isFileInfo(fileInfo)) {\r\n            showPublicLink = true;\r\n            fileName = fileInfo.name;\r\n            fileUrl = getFileUrl(fileInfo.id);\r\n            fileDownloadUrl = getFileDownloadUrl(fileInfo.id);\r\n            isExternalFile = false;\r\n        } else {\r\n            showPublicLink = false;\r\n            fileName = fileInfo.name || fileInfo.link;\r\n            fileUrl = fileInfo.link;\r\n            fileDownloadUrl = fileInfo.link;\r\n            isExternalFile = true;\r\n        }\r\n\r\n        let dialogClassName = 'a11y__modal modal-image file-preview-modal';\r\n\r\n        let content;\r\n        let zoomBar;\r\n\r\n        if (isFileInfo(fileInfo) && fileInfo.archived) {\r\n            content = (\r\n                <ArchivedPreview\r\n                    fileInfo={fileInfo}\r\n                />\r\n            );\r\n        }\r\n\r\n        if (!isFileInfo(fileInfo) || !fileInfo.archived) {\r\n            if (this.state.loaded[this.state.imageIndex]) {\r\n                if (fileType === FileTypes.IMAGE || fileType === FileTypes.SVG) {\r\n                    content = (\r\n                        <ImagePreview\r\n                            fileInfo={fileInfo as FileInfo}\r\n                            canDownloadFiles={this.props.canDownloadFiles}\r\n                        />\r\n                    );\r\n                } else if (fileType === FileTypes.VIDEO || fileType === FileTypes.AUDIO) {\r\n                    content = (\r\n                        <AudioVideoPreview\r\n                            fileInfo={fileInfo as FileInfo}\r\n                            fileUrl={fileUrl}\r\n                        />\r\n                    );\r\n                } else if (fileType === FileTypes.PDF) {\r\n                    content = (\r\n                        <div\r\n                            className='file-preview-modal__scrollable'\r\n                            onClick={this.handleBgClose}\r\n                        >\r\n                            <React.Suspense fallback={null}>\r\n                                <PDFPreview\r\n                                    fileInfo={fileInfo as FileInfo}\r\n                                    fileUrl={fileUrl}\r\n                                    scale={this.state.scale[this.state.imageIndex]}\r\n                                    handleBgClose={this.handleBgClose}\r\n                                />\r\n                            </React.Suspense>\r\n                        </div>\r\n                    );\r\n                    zoomBar = (\r\n                        <PopoverBar\r\n                            scale={this.state.scale[this.state.imageIndex]}\r\n                            showZoomControls={this.state.showZoomControls}\r\n                            handleZoomIn={this.handleZoomIn}\r\n                            handleZoomOut={this.handleZoomOut}\r\n                            handleZoomReset={this.handleZoomReset}\r\n                        />\r\n                    );\r\n                } else if (hasSupportedLanguage(fileInfo)) {\r\n                    dialogClassName += ' modal-code';\r\n                    canCopyContent = true;\r\n                    content = (\r\n                        <CodePreview\r\n                            fileInfo={fileInfo as FileInfo}\r\n                            fileUrl={fileUrl}\r\n                            getContent={this.getContent}\r\n                        />\r\n                    );\r\n                } else {\r\n                    content = (\r\n                        <FileInfoPreview\r\n                            fileInfo={fileInfo as FileInfo}\r\n                            fileUrl={fileUrl}\r\n                        />\r\n                    );\r\n                }\r\n            } else {\r\n                // display a progress indicator when the preview for an image is still loading\r\n                const progress = Math.floor(this.state.progress[this.state.imageIndex]);\r\n\r\n                content = (\r\n                    <LoadingImagePreview\r\n                        loading={\r\n                            <FormattedMessage\r\n                                id='view_image.loading'\r\n                                defaultMessage='Loading'\r\n                            />\r\n                        }\r\n                        progress={progress}\r\n                    />\r\n                );\r\n            }\r\n        }\r\n\r\n        if (isFileInfo(fileInfo) && !fileInfo.archived) {\r\n            for (const preview of this.props.pluginFilePreviewComponents) {\r\n                if (preview.override(fileInfo, this.props.post)) {\r\n                    content = (\r\n                        <preview.component\r\n                            fileInfo={fileInfo}\r\n                            post={this.props.post}\r\n                            onModalDismissed={this.handleModalClose}\r\n                        />\r\n                    );\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        return (\r\n            <Modal\r\n                show={this.state.show}\r\n                onHide={this.handleModalClose}\r\n                onExited={this.props.onExited}\r\n                className='modal-image file-preview-modal'\r\n                dialogClassName={dialogClassName}\r\n                animation={true}\r\n                backdrop={false}\r\n                role='none'\r\n                style={{paddingLeft: 0}}\r\n                aria-labelledby='viewImageModalLabel'\r\n            >\r\n                <Modal.Body className='file-preview-modal__body'>\r\n                    <div\r\n                        className={'modal-image__wrapper'}\r\n                        onClick={this.handleModalClose}\r\n                    >\r\n                        <div\r\n                            className='file-preview-modal__main-ctr'\r\n                            onMouseEnter={this.onMouseEnterImage}\r\n                            onMouseLeave={this.onMouseLeaveImage}\r\n                            onClick={(e) => e.stopPropagation()}\r\n                        >\r\n                            <Modal.Title\r\n                                componentClass='div'\r\n                                id='viewImageModalLabel'\r\n                                className='file-preview-modal__title'\r\n                            >\r\n                                <FilePreviewModalHeader\r\n                                    isMobileView={this.props.isMobileView}\r\n                                    post={this.props.post!}\r\n                                    showPublicLink={showPublicLink}\r\n                                    fileIndex={this.state.imageIndex}\r\n                                    totalFiles={this.props.fileInfos?.length}\r\n                                    filename={fileName}\r\n                                    fileURL={fileDownloadUrl}\r\n                                    fileInfo={fileInfo}\r\n                                    enablePublicLink={this.props.enablePublicLink}\r\n                                    canDownloadFiles={this.props.canDownloadFiles}\r\n                                    canCopyContent={canCopyContent}\r\n                                    isExternalFile={isExternalFile}\r\n                                    handlePrev={this.handlePrev}\r\n                                    handleNext={this.handleNext}\r\n                                    handleModalClose={this.handleModalClose}\r\n                                    content={this.state.content}\r\n                                />\r\n                                {zoomBar}\r\n                            </Modal.Title>\r\n                            <div\r\n                                className={classNames(\r\n                                    'file-preview-modal__content',\r\n                                    {\r\n                                        'file-preview-modal__content-scrollable': (!isFileInfo(fileInfo) || !fileInfo.archived) && this.state.loaded[this.state.imageIndex] && (fileType === FileTypes.PDF),\r\n                                    },\r\n                                )}\r\n                                onClick={this.handleBgClose}\r\n                            >\r\n                                {content}\r\n                            </div>\r\n                            { this.props.isMobileView &&\r\n                                <FilePreviewModalFooter\r\n                                    post={this.props.post}\r\n                                    showPublicLink={showPublicLink}\r\n                                    filename={fileName}\r\n                                    fileURL={fileDownloadUrl}\r\n                                    fileInfo={fileInfo}\r\n                                    enablePublicLink={this.props.enablePublicLink}\r\n                                    canDownloadFiles={this.props.canDownloadFiles}\r\n                                    canCopyContent={canCopyContent}\r\n                                    isExternalFile={isExternalFile}\r\n                                    handleModalClose={this.handleModalClose}\r\n                                    content={this.state.content}\r\n                                />\r\n                            }\r\n                        </div>\r\n                    </div>\r\n                </Modal.Body>\r\n            </Modal>\r\n        );\r\n    }\r\n}\r\n"],"names":["FileInfoPreview","_ref","fileInfo","fileUrl","canDownloadFiles","intl","useIntl","infoParts","extension","push","formatMessage","id","defaultMessage","toUpperCase","size","Utils","infoString","join","preview","React","className","href","alt","src","name","propTypes","_pt","isRequired","connect","state","config","getConfig","props","ArchiveOutlineIcon","color","AudioVideoPreview","constructor","super","_defineProperty","video","this","videoRef","current","document","createElement","setState","canPlay","pause","currentTime","componentDidMount","handleFileInfoChanged","sourceRef","addEventListener","handleLoadError","once","componentDidUpdate","prevProps","render","width","Constants","WEB_VIDEO_WIDTH","height","WEB_VIDEO_HEIGHT","isMobileView","MOBILE_VIDEO_WIDTH","MOBILE_VIDEO_HEIGHT","key","ref","controls","getIsMobileView","CodePreview","getContent","codeInfo","setCodeInfo","useState","code","lang","highlighted","status","setStatus","useEffect","usedLanguage","SyntaxHighlighting","CODE_PREVIEW_MAX_FILE_SIZE","async","_response$headers$get","response","fetch","text","headers","get","includes","xmlDoc","DOMParser","parseFromString","nodeName","XMLSerializer","serializeToString","_unused","e","fetchCode","LoadingSpinner","language","concat","dangerouslySetInnerHTML","__html","displayNameGetter","makeGetDisplayName","FilePreviewModalInfo","user","useSelector","_props$post$user_id","_props$post","selectUser","post","user_id","channel","_props$post$channel_i","_props$post2","makeGetChannel","getChannel","channel_id","_props$post$user_id2","_props$post3","info","channelName","FormattedMessage","values","display_name","showFileName","filename","Object","keys","length","Avatar","username","url","imageURLForUser","last_picture_update","memo","isFileInfo","Boolean","isLinkInfo","link","FilePreviewModalMainActions","showOnlyClose","showClose","showPublicLink","fileURL","enablePublicLink","canCopyContent","handleModalClose","content","selectedFilePublicLink","_selectFilePublicLink","selectFilePublicLink","dispatch","useDispatch","publicLinkCopied","setPublicLinkCopied","getFilePublicLink","setTimeout","closeMessage","closeButton","WithTooltip","title","onClick","publicTooltipMessage","publicLink","copyPublicLink","copyToClipboard","downloadMessage","download","ExternalLink","location","copy","CopyButton","isForText","getFileType","FileTypes","TEXT","FilePreviewModalFooter","actionProps","_objectWithoutProperties","_excluded","assign","isExternalFile","FilePreviewModalMainNav","leftArrow","handlePrev","rightArrow","handleNext","count","fileIndex","total","totalFiles","FilePreviewModalHeader","mainActions","actions","ImagePreview","previewUrl","conditionalSVGStyleAttribute","getFileDownloadUrl","has_preview_image","getFilePreviewUrl","SVG","loading","style","PopoverBar","zoomControls","wrappedZoomControls","showZoomControls","zoomResetButton","zoomOutButton","zoomInButton","scale","ZoomSettings","MIN_SCALE","handleZoomOut","debounce","maxWait","DEFAULT_SCALE","handleZoomReset","MAX_SCALE","handleZoomIn","PDFPreview","KeyCodes","FilePreviewModal","imageIndex","fileInfos","showImage","Keyboard","RIGHT","LEFT","imageHeight","window","innerHeight","loaded","loadImage","fileType","IMAGE","maxLenghtExtension","extensionOrLink","OTHER","index","archived","handleImageLoaded","getFileTypeFromFileInfo","getFileUrl","completedPercentage","handleImageProgress","prevState","_objectSpread","progress","showCloseBtn","newScale","Math","min","SCALE_DELTA","setScale","max","show","currentTarget","target","startIndex","prevFileInfosCount","handleKeyPress","componentWillUnmount","removeEventListener","getDerivedStateFromProps","updatedState","PDF","_this$props$fileInfos","fileName","fileDownloadUrl","zoomBar","dialogClassName","ArchivedPreview","VIDEO","AUDIO","handleBgClose","fallback","hasSupportedLanguage","floor","LoadingImagePreview","pluginFilePreviewComponents","override","component","onModalDismissed","Modal","onHide","onExited","animation","backdrop","role","paddingLeft","Body","onMouseEnter","onMouseEnterImage","onMouseLeave","onMouseLeaveImage","stopPropagation","Title","componentClass","classNames","postId"],"sourceRoot":""}