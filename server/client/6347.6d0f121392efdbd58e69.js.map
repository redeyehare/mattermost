{"version":3,"file":"6347.6d0f121392efdbd58e69.js","mappings":"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","sources":["webpack://mattermost-webapp/./src/components/widgets/icons/fa_back_icon.tsx","webpack://mattermost-webapp/./src/components/backstage/components/backstage_navbar.tsx","webpack://mattermost-webapp/./src/components/integrations/delete_integration_link/delete_integration_link.tsx","webpack://mattermost-webapp/./src/components/integrations/delete_integration_link/index.ts","webpack://mattermost-webapp/./src/components/emoji/emoji_list_item/delete_emoji_button.tsx","webpack://mattermost-webapp/./src/components/emoji/emoji_list_item/emoji_list_item.tsx","webpack://mattermost-webapp/./src/components/emoji/emoji_list_item/index.ts","webpack://mattermost-webapp/./src/components/emoji/emoji_list/emoji_list.tsx","webpack://mattermost-webapp/./src/components/emoji/emoji_list/index.ts","webpack://mattermost-webapp/./src/components/emoji/emoji_page.tsx","webpack://mattermost-webapp/./src/components/emoji/index.ts","webpack://mattermost-webapp/./src/components/backstage/components/backstage_header.tsx","webpack://mattermost-webapp/./src/components/emoji/add_emoji/add_emoji.tsx","webpack://mattermost-webapp/./src/components/emoji/add_emoji/index.ts","webpack://mattermost-webapp/./src/components/integrations/integration_option.tsx","webpack://mattermost-webapp/./src/components/integrations/integrations.tsx","webpack://mattermost-webapp/./src/components/integrations/index.ts","webpack://mattermost-webapp/./src/components/channel_select/channel_select.tsx","webpack://mattermost-webapp/./src/components/channel_select/index.ts","webpack://mattermost-webapp/./src/components/integrations/abstract_incoming_webhook.tsx","webpack://mattermost-webapp/./src/components/integrations/add_incoming_webhook/add_incoming_webhook.tsx","webpack://mattermost-webapp/./src/components/integrations/add_incoming_webhook/index.ts","webpack://mattermost-webapp/./src/components/integrations/abstract_oauth_app.tsx","webpack://mattermost-webapp/./src/components/integrations/add_oauth_app/add_oauth_app.tsx","webpack://mattermost-webapp/./src/components/integrations/add_oauth_app/index.ts","webpack://mattermost-webapp/./src/components/integrations/abstract_outgoing_webhook.tsx","webpack://mattermost-webapp/./src/components/integrations/add_outgoing_webhook/add_outgoing_webhook.tsx","webpack://mattermost-webapp/./src/components/integrations/add_outgoing_webhook/index.ts","webpack://mattermost-webapp/./src/packages/mattermost-redux/src/actions/bots.ts","webpack://mattermost-webapp/./src/components/backstage/components/backstage_list.tsx","webpack://mattermost-webapp/./src/components/integrations/bots/bot.tsx","webpack://mattermost-webapp/./src/components/integrations/bots/bots.tsx","webpack://mattermost-webapp/./src/components/integrations/bots/index.ts","webpack://mattermost-webapp/./src/components/integrations/bots/add_bot/add_bot.tsx","webpack://mattermost-webapp/./src/components/integrations/bots/add_bot/index.ts","webpack://mattermost-webapp/./src/components/integrations/outgoing_oauth_connections/oauth_connection_audience_input.tsx","webpack://mattermost-webapp/./src/components/integrations/abstract_command.tsx","webpack://mattermost-webapp/./src/components/integrations/add_command/add_command.tsx","webpack://mattermost-webapp/./src/components/integrations/add_command/index.ts","webpack://mattermost-webapp/./src/components/copy_text.tsx","webpack://mattermost-webapp/./src/components/integrations/confirm_integration/confirm_integration.tsx","webpack://mattermost-webapp/./src/components/integrations/confirm_integration/index.ts","webpack://mattermost-webapp/./src/components/integrations/edit_command/edit_command.tsx","webpack://mattermost-webapp/./src/components/integrations/edit_command/index.ts","webpack://mattermost-webapp/./src/components/integrations/installed_command.tsx","webpack://mattermost-webapp/./src/components/integrations/installed_commands/installed_commands.tsx","webpack://mattermost-webapp/./src/components/integrations/installed_commands/index.ts","webpack://mattermost-webapp/./src/components/integrations/commands_container/commands_container.tsx","webpack://mattermost-webapp/./src/components/integrations/commands_container/index.ts","webpack://mattermost-webapp/./src/components/integrations/edit_incoming_webhook/edit_incoming_webhook.tsx","webpack://mattermost-webapp/./src/components/integrations/edit_incoming_webhook/index.ts","webpack://mattermost-webapp/./src/components/integrations/edit_oauth_app/edit_oauth_app.tsx","webpack://mattermost-webapp/./src/components/integrations/edit_oauth_app/index.ts","webpack://mattermost-webapp/./src/components/integrations/edit_outgoing_webhook/edit_outgoing_webhook.tsx","webpack://mattermost-webapp/./src/components/integrations/edit_outgoing_webhook/index.ts","webpack://mattermost-webapp/./src/components/integrations/installed_incoming_webhook.tsx","webpack://mattermost-webapp/./src/components/integrations/installed_incoming_webhooks/installed_incoming_webhooks.tsx","webpack://mattermost-webapp/./src/components/integrations/installed_incoming_webhooks/index.ts","webpack://mattermost-webapp/./src/components/integrations/installed_oauth_app/installed_oauth_app.tsx","webpack://mattermost-webapp/./src/components/integrations/installed_oauth_app/index.ts","webpack://mattermost-webapp/./src/components/integrations/installed_oauth_apps/installed_oauth_apps.tsx","webpack://mattermost-webapp/./src/components/integrations/installed_oauth_apps/index.ts","webpack://mattermost-webapp/./src/components/integrations/installed_outgoing_webhook.tsx","webpack://mattermost-webapp/./src/components/integrations/installed_outgoing_webhooks/installed_outgoing_webhooks.tsx","webpack://mattermost-webapp/./src/components/integrations/installed_outgoing_webhooks/index.ts","webpack://mattermost-webapp/./src/components/integrations/outgoing_oauth_connections/abstract_outgoing_oauth_connection.tsx","webpack://mattermost-webapp/./src/components/integrations/outgoing_oauth_connections/add_outgoing_oauth_connection.tsx","webpack://mattermost-webapp/./src/components/integrations/outgoing_oauth_connections/edit_outgoing_oauth_connection.tsx","webpack://mattermost-webapp/./src/components/integrations/outgoing_oauth_connections/installed_outgoing_oauth_connection.tsx","webpack://mattermost-webapp/./src/components/integrations/outgoing_oauth_connections/installed_outgoing_oauth_connections.tsx","webpack://mattermost-webapp/./src/components/backstage/components/backstage_category.tsx","webpack://mattermost-webapp/./src/components/backstage/components/backstage_section.tsx","webpack://mattermost-webapp/./src/components/backstage/components/backstage_sidebar.tsx","webpack://mattermost-webapp/./src/components/backstage/backstage_controller.tsx","webpack://mattermost-webapp/./src/components/backstage/index.ts","webpack://mattermost-webapp/./src/components/form_error.tsx","webpack://mattermost-webapp/./src/components/localized_placeholder_input.tsx","webpack://mattermost-webapp/./src/components/widgets/icons/fa_next_icon.tsx","webpack://mattermost-webapp/./src/components/widgets/icons/fa_previous_icon.tsx","webpack://mattermost-webapp/./src/components/widgets/icons/fa_search_icon.tsx","webpack://mattermost-webapp/./src/components/widgets/icons/fa_warning_icon.tsx","webpack://mattermost-webapp/./src/packages/mattermost-redux/src/selectors/entities/bots.ts"],"sourcesContent":["// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nexport default function BackIcon() {\r\n    const {formatMessage} = useIntl();\r\n    return (\r\n        <i\r\n            className='fa fa-angle-left'\r\n            title={formatMessage({id: 'generic_icons.back', defaultMessage: 'Back Icon'})}\r\n        />\r\n    );\r\n}\r\n\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport BlockableLink from 'components/admin_console/blockable_link';\r\nimport BackIcon from 'components/widgets/icons/fa_back_icon';\r\n\r\ntype Props = {\r\n    team?: Team;\r\n    siteName?: string;\r\n}\r\n\r\nconst BackstageNavbar = ({team, siteName}: Props) => {\r\n    const teamExists = team?.delete_at === 0;\r\n\r\n    return (\r\n        <div className='backstage-navbar'>\r\n            <BlockableLink\r\n                className='backstage-navbar__back'\r\n                to={`/${teamExists ? team?.name : ''}`}\r\n            >\r\n                <BackIcon/>\r\n                <span>\r\n                    {teamExists ? (\r\n                        <FormattedMessage\r\n                            id='backstage_navbar.backToMattermost'\r\n                            defaultMessage='Back to {siteName}'\r\n                            values={{siteName: siteName ?? team?.name}}\r\n                        />\r\n                    ) : (\r\n                        <FormattedMessage\r\n                            id='backstage_navbar.back'\r\n                            defaultMessage='Back'\r\n                        />\r\n                    )}\r\n                </span>\r\n            </BlockableLink>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default BackstageNavbar;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback} from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport type {openModal as openModalAction} from 'actions/views/modals';\r\n\r\nimport ConfirmModalRedux from 'components/confirm_modal_redux';\r\nimport WarningIcon from 'components/widgets/icons/fa_warning_icon';\r\n\r\nconst ModalId = 'delete_integration_confirm';\r\n\r\ntype Props = {\r\n    confirmButtonText?: React.ReactNode;\r\n    linkText?: React.ReactNode;\r\n    subtitleText?: React.ReactNode;\r\n    modalMessage?: React.ReactNode;\r\n    modalTitle?: React.ReactNode;\r\n    onDelete: () => void;\r\n    openModal: typeof openModalAction;\r\n};\r\n\r\nexport default function DeleteIntegrationLink(props: Props) {\r\n    const {\r\n        confirmButtonText = (\r\n            <FormattedMessage\r\n                id='integrations.delete.confirm.button'\r\n                defaultMessage='Yes, delete it'\r\n            />\r\n        ),\r\n        linkText = (\r\n            <FormattedMessage\r\n                id='installed_integrations.delete'\r\n                defaultMessage='Delete'\r\n            />\r\n        ),\r\n        modalMessage,\r\n        modalTitle = (\r\n            <FormattedMessage\r\n                id='integrations.delete.confirm.title'\r\n                defaultMessage='Delete Integration'\r\n            />\r\n        ),\r\n        onDelete,\r\n        openModal,\r\n    } = props;\r\n\r\n    const onClick = useCallback(() => {\r\n        openModal({\r\n            modalId: ModalId,\r\n            dialogProps: {\r\n                confirmButtonText,\r\n                confirmButtonClass: 'btn btn-danger',\r\n                modalClass: 'integrations-backstage-modal',\r\n                message: (\r\n                    <>\r\n                        {props.subtitleText && (\r\n                            <p>\r\n                                {props.subtitleText}\r\n                            </p>\r\n                        )}\r\n                        <div className='alert alert-danger'>\r\n                            <WarningIcon additionalClassName='mr-1'/>\r\n                            <strong>\r\n                                {props.modalMessage}\r\n                            </strong>\r\n                        </div>\r\n                    </>\r\n                ),\r\n                onConfirm: onDelete,\r\n                title: modalTitle,\r\n            },\r\n            dialogType: ConfirmModalRedux,\r\n        });\r\n    }, [confirmButtonText, modalMessage, modalTitle, onDelete, openModal]);\r\n\r\n    return (\r\n        <button\r\n            className='color--link style--none'\r\n            onClick={onClick}\r\n        >\r\n            {linkText}\r\n        </button>\r\n    );\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\n\r\nimport {openModal} from 'actions/views/modals';\r\n\r\nimport DeleteIntegrationLink from './delete_integration_link';\r\n\r\nconst mapDispatchToProps = {\r\n    openModal,\r\n};\r\n\r\nexport default connect(null, mapDispatchToProps)(DeleteIntegrationLink);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport DeleteIntegrationLink from 'components/integrations/delete_integration_link';\r\n\r\ntype Props = {\r\n    onDelete: () => void;\r\n}\r\n\r\nexport default function DeleteEmojiButton(props: Props) {\r\n    return (\r\n        <DeleteIntegrationLink\r\n            confirmButtonText={\r\n                <FormattedMessage\r\n                    id='emoji_list.delete.confirm.button'\r\n                    defaultMessage='Delete'\r\n                />\r\n            }\r\n            linkText={\r\n                <FormattedMessage\r\n                    id='emoji_list.delete'\r\n                    defaultMessage='Delete'\r\n                />\r\n            }\r\n            modalMessage={\r\n                <FormattedMessage\r\n                    id='emoji_list.delete.confirm.msg'\r\n                    defaultMessage='This action permanently deletes the custom emoji. Are you sure you want to delete it?'\r\n                />\r\n            }\r\n            modalTitle={\r\n                <FormattedMessage\r\n                    id='emoji_list.delete.confirm.title'\r\n                    defaultMessage='Delete Custom Emoji'\r\n                />\r\n            }\r\n            onDelete={props.onDelete}\r\n        />\r\n    );\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback, useMemo} from 'react';\r\n\r\nimport type {CustomEmoji} from '@mattermost/types/emojis';\r\n\r\nimport {Client4} from 'mattermost-redux/client';\r\nimport Permissions from 'mattermost-redux/constants/permissions';\r\n\r\nimport AnyTeamPermissionGate from 'components/permissions_gates/any_team_permission_gate';\r\n\r\nimport DeleteEmojiButton from './delete_emoji_button';\r\n\r\nexport type Props = {\r\n    emoji?: CustomEmoji;\r\n    emojiId?: string;\r\n    currentUserId?: string;\r\n    creatorDisplayName?: string;\r\n    creatorUsername?: string;\r\n    onDelete?: (emojiId: string) => void;\r\n    actions: {\r\n        deleteCustomEmoji: (emojiId: string) => void;\r\n    };\r\n};\r\n\r\nconst DELETE_PERMISSION = [Permissions.DELETE_EMOJIS];\r\nconst DELETE_OTHER_PERMISSION = [Permissions.DELETE_OTHERS_EMOJIS];\r\n\r\nconst EmojiListItem = ({\r\n    actions: {\r\n        deleteCustomEmoji,\r\n    },\r\n    onDelete,\r\n    emoji = {} as CustomEmoji,\r\n    creatorUsername,\r\n    currentUserId = '',\r\n    creatorDisplayName = '',\r\n}: Props) => {\r\n    const emoticonStyle = useMemo(() => {\r\n        return {backgroundImage: `url(${Client4.getCustomEmojiImageUrl(emoji.id)})`};\r\n    }, [emoji.id]);\r\n\r\n    const handleDelete = useCallback((): void => {\r\n        if (!emoji) {\r\n            return;\r\n        }\r\n        if (onDelete) {\r\n            onDelete(emoji.id);\r\n        }\r\n        deleteCustomEmoji(emoji.id);\r\n    }, [deleteCustomEmoji, emoji, onDelete]);\r\n\r\n    let displayName = creatorDisplayName;\r\n    if (creatorUsername && creatorUsername !== displayName) {\r\n        displayName += ' (@' + creatorUsername + ')';\r\n    }\r\n\r\n    let deleteButton = <DeleteEmojiButton onDelete={handleDelete}/>;\r\n\r\n    if (emoji.creator_id === currentUserId) {\r\n        deleteButton = (\r\n            <AnyTeamPermissionGate permissions={DELETE_PERMISSION}>\r\n                {deleteButton}\r\n            </AnyTeamPermissionGate>\r\n        );\r\n    } else {\r\n        deleteButton = (\r\n            <AnyTeamPermissionGate permissions={DELETE_PERMISSION}>\r\n                <AnyTeamPermissionGate permissions={DELETE_OTHER_PERMISSION}>\r\n                    {deleteButton}\r\n                </AnyTeamPermissionGate>\r\n            </AnyTeamPermissionGate>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <tr className='backstage-list__item'>\r\n            <td className='emoji-list__name'>{':' + emoji.name + ':'}</td>\r\n            <td className='emoji-list__image'>\r\n                <span\r\n                    className='emoticon'\r\n                    style={emoticonStyle}\r\n                />\r\n            </td>\r\n            <td className='emoji-list__creator'>{displayName}</td>\r\n            <td className='emoji-list-item_actions'>{deleteButton}</td>\r\n        </tr>\r\n    );\r\n};\r\n\r\nexport default React.memo(EmojiListItem);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {deleteCustomEmoji} from 'mattermost-redux/actions/emojis';\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getUser, getCurrentUserId} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {getDisplayNameByUser} from 'utils/utils';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport EmojiListItem from './emoji_list_item';\r\nimport type {Props} from './emoji_list_item';\r\n\r\nfunction mapStateToProps(state: GlobalState, ownProps: Props) {\r\n    const emoji = state.entities.emojis.customEmoji[ownProps.emojiId!];\r\n    const creator = getUser(state, emoji.creator_id);\r\n\r\n    return {\r\n        emoji,\r\n        creatorDisplayName: getDisplayNameByUser(state, creator),\r\n        creatorUsername: creator ? creator.username : '',\r\n        currentUserId: getCurrentUserId(state),\r\n        currentTeam: getCurrentTeam(state),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            deleteCustomEmoji,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(EmojiListItem);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport type {ChangeEvent, ChangeEventHandler} from 'react';\r\nimport {defineMessage, FormattedMessage} from 'react-intl';\r\n\r\nimport type {CustomEmoji} from '@mattermost/types/emojis';\r\n\r\nimport {deleteCustomEmoji} from 'mattermost-redux/actions/emojis';\r\nimport {Emoji} from 'mattermost-redux/constants';\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport EmojiListItem from 'components/emoji/emoji_list_item';\r\nimport LoadingScreen from 'components/loading_screen';\r\nimport LocalizedPlaceholderInput from 'components/localized_placeholder_input';\r\nimport SaveButton from 'components/save_button';\r\nimport NextIcon from 'components/widgets/icons/fa_next_icon';\r\nimport PreviousIcon from 'components/widgets/icons/fa_previous_icon';\r\nimport SearchIcon from 'components/widgets/icons/fa_search_icon';\r\n\r\nconst EMOJI_PER_PAGE = 50;\r\nconst EMOJI_SEARCH_DELAY_MILLISECONDS = 200;\r\n\r\nexport interface Props {\r\n\r\n    /**\r\n     * Custom emojis on the system.\r\n     */\r\n    emojiIds: string[];\r\n\r\n    /**\r\n     * Function to scroll list to top.\r\n     */\r\n    scrollToTop: () => void;\r\n    actions: {\r\n\r\n        /**\r\n         * Get pages of custom emojis.\r\n         */\r\n        getCustomEmojis: (page?: number, perPage?: number, sort?: string, loadUsers?: boolean) => Promise<ActionResult<CustomEmoji[]>>;\r\n\r\n        /**\r\n         * Search custom emojis.\r\n         */\r\n        searchCustomEmojis: (term: string, options: any, loadUsers: boolean) => Promise<ActionResult<CustomEmoji[]>>;\r\n    };\r\n\r\n}\r\n\r\ninterface State {\r\n    loading: boolean;\r\n    page: number;\r\n    nextLoading: boolean;\r\n    searchEmojis: string[] | null;\r\n    missingPages: boolean;\r\n}\r\n\r\nexport default class EmojiList extends React.PureComponent<Props, State> {\r\n    private searchTimeout: NodeJS.Timeout | null;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n        this.searchTimeout = null;\r\n        this.state = {\r\n            loading: true,\r\n            page: 0,\r\n            nextLoading: false,\r\n            searchEmojis: null,\r\n            missingPages: true,\r\n        };\r\n    }\r\n\r\n    async componentDidMount(): Promise<void> {\r\n        this.props.actions.getCustomEmojis(0, EMOJI_PER_PAGE + 1, Emoji.SORT_BY_NAME, true).\r\n            then(({data}: ActionResult<CustomEmoji[]>) => {\r\n                this.setState({loading: false});\r\n                if (data && data.length < EMOJI_PER_PAGE) {\r\n                    this.setState({missingPages: false});\r\n                }\r\n            });\r\n    }\r\n\r\n    nextPage = (e: React.MouseEvent<HTMLButtonElement, MouseEvent>): void => {\r\n        if (e) {\r\n            e.preventDefault();\r\n        }\r\n\r\n        const next = this.state.page + 1;\r\n        this.setState({nextLoading: true});\r\n        this.props.actions.getCustomEmojis(next, EMOJI_PER_PAGE, Emoji.SORT_BY_NAME, true).\r\n            then(({data}: ActionResult<CustomEmoji[]>) => {\r\n                this.setState({page: next, nextLoading: false});\r\n                if (data && data.length < EMOJI_PER_PAGE) {\r\n                    this.setState({missingPages: false});\r\n                }\r\n\r\n                this.props.scrollToTop();\r\n            });\r\n    };\r\n    previousPage = (e: React.MouseEvent<HTMLButtonElement, MouseEvent>): void => {\r\n        if (e) {\r\n            e.preventDefault();\r\n        }\r\n\r\n        this.setState({\r\n            page: this.state.page - 1,\r\n            nextLoading: false,\r\n            missingPages: true,\r\n        });\r\n\r\n        this.props.scrollToTop();\r\n    };\r\n\r\n    onSearchChange: ChangeEventHandler = (e: ChangeEvent): void => {\r\n        if (!e || !e.target) {\r\n            return;\r\n        }\r\n\r\n        const term = (e.target as HTMLInputElement).value || '';\r\n\r\n        clearTimeout(this.searchTimeout!);\r\n\r\n        this.searchTimeout = setTimeout(async () => {\r\n            if (term.trim() === '') {\r\n                this.setState({searchEmojis: null, page: 0});\r\n                return;\r\n            }\r\n\r\n            this.setState({loading: true});\r\n\r\n            const {data} = await this.props.actions.searchCustomEmojis(\r\n                term,\r\n                {},\r\n                true,\r\n            );\r\n\r\n            if (data) {\r\n                this.setState({\r\n                    searchEmojis: data.map((em: CustomEmoji) => em.id),\r\n                    loading: false,\r\n                });\r\n            } else {\r\n                this.setState({searchEmojis: [], loading: false});\r\n            }\r\n        }, EMOJI_SEARCH_DELAY_MILLISECONDS);\r\n    };\r\n\r\n    deleteFromSearch = (emojiId: string): void => {\r\n        if (!this.state.searchEmojis) {\r\n            return;\r\n        }\r\n\r\n        const index = this.state.searchEmojis.indexOf(emojiId);\r\n\r\n        if (index < 0) {\r\n            return;\r\n        }\r\n\r\n        const newSearchEmojis = [...this.state.searchEmojis];\r\n        newSearchEmojis.splice(index, 1);\r\n        this.setState({searchEmojis: newSearchEmojis});\r\n    };\r\n\r\n    render(): JSX.Element {\r\n        const searchEmojis = this.state.searchEmojis;\r\n        const emojis = [];\r\n        let nextButton;\r\n        let previousButton;\r\n\r\n        if (this.state.loading) {\r\n            emojis.push(\r\n                <tr\r\n                    key='loading'\r\n                    className='backstage-list__item backstage-list__empty'\r\n                >\r\n                    <td colSpan={4}>\r\n                        <LoadingScreen key='loading'/>\r\n                    </td>\r\n                </tr>,\r\n            );\r\n        } else if (\r\n            this.props.emojiIds.length === 0 ||\r\n            (searchEmojis && searchEmojis.length === 0)\r\n        ) {\r\n            emojis.push(\r\n                <tr\r\n                    key='empty'\r\n                    className='backstage-list__item backstage-list__empty'\r\n                >\r\n                    <td colSpan={4}>\r\n                        <FormattedMessage\r\n                            id='emoji_list.empty'\r\n                            defaultMessage='No custom emoji found'\r\n                        />\r\n                    </td>\r\n                </tr>,\r\n            );\r\n        } else if (searchEmojis) {\r\n            searchEmojis.forEach((emojiId: string) => {\r\n                emojis.push(\r\n                    <EmojiListItem\r\n                        key={'emoji_search_item' + emojiId}\r\n                        emojiId={emojiId}\r\n                        onDelete={this.deleteFromSearch}\r\n                        actions={{deleteCustomEmoji}}\r\n                    />,\r\n                );\r\n            });\r\n        } else {\r\n            const pageStart = this.state.page * EMOJI_PER_PAGE;\r\n            const pageEnd = pageStart + EMOJI_PER_PAGE;\r\n            const emojisToDisplay = this.props.emojiIds.slice(pageStart, pageEnd);\r\n\r\n            emojisToDisplay.forEach((emojiId: string) => {\r\n                emojis.push(\r\n                    <EmojiListItem\r\n                        key={'emoji_list_item' + emojiId}\r\n                        emojiId={emojiId}\r\n                        actions={{deleteCustomEmoji}}\r\n                    />,\r\n                );\r\n            });\r\n\r\n            if (this.state.missingPages) {\r\n                const buttonContents = (\r\n                    <span>\r\n                        <FormattedMessage\r\n                            id='filtered_user_list.next'\r\n                            defaultMessage='Next'\r\n                        />\r\n                        <NextIcon additionalClassName='ml-2'/>\r\n                    </span>\r\n                );\r\n\r\n                nextButton = (\r\n                    <SaveButton\r\n                        btnClass='btn-tertiary'\r\n                        extraClasses='pull-right'\r\n                        onClick={this.nextPage}\r\n                        saving={this.state.nextLoading}\r\n                        disabled={this.state.nextLoading}\r\n                        defaultMessage={buttonContents}\r\n                        savingMessage={buttonContents}\r\n                    />\r\n                );\r\n            }\r\n\r\n            if (this.state.page > 0) {\r\n                previousButton = (\r\n                    <button\r\n                        className='btn btn-tertiary'\r\n                        onClick={this.previousPage}\r\n                    >\r\n                        <PreviousIcon additionalClassName='mr-2'/>\r\n                        <FormattedMessage\r\n                            id='filtered_user_list.prev'\r\n                            defaultMessage='Previous'\r\n                        />\r\n                    </button>\r\n                );\r\n            }\r\n        }\r\n\r\n        return (\r\n            <div>\r\n                <div className='backstage-filters'>\r\n                    <div className='backstage-filter__search'>\r\n                        <SearchIcon/>\r\n                        <LocalizedPlaceholderInput\r\n                            type='search'\r\n                            className='form-control'\r\n                            placeholder={defineMessage({id: 'emoji_list.search', defaultMessage: 'Search Custom Emoji'})}\r\n                            onChange={this.onSearchChange}\r\n                            style={style.search}\r\n                        />\r\n                    </div>\r\n                </div>\r\n                <span className='backstage-list__help'>\r\n                    <p>\r\n                        <FormattedMessage\r\n                            id='emoji_list.help'\r\n                            defaultMessage=\"Custom emoji are available to everyone on your server. Type ':' followed by two characters in a message box to bring up the emoji selection menu.\"\r\n                        />\r\n                    </p>\r\n                    <p>\r\n                        <FormattedMessage\r\n                            id='emoji_list.help2'\r\n                            defaultMessage=\"Tip: If you add #, ##, or ### as the first character on a new line containing emoji, you can use larger sized emoji. To try it out, send a message such as: '# :smile:'.\"\r\n                        />\r\n                    </p>\r\n                </span>\r\n                <div className='backstage-list'>\r\n                    <table className='emoji-list__table'>\r\n                        <thead>\r\n                            <tr className='backstage-list__item emoji-list__table-header'>\r\n                                <th className='emoji-list__name'>\r\n                                    <FormattedMessage\r\n                                        id='emoji_list.name'\r\n                                        defaultMessage='Name'\r\n                                    />\r\n                                </th>\r\n                                <th className='emoji-list__image'>\r\n                                    <FormattedMessage\r\n                                        id='emoji_list.image'\r\n                                        defaultMessage='Image'\r\n                                    />\r\n                                </th>\r\n                                <th className='emoji-list__creator'>\r\n                                    <FormattedMessage\r\n                                        id='emoji_list.creator'\r\n                                        defaultMessage='Creator'\r\n                                    />\r\n                                </th>\r\n                                <th className='emoji-list_actions'>\r\n                                    <FormattedMessage\r\n                                        id='emoji_list.actions'\r\n                                        defaultMessage='Actions'\r\n                                    />\r\n                                </th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>{emojis}</tbody>\r\n                    </table>\r\n                </div>\r\n                <div className='filter-controls pt-3'>\r\n                    {previousButton}\r\n                    {nextButton}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nconst style = {\r\n    search: {flexGrow: 0, flexShrink: 0},\r\n};\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {getCustomEmojis, searchCustomEmojis} from 'mattermost-redux/actions/emojis';\r\nimport {getCustomEmojiIdsSortedByName} from 'mattermost-redux/selectors/entities/emojis';\r\n\r\nimport EmojiList from './emoji_list';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    return {\r\n        emojiIds: getCustomEmojiIdsSortedByName(state) || [],\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            getCustomEmojis,\r\n            searchCustomEmojis,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(EmojiList);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useEffect} from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport Permissions from 'mattermost-redux/constants/permissions';\r\nimport type {Theme} from 'mattermost-redux/selectors/entities/preferences';\r\n\r\nimport AnyTeamPermissionGate from 'components/permissions_gates/any_team_permission_gate';\r\n\r\nimport * as Utils from 'utils/utils';\r\n\r\nimport EmojiList from './emoji_list';\r\n\r\ntype Props = {\r\n    teamName?: string;\r\n    teamDisplayName?: string;\r\n    siteName?: string;\r\n    scrollToTop(): void;\r\n    currentTheme: Theme;\r\n    actions: {\r\n        loadRolesIfNeeded(roles: Iterable<string>): void;\r\n    };\r\n}\r\n\r\nconst CREATE_EMOJIS_PERMISSIONS = [Permissions.CREATE_EMOJIS];\r\nconst ROLES = ['system_admin', 'team_admin', 'system_user', 'team_user'];\r\n\r\nexport default function EmojiPage({\r\n    teamDisplayName = '',\r\n    teamName = '',\r\n    siteName = '',\r\n    scrollToTop,\r\n    currentTheme,\r\n    actions,\r\n}: Props) {\r\n    const intl = useIntl();\r\n\r\n    useEffect(() => {\r\n        updateTitle();\r\n        actions.loadRolesIfNeeded(ROLES);\r\n        Utils.resetTheme();\r\n\r\n        return () => {\r\n            Utils.applyTheme(currentTheme);\r\n        };\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        updateTitle();\r\n    }, [siteName]);\r\n\r\n    const updateTitle = () => {\r\n        document.title = intl.formatMessage({id: 'custom_emoji.header', defaultMessage: 'Custom Emoji'}) + ' - ' + teamDisplayName + ' ' + siteName;\r\n    };\r\n\r\n    return (\r\n        <div className='backstage-content emoji-list'>\r\n            <div className='backstage-header'>\r\n                <h1>\r\n                    <FormattedMessage\r\n                        id='emoji_list.header'\r\n                        defaultMessage='Custom Emoji'\r\n                    />\r\n                </h1>\r\n                <AnyTeamPermissionGate permissions={CREATE_EMOJIS_PERMISSIONS}>\r\n                    <Link\r\n                        className='add-link'\r\n                        to={'/' + teamName + '/emoji/add'}\r\n                    >\r\n                        <button\r\n                            type='button'\r\n                            className='btn btn-primary'\r\n                        >\r\n                            <FormattedMessage\r\n                                id='emoji_list.add'\r\n                                defaultMessage='Add Custom Emoji'\r\n                            />\r\n                        </button>\r\n                    </Link>\r\n                </AnyTeamPermissionGate>\r\n            </div>\r\n            <EmojiList scrollToTop={scrollToTop}/>\r\n        </div>\r\n    );\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {loadRolesIfNeeded} from 'mattermost-redux/actions/roles';\r\nimport {getTheme} from 'mattermost-redux/selectors/entities/preferences';\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport EmojiPage from 'components/emoji/emoji_page';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const team = getCurrentTeam(state);\r\n\r\n    return {\r\n        teamName: team?.name,\r\n        teamDisplayName: team?.display_name,\r\n        siteName: state.entities.general.config.SiteName,\r\n        currentTheme: getTheme(state),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            loadRolesIfNeeded,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(EmojiPage);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport type {ReactNode} from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\ntype Props = {\r\n    children?: ReactNode;\r\n}\r\n\r\nconst BackstageHeader = ({children}: Props) => {\r\n    const {formatMessage} = useIntl();\r\n    const childrenElements: ReactNode[] = [];\r\n\r\n    React.Children.forEach(children, (child, index) => {\r\n        if (index !== 0) {\r\n            childrenElements.push(\r\n                <span\r\n                    key={'divider' + index}\r\n                    className='backstage-header__divider'\r\n                >\r\n                    <i\r\n                        className='fa fa-angle-right'\r\n                        title={formatMessage({id: 'generic_icons.breadcrumb', defaultMessage: 'Breadcrumb Icon'})}\r\n                    />\r\n                </span>,\r\n            );\r\n        }\r\n\r\n        childrenElements.push(child);\r\n    });\r\n\r\n    return (\r\n        <div className='backstage-header'>\r\n            <h1>\r\n                {childrenElements}\r\n            </h1>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default BackstageHeader;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport type {ChangeEvent, FormEvent, SyntheticEvent} from 'react';\r\nimport {defineMessage, FormattedMessage} from 'react-intl';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport type {CustomEmoji} from '@mattermost/types/emojis';\r\nimport type {Team} from '@mattermost/types/teams';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport BackstageHeader from 'components/backstage/components/backstage_header';\r\nimport FormError from 'components/form_error';\r\nimport SpinnerButton from 'components/spinner_button';\r\n\r\nimport {getHistory} from 'utils/browser_history';\r\nimport {Constants} from 'utils/constants';\r\nimport type EmojiMap from 'utils/emoji_map';\r\n\r\nexport interface AddEmojiProps {\r\n    actions: {\r\n        createCustomEmoji: (term: CustomEmoji, imageData: File) => Promise<ActionResult>;\r\n    };\r\n    emojiMap: EmojiMap;\r\n    user: UserProfile;\r\n    team: Team;\r\n}\r\n\r\ntype EmojiCreateArgs = {\r\n    creator_id: string;\r\n    name: string;\r\n};\r\n\r\ntype AddEmojiState = {\r\n    name: string;\r\n    image: File | null;\r\n    imageUrl: string | ArrayBuffer | null;\r\n    saving: boolean;\r\n    error: React.ReactNode;\r\n};\r\n\r\ninterface AddErrorResponse {\r\n    error: Error;\r\n}\r\n\r\ninterface AddEmojiResponse {\r\n    data: CustomEmoji;\r\n}\r\n\r\nexport default class AddEmoji extends React.PureComponent<AddEmojiProps, AddEmojiState> {\r\n    constructor(props: AddEmojiProps) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            name: '',\r\n            image: null,\r\n            imageUrl: '',\r\n            saving: false,\r\n            error: null,\r\n        };\r\n    }\r\n\r\n    handleFormSubmit = async (e: FormEvent<HTMLFormElement>): Promise<void> => {\r\n        return this.handleSubmit(e);\r\n    };\r\n\r\n    handleSaveButtonClick = async (e: React.MouseEvent<HTMLButtonElement, MouseEvent>): Promise<void> => {\r\n        return this.handleSubmit(e);\r\n    };\r\n\r\n    handleSubmit = async (e: SyntheticEvent<unknown>): Promise<void> => {\r\n        const {actions, emojiMap, user, team} = this.props;\r\n        const {image, name, saving} = this.state;\r\n\r\n        e.preventDefault();\r\n\r\n        if (saving) {\r\n            return;\r\n        }\r\n\r\n        this.setState({\r\n            saving: true,\r\n            error: null,\r\n        });\r\n\r\n        const emoji: EmojiCreateArgs = {\r\n            creator_id: user.id,\r\n            name: name.trim().toLowerCase(),\r\n        };\r\n\r\n        // trim surrounding colons if the user accidentally included them in the name\r\n        if (emoji.name.startsWith(':') && emoji.name.endsWith(':')) {\r\n            emoji.name = emoji.name.substring(1, emoji.name.length - 1);\r\n        }\r\n\r\n        if (!emoji.name) {\r\n            this.setState({\r\n                saving: false,\r\n                error: (\r\n                    <FormattedMessage\r\n                        id='add_emoji.nameRequired'\r\n                        defaultMessage='A name is required for the emoji'\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        if ((/[^a-z0-9+_-]/).test(emoji.name)) {\r\n            this.setState({\r\n                saving: false,\r\n                error: (\r\n                    <FormattedMessage\r\n                        id='add_emoji.nameInvalid'\r\n                        defaultMessage=\"An emoji's name can only contain lowercase letters, numbers, and the symbols '-', '+' and '_'.\"\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        if (emojiMap.hasSystemEmoji(emoji.name)) {\r\n            this.setState({\r\n                saving: false,\r\n                error: (\r\n                    <FormattedMessage\r\n                        id='add_emoji.nameTaken'\r\n                        defaultMessage='This name is already in use by a system emoji. Please choose another name.'\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        if (emojiMap.has(emoji.name)) {\r\n            this.setState({\r\n                saving: false,\r\n                error: (\r\n                    <FormattedMessage\r\n                        id='add_emoji.customNameTaken'\r\n                        defaultMessage='This name is already in use by a custom emoji. Please choose another name.'\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        if (!image) {\r\n            this.setState({\r\n                saving: false,\r\n                error: (\r\n                    <FormattedMessage\r\n                        id='add_emoji.imageRequired'\r\n                        defaultMessage='An image is required for the emoji'\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        const maxFileSizeBytes = 1024 * 1024;\r\n        if (image.size > maxFileSizeBytes) {\r\n            this.setState({\r\n                saving: false,\r\n                error: (\r\n                    <FormattedMessage\r\n                        id='add_emoji.imageTooLarge'\r\n                        defaultMessage='Unable to create emoji. Image must be less than 1 MB in size.'\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        const response = await actions.createCustomEmoji(emoji as CustomEmoji, image);\r\n\r\n        if ('data' in response) {\r\n            const savedEmoji = response as AddEmojiResponse;\r\n            if (savedEmoji && savedEmoji.data.name === emoji.name) {\r\n                getHistory().push('/' + team.name + '/emoji');\r\n                return;\r\n            }\r\n        }\r\n\r\n        if ('error' in response) {\r\n            const responseError = response as AddErrorResponse;\r\n            if (responseError) {\r\n                this.setState({\r\n                    saving: false,\r\n                    error: responseError.error.message,\r\n                });\r\n\r\n                return;\r\n            }\r\n        }\r\n\r\n        const genericError = (\r\n            <FormattedMessage\r\n                id='add_emoji.failedToAdd'\r\n                defaultMessage='Something went wrong when adding the custom emoji.'\r\n            />\r\n        );\r\n\r\n        this.setState({\r\n            saving: false,\r\n            error: (genericError),\r\n        });\r\n    };\r\n\r\n    updateName = (e: ChangeEvent<HTMLInputElement>): void => {\r\n        this.setState({\r\n            name: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateImage = (e: ChangeEvent<HTMLInputElement>): void => {\r\n        if (e.target.files == null || e.target.files.length === 0) {\r\n            this.setState({\r\n                image: null,\r\n                imageUrl: '',\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        const image = e.target.files![0];\r\n\r\n        const reader = new FileReader();\r\n        reader.onload = () => {\r\n            this.setState({\r\n                image,\r\n                imageUrl: reader.result,\r\n            });\r\n        };\r\n        reader.readAsDataURL(image);\r\n    };\r\n\r\n    render(): JSX.Element {\r\n        let filename = null;\r\n        if (this.state.image) {\r\n            filename = (\r\n                <span className='add-emoji__filename'>\r\n                    {this.state.image.name}\r\n                </span>\r\n            );\r\n        }\r\n\r\n        let preview = null;\r\n        if (this.state.imageUrl) {\r\n            preview = (\r\n                <div className='form-group'>\r\n                    <label\r\n                        className='control-label col-sm-4'\r\n                        htmlFor='preview'\r\n                    >\r\n                        <FormattedMessage\r\n                            id='add_emoji.preview'\r\n                            defaultMessage='Preview'\r\n                        />\r\n                    </label>\r\n                    <div className='col-md-5 col-sm-8 add-emoji__preview'>\r\n                        <FormattedMessage\r\n                            id='add_emoji.preview.sentence'\r\n                            defaultMessage='This is a sentence with {image} in it.'\r\n                            values={{\r\n                                image: (\r\n                                    <span\r\n                                        className='emoticon'\r\n                                        style={{backgroundImage: 'url(' + this.state.imageUrl + ')'}}\r\n                                    />\r\n                                ),\r\n                            }}\r\n                        />\r\n                    </div>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div className='backstage-content row'>\r\n                <BackstageHeader>\r\n                    <Link to={'/' + this.props.team.name + '/emoji'}>\r\n                        <FormattedMessage\r\n                            id='emoji_list.header'\r\n                            defaultMessage='Custom Emoji'\r\n                        />\r\n                    </Link>\r\n                    <FormattedMessage\r\n                        id='add_emoji.header'\r\n                        defaultMessage='Add'\r\n                    />\r\n                </BackstageHeader>\r\n                <div className='backstage-form'>\r\n                    <form\r\n                        className='form-horizontal'\r\n                        onSubmit={this.handleFormSubmit}\r\n                    >\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='name'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_emoji.name'\r\n                                    defaultMessage='Name'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <input\r\n                                    id='name'\r\n                                    type='text'\r\n                                    maxLength={64}\r\n                                    className='form-control'\r\n                                    value={this.state.name}\r\n                                    onChange={this.updateName}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_emoji.name.help'\r\n                                        defaultMessage=\"Name your emoji. The name can be up to 64 characters, and can contain lowercase letters, numbers, and the symbols '-' and '_'.\"\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='image'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_emoji.image'\r\n                                    defaultMessage='Image'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <div>\r\n                                    <div className='add-emoji__upload'>\r\n                                        <button className='btn btn-primary'>\r\n                                            <FormattedMessage\r\n                                                id='add_emoji.image.button'\r\n                                                defaultMessage='Select'\r\n                                            />\r\n                                        </button>\r\n                                        <input\r\n                                            id='select-emoji'\r\n                                            type='file'\r\n                                            accept={Constants.ACCEPT_EMOJI_IMAGE}\r\n                                            multiple={false}\r\n                                            onChange={this.updateImage}\r\n                                        />\r\n                                    </div>\r\n                                    {filename}\r\n                                    <div className='form__help'>\r\n                                        <FormattedMessage\r\n                                            id='add_emoji.image.help'\r\n                                            defaultMessage='Specify a .gif, .png, or .jpg file of up to 64 KB for your emoji. The dimensions can be up to 128 pixels by 128 pixels.'\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        {preview}\r\n                        <div className='backstage-form__footer'>\r\n                            <FormError\r\n                                type='backstage'\r\n                                error={this.state.error}\r\n                            />\r\n                            <Link\r\n                                className='btn btn-tertiary'\r\n                                to={'/' + this.props.team.name + '/emoji'}\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_emoji.cancel'\r\n                                    defaultMessage='Cancel'\r\n                                />\r\n                            </Link>\r\n                            <SpinnerButton\r\n                                data-testid='save-button'\r\n                                className='btn btn-primary'\r\n                                type='submit'\r\n                                spinning={this.state.saving}\r\n                                spinningText={defineMessage({id: 'add_emoji.saving', defaultMessage: 'Saving...'})}\r\n                                onClick={this.handleSaveButtonClick}\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_emoji.save'\r\n                                    defaultMessage='Save'\r\n                                />\r\n                            </SpinnerButton>\r\n                        </div>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {createCustomEmoji} from 'mattermost-redux/actions/emojis';\r\n\r\nimport {getEmojiMap} from 'selectors/emojis';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport AddEmoji from './add_emoji';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    return {\r\n        emojiMap: getEmojiMap(state),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            createCustomEmoji,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(AddEmoji);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {Link} from 'react-router-dom';\r\n\r\ntype Props = {\r\n    image: string;\r\n    title: JSX.Element;\r\n    description: JSX.Element;\r\n    link: string;\r\n}\r\n\r\nconst IntegrationOption = ({image, title, description, link}: Props) => {\r\n    return (\r\n        <Link\r\n            to={link}\r\n            className='integration-option'\r\n        >\r\n            <img\r\n                alt={'integration image'}\r\n                className='integration-option__image'\r\n                src={image}\r\n            />\r\n            <div className='integration-option__title'>\r\n                {title}\r\n            </div>\r\n            <div className='integration-option__description'>\r\n                {description}\r\n            </div>\r\n        </Link>\r\n    );\r\n};\r\n\r\nexport default React.memo(IntegrationOption);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport {Permissions} from 'mattermost-redux/constants';\r\n\r\nimport ExternalLink from 'components/external_link';\r\nimport SystemPermissionGate from 'components/permissions_gates/system_permission_gate';\r\nimport TeamPermissionGate from 'components/permissions_gates/team_permission_gate';\r\n\r\nimport BotAccountsIcon from 'images/bot_default_icon.png';\r\nimport IncomingWebhookIcon from 'images/incoming_webhook.jpg';\r\nimport OAuthIcon from 'images/oauth_icon.png';\r\nimport OutgoingOAuthConnectionsIcon from 'images/outgoing_oauth_connection.png';\r\nimport OutgoingWebhookIcon from 'images/outgoing_webhook.jpg';\r\nimport SlashCommandIcon from 'images/slash_command_icon.jpg';\r\nimport * as Utils from 'utils/utils';\r\n\r\nimport IntegrationOption from './integration_option';\r\n\r\ntype Props = {\r\n    siteName: string | undefined;\r\n    enableIncomingWebhooks: boolean;\r\n    enableOutgoingWebhooks: boolean;\r\n    enableCommands: boolean;\r\n    enableOAuthServiceProvider: boolean;\r\n    enableOutgoingOAuthConnections: boolean;\r\n    team: Team;\r\n}\r\n\r\nexport default class Integrations extends React.PureComponent <Props> {\r\n    componentDidMount() {\r\n        this.updateTitle();\r\n    }\r\n\r\n    updateTitle = () => {\r\n        const currentSiteName = this.props.siteName || '';\r\n        document.title = Utils.localizeMessage({id: 'admin.sidebar.integrations', defaultMessage: 'Integrations'}) + ' - ' + this.props.team.display_name + ' ' + currentSiteName;\r\n    };\r\n\r\n    render() {\r\n        const options = [];\r\n\r\n        if (this.props.enableIncomingWebhooks) {\r\n            options.push(\r\n                <TeamPermissionGate\r\n                    teamId={this.props.team.id}\r\n                    permissions={[Permissions.MANAGE_INCOMING_WEBHOOKS, Permissions.MANAGE_OWN_INCOMING_WEBHOOKS]}\r\n                    key='incomingWebhookPermission'\r\n                >\r\n                    <IntegrationOption\r\n                        key='incomingWebhook'\r\n                        image={IncomingWebhookIcon}\r\n                        title={\r\n                            <FormattedMessage\r\n                                id='integrations.incomingWebhook.title'\r\n                                defaultMessage='Incoming Webhooks'\r\n                            />\r\n                        }\r\n                        description={\r\n                            <FormattedMessage\r\n                                id='integrations.incomingWebhook.description'\r\n                                defaultMessage='Incoming webhooks allow external integrations to send messages'\r\n                            />\r\n                        }\r\n                        link={'/' + this.props.team.name + '/integrations/incoming_webhooks'}\r\n                    />\r\n                </TeamPermissionGate>,\r\n            );\r\n        }\r\n\r\n        if (this.props.enableOutgoingWebhooks) {\r\n            options.push(\r\n                <TeamPermissionGate\r\n                    teamId={this.props.team.id}\r\n                    permissions={[Permissions.MANAGE_OUTGOING_WEBHOOKS, Permissions.MANAGE_OWN_OUTGOING_WEBHOOKS]}\r\n                    key='outgoingWebhookPermission'\r\n                >\r\n                    <IntegrationOption\r\n                        key='outgoingWebhook'\r\n                        image={OutgoingWebhookIcon}\r\n                        title={\r\n                            <FormattedMessage\r\n                                id='integrations.outgoingWebhook.title'\r\n                                defaultMessage='Outgoing Webhooks'\r\n                            />\r\n                        }\r\n                        description={\r\n                            <FormattedMessage\r\n                                id='integrations.outgoingWebhook.description'\r\n                                defaultMessage='Outgoing webhooks allow external integrations to receive and respond to messages'\r\n                            />\r\n                        }\r\n                        link={'/' + this.props.team.name + '/integrations/outgoing_webhooks'}\r\n                    />\r\n                </TeamPermissionGate>,\r\n            );\r\n        }\r\n\r\n        if (this.props.enableCommands) {\r\n            options.push(\r\n                <TeamPermissionGate\r\n                    teamId={this.props.team.id}\r\n                    permissions={[Permissions.MANAGE_SLASH_COMMANDS, Permissions.MANAGE_OWN_SLASH_COMMANDS]}\r\n                    key='commandPermission'\r\n                >\r\n                    <IntegrationOption\r\n                        key='command'\r\n                        image={SlashCommandIcon}\r\n                        title={\r\n                            <FormattedMessage\r\n                                id='integrations.command.title'\r\n                                defaultMessage='Slash Commands'\r\n                            />\r\n                        }\r\n                        description={\r\n                            <FormattedMessage\r\n                                id='integrations.command.description'\r\n                                defaultMessage='Slash commands send events to an external integration'\r\n                            />\r\n                        }\r\n                        link={'/' + this.props.team.name + '/integrations/commands'}\r\n                    />\r\n                </TeamPermissionGate>,\r\n            );\r\n        }\r\n\r\n        if (this.props.enableOAuthServiceProvider) {\r\n            options.push(\r\n                <SystemPermissionGate\r\n                    permissions={[Permissions.MANAGE_OAUTH]}\r\n                    key='oauth2AppsPermission'\r\n                >\r\n                    <IntegrationOption\r\n                        key='oauth2Apps'\r\n                        image={OAuthIcon}\r\n                        title={\r\n                            <FormattedMessage\r\n                                id='integrations.oauthApps.title'\r\n                                defaultMessage='OAuth 2.0 Applications'\r\n                            />\r\n                        }\r\n                        description={\r\n                            <FormattedMessage\r\n                                id='integrations.oauthApps.description'\r\n                                defaultMessage='Auth 2.0 allows external applications to make authorized requests to the Mattermost API'\r\n                            />\r\n                        }\r\n                        link={'/' + this.props.team.name + '/integrations/oauth2-apps'}\r\n                    />\r\n                </SystemPermissionGate>,\r\n            );\r\n        }\r\n\r\n        if (this.props.enableOutgoingOAuthConnections) {\r\n            options.push(\r\n                <TeamPermissionGate\r\n                    teamId={this.props.team.id}\r\n                    permissions={[Permissions.MANAGE_OUTGOING_OAUTH_CONNECTIONS]}\r\n                    key='outgoingOAuthConnectionsPermission'\r\n                >\r\n                    <IntegrationOption\r\n                        key='outgoingOAuthConnections'\r\n                        image={OutgoingOAuthConnectionsIcon}\r\n                        title={\r\n                            <FormattedMessage\r\n                                id='integrations.outgoingOAuthConnections.title'\r\n                                defaultMessage='Outgoing OAuth Connections'\r\n                            />\r\n                        }\r\n                        description={\r\n                            <FormattedMessage\r\n                                id='integrations.outgoingOAuthConnections.description'\r\n                                defaultMessage='Outgoing OAuth Connections allow custom integrations to communicate to external systems'\r\n                            />\r\n                        }\r\n                        link={'/' + this.props.team.name + '/integrations/outgoing-oauth2-connections'}\r\n                    />\r\n                </TeamPermissionGate>,\r\n            );\r\n        }\r\n\r\n        options.push(\r\n            <SystemPermissionGate\r\n                permissions={['manage_bots']}\r\n                key='botsPermissions'\r\n            >\r\n                <IntegrationOption\r\n                    image={BotAccountsIcon}\r\n                    title={\r\n                        <FormattedMessage\r\n                            id='bots.manage.header'\r\n                            defaultMessage='Bot Accounts'\r\n                        />\r\n                    }\r\n                    description={\r\n                        <FormattedMessage\r\n                            id='bots.manage.description'\r\n                            defaultMessage='Use bot accounts to integrate with Mattermost through plugins or the API'\r\n                        />\r\n                    }\r\n                    link={'/' + this.props.team.name + '/integrations/bots'}\r\n                />\r\n            </SystemPermissionGate>,\r\n        );\r\n\r\n        return (\r\n            <div className='backstage-content row'>\r\n                <div className='backstage-header'>\r\n                    <h1>\r\n                        <FormattedMessage\r\n                            id='integrations.header'\r\n                            defaultMessage='Integrations'\r\n                        />\r\n                    </h1>\r\n                </div>\r\n                <div className='backstage-list__help'>\r\n                    <FormattedMessage\r\n                        id='integrations.help'\r\n                        defaultMessage='Visit the {appDirectory} to find self-hosted, third-party apps and integrations for Mattermost.'\r\n                        values={{\r\n                            appDirectory: (\r\n                                <ExternalLink\r\n                                    href='https://mattermost.com/marketplace'\r\n                                    location='integrations'\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='integrations.help.appDirectory'\r\n                                        defaultMessage='App Directory'\r\n                                    />\r\n                                </ExternalLink>\r\n                            ),\r\n                        }}\r\n                    />\r\n                </div>\r\n                <div className='integrations-list d-flex flex-wrap'>\r\n                    {options}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\n\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport Integrations from './integrations';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const config = getConfig(state);\r\n    const siteName = config.SiteName;\r\n    const enableIncomingWebhooks = config.EnableIncomingWebhooks === 'true';\r\n    const enableOutgoingWebhooks = config.EnableOutgoingWebhooks === 'true';\r\n    const enableCommands = config.EnableCommands === 'true';\r\n    const enableOAuthServiceProvider = config.EnableOAuthServiceProvider === 'true';\r\n    const enableOutgoingOAuthConnections = config.EnableOutgoingOAuthConnections === 'true';\r\n\r\n    return {\r\n        siteName,\r\n        enableIncomingWebhooks,\r\n        enableOutgoingWebhooks,\r\n        enableCommands,\r\n        enableOAuthServiceProvider,\r\n        enableOutgoingOAuthConnections,\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps)(Integrations);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {memo} from 'react';\r\nimport type {ChangeEventHandler} from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\n\r\nimport Constants from 'utils/constants';\r\n\r\ntype Props = {\r\n    channels: Channel[];\r\n    onChange?: ChangeEventHandler<HTMLSelectElement>;\r\n    value?: string;\r\n    selectOpen: boolean;\r\n    selectPrivate: boolean;\r\n    selectDm: boolean;\r\n};\r\n\r\nconst ChannelSelect = ({\r\n    channels,\r\n    selectOpen,\r\n    selectPrivate,\r\n    selectDm,\r\n    value,\r\n    onChange,\r\n}: Props) => {\r\n    const intl = useIntl();\r\n\r\n    const options = [\r\n        <option\r\n            key=''\r\n            value=''\r\n        >\r\n            {intl.formatMessage({\r\n                id: 'channel_select.placeholder',\r\n                defaultMessage: '--- Select a channel ---',\r\n            })}\r\n        </option>,\r\n    ];\r\n\r\n    channels.forEach((channel: Channel) => {\r\n        const channelName = channel.display_name || channel.name;\r\n        if (channel.type === Constants.OPEN_CHANNEL && selectOpen) {\r\n            options.push(\r\n                <option\r\n                    key={channel.id}\r\n                    value={channel.id}\r\n                >\r\n                    {channelName}\r\n                </option>,\r\n            );\r\n        } else if (channel.type === Constants.PRIVATE_CHANNEL && selectPrivate) {\r\n            options.push(\r\n                <option\r\n                    key={channel.id}\r\n                    value={channel.id}\r\n                >\r\n                    {channelName}\r\n                </option>,\r\n            );\r\n        } else if (channel.type === Constants.DM_CHANNEL && selectDm) {\r\n            options.push(\r\n                <option\r\n                    key={channel.id}\r\n                    value={channel.id}\r\n                >\r\n                    {channelName}\r\n                </option>,\r\n            );\r\n        }\r\n    });\r\n\r\n    return (\r\n        <select\r\n            className='form-control'\r\n            value={value}\r\n            onChange={onChange}\r\n            id='channelSelect'\r\n        >\r\n            {options}\r\n        </select>\r\n    );\r\n};\r\n\r\nexport default memo(ChannelSelect);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\n\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {createSelector} from 'mattermost-redux/selectors/create_selector';\r\nimport {getMyChannels} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getCurrentUserLocale} from 'mattermost-redux/selectors/entities/i18n';\r\nimport {sortChannelsByTypeAndDisplayName} from 'mattermost-redux/utils/channel_utils';\r\n\r\nimport ChannelSelect from './channel_select';\r\n\r\nconst getMyChannelsSorted = createSelector(\r\n    'getMyChannelsSorted',\r\n    getMyChannels,\r\n    getCurrentUserLocale,\r\n    (channels, locale) => {\r\n        const activeChannels = channels.filter((channel) => channel.delete_at === 0);\r\n        return [...activeChannels].sort(sortChannelsByTypeAndDisplayName.bind(null, locale));\r\n    },\r\n);\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    return {\r\n        channels: getMyChannelsSorted(state),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps)(ChannelSelect);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {PureComponent} from 'react';\r\nimport type {ChangeEventHandler, FormEvent, MouseEvent} from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\nimport type {MessageDescriptor} from 'react-intl';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport type {IncomingWebhook} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport BackstageHeader from 'components/backstage/components/backstage_header';\r\nimport ChannelSelect from 'components/channel_select';\r\nimport FormError from 'components/form_error';\r\nimport SpinnerButton from 'components/spinner_button';\r\n\r\ninterface State {\r\n    displayName: string;\r\n    description: string;\r\n    channelId: string;\r\n    channelLocked: boolean;\r\n    username: string;\r\n    iconURL: string;\r\n    saving: boolean;\r\n    serverError: string;\r\n    clientError: JSX.Element | null;\r\n}\r\n\r\ninterface Props {\r\n\r\n    /**\r\n    * The current team\r\n    */\r\n    team: Team;\r\n\r\n    /**\r\n    * The header text to render, has id and defaultMessage\r\n    */\r\n    header: MessageDescriptor;\r\n\r\n    /**\r\n    * The footer text to render, has id and defaultMessage\r\n    */\r\n    footer: MessageDescriptor;\r\n\r\n    /**\r\n    * The spinner loading text to render, has id and defaultMessage\r\n    */\r\n    loading: MessageDescriptor;\r\n\r\n    /**\r\n    * The server error text after a failed action\r\n    */\r\n    serverError: string;\r\n\r\n    /**\r\n    * The hook used to set the initial state\r\n    */\r\n    initialHook?: IncomingWebhook;\r\n\r\n    /**\r\n    * Whether to allow configuration of the default post username.\r\n    */\r\n    enablePostUsernameOverride: boolean;\r\n\r\n    /**\r\n    * Whether to allow configuration of the default post icon.\r\n    */\r\n    enablePostIconOverride: boolean;\r\n\r\n    /**\r\n    * Whether the user can bypass the channel lock requirement.\r\n    */\r\n    canBypassChannelLock?: boolean;\r\n\r\n    /**\r\n    * The async function to run when the action button is pressed\r\n    */\r\n    action: (hook: IncomingWebhook) => Promise<void>;\r\n}\r\n\r\nexport default class AbstractIncomingWebhook extends PureComponent<Props, State> {\r\n    constructor(props: Props | Readonly<Props>) {\r\n        super(props);\r\n\r\n        this.state = this.getStateFromHook(this.props.initialHook);\r\n    }\r\n\r\n    getStateFromHook = (hook?: IncomingWebhook) => {\r\n        return {\r\n            displayName: hook?.display_name || '',\r\n            description: hook?.description || '',\r\n            channelId: hook?.channel_id || '',\r\n            channelLocked: hook?.channel_locked || false,\r\n            username: hook?.username || '',\r\n            iconURL: hook?.icon_url || '',\r\n            saving: false,\r\n            serverError: '',\r\n            clientError: null,\r\n        };\r\n    };\r\n\r\n    handleSubmit = (e: MouseEvent<HTMLElement> | FormEvent<HTMLFormElement>) => {\r\n        e.preventDefault();\r\n\r\n        if (this.state.saving) {\r\n            return;\r\n        }\r\n\r\n        this.setState({\r\n            saving: true,\r\n            serverError: '',\r\n            clientError: null,\r\n        });\r\n\r\n        if (!this.state.channelId) {\r\n            this.setState({\r\n                saving: false,\r\n                clientError: (\r\n                    <FormattedMessage\r\n                        id='add_incoming_webhook.channelRequired'\r\n                        defaultMessage='A valid channel is required'\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        const hook = {\r\n            channel_id: this.state.channelId,\r\n            channel_locked: this.state.channelLocked,\r\n            display_name: this.state.displayName,\r\n            description: this.state.description,\r\n            username: this.state.username,\r\n            icon_url: this.state.iconURL,\r\n            id: this.props.initialHook?.id || '',\r\n            create_at: this.props.initialHook?.create_at || 0,\r\n            update_at: this.props.initialHook?.update_at || 0,\r\n            delete_at: this.props.initialHook?.delete_at || 0,\r\n            team_id: this.props.initialHook?.team_id || '',\r\n            user_id: this.props.initialHook?.user_id || '',\r\n        };\r\n\r\n        this.props.action(hook).then(() => this.setState({saving: false}));\r\n    };\r\n\r\n    updateDisplayName: ChangeEventHandler<HTMLInputElement> = (e) => {\r\n        this.setState({\r\n            displayName: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateDescription: ChangeEventHandler<HTMLInputElement> = (e) => {\r\n        this.setState({\r\n            description: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateChannelId: ChangeEventHandler<HTMLSelectElement> = (e) => {\r\n        this.setState({\r\n            channelId: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateChannelLocked: ChangeEventHandler<HTMLInputElement> = (e) => {\r\n        this.setState({\r\n            channelLocked: e.target.checked,\r\n        });\r\n    };\r\n\r\n    updateUsername: ChangeEventHandler<HTMLInputElement> = (e) => {\r\n        this.setState({\r\n            username: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateIconURL: ChangeEventHandler<HTMLInputElement> = (e) => {\r\n        this.setState({\r\n            iconURL: e.target.value,\r\n        });\r\n    };\r\n\r\n    render() {\r\n        const headerToRender = this.props.header;\r\n        const footerToRender = this.props.footer;\r\n\r\n        return (\r\n            <div className='backstage-content'>\r\n                <BackstageHeader>\r\n                    <Link to={`/${this.props.team.name}/integrations/incoming_webhooks`}>\r\n                        <FormattedMessage\r\n                            id='incoming_webhooks.header'\r\n                            defaultMessage='Incoming Webhooks'\r\n                        />\r\n                    </Link>\r\n                    <FormattedMessage\r\n                        id={headerToRender.id}\r\n                        defaultMessage={headerToRender.defaultMessage}\r\n                    />\r\n                </BackstageHeader>\r\n                <div className='backstage-form'>\r\n                    <form\r\n                        className='form-horizontal'\r\n                        onSubmit={(e) => this.handleSubmit(e)}\r\n                    >\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='displayName'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_incoming_webhook.displayName'\r\n                                    defaultMessage='Title'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <input\r\n                                    id='displayName'\r\n                                    type='text'\r\n                                    maxLength={64}\r\n                                    className='form-control'\r\n                                    value={this.state.displayName}\r\n                                    onChange={this.updateDisplayName}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_incoming_webhook.displayName.help'\r\n                                        defaultMessage='Specify a title, of up to 64 characters, for the webhook settings page.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='description'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_incoming_webhook.description'\r\n                                    defaultMessage='Description'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <input\r\n                                    id='description'\r\n                                    type='text'\r\n                                    maxLength={500}\r\n                                    className='form-control'\r\n                                    value={this.state.description}\r\n                                    onChange={this.updateDescription}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_incoming_webhook.description.help'\r\n                                        defaultMessage='Describe your incoming webhook.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='channelId'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_incoming_webhook.channel'\r\n                                    defaultMessage='Channel'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <ChannelSelect\r\n                                    value={this.state.channelId}\r\n                                    onChange={this.updateChannelId}\r\n                                    selectOpen={true}\r\n                                    selectPrivate={true}\r\n                                    selectDm={false}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_incoming_webhook.channel.help'\r\n                                        defaultMessage='This is the default public or private channel that receives the webhook payloads. When setting up the webhook, you must belong to the private channel.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        { this.props.canBypassChannelLock &&\r\n                            <div className='form-group'>\r\n                                <label\r\n                                    className='control-label col-sm-4'\r\n                                    htmlFor='channelLocked'\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='add_incoming_webhook.channelLocked'\r\n                                        defaultMessage='Lock to this channel'\r\n                                    />\r\n                                </label>\r\n                                <div className='col-md-5 col-sm-8 checkbox'>\r\n                                    <input\r\n                                        id='channelLocked'\r\n                                        type='checkbox'\r\n                                        checked={this.state.channelLocked}\r\n                                        onChange={this.updateChannelLocked}\r\n                                    />\r\n                                    <div className='form__help'>\r\n                                        <FormattedMessage\r\n                                            id='add_incoming_webhook.channelLocked.help'\r\n                                            defaultMessage='If set, the incoming webhook can post only to the selected channel.'\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        }\r\n                        { this.props.enablePostUsernameOverride &&\r\n                            <div className='form-group'>\r\n                                <label\r\n                                    className='control-label col-sm-4'\r\n                                    htmlFor='username'\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='add_incoming_webhook.username'\r\n                                        defaultMessage='Username'\r\n                                    />\r\n                                </label>\r\n                                <div className='col-md-5 col-sm-8'>\r\n                                    <input\r\n                                        id='username'\r\n                                        type='text'\r\n                                        maxLength={22}\r\n                                        className='form-control'\r\n                                        value={this.state.username}\r\n                                        onChange={this.updateUsername}\r\n                                    />\r\n                                    <div className='form__help'>\r\n                                        <FormattedMessage\r\n                                            id='add_incoming_webhook.username.help'\r\n                                            defaultMessage='Specify the username this integration will post as. Usernames can be up to 22 characters, and can contain lowercase letters, numbers and the symbols \\\"-\\\", \\\"_\\\", and \\\".\\\". If left blank, the name specified by the webhook creator is used.'\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        }\r\n                        { this.props.enablePostIconOverride &&\r\n                            <div className='form-group'>\r\n                                <label\r\n                                    className='control-label col-sm-4'\r\n                                    htmlFor='iconURL'\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='add_incoming_webhook.icon_url'\r\n                                        defaultMessage='Profile Picture'\r\n                                    />\r\n                                </label>\r\n                                <div className='col-md-5 col-sm-8'>\r\n                                    <input\r\n                                        id='iconURL'\r\n                                        type='text'\r\n                                        maxLength={1024}\r\n                                        className='form-control'\r\n                                        value={this.state.iconURL}\r\n                                        onChange={this.updateIconURL}\r\n                                    />\r\n                                    <div className='form__help'>\r\n                                        <FormattedMessage\r\n                                            id='add_incoming_webhook.icon_url.help'\r\n                                            defaultMessage='Enter the URL of a .png or .jpg file for the profile picture of this integration when posting. The file should be at least 128 pixels by 128 pixels. If left blank, the profile picture specified by the webhook creator is used.'\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        }\r\n                        <div className='backstage-form__footer'>\r\n                            <FormError\r\n                                type='backstage'\r\n                                errors={[this.props.serverError, this.state.clientError]}\r\n                            />\r\n                            <Link\r\n                                className='btn btn-tertiary'\r\n                                to={`/${this.props.team.name}/integrations/incoming_webhooks`}\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_incoming_webhook.cancel'\r\n                                    defaultMessage='Cancel'\r\n                                />\r\n                            </Link>\r\n                            <SpinnerButton\r\n                                className='btn btn-primary'\r\n                                type='submit'\r\n                                spinning={this.state.saving}\r\n                                spinningText={this.props.loading}\r\n                                onClick={(e) => this.handleSubmit(e)}\r\n                                id='saveWebhook'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id={footerToRender.id}\r\n                                    defaultMessage={footerToRender.defaultMessage}\r\n                                />\r\n                            </SpinnerButton>\r\n                        </div>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {memo, useCallback, useState} from 'react';\r\nimport {defineMessages} from 'react-intl';\r\n\r\nimport type {IncomingWebhook} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport AbstractIncomingWebhook from 'components/integrations/abstract_incoming_webhook';\r\n\r\nimport {getHistory} from 'utils/browser_history';\r\n\r\nconst messages = defineMessages({\r\n    footer: {\r\n        id: 'add_incoming_webhook.save',\r\n        defaultMessage: 'Save',\r\n    },\r\n    header: {\r\n        id: 'integrations.add',\r\n        defaultMessage: 'Add',\r\n    },\r\n    loading: {\r\n        id: 'add_incoming_webhook.saving',\r\n        defaultMessage: 'Saving...',\r\n    },\r\n});\r\n\r\ntype Props = {\r\n\r\n    /**\r\n    * The current team\r\n    */\r\n    team: Team;\r\n\r\n    /**\r\n    * Whether to allow configuration of the default post username.\r\n    */\r\n    enablePostUsernameOverride: boolean;\r\n\r\n    /**\r\n    * Whether to allow configuration of the default post icon.\r\n    */\r\n    enablePostIconOverride: boolean;\r\n\r\n    /**\r\n    * Whether the user can bypass the channel lock requirement.\r\n    */\r\n    canBypassChannelLock?: boolean;\r\n\r\n    actions: {\r\n\r\n        /**\r\n        * The function to call to add a new incoming webhook\r\n        */\r\n        createIncomingHook: (hook: IncomingWebhook) => Promise<ActionResult<IncomingWebhook>>;\r\n    };\r\n};\r\n\r\nconst AddIncomingWebhook = ({\r\n    team,\r\n    enablePostUsernameOverride,\r\n    enablePostIconOverride,\r\n    canBypassChannelLock,\r\n    actions,\r\n}: Props) => {\r\n    const [serverError, setServerError] = useState('');\r\n\r\n    const addIncomingHook = useCallback(async (hook: IncomingWebhook) => {\r\n        setServerError('');\r\n\r\n        const {data, error} = await actions.createIncomingHook(hook);\r\n        if (data) {\r\n            getHistory().push(`/${team.name}/integrations/confirm?type=incoming_webhooks&id=${data.id}`);\r\n            return;\r\n        }\r\n        if (error) {\r\n            setServerError(error.message);\r\n        }\r\n    }, [actions, team.name]);\r\n\r\n    return (\r\n        <AbstractIncomingWebhook\r\n            team={team}\r\n            header={messages.header}\r\n            footer={messages.footer}\r\n            loading={messages.loading}\r\n            enablePostUsernameOverride={enablePostUsernameOverride}\r\n            enablePostIconOverride={enablePostIconOverride}\r\n            canBypassChannelLock={canBypassChannelLock}\r\n            action={addIncomingHook}\r\n            serverError={serverError}\r\n        />\r\n    );\r\n};\r\nexport default memo(AddIncomingWebhook);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {createIncomingHook} from 'mattermost-redux/actions/integrations';\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {haveICurrentTeamPermission} from 'mattermost-redux/selectors/entities/roles';\r\n\r\nimport AddIncomingWebhook from './add_incoming_webhook';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const config = getConfig(state);\r\n    const enablePostUsernameOverride = config.EnablePostUsernameOverride === 'true';\r\n    const enablePostIconOverride = config.EnablePostIconOverride === 'true';\r\n    const canBypassChannelLock = haveICurrentTeamPermission(state, Permissions.BYPASS_INCOMING_WEBHOOK_CHANNEL_LOCK);\r\n\r\n    return {\r\n        enablePostUsernameOverride,\r\n        enablePostIconOverride,\r\n        canBypassChannelLock,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            createIncomingHook,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(AddIncomingWebhook);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {ChangeEvent, FormEvent} from 'react';\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\nimport type {MessageDescriptor} from 'react-intl';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport type {OAuthApp} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport {Permissions} from 'mattermost-redux/constants';\r\n\r\nimport BackstageHeader from 'components/backstage/components/backstage_header';\r\nimport FormError from 'components/form_error';\r\nimport SystemPermissionGate from 'components/permissions_gates/system_permission_gate';\r\nimport SpinnerButton from 'components/spinner_button';\r\n\r\ntype Props = {\r\n\r\n    /**\r\n   * The current team\r\n   */\r\n    team: Team;\r\n\r\n    /**\r\n   * The header text to render, has id and defaultMessage\r\n   */\r\n    header: MessageDescriptor;\r\n\r\n    /**\r\n   * The footer text to render, has id and defaultMessage\r\n   */\r\n    footer: MessageDescriptor;\r\n\r\n    /**\r\n   * The spinner loading text to render, has id and defaultMessage\r\n   */\r\n    loading: MessageDescriptor;\r\n\r\n    /**\r\n   * Any extra component/node to render\r\n   */\r\n    renderExtra?: JSX.Element;\r\n\r\n    /**\r\n    * The server error text after a failed action\r\n    */\r\n    serverError: string;\r\n\r\n    /**\r\n   * The OAuthApp used to set the initial state\r\n   */\r\n    initialApp?: OAuthApp;\r\n\r\n    /**\r\n    * The async function to run when the action button is pressed\r\n    */\r\n    action: (app: OAuthApp) => Promise<void>;\r\n\r\n}\r\n\r\ntype State = {\r\n    name: string;\r\n    description: string;\r\n    homepage: string;\r\n    icon_url: string;\r\n    callbackUrls: string;\r\n    is_trusted: boolean;\r\n    is_public: boolean;\r\n    has_icon: boolean;\r\n    saving: boolean;\r\n    clientError: JSX.Element | null | string;\r\n};\r\n\r\nexport default class AbstractOAuthApp extends React.PureComponent<Props, State> {\r\n    private image: HTMLImageElement;\r\n    private icon_url: React.RefObject<HTMLInputElement>;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.image = new Image();\r\n        this.image.onload = this.imageLoaded;\r\n        this.icon_url = React.createRef();\r\n        this.state = this.getStateFromApp(this.props.initialApp || {} as OAuthApp);\r\n    }\r\n\r\n    getStateFromApp = (app: OAuthApp) => {\r\n        // Determine if this is a public client by checking if the secret is empty\r\n        // Only apply this detection if we have an existing app with an ID\r\n        const isPublicClient = app.id && (!app.client_secret || app.client_secret === '');\r\n\r\n        return {\r\n            name: app.name || '',\r\n            description: app.description || '',\r\n            homepage: app.homepage || '',\r\n            icon_url: app.icon_url || '',\r\n            callbackUrls: app.callback_urls ? app.callback_urls.join('\\n') : '',\r\n            is_trusted: app.is_trusted || false,\r\n            is_public: app.is_public ?? (isPublicClient || false),\r\n            has_icon: Boolean(app.icon_url),\r\n            saving: false,\r\n            clientError: null,\r\n        };\r\n    };\r\n\r\n    imageLoaded = () => {\r\n        if (this.icon_url.current?.value) {\r\n            this.setState({\r\n                has_icon: true,\r\n                icon_url: this.icon_url.current.value,\r\n            });\r\n        }\r\n    };\r\n\r\n    handleSubmit = (e: FormEvent) => {\r\n        e.preventDefault();\r\n\r\n        if (this.state.saving) {\r\n            return;\r\n        }\r\n\r\n        this.setState({\r\n            saving: true,\r\n            clientError: '',\r\n        });\r\n\r\n        if (!this.state.name) {\r\n            this.setState({\r\n                saving: false,\r\n                clientError: (\r\n                    <FormattedMessage\r\n                        id='add_oauth_app.nameRequired'\r\n                        defaultMessage='Name for the OAuth 2.0 application is required.'\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        const isDynamicallyRegistered = this.props.initialApp?.is_dynamically_registered || false;\r\n\r\n        if (!this.state.description && !isDynamicallyRegistered) {\r\n            this.setState({\r\n                saving: false,\r\n                clientError: (\r\n                    <FormattedMessage\r\n                        id='add_oauth_app.descriptionRequired'\r\n                        defaultMessage='Description for the OAuth 2.0 application is required.'\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        if (!this.state.homepage && !isDynamicallyRegistered) {\r\n            this.setState({\r\n                saving: false,\r\n                clientError: (\r\n                    <FormattedMessage\r\n                        id='add_oauth_app.homepageRequired'\r\n                        defaultMessage='Homepage for the OAuth 2.0 application is required.'\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        const callbackUrls = [];\r\n        for (let callbackUrl of this.state.callbackUrls.split('\\n')) {\r\n            callbackUrl = callbackUrl.trim();\r\n\r\n            if (callbackUrl.length > 0) {\r\n                callbackUrls.push(callbackUrl);\r\n            }\r\n        }\r\n\r\n        if (callbackUrls.length === 0) {\r\n            this.setState({\r\n                saving: false,\r\n                clientError: (\r\n                    <FormattedMessage\r\n                        id='add_oauth_app.callbackUrlsRequired'\r\n                        defaultMessage='One or more callback URLs are required.'\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        const app = {\r\n            name: this.state.name,\r\n            callback_urls: callbackUrls,\r\n            homepage: this.state.homepage,\r\n            description: this.state.description,\r\n            is_trusted: this.state.is_trusted,\r\n            is_public: this.state.is_public,\r\n            icon_url: this.state.icon_url,\r\n        } as OAuthApp;\r\n\r\n        this.props.action(app).then(() => this.setState({saving: false}));\r\n    };\r\n\r\n    updateName = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            name: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateTrusted = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            is_trusted: e.target.value === 'true',\r\n        });\r\n    };\r\n\r\n    updatePublic = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            is_public: e.target.value === 'true',\r\n        });\r\n    };\r\n\r\n    updateDescription = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            description: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateHomepage = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            homepage: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateIconUrl = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            has_icon: false,\r\n            icon_url: e.target.value,\r\n        });\r\n        this.image.src = e.target.value;\r\n    };\r\n\r\n    updateCallbackUrls = (e: ChangeEvent<HTMLTextAreaElement>) => {\r\n        this.setState({\r\n            callbackUrls: e.target.value,\r\n        });\r\n    };\r\n\r\n    render() {\r\n        const headerToRender = this.props.header;\r\n        const footerToRender = this.props.footer;\r\n        const renderExtra = this.props.renderExtra;\r\n\r\n        let icon;\r\n        if (this.state.has_icon) {\r\n            icon = (\r\n                <div className='integration__icon'>\r\n                    <img\r\n                        alt={'integration icon'}\r\n                        src={this.state.icon_url}\r\n                    />\r\n                </div>\r\n            );\r\n        }\r\n\r\n        const trusted = (\r\n            <SystemPermissionGate permissions={[Permissions.MANAGE_SYSTEM]}>\r\n                <div className='form-group'>\r\n                    <label\r\n                        className='control-label col-sm-4'\r\n                        htmlFor='is_trusted'\r\n                    >\r\n                        <FormattedMessage\r\n                            id='installed_oauth_apps.trusted'\r\n                            defaultMessage='Is Trusted'\r\n                        />\r\n                    </label>\r\n                    <div className='col-md-5 col-sm-8'>\r\n                        <label className='radio-inline'>\r\n                            <input\r\n                                type='radio'\r\n                                value='true'\r\n                                name='is_trusted'\r\n                                checked={this.state.is_trusted}\r\n                                onChange={this.updateTrusted}\r\n                            />\r\n                            <FormattedMessage\r\n                                id='installed_oauth_apps.trusted.yes'\r\n                                defaultMessage='Yes'\r\n                            />\r\n                        </label>\r\n                        <label className='radio-inline'>\r\n                            <input\r\n                                type='radio'\r\n                                value='false'\r\n                                name='is_trusted'\r\n                                checked={!this.state.is_trusted}\r\n                                onChange={this.updateTrusted}\r\n                            />\r\n                            <FormattedMessage\r\n                                id='installed_oauth_apps.trusted.no'\r\n                                defaultMessage='No'\r\n                            />\r\n                        </label>\r\n                        <div className='form__help'>\r\n                            <FormattedMessage\r\n                                id='add_oauth_app.trusted.help'\r\n                                defaultMessage='If true, the OAuth 2.0 application is considered trusted by the Mattermost server and does not require the user to accept authorization. If false, a window opens to ask the user to accept or deny the authorization.'\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </SystemPermissionGate>\r\n        );\r\n\r\n        const isEditing = Boolean(this.props.initialApp?.id);\r\n        const publicClient = (\r\n            <div className='form-group'>\r\n                <label\r\n                    className='control-label col-sm-4'\r\n                    htmlFor='is_public'\r\n                >\r\n                    <FormattedMessage\r\n                        id='installed_oauth_apps.public'\r\n                        defaultMessage='Is Public Client'\r\n                    />\r\n                </label>\r\n                <div className='col-md-5 col-sm-8'>\r\n                    <label className='radio-inline'>\r\n                        <input\r\n                            type='radio'\r\n                            value='true'\r\n                            name='is_public'\r\n                            checked={this.state.is_public}\r\n                            onChange={this.updatePublic}\r\n                            disabled={isEditing}\r\n                        />\r\n                        <FormattedMessage\r\n                            id='installed_oauth_apps.public.yes'\r\n                            defaultMessage='Yes'\r\n                        />\r\n                    </label>\r\n                    <label className='radio-inline'>\r\n                        <input\r\n                            type='radio'\r\n                            value='false'\r\n                            name='is_public'\r\n                            checked={!this.state.is_public}\r\n                            onChange={this.updatePublic}\r\n                            disabled={isEditing}\r\n                        />\r\n                        <FormattedMessage\r\n                            id='installed_oauth_apps.public.no'\r\n                            defaultMessage='No'\r\n                        />\r\n                    </label>\r\n                    <div className='form__help'>\r\n                        <FormattedMessage\r\n                            id='add_oauth_app.public.help'\r\n                            defaultMessage='If true, the OAuth 2.0 application is a public client (no client secret). Public clients must use PKCE for authorization. If false, the application is a confidential client with a client secret. This setting cannot be changed after the application is created.'\r\n                        />\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n\r\n        return (\r\n            <div className='backstage-content'>\r\n                <BackstageHeader>\r\n                    <Link to={`/${this.props.team.name}/integrations/oauth2-apps`}>\r\n                        <FormattedMessage\r\n                            id='installed_oauth_apps.header'\r\n                            defaultMessage='Installed OAuth2 Apps'\r\n                        />\r\n                    </Link>\r\n                    <FormattedMessage\r\n                        id={headerToRender.id}\r\n                        defaultMessage={headerToRender.defaultMessage}\r\n                    />\r\n                </BackstageHeader>\r\n                <div className='backstage-form'>\r\n                    {icon}\r\n                    <form className='form-horizontal'>\r\n                        {trusted}\r\n                        {publicClient}\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='name'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='installed_oauth_apps.name'\r\n                                    defaultMessage='Display Name'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <input\r\n                                    id='name'\r\n                                    type='text'\r\n                                    maxLength={64}\r\n                                    className='form-control'\r\n                                    value={this.state.name}\r\n                                    onChange={this.updateName}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_oauth_app.name.help'\r\n                                        defaultMessage='Specify the display name, of up to 64 characters, for your OAuth 2.0 application.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='description'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='installed_oauth_apps.description'\r\n                                    defaultMessage='Description'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <input\r\n                                    id='description'\r\n                                    type='text'\r\n                                    maxLength={512}\r\n                                    className='form-control'\r\n                                    value={this.state.description}\r\n                                    onChange={this.updateDescription}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_oauth_app.description.help'\r\n                                        defaultMessage='Describe your OAuth 2.0 application.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='homepage'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='installed_oauth_apps.homepage'\r\n                                    defaultMessage='Homepage'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <input\r\n                                    id='homepage'\r\n                                    type='url'\r\n                                    maxLength={256}\r\n                                    className='form-control'\r\n                                    value={this.state.homepage}\r\n                                    onChange={this.updateHomepage}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_oauth_app.homepage.help'\r\n                                        defaultMessage='This is the URL for the homepage of the OAuth 2.0 application. Depending on your server configuration, use HTTP or HTTPS in the URL.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='icon_url'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='installed_oauth_apps.iconUrl'\r\n                                    defaultMessage='Icon URL'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <input\r\n                                    id='icon_url'\r\n                                    ref={this.icon_url}\r\n                                    type='url'\r\n                                    maxLength={512}\r\n                                    className='form-control'\r\n                                    value={this.state.icon_url}\r\n                                    onChange={this.updateIconUrl}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_oauth_app.icon.help'\r\n                                        defaultMessage='(Optional) The URL of the image used for your OAuth 2.0 application. Make sure you use HTTP or HTTPS in your URL.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='callbackUrls'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='installed_oauth_apps.callbackUrls'\r\n                                    defaultMessage='Callback URLs (One Per Line)'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <textarea\r\n                                    id='callbackUrls'\r\n                                    rows={3}\r\n                                    maxLength={1024}\r\n                                    className='form-control'\r\n                                    value={this.state.callbackUrls}\r\n                                    onChange={this.updateCallbackUrls}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_oauth_app.callbackUrls.help'\r\n                                        defaultMessage='The redirect URIs to which the service will redirect users after accepting or denying authorization of your application, and which will handle authorization codes or access tokens. Must be a valid URL and start with http:// or https://.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='backstage-form__footer'>\r\n                            <FormError\r\n                                type='backstage'\r\n                                errors={[this.props.serverError, this.state.clientError]}\r\n                            />\r\n                            <Link\r\n                                className='btn btn-tertiary'\r\n                                to={`/${this.props.team.name}/integrations/oauth2-apps`}\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='installed_oauth_apps.cancel'\r\n                                    defaultMessage='Cancel'\r\n                                />\r\n                            </Link>\r\n                            <SpinnerButton\r\n                                className='btn btn-primary'\r\n                                type='submit'\r\n                                spinning={this.state.saving}\r\n                                spinningText={this.props.loading}\r\n                                onClick={this.handleSubmit}\r\n                                id='saveOauthApp'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id={footerToRender.id}\r\n                                    defaultMessage={footerToRender.defaultMessage}\r\n                                />\r\n                            </SpinnerButton>\r\n                            {renderExtra}\r\n                        </div>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useState} from 'react';\r\nimport {defineMessages} from 'react-intl';\r\nimport {useHistory} from 'react-router-dom';\r\n\r\nimport type {OAuthApp} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions.js';\r\n\r\nimport AbstractOAuthApp from '../abstract_oauth_app';\r\n\r\nconst messages = defineMessages({\r\n    footer: {\r\n        id: 'installed_oauth_apps.save',\r\n        defaultMessage: 'Save',\r\n    },\r\n    header: {\r\n        id: 'add_oauth_app.header',\r\n        defaultMessage: 'Add',\r\n    },\r\n    loading: {\r\n        id: 'installed_oauth_apps.saving',\r\n        defaultMessage: 'Saving...',\r\n    },\r\n});\r\n\r\nexport type Props = {\r\n\r\n    /**\r\n    * The team data\r\n    */\r\n    team: Team;\r\n\r\n    actions: {\r\n\r\n        /**\r\n        * The function to call to add new OAuthApp\r\n        */\r\n        addOAuthApp: (app: OAuthApp) => Promise<ActionResult<OAuthApp>>;\r\n    };\r\n};\r\n\r\nconst AddOAuthApp = ({team, actions}: Props): JSX.Element => {\r\n    const history = useHistory();\r\n\r\n    const [serverError, setServerError] = useState('');\r\n\r\n    const addOAuthApp = async (app: OAuthApp) => {\r\n        setServerError('');\r\n\r\n        const {data, error} = await actions.addOAuthApp(app);\r\n        if (data) {\r\n            history.push(`/${team.name}/integrations/confirm?type=oauth2-apps&id=${data.id}`);\r\n            return;\r\n        }\r\n\r\n        if (error) {\r\n            setServerError(error.message);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <AbstractOAuthApp\r\n            team={team}\r\n            header={messages.header}\r\n            footer={messages.footer}\r\n            loading={messages.loading}\r\n            action={addOAuthApp}\r\n            serverError={serverError}\r\n        />\r\n    );\r\n};\r\n\r\nexport default AddOAuthApp;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {addOAuthApp} from 'mattermost-redux/actions/integrations';\r\n\r\nimport AddOAuthApp from './add_oauth_app';\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            addOAuthApp,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(null, mapDispatchToProps)(AddOAuthApp);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport type {ChangeEventHandler, FormEvent, MouseEvent} from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\nimport type {MessageDescriptor} from 'react-intl';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport type {OutgoingWebhook} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport BackstageHeader from 'components/backstage/components/backstage_header';\r\nimport ChannelSelect from 'components/channel_select';\r\nimport ExternalLink from 'components/external_link';\r\nimport FormError from 'components/form_error';\r\nimport SpinnerButton from 'components/spinner_button';\r\n\r\nimport {DocLinks} from 'utils/constants';\r\nimport {localizeMessage} from 'utils/utils';\r\n\r\ninterface State {\r\n    callbackUrls: string;\r\n    channelId: string;\r\n    clientError: JSX.Element | null;\r\n    contentType: string;\r\n    description: string;\r\n    displayName: string;\r\n    iconURL: string;\r\n    saving: boolean;\r\n    triggerWhen: number;\r\n    triggerWords: string;\r\n    username: string;\r\n}\r\n\r\ninterface Props {\r\n\r\n    /**\r\n     * The current team\r\n     */\r\n    team: Team;\r\n\r\n    /**\r\n     * The header text to render, has id and defaultMessage\r\n     */\r\n    header: MessageDescriptor;\r\n\r\n    /**\r\n     * The footer text to render, has id and defaultMessage\r\n     */\r\n    footer: MessageDescriptor;\r\n\r\n    /**\r\n    * The spinner loading text to render, has id and defaultMessage\r\n    */\r\n    loading: MessageDescriptor;\r\n\r\n    /**\r\n     * Any extra component/node to render\r\n     */\r\n    renderExtra: React.ReactNode;\r\n\r\n    /**\r\n     * The server error text after a failed action\r\n     */\r\n    serverError: string;\r\n\r\n    /**\r\n     * The hook used to set the initial state\r\n     */\r\n    initialHook?: OutgoingWebhook;\r\n\r\n    /**\r\n     * The async function to run when the action button is pressed\r\n     */\r\n    action: (hook: OutgoingWebhook) => Promise<void>;\r\n\r\n    /**\r\n     * Whether to allow configuration of the default post username.\r\n     */\r\n    enablePostUsernameOverride: boolean;\r\n\r\n    /**\r\n     * Whether to allow configuration of the default post icon.\r\n     */\r\n    enablePostIconOverride: boolean;\r\n}\r\n\r\nexport default class AbstractOutgoingWebhook extends React.PureComponent<Props, State> {\r\n    constructor(props: Props | Readonly<Props>) {\r\n        super(props);\r\n\r\n        this.state = this.getStateFromHook(this.props.initialHook);\r\n    }\r\n\r\n    getStateFromHook = (hook?: OutgoingWebhook) => {\r\n        let triggerWords = '';\r\n        if (hook?.trigger_words) {\r\n            let i = 0;\r\n            for (i = 0; i < hook.trigger_words.length; i++) {\r\n                triggerWords += hook.trigger_words[i] + '\\n';\r\n            }\r\n        }\r\n\r\n        let callbackUrls = '';\r\n        if (hook?.callback_urls) {\r\n            let i = 0;\r\n            for (i = 0; i < hook.callback_urls.length; i++) {\r\n                callbackUrls += hook.callback_urls[i] + '\\n';\r\n            }\r\n        }\r\n\r\n        return {\r\n            displayName: hook?.display_name || '',\r\n            description: hook?.description || '',\r\n            contentType: hook?.content_type || 'application/x-www-form-urlencoded',\r\n            channelId: hook?.channel_id || '',\r\n            triggerWords,\r\n            triggerWhen: hook?.trigger_when || 0,\r\n            callbackUrls,\r\n            saving: false,\r\n            clientError: null,\r\n            username: hook?.username || '',\r\n            iconURL: hook?.icon_url || '',\r\n        };\r\n    };\r\n\r\n    handleSubmit = (e: MouseEvent<HTMLElement> | FormEvent<HTMLFormElement>) => {\r\n        e.preventDefault();\r\n\r\n        if (this.state.saving) {\r\n            return;\r\n        }\r\n\r\n        this.setState({\r\n            saving: true,\r\n            clientError: null,\r\n        });\r\n\r\n        const triggerWords = [];\r\n        if (this.state.triggerWords) {\r\n            for (let triggerWord of this.state.triggerWords.split('\\n')) {\r\n                triggerWord = triggerWord.trim();\r\n\r\n                if (triggerWord.length > 0) {\r\n                    triggerWords.push(triggerWord);\r\n                }\r\n            }\r\n        }\r\n\r\n        if (!this.state.channelId && triggerWords.length === 0) {\r\n            this.setState({\r\n                saving: false,\r\n                clientError: (\r\n                    <FormattedMessage\r\n                        id='add_outgoing_webhook.triggerWordsOrChannelRequired'\r\n                        defaultMessage='A valid channel or a list of trigger words is required'\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        const callbackUrls = [];\r\n        for (let callbackUrl of this.state.callbackUrls.split('\\n')) {\r\n            callbackUrl = callbackUrl.trim();\r\n\r\n            if (callbackUrl.length > 0) {\r\n                callbackUrls.push(callbackUrl);\r\n            }\r\n        }\r\n\r\n        if (callbackUrls.length === 0) {\r\n            this.setState({\r\n                saving: false,\r\n                clientError: (\r\n                    <FormattedMessage\r\n                        id='add_outgoing_webhook.callbackUrlsRequired'\r\n                        defaultMessage='One or more callback URLs are required'\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        const hook = {\r\n            team_id: this.props.team.id,\r\n            channel_id: this.state.channelId,\r\n            trigger_words: triggerWords,\r\n            trigger_when: this.state.triggerWhen,\r\n            callback_urls: callbackUrls,\r\n            display_name: this.state.displayName,\r\n            content_type: this.state.contentType,\r\n            description: this.state.description,\r\n            username: this.state.username,\r\n            icon_url: this.state.iconURL,\r\n            id: this.props.initialHook?.id || '',\r\n            create_at: this.props.initialHook?.create_at || 0,\r\n            update_at: this.props.initialHook?.update_at || 0,\r\n            delete_at: this.props.initialHook?.delete_at || 0,\r\n            creator_id: this.props.initialHook?.creator_id || '',\r\n            token: this.props.initialHook?.token || '',\r\n        };\r\n\r\n        this.props.action(hook).then(() => this.setState({saving: false}));\r\n    };\r\n\r\n    updateDisplayName: ChangeEventHandler<HTMLInputElement> = (e) => {\r\n        this.setState({\r\n            displayName: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateDescription: ChangeEventHandler<HTMLInputElement> = (e) => {\r\n        this.setState({\r\n            description: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateContentType: ChangeEventHandler<HTMLSelectElement> = (e) => {\r\n        this.setState({\r\n            contentType: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateChannelId: ChangeEventHandler<HTMLSelectElement> = (e) => {\r\n        this.setState({\r\n            channelId: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateTriggerWords: ChangeEventHandler<HTMLTextAreaElement> = (e) => {\r\n        this.setState({\r\n            triggerWords: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateTriggerWhen: ChangeEventHandler<HTMLSelectElement> = (e) => {\r\n        this.setState({\r\n            triggerWhen: parseInt(e.target.value, 10),\r\n        });\r\n    };\r\n\r\n    updateCallbackUrls: ChangeEventHandler<HTMLTextAreaElement> = (e) => {\r\n        this.setState({\r\n            callbackUrls: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateUsername: ChangeEventHandler<HTMLInputElement> = (e) => {\r\n        this.setState({\r\n            username: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateIconURL: ChangeEventHandler<HTMLInputElement> = (e) => {\r\n        this.setState({\r\n            iconURL: e.target.value,\r\n        });\r\n    };\r\n\r\n    render() {\r\n        const contentTypeOption1 = 'application/x-www-form-urlencoded';\r\n        const contentTypeOption2 = 'application/json';\r\n\r\n        const headerToRender = this.props.header;\r\n        const footerToRender = this.props.footer;\r\n        const renderExtra = this.props.renderExtra;\r\n\r\n        return (\r\n            <div className='backstage-content'>\r\n                <BackstageHeader>\r\n                    <Link to={`/${this.props.team.name}/integrations/outgoing_webhooks`}>\r\n                        <FormattedMessage\r\n                            id='add_outgoing_webhook.header'\r\n                            defaultMessage='Outgoing Webhooks'\r\n                        />\r\n                    </Link>\r\n                    <FormattedMessage\r\n                        id={headerToRender.id}\r\n                        defaultMessage={headerToRender.defaultMessage}\r\n                    />\r\n                </BackstageHeader>\r\n                <div className='backstage-form'>\r\n                    <form\r\n                        className='form-horizontal'\r\n                        onSubmit={this.handleSubmit}\r\n                    >\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='displayName'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_outgoing_webhook.displayName'\r\n                                    defaultMessage='Title'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <input\r\n                                    id='displayName'\r\n                                    type='text'\r\n                                    maxLength={64}\r\n                                    className='form-control'\r\n                                    value={this.state.displayName}\r\n                                    onChange={this.updateDisplayName}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_outgoing_webhook.displayName.help'\r\n                                        defaultMessage='Specify a title, of up to 64 characters, for the webhook settings page.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='description'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_outgoing_webhook.description'\r\n                                    defaultMessage='Description'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <input\r\n                                    id='description'\r\n                                    type='text'\r\n                                    maxLength={500}\r\n                                    className='form-control'\r\n                                    value={this.state.description}\r\n                                    onChange={this.updateDescription}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_outgoing_webhook.description.help'\r\n                                        defaultMessage='Describe your outgoing webhook.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='contentType'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_outgoing_webhook.content_Type'\r\n                                    defaultMessage='Content Type'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <select\r\n                                    className='form-control'\r\n                                    value={this.state.contentType}\r\n                                    onChange={this.updateContentType}\r\n                                >\r\n                                    <option\r\n                                        value={contentTypeOption1}\r\n                                    >\r\n                                        {contentTypeOption1}\r\n                                    </option>\r\n                                    <option\r\n                                        value={contentTypeOption2}\r\n                                    >\r\n                                        {contentTypeOption2}\r\n                                    </option>\r\n                                </select>\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_outgoing_webhook.contentType.help1'\r\n                                        defaultMessage='Specify the content type by which to send the request.'\r\n                                    />\r\n                                </div>\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_outgoing_webhook.contentType.help2'\r\n                                        defaultMessage='For the server to encode the parameters in a URL format in the request body, select application/x-www-form-urlencoded.'\r\n                                    />\r\n                                </div>\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_outgoing_webhook.contentType.help3'\r\n                                        defaultMessage='For the server to format the request body as JSON, select application/json.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='channelId'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_outgoing_webhook.channel'\r\n                                    defaultMessage='Channel'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <ChannelSelect\r\n                                    value={this.state.channelId}\r\n                                    onChange={this.updateChannelId}\r\n                                    selectOpen={true}\r\n                                    selectPrivate={false}\r\n                                    selectDm={false}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_outgoing_webhook.channel.help'\r\n                                        defaultMessage='This field is optional if you specify at least one trigger word. Specify the public channel that delivers the payload to the webhook.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='triggerWords'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_outgoing_webhook.triggerWords'\r\n                                    defaultMessage='Trigger Words (One Per Line)'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <textarea\r\n                                    id='triggerWords'\r\n                                    rows={3}\r\n                                    maxLength={1000}\r\n                                    className='form-control'\r\n                                    value={this.state.triggerWords}\r\n                                    onChange={this.updateTriggerWords}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_outgoing_webhook.triggerWords.help'\r\n                                        defaultMessage='Specify the trigger words that send an HTTP POST request to your application. The trigger can be for the channel, the outgoing webhook, or both. If you select only Channel, trigger words are optional. If you select both, the message must match both values.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='triggerWords'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_outgoing_webhook.triggerWordsTriggerWhen'\r\n                                    defaultMessage='Trigger When'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <select\r\n                                    id='triggerWhen'\r\n                                    className='form-control'\r\n                                    value={this.state.triggerWhen}\r\n                                    onChange={this.updateTriggerWhen}\r\n                                >\r\n                                    <option\r\n                                        value='0'\r\n                                    >\r\n                                        {localizeMessage({id: 'add_outgoing_webhook.triggerWordsTriggerWhenFullWord', defaultMessage: 'First word matches a trigger word exactly'})}\r\n                                    </option>\r\n                                    <option\r\n                                        value='1'\r\n                                    >\r\n                                        {localizeMessage({id: 'add_outgoing_webhook.triggerWordsTriggerWhenStartsWith', defaultMessage: 'First word starts with a trigger word'})}\r\n                                    </option>\r\n                                </select>\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_outgoing_webhook.triggerWordsTriggerWhen.help'\r\n                                        defaultMessage='Specify when to trigger the outgoing webhook.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='callbackUrls'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_outgoing_webhook.callbackUrls'\r\n                                    defaultMessage='Callback URLs (One Per Line)'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <textarea\r\n                                    id='callbackUrls'\r\n                                    rows={3}\r\n                                    maxLength={1000}\r\n                                    className='form-control'\r\n                                    value={this.state.callbackUrls}\r\n                                    onChange={this.updateCallbackUrls}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_outgoing_webhook.callbackUrls.help'\r\n                                        defaultMessage='Specify the URL that the messages will be sent to. If the URL is private, add it as a {link}.'\r\n                                        values={{\r\n                                            link: (\r\n                                                <ExternalLink\r\n                                                    href={DocLinks.TRUSTED_CONNECTION}\r\n                                                    location='abstract_outgoing_webhook'\r\n                                                >\r\n                                                    <FormattedMessage\r\n                                                        id='add_outgoing_webhook.callbackUrls.helpLinkText'\r\n                                                        defaultMessage='trusted internal connection'\r\n                                                    />\r\n                                                </ExternalLink>\r\n                                            ),\r\n                                        }}\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        {this.props.enablePostUsernameOverride &&\r\n                            <div className='form-group'>\r\n                                <label\r\n                                    className='control-label col-sm-4'\r\n                                    htmlFor='username'\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='add_outgoing_webhook.username'\r\n                                        defaultMessage='Username'\r\n                                    />\r\n                                </label>\r\n                                <div className='col-md-5 col-sm-8'>\r\n                                    <input\r\n                                        id='username'\r\n                                        type='text'\r\n                                        maxLength={22}\r\n                                        className='form-control'\r\n                                        value={this.state.username}\r\n                                        onChange={this.updateUsername}\r\n                                    />\r\n                                    <div className='form__help'>\r\n                                        <FormattedMessage\r\n                                            id='add_outgoing_webhook.username.help'\r\n                                            defaultMessage='Specify the username this integration will post as. Usernames can be up to 22 characters, and contain lowercase letters, numbers and the symbols \\\"-\\\", \\\"_\\\", and \\\".\\\". If left blank, the name specified by the webhook creator is used.'\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        }\r\n                        {this.props.enablePostIconOverride &&\r\n                            <div className='form-group'>\r\n                                <label\r\n                                    className='control-label col-sm-4'\r\n                                    htmlFor='iconURL'\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='add_outgoing_webhook.icon_url'\r\n                                        defaultMessage='Profile Picture'\r\n                                    />\r\n                                </label>\r\n                                <div className='col-md-5 col-sm-8'>\r\n                                    <input\r\n                                        id='iconURL'\r\n                                        type='text'\r\n                                        maxLength={1024}\r\n                                        className='form-control'\r\n                                        value={this.state.iconURL}\r\n                                        onChange={this.updateIconURL}\r\n                                    />\r\n                                    <div className='form__help'>\r\n                                        <FormattedMessage\r\n                                            id='add_outgoing_webhook.icon_url.help'\r\n                                            defaultMessage='Enter the URL of a .png or .jpg file for this integration to use as the profile picture when posting. The file should be at least 128 pixels by 128 pixels. If left blank, the profile picture specified by the webhook creator is used.'\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        }\r\n                        <div className='backstage-form__footer'>\r\n                            <FormError\r\n                                type='backstage'\r\n                                errors={[this.props.serverError, this.state.clientError]}\r\n                            />\r\n                            <Link\r\n                                className='btn btn-tertiary'\r\n                                to={`/${this.props.team.name}/integrations/outgoing_webhooks`}\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_outgoing_webhook.cancel'\r\n                                    defaultMessage='Cancel'\r\n                                />\r\n                            </Link>\r\n                            <SpinnerButton\r\n                                className='btn btn-primary'\r\n                                type='submit'\r\n                                spinning={this.state.saving}\r\n                                spinningText={this.props.loading}\r\n                                onClick={this.handleSubmit}\r\n                                id='saveWebhook'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id={footerToRender.id}\r\n                                    defaultMessage={footerToRender.defaultMessage}\r\n                                />\r\n                            </SpinnerButton>\r\n                            {renderExtra}\r\n                        </div>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useState} from 'react';\r\nimport {defineMessages} from 'react-intl';\r\nimport {useHistory} from 'react-router-dom';\r\n\r\nimport type {OutgoingWebhook} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport AbstractOutgoingWebhook from 'components/integrations/abstract_outgoing_webhook';\r\n\r\nconst messages = defineMessages({\r\n    footer: {\r\n        id: 'add_outgoing_webhook.save',\r\n        defaultMessage: 'Save',\r\n    },\r\n    header: {\r\n        id: 'integrations.add',\r\n        defaultMessage: 'Add',\r\n    },\r\n    loading: {\r\n        id: 'add_outgoing_webhook.saving',\r\n        defaultMessage: 'Saving...',\r\n    },\r\n});\r\n\r\nexport type Props = {\r\n\r\n    /**\r\n     * The current team\r\n     */\r\n    team: Team;\r\n\r\n    actions: {\r\n\r\n        /**\r\n        * The function to call to add a new outgoing webhook\r\n        */\r\n        createOutgoingHook: (hook: OutgoingWebhook) => Promise<ActionResult<OutgoingWebhook>>;\r\n    };\r\n\r\n    /**\r\n     * Whether to allow configuration of the default post username.\r\n     */\r\n    enablePostUsernameOverride: boolean;\r\n\r\n    /**\r\n     * Whether to allow configuration of the default post icon.\r\n     */\r\n    enablePostIconOverride: boolean;\r\n};\r\n\r\nconst AddOutgoingWebhook = ({team, actions, enablePostUsernameOverride, enablePostIconOverride}: Props): JSX.Element => {\r\n    const history = useHistory();\r\n\r\n    const [serverError, setServerError] = useState('');\r\n\r\n    const addOutgoingHook = async (hook: OutgoingWebhook) => {\r\n        setServerError('');\r\n\r\n        const {data, error} = await actions.createOutgoingHook(hook);\r\n        if (data) {\r\n            history.push(`/${team.name}/integrations/confirm?type=outgoing_webhooks&id=${data.id}`);\r\n            return;\r\n        }\r\n\r\n        if (error) {\r\n            setServerError(error.message);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <AbstractOutgoingWebhook\r\n            team={team}\r\n            header={messages.header}\r\n            footer={messages.footer}\r\n            loading={messages.loading}\r\n            renderExtra={''}\r\n            action={addOutgoingHook}\r\n            serverError={serverError}\r\n            enablePostUsernameOverride={enablePostUsernameOverride}\r\n            enablePostIconOverride={enablePostIconOverride}\r\n        />\r\n    );\r\n};\r\n\r\nexport default AddOutgoingWebhook;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {createOutgoingHook} from 'mattermost-redux/actions/integrations';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport AddOutgoingWebhook from './add_outgoing_webhook';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const config = getConfig(state);\r\n    const enablePostUsernameOverride = config.EnablePostUsernameOverride === 'true';\r\n    const enablePostIconOverride = config.EnablePostIconOverride === 'true';\r\n    return {\r\n        enablePostUsernameOverride,\r\n        enablePostIconOverride,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            createOutgoingHook,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(AddOutgoingWebhook);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {Bot, BotPatch} from '@mattermost/types/bots';\r\n\r\nimport {BotTypes} from 'mattermost-redux/action_types';\r\nimport {Client4} from 'mattermost-redux/client';\r\n\r\nimport {bindClientFunc} from './helpers';\r\n\r\nconst BOTS_PER_PAGE_DEFAULT = 20;\r\n\r\nexport function createBot(bot: Partial<Bot>) {\r\n    return bindClientFunc({\r\n        clientFunc: Client4.createBot,\r\n        onSuccess: BotTypes.RECEIVED_BOT_ACCOUNT,\r\n        params: [\r\n            bot,\r\n        ],\r\n    });\r\n}\r\n\r\nexport function patchBot(botUserId: string, botPatch: Partial<BotPatch>) {\r\n    return bindClientFunc({\r\n        clientFunc: Client4.patchBot,\r\n        onSuccess: BotTypes.RECEIVED_BOT_ACCOUNT,\r\n        params: [\r\n            botUserId,\r\n            botPatch,\r\n        ],\r\n    });\r\n}\r\n\r\nexport function loadBot(botUserId: string) {\r\n    return bindClientFunc({\r\n        clientFunc: Client4.getBot,\r\n        onSuccess: BotTypes.RECEIVED_BOT_ACCOUNT,\r\n        params: [\r\n            botUserId,\r\n        ],\r\n    });\r\n}\r\n\r\nexport function loadBots(page = 0, perPage = BOTS_PER_PAGE_DEFAULT) {\r\n    return bindClientFunc({\r\n        clientFunc: Client4.getBotsIncludeDeleted,\r\n        onSuccess: BotTypes.RECEIVED_BOT_ACCOUNTS,\r\n        params: [\r\n            page,\r\n            perPage,\r\n        ],\r\n    });\r\n}\r\n\r\nexport function disableBot(botUserId: string) {\r\n    return bindClientFunc({\r\n        clientFunc: Client4.disableBot,\r\n        onSuccess: BotTypes.RECEIVED_BOT_ACCOUNT,\r\n        params: [\r\n            botUserId,\r\n        ],\r\n    });\r\n}\r\n\r\nexport function enableBot(botUserId: string) {\r\n    return bindClientFunc({\r\n        clientFunc: Client4.enableBot,\r\n        onSuccess: BotTypes.RECEIVED_BOT_ACCOUNT,\r\n        params: [\r\n            botUserId,\r\n        ],\r\n    });\r\n}\r\n\r\nexport function assignBot(botUserId: string, newOwnerId: string) {\r\n    return bindClientFunc({\r\n        clientFunc: Client4.assignBot,\r\n        onSuccess: BotTypes.RECEIVED_BOT_ACCOUNT,\r\n        params: [\r\n            botUserId,\r\n            newOwnerId,\r\n        ],\r\n    });\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useState} from 'react';\r\nimport type {ChangeEvent, ReactNode} from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport LoadingScreen from 'components/loading_screen';\r\nimport NextIcon from 'components/widgets/icons/fa_next_icon';\r\nimport PreviousIcon from 'components/widgets/icons/fa_previous_icon';\r\nimport SearchIcon from 'components/widgets/icons/fa_search_icon';\r\n\r\nimport './backstage_list.scss';\r\n\r\ntype Props = {\r\n    children?: JSX.Element[] | ((filter: string) => [JSX.Element[], boolean]);\r\n    header: ReactNode;\r\n    addLink?: string;\r\n    addText?: ReactNode;\r\n    addButtonId?: string;\r\n    emptyText?: ReactNode;\r\n    emptyTextSearch?: JSX.Element;\r\n    helpText?: ReactNode;\r\n    loading: boolean;\r\n    searchPlaceholder?: string;\r\n    nextPage?: () => void;\r\n    previousPage?: () => void;\r\n    page?: number;\r\n    pageSize?: number;\r\n    total?: number;\r\n};\r\n\r\nconst getPaging = (remainingProps: Props, childCount: number, hasFilter: boolean) => {\r\n    const page = (hasFilter || !remainingProps.page) ? 0 : remainingProps.page;\r\n    const pageSize = (hasFilter || !remainingProps.pageSize) ? childCount : remainingProps.pageSize;\r\n    const total = (hasFilter || !remainingProps.total) ? childCount : remainingProps.total;\r\n\r\n    let startCount = (page * pageSize) + 1;\r\n    let endCount = (page + 1) * pageSize;\r\n    endCount = endCount > total ? total : endCount;\r\n    if (endCount === 0) {\r\n        startCount = 0;\r\n    }\r\n\r\n    const isFirstPage = startCount <= 1;\r\n    const isLastPage = endCount >= total;\r\n\r\n    return {startCount, endCount, total, isFirstPage, isLastPage};\r\n};\r\n\r\nconst BackstageList = (remainingProps: Props) => {\r\n    const {formatMessage} = useIntl();\r\n\r\n    const [filter, setFilter] = useState('');\r\n    const updateFilter = (e: ChangeEvent<HTMLInputElement>) => setFilter(e.target.value);\r\n    const filterLowered = filter.toLowerCase();\r\n\r\n    let searchPlaceholder;\r\n    if (remainingProps.searchPlaceholder) {\r\n        searchPlaceholder = remainingProps.searchPlaceholder;\r\n    } else {\r\n        searchPlaceholder = formatMessage({id: 'backstage_list.search', defaultMessage: 'Search'});\r\n    }\r\n\r\n    let children = [];\r\n    let childCount = 0;\r\n    if (remainingProps.loading) {\r\n        children = [\r\n            <LoadingScreen\r\n                key='loading'\r\n            />,\r\n        ];\r\n    } else {\r\n        let hasChildren = true;\r\n        if (typeof remainingProps.children === 'function') {\r\n            [children, hasChildren] = remainingProps.children(filterLowered);\r\n        } else {\r\n            children = remainingProps.children as JSX.Element[];\r\n        }\r\n        children = React.Children.map(children, (child) => {\r\n            return React.cloneElement(child, {filterLowered});\r\n        });\r\n        if (children.length === 0 || !hasChildren) {\r\n            if (!filterLowered) {\r\n                if (remainingProps.emptyText) {\r\n                    children = [(\r\n                        <div\r\n                            className='backstage-list__item backstage-list__empty'\r\n                            key='emptyText'\r\n                        >\r\n                            {remainingProps.emptyText}\r\n                        </div>\r\n                    )];\r\n                }\r\n            } else if (remainingProps.emptyTextSearch) {\r\n                children = [(\r\n                    <div\r\n                        className='backstage-list__item backstage-list__empty'\r\n                        id='emptySearchResultsMessage'\r\n                        key='emptyTextSearch'\r\n                    >\r\n                        {React.cloneElement(remainingProps.emptyTextSearch, {values: {...remainingProps.emptyTextSearch.props.values, searchTerm: filterLowered}})}\r\n                    </div>\r\n                )];\r\n            }\r\n        } else {\r\n            childCount = children.length;\r\n        }\r\n    }\r\n\r\n    let addLink = null;\r\n\r\n    if (remainingProps.addLink && remainingProps.addText) {\r\n        addLink = (\r\n            <Link\r\n                className='add-link'\r\n                to={remainingProps.addLink}\r\n            >\r\n                <button\r\n                    type='button'\r\n                    className='btn btn-primary'\r\n                    id={remainingProps.addButtonId}\r\n                >\r\n                    <span>\r\n                        {remainingProps.addText}\r\n                    </span>\r\n                </button>\r\n            </Link>\r\n        );\r\n    }\r\n\r\n    const hasFilter = filter.length > 0;\r\n    const {startCount, endCount, total, isFirstPage, isLastPage} = getPaging(remainingProps, childCount, hasFilter);\r\n    const childrenToDisplay = childCount > 0 ? children.slice(startCount - 1, endCount) : children;\r\n\r\n    let previousPageFn = remainingProps.previousPage;\r\n    let nextPageFn = remainingProps.nextPage;\r\n    if (isFirstPage) {\r\n        previousPageFn = () => {};\r\n    }\r\n    if (isLastPage) {\r\n        nextPageFn = () => {};\r\n    }\r\n\r\n    return (\r\n        <div className='backstage-content'>\r\n            <div className='backstage-header'>\r\n                <h1>\r\n                    {remainingProps.header}\r\n                </h1>\r\n                {addLink}\r\n            </div>\r\n            <div className='backstage-filters'>\r\n                <div className='backstage-filter__search'>\r\n                    <SearchIcon/>\r\n                    <input\r\n                        type='search'\r\n                        className='form-control'\r\n                        placeholder={searchPlaceholder}\r\n                        value={filter}\r\n                        onChange={updateFilter}\r\n                        id='searchInput'\r\n                    />\r\n                </div>\r\n            </div>\r\n            <span className='backstage-list__help'>\r\n                {remainingProps.helpText}\r\n            </span>\r\n            <div className='backstage-list'>\r\n                {childrenToDisplay}\r\n            </div>\r\n            <div className='backstage-footer'>\r\n                <div className='backstage-footer__cell'>\r\n                    <FormattedMessage\r\n                        id='backstage_list.paginatorCount'\r\n                        defaultMessage='{startCount, number} - {endCount, number} of {total, number}'\r\n                        values={{\r\n                            startCount,\r\n                            endCount,\r\n                            total,\r\n                        }}\r\n                    />\r\n                    <button\r\n                        type='button'\r\n                        className={'btn btn-quaternary btn-icon btn-sm ml-2 prev ' + (isFirstPage ? 'disabled' : '')}\r\n                        onClick={previousPageFn}\r\n                        aria-label={formatMessage({id: 'backstage_list.previousButton.ariaLabel', defaultMessage: 'Previous'})}\r\n                    >\r\n                        <PreviousIcon/>\r\n                    </button>\r\n                    <button\r\n                        type='button'\r\n                        className={'btn btn-quaternary btn-icon btn-sm next ' + (isLastPage ? 'disabled' : '')}\r\n                        onClick={nextPageFn}\r\n                        aria-label={formatMessage({id: 'backstage_list.nextButton.ariaLabel', defaultMessage: 'Next'})}\r\n                    >\r\n                        <NextIcon/>\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default BackstageList;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport type {ChangeEvent, SyntheticEvent, ReactNode} from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport type {Bot as BotType} from '@mattermost/types/bots';\r\nimport type {Team} from '@mattermost/types/teams';\r\nimport type {UserProfile, UserAccessToken} from '@mattermost/types/users';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport ConfirmModal from 'components/confirm_modal';\r\nimport Markdown from 'components/markdown';\r\nimport SaveButton from 'components/save_button';\r\nimport WarningIcon from 'components/widgets/icons/fa_warning_icon';\r\n\r\nimport * as Utils from 'utils/utils';\r\n\r\nexport function matchesFilter(bot: BotType, filter?: string, owner?: UserProfile): boolean {\r\n    if (!filter) {\r\n        return true;\r\n    }\r\n    const username = bot.username || '';\r\n    const description = bot.description || '';\r\n    const displayName = bot.display_name || '';\r\n\r\n    let ownerUsername = 'plugin';\r\n    if (owner && owner.username) {\r\n        ownerUsername = owner.username;\r\n    }\r\n    return !(username.toLowerCase().indexOf(filter) === -1 &&\r\n        displayName.toLowerCase().indexOf(filter) === -1 &&\r\n        description.toLowerCase().indexOf(filter) === -1 &&\r\n        ownerUsername.toLowerCase().indexOf(filter) === -1);\r\n}\r\n\r\ntype Props = {\r\n\r\n    /**\r\n    *  Bot that we are displaying\r\n    */\r\n    bot: BotType;\r\n\r\n    /**\r\n    * Owner of the bot we are displaying\r\n    */\r\n    owner?: UserProfile;\r\n\r\n    /**\r\n    * User of the bot we are displaying\r\n    */\r\n    user: UserProfile;\r\n\r\n    /**\r\n    * The access tokens of the bot user\r\n    */\r\n    accessTokens: Record<string, UserAccessToken>;\r\n\r\n    /**\r\n    * String used for filtering bot items\r\n    */\r\n    filter?: string;\r\n\r\n    /**\r\n     * Determine whether this bot is managed by the app framework\r\n     */\r\n    fromApp: boolean;\r\n\r\n    actions: {\r\n\r\n        /**\r\n        * Disable a bot\r\n        */\r\n        disableBot: (userId: string) => Promise<ActionResult>;\r\n\r\n        /**\r\n        * Enable a bot\r\n        */\r\n        enableBot: (userId: string) => Promise<ActionResult>;\r\n\r\n        /**\r\n        * Access token managment\r\n        */\r\n        createUserAccessToken: (userId: string, description: string) => Promise<ActionResult<UserAccessToken>>;\r\n\r\n        revokeUserAccessToken: (tokenId: string) => Promise<ActionResult>;\r\n        enableUserAccessToken: (tokenId: string) => Promise<ActionResult>;\r\n        disableUserAccessToken: (tokenId: string) => Promise<ActionResult>;\r\n    };\r\n\r\n    /**\r\n    *  Only used for routing since backstage is team based.\r\n    */\r\n    team: Team;\r\n}\r\n\r\ntype State = {\r\n    confirmingId: string;\r\n    creatingTokenState: string;\r\n    token: UserAccessToken | Record<string, any>;\r\n    error: ReactNode;\r\n}\r\n\r\nexport default class Bot extends React.PureComponent<Props, State> {\r\n    public constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            confirmingId: '',\r\n            creatingTokenState: 'CLOSED',\r\n            token: {},\r\n            error: '',\r\n        };\r\n    }\r\n\r\n    enableBot = (): void => {\r\n        this.props.actions.enableBot(this.props.bot.user_id);\r\n    };\r\n\r\n    disableBot = (): void => {\r\n        this.props.actions.disableBot(this.props.bot.user_id);\r\n    };\r\n\r\n    enableUserAccessToken = (id: string): void => {\r\n        this.props.actions.enableUserAccessToken(id);\r\n    };\r\n\r\n    disableUserAccessToken = (id: string): void => {\r\n        this.props.actions.disableUserAccessToken(id);\r\n    };\r\n\r\n    confirmRevokeToken = (id: string): void => {\r\n        this.setState({confirmingId: id});\r\n    };\r\n\r\n    revokeTokenConfirmed = (): void => {\r\n        this.props.actions.revokeUserAccessToken(this.state.confirmingId);\r\n        this.closeConfirm();\r\n    };\r\n\r\n    closeConfirm = (): void => {\r\n        this.setState({confirmingId: ''});\r\n    };\r\n\r\n    openCreateToken = (): void => {\r\n        this.setState({\r\n            creatingTokenState: 'OPEN',\r\n            token: {\r\n                description: '',\r\n            },\r\n        });\r\n    };\r\n\r\n    closeCreateToken = (): void => {\r\n        this.setState({\r\n            creatingTokenState: 'CLOSED',\r\n            token: {\r\n                description: '',\r\n            },\r\n        });\r\n    };\r\n\r\n    handleUpdateDescription = (e: ChangeEvent<HTMLInputElement>): void => {\r\n        const target = e.target as HTMLInputElement;\r\n        this.setState({\r\n            token: Object.assign({}, this.state.token, {description: target.value}),\r\n        });\r\n    };\r\n\r\n    handleCreateToken = async (e: SyntheticEvent): Promise<void> => {\r\n        e.preventDefault();\r\n\r\n        if (this.state.token.description === '') {\r\n            this.setState({error: (\r\n                <FormattedMessage\r\n                    id='bot.token.error.description'\r\n                    defaultMessage='Please enter a description.'\r\n                />\r\n            )});\r\n            return;\r\n        }\r\n\r\n        const {data, error} = await this.props.actions.createUserAccessToken(this.props.bot.user_id, this.state.token.description);\r\n        if (data) {\r\n            this.setState({creatingTokenState: 'CREATED', token: data});\r\n        } else if (error) {\r\n            this.setState({error: error.message});\r\n        }\r\n    };\r\n\r\n    public render(): JSX.Element | null {\r\n        const username = this.props.bot.username || '';\r\n        const description = this.props.bot.description || '';\r\n        const displayName = this.props.bot.display_name || '';\r\n\r\n        let ownerUsername = 'plugin';\r\n        if (this.props.fromApp) {\r\n            ownerUsername = 'Apps Framework';\r\n        } else if (this.props.owner && this.props.owner.username) {\r\n            ownerUsername = this.props.owner.username;\r\n        }\r\n        const filter = this.props.filter ? this.props.filter.toLowerCase() : '';\r\n        if (!matchesFilter(this.props.bot, filter, this.props.owner)) {\r\n            return null;\r\n        }\r\n\r\n        const tokenList = [];\r\n        Object.values(this.props.accessTokens).forEach((token) => {\r\n            let activeLink;\r\n            let disableClass = '';\r\n            let disabledText;\r\n\r\n            if (token.is_active) {\r\n                activeLink = (\r\n                    <a\r\n                        id={token.id + '_deactivate'}\r\n                        href='#'\r\n                        onClick={(e) => {\r\n                            e.preventDefault();\r\n                            this.disableUserAccessToken(token.id);\r\n                        }}\r\n                    >\r\n                        <FormattedMessage\r\n                            id='user.settings.tokens.deactivate'\r\n                            defaultMessage='Disable'\r\n                        />\r\n                    </a>);\r\n            } else {\r\n                disableClass = 'light';\r\n                disabledText = (\r\n                    <span className='mr-2 light'>\r\n                        <FormattedMessage\r\n                            id='user.settings.tokens.deactivatedWarning'\r\n                            defaultMessage='(Disabled)'\r\n                        />\r\n                    </span>\r\n                );\r\n                activeLink = (\r\n                    <a\r\n                        id={token.id + '_activate'}\r\n                        href='#'\r\n                        onClick={(e) => {\r\n                            e.preventDefault();\r\n                            this.enableUserAccessToken(token.id);\r\n                        }}\r\n                    >\r\n                        <FormattedMessage\r\n                            id='user.settings.tokens.activate'\r\n                            defaultMessage='Enable'\r\n                        />\r\n                    </a>\r\n                );\r\n            }\r\n\r\n            tokenList.push(\r\n                <div\r\n                    key={token.id}\r\n                    className='bot-list__item'\r\n                >\r\n                    <div className='item-details__row d-flex justify-content-between'>\r\n                        <div className={disableClass}>\r\n                            <div className='whitespace--nowrap overflow--ellipsis'>\r\n                                <b>\r\n                                    <FormattedMessage\r\n                                        id='user.settings.tokens.tokenDesc'\r\n                                        defaultMessage='Token Description: '\r\n                                    />\r\n                                </b>\r\n                                {token.description}\r\n                            </div>\r\n                            <div className='setting-box__token-id whitespace--nowrap overflow--ellipsis'>\r\n                                <b>\r\n                                    <FormattedMessage\r\n                                        id='user.settings.tokens.tokenId'\r\n                                        defaultMessage='Token ID: '\r\n                                    />\r\n                                </b>\r\n                                {token.id}\r\n                            </div>\r\n                        </div>\r\n                        <div>\r\n                            {disabledText}\r\n                            {activeLink}\r\n                            {' - '}\r\n                            <a\r\n                                id={token.id + '_delete'}\r\n                                href='#'\r\n                                onClick={(e) => {\r\n                                    e.preventDefault();\r\n                                    this.confirmRevokeToken(token.id);\r\n                                }}\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='user.settings.tokens.delete'\r\n                                    defaultMessage='Delete'\r\n                                />\r\n                            </a>\r\n                        </div>\r\n                    </div>\r\n                </div>,\r\n            );\r\n        });\r\n\r\n        let options;\r\n        if (ownerUsername !== 'plugin') {\r\n            options = (\r\n                <div className='item-actions'>\r\n                    <button\r\n                        id='createToken'\r\n                        className='style--none color--link'\r\n                        onClick={this.openCreateToken}\r\n                    >\r\n                        <FormattedMessage\r\n                            id='bot.manage.create_token'\r\n                            defaultMessage='Create New Token'\r\n                        />\r\n                    </button>\r\n                    {' - '}\r\n                    <Link to={`/${this.props.team.name}/integrations/bots/edit?id=${this.props.bot.user_id}`}>\r\n                        <FormattedMessage\r\n                            id='bots.manage.edit'\r\n                            defaultMessage='Edit'\r\n                        />\r\n                    </Link>\r\n                    {' - '}\r\n                    <button\r\n                        className='style--none color--link'\r\n                        onClick={this.disableBot}\r\n                    >\r\n                        <FormattedMessage\r\n                            id='bot.manage.disable'\r\n                            defaultMessage='Disable'\r\n                        />\r\n                    </button>\r\n                </div>\r\n            );\r\n        }\r\n        if (this.props.bot.delete_at !== 0) {\r\n            options = (\r\n                <div className='item-actions'>\r\n                    <button\r\n                        className='style--none color--link'\r\n                        onClick={this.enableBot}\r\n                    >\r\n                        <FormattedMessage\r\n                            id='bot.manage.enable'\r\n                            defaultMessage='Enable'\r\n                        />\r\n                    </button>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        if (this.state.creatingTokenState === 'OPEN') {\r\n            tokenList.push(\r\n                <div\r\n                    key={'create'}\r\n                    className='bot-list__item'\r\n                >\r\n                    <div key={'create'}>\r\n                        <form\r\n                            className='form-horizontal'\r\n                            onSubmit={this.handleCreateToken}\r\n                        >\r\n                            <div className='row'>\r\n                                <label\r\n                                    className='col-sm-auto control-label'\r\n                                    htmlFor='botToken'\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='user.settings.tokens.name'\r\n                                        defaultMessage='Token Description: '\r\n                                    />\r\n                                </label>\r\n                                <div className='col-sm-4'>\r\n                                    <input\r\n                                        id='botToken'\r\n                                        autoFocus={true}\r\n                                        className='form-control form-sm'\r\n                                        type='text'\r\n                                        maxLength={64}\r\n                                        value={this.state.token.description}\r\n                                        onChange={this.handleUpdateDescription}\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                            <div>\r\n                                <div className='pt-2 pb-2'>\r\n                                    <FormattedMessage\r\n                                        id='user.settings.tokens.nameHelp'\r\n                                        defaultMessage='Enter a description for your token to remember what it does.'\r\n                                    />\r\n                                </div>\r\n                                <label\r\n                                    id='clientError'\r\n                                    className='has-error is-empty'\r\n                                >\r\n                                    {this.state.error}\r\n                                </label>\r\n                                <div className='mt-2'>\r\n                                    <SaveButton\r\n                                        btnClass='btn-sm btn-primary'\r\n                                        savingMessage={\r\n                                            <FormattedMessage\r\n                                                id='user.settings.tokens.save'\r\n                                                defaultMessage='Save'\r\n                                            />\r\n                                        }\r\n                                        saving={false}\r\n                                    />\r\n                                    <button\r\n                                        className='btn btn-sm btn-tertiary'\r\n                                        onClick={this.closeCreateToken}\r\n                                    >\r\n                                        <FormattedMessage\r\n                                            id='user.settings.tokens.cancel'\r\n                                            defaultMessage='Cancel'\r\n                                        />\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        </form>\r\n                    </div>\r\n                </div>,\r\n            );\r\n        } else if (this.state.creatingTokenState === 'CREATED') {\r\n            tokenList.push(\r\n                <div\r\n                    key={'created'}\r\n                    className='bot-list__item alert alert-warning'\r\n                >\r\n                    <div className='mb-2'>\r\n                        <WarningIcon additionalClassName='mr-2'/>\r\n                        <FormattedMessage\r\n                            id='user.settings.tokens.copy'\r\n                            defaultMessage=\"Please copy the access token below. You won't be able to see it again!\"\r\n                        />\r\n                    </div>\r\n                    <div className='whitespace--nowrap overflow--ellipsis'>\r\n                        <FormattedMessage\r\n                            id='user.settings.tokens.name'\r\n                            defaultMessage='Token Description: '\r\n                        />\r\n                        {this.state.token.description}\r\n                    </div>\r\n                    <div className='whitespace--nowrap overflow--ellipsis'>\r\n                        <FormattedMessage\r\n                            id='user.settings.tokens.id'\r\n                            defaultMessage='Token ID: '\r\n                        />\r\n                        {this.state.token.id}\r\n                    </div>\r\n                    <strong className='word-break--all'>\r\n                        <FormattedMessage\r\n                            id='user.settings.tokens.token'\r\n                            defaultMessage='Access Token: '\r\n                        />\r\n                        {this.state.token.token}\r\n                    </strong>\r\n                    <div className='mt-2'>\r\n                        <button\r\n                            className='btn btn-sm btn-primary'\r\n                            onClick={this.closeCreateToken}\r\n                        >\r\n                            <FormattedMessage\r\n                                id='bot.create_token.close'\r\n                                defaultMessage='Close'\r\n                            />\r\n                        </button>\r\n                    </div>\r\n                </div>,\r\n            );\r\n        }\r\n\r\n        const imageURL = Utils.imageURLForUser(this.props.user.id, this.props.user.last_picture_update);\r\n\r\n        return (\r\n            <div className='backstage-list__item'>\r\n                <div className={'bot-list-img-container'}>\r\n                    <img\r\n                        className={'bot-list-img'}\r\n                        alt={'bot image'}\r\n                        src={imageURL}\r\n                    />\r\n                </div>\r\n                <div className='item-details'>\r\n                    <div className='item-details__row d-flex flex-column flex-md-row justify-content-between'>\r\n                        <strong className='item-details__name'>\r\n                            {displayName + ' (@' + username + ')'}\r\n                        </strong>\r\n                        {options}\r\n                    </div>\r\n                    <div className='bot-details__description'>\r\n                        <Markdown message={description}/>\r\n                    </div>\r\n                    <div className='light small'>\r\n                        <FormattedMessage\r\n                            id='bots.managed_by'\r\n                            defaultMessage='Managed by '\r\n                        />\r\n                        {ownerUsername}\r\n                    </div>\r\n                    <div className='bot-list is-empty'>\r\n                        {tokenList}\r\n                    </div>\r\n                </div>\r\n                <ConfirmModal\r\n                    title={\r\n                        <FormattedMessage\r\n                            id='bots.token.delete'\r\n                            defaultMessage='Delete Token'\r\n                        />\r\n                    }\r\n                    message={\r\n                        <FormattedMessage\r\n                            id='bots.token.confirm_text'\r\n                            defaultMessage='Are you sure you want to delete the token?'\r\n                        />\r\n                    }\r\n                    confirmButtonText={\r\n                        <FormattedMessage\r\n                            id='bots.token.confirm'\r\n                            defaultMessage='Delete'\r\n                        />\r\n                    }\r\n                    modalClass='integrations-backstage-modal'\r\n                    show={this.state.confirmingId !== ''}\r\n                    onConfirm={this.revokeTokenConfirmed}\r\n                    onCancel={this.closeConfirm}\r\n                />\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport type {Bot as BotType} from '@mattermost/types/bots';\r\nimport type {Team} from '@mattermost/types/teams';\r\nimport type {UserProfile, UserAccessToken} from '@mattermost/types/users';\r\nimport type {RelationOneToOne} from '@mattermost/types/utilities';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport BackstageList from 'components/backstage/components/backstage_list';\r\nimport ExternalLink from 'components/external_link';\r\n\r\nimport Constants from 'utils/constants';\r\nimport * as Utils from 'utils/utils';\r\n\r\nimport Bot, {matchesFilter} from './bot';\r\n\r\ntype Props = {\r\n\r\n    /**\r\n    *  Map from botUserId to bot.\r\n    */\r\n    bots: Record<string, BotType>;\r\n\r\n    /**\r\n     * List of bot IDs managed by the app framework\r\n     */\r\n    appsBotIDs: string[];\r\n\r\n    /**\r\n     * Whether apps framework is enabled\r\n     */\r\n    appsEnabled: boolean;\r\n\r\n    /**\r\n    *  Map from botUserId to accessTokens.\r\n    */\r\n    accessTokens?: RelationOneToOne<UserProfile, Record<string, UserAccessToken>>;\r\n\r\n    /**\r\n    *  Map from botUserId to owner.\r\n    */\r\n    owners: Record<string, UserProfile>;\r\n\r\n    /**\r\n    *  Map from botUserId to user.\r\n    */\r\n    users: Record<string, UserProfile>;\r\n    createBots?: boolean;\r\n\r\n    actions: {\r\n\r\n        /**\r\n         * Ensure we have bot accounts\r\n         */\r\n        loadBots: (page?: number, perPage?: number) => Promise<ActionResult<BotType[]>>;\r\n\r\n        /**\r\n        * Load access tokens for bot accounts\r\n        */\r\n        getUserAccessTokensForUser: (userId: string, page?: number, perPage?: number) => void;\r\n\r\n        /**\r\n        * Access token managment\r\n        */\r\n        createUserAccessToken: (userId: string, description: string) => Promise<ActionResult<UserAccessToken>>;\r\n\r\n        revokeUserAccessToken: (tokenId: string) => Promise<ActionResult>;\r\n        enableUserAccessToken: (tokenId: string) => Promise<ActionResult>;\r\n        disableUserAccessToken: (tokenId: string) => Promise<ActionResult>;\r\n\r\n        /**\r\n        * Load owner of bot account\r\n        */\r\n        getUser: (userId: string) => void;\r\n\r\n        /**\r\n        * Disable a bot\r\n        */\r\n        disableBot: (userId: string) => Promise<ActionResult>;\r\n\r\n        /**\r\n        * Enable a bot\r\n        */\r\n        enableBot: (userId: string) => Promise<ActionResult>;\r\n\r\n        /**\r\n         * Load bot IDs managed by the apps\r\n         */\r\n        fetchAppsBotIDs: () => Promise<ActionResult>;\r\n    };\r\n\r\n    /**\r\n    *  Only used for routing since backstage is team based.\r\n    */\r\n    team: Team;\r\n}\r\n\r\ntype State = {\r\n    loading: boolean;\r\n}\r\n\r\nexport default class Bots extends React.PureComponent<Props, State> {\r\n    public constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            loading: true,\r\n        };\r\n    }\r\n\r\n    public componentDidMount(): void {\r\n        this.props.actions.loadBots(\r\n            Constants.Integrations.START_PAGE_NUM,\r\n            Constants.Integrations.PAGE_SIZE,\r\n        ).then(\r\n            (result) => {\r\n                if (result.data) {\r\n                    const promises = [];\r\n\r\n                    for (const bot of result.data) {\r\n                        // We don't need to wait for this and we need to accept failure in the case where bot.owner_id is a plugin id\r\n                        this.props.actions.getUser(bot.owner_id);\r\n\r\n                        // We want to wait for these.\r\n                        promises.push(this.props.actions.getUser(bot.user_id));\r\n                        promises.push(this.props.actions.getUserAccessTokensForUser(bot.user_id));\r\n                    }\r\n\r\n                    Promise.all(promises).then(() => {\r\n                        this.setState({loading: false});\r\n                    });\r\n                }\r\n            },\r\n        );\r\n        if (this.props.appsEnabled) {\r\n            this.props.actions.fetchAppsBotIDs();\r\n        }\r\n    }\r\n\r\n    DisabledSection(props: {hasDisabled: boolean; disabledBots: JSX.Element[]; filter?: string}): JSX.Element | null {\r\n        if (!props.hasDisabled) {\r\n            return null;\r\n        }\r\n        const botsToDisplay = React.Children.map(props.disabledBots, (child) => {\r\n            return React.cloneElement(child, {filter: props.filter});\r\n        });\r\n        return (\r\n            <>\r\n                <div className='bot-disabled'>\r\n                    <FormattedMessage\r\n                        id='bots.disabled'\r\n                        defaultMessage='Disabled'\r\n                    />\r\n                </div>\r\n                <div className='bot-list__disabled'>\r\n                    {botsToDisplay}\r\n                </div>\r\n            </>\r\n        );\r\n    }\r\n\r\n    EnabledSection(props: {enabledBots: JSX.Element[]; filter?: string}): JSX.Element {\r\n        const botsToDisplay = React.Children.map(props.enabledBots, (child) => {\r\n            return React.cloneElement(child, {filter: props.filter});\r\n        });\r\n        return (\r\n            <div>\r\n                {botsToDisplay}\r\n            </div>\r\n        );\r\n    }\r\n\r\n    botToJSX = (bot: BotType): JSX.Element => {\r\n        return (\r\n            <Bot\r\n                key={bot.user_id}\r\n                bot={bot}\r\n                owner={this.props.owners[bot.user_id]}\r\n                user={this.props.users[bot.user_id]}\r\n                accessTokens={(this.props.accessTokens && this.props.accessTokens[bot.user_id]) || {}}\r\n                actions={this.props.actions}\r\n                team={this.props.team}\r\n                fromApp={this.props.appsBotIDs.includes(bot.user_id)}\r\n            />\r\n        );\r\n    };\r\n\r\n    bots = (filter?: string): [JSX.Element[], boolean] => {\r\n        const bots = Object.values(this.props.bots).sort((a, b) => a.username.localeCompare(b.username));\r\n        const match = (bot: BotType) => matchesFilter(bot, filter, this.props.owners[bot.user_id]);\r\n        const enabledBots = bots.filter((bot) => bot.delete_at === 0).filter(match).map(this.botToJSX);\r\n        const disabledBots = bots.filter((bot) => bot.delete_at > 0).filter(match).map(this.botToJSX);\r\n        const sections = [(\r\n            <div key='sections'>\r\n                <this.EnabledSection\r\n                    enabledBots={enabledBots}\r\n                />\r\n                <this.DisabledSection\r\n                    hasDisabled={disabledBots.length > 0}\r\n                    disabledBots={disabledBots}\r\n                />\r\n            </div>\r\n        )];\r\n\r\n        return [sections, enabledBots.length > 0 || disabledBots.length > 0];\r\n    };\r\n\r\n    public render(): JSX.Element {\r\n        return (\r\n            <BackstageList\r\n                header={\r\n                    <FormattedMessage\r\n                        id='bots.manage.header'\r\n                        defaultMessage='Bot Accounts'\r\n                    />\r\n                }\r\n                addText={this.props.createBots &&\r\n                    <FormattedMessage\r\n                        id='bots.manage.add'\r\n                        defaultMessage='Add Bot Account'\r\n                    />\r\n                }\r\n                addLink={'/' + this.props.team.name + '/integrations/bots/add'}\r\n                addButtonId='addBotAccount'\r\n                emptyText={\r\n                    <FormattedMessage\r\n                        id='bots.manage.empty'\r\n                        defaultMessage='No bot accounts found'\r\n                    />\r\n                }\r\n                emptyTextSearch={\r\n                    <FormattedMessage\r\n                        id='bots.emptySearch'\r\n                        defaultMessage='No bot accounts match <b>{searchTerm}</b>'\r\n                        values={{\r\n                            b: (chunks) => <b>{chunks}</b>,\r\n                        }}\r\n                    />\r\n                }\r\n                helpText={\r\n                    <>\r\n                        <FormattedMessage\r\n                            id='bots.manage.help1'\r\n                            defaultMessage='Use {botAccounts} to integrate with Mattermost through plugins or the API. Bot accounts are available to everyone on your server. '\r\n                            values={{\r\n                                botAccounts: (\r\n                                    <ExternalLink\r\n                                        href='https://mattermost.com/pl/default-bot-accounts'\r\n                                        location='bots'\r\n                                    >\r\n                                        <FormattedMessage\r\n                                            id='bots.manage.bot_accounts'\r\n                                            defaultMessage='Bot Accounts'\r\n                                        />\r\n                                    </ExternalLink>\r\n                                ),\r\n                            }}\r\n                        />\r\n                        <FormattedMessage\r\n                            id='bots.help2'\r\n                            defaultMessage={'Enable bot account creation in the <a>System Console</a>.'}\r\n                            values={{\r\n                                a: (chunks) => <Link to='/admin_console/integrations/bot_accounts'>{chunks}</Link>,\r\n                            }}\r\n                        />\r\n                    </>\r\n                }\r\n                searchPlaceholder={Utils.localizeMessage({id: 'bots.manage.search', defaultMessage: 'Search Bot Accounts'})}\r\n                loading={this.state.loading}\r\n            >\r\n                {this.bots}\r\n            </BackstageList>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {Bot as BotType} from '@mattermost/types/bots';\r\nimport type {GlobalState} from '@mattermost/types/store';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\n\r\nimport {loadBots, disableBot, enableBot} from 'mattermost-redux/actions/bots';\r\nimport {getAppsBotIDs as fetchAppsBotIDs} from 'mattermost-redux/actions/integrations';\r\nimport {createUserAccessToken, revokeUserAccessToken, enableUserAccessToken, disableUserAccessToken, getUserAccessTokensForUser, getUser} from 'mattermost-redux/actions/users';\r\nimport {appsEnabled} from 'mattermost-redux/selectors/entities/apps';\r\nimport {getExternalBotAccounts} from 'mattermost-redux/selectors/entities/bots';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {getAppsBotIDs} from 'mattermost-redux/selectors/entities/integrations';\r\nimport * as UserSelectors from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport Bots from './bots';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const config = getConfig(state);\r\n    const createBots = config.EnableBotAccountCreation === 'true';\r\n    const bots = getExternalBotAccounts(state);\r\n    const botValues = Object.values(bots);\r\n    const owners = botValues.\r\n        reduce((result: Record<string, UserProfile>, bot: BotType) => {\r\n            result[bot.user_id] = UserSelectors.getUser(state, bot.owner_id);\r\n            return result;\r\n        }, {});\r\n    const users = botValues.\r\n        reduce((result: Record<string, UserProfile>, bot: BotType) => {\r\n            result[bot.user_id] = UserSelectors.getUser(state, bot.user_id);\r\n            return result;\r\n        }, {});\r\n\r\n    return {\r\n        createBots,\r\n        bots,\r\n        accessTokens: state.entities.admin.userAccessTokensByUser,\r\n        owners,\r\n        users,\r\n        appsBotIDs: getAppsBotIDs(state),\r\n        appsEnabled: appsEnabled(state),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            fetchAppsBotIDs,\r\n            loadBots,\r\n            getUserAccessTokensForUser,\r\n            createUserAccessToken,\r\n            revokeUserAccessToken,\r\n            enableUserAccessToken,\r\n            disableUserAccessToken,\r\n            getUser,\r\n            disableBot,\r\n            enableBot,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Bots);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport type {ChangeEvent, FormEvent} from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport type {Bot, BotPatch} from '@mattermost/types/bots';\r\nimport type {Team} from '@mattermost/types/teams';\r\nimport type {UserAccessToken, UserProfile} from '@mattermost/types/users';\r\n\r\nimport {General} from 'mattermost-redux/constants';\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\nimport * as UserUtils from 'mattermost-redux/utils/user_utils';\r\n\r\nimport BackstageHeader from 'components/backstage/components/backstage_header';\r\nimport ExternalLink from 'components/external_link';\r\nimport FormError from 'components/form_error';\r\nimport SpinnerButton from 'components/spinner_button';\r\nimport WithTooltip from 'components/with_tooltip';\r\n\r\nimport BotDefaultIcon from 'images/bot_default_icon.png';\r\nimport {getHistory} from 'utils/browser_history';\r\nimport {AcceptedProfileImageTypes, Constants, DeveloperLinks, ValidationErrors} from 'utils/constants';\r\nimport * as FileUtils from 'utils/file_utils';\r\nimport * as Utils from 'utils/utils';\r\n\r\nconst roleOptionSystemAdmin = 'System Admin';\r\nconst roleOptionMember = 'Member';\r\n\r\nexport type Props = {\r\n\r\n    /**\r\n     *  Only used for routing since backstage is team based.\r\n     */\r\n    team: Team;\r\n\r\n    /**\r\n     *  Bot to edit (if editing)\r\n     */\r\n    bot?: Bot;\r\n\r\n    /**\r\n     *  Bot user\r\n     */\r\n    user?: UserProfile;\r\n\r\n    /**\r\n     *  Roles of the bot to edit (if editing)\r\n     */\r\n    roles?: string;\r\n\r\n    /**\r\n     * Maximum upload file size (for bot account profile picture)\r\n     */\r\n    maxFileSize: number;\r\n\r\n    /**\r\n     * Editing user has the MANAGE_SYSTEM permission\r\n     */\r\n    editingUserHasManageSystem: boolean;\r\n\r\n    /**\r\n     * Bot to edit\r\n     */\r\n    actions: {\r\n\r\n        /**\r\n         * Creates a new bot account.\r\n         */\r\n        createBot: (bot: Partial<Bot>) => Promise<ActionResult<Bot>>;\r\n\r\n        /**\r\n         * Patches an existing bot account.\r\n         */\r\n        patchBot: (botUserId: string, botPatch: Partial<BotPatch>) => Promise<ActionResult<Bot>>;\r\n\r\n        /**\r\n         * Uploads a user profile image\r\n         */\r\n        uploadProfileImage: (userId: string, image: File | string) => Promise<ActionResult>;\r\n\r\n        /**\r\n         * Set profile image to default\r\n         */\r\n        setDefaultProfileImage: (userId: string) => Promise<ActionResult>;\r\n\r\n        /**\r\n         * For creating default access token\r\n         */\r\n        createUserAccessToken: (userId: string, description: string) => Promise<ActionResult<UserAccessToken>>;\r\n\r\n        /**\r\n         * For creating setting bot to system admin or special posting permissions\r\n         */\r\n        updateUserRoles: (userId: string, roles: string) => Promise<ActionResult>;\r\n    };\r\n};\r\n\r\nexport type State = {\r\n    username: string;\r\n    displayName: string | undefined;\r\n    description: string | undefined;\r\n    role: string;\r\n    postAll: boolean;\r\n    postChannels: boolean;\r\n    error: JSX.Element | string;\r\n    adding: boolean;\r\n    image: string;\r\n    orientationStyles: { transform: string; transformOrigin: string };\r\n    pictureFile: File | null | string;\r\n};\r\n\r\nexport default class AddBot extends React.PureComponent<Props, State> {\r\n    previewBlob: string | null = null;\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            error: '',\r\n            username: this.props.bot ? this.props.bot.username : '',\r\n            displayName: this.props.bot ? this.props.bot.display_name : '',\r\n            description: this.props.bot ? this.props.bot.description : '',\r\n            adding: false,\r\n            image: BotDefaultIcon,\r\n            role: UserUtils.isSystemAdmin(this.props.roles || '') ? roleOptionSystemAdmin : roleOptionMember,\r\n            postAll: this.props.bot ? UserUtils.hasPostAllRole(this.props.roles || '') : false,\r\n            postChannels: this.props.bot ? UserUtils.hasPostAllPublicRole(this.props.roles || '') : false,\r\n            orientationStyles: {transform: '', transformOrigin: ''},\r\n            pictureFile: null,\r\n        };\r\n    }\r\n\r\n    updateUsername = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            username: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateDisplayName = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            displayName: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateDescription = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            description: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateRole = (e: ChangeEvent<HTMLSelectElement>) => {\r\n        this.setState({\r\n            role: e.target.value,\r\n        });\r\n    };\r\n\r\n    updatePostAll = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            postAll: e.target.checked,\r\n        });\r\n    };\r\n\r\n    updatePostChannels = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            postChannels: e.target.checked,\r\n        });\r\n    };\r\n\r\n    updatePicture = (e: ChangeEvent<HTMLInputElement>) => {\r\n        if (e.target.files && e.target.files[0]) {\r\n            const pictureFile = e.target.files[0];\r\n            this.previewBlob = URL.createObjectURL(pictureFile);\r\n\r\n            const reader = new FileReader();\r\n            reader.onload = (e2) => {\r\n                const orientation = FileUtils.getExifOrientation(e2.target?.result as ArrayBuffer);\r\n                const orientationStyles = FileUtils.getOrientationStyles(orientation);\r\n\r\n                this.setState({\r\n                    image: this.previewBlob || '',\r\n                    orientationStyles,\r\n                });\r\n            };\r\n            reader.readAsArrayBuffer(pictureFile);\r\n            e.target.value = '';\r\n            this.setState({pictureFile});\r\n        } else {\r\n            this.setState({pictureFile: null, image: ''});\r\n        }\r\n    };\r\n\r\n    setDefault = () => {\r\n        this.setState({pictureFile: 'default', image: BotDefaultIcon});\r\n    };\r\n\r\n    isFile(file: File | string): file is File {\r\n        return (file as File).size !== undefined;\r\n    }\r\n\r\n    updateRoles = async (data: Bot) => {\r\n        let roles = General.SYSTEM_USER_ROLE;\r\n\r\n        if (this.state.role === roleOptionSystemAdmin) {\r\n            roles += ' ' + General.SYSTEM_ADMIN_ROLE;\r\n        } else if (this.state.postAll) {\r\n            roles += ' ' + General.SYSTEM_POST_ALL_ROLE;\r\n        } else if (this.state.postChannels) {\r\n            roles += ' ' + General.SYSTEM_POST_ALL_PUBLIC_ROLE;\r\n        }\r\n\r\n        const rolesResult = await this.props.actions.updateUserRoles(data.user_id, roles);\r\n        if (rolesResult) {\r\n            return rolesResult.error;\r\n        }\r\n\r\n        return null;\r\n    };\r\n\r\n    handleSubmit = async (e: FormEvent<HTMLButtonElement | HTMLFormElement>) => {\r\n        e.preventDefault();\r\n\r\n        if (this.state.adding) {\r\n            return;\r\n        }\r\n\r\n        if (!this.state.username || this.state.username.length < 3) {\r\n            this.setState({\r\n                error: (\r\n                    <FormattedMessage\r\n                        id='bots.manage.add.invalid_username'\r\n                        defaultMessage='Usernames have to begin with a lowercase letter and be 3-22 characters long. You can use lowercase letters, numbers, periods, dashes, and underscores.'\r\n                    />\r\n                ),\r\n            });\r\n            return;\r\n        }\r\n\r\n        if (this.state.pictureFile && this.isFile(this.state.pictureFile)) {\r\n            if (!AcceptedProfileImageTypes.includes(this.state.pictureFile.type)) {\r\n                this.setState({\r\n                    error: (\r\n                        <FormattedMessage\r\n                            id='user.settings.general.validImage'\r\n                            defaultMessage='Only BMP, JPG or PNG images may be used for profile pictures'\r\n                        />\r\n                    ),\r\n                });\r\n                return;\r\n            } else if (this.state.pictureFile.size > this.props.maxFileSize) {\r\n                this.setState({\r\n                    error: (\r\n                        <FormattedMessage\r\n                            id='user.settings.general.imageTooLarge'\r\n                            defaultMessage='Unable to upload profile image. File is too large.'\r\n                        />\r\n                    ),\r\n                });\r\n                return;\r\n            }\r\n        }\r\n\r\n        this.setState({\r\n            adding: true,\r\n            error: '',\r\n        });\r\n\r\n        const bot = {\r\n            username: this.state.username.toLowerCase().trim(),\r\n            display_name: this.state.displayName,\r\n            description: this.state.description,\r\n        };\r\n\r\n        let data: Bot | undefined;\r\n        let error;\r\n        if (this.props.bot) {\r\n            const result = await this.props.actions.patchBot(this.props.bot.user_id, bot);\r\n            if (result) {\r\n                data = result.data;\r\n                error = result.error;\r\n            } else {\r\n                error = Utils.localizeMessage({id: 'bot.edit_failed', defaultMessage: 'Failed to edit bot'});\r\n            }\r\n\r\n            if (!error && data) {\r\n                if (this.state.pictureFile && this.state.pictureFile !== 'default') {\r\n                    const imageResult = await this.props.actions.uploadProfileImage(data.user_id, this.state.pictureFile);\r\n                    error = imageResult.error;\r\n                } else if (this.state.pictureFile && this.state.pictureFile === 'default') {\r\n                    await this.props.actions.setDefaultProfileImage(data.user_id);\r\n                }\r\n            }\r\n\r\n            if (!error && data) {\r\n                error = this.updateRoles(data);\r\n            }\r\n\r\n            if (data) {\r\n                getHistory().push(`/${this.props.team.name}/integrations/bots`);\r\n                return;\r\n            }\r\n        } else {\r\n            const usernameError = Utils.isValidBotUsername(bot.username);\r\n            if (usernameError) {\r\n                let errObj;\r\n                if (usernameError.id === ValidationErrors.INVALID_LAST_CHARACTER) {\r\n                    errObj = {\r\n                        adding: false,\r\n                        error: (\r\n                            <FormattedMessage\r\n                                id='bots.manage.add.invalid_last_char'\r\n                                defaultMessage='Bot usernames cannot have a period as the last character'\r\n                            />\r\n                        ),\r\n                    };\r\n                } else {\r\n                    errObj = {\r\n                        adding: false,\r\n                        error: (\r\n                            <FormattedMessage\r\n                                id='bots.manage.add.invalid_username'\r\n                                defaultMessage='Usernames have to begin with a lowercase letter and be 3-22 characters long. You can use lowercase letters, numbers, periods, dashes, and underscores.'\r\n                            />\r\n                        ),\r\n                    };\r\n                }\r\n                this.setState(errObj);\r\n                return;\r\n            }\r\n\r\n            const result = await this.props.actions.createBot(bot);\r\n            if (result) {\r\n                data = result.data;\r\n                error = result.error;\r\n            } else {\r\n                error = Utils.localizeMessage({id: 'bot.create_failed', defaultMessage: 'Failed to create bot'});\r\n            }\r\n\r\n            let token = '';\r\n            if (!error && data) {\r\n                if (this.state.pictureFile && this.state.pictureFile !== 'default') {\r\n                    await this.props.actions.uploadProfileImage(data.user_id, this.state.pictureFile);\r\n                } else {\r\n                    await this.props.actions.setDefaultProfileImage(data.user_id);\r\n                }\r\n                const tokenResult = await this.props.actions.createUserAccessToken(data.user_id,\r\n                    Utils.localizeMessage({id: 'bot.token.default.description', defaultMessage: 'Default Token'}),\r\n                );\r\n\r\n                // On error just skip the confirmation because we have a bot without a token.\r\n                if (!tokenResult || tokenResult.error) {\r\n                    getHistory().push(`/${this.props.team.name}/integrations/bots`);\r\n                    return;\r\n                }\r\n\r\n                token = tokenResult.data!.token!;\r\n            }\r\n\r\n            if (!error && data) {\r\n                error = this.updateRoles(data);\r\n            }\r\n\r\n            if (data) {\r\n                getHistory().push(`/${this.props.team.name}/integrations/confirm?type=bots&id=${data.user_id}&token=${token}`);\r\n                return;\r\n            }\r\n        }\r\n\r\n        this.setState({\r\n            adding: false,\r\n        });\r\n\r\n        if (error) {\r\n            this.setState({\r\n                error: error.message,\r\n            });\r\n        }\r\n    };\r\n\r\n    render() {\r\n        let subtitle = (\r\n            <FormattedMessage\r\n                id='bots.manage.add.add'\r\n                defaultMessage='Add'\r\n            />\r\n        );\r\n        let buttonText = (\r\n            <FormattedMessage\r\n                id='bots.manage.add.create'\r\n                defaultMessage='Create Bot Account'\r\n            />\r\n        );\r\n        let buttonActiveText = (\r\n            <FormattedMessage\r\n                id='bots.manage.add.creating'\r\n                defaultMessage='Creating...'\r\n            />\r\n        );\r\n\r\n        // If we are editing\r\n        if (this.props.bot) {\r\n            subtitle = (\r\n                <FormattedMessage\r\n                    id='bots.manage.edit'\r\n                    defaultMessage='Edit'\r\n                />\r\n            );\r\n            buttonText = (\r\n                <FormattedMessage\r\n                    id='bots.manage.edit.title'\r\n                    defaultMessage='Update'\r\n                />\r\n            );\r\n            buttonActiveText = (\r\n                <FormattedMessage\r\n                    id='bots.manage.edit.editing'\r\n                    defaultMessage='Updating...'\r\n                />\r\n            );\r\n        }\r\n\r\n        let imageURL = '';\r\n        let removeImageIcon: JSX.Element | null = (\r\n            <WithTooltip\r\n                title={\r\n                    <FormattedMessage\r\n                        id='bot.remove_profile_picture'\r\n                        defaultMessage='Remove Bot Icon'\r\n                    />\r\n                }\r\n            >\r\n                <a\r\n                    className={'bot-profile__remove'}\r\n                    onClick={this.setDefault}\r\n                >\r\n                    <span>{''}</span>\r\n                </a>\r\n            </WithTooltip>\r\n        );\r\n        let imageStyles;\r\n        if (this.props.bot && !this.state.pictureFile) {\r\n            if (this.props.user) {\r\n                imageURL = Utils.imageURLForUser(this.props.user.id, this.props.user.last_picture_update);\r\n            } else {\r\n                imageURL = Utils.imageURLForUser(this.props.bot.user_id);\r\n            }\r\n        } else {\r\n            imageURL = this.state.image;\r\n            imageStyles = this.state.orientationStyles;\r\n            if (this.state.image === BotDefaultIcon) {\r\n                removeImageIcon = null;\r\n            }\r\n        }\r\n\r\n        return (\r\n            <div className='backstage-content'>\r\n                <BackstageHeader>\r\n                    <Link to={`/${this.props.team.name}/integrations/bots`}>\r\n                        <FormattedMessage\r\n                            id='bots.manage.header'\r\n                            defaultMessage='Bot Accounts'\r\n                        />\r\n                    </Link>\r\n                    {subtitle}\r\n                </BackstageHeader>\r\n                <div className='backstage-form'>\r\n                    <form\r\n                        className='form-horizontal'\r\n                        onSubmit={this.handleSubmit}\r\n                    >\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='username'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='bots.add.username'\r\n                                    defaultMessage='Username'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <input\r\n                                    id='username'\r\n                                    type='text'\r\n                                    maxLength={22}\r\n                                    className='form-control'\r\n                                    value={this.state.username}\r\n                                    onChange={this.updateUsername}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='bot.add.username.help'\r\n                                        defaultMessage='You can use lowercase letters, numbers, periods, dashes, and underscores.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='boticon'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='bots.add.icon'\r\n                                    defaultMessage='Bot Icon'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <div className={'bot-img-container'}>\r\n                                    <img\r\n                                        className={'bot-img'}\r\n                                        alt={'bot image'}\r\n                                        src={imageURL}\r\n                                        style={imageStyles}\r\n                                    />\r\n                                    {removeImageIcon}\r\n                                </div>\r\n                                <div\r\n                                    className='btn btn-primary btn-file'\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='bots.image.upload'\r\n                                        defaultMessage='Upload Image'\r\n                                    />\r\n                                    <input\r\n                                        className='btn-file__input'\r\n                                        accept={Constants.ACCEPT_STATIC_IMAGE}\r\n                                        type='file'\r\n                                        onChange={this.updatePicture}\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='displayName'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='bots.add.displayName'\r\n                                    defaultMessage='Display Name'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <input\r\n                                    id='displayName'\r\n                                    type='text'\r\n                                    maxLength={64}\r\n                                    className='form-control'\r\n                                    value={this.state.displayName}\r\n                                    onChange={this.updateDisplayName}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='bot.add.display_name.help'\r\n                                        defaultMessage={'(Optional) You can choose to display your bot\\'s full name rather than its username.'}\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='description'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='bot.add.description'\r\n                                    defaultMessage='Description'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <input\r\n                                    id='description'\r\n                                    type='text'\r\n                                    maxLength={1024}\r\n                                    className='form-control'\r\n                                    value={this.state.description}\r\n                                    onChange={this.updateDescription}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='bot.add.description.help'\r\n                                        defaultMessage='(Optional) Let others know what this bot does.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='role'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='bot.add.role'\r\n                                    defaultMessage='Role'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <select\r\n                                    className='form-control'\r\n                                    value={this.state.role}\r\n                                    disabled={!this.props.editingUserHasManageSystem}\r\n                                    onChange={this.updateRole}\r\n                                >\r\n                                    <option\r\n                                        value={roleOptionMember}\r\n                                    >\r\n                                        {Utils.localizeMessage({id: 'bot.add.role.member', defaultMessage: 'Member'})}\r\n                                    </option>\r\n                                    <option\r\n                                        value={roleOptionSystemAdmin}\r\n                                    >\r\n                                        {Utils.localizeMessage({id: 'bot.add.role.admin', defaultMessage: 'System Admin'})}\r\n                                    </option>\r\n                                </select>\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='bot.add.role.help'\r\n                                        defaultMessage='Choose what role the bot should have.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='row bot-profile__section'>\r\n                            <div className='col-md-5 col-sm-8 col-sm-offset-4'>\r\n                                <FormattedMessage\r\n                                    id='admin.manage_roles.botAdditionalRoles'\r\n                                    defaultMessage='Select additional permissions for the account. <link>Read more about roles and permissions</link>.'\r\n                                    values={{\r\n                                        link: (msg: React.ReactNode) => (\r\n                                            <ExternalLink\r\n                                                href={DeveloperLinks.PERSONAL_ACCESS_TOKENS}\r\n                                                location='add_bot'\r\n                                            >\r\n                                                {msg}\r\n                                            </ExternalLink>\r\n                                        ),\r\n                                    }}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='postAll'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='bot.add.post_all'\r\n                                    defaultMessage='post:all'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8 checkbox'>\r\n                                <div className='checkbox no-padding'>\r\n                                    <label htmlFor='postAll'>\r\n                                        <input\r\n                                            id='postAll'\r\n                                            type='checkbox'\r\n                                            checked={this.state.postAll || this.state.role === roleOptionSystemAdmin}\r\n                                            onChange={this.updatePostAll}\r\n                                            disabled={!this.props.editingUserHasManageSystem || this.state.role === roleOptionSystemAdmin}\r\n                                        />\r\n                                        <FormattedMessage\r\n                                            id='bot.add.post_all.enabled'\r\n                                            defaultMessage='Enabled'\r\n                                        />\r\n                                    </label>\r\n                                </div>\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='bot.add.post_all.help'\r\n                                        defaultMessage='Bot will have access to post to all Mattermost channels including direct messages.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='postChannels'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='bot.add.post_channels'\r\n                                    defaultMessage='post:channels'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8 checkbox'>\r\n                                <div className='checkbox no-padding'>\r\n                                    <label htmlFor='postChannels'>\r\n                                        <input\r\n                                            id='postChannels'\r\n                                            type='checkbox'\r\n                                            checked={this.state.postChannels || this.state.role === roleOptionSystemAdmin || this.state.postAll}\r\n                                            onChange={this.updatePostChannels}\r\n                                            disabled={!this.props.editingUserHasManageSystem || this.state.role === roleOptionSystemAdmin || this.state.postAll}\r\n                                        />\r\n                                        <FormattedMessage\r\n                                            id='bot.add.post_channels.enabled'\r\n                                            defaultMessage='Enabled'\r\n                                        />\r\n                                    </label>\r\n                                </div>\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='bot.add.post_channels.help'\r\n                                        defaultMessage='Bot will have access to post to all Mattermost public channels.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='backstage-form__footer'>\r\n                            <FormError\r\n                                type='backstage'\r\n                                errors={[this.state.error]}\r\n                            />\r\n                            <Link\r\n                                className='btn btn-tertiary'\r\n                                to={`/${this.props.team.name}/integrations/bots`}\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='bots.manage.add.cancel'\r\n                                    defaultMessage='Cancel'\r\n                                />\r\n                            </Link>\r\n                            <SpinnerButton\r\n                                className='btn btn-primary'\r\n                                type='submit'\r\n                                spinning={this.state.adding}\r\n                                spinningText={buttonActiveText}\r\n                                onClick={this.handleSubmit}\r\n                                id='saveBot'\r\n                            >\r\n                                {buttonText}\r\n                            </SpinnerButton>\r\n                        </div>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport type {RouteComponentProps} from 'react-router-dom';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {createBot, patchBot} from 'mattermost-redux/actions/bots';\r\nimport {updateUserRoles, uploadProfileImage, setDefaultProfileImage, createUserAccessToken} from 'mattermost-redux/actions/users';\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {getBotAccounts} from 'mattermost-redux/selectors/entities/bots';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {haveISystemPermission} from 'mattermost-redux/selectors/entities/roles';\r\nimport {getUser} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport AddBot from './add_bot';\r\n\r\ntype OwnProps = {\r\n\r\n    /**\r\n     * Search query for the bot\r\n     */\r\n    location: RouteComponentProps['location'];\r\n}\r\n\r\nfunction mapStateToProps(state: GlobalState, ownProps: OwnProps) {\r\n    const config = getConfig(state);\r\n    const botId = (new URLSearchParams(ownProps.location.search)).get('id');\r\n    const bots = getBotAccounts(state);\r\n    const bot = (bots && botId) ? bots[botId] : undefined;\r\n    const user = bot ? getUser(state, bot.user_id) : undefined;\r\n    const roles = user ? user.roles : undefined;\r\n    return {\r\n        maxFileSize: parseInt(config.MaxFileSize!, 10),\r\n        bot,\r\n        roles,\r\n        editingUserHasManageSystem: haveISystemPermission(state, {permission: Permissions.MANAGE_SYSTEM}),\r\n        user,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            createBot,\r\n            patchBot,\r\n            uploadProfileImage,\r\n            setDefaultProfileImage,\r\n            createUserAccessToken,\r\n            updateUserRoles,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(AddBot);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport debounce from 'lodash/debounce';\r\nimport React, {useCallback, useEffect, useMemo, useRef, useState} from 'react';\r\nimport type {MessageDescriptor} from 'react-intl';\r\nimport {FormattedMessage} from 'react-intl';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\n\r\nimport {OauthIcon, InformationOutlineIcon} from '@mattermost/compass-icons/components';\r\nimport type {OutgoingOAuthConnection} from '@mattermost/types/integrations';\r\n\r\nimport {\r\n    getOutgoingOAuthConnectionsForAudience as fetchOutgoingOAuthConnectionsForAudience,\r\n    getOutgoingOAuthConnections as fetchOutgoingOAuthConnections,\r\n} from 'mattermost-redux/actions/integrations';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {getOutgoingOAuthConnections} from 'mattermost-redux/selectors/entities/integrations';\r\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport LocalizedPlaceholderInput from 'components/localized_placeholder_input';\r\nimport LoadingSpinner from 'components/widgets/loading/loading_spinner';\r\n\r\ntype Props = {\r\n    value: string;\r\n    onChange: (e: React.ChangeEvent<HTMLInputElement>) => void;\r\n    placeholder: MessageDescriptor;\r\n}\r\n\r\nconst OAuthConnectionAudienceInput = (props: Props) => {\r\n    const mounted = useRef(false);\r\n    const [matchedConnection, setMatchingOAuthConnection] = useState<OutgoingOAuthConnection | null>(null);\r\n    const [loadingAudienceMatch, setLoadingAudienceMatch] = useState(false);\r\n\r\n    const oauthConnections = useSelector(getOutgoingOAuthConnections);\r\n    const oauthConnectionsEnabled = useSelector(getConfig).EnableOutgoingOAuthConnections === 'true';\r\n    const teamId = useSelector(getCurrentTeamId);\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    const matchConnectionsOnInput = useCallback(async (inputValue: string) => {\r\n        const res = await dispatch(fetchOutgoingOAuthConnectionsForAudience(teamId, inputValue));\r\n        setLoadingAudienceMatch(false);\r\n\r\n        if (res.data && res.data.length) {\r\n            setMatchingOAuthConnection(res.data[0]);\r\n        } else {\r\n            setMatchingOAuthConnection(null);\r\n        }\r\n    }, [dispatch, teamId]);\r\n\r\n    const debouncedMatchConnections = useMemo(() => {\r\n        return debounce((inputValue: string) => matchConnectionsOnInput(inputValue), 1000);\r\n    }, [matchConnectionsOnInput]);\r\n\r\n    useEffect(() => {\r\n        if (mounted.current) {\r\n            return;\r\n        }\r\n        mounted.current = true;\r\n\r\n        if (oauthConnectionsEnabled) {\r\n            dispatch(fetchOutgoingOAuthConnections(teamId));\r\n            if (props.value) {\r\n                setLoadingAudienceMatch(true);\r\n                matchConnectionsOnInput(props.value);\r\n            }\r\n        }\r\n    }, [oauthConnectionsEnabled, props.value, teamId, matchConnectionsOnInput, dispatch, mounted]);\r\n\r\n    const onChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        props.onChange(e);\r\n\r\n        if (oauthConnectionsEnabled) {\r\n            setLoadingAudienceMatch(true);\r\n            debouncedMatchConnections(e.target.value);\r\n        }\r\n    };\r\n\r\n    const connections = Object.values(oauthConnections);\r\n\r\n    const input = (\r\n        <LocalizedPlaceholderInput\r\n            autoComplete='off'\r\n            id='url'\r\n            maxLength={1024}\r\n            className='form-control'\r\n            value={props.value}\r\n            onChange={onChange}\r\n            placeholder={props.placeholder}\r\n        />\r\n    );\r\n\r\n    if (!connections.length) {\r\n        return input;\r\n    }\r\n\r\n    let oauthMessage: React.ReactNode;\r\n\r\n    if (loadingAudienceMatch) {\r\n        oauthMessage = (\r\n            <span>\r\n                <LoadingSpinner/>\r\n            </span>\r\n        );\r\n    } else if (matchedConnection) {\r\n        oauthMessage = (\r\n            <>\r\n                <span>\r\n                    <OauthIcon\r\n                        size={20}\r\n                    />\r\n                </span>\r\n                <span className='outgoing-oauth-audience-match-message'>\r\n                    <FormattedMessage\r\n                        id='add_outgoing_oauth_connection.connected'\r\n                        defaultMessage='Connected to \"{connectionName}\"'\r\n                        values={{\r\n                            connectionName: matchedConnection.name,\r\n                        }}\r\n                    />\r\n                </span>\r\n            </>\r\n        );\r\n    } else {\r\n        oauthMessage = (\r\n            <>\r\n                <span>\r\n                    <InformationOutlineIcon\r\n                        size={20}\r\n                    />\r\n                </span>\r\n                <span className='outgoing-oauth-audience-match-message'>\r\n                    <FormattedMessage\r\n                        id='add_outgoing_oauth_connection.not_connected'\r\n                        defaultMessage='Not linked to an OAuth connection'\r\n                    />\r\n                </span>\r\n            </>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <>\r\n            {input}\r\n            <div className='outgoing-oauth-audience-match-message-container'>\r\n                {oauthMessage}\r\n            </div>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default OAuthConnectionAudienceInput;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport type {ChangeEvent} from 'react';\r\nimport {defineMessage, FormattedMessage, type MessageDescriptor} from 'react-intl';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport type {Command} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport BackstageHeader from 'components/backstage/components/backstage_header';\r\nimport ExternalLink from 'components/external_link';\r\nimport FormError from 'components/form_error';\r\nimport LocalizedPlaceholderInput from 'components/localized_placeholder_input';\r\nimport SpinnerButton from 'components/spinner_button';\r\n\r\nimport {Constants, DeveloperLinks} from 'utils/constants';\r\nimport * as Utils from 'utils/utils';\r\n\r\nimport OAuthConnectionAudienceInput from './outgoing_oauth_connections/oauth_connection_audience_input';\r\n\r\nconst REQUEST_POST = 'P';\r\nconst REQUEST_GET = 'G';\r\n\r\ntype Props = {\r\n\r\n    /**\r\n    * The current team\r\n    */\r\n    team: Team;\r\n\r\n    /**\r\n    * The header text to render, has id and defaultMessage\r\n    */\r\n    header: MessageDescriptor | string;\r\n\r\n    /**\r\n    * The footer text to render, has id and defaultMessage\r\n    */\r\n    footer: MessageDescriptor | string;\r\n\r\n    /**\r\n    * The spinner loading text to render, has id and defaultMessage\r\n    */\r\n    loading: MessageDescriptor | string;\r\n\r\n    /**\r\n    * Any extra component/node to render\r\n    */\r\n    renderExtra?: JSX.Element;\r\n\r\n    /**\r\n    * The server error text after a failed action\r\n    */\r\n    serverError: string;\r\n\r\n    /**\r\n    * The Command used to set the initial state\r\n    */\r\n    initialCommand?: Partial<Command>;\r\n\r\n    /**\r\n    * The async function to run when the action button is pressed\r\n    */\r\n    action: (command: Command) => Promise<void>;\r\n}\r\n\r\ntype State = {\r\n    saving: boolean;\r\n    clientError: null | JSX.Element | string;\r\n    trigger: string;\r\n    displayName: string;\r\n    description: string;\r\n    url: string;\r\n    method: 'P' | 'G' | '';\r\n    username: string;\r\n    iconUrl: string;\r\n    autocomplete: boolean;\r\n    autocompleteHint: string;\r\n    autocompleteDescription: string;\r\n}\r\n\r\nexport default class AbstractCommand extends React.PureComponent<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = this.getStateFromCommand(this.props.initialCommand || {});\r\n    }\r\n\r\n    getStateFromCommand = (command: Props['initialCommand']): State => {\r\n        return {\r\n            displayName: command?.display_name ?? '',\r\n            description: command?.description ?? '',\r\n            trigger: command?.trigger ?? '',\r\n            url: command?.url ?? '',\r\n            method: command?.method ?? REQUEST_POST,\r\n            username: command?.username ?? '',\r\n            iconUrl: command?.icon_url ?? '',\r\n            autocomplete: command?.auto_complete ?? false,\r\n            autocompleteHint: command?.auto_complete_hint ?? '',\r\n            autocompleteDescription: command?.auto_complete_desc ?? '',\r\n            saving: false,\r\n            clientError: null,\r\n        };\r\n    };\r\n\r\n    getBackstageHeader = () => {\r\n        if (typeof this.props.header === 'string') {\r\n            return <span>{this.props.header}</span>;\r\n        }\r\n\r\n        return (\r\n            <FormattedMessage\r\n                id={this.props.header.id}\r\n                defaultMessage={this.props.header.defaultMessage}\r\n            />\r\n        );\r\n    };\r\n\r\n    getBackstageFooter = () => {\r\n        if (typeof this.props.footer === 'string') {\r\n            return <span>{this.props.footer}</span>;\r\n        }\r\n\r\n        return (\r\n            <FormattedMessage\r\n                id={this.props.footer.id}\r\n                defaultMessage={this.props.footer.defaultMessage}\r\n            />\r\n        );\r\n    };\r\n\r\n    handleSubmit = (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n\r\n        if (this.state.saving) {\r\n            return;\r\n        }\r\n\r\n        this.setState({\r\n            saving: true,\r\n            clientError: '',\r\n        });\r\n\r\n        let triggerWord = this.state.trigger.trim().toLowerCase();\r\n        if (triggerWord.indexOf('/') === 0) {\r\n            triggerWord = triggerWord.substr(1);\r\n        }\r\n\r\n        const command = {\r\n            display_name: this.state.displayName,\r\n            description: this.state.description,\r\n            trigger: triggerWord,\r\n            url: this.state.url.trim(),\r\n            method: this.state.method,\r\n            username: this.state.username,\r\n            icon_url: this.state.iconUrl,\r\n            auto_complete: this.state.autocomplete,\r\n            team_id: this.props.team.id,\r\n            auto_complete_desc: '',\r\n            auto_complete_hint: '',\r\n            token: '',\r\n            create_at: 0,\r\n            update_at: 0,\r\n            delete_at: 0,\r\n            id: '',\r\n            creator_id: '',\r\n        };\r\n\r\n        if (command.auto_complete) {\r\n            command.auto_complete_desc = this.state.autocompleteDescription ?? '';\r\n            command.auto_complete_hint = this.state.autocompleteHint ?? '';\r\n        }\r\n\r\n        if (!command.trigger) {\r\n            this.setState({\r\n                saving: false,\r\n                clientError: (\r\n                    <FormattedMessage\r\n                        id='add_command.triggerRequired'\r\n                        defaultMessage='A trigger word is required'\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        if (command.trigger.indexOf('/') === 0) {\r\n            this.setState({\r\n                saving: false,\r\n                clientError: (\r\n                    <FormattedMessage\r\n                        id='add_command.triggerInvalidSlash'\r\n                        defaultMessage='A trigger word cannot begin with a /'\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        if (command.trigger.indexOf(' ') !== -1) {\r\n            this.setState({\r\n                saving: false,\r\n                clientError: (\r\n                    <FormattedMessage\r\n                        id='add_command.triggerInvalidSpace'\r\n                        defaultMessage='A trigger word must not contain spaces'\r\n                    />\r\n                ),\r\n            });\r\n            return;\r\n        }\r\n\r\n        if (command.trigger.length < Constants.MIN_TRIGGER_LENGTH ||\r\n            command.trigger.length > Constants.MAX_TRIGGER_LENGTH) {\r\n            this.setState({\r\n                saving: false,\r\n                clientError: (\r\n                    <FormattedMessage\r\n                        id='add_command.triggerInvalidLength'\r\n                        defaultMessage='A trigger word must contain between {min} and {max} characters'\r\n                        values={{\r\n                            min: Constants.MIN_TRIGGER_LENGTH,\r\n                            max: Constants.MAX_TRIGGER_LENGTH,\r\n                        }}\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        if (!command.url) {\r\n            this.setState({\r\n                saving: false,\r\n                clientError: (\r\n                    <FormattedMessage\r\n                        id='add_command.urlRequired'\r\n                        defaultMessage='A request URL is required'\r\n                    />\r\n                ),\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        this.props.action(command).then(() => this.setState({saving: false}));\r\n    };\r\n\r\n    updateDisplayName = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            displayName: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateDescription = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            description: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateTrigger = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            trigger: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateUrl = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            url: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateMethod = (e: ChangeEvent<HTMLSelectElement>) => {\r\n        const methodValue = e.target.value;\r\n        if (methodValue === 'P' || methodValue === 'G' || methodValue === '') {\r\n            this.setState({\r\n                method: methodValue,\r\n            });\r\n        }\r\n    };\r\n\r\n    updateUsername = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            username: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateIconUrl = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            iconUrl: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateAutocomplete = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            autocomplete: e.target.checked,\r\n        });\r\n    };\r\n\r\n    updateAutocompleteHint = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            autocompleteHint: e.target.value,\r\n        });\r\n    };\r\n\r\n    updateAutocompleteDescription = (e: ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({\r\n            autocompleteDescription: e.target.value,\r\n        });\r\n    };\r\n\r\n    render() {\r\n        let autocompleteHint = null;\r\n        let autocompleteDescription = null;\r\n\r\n        if (this.state.autocomplete) {\r\n            autocompleteHint = (\r\n                <div className='form-group'>\r\n                    <label\r\n                        className='control-label col-sm-4'\r\n                        htmlFor='autocompleteHint'\r\n                    >\r\n                        <FormattedMessage\r\n                            id='add_command.autocompleteHint'\r\n                            defaultMessage='Autocomplete Hint'\r\n                        />\r\n                    </label>\r\n                    <div className='col-md-5 col-sm-8'>\r\n                        <LocalizedPlaceholderInput\r\n                            id='autocompleteHint'\r\n                            type='text'\r\n                            maxLength={1024}\r\n                            className='form-control'\r\n                            value={this.state.autocompleteHint}\r\n                            onChange={this.updateAutocompleteHint}\r\n                            placeholder={defineMessage({\r\n                                id: 'add_command.autocompleteHint.placeholder',\r\n                                defaultMessage: 'Example: [Patient Name]',\r\n                            })}\r\n                        />\r\n                        <div className='form__help'>\r\n                            <FormattedMessage\r\n                                id='add_command.autocompleteHint.help'\r\n                                defaultMessage='(Optional) Specify the arguments associated with your slash command. These are displayed as help on the autocomplete list.'\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            );\r\n\r\n            autocompleteDescription = (\r\n                <div className='form-group'>\r\n                    <label\r\n                        className='control-label col-sm-4'\r\n                        htmlFor='autocompleteDescription'\r\n                    >\r\n                        <FormattedMessage\r\n                            id='add_command.autocompleteDescription'\r\n                            defaultMessage='Autocomplete Description'\r\n                        />\r\n                    </label>\r\n                    <div className='col-md-5 col-sm-8'>\r\n                        <LocalizedPlaceholderInput\r\n                            id='description'\r\n                            type='text'\r\n                            maxLength={128}\r\n                            className='form-control'\r\n                            value={this.state.autocompleteDescription}\r\n                            onChange={this.updateAutocompleteDescription}\r\n                            placeholder={defineMessage({\r\n                                id: 'add_command.autocompleteDescription.placeholder',\r\n                                defaultMessage: 'Example: \"Returns search results for patient records\"',\r\n                            })}\r\n                        />\r\n                        <div className='form__help'>\r\n                            <FormattedMessage\r\n                                id='add_command.autocompleteDescription.help'\r\n                                defaultMessage='(Optional) Describe your slash command for the autocomplete list.'\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div className='backstage-content row'>\r\n                <BackstageHeader>\r\n                    <Link to={'/' + this.props.team.name + '/integrations/commands'}>\r\n                        <FormattedMessage\r\n                            id='installed_command.header'\r\n                            defaultMessage='Slash Commands'\r\n                        />\r\n                    </Link>\r\n                    {this.getBackstageHeader()}\r\n                </BackstageHeader>\r\n                <div className='backstage-form'>\r\n                    <form\r\n                        className='form-horizontal'\r\n                        onSubmit={this.handleSubmit}\r\n                    >\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='displayName'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_command.displayName'\r\n                                    defaultMessage='Title'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <input\r\n                                    id='displayName'\r\n                                    type='text'\r\n                                    maxLength={64}\r\n                                    className='form-control'\r\n                                    value={this.state.displayName}\r\n                                    onChange={this.updateDisplayName}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_command.displayName.help'\r\n                                        defaultMessage='Specify a title, of up to 64 characters, for the slash command settings page.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='description'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_command.description'\r\n                                    defaultMessage='Description'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <input\r\n                                    id='description'\r\n                                    type='text'\r\n                                    maxLength={128}\r\n                                    className='form-control'\r\n                                    value={this.state.description}\r\n                                    onChange={this.updateDescription}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_command.description.help'\r\n                                        defaultMessage='Describe your slash command.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='trigger'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_command.trigger'\r\n                                    defaultMessage='Command Trigger Word'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <LocalizedPlaceholderInput\r\n                                    id='trigger'\r\n                                    type='text'\r\n                                    maxLength={Constants.MAX_TRIGGER_LENGTH}\r\n                                    className='form-control'\r\n                                    value={this.state.trigger}\r\n                                    onChange={this.updateTrigger}\r\n                                    placeholder={defineMessage({\r\n                                        id: 'add_command.trigger.placeholder',\r\n                                        defaultMessage: 'Command trigger e.g. \"hello\" not including the slash',\r\n                                    })}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_command.trigger.help'\r\n                                        defaultMessage='Specify a trigger word that is not a built-in command, does not contain spaces, and does not begin with the slash character.'\r\n                                    />\r\n                                </div>\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_command.trigger.helpExamples'\r\n                                        defaultMessage='Examples: client, employee, patient, weather'\r\n                                    />\r\n                                </div>\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_command.trigger.helpReserved'\r\n                                        defaultMessage='Reserved: {link}'\r\n                                        values={{\r\n                                            link: (\r\n                                                <ExternalLink\r\n                                                    href={DeveloperLinks.CUSTOM_SLASH_COMMANDS}\r\n                                                    location='abstract_command'\r\n                                                >\r\n                                                    <FormattedMessage\r\n                                                        id='add_command.trigger.helpReservedLinkText'\r\n                                                        defaultMessage='See built-in slash commands'\r\n                                                    />\r\n                                                </ExternalLink>\r\n                                            ),\r\n                                        }}\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='url'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_command.url'\r\n                                    defaultMessage='Request URL'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <OAuthConnectionAudienceInput\r\n                                    value={this.state.url}\r\n                                    onChange={this.updateUrl}\r\n                                    placeholder={defineMessage({\r\n                                        id: 'add_command.url.placeholder',\r\n                                        defaultMessage: 'Must start with http:// or https://',\r\n                                    })}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_command.url.help'\r\n                                        defaultMessage='Specify the callback URL to receive the HTTP POST or GET event request when the slash command is run.'\r\n                                    />\r\n                                </div>\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id={'add_command.outgoing_oauth_connections.help_text'}\r\n                                        defaultMessage={'You can connect commands to <link>outgoing OAuth connections</link>.'}\r\n                                        values={{\r\n                                            link: (text) => (\r\n                                                <a href='https://mattermost.com/pl/outgoing-oauth-connections'>{text}</a>\r\n                                            ),\r\n                                        }}\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='method'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_command.method'\r\n                                    defaultMessage='Request Method'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <select\r\n                                    id='method'\r\n                                    className='form-control'\r\n                                    value={this.state.method}\r\n                                    onChange={this.updateMethod}\r\n                                >\r\n                                    <option value={REQUEST_POST}>\r\n                                        {Utils.localizeMessage({id: 'add_command.method.post', defaultMessage: 'POST'})}\r\n                                    </option>\r\n                                    <option value={REQUEST_GET}>\r\n                                        {Utils.localizeMessage({id: 'add_command.method.get', defaultMessage: 'GET'})}\r\n                                    </option>\r\n                                </select>\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_command.method.help'\r\n                                        defaultMessage='Specify the type of request, either POST or GET, sent to the endpoint that Mattermost hits to reach your application.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='username'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_command.username'\r\n                                    defaultMessage='Response Username'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <LocalizedPlaceholderInput\r\n                                    id='username'\r\n                                    type='text'\r\n                                    maxLength={64}\r\n                                    className='form-control'\r\n                                    value={this.state.username}\r\n                                    onChange={this.updateUsername}\r\n                                    placeholder={defineMessage({\r\n                                        id: 'add_command.username.placeholder',\r\n                                        defaultMessage: 'Username',\r\n                                    })}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_command.username.help'\r\n                                        defaultMessage='(Optional) Specify the name to use when posting responses for this slash command. Usernames can be up to 22 characters, and contain lowercase letters, numbers, and the symbols \\\"-\\\", \\\"_\\\", and \\\".\\\". If left blank, your Mattermost username is used.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='iconUrl'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_command.iconUrl'\r\n                                    defaultMessage='Response Icon'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8'>\r\n                                <LocalizedPlaceholderInput\r\n                                    id='iconUrl'\r\n                                    type='text'\r\n                                    maxLength={1024}\r\n                                    className='form-control'\r\n                                    value={this.state.iconUrl}\r\n                                    onChange={this.updateIconUrl}\r\n                                    placeholder={defineMessage({\r\n                                        id: 'add_command.iconUrl.placeholder',\r\n                                        defaultMessage: 'https://www.example.com/myicon.png',\r\n                                    })}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_command.iconUrl.help'\r\n                                        defaultMessage='(Optional) Enter the URL of a .png or .jpg file to use as the icon when posting responses to this slash command. The file must be at least 128 pixels by 128 pixels. If left blank, your profile picture is used.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className='form-group'>\r\n                            <label\r\n                                className='control-label col-sm-4'\r\n                                htmlFor='autocomplete'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_command.autocomplete'\r\n                                    defaultMessage='Autocomplete'\r\n                                />\r\n                            </label>\r\n                            <div className='col-md-5 col-sm-8 checkbox'>\r\n                                <input\r\n                                    id='autocomplete'\r\n                                    type='checkbox'\r\n                                    checked={this.state.autocomplete}\r\n                                    onChange={this.updateAutocomplete}\r\n                                />\r\n                                <div className='form__help'>\r\n                                    <FormattedMessage\r\n                                        id='add_command.autocomplete.help'\r\n                                        defaultMessage='(Optional) Show your slash command on the autocomplete list when someone types \"/\" in the input box.'\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        {autocompleteHint}\r\n                        {autocompleteDescription}\r\n                        <div className='backstage-form__footer'>\r\n                            <FormError\r\n                                type='backstage'\r\n                                errors={[this.props.serverError, this.state.clientError]}\r\n                            />\r\n                            <Link\r\n                                className='btn btn-tertiary'\r\n                                to={'/' + this.props.team.name + '/integrations/commands'}\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='add_command.cancel'\r\n                                    defaultMessage='Cancel'\r\n                                />\r\n                            </Link>\r\n                            <SpinnerButton\r\n                                className='btn btn-primary'\r\n                                type='submit'\r\n                                spinning={this.state.saving}\r\n                                spinningText={this.props.loading}\r\n                                onClick={this.handleSubmit}\r\n                                id='saveCommand'\r\n                            >\r\n                                {this.getBackstageFooter()}\r\n                            </SpinnerButton>\r\n                            {this.props.renderExtra}\r\n                        </div>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useState} from 'react';\r\nimport {useIntl} from 'react-intl';\r\nimport type {MessageDescriptor} from 'react-intl';\r\nimport {useHistory} from 'react-router-dom';\r\n\r\nimport type {Command} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions.js';\r\n\r\nimport AbstractCommand from '../abstract_command';\r\n\r\nexport type Props = {\r\n\r\n    /**\r\n    * The team data\r\n    */\r\n    team: Team;\r\n\r\n    actions: {\r\n\r\n        /**\r\n        * The function to call to add new command\r\n        */\r\n        addCommand: (command: Command) => Promise<ActionResult<Command>>;\r\n    };\r\n};\r\n\r\nconst AddCommand = ({team, actions}: Props) => {\r\n    const history = useHistory();\r\n    const {formatMessage} = useIntl();\r\n    const headerMessage = formatMessage({id: ('integrations.add'), defaultMessage: 'Add'}) as MessageDescriptor;\r\n    const footerMessage = formatMessage({id: ('add_command.save'), defaultMessage: 'Save'}) as MessageDescriptor;\r\n    const loadingMessage = formatMessage({id: ('add_command.saving'), defaultMessage: 'Saving...'}) as MessageDescriptor;\r\n    const [serverError, setServerError] = useState('');\r\n\r\n    const addCommand = async (command: Command) => {\r\n        setServerError('');\r\n\r\n        const {data, error} = await actions.addCommand(command);\r\n        if (data) {\r\n            history.push(`/${team.name}/integrations/commands/confirm?type=commands&id=${data.id}`);\r\n            return;\r\n        }\r\n\r\n        if (error) {\r\n            setServerError(error.message);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <AbstractCommand\r\n            team={team}\r\n            header={headerMessage}\r\n            footer={footerMessage}\r\n            loading={loadingMessage}\r\n            action={addCommand}\r\n            serverError={serverError}\r\n        />\r\n    );\r\n};\r\n\r\nexport default AddCommand;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport {addCommand} from 'mattermost-redux/actions/integrations';\r\n\r\nimport AddCommand from './add_command';\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            addCommand,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(null, mapDispatchToProps)(AddCommand);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useCallback} from 'react';\r\nimport type {MessageDescriptor} from 'react-intl';\r\nimport {useIntl} from 'react-intl';\r\n\r\nimport WithTooltip from 'components/with_tooltip';\r\n\r\nimport {copyToClipboard} from 'utils/utils';\r\n\r\ntype Props = {\r\n    label: MessageDescriptor;\r\n    value: string;\r\n};\r\n\r\nconst CopyText = ({\r\n    label,\r\n    value,\r\n}: Props) => {\r\n    const intl = useIntl();\r\n\r\n    const copyText = useCallback((e: React.MouseEvent) => {\r\n        e.preventDefault();\r\n        copyToClipboard(value);\r\n    }, [value]);\r\n\r\n    if (!document.queryCommandSupported('copy')) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <WithTooltip title={label}>\r\n            <button\r\n                data-testid='copyText'\r\n                className='btn btn-link icon-content-copy ml-2'\r\n                aria-label={intl.formatMessage(label)}\r\n                onClick={copyText}\r\n            />\r\n        </WithTooltip>\r\n    );\r\n};\r\n\r\nexport default React.memo(CopyText);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useEffect} from 'react';\r\nimport {defineMessages, FormattedMessage} from 'react-intl';\r\nimport {Link, useHistory} from 'react-router-dom';\r\n\r\nimport type {Bot} from '@mattermost/types/bots';\r\nimport type {Command, IncomingWebhook, OAuthApp, OutgoingOAuthConnection, OutgoingWebhook} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\nimport type {IDMappedObjects} from '@mattermost/types/utilities';\r\n\r\nimport BackstageHeader from 'components/backstage/components/backstage_header';\r\nimport CopyText from 'components/copy_text';\r\nimport ExternalLink from 'components/external_link';\r\n\r\nimport {Constants, DeveloperLinks, ErrorPageTypes} from 'utils/constants';\r\nimport {getSiteURL} from 'utils/url';\r\n\r\ntype Props = {\r\n    team: Team;\r\n    location: {search: string};\r\n    commands: IDMappedObjects<Command>;\r\n    oauthApps: IDMappedObjects<OAuthApp>;\r\n    incomingHooks: IDMappedObjects<IncomingWebhook>;\r\n    outgoingHooks: IDMappedObjects<OutgoingWebhook>;\r\n    bots: Record<string, Bot>;\r\n    outgoingOAuthConnections: Record<string, OutgoingOAuthConnection>;\r\n}\r\n\r\nconst ConfirmIntegration = ({team, location, commands, oauthApps, incomingHooks, outgoingHooks, bots, outgoingOAuthConnections}: Props): JSX.Element | null => {\r\n    const history = useHistory();\r\n\r\n    const type = (new URLSearchParams(location.search)).get('type') || '';\r\n    const id = (new URLSearchParams(location.search)).get('id') || '';\r\n\r\n    useEffect(() => {\r\n        window.addEventListener('keypress', handleKeyPress);\r\n\r\n        return () => {\r\n            window.removeEventListener('keypress', handleKeyPress);\r\n        };\r\n    });\r\n\r\n    const handleKeyPress = (e: KeyboardEvent) => {\r\n        if (e.key === 'Enter') {\r\n            history.push('/' + team.name + '/integrations/' + type);\r\n        }\r\n    };\r\n\r\n    let headerText: JSX.Element;\r\n    let helpText: JSX.Element | JSX.Element[];\r\n    let tokenText: JSX.Element;\r\n\r\n    const command = commands[id];\r\n    const incomingHook = incomingHooks[id];\r\n    const outgoingHook = outgoingHooks[id];\r\n    const oauthApp = oauthApps[id];\r\n    const outgoingOAuthConnection = outgoingOAuthConnections[id];\r\n    const bot = bots[id];\r\n\r\n    if (type === Constants.Integrations.COMMAND && command) {\r\n        const commandToken = command.token;\r\n\r\n        headerText = (\r\n            <FormattedMessage\r\n                id='slash_commands.header'\r\n                defaultMessage='Slash Commands'\r\n            />\r\n        );\r\n        helpText = (\r\n            <p>\r\n                <FormattedMessage\r\n                    id='add_command.doneHelp'\r\n                    defaultMessage='Your slash command is set up. The following token will be sent in the outgoing payload. Please use it to verify the request came from your Mattermost team (details at <link>Slash Commands</link>).'\r\n                    values={{\r\n                        link: (msg) => (\r\n                            <ExternalLink\r\n                                href={DeveloperLinks.SETUP_CUSTOM_SLASH_COMMANDS}\r\n                                location='confirm_integration'\r\n                            >\r\n                                {msg}\r\n                            </ExternalLink>\r\n                        ),\r\n                    }}\r\n                />\r\n            </p>\r\n        );\r\n        tokenText = (\r\n            <p className='word-break--all'>\r\n                <FormattedMessage\r\n                    id='add_command.token'\r\n                    defaultMessage='<b>Token</b>: {token}'\r\n                    values={{\r\n                        token: <code>{commandToken}</code>,\r\n                        b: (chunks) => <b>{chunks}</b>,\r\n                    }}\r\n                />\r\n                <CopyText\r\n                    label={messages.copyToken}\r\n                    value={commandToken}\r\n                />\r\n            </p>\r\n        );\r\n    } else if (type === Constants.Integrations.INCOMING_WEBHOOK && incomingHook) {\r\n        const incomingHookToken = getSiteURL() + '/hooks/' + incomingHook.id;\r\n\r\n        headerText = (\r\n            <FormattedMessage\r\n                id={'incoming_webhooks.header'}\r\n                defaultMessage='Incoming Webhooks'\r\n            />\r\n        );\r\n        helpText = (\r\n            <p>\r\n                <FormattedMessage\r\n                    id='add_incoming_webhook.doneHelp'\r\n                    defaultMessage='Your incoming webhook is set up. Please send data to the following URL (details at <link>Incoming Webhooks</link>).'\r\n                    values={{\r\n                        link: (msg) => (\r\n                            <ExternalLink\r\n                                href={DeveloperLinks.SETUP_INCOMING_WEBHOOKS}\r\n                                location='confirm_integration'\r\n                            >\r\n                                {msg}\r\n                            </ExternalLink>\r\n                        ),\r\n                    }}\r\n                />\r\n            </p>\r\n        );\r\n        tokenText = (\r\n            <p className='word-break--all'>\r\n                <FormattedMessage\r\n                    id='add_incoming_webhook.url'\r\n                    defaultMessage='<b>URL</b>: {url}'\r\n                    values={{\r\n                        url: <code>{incomingHookToken}</code>,\r\n                        b: (chunks) => <b>{chunks}</b>,\r\n                    }}\r\n                />\r\n                <CopyText\r\n                    label={messages.copyToken}\r\n                    value={incomingHookToken}\r\n                />\r\n            </p>\r\n        );\r\n    } else if (type === Constants.Integrations.OUTGOING_WEBHOOK && outgoingHook) {\r\n        const outgoingHookToken = outgoingHook.token;\r\n\r\n        headerText = (\r\n            <FormattedMessage\r\n                id={'add_outgoing_webhook.header'}\r\n                defaultMessage='Outgoing Webhooks'\r\n            />\r\n        );\r\n        helpText = (\r\n            <p>\r\n                <FormattedMessage\r\n                    id='add_outgoing_webhook.doneHelp'\r\n                    defaultMessage='Your outgoing webhook is set up. The following token will be sent in the outgoing payload. Please use it to verify that the request came from your Mattermost team (details at <link>Outgoing Webhooks</link>).'\r\n                    values={{\r\n                        link: (msg) => (\r\n                            <ExternalLink\r\n                                href={DeveloperLinks.SETUP_OUTGOING_WEBHOOKS}\r\n                                location='confirm_integration'\r\n                            >\r\n                                {msg}\r\n                            </ExternalLink>\r\n                        ),\r\n                    }}\r\n                />\r\n            </p>\r\n        );\r\n        tokenText = (\r\n            <p className='word-break--all'>\r\n                <FormattedMessage\r\n                    id='add_outgoing_webhook.token'\r\n                    defaultMessage='<b>Token</b>: {token}'\r\n                    values={{\r\n                        token: <code>{outgoingHookToken}</code>,\r\n                        b: (chunks) => <b>{chunks}</b>,\r\n                    }}\r\n                />\r\n                <CopyText\r\n                    label={messages.copyToken}\r\n                    value={outgoingHookToken}\r\n                />\r\n            </p>\r\n        );\r\n    } else if (type === Constants.Integrations.OAUTH_APP && oauthApp) {\r\n        const oauthAppToken = oauthApp.id;\r\n        const oauthAppSecret = oauthApp.client_secret;\r\n        const isPublicClient = !oauthAppSecret || oauthAppSecret === '';\r\n\r\n        headerText = (\r\n            <FormattedMessage\r\n                id={'installed_oauth2_apps.header'}\r\n                defaultMessage='OAuth 2.0 Applications'\r\n            />\r\n        );\r\n\r\n        helpText = [];\r\n\r\n        // Show different help text for public vs confidential clients\r\n        if (isPublicClient) {\r\n            helpText.push(\r\n                <p key='add_oauth_app.doneHelp'>\r\n                    <FormattedMessage\r\n                        id='add_oauth_app.doneHelp.public'\r\n                        defaultMessage='Your OAuth 2.0 public client application is set up. Please use the following Client ID when requesting authorization for your application. Public clients must use PKCE for authorization (details at <link>oAuth 2 Applications</link>).'\r\n                        values={{\r\n                            link: (msg) => (\r\n                                <ExternalLink\r\n                                    href={DeveloperLinks.SETUP_OAUTH2}\r\n                                    location='confirm_integration'\r\n                                >\r\n                                    {msg}\r\n                                </ExternalLink>\r\n                            ),\r\n                        }}\r\n                    />\r\n                </p>,\r\n            );\r\n        } else {\r\n            helpText.push(\r\n                <p key='add_oauth_app.doneHelp'>\r\n                    <FormattedMessage\r\n                        id='add_oauth_app.doneHelp'\r\n                        defaultMessage='Your OAuth 2.0 application is set up. Please use the following Client ID and Client Secret when requesting authorization for your application (details at <link>oAuth 2 Applications</link>).'\r\n                        values={{\r\n                            link: (msg) => (\r\n                                <ExternalLink\r\n                                    href={DeveloperLinks.SETUP_OAUTH2}\r\n                                    location='confirm_integration'\r\n                                >\r\n                                    {msg}\r\n                                </ExternalLink>\r\n                            ),\r\n                        }}\r\n                    />\r\n                </p>,\r\n            );\r\n        }\r\n\r\n        helpText.push(\r\n            <p key='add_oauth_app.clientId'>\r\n                <FormattedMessage\r\n                    id='add_oauth_app.clientId'\r\n                    defaultMessage='<b>Client ID</b>: {id}'\r\n                    values={{\r\n                        id: <code>{oauthAppToken}</code>,\r\n                        b: (chunks) => <b>{chunks}</b>,\r\n                    }}\r\n                />\r\n                <CopyText\r\n                    label={messages.copyClientId}\r\n                    value={oauthAppToken}\r\n                />\r\n                {!isPublicClient && (\r\n                    <>\r\n                        <br/>\r\n                        <FormattedMessage\r\n                            id='add_oauth_app.clientSecret'\r\n                            defaultMessage='<b>Client Secret</b>: {secret}'\r\n                            values={{\r\n                                secret: <code>{oauthAppSecret}</code>,\r\n                                b: (chunks) => <b>{chunks}</b>,\r\n                            }}\r\n                        />\r\n                        <CopyText\r\n                            label={messages.copyClientSecret}\r\n                            value={oauthAppSecret}\r\n                        />\r\n                    </>\r\n                )}\r\n            </p>,\r\n        );\r\n\r\n        helpText.push(\r\n            <p key='add_oauth_app.doneUrlHelp'>\r\n                <FormattedMessage\r\n                    id='add_oauth_app.doneUrlHelp'\r\n                    defaultMessage='Here are your authorized redirect URLs.'\r\n                />\r\n            </p>,\r\n        );\r\n\r\n        tokenText = (\r\n            <p className='word-break--all'>\r\n                <FormattedMessage\r\n                    id='add_oauth_app.url'\r\n                    defaultMessage='<b>URL(s)</b>: {url}'\r\n                    values={{\r\n                        url: oauthApp.callback_urls.join(', '),\r\n                        b: (chunks) => <b>{chunks}</b>,\r\n                    }}\r\n                />\r\n            </p>\r\n        );\r\n    } else if (type === Constants.Integrations.OUTGOING_OAUTH_CONNECTIONS && outgoingOAuthConnection) {\r\n        const clientId = outgoingOAuthConnection.client_id;\r\n        const clientSecret = outgoingOAuthConnection.client_secret;\r\n        const username = outgoingOAuthConnection.credentials_username;\r\n        const password = outgoingOAuthConnection.credentials_password;\r\n\r\n        headerText = (\r\n            <FormattedMessage\r\n                id='installed_outgoing_oauth_connections.header'\r\n                defaultMessage='Outgoing OAuth 2.0 Connections'\r\n            />\r\n        );\r\n\r\n        helpText = [];\r\n        helpText.push(\r\n            <p key='add_outgoing_oauth_connection.doneHelp'>\r\n                <FormattedMessage\r\n                    id='add_outgoing_oauth_connection.doneHelp'\r\n                    defaultMessage='Your Outgoing OAuth 2.0 Connection is set up. When a request is sent to one of the following Audience URLs, the Client ID and Client Secret will now be used to retrieve a token from the Token URL, before sending the integration request (details at <link>Outgoing OAuth 2.0 Connections</link>).'\r\n                    values={{\r\n                        link: (msg) => (\r\n                            <ExternalLink\r\n                                href={DeveloperLinks.SETUP_OAUTH2} // TODO: dev docs for outgoing oauth connections feature\r\n                                location='confirm_integration'\r\n                            >\r\n                                {msg}\r\n                            </ExternalLink>\r\n                        ),\r\n                    }}\r\n                />\r\n            </p>,\r\n        );\r\n        helpText.push(\r\n            <p key='add_outgoing_oauth_connection.clientId'>\r\n                <FormattedMessage\r\n                    id='add_outgoing_oauth_connection.clientId'\r\n                    defaultMessage='<b>Client ID</b>: {id}'\r\n                    values={{\r\n                        id: <code>{clientId}</code>,\r\n                        b: (chunks) => <b>{chunks}</b>,\r\n                    }}\r\n                />\r\n                <br/>\r\n                <FormattedMessage\r\n                    id='add_outgoing_oauth_connection.clientSecret'\r\n                    defaultMessage='<b>Client Secret</b>: \\*\\*\\*\\*\\*\\*\\*\\*'\r\n                    values={{\r\n                        secret: clientSecret,\r\n                        b: (chunks) => <b>{chunks}</b>,\r\n                    }}\r\n                />\r\n            </p>,\r\n        );\r\n\r\n        if (outgoingOAuthConnection.grant_type === 'password') {\r\n            helpText.push(\r\n                <p key='add_outgoing_oauth_connection.username'>\r\n                    <FormattedMessage\r\n                        id='add_outgoing_oauth_connection.username'\r\n                        defaultMessage='<b>Username</b>: {username}'\r\n                        values={{\r\n                            username,\r\n                            b: (chunks) => <b>{chunks}</b>,\r\n                        }}\r\n                    />\r\n                    <CopyText\r\n                        label={messages.copyUsername}\r\n                        value={username || ''}\r\n                    />\r\n                    <br/>\r\n                    <FormattedMessage\r\n                        id='add_outgoing_oauth_connection.password'\r\n                        defaultMessage='<b>Password</b>: {password}'\r\n                        values={{\r\n                            password,\r\n                            b: (chunks) => <b>{chunks}</b>,\r\n                        }}\r\n                    />\r\n                </p>,\r\n            );\r\n        }\r\n\r\n        tokenText = (\r\n            <>\r\n                <p className='word-break--all'>\r\n                    <FormattedMessage\r\n                        id='add_outgoing_oauth_connection.token_url'\r\n                        defaultMessage='<b>Token URL</b>: {url}'\r\n                        values={{\r\n                            url: <code>{outgoingOAuthConnection.oauth_token_url}</code>,\r\n                            b: (chunks) => <b>{chunks}</b>,\r\n                        }}\r\n                    />\r\n                </p>\r\n                <p className='word-break--all'>\r\n                    <FormattedMessage\r\n                        id='add_outgoing_oauth_connection.audience_urls'\r\n                        defaultMessage='<b>Audience URL(s)</b>: {url}'\r\n                        values={{\r\n                            url: <code>{outgoingOAuthConnection.audiences.join(', ')}</code>,\r\n                            b: (chunks) => <b>{chunks}</b>,\r\n                        }}\r\n                    />\r\n                </p>\r\n            </>\r\n        );\r\n    } else if (type === Constants.Integrations.BOT && bot) {\r\n        const botToken = (new URLSearchParams(location.search)).get('token') || '';\r\n\r\n        headerText = (\r\n            <FormattedMessage\r\n                id='bots.manage.header'\r\n                defaultMessage='Bot Accounts'\r\n            />\r\n        );\r\n        helpText = (\r\n            <p>\r\n                <FormattedMessage\r\n                    id='bots.manage.created.text'\r\n                    defaultMessage='Your bot account **{botname}** has been created successfully. Please use the following access token to connect to the bot (see [documentation](https://mattermost.com/pl/default-bot-accounts) for further details).'\r\n                    values={{\r\n                        botname: bot.display_name || bot.username,\r\n                        b: (msg) => <b>{msg}</b>,\r\n                        link: (msg) => (\r\n                            <ExternalLink\r\n                                href='https://mattermost.com/pl/default-bot-accounts'\r\n                                location='confirm_integration'\r\n                            >\r\n                                {msg}\r\n                            </ExternalLink>\r\n                        ),\r\n                    }}\r\n                />\r\n            </p>\r\n        );\r\n        tokenText = (\r\n            <p className='word-break--all'>\r\n                <FormattedMessage\r\n                    id='add_outgoing_webhook.token'\r\n                    defaultMessage='<b>Token</b>: {token}'\r\n                    values={{\r\n                        token: <code>{botToken}</code>,\r\n                        b: (chunks) => <b>{chunks}</b>,\r\n                    }}\r\n                />\r\n                <CopyText\r\n                    label={messages.copyToken}\r\n                    value={botToken}\r\n                />\r\n                <br/>\r\n                <br/>\r\n                <FormattedMessage\r\n                    id='add_outgoing_webhook.token.message'\r\n                    defaultMessage='Make sure to add this bot account to teams and channels you want it to interact in. See <link>documentation</link> to learn more.'\r\n                    values={{\r\n                        link: (msg) => (\r\n                            <ExternalLink\r\n                                href='https://mattermost.com/pl/default-bot-accounts'\r\n                                location='confirm_integration'\r\n                            >\r\n                                {msg}\r\n                            </ExternalLink>\r\n                        ),\r\n                    }}\r\n                />\r\n            </p>\r\n        );\r\n    } else {\r\n        history.replace(`/error?type=${ErrorPageTypes.PAGE_NOT_FOUND}`);\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <div className='backstage-content row'>\r\n            <BackstageHeader>\r\n                <Link to={'/' + team.name + '/integrations/' + type}>\r\n                    {headerText}\r\n                </Link>\r\n                <FormattedMessage\r\n                    id='integrations.add'\r\n                    defaultMessage='Add'\r\n                />\r\n            </BackstageHeader>\r\n            <div className='backstage-form backstage-form__confirmation'>\r\n                <h4\r\n                    className='backstage-form__title'\r\n                    id='formTitle'\r\n                >\r\n                    <FormattedMessage\r\n                        id='integrations.successful'\r\n                        defaultMessage='Setup Successful'\r\n                    />\r\n                </h4>\r\n                {helpText}\r\n                {tokenText}\r\n                <div className='backstage-form__footer'>\r\n                    <Link\r\n                        className='btn btn-primary'\r\n                        type='submit'\r\n                        to={'/' + team.name + '/integrations/' + type}\r\n                        id='doneButton'\r\n                    >\r\n                        <FormattedMessage\r\n                            id='integrations.done'\r\n                            defaultMessage='Done'\r\n                        />\r\n                    </Link>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst messages = defineMessages({\r\n    copyClientId: {\r\n        id: 'integrations.copy_client_id',\r\n        defaultMessage: 'Copy Client Id',\r\n    },\r\n    copyClientSecret: {\r\n        id: 'integrations.copy_client_secret',\r\n        defaultMessage: 'Copy Client Secret',\r\n    },\r\n    copyToken: {\r\n        id: 'integrations.copy_token',\r\n        defaultMessage: 'Copy Token',\r\n    },\r\n    copyUsername: {\r\n        id: 'integrations.copy_username',\r\n        defaultMessage: 'Copy Username',\r\n    },\r\n});\r\n\r\nexport default ConfirmIntegration;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\n\r\nimport {getBotAccounts} from 'mattermost-redux/selectors/entities/bots';\r\nimport {getCommands, getOAuthApps, getIncomingHooks, getOutgoingHooks, getOutgoingOAuthConnections} from 'mattermost-redux/selectors/entities/integrations';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport ConfirmIntegration from './confirm_integration';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    return {\r\n        commands: getCommands(state),\r\n        oauthApps: getOAuthApps(state),\r\n        incomingHooks: getIncomingHooks(state),\r\n        outgoingHooks: getOutgoingHooks(state),\r\n        bots: getBotAccounts(state),\r\n        outgoingOAuthConnections: getOutgoingOAuthConnections(state),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps)(ConfirmIntegration);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage, defineMessages} from 'react-intl';\r\n\r\nimport type {Command} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\nimport type {RelationOneToOne} from '@mattermost/types/utilities';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport ConfirmModal from 'components/confirm_modal';\r\nimport LoadingScreen from 'components/loading_screen';\r\n\r\nimport {getHistory} from 'utils/browser_history';\r\n\r\nimport AbstractCommand from '../abstract_command';\r\n\r\nconst messages = defineMessages({\r\n    footer: {\r\n        id: 'edit_command.update',\r\n        defaultMessage: 'Update',\r\n    },\r\n    header: {\r\n        id: 'integrations.edit',\r\n        defaultMessage: 'Edit',\r\n    },\r\n    loading: {\r\n        id: 'edit_command.updating',\r\n        defaultMessage: 'Updating...',\r\n    },\r\n});\r\n\r\ntype Props = {\r\n\r\n    /**\r\n    * The current team\r\n    */\r\n    team: Team;\r\n\r\n    /**\r\n    * The id of the command to edit\r\n    */\r\n    commandId: string | null;\r\n\r\n    /**\r\n    * Installed slash commands to display\r\n    */\r\n    commands: RelationOneToOne<Command, Command>;\r\n    actions: {\r\n\r\n        /**\r\n        * The function to call to fetch team commands\r\n        */\r\n        getCustomTeamCommands: (teamId: string) => Promise<ActionResult>;\r\n\r\n        /**\r\n        * The function to call to edit command\r\n        */\r\n        editCommand: (command: Command) => Promise<ActionResult>;\r\n    };\r\n\r\n    /**\r\n    * Whether or not commands are enabled.\r\n    */\r\n    enableCommands: boolean;\r\n}\r\n\r\ntype State = {\r\n    originalCommand: Command | null;\r\n    showConfirmModal: boolean;\r\n    serverError: string;\r\n}\r\n\r\nexport default class EditCommand extends React.PureComponent<Props, State> {\r\n    private newCommand?: Command;\r\n\r\n    public constructor(props: Props) {\r\n        super(props);\r\n        this.newCommand = undefined;\r\n\r\n        this.state = {\r\n            originalCommand: null,\r\n            showConfirmModal: false,\r\n            serverError: '',\r\n        };\r\n    }\r\n\r\n    public componentDidMount(): void {\r\n        if (this.props.enableCommands) {\r\n            this.props.actions.getCustomTeamCommands(this.props.team.id).then(\r\n                () => {\r\n                    this.setState({\r\n                        originalCommand: Object.values(this.props.commands).filter((command) => command.id === this.props.commandId)[0],\r\n                    });\r\n                },\r\n            );\r\n        }\r\n    }\r\n\r\n    public editCommand = async (command: Command): Promise<void> => {\r\n        this.newCommand = command;\r\n\r\n        if (this.state.originalCommand?.id) {\r\n            command.id = this.state.originalCommand.id;\r\n        }\r\n\r\n        if (this.state.originalCommand?.url !== this.newCommand.url ||\r\n            this.state.originalCommand?.trigger !== this.newCommand.trigger ||\r\n            this.state.originalCommand?.method !== this.newCommand.method) {\r\n            this.handleConfirmModal();\r\n        } else {\r\n            await this.submitCommand();\r\n        }\r\n    };\r\n\r\n    public handleConfirmModal = (): void => {\r\n        this.setState({showConfirmModal: true});\r\n    };\r\n\r\n    public confirmModalDismissed = (): void => {\r\n        this.setState({showConfirmModal: false});\r\n    };\r\n\r\n    public submitCommand = async (): Promise<void> => {\r\n        this.setState({serverError: ''});\r\n\r\n        const {data, error} = await this.props.actions.editCommand(this.newCommand!);\r\n\r\n        if (data) {\r\n            getHistory().push(`/${this.props.team.name}/integrations/commands`);\r\n            return;\r\n        }\r\n\r\n        this.setState({showConfirmModal: false});\r\n\r\n        if (error) {\r\n            this.setState({serverError: error.message});\r\n        }\r\n    };\r\n\r\n    public renderExtra = (): JSX.Element => {\r\n        const confirmButton = (\r\n            <FormattedMessage\r\n                id='update_command.update'\r\n                defaultMessage='Update'\r\n            />\r\n        );\r\n\r\n        const confirmTitle = (\r\n            <FormattedMessage\r\n                id='update_command.confirm'\r\n                defaultMessage='Edit Slash Command'\r\n            />\r\n        );\r\n\r\n        const confirmMessage = (\r\n            <FormattedMessage\r\n                id='update_command.question'\r\n                defaultMessage='Your changes may break the existing slash command. Are you sure you would like to update it?'\r\n            />\r\n        );\r\n\r\n        return (\r\n            <ConfirmModal\r\n                title={confirmTitle}\r\n                message={confirmMessage}\r\n                confirmButtonText={confirmButton}\r\n                modalClass='integrations-backstage-modal'\r\n                show={this.state.showConfirmModal}\r\n                onConfirm={this.submitCommand}\r\n                onCancel={this.confirmModalDismissed}\r\n            />\r\n        );\r\n    };\r\n\r\n    public render(): JSX.Element {\r\n        if (!this.state.originalCommand) {\r\n            return <LoadingScreen/>;\r\n        }\r\n\r\n        return (\r\n            <AbstractCommand\r\n                team={this.props.team}\r\n                header={messages.header}\r\n                footer={messages.footer}\r\n                loading={messages.loading}\r\n                renderExtra={this.renderExtra()}\r\n                action={this.editCommand}\r\n                serverError={this.state.serverError}\r\n                initialCommand={this.state.originalCommand}\r\n            />\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {editCommand, getCustomTeamCommands} from 'mattermost-redux/actions/integrations';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {getCommands} from 'mattermost-redux/selectors/entities/integrations';\r\n\r\nimport EditCommand from './edit_command';\r\n\r\ntype Props = {\r\n    location: Location;\r\n}\r\n\r\nfunction mapStateToProps(state: GlobalState, ownProps: Props) {\r\n    const config = getConfig(state);\r\n    const commandId = (new URLSearchParams(ownProps.location.search)).get('id');\r\n    const enableCommands = config.EnableCommands === 'true';\r\n\r\n    return {\r\n        commandId,\r\n        commands: getCommands(state),\r\n        enableCommands,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            getCustomTeamCommands,\r\n            editCommand,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(EditCommand);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {defineMessage, FormattedMessage} from 'react-intl';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport type {Command} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\n\r\nimport CopyText from 'components/copy_text';\r\n\r\nimport DeleteIntegrationLink from './delete_integration_link';\r\n\r\ntype Props = {\r\n\r\n    /**\r\n     * The team data\r\n     */\r\n    team: Team;\r\n\r\n    /**\r\n     * Installed slash command to display\r\n     */\r\n    command: Command;\r\n\r\n    /**\r\n     * The function to call when Regenerate Token link is clicked\r\n     */\r\n    onRegenToken: (command: Command) => void ;\r\n\r\n    /**\r\n     * The function to call when Delete link is clicked\r\n     */\r\n    onDelete: (command: Command) => void ;\r\n\r\n    /**\r\n     * Set to filter command, comes from BackstageList\r\n     */\r\n    filter?: string;\r\n\r\n    /**\r\n     * The creator user data\r\n     */\r\n    creator: UserProfile;\r\n\r\n    /**\r\n     * Set to show edit link\r\n     */\r\n    canChange: boolean;\r\n}\r\n\r\nexport function matchesFilter(command: Command, filter?: string) {\r\n    if (!filter) {\r\n        return true;\r\n    }\r\n\r\n    return command.display_name.toLowerCase().indexOf(filter) !== -1 ||\r\n        command.description.toLowerCase().indexOf(filter) !== -1 ||\r\n        command.trigger.toLowerCase().indexOf(filter) !== -1;\r\n}\r\n\r\nexport default class InstalledCommand extends React.PureComponent<Props> {\r\n    handleRegenToken = (e: React.MouseEvent) => {\r\n        e.preventDefault();\r\n\r\n        this.props.onRegenToken(this.props.command);\r\n    };\r\n\r\n    handleDelete = () => {\r\n        this.props.onDelete(this.props.command);\r\n    };\r\n\r\n    render() {\r\n        const command = this.props.command;\r\n        const filter = this.props.filter ? this.props.filter.toLowerCase() : '';\r\n\r\n        if (!matchesFilter(command, filter)) {\r\n            return null;\r\n        }\r\n\r\n        let name;\r\n\r\n        if (command.display_name) {\r\n            name = command.display_name;\r\n        } else {\r\n            name = (\r\n                <FormattedMessage\r\n                    id='installed_commands.unnamed_command'\r\n                    defaultMessage='Unnamed Slash Command'\r\n                />\r\n            );\r\n        }\r\n\r\n        let description = null;\r\n        if (command.description) {\r\n            description = (\r\n                <div className='item-details__row'>\r\n                    <span className='item-details__description'>\r\n                        {command.description}\r\n                    </span>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        let trigger = '- /' + command.trigger;\r\n        if (command.auto_complete && command.auto_complete_hint) {\r\n            trigger += ' ' + command.auto_complete_hint;\r\n        }\r\n\r\n        let actions = null;\r\n        if (this.props.canChange) {\r\n            actions = (\r\n                <div className='item-actions'>\r\n                    <button\r\n                        className='style--none color--link'\r\n                        onClick={this.handleRegenToken}\r\n                    >\r\n                        <FormattedMessage\r\n                            id='installed_integrations.regenToken'\r\n                            defaultMessage='Regenerate Token'\r\n                        />\r\n                    </button>\r\n                    {' - '}\r\n                    <Link to={`/${this.props.team.name}/integrations/commands/edit?id=${command.id}`}>\r\n                        <FormattedMessage\r\n                            id='installed_integrations.edit'\r\n                            defaultMessage='Edit'\r\n                        />\r\n                    </Link>\r\n                    {' - '}\r\n                    <DeleteIntegrationLink\r\n                        modalMessage={\r\n                            <FormattedMessage\r\n                                id='installed_commands.delete.confirm'\r\n                                defaultMessage='This action permanently deletes the slash command and breaks any integrations using it. Are you sure you want to delete it?'\r\n                            />\r\n                        }\r\n                        onDelete={this.handleDelete}\r\n                    />\r\n                </div>\r\n            );\r\n        }\r\n\r\n        const commandToken = command.token;\r\n\r\n        return (\r\n            <div className='backstage-list__item'>\r\n                <div className='item-details'>\r\n                    <div className='item-details__row d-flex flex-column flex-md-row justify-content-between'>\r\n                        <div className='item-details__name'>\r\n                            <strong>\r\n                                {name}\r\n                            </strong>\r\n                        </div>\r\n                        <span className='item-details__trigger'>\r\n                            {trigger}\r\n                        </span>\r\n                        {actions}\r\n                    </div>\r\n                    {description}\r\n                    <div className='item-details__row'>\r\n                        <span className='item-details__token'>\r\n                            <FormattedMessage\r\n                                id='installed_integrations.token'\r\n                                defaultMessage='Token: {token}'\r\n                                values={{\r\n                                    token: <code>{commandToken}</code>,\r\n                                }}\r\n                            />\r\n                            <CopyText\r\n                                label={defineMessage({\r\n                                    id: 'integrations.copy_token',\r\n                                    defaultMessage: 'Copy Token',\r\n                                })}\r\n                                value={commandToken}\r\n                            />\r\n                        </span>\r\n                    </div>\r\n                    <div className='item-details__row'>\r\n                        <span className='item-details__creation'>\r\n                            <FormattedMessage\r\n                                id='installed_integrations.creation'\r\n                                defaultMessage='Created by {creator} on {createAt, date, full}'\r\n                                values={{\r\n                                    creator: this.props.creator.username,\r\n                                    createAt: command.create_at,\r\n                                }}\r\n                            />\r\n                        </span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport type {Command} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\nimport type {RelationOneToOne} from '@mattermost/types/utilities';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport BackstageList from 'components/backstage/components/backstage_list';\r\nimport ExternalLink from 'components/external_link';\r\n\r\nimport {DeveloperLinks} from 'utils/constants';\r\nimport * as Utils from 'utils/utils';\r\n\r\nimport InstalledCommand, {matchesFilter} from '../installed_command';\r\n\r\ntype Props = {\r\n    team: Team;\r\n    user: UserProfile;\r\n    users: RelationOneToOne<UserProfile, UserProfile>;\r\n\r\n    // Installed slash commands to display\r\n    commands: Command[];\r\n    loading: boolean;\r\n\r\n    // Set to allow changes to installed slash commands\r\n    canManageOthersSlashCommands: boolean;\r\n    actions: {\r\n\r\n        // The function to call when Regenerate Token link is clicked\r\n        regenCommandToken: (id: string) => Promise<ActionResult>;\r\n\r\n        // The function to call when Delete link is clicked\r\n        deleteCommand: (id: string) => Promise<ActionResult>;\r\n    };\r\n}\r\n\r\nexport default class InstalledCommands extends React.PureComponent<Props> {\r\n    public regenCommandToken = (command: Command): void => {\r\n        this.props.actions.regenCommandToken(command.id);\r\n    };\r\n\r\n    public deleteCommand = (command: Command): void => {\r\n        this.props.actions.deleteCommand(command.id);\r\n    };\r\n\r\n    private commandCompare(a: Command, b: Command) {\r\n        let nameA = a.display_name;\r\n        if (!nameA) {\r\n            nameA = Utils.localizeMessage({id: 'installed_commands.unnamed_command', defaultMessage: 'Unnamed Slash Command'});\r\n        }\r\n\r\n        let nameB = b.display_name;\r\n        if (!nameB) {\r\n            nameB = Utils.localizeMessage({id: 'installed_commands.unnamed_command', defaultMessage: 'Unnamed Slash Command'});\r\n        }\r\n\r\n        return nameA.localeCompare(nameB);\r\n    }\r\n\r\n    public render(): JSX.Element {\r\n        const commands = (filter: string) => this.props.commands.\r\n            filter((command) => command.team_id === this.props.team.id).\r\n            filter((command) => matchesFilter(command, filter)).\r\n            sort(this.commandCompare).map((command) => {\r\n                const canChange = this.props.canManageOthersSlashCommands || this.props.user.id === command.creator_id;\r\n\r\n                return (\r\n                    <InstalledCommand\r\n                        key={command.id}\r\n                        team={this.props.team}\r\n                        command={command}\r\n                        onRegenToken={this.regenCommandToken}\r\n                        onDelete={this.deleteCommand}\r\n                        creator={this.props.users[command.creator_id] || {}}\r\n                        canChange={canChange}\r\n                    />\r\n                );\r\n            });\r\n\r\n        return (\r\n            <BackstageList\r\n                header={\r\n                    <FormattedMessage\r\n                        id='installed_commands.header'\r\n                        defaultMessage='Installed Slash Commands'\r\n                    />\r\n                }\r\n                addText={\r\n                    <FormattedMessage\r\n                        id='installed_commands.add'\r\n                        defaultMessage='Add Slash Command'\r\n                    />\r\n                }\r\n                addLink={'/' + this.props.team.name + '/integrations/commands/add'}\r\n                addButtonId='addSlashCommand'\r\n                emptyText={\r\n                    <FormattedMessage\r\n                        id='installed_commands.empty'\r\n                        defaultMessage='No slash commands found'\r\n                    />\r\n                }\r\n                emptyTextSearch={\r\n                    <FormattedMessage\r\n                        id='installed_commands.search.empty'\r\n                        defaultMessage='No slash commands match <b>{searchTerm}</b>'\r\n                        values={{\r\n                            b: (chunks) => <b>{chunks}</b>,\r\n                        }}\r\n                    />\r\n                }\r\n                helpText={\r\n                    <FormattedMessage\r\n                        id='installed_commands.help'\r\n                        defaultMessage='Use slash commands to connect external tools to Mattermost. {buildYourOwn} or visit the {appDirectory} to find self-hosted, third-party apps and integrations.'\r\n                        values={{\r\n                            buildYourOwn: (\r\n                                <ExternalLink\r\n                                    href={DeveloperLinks.SETUP_CUSTOM_SLASH_COMMANDS}\r\n                                    location='installed_commands'\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='installed_commands.help.buildYourOwn'\r\n                                        defaultMessage='Build Your Own'\r\n                                    />\r\n                                </ExternalLink>\r\n                            ),\r\n                            appDirectory: (\r\n                                <ExternalLink\r\n                                    href='https://mattermost.com/marketplace'\r\n                                    location='installed_commands'\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='installed_commands.help.appDirectory'\r\n                                        defaultMessage='App Directory'\r\n                                    />\r\n                                </ExternalLink>\r\n                            ),\r\n                        }}\r\n                    />\r\n                }\r\n                searchPlaceholder={Utils.localizeMessage({id: 'installed_commands.search', defaultMessage: 'Search Slash Commands'})}\r\n                loading={this.props.loading}\r\n            >\r\n                {(filter: string) => {\r\n                    const children = commands(filter);\r\n                    return [children, children.length > 0];\r\n                }}\r\n            </BackstageList>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {deleteCommand, regenCommandToken} from 'mattermost-redux/actions/integrations';\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {haveITeamPermission} from 'mattermost-redux/selectors/entities/roles';\r\n\r\nimport InstalledCommands from './installed_commands';\r\n\r\ntype Props = {\r\n    team: {\r\n        id: string;\r\n    };\r\n}\r\n\r\nfunction mapStateToProps(state: GlobalState, ownProps: Props) {\r\n    const canManageOthersSlashCommands = haveITeamPermission(state, ownProps.team.id, Permissions.MANAGE_OTHERS_SLASH_COMMANDS);\r\n\r\n    return {\r\n        canManageOthersSlashCommands,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            regenCommandToken,\r\n            deleteCommand,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(InstalledCommands);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {Route, Switch, Redirect} from 'react-router-dom';\r\n\r\nimport type {Command} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\nimport type {RelationOneToOne} from '@mattermost/types/utilities';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport AddCommand from 'components/integrations/add_command';\r\nimport ConfirmIntegration from 'components/integrations/confirm_integration';\r\nimport EditCommand from 'components/integrations/edit_command';\r\nimport InstalledCommands from 'components/integrations/installed_commands';\r\n\r\ninterface IProps {\r\n    component: any;\r\n    extraProps: {\r\n        loading: boolean;\r\n        commands: Command[];\r\n        users?: RelationOneToOne<UserProfile, UserProfile>;\r\n        team?: Team;\r\n        user?: UserProfile;\r\n    };\r\n    path: string;\r\n}\r\n\r\nconst CommandRoute = ({component: Component, extraProps, ...rest}: IProps) => (\r\n    <Route\r\n        {...rest}\r\n        render={(props) => (\r\n            <Component\r\n                {...extraProps}\r\n                {...props}\r\n            />\r\n        )}\r\n    />\r\n);\r\n\r\ntype Props = {\r\n\r\n    /**\r\n     * The team data needed to pass into child components\r\n     */\r\n    team?: Team;\r\n\r\n    /**\r\n     * The user data needed to pass into child components\r\n     */\r\n    user?: UserProfile;\r\n\r\n    /**\r\n     * The users collection\r\n     */\r\n    users?: RelationOneToOne<UserProfile, UserProfile>;\r\n\r\n    /**\r\n     * Installed slash commands to display\r\n     */\r\n    commands: Command[];\r\n\r\n    /**\r\n     * Object from react-router\r\n     */\r\n    match: {\r\n        url: string;\r\n    };\r\n\r\n    actions: {\r\n\r\n        /**\r\n         * The function to call to fetch team commands\r\n         */\r\n        loadCommandsAndProfilesForTeam: (teamId: string) => Promise<ActionResult>;\r\n    };\r\n\r\n    /**\r\n     * Whether or not commands are enabled.\r\n     */\r\n    enableCommands?: boolean;\r\n};\r\n\r\ntype State = {\r\n    loading: boolean;\r\n};\r\n\r\nexport default class CommandsContainer extends React.PureComponent<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n        this.state = {\r\n            loading: true,\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (this.props.enableCommands) {\r\n            this.props.actions.loadCommandsAndProfilesForTeam(this.props.team?.id || '').then(\r\n                () => this.setState({loading: false}),\r\n            );\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const extraProps = {\r\n            loading: this.state.loading,\r\n            commands: this.props.commands || [],\r\n            users: this.props.users,\r\n            team: this.props.team,\r\n            user: this.props.user,\r\n        };\r\n        return (\r\n            <div>\r\n                <Switch>\r\n                    <Route\r\n                        exact={true}\r\n                        path={`${this.props.match.url}/`}\r\n                        render={() => (<Redirect to={`${this.props.match.url}/installed`}/>)}\r\n                    />\r\n                    <CommandRoute\r\n                        extraProps={extraProps}\r\n                        path={`${this.props.match.url}/installed`}\r\n                        component={InstalledCommands}\r\n                    />\r\n                    <CommandRoute\r\n                        extraProps={extraProps}\r\n                        path={`${this.props.match.url}/add`}\r\n                        component={AddCommand}\r\n                    />\r\n                    <CommandRoute\r\n                        extraProps={extraProps}\r\n                        path={`${this.props.match.url}/edit`}\r\n                        component={EditCommand}\r\n                    />\r\n                    <CommandRoute\r\n                        extraProps={extraProps}\r\n                        path={`${this.props.match.url}/confirm`}\r\n                        component={ConfirmIntegration}\r\n                    />\r\n                </Switch>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {AnyAction, Dispatch} from 'redux';\r\n\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {getCommands} from 'mattermost-redux/selectors/entities/integrations';\r\nimport {getUsers} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {loadCommandsAndProfilesForTeam} from 'actions/integration_actions';\r\n\r\nimport CommandsContainer from './commands_container';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const config = getConfig(state);\r\n    const enableCommands = config.EnableCommands === 'true';\r\n\r\n    return {\r\n        commands: Object.values(getCommands(state)),\r\n        users: getUsers(state),\r\n        enableCommands,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch<AnyAction>) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            loadCommandsAndProfilesForTeam,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(CommandsContainer);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {defineMessages} from 'react-intl';\r\n\r\nimport type {IncomingWebhook} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport AbstractIncomingWebhook from 'components/integrations/abstract_incoming_webhook';\r\nimport LoadingScreen from 'components/loading_screen';\r\n\r\nimport {getHistory} from 'utils/browser_history';\r\n\r\nconst messages = defineMessages({\r\n    footer: {\r\n        id: 'update_incoming_webhook.update',\r\n        defaultMessage: 'Update',\r\n    },\r\n    header: {\r\n        id: 'integrations.edit',\r\n        defaultMessage: 'Edit',\r\n    },\r\n    loading: {\r\n        id: 'update_incoming_webhook.updating',\r\n        defaultMessage: 'Updating...',\r\n    },\r\n});\r\n\r\ntype Props = {\r\n\r\n    /**\r\n     * The current team\r\n     */\r\n    team: Team;\r\n\r\n    /**\r\n     * The incoming webhook to edit\r\n     */\r\n    hook?: IncomingWebhook;\r\n\r\n    /**\r\n     * The id of the incoming webhook to edit\r\n     */\r\n    hookId: string;\r\n\r\n    /**\r\n     * Whether or not incoming webhooks are enabled.\r\n     */\r\n    enableIncomingWebhooks: boolean;\r\n\r\n    /**\r\n     * Whether to allow configuration of the default post username.\r\n     */\r\n    enablePostUsernameOverride: boolean;\r\n\r\n    /**\r\n     * Whether to allow configuration of the default post icon.\r\n     */\r\n    enablePostIconOverride: boolean;\r\n\r\n    /**\r\n     * Whether the user can bypass the channel lock requirement.\r\n     */\r\n    canBypassChannelLock?: boolean;\r\n\r\n    actions: {\r\n\r\n        /**\r\n         * The function to call to update an incoming webhook\r\n         */\r\n        updateIncomingHook: (hook: IncomingWebhook) => Promise<ActionResult>;\r\n\r\n        /**\r\n         * The function to call to get an incoming webhook\r\n         */\r\n        getIncomingHook: (hookId: string) => Promise<ActionResult>;\r\n    };\r\n};\r\n\r\ntype State = {\r\n    serverError: string;\r\n};\r\n\r\nexport default class EditIncomingWebhook extends React.PureComponent<Props, State> {\r\n    private newHook?: IncomingWebhook;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            serverError: '',\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (this.props.enableIncomingWebhooks) {\r\n            this.props.actions.getIncomingHook(this.props.hookId);\r\n        }\r\n    }\r\n\r\n    editIncomingHook = async (hook: IncomingWebhook) => {\r\n        this.newHook = hook;\r\n\r\n        if (this.props.hook?.id) {\r\n            hook.id = this.props.hook.id;\r\n        }\r\n\r\n        await this.submitHook();\r\n    };\r\n\r\n    submitHook = async () => {\r\n        this.setState({serverError: ''});\r\n\r\n        if (!this.newHook) {\r\n            return;\r\n        }\r\n\r\n        const result = await this.props.actions.updateIncomingHook(this.newHook);\r\n\r\n        if ('data' in result) {\r\n            getHistory().push(`/${this.props.team.name}/integrations/incoming_webhooks`);\r\n            return;\r\n        }\r\n\r\n        if ('error' in result) {\r\n            const {error} = result;\r\n            this.setState({serverError: error.message});\r\n        }\r\n    };\r\n\r\n    render() {\r\n        if (!this.props.hook) {\r\n            return <LoadingScreen/>;\r\n        }\r\n\r\n        return (\r\n            <AbstractIncomingWebhook\r\n                team={this.props.team}\r\n                header={messages.header}\r\n                footer={messages.footer}\r\n                loading={messages.loading}\r\n                enablePostUsernameOverride={this.props.enablePostUsernameOverride}\r\n                enablePostIconOverride={this.props.enablePostIconOverride}\r\n                canBypassChannelLock={this.props.canBypassChannelLock}\r\n                action={this.editIncomingHook}\r\n                serverError={this.state.serverError}\r\n                initialHook={this.props.hook}\r\n            />\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {getIncomingHook, updateIncomingHook} from 'mattermost-redux/actions/integrations';\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {haveICurrentTeamPermission} from 'mattermost-redux/selectors/entities/roles';\r\n\r\nimport EditIncomingWebhook from './edit_incoming_webhook';\r\n\r\ntype Props = {\r\n    location: Location;\r\n}\r\n\r\nfunction mapStateToProps(state: GlobalState, ownProps: Props) {\r\n    const config = getConfig(state);\r\n    const enableIncomingWebhooks = config.EnableIncomingWebhooks === 'true';\r\n    const enablePostUsernameOverride = config.EnablePostUsernameOverride === 'true';\r\n    const enablePostIconOverride = config.EnablePostIconOverride === 'true';\r\n    const hookId = (new URLSearchParams(ownProps.location.search)).get('id') || '';\r\n    const canBypassChannelLock = haveICurrentTeamPermission(state, Permissions.BYPASS_INCOMING_WEBHOOK_CHANNEL_LOCK);\r\n\r\n    return {\r\n        hookId,\r\n        hook: state.entities.integrations.incomingHooks[hookId],\r\n        enableIncomingWebhooks,\r\n        enablePostUsernameOverride,\r\n        enablePostIconOverride,\r\n        canBypassChannelLock,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            updateIncomingHook,\r\n            getIncomingHook,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(EditIncomingWebhook);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport type {OAuthApp} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport ConfirmModal from 'components/confirm_modal';\r\nimport LoadingScreen from 'components/loading_screen';\r\n\r\nimport {getHistory} from 'utils/browser_history';\r\n\r\nimport AbstractOAuthApp from '../abstract_oauth_app';\r\n\r\nconst HEADER = {id: 'integrations.edit', defaultMessage: 'Edit'};\r\nconst FOOTER = {id: 'update_incoming_webhook.update', defaultMessage: 'Update'};\r\nconst LOADING = {id: 'update_incoming_webhook.updating', defaultMessage: 'Updating...'};\r\n\r\ntype Actions = {\r\n    getOAuthApp: (id: string) => void;\r\n    editOAuthApp: (app: OAuthApp) => Promise<ActionResult>;\r\n};\r\n\r\ntype Props = {\r\n    team: Team;\r\n    oauthAppId: string;\r\n    oauthApp: OAuthApp;\r\n    actions: Actions;\r\n    enableOAuthServiceProvider: boolean;\r\n};\r\n\r\ntype State = {\r\n    showConfirmModal: boolean;\r\n    serverError: string;\r\n};\r\n\r\nexport default class EditOAuthApp extends React.PureComponent<Props, State> {\r\n    newApp: OAuthApp;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            showConfirmModal: false,\r\n            serverError: '',\r\n        };\r\n        this.newApp = this.props.oauthApp;\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (this.props.enableOAuthServiceProvider) {\r\n            this.props.actions.getOAuthApp(this.props.oauthAppId);\r\n        }\r\n    }\r\n\r\n    editOAuthApp = async (app: OAuthApp) => {\r\n        this.newApp = app;\r\n\r\n        if (this.props.oauthApp.id) {\r\n            app.id = this.props.oauthApp.id;\r\n        }\r\n\r\n        const callbackUrlsSame = (this.props.oauthApp.callback_urls.length === app.callback_urls.length) &&\r\n            this.props.oauthApp.callback_urls.every((v, i) => v === app.callback_urls[i]);\r\n\r\n        if (callbackUrlsSame === false) {\r\n            this.handleConfirmModal();\r\n        } else {\r\n            await this.submitOAuthApp();\r\n        }\r\n    };\r\n\r\n    handleConfirmModal = () => {\r\n        this.setState({showConfirmModal: true});\r\n    };\r\n\r\n    confirmModalDismissed = () => {\r\n        this.setState({showConfirmModal: false});\r\n    };\r\n\r\n    submitOAuthApp = async () => {\r\n        this.setState({serverError: ''});\r\n\r\n        const res = await this.props.actions.editOAuthApp(this.newApp);\r\n\r\n        if ('data' in res && res.data) {\r\n            getHistory().push(`/${this.props.team.name}/integrations/oauth2-apps`);\r\n            return;\r\n        }\r\n\r\n        this.setState({showConfirmModal: false});\r\n\r\n        if ('error' in res) {\r\n            const {error: err} = res;\r\n            this.setState({serverError: err.message});\r\n        }\r\n    };\r\n\r\n    renderExtra = () => {\r\n        const confirmButton = (\r\n            <FormattedMessage\r\n                id='update_command.update'\r\n                defaultMessage='Update'\r\n            />\r\n        );\r\n\r\n        const confirmTitle = (\r\n            <FormattedMessage\r\n                id='update_oauth_app.confirm'\r\n                defaultMessage='Edit OAuth 2.0 application'\r\n            />\r\n        );\r\n\r\n        const confirmMessage = (\r\n            <FormattedMessage\r\n                id='update_oauth_app.question'\r\n                defaultMessage='Your changes may break the existing OAuth 2.0 application. Are you sure you would like to update it?'\r\n            />\r\n        );\r\n\r\n        return (\r\n            <ConfirmModal\r\n                title={confirmTitle}\r\n                message={confirmMessage}\r\n                confirmButtonText={confirmButton}\r\n                modalClass='integrations-backstage-modal'\r\n                show={this.state.showConfirmModal}\r\n                onConfirm={this.submitOAuthApp}\r\n                onCancel={this.confirmModalDismissed}\r\n            />\r\n        );\r\n    };\r\n\r\n    render() {\r\n        if (!this.props.oauthApp) {\r\n            return <LoadingScreen/>;\r\n        }\r\n\r\n        return (\r\n            <AbstractOAuthApp\r\n                team={this.props.team}\r\n                header={HEADER}\r\n                footer={FOOTER}\r\n                loading={LOADING}\r\n                renderExtra={this.renderExtra()}\r\n                action={this.editOAuthApp}\r\n                serverError={this.state.serverError}\r\n                initialApp={this.props.oauthApp}\r\n            />\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\n// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {getOAuthApp, editOAuthApp} from 'mattermost-redux/actions/integrations';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\n\r\nimport EditOAuthApp from './edit_oauth_app';\r\n\r\ntype Props = {\r\n    location: Location;\r\n};\r\n\r\nfunction mapStateToProps(state: GlobalState, ownProps: Props) {\r\n    const config = getConfig(state);\r\n    const oauthAppId: string = (new URLSearchParams(ownProps.location.search)).get('id') || '';\r\n    const enableOAuthServiceProvider = config.EnableOAuthServiceProvider === 'true';\r\n\r\n    return {\r\n        oauthAppId,\r\n        oauthApp: state.entities.integrations.oauthApps[oauthAppId],\r\n        enableOAuthServiceProvider,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            getOAuthApp,\r\n            editOAuthApp,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(EditOAuthApp);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport type {OutgoingWebhook} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport ConfirmModal from 'components/confirm_modal';\r\nimport AbstractOutgoingWebhook from 'components/integrations/abstract_outgoing_webhook';\r\nimport LoadingScreen from 'components/loading_screen';\r\n\r\nimport {getHistory} from 'utils/browser_history';\r\n\r\nconst HEADER = {id: 'integrations.edit', defaultMessage: 'Edit'};\r\nconst FOOTER = {id: 'update_outgoing_webhook.update', defaultMessage: 'Update'};\r\nconst LOADING = {id: 'update_outgoing_webhook.updating', defaultMessage: 'Updating...'};\r\n\r\nexport interface Props {\r\n\r\n    /**\r\n     * The current team\r\n     */\r\n    team: Team;\r\n\r\n    /**\r\n     * The outgoing webhook to edit\r\n     */\r\n    hook?: OutgoingWebhook;\r\n\r\n    /**\r\n     * The id of the outgoing webhook to edit\r\n     */\r\n    hookId: string;\r\n    actions: {\r\n\r\n        /**\r\n         * The function to call to update an outgoing webhook\r\n         */\r\n        updateOutgoingHook: (hook: OutgoingWebhook) => Promise<ActionResult<OutgoingWebhook>>;\r\n\r\n        /**\r\n         * The function to call to get an outgoing webhook\r\n         */\r\n        getOutgoingHook: (hookId: string) => Promise<ActionResult<OutgoingWebhook>>;\r\n    };\r\n\r\n    /**\r\n     * Whether or not outgoing webhooks are enabled.\r\n     */\r\n    enableOutgoingWebhooks?: boolean;\r\n\r\n    /**\r\n     * Whether to allow configuration of the default post username.\r\n     */\r\n    enablePostUsernameOverride: boolean;\r\n\r\n    /**\r\n     * Whether to allow configuration of the default post icon.\r\n     */\r\n    enablePostIconOverride: boolean;\r\n}\r\n\r\ninterface State {\r\n    showConfirmModal: boolean;\r\n    serverError: string;\r\n}\r\n\r\nexport default class EditOutgoingWebhook extends React.PureComponent<Props, State> {\r\n    private newHook: OutgoingWebhook | undefined;\r\n\r\n    constructor(props: Props) {\r\n        super(props);\r\n        this.state = {\r\n            showConfirmModal: false,\r\n            serverError: '',\r\n        };\r\n    }\r\n\r\n    componentDidMount(): void {\r\n        if (this.props.enableOutgoingWebhooks) {\r\n            this.props.actions.getOutgoingHook(this.props.hookId);\r\n        }\r\n    }\r\n\r\n    editOutgoingHook = async (hook: OutgoingWebhook): Promise<void> => {\r\n        this.newHook = hook;\r\n\r\n        if (this.props.hook!.id) {\r\n            hook.id = this.props.hook!.id;\r\n        }\r\n\r\n        if (this.props.hook!.token) {\r\n            hook.token = this.props.hook!.token;\r\n        }\r\n\r\n        const triggerWordsSame = (this.props.hook!.trigger_words.length === hook!.trigger_words.length) &&\r\n            this.props.hook!.trigger_words.every((v, i) => v === hook.trigger_words[i]);\r\n\r\n        const callbackUrlsSame = (this.props.hook!.callback_urls.length === hook!.callback_urls.length) &&\r\n            this.props.hook!.callback_urls.every((v, i) => v === hook.callback_urls[i]);\r\n\r\n        if (this.props.hook!.content_type !== hook.content_type ||\r\n            !triggerWordsSame || !callbackUrlsSame) {\r\n            this.handleConfirmModal();\r\n        } else {\r\n            await this.submitHook();\r\n        }\r\n    };\r\n\r\n    handleConfirmModal = (): void => {\r\n        this.setState({showConfirmModal: true});\r\n    };\r\n\r\n    confirmModalDismissed = (): void => {\r\n        this.setState({showConfirmModal: false});\r\n    };\r\n\r\n    submitHook = async (): Promise<void> => {\r\n        this.setState({serverError: ''});\r\n\r\n        const {data, error} = await this.props.actions.updateOutgoingHook(this.newHook!);\r\n\r\n        if (data) {\r\n            getHistory().push(`/${this.props.team.name}/integrations/outgoing_webhooks`);\r\n            return;\r\n        }\r\n\r\n        this.setState({showConfirmModal: false});\r\n\r\n        if (error) {\r\n            this.setState({serverError: error.message});\r\n        }\r\n    };\r\n\r\n    renderExtra = (): JSX.Element => {\r\n        const confirmButton = (\r\n            <FormattedMessage\r\n                id='update_outgoing_webhook.update'\r\n                defaultMessage='Update'\r\n            />\r\n        );\r\n\r\n        const confirmTitle = (\r\n            <FormattedMessage\r\n                id='update_outgoing_webhook.confirm'\r\n                defaultMessage='Edit Outgoing Webhook'\r\n            />\r\n        );\r\n\r\n        const confirmMessage = (\r\n            <FormattedMessage\r\n                id='update_outgoing_webhook.question'\r\n                defaultMessage='Your changes may break the existing outgoing webhook. Are you sure you would like to update it?'\r\n            />\r\n        );\r\n\r\n        return (\r\n            <ConfirmModal\r\n                title={confirmTitle}\r\n                message={confirmMessage}\r\n                confirmButtonText={confirmButton}\r\n                modalClass='integrations-backstage-modal'\r\n                show={this.state.showConfirmModal}\r\n                onConfirm={this.submitHook}\r\n                onCancel={this.confirmModalDismissed}\r\n            />\r\n        );\r\n    };\r\n\r\n    render(): JSX.Element {\r\n        if (!this.props.hook) {\r\n            return <LoadingScreen/>;\r\n        }\r\n\r\n        return (\r\n            <AbstractOutgoingWebhook\r\n                team={this.props.team}\r\n                header={HEADER}\r\n                footer={FOOTER}\r\n                loading={LOADING}\r\n                renderExtra={this.renderExtra()}\r\n                action={this.editOutgoingHook}\r\n                serverError={this.state.serverError}\r\n                initialHook={this.props.hook}\r\n                enablePostUsernameOverride={this.props.enablePostUsernameOverride}\r\n                enablePostIconOverride={this.props.enablePostIconOverride}\r\n            />\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {getOutgoingHook, updateOutgoingHook} from 'mattermost-redux/actions/integrations';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\n\r\nimport EditOutgoingWebhook from './edit_outgoing_webhook';\r\n\r\ntype OwnProps = {\r\n    location: {\r\n        search: string | string[][] | Record<string, string> | URLSearchParams | undefined;\r\n    };\r\n}\r\n\r\nfunction mapStateToProps(state: GlobalState, ownProps: OwnProps) {\r\n    const config = getConfig(state);\r\n    const hookId = (new URLSearchParams(ownProps.location.search)).get('id');\r\n    const enableOutgoingWebhooks = config.EnableOutgoingWebhooks === 'true';\r\n    const enablePostUsernameOverride = config.EnablePostUsernameOverride === 'true';\r\n    const enablePostIconOverride = config.EnablePostIconOverride === 'true';\r\n\r\n    return {\r\n        hookId: hookId!,\r\n        hook: state.entities.integrations.outgoingHooks[hookId!],\r\n        enableOutgoingWebhooks,\r\n        enablePostUsernameOverride,\r\n        enablePostIconOverride,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            updateOutgoingHook,\r\n            getOutgoingHook,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(EditOutgoingWebhook);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {defineMessage, FormattedMessage} from 'react-intl';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {IncomingWebhook} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport CopyText from 'components/copy_text';\r\n\r\nimport {getSiteURL} from 'utils/url';\r\n\r\nimport DeleteIntegrationLink from './delete_integration_link';\r\n\r\nexport function matchesFilter(incomingWebhook: IncomingWebhook, channel: Channel, filter: string) {\r\n    if (!filter) {\r\n        return true;\r\n    }\r\n\r\n    if (incomingWebhook.display_name.toLowerCase().indexOf(filter) !== -1 ||\r\n        incomingWebhook.description.toLowerCase().indexOf(filter) !== -1) {\r\n        return true;\r\n    }\r\n\r\n    if (incomingWebhook.channel_id) {\r\n        if (channel && channel.name.toLowerCase().indexOf(filter) !== -1) {\r\n            return true;\r\n        }\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\ntype Props = {\r\n\r\n    /**\r\n     * Data used for showing webhook details\r\n     */\r\n    incomingWebhook: IncomingWebhook;\r\n\r\n    /**\r\n     * Function to call when webhook delete button is pressed\r\n     */\r\n    onDelete: (incomingWebhook: IncomingWebhook) => void;\r\n\r\n    /**\r\n     * String used for filtering webhook item\r\n     */\r\n    filter?: string;\r\n\r\n    /**\r\n     * Data used for showing created by details\r\n     */\r\n    creator: {\r\n        username: string;\r\n    };\r\n\r\n    /**\r\n     *  Set to show available actions on webhook\r\n     */\r\n    canChange: boolean;\r\n\r\n    /**\r\n     *  Data used in routing of webhook for modifications\r\n     */\r\n    team: Team;\r\n\r\n    /**\r\n     *  Data used for filtering of webhook based on filter prop\r\n     */\r\n    channel: Channel;\r\n}\r\n\r\nexport default class InstalledIncomingWebhook extends React.PureComponent<Props> {\r\n    handleDelete = () => {\r\n        this.props.onDelete(this.props.incomingWebhook);\r\n    };\r\n\r\n    render() {\r\n        const incomingWebhook = this.props.incomingWebhook;\r\n        const channel = this.props.channel;\r\n        const filter = this.props.filter ? this.props.filter.toLowerCase() : '';\r\n\r\n        if (!matchesFilter(incomingWebhook, channel, filter)) {\r\n            return null;\r\n        }\r\n\r\n        let displayName;\r\n        if (incomingWebhook.display_name) {\r\n            displayName = incomingWebhook.display_name;\r\n        } else if (channel) {\r\n            displayName = channel.display_name;\r\n        } else {\r\n            displayName = (\r\n                <FormattedMessage\r\n                    id='installed_incoming_webhooks.unknown_channel'\r\n                    defaultMessage='A Private Webhook'\r\n                />\r\n            );\r\n        }\r\n\r\n        let description = null;\r\n        if (incomingWebhook.description) {\r\n            description = (\r\n                <div className='item-details__row'>\r\n                    <span className='item-details__description'>\r\n                        {incomingWebhook.description}\r\n                    </span>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        let actions = null;\r\n        if (this.props.canChange) {\r\n            actions = (\r\n                <div className='item-actions'>\r\n                    <Link to={`/${this.props.team.name}/integrations/incoming_webhooks/edit?id=${incomingWebhook.id}`}>\r\n                        <FormattedMessage\r\n                            id='installed_integrations.edit'\r\n                            defaultMessage='Edit'\r\n                        />\r\n                    </Link>\r\n                    {' - '}\r\n                    <DeleteIntegrationLink\r\n                        modalMessage={\r\n                            <FormattedMessage\r\n                                id='installed_incoming_webhooks.delete.confirm'\r\n                                defaultMessage='This action permanently deletes the incoming webhook and breaks any integrations using it. Are you sure you want to delete it?'\r\n                            />\r\n                        }\r\n                        onDelete={this.handleDelete}\r\n                    />\r\n                </div>\r\n            );\r\n        }\r\n\r\n        const incomingWebhookId = getSiteURL() + '/hooks/' + incomingWebhook.id;\r\n\r\n        return (\r\n            <div className='backstage-list__item'>\r\n                <div className='item-details'>\r\n                    <div className='item-details__row d-flex flex-column flex-md-row justify-content-between'>\r\n                        <strong className='item-details__name'>\r\n                            {displayName}\r\n                        </strong>\r\n                        {actions}\r\n                    </div>\r\n                    {description}\r\n                    <div className='item-details__row'>\r\n                        <span className='item-details__url word-break--all'>\r\n                            <FormattedMessage\r\n                                id='installed_integrations.url'\r\n                                defaultMessage='URL: {url}'\r\n                                values={{\r\n                                    url: <code>{incomingWebhookId}</code>,\r\n                                }}\r\n                            />\r\n                            <span>\r\n                                <CopyText\r\n                                    label={defineMessage({\r\n                                        id: 'integrations.copy_url',\r\n                                        defaultMessage: 'Copy URL',\r\n                                    })}\r\n                                    value={incomingWebhookId}\r\n                                />\r\n                            </span>\r\n                        </span>\r\n                    </div>\r\n                    <div className='item-details__row'>\r\n                        <span className='item-details__creation'>\r\n                            <FormattedMessage\r\n                                id='installed_integrations.creation'\r\n                                defaultMessage='Created by {creator} on {createAt, date, full}'\r\n                                values={{\r\n                                    creator: this.props.creator.username,\r\n                                    createAt: incomingWebhook.create_at,\r\n                                }}\r\n                            />\r\n                        </span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {IncomingWebhook, IncomingWebhooksWithCount} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\nimport type {IDMappedObjects} from '@mattermost/types/utilities';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport BackstageList from 'components/backstage/components/backstage_list';\r\nimport ExternalLink from 'components/external_link';\r\nimport InstalledIncomingWebhook, {matchesFilter} from 'components/integrations/installed_incoming_webhook';\r\n\r\nimport {DeveloperLinks} from 'utils/constants';\r\nimport * as Utils from 'utils/utils';\r\n\r\nconst PAGE_SIZE = 200;\r\n\r\ntype Props = {\r\n    team: Team;\r\n    user: UserProfile;\r\n    incomingHooks: IncomingWebhook[];\r\n    incomingHooksTotalCount: number;\r\n    channels: IDMappedObjects<Channel>;\r\n    users: IDMappedObjects<UserProfile>;\r\n    canManageOthersWebhooks: boolean;\r\n    enableIncomingWebhooks: boolean;\r\n    actions: {\r\n        removeIncomingHook: (hookId: string) => Promise<ActionResult>;\r\n        loadIncomingHooksAndProfilesForTeam: (teamId: string, startPageNumber: number,\r\n            pageSize: number, includeTotalCount: boolean) => Promise<ActionResult<IncomingWebhook[] | IncomingWebhooksWithCount>>;\r\n    };\r\n}\r\n\r\ntype State = {\r\n    page: number;\r\n    loading: boolean;\r\n}\r\n\r\nexport default class InstalledIncomingWebhooks extends React.PureComponent<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            page: 0,\r\n            loading: true,\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.loadPage(0);\r\n    }\r\n\r\n    deleteIncomingWebhook = (incomingWebhook: IncomingWebhook) => {\r\n        this.props.actions.removeIncomingHook(incomingWebhook.id);\r\n    };\r\n\r\n    loadPage = async (pageToLoad: number) => {\r\n        if (this.props.enableIncomingWebhooks) {\r\n            this.setState({loading: true},\r\n                async () => {\r\n                    await this.props.actions.loadIncomingHooksAndProfilesForTeam(\r\n                        this.props.team.id,\r\n                        pageToLoad,\r\n                        PAGE_SIZE,\r\n                        true,\r\n                    );\r\n                    this.setState({page: pageToLoad, loading: false});\r\n                },\r\n            );\r\n        }\r\n    };\r\n\r\n    nextPage = () => {\r\n        this.loadPage(this.state.page + 1);\r\n    };\r\n\r\n    previousPage = () => {\r\n        this.loadPage(this.state.page - 1);\r\n    };\r\n\r\n    incomingWebhookCompare = (a: IncomingWebhook, b: IncomingWebhook) => {\r\n        let displayNameA = a.display_name;\r\n        if (!displayNameA) {\r\n            const channelA = this.props.channels[a.channel_id];\r\n            if (channelA) {\r\n                displayNameA = channelA.display_name;\r\n            } else {\r\n                displayNameA = Utils.localizeMessage({id: 'installed_incoming_webhooks.unknown_channel', defaultMessage: 'A Private Webhook'});\r\n            }\r\n        }\r\n\r\n        const displayNameB = b.display_name;\r\n        return displayNameA.localeCompare(displayNameB);\r\n    };\r\n\r\n    incomingWebhooks = (filter: string) => this.props.incomingHooks.\r\n        sort(this.incomingWebhookCompare).\r\n        filter((incomingWebhook: IncomingWebhook) => matchesFilter(incomingWebhook, this.props.channels[incomingWebhook.channel_id], filter)).\r\n        map((incomingWebhook: IncomingWebhook) => {\r\n            const canChange = this.props.canManageOthersWebhooks || this.props.user.id === incomingWebhook.user_id;\r\n            const channel = this.props.channels[incomingWebhook.channel_id];\r\n            return (\r\n                <InstalledIncomingWebhook\r\n                    key={incomingWebhook.id}\r\n                    incomingWebhook={incomingWebhook}\r\n                    onDelete={this.deleteIncomingWebhook}\r\n                    creator={this.props.users[incomingWebhook.user_id] || {}}\r\n                    canChange={canChange}\r\n                    team={this.props.team}\r\n                    channel={channel}\r\n                />\r\n            );\r\n        });\r\n\r\n    render() {\r\n        return (\r\n            <BackstageList\r\n                header={\r\n                    <FormattedMessage\r\n                        id='installed_incoming_webhooks.header'\r\n                        defaultMessage='Installed Incoming Webhooks'\r\n                    />\r\n                }\r\n                addText={\r\n                    <FormattedMessage\r\n                        id='installed_incoming_webhooks.add'\r\n                        defaultMessage='Add Incoming Webhook'\r\n                    />\r\n                }\r\n                addLink={'/' + this.props.team.name + '/integrations/incoming_webhooks/add'}\r\n                addButtonId='addIncomingWebhook'\r\n                emptyText={\r\n                    <FormattedMessage\r\n                        id='installed_incoming_webhooks.empty'\r\n                        defaultMessage='No incoming webhooks found'\r\n                    />\r\n                }\r\n                emptyTextSearch={\r\n                    <FormattedMessage\r\n                        id='installed_incoming_webhooks.emptySearch'\r\n                        defaultMessage='No incoming webhooks match {searchTerm}'\r\n                    />\r\n                }\r\n                helpText={\r\n                    <FormattedMessage\r\n                        id='installed_incoming_webhooks.help'\r\n                        defaultMessage='Use incoming webhooks to connect external tools to Mattermost. {buildYourOwn} or visit the {appDirectory} to find self-hosted, third-party apps and integrations.'\r\n                        values={{\r\n                            buildYourOwn: (\r\n                                <ExternalLink\r\n                                    location='installed_incoming_webhooks'\r\n                                    href={DeveloperLinks.SETUP_INCOMING_WEBHOOKS}\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='installed_incoming_webhooks.help.buildYourOwn'\r\n                                        defaultMessage='Build Your Own'\r\n                                    />\r\n                                </ExternalLink>\r\n                            ),\r\n                            appDirectory: (\r\n                                <ExternalLink\r\n                                    href='https://mattermost.com/marketplace'\r\n                                    location='installed_incoming_webhooks'\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='installed_incoming_webhooks.help.appDirectory'\r\n                                        defaultMessage='App Directory'\r\n                                    />\r\n                                </ExternalLink>\r\n                            ),\r\n                        }}\r\n                    />\r\n                }\r\n                searchPlaceholder={Utils.localizeMessage({id: 'installed_incoming_webhooks.search', defaultMessage: 'Search Incoming Webhooks'})}\r\n                loading={this.state.loading}\r\n                nextPage={this.nextPage}\r\n                previousPage={this.previousPage}\r\n                page={this.state.page}\r\n                pageSize={PAGE_SIZE}\r\n                total={this.props.incomingHooksTotalCount}\r\n            >\r\n                {(filter: string) => {\r\n                    const children = this.incomingWebhooks(filter);\r\n                    return [children, children.length > 0];\r\n                }}\r\n            </BackstageList>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {removeIncomingHook} from 'mattermost-redux/actions/integrations';\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {getAllChannels} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {getFilteredIncomingHooks, getIncomingHooksTotalCount} from 'mattermost-redux/selectors/entities/integrations';\r\nimport {haveITeamPermission} from 'mattermost-redux/selectors/entities/roles';\r\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getUsers} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {loadIncomingHooksAndProfilesForTeam} from 'actions/integration_actions';\r\n\r\nimport InstalledIncomingWebhooks from './installed_incoming_webhooks';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const teamId = getCurrentTeamId(state);\r\n    const incomingHooks = getFilteredIncomingHooks(state);\r\n    const incomingHooksTotalCount = getIncomingHooksTotalCount(state);\r\n    const config = getConfig(state);\r\n    const canManageOthersWebhooks = haveITeamPermission(state, teamId, Permissions.MANAGE_OTHERS_INCOMING_WEBHOOKS);\r\n    const enableIncomingWebhooks = config.EnableIncomingWebhooks === 'true';\r\n\r\n    return {\r\n        incomingHooks,\r\n        incomingHooksTotalCount,\r\n        channels: getAllChannels(state),\r\n        users: getUsers(state),\r\n        canManageOthersWebhooks,\r\n        enableIncomingWebhooks,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            loadIncomingHooksAndProfilesForTeam,\r\n            removeIncomingHook,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(InstalledIncomingWebhooks);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {defineMessages, FormattedMessage} from 'react-intl';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport type {OAuthApp} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport CopyText from 'components/copy_text';\r\nimport FormError from 'components/form_error';\r\n\r\nimport DeleteIntegrationLink from '../delete_integration_link';\r\n\r\nconst FAKE_SECRET = '***************';\r\n\r\nexport function matchesFilter(oauthApp: OAuthApp, filter?: string | null): boolean {\r\n    if (!filter) {\r\n        return true;\r\n    }\r\n\r\n    return oauthApp.name.toLowerCase().includes(filter);\r\n}\r\n\r\nexport type InstalledOAuthAppProps = {\r\n\r\n    /**\r\n     * The team data\r\n     */\r\n    team?: Team;\r\n\r\n    /**\r\n     * The oauthApp data\r\n     */\r\n    oauthApp: OAuthApp;\r\n\r\n    /**\r\n     * Whether the oauth app is created by an App\r\n     */\r\n    fromApp: boolean;\r\n\r\n    creatorName: string;\r\n\r\n    /**\r\n     * The function to call when Regenerate Secret link is clicked\r\n     */\r\n    onRegenerateSecret: (oauthAppId: string) => Promise<{ error?: { message: string } }>;\r\n\r\n    /**\r\n     * The function to call when Delete link is clicked\r\n     */\r\n    onDelete: (oauthApp: OAuthApp) => void;\r\n\r\n    /**\r\n     * Set to filter OAuthApp\r\n     */\r\n    filter?: string | null;\r\n}\r\n\r\nexport type InstalleOAuthAppState = {\r\n    clientSecret: string;\r\n    error?: string | null;\r\n}\r\n\r\nexport default class InstalledOAuthApp extends React.PureComponent<InstalledOAuthAppProps, InstalleOAuthAppState> {\r\n    constructor(props: InstalledOAuthAppProps) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            clientSecret: FAKE_SECRET,\r\n        };\r\n    }\r\n\r\n    handleShowClientSecret = (e?: React.MouseEvent): void => {\r\n        if (e && e.preventDefault) {\r\n            e.preventDefault();\r\n        }\r\n        this.setState({clientSecret: this.props.oauthApp.client_secret});\r\n    };\r\n\r\n    handleHideClientSecret = (e: React.MouseEvent): void => {\r\n        e.preventDefault();\r\n        this.setState({clientSecret: FAKE_SECRET});\r\n    };\r\n\r\n    handleRegenerate = (e: React.MouseEvent): void => {\r\n        e.preventDefault();\r\n        this.props.onRegenerateSecret(this.props.oauthApp.id).then(\r\n            ({error}) => {\r\n                if (error) {\r\n                    this.setState({error: error.message});\r\n                } else {\r\n                    this.setState({error: null});\r\n                    this.handleShowClientSecret();\r\n                }\r\n            },\r\n        );\r\n    };\r\n\r\n    handleDelete = (): void => {\r\n        this.props.onDelete(this.props.oauthApp);\r\n    };\r\n\r\n    render(): React.ReactNode {\r\n        const {oauthApp, creatorName} = this.props;\r\n        let error;\r\n\r\n        if (this.state.error) {\r\n            error = (\r\n                <FormError\r\n                    error={this.state.error}\r\n                />\r\n            );\r\n        }\r\n\r\n        if (!matchesFilter(oauthApp, this.props.filter)) {\r\n            return null;\r\n        }\r\n\r\n        let name;\r\n        if (oauthApp.name) {\r\n            name = oauthApp.name;\r\n        } else {\r\n            name = (\r\n                <FormattedMessage\r\n                    id='installed_integrations.unnamed_oauth_app'\r\n                    defaultMessage='Unnamed OAuth 2.0 Application'\r\n                />\r\n            );\r\n        }\r\n\r\n        let description;\r\n        if (oauthApp.description) {\r\n            description = (\r\n                <div className='item-details__row'>\r\n                    <span className='item-details__description'>\r\n                        {oauthApp.description}\r\n                    </span>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        const urls = (\r\n            <div className='item-details__row'>\r\n                <span className='item-details__url word-break--all'>\r\n                    <FormattedMessage\r\n                        id='installed_integrations.callback_urls'\r\n                        defaultMessage='Callback URLs: {urls}'\r\n                        values={{\r\n                            urls: oauthApp.callback_urls.join(', '),\r\n                        }}\r\n                    />\r\n                </span>\r\n            </div>\r\n        );\r\n\r\n        let isTrusted;\r\n        if (oauthApp.is_trusted) {\r\n            isTrusted = (\r\n                <FormattedMessage\r\n                    id='installed_oauth_apps.trusted.yes'\r\n                    defaultMessage='Yes'\r\n                />\r\n            );\r\n        } else {\r\n            isTrusted = (\r\n                <FormattedMessage\r\n                    id='installed_oauth_apps.trusted.no'\r\n                    defaultMessage='No'\r\n                />\r\n            );\r\n        }\r\n\r\n        // Check if this is a public client (no secret)\r\n        const isPublicClient = !oauthApp.client_secret || oauthApp.client_secret === '';\r\n\r\n        let showHide;\r\n        let clientSecret;\r\n        if (isPublicClient) {\r\n            // Public clients don't have secrets, so don't show secret controls\r\n            clientSecret = (\r\n                <span className='item-details__token'>\r\n                    <FormattedMessage\r\n                        id='installed_integrations.client_type'\r\n                        defaultMessage='Client Type: '\r\n                    />\r\n                    <strong>\r\n                        <FormattedMessage\r\n                            id='installed_oauth_apps.public_client'\r\n                            defaultMessage='Public Client (No Secret)'\r\n                        />\r\n                    </strong>\r\n                </span>\r\n            );\r\n        } else if (this.state.clientSecret === FAKE_SECRET) {\r\n            showHide = (\r\n                <button\r\n                    id='showSecretButton'\r\n                    className='style--none color--link'\r\n                    onClick={this.handleShowClientSecret}\r\n                >\r\n                    <FormattedMessage\r\n                        id='installed_integrations.showSecret'\r\n                        defaultMessage='Show Secret'\r\n                    />\r\n                </button>\r\n            );\r\n            clientSecret = (\r\n                <span className='item-details__token'>\r\n                    <FormattedMessage\r\n                        id='installed_integrations.client_secret'\r\n                        defaultMessage='Client Secret: '\r\n                    />\r\n                    <strong>{this.state.clientSecret}</strong>\r\n                </span>\r\n            );\r\n        } else {\r\n            showHide = (\r\n                <button\r\n                    id='hideSecretButton'\r\n                    className='style--none color--link'\r\n                    onClick={this.handleHideClientSecret}\r\n                >\r\n                    <FormattedMessage\r\n                        id='installed_integrations.hideSecret'\r\n                        defaultMessage='Hide Secret'\r\n                    />\r\n                </button>\r\n            );\r\n            clientSecret = (\r\n                <span className='item-details__token'>\r\n                    <FormattedMessage\r\n                        id='installed_integrations.client_secret'\r\n                        defaultMessage='Client Secret: '\r\n                    />\r\n                    <strong>{this.state.clientSecret}</strong>\r\n                    <CopyText\r\n                        label={messages.copyClientSecret}\r\n                        value={this.state.clientSecret}\r\n                    />\r\n                </span>\r\n            );\r\n        }\r\n\r\n        let regen;\r\n        if (!isPublicClient) {\r\n            regen = (\r\n                <button\r\n                    id='regenerateSecretButton'\r\n                    className='style--none color--link'\r\n                    onClick={this.handleRegenerate}\r\n                >\r\n                    <FormattedMessage\r\n                        id='installed_integrations.regenSecret'\r\n                        defaultMessage='Regenerate Secret'\r\n                    />\r\n                </button>\r\n            );\r\n        }\r\n\r\n        let icon;\r\n        if (oauthApp.icon_url) {\r\n            icon = (\r\n                <div className='integration__icon integration-list__icon'>\r\n                    <img\r\n                        alt={'get app screenshot'}\r\n                        src={oauthApp.icon_url}\r\n                    />\r\n                </div>\r\n            );\r\n        }\r\n\r\n        let actions;\r\n        if (!this.props.fromApp) {\r\n            const actionParts = [];\r\n\r\n            // Only show secret controls for confidential clients\r\n            if (!isPublicClient) {\r\n                actionParts.push(showHide);\r\n                actionParts.push(regen);\r\n            }\r\n\r\n            actionParts.push(\r\n                <Link\r\n                    key='edit'\r\n                    to={`/${this.props.team?.name}/integrations/oauth2-apps/edit?id=${oauthApp.id}`}\r\n                >\r\n                    <FormattedMessage\r\n                        id='installed_integrations.edit'\r\n                        defaultMessage='Edit'\r\n                    />\r\n                </Link>,\r\n            );\r\n\r\n            actionParts.push(\r\n                <DeleteIntegrationLink\r\n                    key='delete'\r\n                    modalMessage={\r\n                        <FormattedMessage\r\n                            id='installed_oauth_apps.delete.confirm'\r\n                            defaultMessage='This action permanently deletes the OAuth 2.0 application and breaks any integrations using it. Are you sure you want to delete it?'\r\n                        />\r\n                    }\r\n                    onDelete={this.handleDelete}\r\n                />,\r\n            );\r\n\r\n            actions = (\r\n                <div className='item-actions'>\r\n                    {actionParts.map((part, idx) => (\r\n                        <React.Fragment key={idx}>\r\n                            {idx > 0 && ' - '}\r\n                            {part}\r\n                        </React.Fragment>\r\n                    ))}\r\n                </div>\r\n            );\r\n        }\r\n\r\n        let appInfo = (\r\n            <div className='item-details__row'>\r\n                <span className='item-details__creation'>\r\n                    <FormattedMessage\r\n                        id='installed_integrations.fromApp'\r\n                        defaultMessage='Managed by Apps Framework'\r\n                    />\r\n                </span>\r\n            </div>\r\n        );\r\n        if (!this.props.fromApp) {\r\n            appInfo = (\r\n                <>\r\n                    <div className='item-details__row'>\r\n                        <span className='item-details__url word-break--all'>\r\n                            <FormattedMessage\r\n                                id='installed_oauth_apps.is_trusted'\r\n                                defaultMessage='Is Trusted: '\r\n                            />\r\n                            <strong>{isTrusted}</strong>\r\n                        </span>\r\n                    </div>\r\n                    {oauthApp.is_dynamically_registered && (\r\n                        <div className='item-details__row'>\r\n                            <span className='item-details__url word-break--all'>\r\n                                <FormattedMessage\r\n                                    id='installed_oauth_apps.dynamically_registered'\r\n                                    defaultMessage='Dynamically Registered: '\r\n                                />\r\n                                <strong>\r\n                                    <FormattedMessage\r\n                                        id='installed_oauth_apps.dynamically_registered.yes'\r\n                                        defaultMessage='Yes'\r\n                                    />\r\n                                </strong>\r\n                            </span>\r\n                        </div>\r\n                    )}\r\n                    <div className='item-details__row'>\r\n                        <span className='item-details__token'>\r\n                            <FormattedMessage\r\n                                id='installed_integrations.client_id'\r\n                                defaultMessage='Client ID: '\r\n                            />\r\n                            <strong>{oauthApp.id}</strong>\r\n                            <CopyText\r\n                                label={messages.copyClientId}\r\n                                value={oauthApp.id}\r\n                            />\r\n                        </span>\r\n                    </div>\r\n                    <div className='item-details__row'>\r\n                        {clientSecret}\r\n                    </div>\r\n                    {urls}\r\n                    <div className='item-details__row'>\r\n                        <span className='item-details__creation'>\r\n                            <FormattedMessage\r\n                                id='installed_integrations.creation'\r\n                                defaultMessage='Created by {creator} on {createAt, date, full}'\r\n                                values={{\r\n                                    creator: creatorName,\r\n                                    createAt: oauthApp.create_at,\r\n                                }}\r\n                            />\r\n                        </span>\r\n                    </div>\r\n                </>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div className='backstage-list__item'>\r\n                {icon}\r\n                <div className='item-details'>\r\n                    <div className='item-details__row d-flex flex-column flex-md-row justify-content-between'>\r\n                        <strong className='item-details__name'>\r\n                            {name}\r\n                        </strong>\r\n                        {actions}\r\n                    </div>\r\n                    {error}\r\n                    {description}\r\n                    {appInfo}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nconst messages = defineMessages({\r\n    copyClientId: {\r\n        id: 'integrations.copy_client_id',\r\n        defaultMessage: 'Copy Client Id',\r\n    },\r\n    copyClientSecret: {\r\n        id: 'integrations.copy_client_secret',\r\n        defaultMessage: 'Copy Client Secret',\r\n    },\r\n});\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\n\r\nimport {getUser} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {getDisplayNameByUser} from 'utils/utils';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport InstalledOAuthApp from './installed_oauth_app';\r\nimport type {InstalledOAuthAppProps} from './installed_oauth_app';\r\n\r\nfunction mapStateToProps(state: GlobalState, ownProps: InstalledOAuthAppProps) {\r\n    const oauthApp = ownProps.oauthApp || {};\r\n    return {\r\n        creatorName: getDisplayNameByUser(state, getUser(state, oauthApp.creator_id)),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps)(InstalledOAuthApp);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport type {OAuthApp} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport BackstageList from 'components/backstage/components/backstage_list';\r\nimport ExternalLink from 'components/external_link';\r\n\r\nimport {DeveloperLinks} from 'utils/constants';\r\nimport {localizeMessage} from 'utils/utils';\r\n\r\nimport InstalledOAuthApp from '../installed_oauth_app';\r\nimport {matchesFilter} from '../installed_oauth_app/installed_oauth_app';\r\n\r\ntype Props = {\r\n\r\n    /**\r\n    * The team data\r\n    */\r\n    team?: Team;\r\n\r\n    /**\r\n    * The oauthApps data\r\n    */\r\n    oauthApps: {\r\n        [key: string]: OAuthApp;\r\n    };\r\n\r\n    /**\r\n     * List of IDs for apps managed by the App Framwork\r\n     */\r\n    appsOAuthAppIDs: string[];\r\n\r\n    /**\r\n    * Set if user can manage oath\r\n    */\r\n    canManageOauth: boolean;\r\n\r\n    /**\r\n    * Whether or not OAuth applications are enabled.\r\n    */\r\n    enableOAuthServiceProvider: boolean;\r\n\r\n    actions: ({\r\n\r\n        /**\r\n        * The function to call to fetch OAuth apps\r\n        */\r\n        loadOAuthAppsAndProfiles: (page?: number, perPage?: number) => Promise<ActionResult>;\r\n\r\n        /**\r\n        * The function to call when Regenerate Secret link is clicked\r\n        */\r\n        regenOAuthAppSecret: (appId: string) => Promise<ActionResult>;\r\n\r\n        /**\r\n        * The function to call when Delete link is clicked\r\n        */\r\n        deleteOAuthApp: (appId: string) => Promise<ActionResult>;\r\n    });\r\n};\r\n\r\ntype State = {\r\n    loading: boolean;\r\n};\r\n\r\nexport default class InstalledOAuthApps extends React.PureComponent<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n        this.state = {\r\n            loading: true,\r\n        };\r\n    }\r\n\r\n    componentDidMount(): void {\r\n        if (this.props.enableOAuthServiceProvider) {\r\n            this.props.actions.loadOAuthAppsAndProfiles().then(\r\n                () => this.setState({loading: false}),\r\n            );\r\n        }\r\n    }\r\n\r\n    deleteOAuthApp = (app: OAuthApp): void => {\r\n        if (app && app.id) {\r\n            this.props.actions.deleteOAuthApp(app.id);\r\n        }\r\n    };\r\n\r\n    oauthAppCompare(a: OAuthApp, b: OAuthApp): number {\r\n        let nameA = a.name.toString();\r\n        if (!nameA) {\r\n            nameA = localizeMessage({id: 'installed_integrations.unnamed_oauth_app', defaultMessage: 'Unnamed OAuth 2.0 Application'});\r\n        }\r\n\r\n        let nameB = b.name.toString();\r\n        if (!nameB) {\r\n            nameB = localizeMessage({id: 'installed_integrations.unnamed_oauth_app', defaultMessage: 'Unnamed OAuth 2.0 Application'});\r\n        }\r\n\r\n        return nameA.localeCompare(nameB);\r\n    }\r\n\r\n    oauthApps = (filter?: string) => Object.values(this.props.oauthApps).\r\n        filter((app) => matchesFilter(app, filter)).\r\n        sort(this.oauthAppCompare).\r\n        map((app) => {\r\n            return (\r\n                <InstalledOAuthApp\r\n                    key={app.id}\r\n                    oauthApp={app}\r\n                    onRegenerateSecret={this.props.actions.regenOAuthAppSecret}\r\n                    onDelete={this.deleteOAuthApp}\r\n                    team={this.props.team}\r\n                    creatorName=''\r\n                    fromApp={this.props.appsOAuthAppIDs.includes(app.id)}\r\n                />\r\n            );\r\n        });\r\n\r\n    render() {\r\n        if (!this.props.team) {\r\n            return null;\r\n        }\r\n        const integrationsEnabled = this.props.enableOAuthServiceProvider && this.props.canManageOauth;\r\n        let props;\r\n        if (integrationsEnabled) {\r\n            props = {\r\n                addLink: '/' + this.props.team.name + '/integrations/oauth2-apps/add',\r\n                addText: localizeMessage({id: 'installed_oauth_apps.add', defaultMessage: 'Add OAuth 2.0 Application'}),\r\n                addButtonId: 'addOauthApp',\r\n            };\r\n        }\r\n\r\n        return (\r\n            <BackstageList\r\n                header={\r\n                    <FormattedMessage\r\n                        id='installed_oauth2_apps.header'\r\n                        defaultMessage='OAuth 2.0 Applications'\r\n                    />\r\n                }\r\n                helpText={\r\n                    <FormattedMessage\r\n                        id='installed_oauth_apps.help'\r\n                        defaultMessage='Create {oauthApplications} to securely integrate bots and third-party apps with Mattermost. Visit the {appDirectory} to find available self-hosted apps.'\r\n                        values={{\r\n                            oauthApplications: (\r\n                                <ExternalLink\r\n                                    href={DeveloperLinks.SETUP_OAUTH2}\r\n                                    location='installed_oauth_apps'\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='installed_oauth_apps.help.oauthApplications'\r\n                                        defaultMessage='OAuth 2.0 applications'\r\n                                    />\r\n                                </ExternalLink>\r\n                            ),\r\n                            appDirectory: (\r\n                                <ExternalLink\r\n                                    href='https://mattermost.com/marketplace/'\r\n                                    location='installed_oauth_apps'\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='installed_oauth_apps.help.appDirectory'\r\n                                        defaultMessage='App Directory'\r\n                                    />\r\n                                </ExternalLink>\r\n                            ),\r\n                        }}\r\n                    />\r\n                }\r\n                emptyText={\r\n                    <FormattedMessage\r\n                        id='installed_oauth_apps.empty'\r\n                        defaultMessage='No OAuth 2.0 Applications found'\r\n                    />\r\n                }\r\n                emptyTextSearch={\r\n                    <FormattedMessage\r\n                        id='installed_oauth_apps.emptySearch'\r\n                        defaultMessage='No OAuth 2.0 Applications match {searchTerm}'\r\n                    />\r\n                }\r\n                searchPlaceholder={localizeMessage({id: 'installed_oauth_apps.search', defaultMessage: 'Search OAuth 2.0 Applications'})}\r\n                loading={this.state.loading}\r\n                {...props}\r\n            >\r\n                {(filter: string) => {\r\n                    const children = this.oauthApps(filter);\r\n                    return [children, children.length > 0];\r\n                }}\r\n            </BackstageList>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {regenOAuthAppSecret, deleteOAuthApp} from 'mattermost-redux/actions/integrations';\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {getAppsOAuthAppIDs, getOAuthApps} from 'mattermost-redux/selectors/entities/integrations';\r\nimport {haveISystemPermission} from 'mattermost-redux/selectors/entities/roles';\r\nimport {getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\n\r\nimport {loadOAuthAppsAndProfiles} from 'actions/integration_actions';\r\n\r\nimport InstalledOAuthApps from './installed_oauth_apps';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const config = getConfig(state);\r\n    const enableOAuthServiceProvider = config.EnableOAuthServiceProvider === 'true';\r\n\r\n    return {\r\n        canManageOauth: haveISystemPermission(state, {permission: Permissions.MANAGE_OAUTH}),\r\n        oauthApps: getOAuthApps(state),\r\n        appsOAuthAppIDs: getAppsOAuthAppIDs(state),\r\n        enableOAuthServiceProvider,\r\n        team: getCurrentTeam(state),\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            loadOAuthAppsAndProfiles,\r\n            regenOAuthAppSecret,\r\n            deleteOAuthApp,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(InstalledOAuthApps);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {defineMessage, FormattedMessage} from 'react-intl';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {OutgoingWebhook} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\n\r\nimport CopyText from 'components/copy_text';\r\n\r\nimport DeleteIntegrationLink from './delete_integration_link';\r\n\r\nexport function matchesFilter(outgoingWebhook: OutgoingWebhook, channel: Channel, filter: string) {\r\n    if (!filter) {\r\n        return true;\r\n    }\r\n\r\n    const {\r\n        display_name: displayName,\r\n        description,\r\n        trigger_words: triggerWords,\r\n    } = outgoingWebhook;\r\n\r\n    if (\r\n        (displayName && displayName.toLowerCase().indexOf(filter) !== -1) ||\r\n        (description && description.toLowerCase().indexOf(filter) !== -1)\r\n    ) {\r\n        return true;\r\n    }\r\n\r\n    if (triggerWords) {\r\n        for (const triggerWord of triggerWords) {\r\n            if (triggerWord.toLowerCase().indexOf(filter) !== -1) {\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n\r\n    if (channel && channel.name) {\r\n        if (channel.name.toLowerCase().indexOf(filter) !== -1) {\r\n            return true;\r\n        }\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\ntype Props = {\r\n    outgoingWebhook: OutgoingWebhook;\r\n    onRegenToken: (outgoingWebhook: OutgoingWebhook) => void;\r\n    onDelete: (outgoingWebhook: OutgoingWebhook) => void;\r\n    team: Team;\r\n    creator: UserProfile;\r\n    channel: Channel;\r\n    canChange: boolean;\r\n    filter?: string;\r\n}\r\n\r\nexport default class InstalledOutgoingWebhook extends React.PureComponent<Props> {\r\n    handleRegenToken = (e: React.MouseEvent<HTMLButtonElement, MouseEvent>) => {\r\n        e.preventDefault();\r\n\r\n        this.props.onRegenToken(this.props.outgoingWebhook);\r\n    };\r\n\r\n    handleDelete = () => {\r\n        this.props.onDelete(this.props.outgoingWebhook);\r\n    };\r\n\r\n    makeDisplayName(outgoingWebhook: OutgoingWebhook, channel: Channel) {\r\n        if (outgoingWebhook.display_name) {\r\n            return outgoingWebhook.display_name;\r\n        } else if (channel) {\r\n            return channel.display_name;\r\n        }\r\n        return (\r\n            <FormattedMessage\r\n                id='installed_outgoing_webhooks.unknown_channel'\r\n                defaultMessage='A Private Webhook'\r\n            />\r\n        );\r\n    }\r\n\r\n    render() {\r\n        const outgoingWebhook = this.props.outgoingWebhook;\r\n        const channel = this.props.channel;\r\n        const filter = this.props.filter ? this.props.filter.toLowerCase() : '';\r\n        const triggerWordsFull = 0;\r\n        const triggerWordsStartsWith = 1;\r\n\r\n        if (outgoingWebhook && !matchesFilter(outgoingWebhook, channel, filter)) {\r\n            return null;\r\n        }\r\n\r\n        const displayName = this.makeDisplayName(outgoingWebhook, channel);\r\n\r\n        let description = null;\r\n        if (outgoingWebhook.description) {\r\n            description = (\r\n                <div className='item-details__row'>\r\n                    <span className='item-details__description'>\r\n                        {outgoingWebhook.description}\r\n                    </span>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        let triggerWords = null;\r\n        if (outgoingWebhook.trigger_words && outgoingWebhook.trigger_words.length > 0) {\r\n            triggerWords = (\r\n                <div className='item-details__row'>\r\n                    <span className='item-details__trigger-words'>\r\n                        <FormattedMessage\r\n                            id='installed_integrations.triggerWords'\r\n                            defaultMessage='Trigger Words: {triggerWords}'\r\n                            values={{\r\n                                triggerWords: outgoingWebhook.trigger_words.join(', '),\r\n                            }}\r\n                        />\r\n                    </span>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        const urls = (\r\n            <div className='item-details__row'>\r\n                <span className='item-details__url word-break--all'>\r\n                    <FormattedMessage\r\n                        id='installed_integrations.callback_urls'\r\n                        defaultMessage='Callback URLs: {urls}'\r\n                        values={{\r\n                            urls: outgoingWebhook.callback_urls.join(', '),\r\n                        }}\r\n                    />\r\n                </span>\r\n            </div>\r\n        );\r\n\r\n        let triggerWhen;\r\n        if (outgoingWebhook.trigger_when === triggerWordsFull) {\r\n            triggerWhen = (\r\n                <FormattedMessage\r\n                    id='add_outgoing_webhook.triggerWordsTriggerWhenFullWord'\r\n                    defaultMessage='First word matches a trigger word exactly'\r\n                />\r\n            );\r\n        } else if (outgoingWebhook.trigger_when === triggerWordsStartsWith) {\r\n            triggerWhen = (\r\n                <FormattedMessage\r\n                    id='add_outgoing_webhook.triggerWordsTriggerWhenStartsWith'\r\n                    defaultMessage='First word starts with a trigger word'\r\n                />\r\n            );\r\n        }\r\n\r\n        let actions = null;\r\n        if (this.props.canChange) {\r\n            actions = (\r\n                <div className='item-actions'>\r\n                    <button\r\n                        className='style--none color--link'\r\n                        onClick={this.handleRegenToken}\r\n                    >\r\n                        <FormattedMessage\r\n                            id='installed_integrations.regenToken'\r\n                            defaultMessage='Regenerate Token'\r\n                        />\r\n                    </button>\r\n                    {' - '}\r\n                    <Link to={`/${this.props.team.name}/integrations/outgoing_webhooks/edit?id=${outgoingWebhook.id}`}>\r\n                        <FormattedMessage\r\n                            id='installed_integrations.edit'\r\n                            defaultMessage='Edit'\r\n                        />\r\n                    </Link>\r\n                    {' - '}\r\n                    <DeleteIntegrationLink\r\n                        modalMessage={\r\n                            <FormattedMessage\r\n                                id='installed_outgoing_webhooks.delete.confirm'\r\n                                defaultMessage='This action permanently deletes the outgoing webhook and breaks any integrations using it. Are you sure you want to delete it?'\r\n                            />\r\n                        }\r\n                        onDelete={this.handleDelete}\r\n                    />\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div className='backstage-list__item'>\r\n                <div className='item-details'>\r\n                    <div className='item-details__row d-flex flex-column flex-md-row justify-content-between'>\r\n                        <strong className='item-details__name'>\r\n                            {displayName}\r\n                        </strong>\r\n                        {actions}\r\n                    </div>\r\n                    {description}\r\n                    <div className='item-details__row'>\r\n                        <span className='item-details__content_type'>\r\n                            <FormattedMessage\r\n                                id='installed_integrations.content_type'\r\n                                defaultMessage='Content-Type: {contentType}'\r\n                                values={{\r\n                                    contentType: outgoingWebhook.content_type || 'application/x-www-form-urlencoded',\r\n                                }}\r\n                            />\r\n                        </span>\r\n                    </div>\r\n                    {triggerWords}\r\n                    <div className='item-details__row'>\r\n                        <span className='item-details__trigger-when'>\r\n                            <FormattedMessage\r\n                                id='installed_integrations.triggerWhen'\r\n                                defaultMessage='Trigger When: {triggerWhen}'\r\n                                values={{\r\n                                    triggerWhen,\r\n                                }}\r\n                            />\r\n                        </span>\r\n                    </div>\r\n                    <div className='item-details__row'>\r\n                        <span className='item-details__token'>\r\n                            <FormattedMessage\r\n                                id='installed_integrations.token'\r\n                                defaultMessage='Token: {token}'\r\n                                values={{\r\n                                    token: <code>{outgoingWebhook.token}</code>,\r\n                                }}\r\n                            />\r\n                            <CopyText\r\n                                label={defineMessage({\r\n                                    id: 'integrations.copy_token',\r\n                                    defaultMessage: 'Copy Token',\r\n                                })}\r\n                                value={outgoingWebhook.token}\r\n                            />\r\n                        </span>\r\n                    </div>\r\n                    <div className='item-details__row'>\r\n                        <span className='item-details__creation'>\r\n                            <FormattedMessage\r\n                                id='installed_integrations.creation'\r\n                                defaultMessage='Created by {creator} on {createAt, date, full}'\r\n                                values={{\r\n                                    creator: this.props.creator.username,\r\n                                    createAt: outgoingWebhook.create_at,\r\n                                }}\r\n                            />\r\n                        </span>\r\n                    </div>\r\n                    {urls}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport type {Channel} from '@mattermost/types/channels';\r\nimport type {OutgoingWebhook} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\nimport type {IDMappedObjects} from '@mattermost/types/utilities';\r\n\r\nimport type {ActionResult} from 'mattermost-redux/types/actions';\r\n\r\nimport BackstageList from 'components/backstage/components/backstage_list';\r\nimport ExternalLink from 'components/external_link';\r\nimport InstalledOutgoingWebhook, {matchesFilter} from 'components/integrations/installed_outgoing_webhook';\r\n\r\nimport {Constants, DeveloperLinks} from 'utils/constants';\r\nimport {localizeMessage} from 'utils/utils';\r\n\r\nexport type Props = {\r\n\r\n    /**\r\n    *  Data used in passing down as props for webhook modifications\r\n    */\r\n    team: Team;\r\n\r\n    /**\r\n    * Data used for checking if webhook is created by current user\r\n    */\r\n    user: UserProfile;\r\n\r\n    /**\r\n    *  Data used for checking modification privileges\r\n    */\r\n    canManageOthersWebhooks: boolean;\r\n\r\n    /**\r\n    * Data used in passing down as props for showing webhook details\r\n    */\r\n    outgoingWebhooks: OutgoingWebhook[];\r\n\r\n    /**\r\n    * Data used in sorting for displaying list and as props channel details\r\n    */\r\n    channels: IDMappedObjects<Channel>;\r\n\r\n    /**\r\n    *  Data used in passing down as props for webhook -created by label\r\n    */\r\n    users: IDMappedObjects<UserProfile>;\r\n\r\n    /**\r\n    *  Data used in passing as argument for loading webhooks\r\n    */\r\n    teamId: string;\r\n\r\n    actions: {\r\n\r\n        /**\r\n        * The function to call for removing outgoingWebhook\r\n        */\r\n        removeOutgoingHook: (hookId: string) => Promise<ActionResult>;\r\n\r\n        /**\r\n        * The function to call for outgoingWebhook List and for the status of api\r\n        */\r\n        loadOutgoingHooksAndProfilesForTeam: (teamId: string, page: number, perPage: number) => Promise<ActionResult>;\r\n\r\n        /**\r\n        * The function to call for regeneration of webhook token\r\n        */\r\n        regenOutgoingHookToken: (hookId: string) => Promise<ActionResult>;\r\n    };\r\n\r\n    /**\r\n    * Whether or not outgoing webhooks are enabled.\r\n    */\r\n    enableOutgoingWebhooks: boolean;\r\n}\r\n\r\ntype State = {\r\n    loading: boolean;\r\n};\r\n\r\nexport default class InstalledOutgoingWebhooks extends React.PureComponent<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            loading: true,\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (this.props.enableOutgoingWebhooks) {\r\n            this.props.actions.loadOutgoingHooksAndProfilesForTeam(\r\n                this.props.teamId,\r\n                Constants.Integrations.START_PAGE_NUM,\r\n                Constants.Integrations.PAGE_SIZE,\r\n            ).then(\r\n                () => this.setState({loading: false}),\r\n            );\r\n        }\r\n    }\r\n\r\n    regenOutgoingWebhookToken = (outgoingWebhook: OutgoingWebhook) => {\r\n        this.props.actions.regenOutgoingHookToken(outgoingWebhook.id);\r\n    };\r\n\r\n    removeOutgoingHook = (outgoingWebhook: OutgoingWebhook) => {\r\n        this.props.actions.removeOutgoingHook(outgoingWebhook.id);\r\n    };\r\n\r\n    outgoingWebhookCompare = (a: OutgoingWebhook, b: OutgoingWebhook) => {\r\n        let displayNameA = a.display_name;\r\n        if (!displayNameA) {\r\n            const channelA = this.props.channels[a.channel_id];\r\n            if (channelA) {\r\n                displayNameA = channelA.display_name;\r\n            } else {\r\n                displayNameA = localizeMessage({id: 'installed_outgoing_webhooks.unknown_channel', defaultMessage: 'A Private Webhook'});\r\n            }\r\n        }\r\n\r\n        let displayNameB = b.display_name;\r\n        if (!displayNameB) {\r\n            const channelB = this.props.channels[b.channel_id];\r\n            if (channelB) {\r\n                displayNameB = channelB.display_name;\r\n            } else {\r\n                displayNameB = localizeMessage({id: 'installed_outgoing_webhooks.unknown_channel', defaultMessage: 'A Private Webhook'});\r\n            }\r\n        }\r\n        return displayNameA.localeCompare(displayNameB);\r\n    };\r\n\r\n    outgoingWebhooks = (filter: string) => this.props.outgoingWebhooks.\r\n        sort(this.outgoingWebhookCompare).\r\n        filter((outgoingWebhook) => matchesFilter(outgoingWebhook, this.props.channels[outgoingWebhook.channel_id], filter)).\r\n        map((outgoingWebhook) => {\r\n            const canChange = this.props.canManageOthersWebhooks || this.props.user.id === outgoingWebhook.creator_id;\r\n            const channel = this.props.channels[outgoingWebhook.channel_id];\r\n            return (\r\n                <InstalledOutgoingWebhook\r\n                    key={outgoingWebhook.id}\r\n                    outgoingWebhook={outgoingWebhook}\r\n                    onRegenToken={this.regenOutgoingWebhookToken}\r\n                    onDelete={this.removeOutgoingHook}\r\n                    creator={this.props.users[outgoingWebhook.creator_id] || {}}\r\n                    canChange={canChange}\r\n                    team={this.props.team}\r\n                    channel={channel}\r\n                />\r\n            );\r\n        });\r\n\r\n    render() {\r\n        return (\r\n            <BackstageList\r\n                header={\r\n                    <FormattedMessage\r\n                        id='installed_outgoing_webhooks.header'\r\n                        defaultMessage='Installed Outgoing Webhooks'\r\n                    />\r\n                }\r\n                addText={\r\n                    <FormattedMessage\r\n                        id='installed_outgoing_webhooks.add'\r\n                        defaultMessage='Add Outgoing Webhook'\r\n                    />\r\n                }\r\n                addLink={\r\n                    '/' +\r\n                    this.props.team.name +\r\n                    '/integrations/outgoing_webhooks/add'\r\n                }\r\n                addButtonId='addOutgoingWebhook'\r\n                emptyText={\r\n                    <FormattedMessage\r\n                        id='installed_outgoing_webhooks.empty'\r\n                        defaultMessage='No outgoing webhooks found'\r\n                    />\r\n                }\r\n                emptyTextSearch={\r\n                    <FormattedMessage\r\n                        id='installed_outgoing_webhooks.search.empty'\r\n                        defaultMessage='No outgoing webhooks match <b>{searchTerm}</b>'\r\n                        values={{\r\n                            b: (chunks) => <b>{chunks}</b>,\r\n                        }}\r\n                    />\r\n                }\r\n                helpText={\r\n                    <FormattedMessage\r\n                        id='installed_outgoing_webhooks.help'\r\n                        defaultMessage='Use outgoing webhooks to connect external tools to Mattermost. {buildYourOwn} or visit the {appDirectory} to find self-hosted, third-party apps and integrations.'\r\n                        values={{\r\n                            buildYourOwn: (\r\n                                <ExternalLink\r\n                                    href={DeveloperLinks.SETUP_OUTGOING_WEBHOOKS}\r\n                                    location='installed_outgoing_webhooks'\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='installed_outgoing_webhooks.help.buildYourOwn'\r\n                                        defaultMessage='Build your own'\r\n                                    />\r\n                                </ExternalLink>\r\n                            ),\r\n                            appDirectory: (\r\n                                <ExternalLink\r\n                                    href='https://mattermost.com/marketplace'\r\n                                    location='installed_outgoing_webhooks'\r\n                                >\r\n                                    <FormattedMessage\r\n                                        id='installed_outgoing_webhooks.help.appDirectory'\r\n                                        defaultMessage='App Directory'\r\n                                    />\r\n                                </ExternalLink>\r\n                            ),\r\n                        }}\r\n                    />\r\n                }\r\n                searchPlaceholder={localizeMessage({\r\n                    id: 'installed_outgoing_webhooks.search',\r\n                    defaultMessage: 'Search Outgoing Webhooks',\r\n                })}\r\n                loading={this.state.loading}\r\n            >\r\n                {(filter: string) => {\r\n                    const children = this.outgoingWebhooks(filter);\r\n                    return [children, children.length > 0];\r\n                }}\r\n            </BackstageList>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport type {Dispatch} from 'redux';\r\n\r\nimport * as Actions from 'mattermost-redux/actions/integrations';\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {getAllChannels} from 'mattermost-redux/selectors/entities/channels';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {getOutgoingHooks} from 'mattermost-redux/selectors/entities/integrations';\r\nimport {haveITeamPermission} from 'mattermost-redux/selectors/entities/roles';\r\nimport {getCurrentTeamId} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getUsers} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport {loadOutgoingHooksAndProfilesForTeam} from 'actions/integration_actions';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport InstalledOutgoingWebhook from './installed_outgoing_webhooks';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const config = getConfig(state);\r\n    const teamId = getCurrentTeamId(state);\r\n    const canManageOthersWebhooks = haveITeamPermission(state, teamId, Permissions.MANAGE_OTHERS_OUTGOING_WEBHOOKS);\r\n    const outgoingHooks = getOutgoingHooks(state);\r\n    const outgoingWebhooks = Object.keys(outgoingHooks).\r\n        map((key) => outgoingHooks[key]).\r\n        filter((outgoingWebhook) => outgoingWebhook.team_id === teamId);\r\n    const enableOutgoingWebhooks = config.EnableOutgoingWebhooks === 'true';\r\n\r\n    return {\r\n        outgoingWebhooks,\r\n        channels: getAllChannels(state),\r\n        users: getUsers(state),\r\n        teamId,\r\n        canManageOthersWebhooks,\r\n        enableOutgoingWebhooks,\r\n    };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch: Dispatch) {\r\n    return {\r\n        actions: bindActionCreators({\r\n            loadOutgoingHooksAndProfilesForTeam,\r\n            removeOutgoingHook: Actions.removeOutgoingHook,\r\n            regenOutgoingHookToken: Actions.regenOutgoingHookToken,\r\n        }, dispatch),\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(InstalledOutgoingWebhook);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {ChangeEvent, FormEvent} from 'react';\r\nimport React, {useMemo, useState} from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\nimport type {MessageDescriptor} from 'react-intl';\r\nimport {useDispatch} from 'react-redux';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport {AlertOutlineIcon, CheckCircleOutlineIcon} from '@mattermost/compass-icons/components';\r\nimport type {OutgoingOAuthConnection} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport {validateOutgoingOAuthConnection} from 'mattermost-redux/actions/integrations';\r\n\r\nimport BackstageHeader from 'components/backstage/components/backstage_header';\r\nimport ConfirmModal from 'components/confirm_modal';\r\nimport FormError from 'components/form_error';\r\nimport SpinnerButton from 'components/spinner_button';\r\nimport LoadingSpinner from 'components/widgets/loading/loading_spinner';\r\n\r\ntype Props = {\r\n    team: Team;\r\n    header: MessageDescriptor;\r\n    footer: MessageDescriptor;\r\n    loading: MessageDescriptor;\r\n    renderExtra?: JSX.Element;\r\n    serverError: string;\r\n\r\n    initialConnection?: OutgoingOAuthConnection;\r\n\r\n    submitAction: (connection: OutgoingOAuthConnection) => Promise<void>;\r\n}\r\n\r\ntype State = {\r\n    name: string;\r\n    oauthTokenUrl: string;\r\n    grantType: OutgoingOAuthConnection['grant_type'];\r\n    clientId: string;\r\n    clientSecret: string;\r\n    audienceUrls: string;\r\n};\r\n\r\nenum ValidationStatus {\r\n    INITIAL = 'initial',\r\n    DIRTY = 'dirty',\r\n    VALIDATING = 'validating',\r\n    VALIDATED = 'validated',\r\n    ERROR = 'error',\r\n}\r\n\r\nconst useOutgoingOAuthForm = (connection: OutgoingOAuthConnection): [State, (state: Partial<State>) => void] => {\r\n    const initialState: State = {\r\n        name: connection.name || '',\r\n        audienceUrls: connection.audiences ? connection.audiences.join('\\n') : '',\r\n        oauthTokenUrl: connection.oauth_token_url || '',\r\n        clientId: connection.client_id || '',\r\n        clientSecret: connection.client_secret || '',\r\n        grantType: 'client_credentials',\r\n    };\r\n\r\n    const [state, setState] = useState(initialState);\r\n\r\n    return useMemo(() => [state, (newState: Partial<State>) => {\r\n        setState((oldState) => ({...oldState, ...newState}));\r\n    }], [state]);\r\n};\r\n\r\nconst initialState: OutgoingOAuthConnection = {\r\n    id: '',\r\n    name: '',\r\n    creator_id: '',\r\n    create_at: 0,\r\n    update_at: 0,\r\n    client_id: '',\r\n    client_secret: '',\r\n    oauth_token_url: '',\r\n    grant_type: 'client_credentials',\r\n    audiences: [],\r\n};\r\n\r\nexport default function AbstractOutgoingOAuthConnection(props: Props) {\r\n    const [formState, setFormState] = useOutgoingOAuthForm(props.initialConnection || initialState);\r\n\r\n    const [storedError, setError] = useState<React.ReactNode>('');\r\n    const [validationError, setValidationError] = useState<string>('');\r\n\r\n    const [isSubmitting, setIsSubmitting] = useState(false);\r\n    const [validationStatus, setValidationStatus] = useState<ValidationStatus>(ValidationStatus.INITIAL);\r\n    const [isEditingSecret, setIsEditingSecret] = useState(false);\r\n\r\n    const [isValidationModalOpen, setIsValidationModalOpen] = useState(false);\r\n\r\n    const intl = useIntl();\r\n    const dispatch = useDispatch();\r\n\r\n    const isNewConnection = !props.initialConnection;\r\n\r\n    const parseForm = (requireAudienceUrl: boolean): OutgoingOAuthConnection | undefined => {\r\n        if (!formState.name) {\r\n            setIsSubmitting(false);\r\n            setError(\r\n                <FormattedMessage\r\n                    id='add_outgoing_oauth_connection.name.required'\r\n                    defaultMessage='Name for the OAuth connection is required.'\r\n                />,\r\n            );\r\n\r\n            return undefined;\r\n        }\r\n\r\n        if (!formState.clientId) {\r\n            setIsSubmitting(false);\r\n            setError(\r\n                <FormattedMessage\r\n                    id='add_outgoing_oauth_connection.client_id.required'\r\n                    defaultMessage='Client Id for the OAuth connection is required.'\r\n                />,\r\n            );\r\n\r\n            return undefined;\r\n        }\r\n\r\n        if ((isNewConnection || isEditingSecret) && !formState.clientSecret) {\r\n            setIsSubmitting(false);\r\n            setError(\r\n                <FormattedMessage\r\n                    id='add_outgoing_oauth_connection.client_secret.required'\r\n                    defaultMessage='Client Secret for the OAuth connection is required.'\r\n                />,\r\n            );\r\n\r\n            return undefined;\r\n        }\r\n\r\n        if (!formState.grantType) {\r\n            setIsSubmitting(false);\r\n            setError(\r\n                <FormattedMessage\r\n                    id='add_outgoing_oauth_connection.grant_type.required'\r\n                    defaultMessage='Grant Type for the OAuth connection is required.'\r\n                />,\r\n            );\r\n\r\n            return undefined;\r\n        }\r\n\r\n        if (!formState.oauthTokenUrl) {\r\n            setIsSubmitting(false);\r\n            setError(\r\n                <FormattedMessage\r\n                    id='add_outgoing_oauth_connection.oauth_token_url.required'\r\n                    defaultMessage='OAuth Token URL for the OAuth connection is required.'\r\n                />,\r\n            );\r\n\r\n            return undefined;\r\n        }\r\n\r\n        const audienceUrls = [];\r\n        for (let audienceUrl of formState.audienceUrls.split('\\n')) {\r\n            audienceUrl = audienceUrl.trim();\r\n\r\n            if (audienceUrl.length > 0) {\r\n                audienceUrls.push(audienceUrl);\r\n            }\r\n        }\r\n\r\n        if (requireAudienceUrl && audienceUrls.length === 0) {\r\n            setIsSubmitting(false);\r\n            setError(\r\n                <FormattedMessage\r\n                    id='add_outgoing_oauth_connection.audienceUrls.required'\r\n                    defaultMessage='One or more audience URLs are required.'\r\n                />,\r\n            );\r\n\r\n            return undefined;\r\n        }\r\n\r\n        const connection = {\r\n            name: formState.name,\r\n            audiences: audienceUrls,\r\n            client_id: formState.clientId,\r\n            client_secret: formState.clientSecret,\r\n            grant_type: formState.grantType,\r\n            oauth_token_url: formState.oauthTokenUrl,\r\n        } as OutgoingOAuthConnection;\r\n\r\n        return connection;\r\n    };\r\n\r\n    const showSkipValidateModal = () => {\r\n        setIsValidationModalOpen(true);\r\n    };\r\n\r\n    const hideSkipValidateModal = () => {\r\n        setIsValidationModalOpen(false);\r\n    };\r\n\r\n    const handleSubmitFromButton = (e: FormEvent) => {\r\n        e.preventDefault();\r\n        handleSubmit();\r\n    };\r\n\r\n    const handleSubmit = () => {\r\n        if (isSubmitting) {\r\n            return;\r\n        }\r\n\r\n        const connection = parseForm(true);\r\n        if (!connection) {\r\n            return;\r\n        }\r\n\r\n        setError('');\r\n\r\n        if (validationStatus !== ValidationStatus.VALIDATED && !(!isNewConnection && validationStatus === ValidationStatus.INITIAL)) {\r\n            if (!isValidationModalOpen) {\r\n                showSkipValidateModal();\r\n                return;\r\n            }\r\n        }\r\n\r\n        setIsSubmitting(true);\r\n\r\n        const res = props.submitAction(connection);\r\n        res.then(() => setIsSubmitting(false));\r\n    };\r\n\r\n    const handleValidate = async (e: FormEvent) => {\r\n        e.preventDefault();\r\n\r\n        if (validationStatus === ValidationStatus.VALIDATING) {\r\n            return;\r\n        }\r\n\r\n        setError('');\r\n        setValidationStatus(ValidationStatus.VALIDATING);\r\n\r\n        const connection = parseForm(false);\r\n        if (!connection) {\r\n            // Defer to the form validation error\r\n            setValidationStatus(ValidationStatus.INITIAL);\r\n            return;\r\n        }\r\n\r\n        if (props.initialConnection?.id) {\r\n            connection.id = props.initialConnection.id;\r\n        }\r\n\r\n        const {error} = await dispatch(validateOutgoingOAuthConnection(props.team.id, connection));\r\n\r\n        if (error) {\r\n            setValidationStatus(ValidationStatus.ERROR);\r\n            setValidationError(error.message);\r\n        } else {\r\n            setValidationStatus(ValidationStatus.VALIDATED);\r\n        }\r\n    };\r\n\r\n    const setUnvalidated = (e?: React.FormEvent) => {\r\n        e?.preventDefault();\r\n\r\n        if (validationStatus !== ValidationStatus.DIRTY) {\r\n            setValidationStatus(ValidationStatus.DIRTY);\r\n        }\r\n\r\n        if (validationError) {\r\n            setValidationError('');\r\n        }\r\n    };\r\n\r\n    const updateName = (e: ChangeEvent<HTMLInputElement>) => {\r\n        setFormState({\r\n            name: e.target.value,\r\n        });\r\n    };\r\n\r\n    const updateClientId = (e: ChangeEvent<HTMLInputElement>) => {\r\n        setUnvalidated();\r\n\r\n        setFormState({\r\n            clientId: e.target.value,\r\n        });\r\n    };\r\n\r\n    const updateClientSecret = (e: ChangeEvent<HTMLInputElement>) => {\r\n        setUnvalidated();\r\n\r\n        setFormState({\r\n            clientSecret: e.target.value,\r\n        });\r\n    };\r\n\r\n    const updateOAuthTokenURL = (e: ChangeEvent<HTMLInputElement>) => {\r\n        setUnvalidated();\r\n\r\n        setFormState({\r\n            oauthTokenUrl: e.target.value,\r\n        });\r\n    };\r\n\r\n    const updateAudienceUrls = (e: ChangeEvent<HTMLTextAreaElement>) => {\r\n        setFormState({\r\n            audienceUrls: e.target.value,\r\n        });\r\n    };\r\n\r\n    const startEditingClientSecret = () => {\r\n        setIsEditingSecret(true);\r\n    };\r\n\r\n    const headerToRender = props.header;\r\n    const footerToRender = props.footer;\r\n\r\n    let clientSecretSection = (\r\n        <input\r\n            id='client_secret'\r\n            type='text'\r\n            autoComplete='off'\r\n            className='form-control'\r\n            value={formState.clientSecret}\r\n            onChange={updateClientSecret}\r\n        />\r\n    );\r\n\r\n    if (!isNewConnection && !isEditingSecret) {\r\n        clientSecretSection = (\r\n            <>\r\n                <input\r\n                    id='client_secret'\r\n                    disabled={true}\r\n                    autoComplete='off'\r\n                    type='text'\r\n                    className='form-control disabled'\r\n                    value={''.repeat(40)}\r\n                />\r\n                <span\r\n                    onClick={startEditingClientSecret}\r\n                    className='outgoing-oauth-connections-edit-secret'\r\n                >\r\n                    <i className='icon icon-pencil-outline'/>\r\n                </span>\r\n            </>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className='backstage-content'>\r\n            <BackstageHeader>\r\n                <Link to={`/${props.team.name}/integrations/outgoing-oauth2-connections`}>\r\n                    <FormattedMessage\r\n                        id='add_outgoing_oauth_connection.header'\r\n                        defaultMessage='Outgoing OAuth Connections'\r\n                    />\r\n                </Link>\r\n                <FormattedMessage\r\n                    id={headerToRender.id}\r\n                    defaultMessage={headerToRender.defaultMessage}\r\n                />\r\n            </BackstageHeader>\r\n            <div className='backstage-form'>\r\n                <form className='form-horizontal'>\r\n                    <div className='form-group'>\r\n                        <label\r\n                            className='control-label col-sm-4'\r\n                            htmlFor='name'\r\n                        >\r\n                            <FormattedMessage\r\n                                id='add_outgoing_oauth_connection.name.label'\r\n                                defaultMessage='Name'\r\n                            />\r\n                        </label>\r\n                        <div className='col-md-5 col-sm-8'>\r\n                            <input\r\n                                id='name'\r\n                                type='text'\r\n                                className='form-control'\r\n                                value={formState.name}\r\n                                onChange={updateName}\r\n                            />\r\n                            <div className='form__help'>\r\n                                <FormattedMessage\r\n                                    id='add_outgoing_oauth_connection.name.help'\r\n                                    defaultMessage='Specify the name for your OAuth connection.'\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div className='form-group'>\r\n                        <label\r\n                            className='control-label col-sm-4'\r\n                            htmlFor='client_id'\r\n                        >\r\n                            <FormattedMessage\r\n                                id='add_outgoing_oauth_connection.client_id.label'\r\n                                defaultMessage='Client ID'\r\n                            />\r\n                        </label>\r\n                        <div className='col-md-5 col-sm-8'>\r\n                            <input\r\n                                id='client_id'\r\n                                type='text'\r\n                                autoComplete='off'\r\n                                className='form-control'\r\n                                value={formState.clientId}\r\n                                onChange={updateClientId}\r\n                            />\r\n                            <div className='form__help'>\r\n                                <FormattedMessage\r\n                                    id='add_outgoing_oauth_connection.client_id.help'\r\n                                    defaultMessage='Specify the Client ID for your OAuth connection.'\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div className='form-group'>\r\n                        <label\r\n                            className='control-label col-sm-4'\r\n                            htmlFor='client_secret'\r\n                        >\r\n                            <FormattedMessage\r\n                                id='add_outgoing_oauth_connection.client_secret.label'\r\n                                defaultMessage='Client Secret'\r\n                            />\r\n                        </label>\r\n                        <div className='col-md-5 col-sm-8'>\r\n                            {clientSecretSection}\r\n                            <div className='form__help'>\r\n                                <FormattedMessage\r\n                                    id='add_outgoing_oauth_connection.client_secret.help'\r\n                                    defaultMessage='Specify the Client Secret for your OAuth connection.'\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div className='form-group'>\r\n                        <label\r\n                            className='control-label col-sm-4'\r\n                            htmlFor='oauth_token_url'\r\n                        >\r\n                            <FormattedMessage\r\n                                id='add_outgoing_oauth_connection.oauth_token_url.label'\r\n                                defaultMessage='OAuth Token URL'\r\n                            />\r\n                        </label>\r\n                        <div className='col-md-5 col-sm-8'>\r\n                            <input\r\n                                id='token_url'\r\n                                type='text'\r\n                                className='form-control'\r\n                                value={formState.oauthTokenUrl}\r\n                                onChange={updateOAuthTokenURL}\r\n                            />\r\n                            <div className='form__help'>\r\n                                <FormattedMessage\r\n                                    id='add_outgoing_oauth_connection.oauth_token_url.help'\r\n                                    defaultMessage='Specify the OAuth Token URL for your OAuth connection.'\r\n                                />\r\n                            </div>\r\n                            <div className='outgoing-oauth-connection-validate-button-container'>\r\n                                <ValidateButton\r\n                                    onClick={handleValidate}\r\n                                    setUnvalidated={setUnvalidated}\r\n                                    status={validationStatus}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div className='form-group'>\r\n                        <label\r\n                            className='control-label col-sm-4'\r\n                            htmlFor='audienceUrls'\r\n                        >\r\n                            <FormattedMessage\r\n                                id='add_outgoing_oauth_connection.audienceUrls.label'\r\n                                defaultMessage='Audience URLs (One Per Line)'\r\n                            />\r\n                        </label>\r\n                        <div className='col-md-5 col-sm-8'>\r\n                            <textarea\r\n                                id='audienceUrls'\r\n                                rows={3}\r\n                                className='form-control'\r\n                                value={formState.audienceUrls}\r\n                                onChange={updateAudienceUrls}\r\n                            />\r\n                            <div className='form__help'>\r\n                                <FormattedMessage\r\n                                    id='add_outgoing_oauth_connection.audienceUrls.help'\r\n                                    defaultMessage='The URLs which will receive requests with the OAuth token, e.g. your custom slash command handler endpoint. Must be a valid URL and start with http:// or https://.'\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div className='backstage-form__footer'>\r\n                        <FormError\r\n                            type='backstage'\r\n                            errors={[props.serverError, storedError]}\r\n                        />\r\n                        <Link\r\n                            className='btn btn-tertiary'\r\n                            to={`/${props.team.name}/integrations/outgoing-oauth2-connections`}\r\n                        >\r\n                            <FormattedMessage\r\n                                id='add_outgoing_oauth_connection.cancel'\r\n                                defaultMessage='Cancel'\r\n                            />\r\n                        </Link>\r\n                        <SpinnerButton\r\n                            className='btn btn-primary'\r\n                            type='submit'\r\n                            spinning={isSubmitting}\r\n                            spinningText={intl.formatMessage(props.loading)}\r\n                            onClick={handleSubmitFromButton}\r\n                            id='saveConnection'\r\n                        >\r\n                            <FormattedMessage\r\n                                id={footerToRender.id}\r\n                                defaultMessage={footerToRender.defaultMessage}\r\n                            />\r\n                        </SpinnerButton>\r\n                        {props.renderExtra}\r\n                    </div>\r\n                </form>\r\n            </div>\r\n            <div className='outgoing-oauth-connections-docs-link'>\r\n                <FormattedMessage\r\n                    id={'add_outgoing_oauth_connection.documentation_link'}\r\n                    defaultMessage={'Get help with <link>configuring outgoing OAuth connections</link>.'}\r\n                    values={{\r\n                        link: (text) => (\r\n                            <a href='https://mattermost.com/pl/outgoing-oauth-connections'>{text}</a>\r\n                        ),\r\n                    }}\r\n                />\r\n            </div>\r\n            <ConfirmModal\r\n                show={isValidationModalOpen}\r\n                message={intl.formatMessage({\r\n                    id: 'add_outgoing_oauth_connection.save_without_validation_warning',\r\n                    defaultMessage: 'This connection has not been validated, Do you want to save anyway?',\r\n                })}\r\n                title={intl.formatMessage({\r\n                    id: 'add_outgoing_oauth_connection.confirm_save',\r\n                    defaultMessage: 'Save Outgoing OAuth Connection',\r\n                })}\r\n                confirmButtonText={intl.formatMessage({\r\n                    id: 'add_outgoing_oauth_connection.save_anyway',\r\n                    defaultMessage: 'Save anyway',\r\n                })}\r\n                onExited={hideSkipValidateModal}\r\n                onCancel={hideSkipValidateModal}\r\n                onConfirm={handleSubmit}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n\r\ntype ValidateButtonProps = {\r\n    status: ValidationStatus;\r\n    onClick: (e: FormEvent) => void;\r\n    setUnvalidated: (e: FormEvent) => void;\r\n}\r\n\r\nconst ValidateButton = ({status, onClick, setUnvalidated}: ValidateButtonProps) => {\r\n    if (status === ValidationStatus.ERROR) {\r\n        return (\r\n            <span\r\n                className='outgoing-oauth-connection-validation-message validation-error'\r\n            >\r\n                <AlertOutlineIcon size={20}/>\r\n                <FormattedMessage\r\n                    id={'add_outgoing_oauth_connection.validation_error'}\r\n                    defaultMessage={'Connection not validated. Please check the server logs for details or <link>try again</link>.'}\r\n                    values={{\r\n                        link: (text) => <a onClick={setUnvalidated}>{text}</a>,\r\n                    }}\r\n                />\r\n            </span>\r\n        );\r\n    }\r\n\r\n    if (status === ValidationStatus.VALIDATED) {\r\n        return (\r\n            <span\r\n                className='outgoing-oauth-connection-validation-message validation-success'\r\n            >\r\n                <CheckCircleOutlineIcon size={20}/>\r\n                <FormattedMessage\r\n                    id={'add_outgoing_oauth_connection.validated_connection'}\r\n                    defaultMessage={'Validated connection'}\r\n                />\r\n            </span>\r\n        );\r\n    }\r\n\r\n    if (status === ValidationStatus.VALIDATING) {\r\n        return (\r\n            <span\r\n                className='outgoing-oauth-connection-validation-message'\r\n            >\r\n                <LoadingSpinner\r\n                    text={(\r\n                        <FormattedMessage\r\n                            id={'add_outgoing_oauth_connection.validating'}\r\n                            defaultMessage={'Validating...'}\r\n                        />\r\n                    )}\r\n                />\r\n            </span>\r\n        );\r\n    }\r\n\r\n    const validateButton = (\r\n        <button\r\n            className='btn btn-tertiary btn-sm'\r\n            type='button'\r\n            onClick={onClick}\r\n            id='validateConnection'\r\n        >\r\n            <FormattedMessage\r\n                id={'add_outgoing_oauth_connection.validate'}\r\n                defaultMessage={'Validate Connection'}\r\n            />\r\n        </button>\r\n    );\r\n\r\n    return validateButton;\r\n};\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useState} from 'react';\r\nimport {defineMessage} from 'react-intl';\r\nimport {useDispatch} from 'react-redux';\r\nimport {useHistory} from 'react-router-dom';\r\n\r\nimport type {OutgoingOAuthConnection} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport {addOutgoingOAuthConnection} from 'mattermost-redux/actions/integrations';\r\n\r\nimport AbstractOutgoingOAuthConnection from './abstract_outgoing_oauth_connection';\r\n\r\nconst HEADER = defineMessage({id: 'add_outgoing_oauth_connection.add', defaultMessage: 'Add'});\r\nconst FOOTER = defineMessage({id: 'add_outgoing_oauth_connection.save', defaultMessage: 'Save'});\r\nconst LOADING = defineMessage({id: 'add_outgoing_oauth_connection.saving', defaultMessage: 'Saving...'});\r\n\r\nexport type Props = {\r\n    team: Team;\r\n};\r\n\r\nconst AddOutgoingOAuthConnection = ({team}: Props): JSX.Element => {\r\n    const dispatch = useDispatch();\r\n\r\n    const history = useHistory();\r\n\r\n    const [serverError, setServerError] = useState('');\r\n\r\n    const submit = async (connection: OutgoingOAuthConnection) => {\r\n        setServerError('');\r\n\r\n        const {data, error} = (await dispatch(addOutgoingOAuthConnection(team.id, connection))) as unknown as {data: OutgoingOAuthConnection; error: Error};\r\n        if (data) {\r\n            history.push(`/${team.name}/integrations/confirm?type=outgoing-oauth2-connections&id=${data.id}`);\r\n            return;\r\n        }\r\n\r\n        if (error) {\r\n            setServerError(error.message);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <AbstractOutgoingOAuthConnection\r\n            team={team}\r\n            header={HEADER}\r\n            footer={FOOTER}\r\n            loading={LOADING}\r\n            submitAction={submit}\r\n            serverError={serverError}\r\n        />\r\n    );\r\n};\r\n\r\nexport default AddOutgoingOAuthConnection;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useEffect, useState} from 'react';\r\nimport {FormattedMessage, defineMessage} from 'react-intl';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\n\r\nimport type {OutgoingOAuthConnection} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport {editOutgoingOAuthConnection, getOutgoingOAuthConnection} from 'mattermost-redux/actions/integrations';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {getOutgoingOAuthConnections} from 'mattermost-redux/selectors/entities/integrations';\r\n\r\nimport ConfirmModal from 'components/confirm_modal';\r\nimport LoadingScreen from 'components/loading_screen';\r\n\r\nimport {getHistory} from 'utils/browser_history';\r\n\r\nimport AbstractOutgoingOAuthConnection from './abstract_outgoing_oauth_connection';\r\n\r\nconst HEADER = defineMessage({id: 'integrations.edit', defaultMessage: 'Edit'});\r\nconst FOOTER = defineMessage({id: 'edit_outgoing_oauth_connection.update', defaultMessage: 'Update'});\r\nconst LOADING = defineMessage({id: 'edit_outgoing_oauth_connection.updating', defaultMessage: 'Updating...'});\r\n\r\ntype Props = {\r\n    team: Team;\r\n    location: Location;\r\n};\r\n\r\nconst getConnectionIdFromSearch = (search: string): string => {\r\n    return (new URLSearchParams(search)).get('id') || '';\r\n};\r\n\r\nconst EditOutgoingOAuthConnection = (props: Props) => {\r\n    const connectionId = getConnectionIdFromSearch(props.location.search);\r\n    const connections = useSelector(getOutgoingOAuthConnections);\r\n    const existingConnection = connections[connectionId];\r\n\r\n    const [newConnection, setNewConnection] = useState(existingConnection);\r\n    const [showConfirmModal, setShowConfirmModal] = useState(false);\r\n    const [serverError, setServerError] = useState('');\r\n\r\n    const enableOAuthServiceProvider = useSelector(getConfig).EnableOAuthServiceProvider;\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    useEffect(() => {\r\n        if (enableOAuthServiceProvider) {\r\n            dispatch(getOutgoingOAuthConnection(props.team.id, connectionId));\r\n        }\r\n    }, [connectionId, enableOAuthServiceProvider, props.team, dispatch]);\r\n\r\n    const handleInitialSubmit = async (connection: OutgoingOAuthConnection) => {\r\n        setNewConnection(connection);\r\n\r\n        if (existingConnection.id) {\r\n            connection.id = existingConnection.id;\r\n        }\r\n\r\n        const audienceUrlsSame = (existingConnection.audiences.length === connection.audiences.length) &&\r\n            existingConnection.audiences.every((v, i) => v === connection.audiences[i]);\r\n\r\n        if (audienceUrlsSame) {\r\n            await createOutgoingOAuthConnection(connection);\r\n        } else {\r\n            handleConfirmModal();\r\n        }\r\n    };\r\n\r\n    const handleConfirmModal = () => {\r\n        setShowConfirmModal(true);\r\n    };\r\n\r\n    const confirmModalDismissed = () => {\r\n        setShowConfirmModal(false);\r\n    };\r\n\r\n    const createOutgoingOAuthConnection = async (connection: OutgoingOAuthConnection) => {\r\n        setServerError('');\r\n\r\n        const res = await dispatch(editOutgoingOAuthConnection(props.team.id, connection));\r\n\r\n        if ('data' in res && res.data) {\r\n            getHistory().push(`/${props.team.name}/integrations/outgoing-oauth2-connections`);\r\n            return;\r\n        }\r\n\r\n        confirmModalDismissed();\r\n\r\n        if ('error' in res) {\r\n            const {error: err} = res as {error: Error};\r\n            setServerError(err.message);\r\n        }\r\n    };\r\n\r\n    const renderExtra = () => {\r\n        const confirmButton = (\r\n            <FormattedMessage\r\n                id='update_command.update'\r\n                defaultMessage='Update'\r\n            />\r\n        );\r\n\r\n        const confirmTitle = (\r\n            <FormattedMessage\r\n                id='update_outgoing_oauth_connection.confirm'\r\n                defaultMessage='Edit Outgoing OAuth Connection'\r\n            />\r\n        );\r\n\r\n        const confirmMessage = (\r\n            <FormattedMessage\r\n                id='update_outgoing_oauth_connection.question'\r\n                defaultMessage='Your changes may break any existing integrations using this connection. Are you sure you would like to update it?'\r\n            />\r\n        );\r\n\r\n        return (\r\n            <ConfirmModal\r\n                title={confirmTitle}\r\n                message={confirmMessage}\r\n                confirmButtonText={confirmButton}\r\n                modalClass='integrations-backstage-modal'\r\n                show={showConfirmModal}\r\n                onConfirm={() => createOutgoingOAuthConnection(newConnection)}\r\n                onCancel={confirmModalDismissed}\r\n            />\r\n        );\r\n    };\r\n\r\n    if (!existingConnection) {\r\n        return <LoadingScreen/>;\r\n    }\r\n\r\n    return (\r\n        <AbstractOutgoingOAuthConnection\r\n            team={props.team}\r\n            header={HEADER}\r\n            footer={FOOTER}\r\n            loading={LOADING}\r\n            renderExtra={renderExtra()}\r\n            submitAction={handleInitialSubmit}\r\n            serverError={serverError}\r\n            initialConnection={existingConnection}\r\n        />\r\n    );\r\n};\r\n\r\nexport default EditOutgoingOAuthConnection;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\nimport {Link} from 'react-router-dom';\r\n\r\nimport type {OutgoingOAuthConnection} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport DeleteIntegrationLink from '../delete_integration_link';\r\n\r\nexport function matchesFilter(outgoingOAuthConnection: OutgoingOAuthConnection, filter?: string | null): boolean {\r\n    if (!filter) {\r\n        return true;\r\n    }\r\n\r\n    return outgoingOAuthConnection.name.toLowerCase().includes(filter);\r\n}\r\n\r\nexport type InstalledOutgoingOAuthConnectionProps = {\r\n    team: Partial<Team>;\r\n    outgoingOAuthConnection: OutgoingOAuthConnection;\r\n    creatorName: string;\r\n    filter?: string | null;\r\n\r\n    onDelete: (outgoingOAuthConnection: OutgoingOAuthConnection) => void;\r\n}\r\n\r\nexport type InstalledOutgoingOAuthConnectionState = {\r\n    clientSecret: string;\r\n    error?: string | null;\r\n}\r\n\r\nconst InstalledOutgoingOAuthConnection = (props: InstalledOutgoingOAuthConnectionProps) => {\r\n    const handleDelete = (): void => {\r\n        props.onDelete(props.outgoingOAuthConnection);\r\n    };\r\n\r\n    const {outgoingOAuthConnection, creatorName} = props;\r\n\r\n    if (!matchesFilter(outgoingOAuthConnection, props.filter)) {\r\n        return null;\r\n    }\r\n\r\n    let name;\r\n    if (outgoingOAuthConnection.name) {\r\n        name = outgoingOAuthConnection.name;\r\n    } else {\r\n        name = (\r\n            <FormattedMessage\r\n                id='installed_integrations.unnamed_outgoing_oauth_connection'\r\n                defaultMessage='Unnamed Outgoing OAuth Connection'\r\n            />\r\n        );\r\n    }\r\n\r\n    const urls = (\r\n        <>\r\n            <div className='item-details__row'>\r\n                <span className='item-details__url word-break--all'>\r\n                    <FormattedMessage\r\n                        id='installed_integrations.audience_urls'\r\n                        defaultMessage='Audience URLs: {urls}'\r\n                        values={{\r\n                            urls: <code>{outgoingOAuthConnection.audiences.join(', ')}</code>,\r\n                        }}\r\n                    />\r\n                </span>\r\n            </div>\r\n            <div className='item-details__row'>\r\n                <span className='item-details__url word-break--all'>\r\n                    <FormattedMessage\r\n                        id='installed_integrations.token_url'\r\n                        defaultMessage='Token URL: {url}'\r\n                        values={{\r\n                            url: <code>{outgoingOAuthConnection.oauth_token_url}</code>,\r\n                        }}\r\n                    />\r\n                </span>\r\n            </div>\r\n        </>\r\n    );\r\n\r\n    const actions = (\r\n        <div className='item-actions'>\r\n            <Link to={`/${props.team.name}/integrations/outgoing-oauth2-connections/edit?id=${outgoingOAuthConnection.id}`}>\r\n                <FormattedMessage\r\n                    id='installed_integrations.edit'\r\n                    defaultMessage='Edit'\r\n                />\r\n            </Link>\r\n            {' - '}\r\n            <DeleteIntegrationLink\r\n                subtitleText={\r\n                    <FormattedMessage\r\n                        id='installed_outgoing_oauth_connections.delete.confirm'\r\n                        defaultMessage='Are you sure you want to delete {connectionName}?'\r\n                        values={{\r\n                            connectionName: (\r\n                                <strong>\r\n                                    {props.outgoingOAuthConnection.name}\r\n                                </strong>\r\n                            ),\r\n                        }}\r\n                    />\r\n                }\r\n                modalMessage={\r\n                    <FormattedMessage\r\n                        id='installed_outgoing_oauth_connections.delete.wanring'\r\n                        defaultMessage='Deleting this connection will break any integrations using it'\r\n                    />\r\n                }\r\n                onDelete={handleDelete}\r\n            />\r\n        </div>\r\n    );\r\n\r\n    const connectionInfo = (\r\n        <>\r\n            <div className='item-details__row'>\r\n                <span className='item-details__token'>\r\n                    <FormattedMessage\r\n                        id='installed_integrations.client_id'\r\n                        defaultMessage='Client ID: '\r\n                    />\r\n                    <strong><code>{outgoingOAuthConnection.client_id}</code></strong>\r\n                </span>\r\n            </div>\r\n            <div className='item-details__row'>\r\n                <span className='item-details__token'>\r\n                    <FormattedMessage\r\n                        id='installed_outgoing_oauth_connections.client_secret'\r\n                        defaultMessage='Client Secret: ********'\r\n                    />\r\n                </span>\r\n            </div>\r\n            {outgoingOAuthConnection.grant_type === 'password' && (\r\n                <>\r\n                    <div className='item-details__row'>\r\n                        <span className='item-details__token'>\r\n                            <FormattedMessage\r\n                                id='installed_outgoing_oauth_connections.username'\r\n                                defaultMessage='Username: '\r\n                            />\r\n                            <strong>{outgoingOAuthConnection.credentials_username}</strong>\r\n                        </span>\r\n                    </div>\r\n                    <div className='item-details__row'>\r\n                        <span className='item-details__token'>\r\n                            <FormattedMessage\r\n                                id='installed_outgoing_oauth_connections.password'\r\n                                defaultMessage='Password: ********'\r\n                            />\r\n                        </span>\r\n                    </div>\r\n                </>\r\n            )}\r\n\r\n            {urls}\r\n            <div className='item-details__row'>\r\n                <span className='item-details__creation'>\r\n                    <FormattedMessage\r\n                        id='installed_integrations.creation'\r\n                        defaultMessage='Created by {creator} on {createAt, date, full}'\r\n                        values={{\r\n                            creator: creatorName,\r\n                            createAt: outgoingOAuthConnection.create_at,\r\n                        }}\r\n                    />\r\n                </span>\r\n            </div>\r\n        </>\r\n    );\r\n\r\n    return (\r\n        <div className='backstage-list__item' >\r\n            <div className='item-details' >\r\n                <div className='item-details__row d-flex flex-column flex-md-row justify-content-between'>\r\n                    <strong className='item-details__name'>\r\n                        {name}\r\n                    </strong>\r\n                    {actions}\r\n                </div>\r\n                {connectionInfo}\r\n            </div>\r\n        </div >\r\n    );\r\n};\r\n\r\nexport default InstalledOutgoingOAuthConnection;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useEffect, useState} from 'react';\r\nimport {FormattedMessage, useIntl} from 'react-intl';\r\nimport {useDispatch, useSelector} from 'react-redux';\r\n\r\nimport type {OutgoingOAuthConnection} from '@mattermost/types/integrations';\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport {deleteOutgoingOAuthConnection} from 'mattermost-redux/actions/integrations';\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {getOutgoingOAuthConnections} from 'mattermost-redux/selectors/entities/integrations';\r\nimport {haveITeamPermission} from 'mattermost-redux/selectors/entities/roles';\r\n\r\nimport {loadOutgoingOAuthConnectionsAndProfiles} from 'actions/integration_actions';\r\n\r\nimport BackstageList from 'components/backstage/components/backstage_list';\r\nimport ExternalLink from 'components/external_link';\r\n\r\nimport {DeveloperLinks} from 'utils/constants';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport InstalledOutgoingOAuthConnection, {matchesFilter} from './installed_outgoing_oauth_connection';\r\n\r\ntype Props = {\r\n    team: Team;\r\n};\r\n\r\nconst InstalledOutgoingOAuthConnections = (props: Props) => {\r\n    const [loading, setLoading] = useState(true);\r\n    const canManageOutgoingOAuthConnections = useSelector((state: GlobalState) => haveITeamPermission(state, props.team.id, Permissions.MANAGE_OUTGOING_OAUTH_CONNECTIONS));\r\n    const enableOutgoingOAuthConnections = (useSelector(getConfig).EnableOutgoingOAuthConnections === 'true');\r\n    const connections = useSelector(getOutgoingOAuthConnections);\r\n\r\n    const dispatch = useDispatch();\r\n    const intl = useIntl();\r\n\r\n    useEffect(() => {\r\n        if (canManageOutgoingOAuthConnections) {\r\n            (dispatch(loadOutgoingOAuthConnectionsAndProfiles(props.team.id)) as unknown as Promise<void>).then(\r\n                () => setLoading(false),\r\n            );\r\n        }\r\n    }, [canManageOutgoingOAuthConnections, props.team, dispatch]);\r\n\r\n    const deleteOutgoingOAuthConnectionLocal = (connection: OutgoingOAuthConnection): void => {\r\n        if (connection && connection.id) {\r\n            dispatch(deleteOutgoingOAuthConnection(connection.id));\r\n        }\r\n    };\r\n\r\n    const outgoingOauthConnectionCompare = (a: OutgoingOAuthConnection, b: OutgoingOAuthConnection): number => {\r\n        let nameA = a.name.toString();\r\n        if (!nameA) {\r\n            nameA = intl.formatMessage({id: 'installed_integrations.unnamed_outgoing_oauth_connection', defaultMessage: 'Unnamed Outgoing OAuth Connection'});\r\n        }\r\n\r\n        let nameB = b.name.toString();\r\n        if (!nameB) {\r\n            nameB = intl.formatMessage({id: 'installed_integrations.unnamed_outgoing_oauth_connection', defaultMessage: 'Unnamed Outgoing OAuth Connection'});\r\n        }\r\n\r\n        return nameA.localeCompare(nameB);\r\n    };\r\n\r\n    const outgoingOauthConnections = (filter?: string) => {\r\n        const values = Object.values(connections);\r\n        const filtered = values.filter((connection) => matchesFilter(connection, filter));\r\n        const sorted = filtered.sort(outgoingOauthConnectionCompare);\r\n        const mapped = sorted.map((connection) => {\r\n            return (\r\n                <InstalledOutgoingOAuthConnection\r\n                    key={connection.id}\r\n                    outgoingOAuthConnection={connection}\r\n                    onDelete={deleteOutgoingOAuthConnectionLocal}\r\n                    team={props.team}\r\n                    creatorName=''\r\n                />\r\n            );\r\n        });\r\n\r\n        return mapped;\r\n    };\r\n\r\n    const integrationsEnabled = enableOutgoingOAuthConnections && canManageOutgoingOAuthConnections;\r\n    let childProps;\r\n    if (integrationsEnabled) {\r\n        childProps = {\r\n            addLink: '/' + props.team.name + '/integrations/outgoing-oauth2-connections/add',\r\n            addText: intl.formatMessage({id: 'installed_outgoing_oauth_connections.add', defaultMessage: 'Add Outgoing OAuth Connection'}),\r\n            addButtonId: 'addOutgoingOauthConnection',\r\n        };\r\n    }\r\n\r\n    return (\r\n        <BackstageList\r\n            header={\r\n                <FormattedMessage\r\n                    id='installed_outgoing_oauth_connections.header'\r\n                    defaultMessage='Outgoing OAuth Connections'\r\n                />\r\n            }\r\n            helpText={\r\n                <FormattedMessage\r\n                    id='installed_outgoing_oauth_connections.help'\r\n                    defaultMessage='Create {outgoingOauthConnections} to securely integrate bots and third-party apps with Mattermost.'\r\n                    values={{\r\n                        outgoingOauthConnections: (\r\n                            <ExternalLink\r\n                                href={DeveloperLinks.SETUP_OAUTH2}\r\n                                location='installed_outgoing_oauth_connections'\r\n                            >\r\n                                <FormattedMessage\r\n                                    id='installed_outgoing_oauth_connections.help.outgoingOauthConnections'\r\n                                    defaultMessage='Outgoing OAuth Connections'\r\n                                />\r\n                            </ExternalLink>\r\n                        ),\r\n                    }}\r\n                />\r\n            }\r\n            emptyText={\r\n                <FormattedMessage\r\n                    id='installed_outgoing_oauth_connections.empty'\r\n                    defaultMessage='No Outgoing OAuth Connections found'\r\n                />\r\n            }\r\n            emptyTextSearch={\r\n                <FormattedMessage\r\n                    id='installed_outgoing_oauth_connections.emptySearch'\r\n                    defaultMessage='No Outgoing OAuth Connections match {searchTerm}'\r\n                />\r\n            }\r\n            searchPlaceholder={intl.formatMessage({id: 'installed_outgoing_oauth_connections.search', defaultMessage: 'Search Outgoing OAuth Connections'})}\r\n            loading={loading}\r\n            {...childProps}\r\n        >\r\n            {(filter: string) => {\r\n                const children = outgoingOauthConnections(filter);\r\n                return [children, children.length > 0];\r\n            }}\r\n        </BackstageList>\r\n    );\r\n};\r\n\r\nexport default InstalledOutgoingOAuthConnections;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\nimport type {ReactNode} from 'react';\r\nimport {Route, NavLink} from 'react-router-dom';\r\n\r\ntype Props = {\r\n    name: string;\r\n    title: ReactNode;\r\n    icon: string;\r\n    parentLink?: string;\r\n    children?: ReactNode[];\r\n}\r\n\r\nconst BackstageCategory = ({name, title, icon, parentLink, children = []}: Props) => {\r\n    const link = parentLink + '/' + name;\r\n\r\n    return (\r\n        <li className='backstage-sidebar__category'>\r\n            <NavLink\r\n                to={link}\r\n                className='category-title'\r\n                activeClassName='category-title--active'\r\n            >\r\n                <i className={classNames('fa ', icon)}/>\r\n                <span className='category-title__text'>\r\n                    {title}\r\n                </span>\r\n            </NavLink>\r\n            {\r\n                children && children.length > 0 &&\r\n                    <Route\r\n                        path={link}\r\n                        render={() => (\r\n                            <ul className='sections'>\r\n                                {\r\n                                    React.Children.map(children, (child) => {\r\n                                        if (!child) {\r\n                                            return child;\r\n                                        }\r\n\r\n                                        return React.cloneElement(child as JSX.Element, {\r\n                                            parentLink: link,\r\n                                        });\r\n                                    })\r\n                                }\r\n                            </ul>\r\n                        )}\r\n                    />\r\n            }\r\n        </li>\r\n    );\r\n};\r\n\r\nexport default BackstageCategory;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport type {ReactNode} from 'react';\r\nimport {NavLink} from 'react-router-dom';\r\n\r\ntype Props = {\r\n    name: string;\r\n    title: ReactNode;\r\n    subsection?: boolean;\r\n    parentLink?: string;\r\n    children?: JSX.Element[];\r\n    id?: string;\r\n}\r\n\r\nconst BackstageSection = ({name, title, subsection = false, parentLink = '', children = [], id}: Props) => {\r\n    const link = parentLink + '/' + name;\r\n\r\n    let clonedChildren = null;\r\n    if (children.length > 0) {\r\n        clonedChildren = (\r\n            <ul className='subsections'>\r\n                {\r\n                    React.Children.map(children, (child) => {\r\n                        return React.cloneElement(child, {\r\n                            parentLink: link,\r\n                            subsection: true,\r\n                        });\r\n                    })\r\n                }\r\n            </ul>\r\n        );\r\n    }\r\n\r\n    const className = subsection ? 'subsection' : 'section';\r\n\r\n    return (\r\n        <li\r\n            className={className}\r\n            id={id}\r\n        >\r\n            <NavLink\r\n                className={`${className}-title`}\r\n                activeClassName={`${className}-title--active`}\r\n                to={link}\r\n            >\r\n                <span className={`${className}-title__text`}>\r\n                    {title}\r\n                </span>\r\n            </NavLink>\r\n            {clonedChildren}\r\n        </li>\r\n    );\r\n};\r\n\r\nexport default BackstageSection;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport type {Team} from '@mattermost/types/teams';\r\n\r\nimport {Permissions} from 'mattermost-redux/constants';\r\n\r\nimport SystemPermissionGate from 'components/permissions_gates/system_permission_gate';\r\nimport TeamPermissionGate from 'components/permissions_gates/team_permission_gate';\r\n\r\nimport BackstageCategory from './backstage_category';\r\nimport BackstageSection from './backstage_section';\r\n\r\ntype Props = {\r\n    team: Team;\r\n    enableCustomEmoji: boolean;\r\n    enableIncomingWebhooks: boolean;\r\n    enableOutgoingWebhooks: boolean;\r\n    enableCommands: boolean;\r\n    enableOAuthServiceProvider: boolean;\r\n    enableOutgoingOAuthConnections: boolean;\r\n    canCreateOrDeleteCustomEmoji: boolean;\r\n    canManageIntegrations: boolean;\r\n}\r\n\r\nexport default class BackstageSidebar extends React.PureComponent<Props> {\r\n    renderCustomEmoji() {\r\n        if (!this.props.enableCustomEmoji || !this.props.canCreateOrDeleteCustomEmoji) {\r\n            return null;\r\n        }\r\n\r\n        return (\r\n            <BackstageCategory\r\n                name='emoji'\r\n                parentLink={'/' + this.props.team.name}\r\n                icon='fa-smile-o'\r\n                title={\r\n                    <FormattedMessage\r\n                        id='backstage_sidebar.emoji'\r\n                        defaultMessage='Custom Emoji'\r\n                    />\r\n                }\r\n            />\r\n        );\r\n    }\r\n\r\n    renderIntegrations() {\r\n        if (!this.props.canManageIntegrations) {\r\n            return null;\r\n        }\r\n\r\n        let incomingWebhooks;\r\n        if (this.props.enableIncomingWebhooks) {\r\n            incomingWebhooks = (\r\n                <TeamPermissionGate\r\n                    permissions={[Permissions.MANAGE_INCOMING_WEBHOOKS, Permissions.MANAGE_OWN_INCOMING_WEBHOOKS]}\r\n                    teamId={this.props.team.id}\r\n                >\r\n                    <BackstageSection\r\n                        name='incoming_webhooks'\r\n                        parentLink={'/' + this.props.team.name + '/integrations'}\r\n                        title={(\r\n                            <FormattedMessage\r\n                                id='backstage_sidebar.integrations.incoming_webhooks'\r\n                                defaultMessage='Incoming Webhooks'\r\n                            />\r\n                        )}\r\n                        id='incomingWebhooks'\r\n                    />\r\n                </TeamPermissionGate>\r\n            );\r\n        }\r\n\r\n        let outgoingWebhooks: JSX.Element | null = null;\r\n        if (this.props.enableOutgoingWebhooks) {\r\n            outgoingWebhooks = (\r\n                <TeamPermissionGate\r\n                    permissions={[Permissions.MANAGE_OUTGOING_WEBHOOKS, Permissions.MANAGE_OWN_OUTGOING_WEBHOOKS]}\r\n                    teamId={this.props.team.id}\r\n                >\r\n                    <BackstageSection\r\n                        name='outgoing_webhooks'\r\n                        parentLink={'/' + this.props.team.name + '/integrations'}\r\n                        title={(\r\n                            <FormattedMessage\r\n                                id='backstage_sidebar.integrations.outgoing_webhooks'\r\n                                defaultMessage='Outgoing Webhooks'\r\n                            />\r\n                        )}\r\n                        id='outgoingWebhooks'\r\n                    />\r\n                </TeamPermissionGate>\r\n            );\r\n        }\r\n\r\n        let commands: JSX.Element | null = null;\r\n        if (this.props.enableCommands) {\r\n            commands = (\r\n                <TeamPermissionGate\r\n                    permissions={[Permissions.MANAGE_SLASH_COMMANDS, Permissions.MANAGE_OWN_SLASH_COMMANDS]}\r\n                    teamId={this.props.team.id}\r\n                >\r\n                    <BackstageSection\r\n                        name='commands'\r\n                        parentLink={'/' + this.props.team.name + '/integrations'}\r\n                        title={(\r\n                            <FormattedMessage\r\n                                id='backstage_sidebar.integrations.commands'\r\n                                defaultMessage='Slash Commands'\r\n                            />\r\n                        )}\r\n                        id='slashCommands'\r\n                    />\r\n                </TeamPermissionGate>\r\n            );\r\n        }\r\n\r\n        let oauthApps: JSX.Element | null = null;\r\n        if (this.props.enableOAuthServiceProvider) {\r\n            oauthApps = (\r\n                <SystemPermissionGate permissions={[Permissions.MANAGE_OAUTH]}>\r\n                    <BackstageSection\r\n                        name='oauth2-apps'\r\n                        parentLink={'/' + this.props.team.name + '/integrations'}\r\n                        title={\r\n                            <FormattedMessage\r\n                                id='backstage_sidebar.integrations.oauthApps'\r\n                                defaultMessage='OAuth 2.0 Applications'\r\n                            />\r\n                        }\r\n                        id='oauthApps'\r\n                    />\r\n                </SystemPermissionGate>\r\n            );\r\n        }\r\n\r\n        // Note that we allow managing bot accounts even if bot account creation is disabled: only\r\n        // a permissions check is required.\r\n        const botAccounts = (\r\n            <SystemPermissionGate permissions={['manage_bots', 'manage_others_bots']}>\r\n                <BackstageSection\r\n                    name='bots'\r\n                    parentLink={'/' + this.props.team.name + '/integrations'}\r\n                    title={\r\n                        <FormattedMessage\r\n                            id='backstage_sidebar.bots'\r\n                            defaultMessage='Bot Accounts'\r\n                        />\r\n                    }\r\n                    id='botAccounts'\r\n                />\r\n            </SystemPermissionGate>\r\n        );\r\n\r\n        let outgoingOAuthConnections: JSX.Element | null = null;\r\n        if (this.props.enableOutgoingOAuthConnections) {\r\n            outgoingOAuthConnections = (\r\n                <TeamPermissionGate\r\n                    permissions={[Permissions.MANAGE_OUTGOING_OAUTH_CONNECTIONS]}\r\n                    teamId={this.props.team.id}\r\n                >\r\n                    <BackstageSection\r\n                        name='outgoing-oauth2-connections'\r\n                        parentLink={'/' + this.props.team.name + '/integrations'}\r\n                        title={\r\n                            <FormattedMessage\r\n                                id='backstage_sidebar.integrations.outgoingOauthConnections'\r\n                                defaultMessage='Outgoing OAuth 2.0 Connections'\r\n                            />\r\n                        }\r\n                        id='outgoingOauthConnections'\r\n                    />\r\n                </TeamPermissionGate>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <BackstageCategory\r\n                name='integrations'\r\n                icon='fa-link'\r\n                parentLink={'/' + this.props.team.name}\r\n                title={\r\n                    <FormattedMessage\r\n                        id='backstage_sidebar.integrations'\r\n                        defaultMessage='Integrations'\r\n                    />\r\n                }\r\n            >\r\n                {incomingWebhooks}\r\n                {outgoingWebhooks}\r\n                {commands}\r\n                {oauthApps}\r\n                {botAccounts}\r\n                {outgoingOAuthConnections}\r\n            </BackstageCategory>\r\n        );\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className='backstage-sidebar'>\r\n                <ul>\r\n                    {this.renderCustomEmoji()}\r\n                    {this.renderIntegrations()}\r\n                </ul>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {useRef} from 'react';\r\nimport type {ComponentType} from 'react';\r\nimport {Route, Switch} from 'react-router-dom';\r\nimport type {match} from 'react-router-dom';\r\nimport {createGlobalStyle} from 'styled-components';\r\n\r\nimport type {Team} from '@mattermost/types/teams';\r\nimport type {UserProfile} from '@mattermost/types/users';\r\n\r\nimport Emoji from 'components/emoji';\r\nimport AddEmoji from 'components/emoji/add_emoji';\r\nimport Integrations from 'components/integrations';\r\nimport AddIncomingWehook from 'components/integrations/add_incoming_webhook';\r\nimport AddOauthApp from 'components/integrations/add_oauth_app';\r\nimport AddOutgoingWebhook from 'components/integrations/add_outgoing_webhook';\r\nimport Bots from 'components/integrations/bots';\r\nimport AddBot from 'components/integrations/bots/add_bot';\r\nimport CommandsContainer from 'components/integrations/commands_container';\r\nimport ConfirmIntegration from 'components/integrations/confirm_integration';\r\nimport EditIncomingWebhook from 'components/integrations/edit_incoming_webhook';\r\nimport EditOauthApp from 'components/integrations/edit_oauth_app';\r\nimport EditOutgoingWebhook from 'components/integrations/edit_outgoing_webhook';\r\nimport InstalledIncomingWebhooks from 'components/integrations/installed_incoming_webhooks';\r\nimport InstalledOauthApps from 'components/integrations/installed_oauth_apps';\r\nimport InstalledOutgoingWebhooks from 'components/integrations/installed_outgoing_webhooks';\r\nimport AddOutgoingOAuthConnection from 'components/integrations/outgoing_oauth_connections/add_outgoing_oauth_connection';\r\nimport EditOutgoingOAuthConnection from 'components/integrations/outgoing_oauth_connections/edit_outgoing_oauth_connection';\r\nimport InstalledOutgoingOAuthConnections from 'components/integrations/outgoing_oauth_connections/installed_outgoing_oauth_connections';\r\n\r\nimport Pluggable from 'plugins/pluggable';\r\n\r\nimport BackstageNavbar from './components/backstage_navbar';\r\nimport BackstageSidebar from './components/backstage_sidebar';\r\n\r\ntype ExtraProps = Pick<Props, 'user' | 'team'> & {scrollToTop: () => void}\r\n\r\ntype BackstageRouteProps = {\r\n    component: ComponentType<any>;\r\n    extraProps: ExtraProps;\r\n    path: string;\r\n    exact?: boolean;\r\n}\r\n\r\nconst BackstageRoute = ({component: Component, extraProps, ...rest}: BackstageRouteProps) => (\r\n    <Route\r\n        {...rest}\r\n        render={(props) => (\r\n            <Component\r\n                {...extraProps}\r\n                {...props}\r\n            />\r\n        )}\r\n    />\r\n);\r\n\r\ntype Props = {\r\n\r\n    /**\r\n     * Current user.\r\n     */\r\n    user: UserProfile;\r\n\r\n    /**\r\n     * Current team.\r\n     */\r\n    team?: Team;\r\n\r\n    /**\r\n     * Object from react-router\r\n     */\r\n    match: match<{url: string}>;\r\n\r\n    siteName?: string;\r\n    enableCustomEmoji: boolean;\r\n    enableIncomingWebhooks: boolean;\r\n    enableOutgoingWebhooks: boolean;\r\n    enableCommands: boolean;\r\n    enableOAuthServiceProvider: boolean;\r\n    enableOutgoingOAuthConnections: boolean;\r\n    canCreateOrDeleteCustomEmoji: boolean;\r\n    canManageIntegrations: boolean;\r\n}\r\n\r\nconst BackstageController = (props: Props) => {\r\n    const listRef = useRef<HTMLDivElement>(null);\r\n\r\n    const scrollToTop = () => {\r\n        if (listRef.current) {\r\n            listRef.current.scrollTop = 0;\r\n        }\r\n    };\r\n\r\n    if (!props.team || !props.user) {\r\n        return null;\r\n    }\r\n    const extraProps = {\r\n        team: props.team,\r\n        user: props.user,\r\n        scrollToTop,\r\n    };\r\n    return (\r\n        <>\r\n            <BackstageNavbar\r\n                team={props.team}\r\n                siteName={props.siteName}\r\n            />\r\n            <div\r\n                className='backstage-body'\r\n                ref={listRef}\r\n            >\r\n                <Pluggable pluggableName='Root'/>\r\n                <BackstageSidebar\r\n                    team={props.team}\r\n                    enableCustomEmoji={props.enableCustomEmoji}\r\n                    enableIncomingWebhooks={props.enableIncomingWebhooks}\r\n                    enableOutgoingWebhooks={props.enableOutgoingWebhooks}\r\n                    enableCommands={props.enableCommands}\r\n                    enableOAuthServiceProvider={props.enableOAuthServiceProvider}\r\n                    enableOutgoingOAuthConnections={props.enableOutgoingOAuthConnections}\r\n                    canCreateOrDeleteCustomEmoji={props.canCreateOrDeleteCustomEmoji}\r\n                    canManageIntegrations={props.canManageIntegrations}\r\n                />\r\n                <Switch>\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        exact={true}\r\n                        path={'/:team/integrations'}\r\n                        component={Integrations}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        exact={true}\r\n                        path={`${props.match.url}/incoming_webhooks`}\r\n                        component={InstalledIncomingWebhooks}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        path={`${props.match.url}/incoming_webhooks/add`}\r\n                        component={AddIncomingWehook}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        path={`${props.match.url}/incoming_webhooks/edit`}\r\n                        component={EditIncomingWebhook}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        exact={true}\r\n                        path={`${props.match.url}/outgoing_webhooks`}\r\n                        component={InstalledOutgoingWebhooks}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        path={`${props.match.url}/outgoing_webhooks/add`}\r\n                        component={AddOutgoingWebhook}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        path={`${props.match.url}/outgoing_webhooks/edit`}\r\n                        component={EditOutgoingWebhook}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        path={`${props.match.url}/commands`}\r\n                        component={CommandsContainer}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        exact={true}\r\n                        path={`${props.match.url}/oauth2-apps`}\r\n                        component={InstalledOauthApps}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        path={`${props.match.url}/oauth2-apps/add`}\r\n                        component={AddOauthApp}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        path={`${props.match.url}/oauth2-apps/edit`}\r\n                        component={EditOauthApp}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        exact={true}\r\n                        path={`${props.match.url}/outgoing-oauth2-connections`}\r\n                        component={InstalledOutgoingOAuthConnections}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        exact={true}\r\n                        path={`${props.match.url}/outgoing-oauth2-connections/add`}\r\n                        component={AddOutgoingOAuthConnection}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        exact={true}\r\n                        path={`${props.match.url}/outgoing-oauth2-connections/edit`}\r\n                        component={EditOutgoingOAuthConnection}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        path={`${props.match.url}/confirm`}\r\n                        component={ConfirmIntegration}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        exact={true}\r\n                        path={'/:team/emoji'}\r\n                        component={Emoji}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        path={`${props.match.url}/add`}\r\n                        component={AddEmoji}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        path={`${props.match.url}/bots/add`}\r\n                        component={AddBot}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        path={`${props.match.url}/bots/edit`}\r\n                        component={AddBot}\r\n                    />\r\n                    <BackstageRoute\r\n                        extraProps={extraProps}\r\n                        path={`${props.match.url}/bots`}\r\n                        component={Bots}\r\n                    />\r\n                </Switch>\r\n            </div>\r\n            <BackstageGlobalStyle/>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default BackstageController;\r\n\r\nconst BackstageGlobalStyle = createGlobalStyle`\r\n    #root {\r\n        > #global-header,\r\n        > .team-sidebar,\r\n        > .main-wrapper .sidebar--right,\r\n        > .app-bar {\r\n            display: none;\r\n        }\r\n    }\r\n`;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\nimport {withRouter} from 'react-router-dom';\r\n\r\nimport {Permissions} from 'mattermost-redux/constants';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {haveITeamPermission, haveISystemPermission} from 'mattermost-redux/selectors/entities/roles';\r\nimport {getMyTeams, getCurrentTeam} from 'mattermost-redux/selectors/entities/teams';\r\nimport {getCurrentUser} from 'mattermost-redux/selectors/entities/users';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport BackstageController from './backstage_controller';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const user = getCurrentUser(state);\r\n    const team = getCurrentTeam(state);\r\n\r\n    const config = getConfig(state);\r\n\r\n    const siteName = config.SiteName;\r\n    const enableCustomEmoji = config.EnableCustomEmoji === 'true';\r\n    const enableIncomingWebhooks = config.EnableIncomingWebhooks === 'true';\r\n    const enableOutgoingWebhooks = config.EnableOutgoingWebhooks === 'true';\r\n    const enableCommands = config.EnableCommands === 'true';\r\n    const enableOAuthServiceProvider = config.EnableOAuthServiceProvider === 'true';\r\n    const enableOutgoingOAuthConnections = config.EnableOutgoingOAuthConnections === 'true';\r\n\r\n    let canCreateOrDeleteCustomEmoji = (haveISystemPermission(state, {permission: Permissions.CREATE_EMOJIS}) || haveISystemPermission(state, {permission: Permissions.DELETE_EMOJIS}));\r\n    if (!canCreateOrDeleteCustomEmoji) {\r\n        for (const t of getMyTeams(state)) {\r\n            if (haveITeamPermission(state, t.id, Permissions.CREATE_EMOJIS) || haveITeamPermission(state, t.id, Permissions.DELETE_EMOJIS)) {\r\n                canCreateOrDeleteCustomEmoji = true;\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    const canManageTeamIntegrations = (\r\n        haveITeamPermission(state, team?.id, Permissions.MANAGE_SLASH_COMMANDS) ||\r\n        haveITeamPermission(state, team?.id, Permissions.MANAGE_OWN_SLASH_COMMANDS) ||\r\n        haveITeamPermission(state, team?.id, Permissions.MANAGE_INCOMING_WEBHOOKS) ||\r\n        haveITeamPermission(state, team?.id, Permissions.MANAGE_OWN_INCOMING_WEBHOOKS) ||\r\n        haveITeamPermission(state, team?.id, Permissions.MANAGE_OUTGOING_WEBHOOKS) ||\r\n        haveITeamPermission(state, team?.id, Permissions.MANAGE_OWN_OUTGOING_WEBHOOKS) ||\r\n        haveISystemPermission(state, {permission: Permissions.MANAGE_OAUTH})\r\n    );\r\n    const canManageSystemBots = (haveISystemPermission(state, {permission: Permissions.MANAGE_BOTS}) || haveISystemPermission(state, {permission: Permissions.MANAGE_OTHERS_BOTS}));\r\n    const canManageIntegrations = canManageTeamIntegrations || canManageSystemBots;\r\n\r\n    return {\r\n        user,\r\n        team,\r\n        siteName,\r\n        enableCustomEmoji,\r\n        enableIncomingWebhooks,\r\n        enableOutgoingWebhooks,\r\n        enableCommands,\r\n        enableOAuthServiceProvider,\r\n        enableOutgoingOAuthConnections,\r\n        canCreateOrDeleteCustomEmoji,\r\n        canManageIntegrations,\r\n    };\r\n}\r\n\r\nexport default withRouter(connect(mapStateToProps)(BackstageController));\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\n\r\nexport const TYPE_MODAL = 'modal';\r\nexport const TYPE_BACKSTAGE = 'backstage';\r\n\r\n// accepts either a single error or an array of errors\r\ntype Props = {\r\n    type?: React.ReactNode;\r\n    error?: React.ReactNode;\r\n    textClassName?: string;\r\n    iconClassName?: string;\r\n    margin?: boolean;\r\n    errors?: React.ReactNode[];\r\n};\r\n\r\nconst EMPTY_ERROR_LIST: React.ReactNode[] = [];\r\n\r\nconst FormError: React.FC<Props> = ({\r\n    error = null,\r\n    errors = EMPTY_ERROR_LIST,\r\n    iconClassName,\r\n    margin,\r\n    textClassName,\r\n    type,\r\n}) => {\r\n    if (!error && errors.length === 0) {\r\n        return null;\r\n    }\r\n\r\n    // look for the first truthy error to display\r\n    let message = error;\r\n\r\n    if (!message) {\r\n        for (const err of errors) {\r\n            if (err) {\r\n                message = err;\r\n            }\r\n        }\r\n    }\r\n\r\n    if (!message) {\r\n        return null;\r\n    }\r\n\r\n    if (type === TYPE_MODAL) {\r\n        return (\r\n            <div className='form-group'>\r\n                <label className='col-sm-12 has-error'>{message}</label>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (type === TYPE_BACKSTAGE) {\r\n        return (\r\n            <div className='pull-left has-error'>\r\n                <label className='control-label'>{message}</label>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (margin) {\r\n        return (\r\n            <div className='form-group has-error'>\r\n                <label className='control-label'>{message}</label>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className={`col-sm-12 ${textClassName || 'has-error'}`}>\r\n            <label className='control-label'>\r\n                <i\r\n                    className={`fa ${iconClassName || 'fa-exclamation-circle'}`}\r\n                />{' '}\r\n                {message}\r\n            </label>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default React.memo(FormError);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {useIntl, type MessageDescriptor} from 'react-intl';\r\n\r\ntype Props = {\r\n    placeholder: MessageDescriptor;\r\n} & Omit<React.InputHTMLAttributes<HTMLInputElement>, 'placeholder'>;\r\n\r\nconst LocalizedPlaceholderInput = React.forwardRef<HTMLInputElement, Props>(({placeholder, ...otherProps}, ref) => {\r\n    const intl = useIntl();\r\n\r\n    return (\r\n        <input\r\n            ref={ref}\r\n            placeholder={intl.formatMessage(placeholder)}\r\n            {...otherProps}\r\n        />\r\n    );\r\n});\r\n\r\nLocalizedPlaceholderInput.displayName = 'LocalizedPlaceholderInput';\r\n\r\nexport default LocalizedPlaceholderInput;\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\ntype Props = {\r\n    additionalClassName?: string;\r\n}\r\n\r\nconst NextIcon = ({additionalClassName}: Props) => {\r\n    const {formatMessage} = useIntl();\r\n\r\n    return (\r\n        <i\r\n            className={classNames('icon icon-chevron-right', additionalClassName)}\r\n            title={formatMessage({\r\n                id: 'generic_icons.next',\r\n                defaultMessage: 'Next Icon',\r\n            })}\r\n        />\r\n    );\r\n};\r\n\r\nexport default React.memo(NextIcon);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\ntype Props = {\r\n    additionalClassName?: string;\r\n}\r\n\r\nconst PreviousIcon = ({additionalClassName}: Props) => {\r\n    const {formatMessage} = useIntl();\r\n\r\n    return (\r\n        <i\r\n            className={classNames('icon icon-chevron-left', additionalClassName)}\r\n            title={formatMessage({id: 'generic_icons.previous', defaultMessage: 'Previous Icon'})}\r\n        />\r\n    );\r\n};\r\n\r\nexport default React.memo(PreviousIcon);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\nexport default function SearchIcon() {\r\n    const {formatMessage} = useIntl();\r\n\r\n    return (\r\n        <i\r\n            className='fa fa-search'\r\n            title={formatMessage({id: 'generic_icons.search', defaultMessage: 'Search Icon'})}\r\n        />\r\n    );\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport classNames from 'classnames';\r\nimport React from 'react';\r\nimport {useIntl} from 'react-intl';\r\n\r\ntype Props = {\r\n    additionalClassName?: string;\r\n}\r\n\r\nconst WarningIcon = ({additionalClassName}: Props) => {\r\n    const {formatMessage} = useIntl();\r\n    return (\r\n        <i\r\n            className={classNames('fa fa-warning', additionalClassName)}\r\n            title={formatMessage({id: 'generic_icons.warning', defaultMessage: 'Warning Icon'})}\r\n        />\r\n    );\r\n};\r\n\r\nexport default React.memo(WarningIcon);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {Bot} from '@mattermost/types/bots';\r\nimport type {GlobalState} from '@mattermost/types/store';\r\n\r\nimport {createSelector} from 'mattermost-redux/selectors/create_selector';\r\nimport {getUsers} from 'mattermost-redux/selectors/entities/common';\r\n\r\nexport const ExternalBotAccountNames: string[] = ['mattermost-advisor'];\r\n\r\nexport function getBotAccounts(state: GlobalState) {\r\n    return state.entities.bots.accounts;\r\n}\r\n\r\nexport const getExternalBotAccounts: (state: GlobalState) => Record<string, Bot> = createSelector(\r\n    'getExternalBotAccounts',\r\n    getBotAccounts,\r\n    getUsers,\r\n    (botAccounts, userProfiles) => {\r\n        const nextState: Record<string, Bot> = {};\r\n        Object.values(botAccounts).forEach((botAccount) => {\r\n            const botUser = userProfiles[botAccount.user_id];\r\n            if (botUser && !ExternalBotAccountNames.includes(botUser.username)) {\r\n                nextState[botAccount.user_id] = botAccount;\r\n            }\r\n        });\r\n\r\n        return nextState;\r\n    },\r\n);\r\n"],"names":["BackIcon","formatMessage","useIntl","React","className","title","id","defaultMessage","BackstageNavbar","_ref","team","siteName","teamExists","delete_at","BlockableLink","to","concat","name","FormattedMessage","values","propTypes","_pt","DeleteIntegrationLink","props","confirmButtonText","linkText","modalMessage","modalTitle","onDelete","openModal","onClick","useCallback","modalId","dialogProps","confirmButtonClass","modalClass","message","subtitleText","WarningIcon","additionalClassName","onConfirm","dialogType","ConfirmModalRedux","isRequired","mapDispatchToProps","connect","DeleteEmojiButton","DELETE_PERMISSION","Permissions","DELETE_EMOJIS","DELETE_OTHER_PERMISSION","DELETE_OTHERS_EMOJIS","EmojiListItem","actions","deleteCustomEmoji","emoji","creatorUsername","currentUserId","creatorDisplayName","emoticonStyle","useMemo","backgroundImage","Client4","getCustomEmojiImageUrl","handleDelete","displayName","deleteButton","creator_id","AnyTeamPermissionGate","permissions","style","emojiId","state","ownProps","entities","emojis","customEmoji","creator","getUser","getDisplayNameByUser","username","getCurrentUserId","currentTeam","getCurrentTeam","dispatch","bindActionCreators","EmojiList","constructor","super","_defineProperty","e","preventDefault","next","this","page","setState","nextLoading","getCustomEmojis","Emoji","SORT_BY_NAME","then","data","length","missingPages","scrollToTop","target","term","value","clearTimeout","searchTimeout","setTimeout","async","trim","searchEmojis","loading","searchCustomEmojis","map","em","index","indexOf","newSearchEmojis","splice","componentDidMount","EMOJI_PER_PAGE","_ref2","render","nextButton","previousButton","push","key","colSpan","LoadingScreen","emojiIds","forEach","deleteFromSearch","pageStart","pageEnd","slice","buttonContents","NextIcon","SaveButton","btnClass","extraClasses","nextPage","saving","disabled","savingMessage","previousPage","PreviousIcon","SearchIcon","LocalizedPlaceholderInput","type","placeholder","defineMessage","onChange","onSearchChange","search","flexGrow","flexShrink","getCustomEmojiIdsSortedByName","CREATE_EMOJIS_PERMISSIONS","CREATE_EMOJIS","ROLES","EmojiPage","teamDisplayName","teamName","currentTheme","intl","useEffect","updateTitle","loadRolesIfNeeded","Utils","document","Link","display_name","general","config","SiteName","getTheme","children","childrenElements","child","AddEmoji","handleSubmit","emojiMap","user","image","error","toLowerCase","startsWith","endsWith","substring","test","hasSystemEmoji","has","size","response","createCustomEmoji","getHistory","responseError","genericError","files","imageUrl","reader","FileReader","onload","result","readAsDataURL","filename","preview","htmlFor","BackstageHeader","onSubmit","handleFormSubmit","maxLength","updateName","accept","Constants","ACCEPT_EMOJI_IMAGE","multiple","updateImage","FormError","SpinnerButton","spinning","spinningText","handleSaveButtonClick","getEmojiMap","IntegrationOption","description","link","alt","src","Integrations","arguments","currentSiteName","options","enableIncomingWebhooks","TeamPermissionGate","teamId","MANAGE_INCOMING_WEBHOOKS","MANAGE_OWN_INCOMING_WEBHOOKS","IncomingWebhookIcon","enableOutgoingWebhooks","MANAGE_OUTGOING_WEBHOOKS","MANAGE_OWN_OUTGOING_WEBHOOKS","OutgoingWebhookIcon","enableCommands","MANAGE_SLASH_COMMANDS","MANAGE_OWN_SLASH_COMMANDS","SlashCommandIcon","enableOAuthServiceProvider","SystemPermissionGate","MANAGE_OAUTH","OAuthIcon","enableOutgoingOAuthConnections","MANAGE_OUTGOING_OAUTH_CONNECTIONS","OutgoingOAuthConnectionsIcon","BotAccountsIcon","appDirectory","ExternalLink","href","location","getConfig","EnableIncomingWebhooks","EnableOutgoingWebhooks","EnableCommands","EnableOAuthServiceProvider","EnableOutgoingOAuthConnections","ChannelSelect","channels","selectOpen","selectPrivate","selectDm","channel","channelName","OPEN_CHANNEL","PRIVATE_CHANNEL","DM_CHANNEL","memo","getMyChannelsSorted","createSelector","getMyChannels","getCurrentUserLocale","locale","filter","sort","sortChannelsByTypeAndDisplayName","bind","AbstractIncomingWebhook","PureComponent","hook","channelId","channel_id","channelLocked","channel_locked","iconURL","icon_url","serverError","clientError","_this$props$initialHo","_this$props$initialHo2","_this$props$initialHo3","_this$props$initialHo4","_this$props$initialHo5","_this$props$initialHo6","initialHook","create_at","update_at","team_id","user_id","action","checked","getStateFromHook","headerToRender","header","footerToRender","footer","updateDisplayName","updateDescription","updateChannelId","canBypassChannelLock","updateChannelLocked","enablePostUsernameOverride","updateUsername","enablePostIconOverride","updateIconURL","errors","messages","defineMessages","AddIncomingWebhook","setServerError","useState","addIncomingHook","createIncomingHook","EnablePostUsernameOverride","EnablePostIconOverride","haveICurrentTeamPermission","BYPASS_INCOMING_WEBHOOK_CHANNEL_LOCK","r","t","i","Symbol","toPrimitive","call","TypeError","String","_toPrimitive","_toPropertyKey","Object","defineProperty","enumerable","configurable","writable","AbstractOAuthApp","app","_app$is_public","isPublicClient","client_secret","homepage","callbackUrls","callback_urls","join","is_trusted","is_public","has_icon","Boolean","_this$icon_url$curren","current","_this$props$initialAp","isDynamicallyRegistered","initialApp","is_dynamically_registered","callbackUrl","split","Image","imageLoaded","getStateFromApp","_this$props$initialAp2","renderExtra","icon","trusted","MANAGE_SYSTEM","updateTrusted","isEditing","publicClient","updatePublic","updateHomepage","ref","updateIconUrl","rows","updateCallbackUrls","AddOAuthApp","history","useHistory","addOAuthApp","AbstractOutgoingWebhook","triggerWords","trigger_words","contentType","content_type","triggerWhen","trigger_when","triggerWord","token","parseInt","contentTypeOption1","contentTypeOption2","updateContentType","updateTriggerWords","updateTriggerWhen","localizeMessage","DocLinks","TRUSTED_CONNECTION","AddOutgoingWebhook","createOutgoingHook","createBot","bot","bindClientFunc","clientFunc","onSuccess","BotTypes","RECEIVED_BOT_ACCOUNT","params","patchBot","botUserId","botPatch","loadBots","undefined","perPage","getBotsIncludeDeleted","RECEIVED_BOT_ACCOUNTS","disableBot","enableBot","remainingProps","setFilter","filterLowered","searchPlaceholder","childCount","hasChildren","emptyTextSearch","_objectSpread","searchTerm","emptyText","addLink","addText","addButtonId","hasFilter","startCount","endCount","total","isFirstPage","isLastPage","getPaging","pageSize","childrenToDisplay","previousPageFn","nextPageFn","helpText","matchesFilter","owner","ownerUsername","Bot","enableUserAccessToken","disableUserAccessToken","confirmingId","revokeUserAccessToken","closeConfirm","creatingTokenState","assign","createUserAccessToken","fromApp","tokenList","accessTokens","activeLink","disabledText","disableClass","is_active","confirmRevokeToken","openCreateToken","handleCreateToken","autoFocus","handleUpdateDescription","closeCreateToken","imageURL","last_picture_update","Markdown","ConfirmModal","show","revokeTokenConfirmed","onCancel","Bots","owners","users","appsBotIDs","includes","bots","a","b","localeCompare","match","enabledBots","botToJSX","disabledBots","EnabledSection","DisabledSection","hasDisabled","START_PAGE_NUM","PAGE_SIZE","promises","owner_id","getUserAccessTokensForUser","Promise","all","appsEnabled","fetchAppsBotIDs","botsToDisplay","BackstageList","createBots","chunks","botAccounts","EnableBotAccountCreation","getExternalBotAccounts","botValues","reduce","UserSelectors","admin","userAccessTokensByUser","getAppsBotIDs","roleOptionSystemAdmin","roleOptionMember","AddBot","role","postAll","postChannels","pictureFile","previewBlob","URL","createObjectURL","e2","_e2$target","orientation","FileUtils","orientationStyles","readAsArrayBuffer","BotDefaultIcon","roles","General","SYSTEM_USER_ROLE","SYSTEM_ADMIN_ROLE","SYSTEM_POST_ALL_ROLE","SYSTEM_POST_ALL_PUBLIC_ROLE","rolesResult","updateUserRoles","adding","isFile","AcceptedProfileImageTypes","maxFileSize","uploadProfileImage","setDefaultProfileImage","updateRoles","usernameError","errObj","ValidationErrors","INVALID_LAST_CHARACTER","tokenResult","UserUtils","transform","transformOrigin","file","subtitle","buttonText","buttonActiveText","imageStyles","removeImageIcon","WithTooltip","setDefault","ACCEPT_STATIC_IMAGE","updatePicture","editingUserHasManageSystem","updateRole","msg","DeveloperLinks","PERSONAL_ACCESS_TOKENS","updatePostAll","updatePostChannels","botId","URLSearchParams","get","getBotAccounts","MaxFileSize","haveISystemPermission","permission","OAuthConnectionAudienceInput","mounted","useRef","matchedConnection","setMatchingOAuthConnection","loadingAudienceMatch","setLoadingAudienceMatch","oauthConnections","useSelector","getOutgoingOAuthConnections","oauthConnectionsEnabled","getCurrentTeamId","useDispatch","matchConnectionsOnInput","res","fetchOutgoingOAuthConnectionsForAudience","inputValue","debouncedMatchConnections","debounce","fetchOutgoingOAuthConnections","connections","input","autoComplete","oauthMessage","LoadingSpinner","OauthIcon","connectionName","InformationOutlineIcon","AbstractCommand","command","_command$display_name","_command$description","_command$trigger","_command$url","_command$method","_command$username","_command$icon_url","_command$auto_complet","_command$auto_complet2","_command$auto_complet3","trigger","url","method","iconUrl","autocomplete","auto_complete","autocompleteHint","auto_complete_hint","autocompleteDescription","auto_complete_desc","substr","_this$state$autocompl","_this$state$autocompl2","MIN_TRIGGER_LENGTH","MAX_TRIGGER_LENGTH","min","max","methodValue","getStateFromCommand","initialCommand","updateAutocompleteHint","updateAutocompleteDescription","getBackstageHeader","updateTrigger","CUSTOM_SLASH_COMMANDS","updateUrl","text","updateMethod","updateAutocomplete","getBackstageFooter","AddCommand","headerMessage","footerMessage","loadingMessage","addCommand","CopyText","label","copyText","copyToClipboard","queryCommandSupported","ConfirmIntegration","commands","oauthApps","incomingHooks","outgoingHooks","outgoingOAuthConnections","window","addEventListener","handleKeyPress","removeEventListener","headerText","tokenText","incomingHook","outgoingHook","oauthApp","outgoingOAuthConnection","COMMAND","commandToken","SETUP_CUSTOM_SLASH_COMMANDS","copyToken","INCOMING_WEBHOOK","incomingHookToken","getSiteURL","SETUP_INCOMING_WEBHOOKS","OUTGOING_WEBHOOK","outgoingHookToken","SETUP_OUTGOING_WEBHOOKS","OAUTH_APP","oauthAppToken","oauthAppSecret","SETUP_OAUTH2","copyClientId","secret","copyClientSecret","OUTGOING_OAUTH_CONNECTIONS","clientId","client_id","clientSecret","credentials_username","password","credentials_password","grant_type","copyUsername","oauth_token_url","audiences","BOT","replace","ErrorPageTypes","PAGE_NOT_FOUND","botToken","botname","getCommands","getOAuthApps","getIncomingHooks","getOutgoingHooks","EditCommand","_this$state$originalC","_this$state$originalC2","_this$state$originalC3","_this$state$originalC4","newCommand","originalCommand","handleConfirmModal","submitCommand","showConfirmModal","editCommand","confirmButton","confirmTitle","confirmMessage","confirmModalDismissed","getCustomTeamCommands","commandId","InstalledCommand","onRegenToken","canChange","handleRegenToken","createAt","InstalledCommands","regenCommandToken","deleteCommand","commandCompare","nameA","nameB","canManageOthersSlashCommands","buildYourOwn","haveITeamPermission","MANAGE_OTHERS_SLASH_COMMANDS","CommandRoute","component","Component","extraProps","rest","_objectWithoutProperties","_excluded","Route","path","CommandsContainer","_this$props$team","loadCommandsAndProfilesForTeam","Switch","exact","Redirect","getUsers","EditIncomingWebhook","_this$props$hook","newHook","submitHook","updateIncomingHook","getIncomingHook","hookId","editIncomingHook","integrations","HEADER","FOOTER","LOADING","EditOAuthApp","newApp","every","v","submitOAuthApp","editOAuthApp","err","getOAuthApp","oauthAppId","EditOutgoingWebhook","triggerWordsSame","callbackUrlsSame","updateOutgoingHook","getOutgoingHook","editOutgoingHook","incomingWebhook","InstalledIncomingWebhook","incomingWebhookId","InstalledIncomingWebhooks","removeIncomingHook","loadIncomingHooksAndProfilesForTeam","pageToLoad","loadPage","displayNameA","channelA","displayNameB","incomingWebhookCompare","canManageOthersWebhooks","deleteIncomingWebhook","incomingHooksTotalCount","incomingWebhooks","getFilteredIncomingHooks","getIncomingHooksTotalCount","MANAGE_OTHERS_INCOMING_WEBHOOKS","getAllChannels","FAKE_SECRET","InstalledOAuthApp","onRegenerateSecret","handleShowClientSecret","creatorName","urls","isTrusted","showHide","regen","handleHideClientSecret","handleRegenerate","actionParts","part","idx","appInfo","InstalledOAuthApps","deleteOAuthApp","oauthAppCompare","regenOAuthAppSecret","appsOAuthAppIDs","loadOAuthAppsAndProfiles","toString","canManageOauth","oauthApplications","getAppsOAuthAppIDs","outgoingWebhook","InstalledOutgoingWebhook","makeDisplayName","InstalledOutgoingWebhooks","regenOutgoingHookToken","removeOutgoingHook","channelB","outgoingWebhooks","outgoingWebhookCompare","regenOutgoingWebhookToken","loadOutgoingHooksAndProfilesForTeam","MANAGE_OTHERS_OUTGOING_WEBHOOKS","keys","Actions","ownKeys","getOwnPropertySymbols","o","getOwnPropertyDescriptor","apply","getOwnPropertyDescriptors","defineProperties","ValidationStatus","initialState","AbstractOutgoingOAuthConnection","formState","setFormState","connection","audienceUrls","oauthTokenUrl","grantType","newState","oldState","useOutgoingOAuthForm","initialConnection","storedError","setError","validationError","setValidationError","isSubmitting","setIsSubmitting","validationStatus","setValidationStatus","INITIAL","isEditingSecret","setIsEditingSecret","isValidationModalOpen","setIsValidationModalOpen","isNewConnection","parseForm","requireAudienceUrl","audienceUrl","hideSkipValidateModal","VALIDATED","submitAction","setUnvalidated","DIRTY","clientSecretSection","repeat","startEditingClientSecret","ValidateButton","_props$initialConnect","VALIDATING","validateOutgoingOAuthConnection","ERROR","status","onExited","AlertOutlineIcon","CheckCircleOutlineIcon","addOutgoingOAuthConnection","connectionId","existingConnection","newConnection","setNewConnection","setShowConfirmModal","getOutgoingOAuthConnection","createOutgoingOAuthConnection","editOutgoingOAuthConnection","InstalledOutgoingOAuthConnection","connectionInfo","setLoading","canManageOutgoingOAuthConnections","loadOutgoingOAuthConnectionsAndProfiles","deleteOutgoingOAuthConnectionLocal","deleteOutgoingOAuthConnection","outgoingOauthConnectionCompare","childProps","outgoingOauthConnections","parentLink","NavLink","activeClassName","classNames","subsection","clonedChildren","BackstageSidebar","renderCustomEmoji","enableCustomEmoji","canCreateOrDeleteCustomEmoji","BackstageCategory","renderIntegrations","canManageIntegrations","BackstageSection","BackstageRoute","BackstageGlobalStyle","createGlobalStyle","withRouter","getCurrentUser","EnableCustomEmoji","getMyTeams","canManageTeamIntegrations","canManageSystemBots","MANAGE_BOTS","MANAGE_OTHERS_BOTS","listRef","scrollTop","Pluggable","pluggableName","AddIncomingWehook","InstalledOauthApps","AddOauthApp","EditOauthApp","InstalledOutgoingOAuthConnections","AddOutgoingOAuthConnection","EditOutgoingOAuthConnection","TYPE_BACKSTAGE","EMPTY_ERROR_LIST","iconClassName","margin","textClassName","otherProps","ExternalBotAccountNames","accounts","userProfiles","nextState","botAccount","botUser"],"sourceRoot":""}