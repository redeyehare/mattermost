{"version":3,"file":"7884.20b483d1a1a433e91130.js","mappings":"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","sources":["webpack://mattermost-webapp/./src/selectors/views/gif_picker.ts","webpack://mattermost-webapp/./src/components/gif_picker/gif_picker_items.tsx","webpack://mattermost-webapp/./src/components/gif_picker/gif_picker_search.tsx","webpack://mattermost-webapp/./src/components/gif_picker/gif_picker.tsx"],"sourcesContent":["// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {GiphyFetch} from '@giphy/js-fetch-api';\r\n\r\nimport {createSelector} from 'mattermost-redux/selectors/create_selector';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\n\r\nimport {getCurrentLocale} from 'selectors/i18n';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nexport const getGiphyFetchInstance: (state: GlobalState) => GiphyFetch | null =\r\n    createSelector(\r\n        'getGiphyFetchInstance',\r\n        (state) => getConfig(state).GiphySdkKey,\r\n        (giphySdkKey) => {\r\n            if (giphySdkKey) {\r\n                const giphyFetch = new GiphyFetch(giphySdkKey);\r\n                return giphyFetch;\r\n            }\r\n\r\n            return null;\r\n        },\r\n    );\r\n\r\n/**\r\n * Library expects the language code to be the first part of the locale string, e.g. 'en-US' -> 'en'\r\n * see https://developers.giphy.com/docs/#language-support\r\n */\r\nexport const getGiphyLanguageCode: (state: GlobalState) => string =\r\n    createSelector(\r\n        'getGiphyLanguageCode',\r\n        (state) => getCurrentLocale(state),\r\n        (currentLocale) => {\r\n            return currentLocale?.split('-')?.[0] ?? 'en';\r\n        },\r\n    );\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {GifsResult} from '@giphy/js-fetch-api';\r\nimport type {EmojiVariationsListProps} from '@giphy/react-components';\r\nimport {Grid} from '@giphy/react-components';\r\nimport React, {memo, useCallback} from 'react';\r\nimport {useSelector} from 'react-redux';\r\n\r\nimport {\r\n    getGiphyFetchInstance,\r\n    getGiphyLanguageCode,\r\n} from 'selectors/views/gif_picker';\r\n\r\nimport NoResultsIndicator from 'components/no_results_indicator';\r\nimport {NoResultsVariant} from 'components/no_results_indicator/types';\r\n\r\nconst GUTTER_BETWEEN_GIFS = 8;\r\nconst NUM_OF_GIFS_COLUMNS = 2;\r\nconst RATING_GENERAL = 'g';\r\nconst NUM_OF_RESULTS_PER_PAGE = 10;\r\nconst RESULTS_TYPE = 'gifs';\r\nconst SORT_BY = 'relevant';\r\n\r\ninterface Props {\r\n    width: number;\r\n    filter: string;\r\n    onClick: EmojiVariationsListProps['onGifClick'];\r\n}\r\n\r\nfunction GifPickerItems(props: Props) {\r\n    const giphyFetch = useSelector(getGiphyFetchInstance);\r\n    const giphyLanguageCode = useSelector(getGiphyLanguageCode);\r\n\r\n    const fetchGifs = useCallback(\r\n        async (offset: number) => {\r\n            if (!giphyFetch) {\r\n                return {} as GifsResult;\r\n            }\r\n\r\n            // We dont have to throttled the fetching as the library does it for us\r\n            if (props.filter.length > 0) {\r\n                const filteredResult = await giphyFetch.search(props.filter, {\r\n                    offset,\r\n                    lang: giphyLanguageCode,\r\n                    sort: SORT_BY,\r\n                    limit: NUM_OF_RESULTS_PER_PAGE,\r\n                    rating: RATING_GENERAL,\r\n                    type: RESULTS_TYPE,\r\n                });\r\n                return filteredResult;\r\n            }\r\n\r\n            const trendingResult = await giphyFetch.trending({\r\n                offset,\r\n                limit: NUM_OF_RESULTS_PER_PAGE,\r\n                rating: RATING_GENERAL,\r\n                type: RESULTS_TYPE,\r\n            });\r\n            return trendingResult;\r\n        },\r\n        [props.filter, giphyLanguageCode, giphyFetch],\r\n    );\r\n\r\n    return (\r\n        <div className='emoji-picker__items gif-picker__items'>\r\n            <Grid\r\n                key={props.filter.length === 0 ? 'trending' : props.filter}\r\n                columns={NUM_OF_GIFS_COLUMNS}\r\n                gutter={GUTTER_BETWEEN_GIFS}\r\n                hideAttribution={true}\r\n                width={props.width}\r\n                noResultsMessage={\r\n                    <NoResultsIndicator\r\n                        variant={NoResultsVariant.Search}\r\n                        titleValues={{channelName: `${props.filter}`}}\r\n                    />\r\n                }\r\n                fetchGifs={fetchGifs}\r\n                onGifClick={props.onClick}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default memo(GifPickerItems);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {ChangeEvent} from 'react';\r\nimport React, {memo, useCallback, useMemo} from 'react';\r\nimport {useIntl} from 'react-intl';\r\nimport {useSelector} from 'react-redux';\r\nimport tinycolor from 'tinycolor2';\r\n\r\nimport {getTheme} from 'mattermost-redux/selectors/entities/preferences';\r\n\r\nimport giphyBlackImage from 'images/gif_picker/powered-by-giphy-black.png';\r\nimport giphyWhiteImage from 'images/gif_picker/powered-by-giphy-white.png';\r\n\r\ninterface Props {\r\n    value: string;\r\n    onChange: (value: string) => void;\r\n}\r\n\r\nfunction GifPickerSearch(props: Props) {\r\n    const theme = useSelector(getTheme);\r\n\r\n    const {formatMessage} = useIntl();\r\n\r\n    const handleChange = useCallback((event: ChangeEvent<HTMLInputElement>) => {\r\n        event.preventDefault();\r\n\r\n        // remove trailing and leading colons\r\n        const value = event.target?.value?.replace(/^:|:$/g, '') ?? '';\r\n        props.onChange(value);\r\n    }, [props.onChange]);\r\n\r\n    const shouldUseWhiteLogo = useMemo(() => {\r\n        const WHITE_COLOR = '#FFFFFF';\r\n        const BLACK_COLOR = '#000000';\r\n\r\n        const mostReadableColor = tinycolor.mostReadable(theme.centerChannelBg, [WHITE_COLOR, BLACK_COLOR], {includeFallbackColors: false});\r\n\r\n        if (mostReadableColor.isLight()) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }, [theme.centerChannelBg]);\r\n\r\n    return (\r\n        <div className='emoji-picker__search-container'>\r\n            <div className='emoji-picker__text-container gif-picker__text-container'>\r\n                <span className='icon-magnify icon emoji-picker__search-icon'/>\r\n                <input\r\n                    id='emojiPickerSearch'\r\n                    className='emoji-picker__search'\r\n                    aria-label={formatMessage({id: 'gif_picker.input.label', defaultMessage: 'Search for GIFs'})}\r\n                    placeholder={formatMessage({id: 'gif_picker.input.placeholder', defaultMessage: 'Search GIPHY'})}\r\n                    type='text'\r\n                    autoFocus={true}\r\n                    autoComplete='off'\r\n                    onChange={handleChange}\r\n                    value={props.value}\r\n                />\r\n            </div>\r\n            <div className='gif-attribution'>\r\n                <img\r\n                    src={shouldUseWhiteLogo ? giphyWhiteImage : giphyBlackImage}\r\n                    alt={formatMessage({id: 'gif_picker.attribution.alt', defaultMessage: 'Powered by GIPHY'})}\r\n                />\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default memo(GifPickerSearch);\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport type {IGif} from '@giphy/js-types';\r\nimport type {SyntheticEvent} from 'react';\r\nimport React, {useCallback, useMemo} from 'react';\r\n\r\nimport GifPickerItems from './gif_picker_items';\r\nimport GifPickerSearch from './gif_picker_search';\r\n\r\nconst GIF_DEFAULT_WIDTH = 350;\r\nconst GIF_MARGIN_ENDS = 12;\r\n\r\ntype Props = {\r\n    filter: string;\r\n    onGifClick?: (gif: string) => void;\r\n    handleFilterChange: (filter: string) => void;\r\n    getRootPickerNode: () => HTMLDivElement | null;\r\n}\r\n\r\nconst GifPicker = (props: Props) => {\r\n    const handleItemClick = useCallback((gif: IGif, event: SyntheticEvent<HTMLElement, Event>) => {\r\n        if (props.onGifClick) {\r\n            event.preventDefault();\r\n\r\n            const imageWithMarkdown = `![${gif.title}](${gif.images.fixed_height.url})`;\r\n            props.onGifClick(imageWithMarkdown);\r\n        }\r\n    }, [props.onGifClick]);\r\n\r\n    const pickerWidth = useMemo(() => {\r\n        const pickerWidth = props.getRootPickerNode?.()?.getBoundingClientRect()?.width ?? GIF_DEFAULT_WIDTH;\r\n        return (pickerWidth - (2 * GIF_MARGIN_ENDS));\r\n    }, [props.getRootPickerNode]);\r\n\r\n    return (\r\n        <>\r\n            <GifPickerSearch\r\n                value={props.filter}\r\n                onChange={props.handleFilterChange}\r\n            />\r\n            <GifPickerItems\r\n                width={pickerWidth}\r\n                filter={props.filter}\r\n                onClick={handleItemClick}\r\n            />\r\n        </>\r\n    );\r\n};\r\n\r\nexport default GifPicker;\r\n"],"names":["getGiphyFetchInstance","createSelector","state","getConfig","GiphySdkKey","giphySdkKey","GiphyFetch","getGiphyLanguageCode","getCurrentLocale","currentLocale","_currentLocale$split$","_currentLocale$split","split","RESULTS_TYPE","GifPickerItems","props","giphyFetch","useSelector","giphyLanguageCode","fetchGifs","useCallback","async","filter","length","search","offset","lang","sort","limit","rating","type","trending","React","className","Grid","key","columns","gutter","hideAttribution","width","noResultsMessage","NoResultsIndicator","variant","NoResultsVariant","Search","titleValues","channelName","concat","onGifClick","onClick","propTypes","_pt","isRequired","memo","GifPickerSearch","theme","getTheme","formatMessage","useIntl","handleChange","event","_event$target$value$r","_event$target","_event$target$value","preventDefault","value","target","replace","onChange","shouldUseWhiteLogo","useMemo","tinycolor","mostReadable","centerChannelBg","includeFallbackColors","isLight","id","defaultMessage","placeholder","autoFocus","autoComplete","src","giphyWhiteImage","giphyBlackImage","alt","GifPicker","handleItemClick","gif","imageWithMarkdown","title","images","fixed_height","url","pickerWidth","_props$getRootPickerN","_props$getRootPickerN2","_props$getRootPickerN3","_props$getRootPickerN4","getRootPickerNode","call","getBoundingClientRect","handleFilterChange"],"sourceRoot":""}