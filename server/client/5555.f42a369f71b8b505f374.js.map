{"version":3,"file":"5555.f42a369f71b8b505f374.js","mappings":"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","sources":["webpack://mattermost-webapp/./src/components/linking_landing_page/linking_landing_page.tsx","webpack://mattermost-webapp/./src/components/linking_landing_page/index.tsx"],"sourcesContent":["// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport React, {PureComponent} from 'react';\r\nimport {FormattedMessage} from 'react-intl';\r\n\r\nimport BrowserStore from 'stores/browser_store';\r\n\r\nimport ExternalLink from 'components/external_link';\r\n\r\nimport desktopImg from 'images/deep-linking/deeplinking-desktop-img.png';\r\nimport mobileImg from 'images/deep-linking/deeplinking-mobile-img.png';\r\nimport MattermostLogoSvg from 'images/logo.svg';\r\nimport {LandingPreferenceTypes} from 'utils/constants';\r\nimport * as UserAgent from 'utils/user_agent';\r\nimport * as Utils from 'utils/utils';\r\n\r\ntype Props = {\r\n    defaultTheme: any;\r\n    desktopAppLink?: string;\r\n    iosAppLink?: string;\r\n    androidAppLink?: string;\r\n    siteUrl?: string;\r\n    siteName?: string;\r\n    brandImageUrl?: string;\r\n    enableCustomBrand: boolean;\r\n}\r\n\r\ntype State = {\r\n    rememberChecked: boolean;\r\n    redirectPage: boolean;\r\n    location: string;\r\n    nativeLocation: string;\r\n    brandImageError: boolean;\r\n    navigating: boolean;\r\n}\r\n\r\nfunction safeRedirect(path: string) {\r\n    const url = new URL(path);\r\n\r\n    // Remove '/landing' from the end of the pathname\r\n    url.pathname = url.pathname.slice(0, -'/landing'.length);\r\n\r\n    const hash = url.hash.slice(1);\r\n    const baseUrl = new URL(url.pathname, url.origin);\r\n\r\n    // Default to base URL if no hash\r\n    if (!hash) {\r\n        return baseUrl.href;\r\n    }\r\n\r\n    let redirectUrl;\r\n\r\n    try {\r\n        // Attempt to construct URL from hash (handles both absolute and relative URLs)\r\n        redirectUrl = new URL(hash, baseUrl);\r\n    } catch (e) {\r\n        // Invalid hash, return safe default\r\n        return baseUrl.href;\r\n    }\r\n\r\n    // Only allow same-origin redirects\r\n    if (redirectUrl.origin !== baseUrl.origin) {\r\n        return baseUrl.href;\r\n    }\r\n\r\n    return redirectUrl.href;\r\n}\r\n\r\nexport default class LinkingLandingPage extends PureComponent<Props, State> {\r\n    constructor(props: Props) {\r\n        super(props);\r\n\r\n        const finalLocation = safeRedirect(window.location.href);\r\n        const nativeLocation = finalLocation.replace(/^(https|http)/, 'mattermost');\r\n\r\n        this.state = {\r\n            rememberChecked: false,\r\n            redirectPage: false,\r\n            location: finalLocation,\r\n            nativeLocation,\r\n            brandImageError: false,\r\n            navigating: false,\r\n        };\r\n\r\n        if (!BrowserStore.hasSeenLandingPage()) {\r\n            BrowserStore.setLandingPageSeen(true);\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        Utils.applyTheme(this.props.defaultTheme);\r\n        if (this.checkLandingPreferenceApp()) {\r\n            this.openMattermostApp();\r\n        }\r\n\r\n        window.addEventListener('beforeunload', this.clearLandingPreferenceIfNotChecked);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        window.removeEventListener('beforeunload', this.clearLandingPreferenceIfNotChecked);\r\n    }\r\n\r\n    clearLandingPreferenceIfNotChecked = () => {\r\n        if (!this.state.navigating && !this.state.rememberChecked) {\r\n            BrowserStore.clearLandingPreference(this.props.siteUrl);\r\n        }\r\n    };\r\n\r\n    checkLandingPreferenceBrowser = () => {\r\n        const landingPreference = BrowserStore.getLandingPreference(this.props.siteUrl);\r\n        return landingPreference && landingPreference === LandingPreferenceTypes.BROWSER;\r\n    };\r\n\r\n    isEmbedded = () => {\r\n        // this cookie is set by any plugin that facilitates iframe embedding (e.g. mattermost-plugin-msteams-sync).\r\n        const cookieName = 'MMEMBED';\r\n        const cookies = document.cookie.split(';');\r\n        for (let i = 0; i < cookies.length; i++) {\r\n            const cookie = cookies[i].trim();\r\n            if (cookie.startsWith(cookieName + '=')) {\r\n                const value = cookie.substring(cookieName.length + 1);\r\n                return decodeURIComponent(value) === '1';\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n\r\n    checkLandingPreferenceApp = () => {\r\n        const landingPreference = BrowserStore.getLandingPreference(this.props.siteUrl);\r\n        return landingPreference && landingPreference === LandingPreferenceTypes.MATTERMOSTAPP;\r\n    };\r\n\r\n    handleChecked = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.setState({rememberChecked: e.target.checked});\r\n\r\n        // If it was checked, and now we're unchecking it, clear the preference\r\n        if (!e.target.checked) {\r\n            BrowserStore.clearLandingPreference(this.props.siteUrl);\r\n        }\r\n    };\r\n\r\n    setPreference = (pref: string, clearIfNotChecked?: boolean) => {\r\n        if (!this.state.rememberChecked) {\r\n            if (clearIfNotChecked) {\r\n                BrowserStore.clearLandingPreference(this.props.siteUrl);\r\n            }\r\n            return;\r\n        }\r\n\r\n        switch (pref) {\r\n        case LandingPreferenceTypes.MATTERMOSTAPP:\r\n            BrowserStore.setLandingPreferenceToMattermostApp(this.props.siteUrl);\r\n            break;\r\n        case LandingPreferenceTypes.BROWSER:\r\n            BrowserStore.setLandingPreferenceToBrowser(this.props.siteUrl);\r\n            break;\r\n        default:\r\n            break;\r\n        }\r\n    };\r\n\r\n    openMattermostApp = () => {\r\n        this.setPreference(LandingPreferenceTypes.MATTERMOSTAPP);\r\n        this.setState({redirectPage: true});\r\n        window.location.href = this.state.nativeLocation;\r\n    };\r\n\r\n    openInBrowser = () => {\r\n        this.setPreference(LandingPreferenceTypes.BROWSER);\r\n        window.location.href = this.state.location;\r\n    };\r\n\r\n    renderSystemDialogMessage = () => {\r\n        const isMobile = UserAgent.isMobile();\r\n\r\n        if (isMobile) {\r\n            return (\r\n                <FormattedMessage\r\n                    id='get_app.systemDialogMessageMobile'\r\n                    defaultMessage='View in App'\r\n                />\r\n            );\r\n        }\r\n\r\n        return (\r\n            <FormattedMessage\r\n                id='get_app.systemDialogMessage'\r\n                defaultMessage='View in Desktop App'\r\n            />\r\n        );\r\n    };\r\n\r\n    renderGoNativeAppMessage = () => {\r\n        return (\r\n            <a\r\n                href={UserAgent.isMobile() ? '#' : this.state.nativeLocation}\r\n                onMouseDown={() => {\r\n                    this.setPreference(LandingPreferenceTypes.MATTERMOSTAPP, true);\r\n                }}\r\n                onClick={() => {\r\n                    this.setPreference(LandingPreferenceTypes.MATTERMOSTAPP, true);\r\n                    this.setState({redirectPage: true, navigating: true});\r\n                    if (UserAgent.isMobile()) {\r\n                        if (UserAgent.isAndroidWeb()) {\r\n                            const timeout = setTimeout(() => {\r\n                                window.location.replace(this.getDownloadLink()!);\r\n                            }, 2000);\r\n                            window.addEventListener('blur', () => {\r\n                                clearTimeout(timeout);\r\n                            });\r\n                        }\r\n                        window.location.replace(this.state.nativeLocation);\r\n                    }\r\n                }}\r\n                className='btn btn-primary btn-lg get-app__download'\r\n            >\r\n                {this.renderSystemDialogMessage()}\r\n            </a>\r\n        );\r\n    };\r\n\r\n    getDownloadLink = () => {\r\n        if (UserAgent.isIosWeb()) {\r\n            return this.props.iosAppLink;\r\n        } else if (UserAgent.isAndroidWeb()) {\r\n            return this.props.androidAppLink;\r\n        }\r\n\r\n        return this.props.desktopAppLink;\r\n    };\r\n\r\n    handleBrandImageError = () => {\r\n        this.setState({brandImageError: true});\r\n    };\r\n\r\n    renderGraphic = () => {\r\n        const isMobile = UserAgent.isMobile();\r\n\r\n        if (isMobile) {\r\n            return (\r\n                <img src={mobileImg}/>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <img src={desktopImg}/>\r\n        );\r\n    };\r\n\r\n    renderDownloadLinkText = () => {\r\n        const isMobile = UserAgent.isMobile();\r\n\r\n        if (isMobile) {\r\n            return (\r\n                <FormattedMessage\r\n                    id='get_app.dontHaveTheMobileApp'\r\n                    defaultMessage={'Don\\'t have the Mobile App?'}\r\n                />\r\n            );\r\n        }\r\n\r\n        return (\r\n            <FormattedMessage\r\n                id='get_app.dontHaveTheDesktopApp'\r\n                defaultMessage={'Don\\'t have the Desktop App?'}\r\n            />\r\n        );\r\n    };\r\n\r\n    renderDownloadLinkSection = () => {\r\n        const downloadLink = this.getDownloadLink();\r\n\r\n        if (this.state.redirectPage) {\r\n            return (\r\n                <div className='get-app__download-link'>\r\n                    <FormattedMessage\r\n                        id='getApp.downloadLinkInBrowser'\r\n                        defaultMessage='Or, <a>open this link in your browser</a>.'\r\n                        values={{\r\n                            a: (chunks) => (\r\n                                <ExternalLink\r\n                                    href={this.state.location}\r\n                                    location='landingPage'\r\n                                >\r\n                                    {chunks}\r\n                                </ExternalLink>\r\n                            ),\r\n                        }}\r\n                    />\r\n                </div>\r\n            );\r\n        } else if (downloadLink) {\r\n            return (\r\n                <div className='get-app__download-link'>\r\n                    {this.renderDownloadLinkText()}\r\n                    {'\\u00A0'}\r\n                    <br/>\r\n                    <a href={downloadLink}>\r\n                        <FormattedMessage\r\n                            id='get_app.downloadTheAppNow'\r\n                            defaultMessage='Download the app now.'\r\n                        />\r\n                    </a>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return null;\r\n    };\r\n\r\n    renderDialogHeader = () => {\r\n        const downloadLink = this.getDownloadLink();\r\n        const isMobile = UserAgent.isMobile();\r\n\r\n        let openingLink = (\r\n            <FormattedMessage\r\n                id='get_app.openingLink'\r\n                defaultMessage='Opening link in Mattermost...'\r\n            />\r\n        );\r\n        if (this.props.enableCustomBrand) {\r\n            openingLink = (\r\n                <FormattedMessage\r\n                    id='get_app.openingLinkWhiteLabel'\r\n                    defaultMessage='Opening link in {appName}...'\r\n                    values={{\r\n                        appName: this.props.siteName || 'Mattermost',\r\n                    }}\r\n                />\r\n            );\r\n        }\r\n\r\n        if (this.state.redirectPage) {\r\n            return (\r\n                <h1 className='get-app__launching'>\r\n                    {openingLink}\r\n                    <div className={`get-app__alternative${this.state.redirectPage ? ' redirect-page' : ''}`}>\r\n                        <FormattedMessage\r\n                            id='get_app.redirectedInMoments'\r\n                            defaultMessage='You will be redirected in a few moments.'\r\n                        />\r\n                        <br/>\r\n                        {this.renderDownloadLinkText()}\r\n                        {'\\u00A0'}\r\n                        <br className='mobile-only'/>\r\n                        <a href={downloadLink}>\r\n                            <FormattedMessage\r\n                                id='get_app.downloadTheAppNow'\r\n                                defaultMessage='Download the app now.'\r\n                            />\r\n                        </a>\r\n                    </div>\r\n                </h1>\r\n            );\r\n        }\r\n\r\n        let viewApp = (\r\n            <FormattedMessage\r\n                id='get_app.ifNothingPrompts'\r\n                defaultMessage='You can view {siteName} in the desktop app or continue in your web browser.'\r\n                values={{\r\n                    siteName: this.props.enableCustomBrand ? '' : ' Mattermost',\r\n                }}\r\n            />\r\n        );\r\n        if (isMobile) {\r\n            viewApp = (\r\n                <FormattedMessage\r\n                    id='get_app.ifNothingPromptsMobile'\r\n                    defaultMessage='You can view {siteName} in the mobile app or continue in your web browser.'\r\n                    values={{\r\n                        siteName: this.props.enableCustomBrand ? '' : ' Mattermost',\r\n                    }}\r\n                />\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div className='get-app__launching'>\r\n                <FormattedMessage\r\n                    id='get_app.launching'\r\n                    tagName='h1'\r\n                    defaultMessage='Where would you like to view this?'\r\n                />\r\n                <div className='get-app__alternative'>\r\n                    {viewApp}\r\n                </div>\r\n            </div>\r\n        );\r\n    };\r\n\r\n    renderDialogBody = () => {\r\n        if (this.state.redirectPage) {\r\n            return (\r\n                <div className='get-app__dialog-body'>\r\n                    {this.renderDialogHeader()}\r\n                    {this.renderDownloadLinkSection()}\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div className='get-app__dialog-body'>\r\n                {this.renderDialogHeader()}\r\n                <div className='get-app__buttons'>\r\n                    {this.renderGoNativeAppMessage()}\r\n                    <a\r\n                        href={this.state.location}\r\n                        onMouseDown={() => {\r\n                            this.setPreference(LandingPreferenceTypes.BROWSER, true);\r\n                        }}\r\n                        onClick={() => {\r\n                            this.setPreference(LandingPreferenceTypes.BROWSER, true);\r\n                            this.setState({navigating: true});\r\n                        }}\r\n                        className='btn btn-tertiary btn-lg'\r\n                    >\r\n                        <FormattedMessage\r\n                            id='get_app.continueToBrowser'\r\n                            defaultMessage='View in Browser'\r\n                        />\r\n                    </a>\r\n                </div>\r\n                <label className='get-app__preference'>\r\n                    <input\r\n                        type='checkbox'\r\n                        checked={this.state.rememberChecked}\r\n                        className='get-app__checkbox'\r\n                        onChange={this.handleChecked}\r\n                    />\r\n                    <FormattedMessage\r\n                        id='get_app.rememberMyPreference'\r\n                        defaultMessage='Remember my preference'\r\n                    />\r\n                </label>\r\n                {this.renderDownloadLinkSection()}\r\n            </div>\r\n        );\r\n    };\r\n\r\n    renderHeader = () => {\r\n        let header = (\r\n            <div className='get-app__header'>\r\n                <img\r\n                    src={MattermostLogoSvg}\r\n                    className='get-app__logo'\r\n                />\r\n            </div>\r\n        );\r\n        if (this.props.enableCustomBrand && this.props.brandImageUrl) {\r\n            let customLogo;\r\n            if (this.props.brandImageUrl && !this.state.brandImageError) {\r\n                customLogo = (\r\n                    <img\r\n                        src={this.props.brandImageUrl}\r\n                        onError={this.handleBrandImageError}\r\n                        className='get-app__custom-logo'\r\n                    />\r\n                );\r\n            }\r\n\r\n            header = (\r\n                <div className='get-app__header'>\r\n                    {customLogo}\r\n                    <div className='get-app__custom-site-name'>\r\n                        <span>{this.props.siteName}</span>\r\n                    </div>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return header;\r\n    };\r\n\r\n    render() {\r\n        const isMobile = UserAgent.isMobile();\r\n\r\n        if (this.checkLandingPreferenceBrowser() || this.isEmbedded()) {\r\n            this.openInBrowser();\r\n            return null;\r\n        }\r\n\r\n        return (\r\n            <div className='get-app'>\r\n                {this.renderHeader()}\r\n                <div className='get-app__dialog'>\r\n                    <div\r\n                        className={`get-app__graphic ${isMobile ? 'mobile' : ''}`}\r\n                    >\r\n                        {this.renderGraphic()}\r\n                    </div>\r\n                    {this.renderDialogBody()}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","// Copyright (c) 2015-present Mattermost, Inc. All Rights Reserved.\r\n// See LICENSE.txt for license information.\r\n\r\nimport {connect} from 'react-redux';\r\n\r\nimport {Client4} from 'mattermost-redux/client';\r\nimport {getConfig} from 'mattermost-redux/selectors/entities/general';\r\nimport {getTheme} from 'mattermost-redux/selectors/entities/preferences';\r\n\r\nimport type {GlobalState} from 'types/store';\r\n\r\nimport LinkingLandingPage from './linking_landing_page';\r\n\r\nfunction mapStateToProps(state: GlobalState) {\r\n    const config = getConfig(state);\r\n\r\n    return {\r\n        desktopAppLink: config.AppDownloadLink,\r\n        iosAppLink: config.IosAppDownloadLink,\r\n        androidAppLink: config.AndroidAppDownloadLink,\r\n        defaultTheme: getTheme(state),\r\n        siteUrl: config.SiteURL,\r\n        siteName: config.SiteName,\r\n        brandImageUrl: Client4.getBrandImageUrl('0'),\r\n        enableCustomBrand: config.EnableCustomBrand === 'true',\r\n    };\r\n}\r\n\r\nexport default connect(mapStateToProps)(LinkingLandingPage);\r\n"],"names":["LinkingLandingPage","PureComponent","constructor","props","super","_defineProperty","this","state","navigating","rememberChecked","BrowserStore","clearLandingPreference","siteUrl","landingPreference","getLandingPreference","LandingPreferenceTypes","BROWSER","cookies","document","cookie","split","i","length","trim","startsWith","cookieName","value","substring","decodeURIComponent","MATTERMOSTAPP","e","setState","target","checked","pref","clearIfNotChecked","setLandingPreferenceToMattermostApp","setLandingPreferenceToBrowser","setPreference","redirectPage","window","location","href","nativeLocation","UserAgent","React","FormattedMessage","id","defaultMessage","onMouseDown","onClick","timeout","setTimeout","replace","getDownloadLink","addEventListener","clearTimeout","className","renderSystemDialogMessage","iosAppLink","androidAppLink","desktopAppLink","brandImageError","src","mobileImg","desktopImg","downloadLink","values","a","chunks","ExternalLink","renderDownloadLinkText","isMobile","openingLink","enableCustomBrand","appName","siteName","concat","viewApp","tagName","renderDialogHeader","renderDownloadLinkSection","renderGoNativeAppMessage","type","onChange","handleChecked","header","MattermostLogoSvg","brandImageUrl","customLogo","onError","handleBrandImageError","finalLocation","path","url","URL","pathname","slice","hash","baseUrl","origin","redirectUrl","safeRedirect","hasSeenLandingPage","setLandingPageSeen","componentDidMount","Utils","defaultTheme","checkLandingPreferenceApp","openMattermostApp","clearLandingPreferenceIfNotChecked","componentWillUnmount","removeEventListener","render","checkLandingPreferenceBrowser","isEmbedded","openInBrowser","renderHeader","renderGraphic","renderDialogBody","_pt","isRequired","connect","config","getConfig","AppDownloadLink","IosAppDownloadLink","AndroidAppDownloadLink","getTheme","SiteURL","SiteName","Client4","getBrandImageUrl","EnableCustomBrand"],"sourceRoot":""}